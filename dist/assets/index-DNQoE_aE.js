(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const g of l)if(g.type==="childList")for(const d of g.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function o(l){const g={};return l.integrity&&(g.integrity=l.integrity),l.referrerPolicy&&(g.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?g.credentials="include":l.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function a(l){if(l.ep)return;l.ep=!0;const g=o(l);fetch(l.href,g)}})();var Yr={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var sl=Yr.exports,oa;function ol(){return oa||(oa=1,function(h,i){(function(o,a){a(i)})(sl,function(o){var a="1.9.4";function l(n){var u,f,y,k;for(f=1,y=arguments.length;f<y;f++){k=arguments[f];for(u in k)n[u]=k[u]}return n}var g=Object.create||function(){function n(){}return function(u){return n.prototype=u,new n}}();function d(n,u){var f=Array.prototype.slice;if(n.bind)return n.bind.apply(n,f.call(arguments,1));var y=f.call(arguments,2);return function(){return n.apply(u,y.length?y.concat(f.call(arguments)):arguments)}}var m=0;function _(n){return"_leaflet_id"in n||(n._leaflet_id=++m),n._leaflet_id}function x(n,u,f){var y,k,T,K;return K=function(){y=!1,k&&(T.apply(f,k),k=!1)},T=function(){y?k=arguments:(n.apply(f,arguments),setTimeout(K,u),y=!0)},T}function w(n,u,f){var y=u[1],k=u[0],T=y-k;return n===y&&f?n:((n-k)%T+T)%T+k}function I(){return!1}function b(n,u){if(u===!1)return n;var f=Math.pow(10,u===void 0?6:u);return Math.round(n*f)/f}function F(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function z(n){return F(n).split(/\s+/)}function et(n,u){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?g(n.options):{});for(var f in u)n.options[f]=u[f];return n.options}function ot(n,u,f){var y=[];for(var k in n)y.push(encodeURIComponent(f?k.toUpperCase():k)+"="+encodeURIComponent(n[k]));return(!u||u.indexOf("?")===-1?"?":"&")+y.join("&")}var ut=/\{ *([\w_ -]+) *\}/g;function S(n,u){return n.replace(ut,function(f,y){var k=u[y];if(k===void 0)throw new Error("No value provided for variable "+f);return typeof k=="function"&&(k=k(u)),k})}var G=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function R(n,u){for(var f=0;f<n.length;f++)if(n[f]===u)return f;return-1}var H="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Y(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var J=0;function P(n){var u=+new Date,f=Math.max(0,16-(u-J));return J=u+f,window.setTimeout(n,f)}var M=window.requestAnimationFrame||Y("RequestAnimationFrame")||P,N=window.cancelAnimationFrame||Y("CancelAnimationFrame")||Y("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function A(n,u,f){if(f&&M===P)n.call(u);else return M.call(window,d(n,u))}function O(n){n&&N.call(window,n)}var V={__proto__:null,extend:l,create:g,bind:d,get lastId(){return m},stamp:_,throttle:x,wrapNum:w,falseFn:I,formatNum:b,trim:F,splitWords:z,setOptions:et,getParamString:ot,template:S,isArray:G,indexOf:R,emptyImageUrl:H,requestFn:M,cancelFn:N,requestAnimFrame:A,cancelAnimFrame:O};function q(){}q.extend=function(n){var u=function(){et(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},f=u.__super__=this.prototype,y=g(f);y.constructor=u,u.prototype=y;for(var k in this)Object.prototype.hasOwnProperty.call(this,k)&&k!=="prototype"&&k!=="__super__"&&(u[k]=this[k]);return n.statics&&l(u,n.statics),n.includes&&(X(n.includes),l.apply(null,[y].concat(n.includes))),l(y,n),delete y.statics,delete y.includes,y.options&&(y.options=f.options?g(f.options):{},l(y.options,n.options)),y._initHooks=[],y.callInitHooks=function(){if(!this._initHooksCalled){f.callInitHooks&&f.callInitHooks.call(this),this._initHooksCalled=!0;for(var T=0,K=y._initHooks.length;T<K;T++)y._initHooks[T].call(this)}},u},q.include=function(n){var u=this.prototype.options;return l(this.prototype,n),n.options&&(this.prototype.options=u,this.mergeOptions(n.options)),this},q.mergeOptions=function(n){return l(this.prototype.options,n),this},q.addInitHook=function(n){var u=Array.prototype.slice.call(arguments,1),f=typeof n=="function"?n:function(){this[n].apply(this,u)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(f),this};function X(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=G(n)?n:[n];for(var u=0;u<n.length;u++)n[u]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var B={on:function(n,u,f){if(typeof n=="object")for(var y in n)this._on(y,n[y],u);else{n=z(n);for(var k=0,T=n.length;k<T;k++)this._on(n[k],u,f)}return this},off:function(n,u,f){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var y in n)this._off(y,n[y],u);else{n=z(n);for(var k=arguments.length===1,T=0,K=n.length;T<K;T++)k?this._off(n[T]):this._off(n[T],u,f)}return this},_on:function(n,u,f,y){if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}if(this._listens(n,u,f)===!1){f===this&&(f=void 0);var k={fn:u,ctx:f};y&&(k.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(k)}},_off:function(n,u,f){var y,k,T;if(this._events&&(y=this._events[n],!!y)){if(arguments.length===1){if(this._firingCount)for(k=0,T=y.length;k<T;k++)y[k].fn=I;delete this._events[n];return}if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}var K=this._listens(n,u,f);if(K!==!1){var it=y[K];this._firingCount&&(it.fn=I,this._events[n]=y=y.slice()),y.splice(K,1)}}},fire:function(n,u,f){if(!this.listens(n,f))return this;var y=l({},u,{type:n,target:this,sourceTarget:u&&u.sourceTarget||this});if(this._events){var k=this._events[n];if(k){this._firingCount=this._firingCount+1||1;for(var T=0,K=k.length;T<K;T++){var it=k[T],st=it.fn;it.once&&this.off(n,st,it.ctx),st.call(it.ctx||this,y)}this._firingCount--}}return f&&this._propagateEvent(y),this},listens:function(n,u,f,y){typeof n!="string"&&console.warn('"string" type argument expected');var k=u;typeof u!="function"&&(y=!!u,k=void 0,f=void 0);var T=this._events&&this._events[n];if(T&&T.length&&this._listens(n,k,f)!==!1)return!0;if(y){for(var K in this._eventParents)if(this._eventParents[K].listens(n,u,f,y))return!0}return!1},_listens:function(n,u,f){if(!this._events)return!1;var y=this._events[n]||[];if(!u)return!!y.length;f===this&&(f=void 0);for(var k=0,T=y.length;k<T;k++)if(y[k].fn===u&&y[k].ctx===f)return k;return!1},once:function(n,u,f){if(typeof n=="object")for(var y in n)this._on(y,n[y],u,!0);else{n=z(n);for(var k=0,T=n.length;k<T;k++)this._on(n[k],u,f,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[_(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[_(n)],this},_propagateEvent:function(n){for(var u in this._eventParents)this._eventParents[u].fire(n.type,l({layer:n.target,propagatedFrom:n.target},n),!0)}};B.addEventListener=B.on,B.removeEventListener=B.clearAllEventListeners=B.off,B.addOneTimeEventListener=B.once,B.fireEvent=B.fire,B.hasEventListeners=B.listens;var j=q.extend(B);function U(n,u,f){this.x=f?Math.round(n):n,this.y=f?Math.round(u):u}var tt=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};U.prototype={clone:function(){return new U(this.x,this.y)},add:function(n){return this.clone()._add(W(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(W(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new U(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new U(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=tt(this.x),this.y=tt(this.y),this},distanceTo:function(n){n=W(n);var u=n.x-this.x,f=n.y-this.y;return Math.sqrt(u*u+f*f)},equals:function(n){return n=W(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=W(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+b(this.x)+", "+b(this.y)+")"}};function W(n,u,f){return n instanceof U?n:G(n)?new U(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new U(n.x,n.y):new U(n,u,f)}function rt(n,u){if(n)for(var f=u?[n,u]:n,y=0,k=f.length;y<k;y++)this.extend(f[y])}rt.prototype={extend:function(n){var u,f;if(!n)return this;if(n instanceof U||typeof n[0]=="number"||"x"in n)u=f=W(n);else if(n=ht(n),u=n.min,f=n.max,!u||!f)return this;return!this.min&&!this.max?(this.min=u.clone(),this.max=f.clone()):(this.min.x=Math.min(u.x,this.min.x),this.max.x=Math.max(f.x,this.max.x),this.min.y=Math.min(u.y,this.min.y),this.max.y=Math.max(f.y,this.max.y)),this},getCenter:function(n){return W((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return W(this.min.x,this.max.y)},getTopRight:function(){return W(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var u,f;return typeof n[0]=="number"||n instanceof U?n=W(n):n=ht(n),n instanceof rt?(u=n.min,f=n.max):u=f=n,u.x>=this.min.x&&f.x<=this.max.x&&u.y>=this.min.y&&f.y<=this.max.y},intersects:function(n){n=ht(n);var u=this.min,f=this.max,y=n.min,k=n.max,T=k.x>=u.x&&y.x<=f.x,K=k.y>=u.y&&y.y<=f.y;return T&&K},overlaps:function(n){n=ht(n);var u=this.min,f=this.max,y=n.min,k=n.max,T=k.x>u.x&&y.x<f.x,K=k.y>u.y&&y.y<f.y;return T&&K},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var u=this.min,f=this.max,y=Math.abs(u.x-f.x)*n,k=Math.abs(u.y-f.y)*n;return ht(W(u.x-y,u.y-k),W(f.x+y,f.y+k))},equals:function(n){return n?(n=ht(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function ht(n,u){return!n||n instanceof rt?n:new rt(n,u)}function mt(n,u){if(n)for(var f=u?[n,u]:n,y=0,k=f.length;y<k;y++)this.extend(f[y])}mt.prototype={extend:function(n){var u=this._southWest,f=this._northEast,y,k;if(n instanceof ct)y=n,k=n;else if(n instanceof mt){if(y=n._southWest,k=n._northEast,!y||!k)return this}else return n?this.extend(ft(n)||at(n)):this;return!u&&!f?(this._southWest=new ct(y.lat,y.lng),this._northEast=new ct(k.lat,k.lng)):(u.lat=Math.min(y.lat,u.lat),u.lng=Math.min(y.lng,u.lng),f.lat=Math.max(k.lat,f.lat),f.lng=Math.max(k.lng,f.lng)),this},pad:function(n){var u=this._southWest,f=this._northEast,y=Math.abs(u.lat-f.lat)*n,k=Math.abs(u.lng-f.lng)*n;return new mt(new ct(u.lat-y,u.lng-k),new ct(f.lat+y,f.lng+k))},getCenter:function(){return new ct((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ct(this.getNorth(),this.getWest())},getSouthEast:function(){return new ct(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof ct||"lat"in n?n=ft(n):n=at(n);var u=this._southWest,f=this._northEast,y,k;return n instanceof mt?(y=n.getSouthWest(),k=n.getNorthEast()):y=k=n,y.lat>=u.lat&&k.lat<=f.lat&&y.lng>=u.lng&&k.lng<=f.lng},intersects:function(n){n=at(n);var u=this._southWest,f=this._northEast,y=n.getSouthWest(),k=n.getNorthEast(),T=k.lat>=u.lat&&y.lat<=f.lat,K=k.lng>=u.lng&&y.lng<=f.lng;return T&&K},overlaps:function(n){n=at(n);var u=this._southWest,f=this._northEast,y=n.getSouthWest(),k=n.getNorthEast(),T=k.lat>u.lat&&y.lat<f.lat,K=k.lng>u.lng&&y.lng<f.lng;return T&&K},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,u){return n?(n=at(n),this._southWest.equals(n.getSouthWest(),u)&&this._northEast.equals(n.getNorthEast(),u)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function at(n,u){return n instanceof mt?n:new mt(n,u)}function ct(n,u,f){if(isNaN(n)||isNaN(u))throw new Error("Invalid LatLng object: ("+n+", "+u+")");this.lat=+n,this.lng=+u,f!==void 0&&(this.alt=+f)}ct.prototype={equals:function(n,u){if(!n)return!1;n=ft(n);var f=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return f<=(u===void 0?1e-9:u)},toString:function(n){return"LatLng("+b(this.lat,n)+", "+b(this.lng,n)+")"},distanceTo:function(n){return Q.distance(this,ft(n))},wrap:function(){return Q.wrapLatLng(this)},toBounds:function(n){var u=180*n/40075017,f=u/Math.cos(Math.PI/180*this.lat);return at([this.lat-u,this.lng-f],[this.lat+u,this.lng+f])},clone:function(){return new ct(this.lat,this.lng,this.alt)}};function ft(n,u,f){return n instanceof ct?n:G(n)&&typeof n[0]!="object"?n.length===3?new ct(n[0],n[1],n[2]):n.length===2?new ct(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new ct(n.lat,"lng"in n?n.lng:n.lon,n.alt):u===void 0?null:new ct(n,u,f)}var kt={latLngToPoint:function(n,u){var f=this.projection.project(n),y=this.scale(u);return this.transformation._transform(f,y)},pointToLatLng:function(n,u){var f=this.scale(u),y=this.transformation.untransform(n,f);return this.projection.unproject(y)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var u=this.projection.bounds,f=this.scale(n),y=this.transformation.transform(u.min,f),k=this.transformation.transform(u.max,f);return new rt(y,k)},infinite:!1,wrapLatLng:function(n){var u=this.wrapLng?w(n.lng,this.wrapLng,!0):n.lng,f=this.wrapLat?w(n.lat,this.wrapLat,!0):n.lat,y=n.alt;return new ct(f,u,y)},wrapLatLngBounds:function(n){var u=n.getCenter(),f=this.wrapLatLng(u),y=u.lat-f.lat,k=u.lng-f.lng;if(y===0&&k===0)return n;var T=n.getSouthWest(),K=n.getNorthEast(),it=new ct(T.lat-y,T.lng-k),st=new ct(K.lat-y,K.lng-k);return new mt(it,st)}},Q=l({},kt,{wrapLng:[-180,180],R:6371e3,distance:function(n,u){var f=Math.PI/180,y=n.lat*f,k=u.lat*f,T=Math.sin((u.lat-n.lat)*f/2),K=Math.sin((u.lng-n.lng)*f/2),it=T*T+Math.cos(y)*Math.cos(k)*K*K,st=2*Math.atan2(Math.sqrt(it),Math.sqrt(1-it));return this.R*st}}),Xt=6378137,Ct={R:Xt,MAX_LATITUDE:85.0511287798,project:function(n){var u=Math.PI/180,f=this.MAX_LATITUDE,y=Math.max(Math.min(f,n.lat),-f),k=Math.sin(y*u);return new U(this.R*n.lng*u,this.R*Math.log((1+k)/(1-k))/2)},unproject:function(n){var u=180/Math.PI;return new ct((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*u,n.x*u/this.R)},bounds:function(){var n=Xt*Math.PI;return new rt([-n,-n],[n,n])}()};function vt(n,u,f,y){if(G(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=u,this._c=f,this._d=y}vt.prototype={transform:function(n,u){return this._transform(n.clone(),u)},_transform:function(n,u){return u=u||1,n.x=u*(this._a*n.x+this._b),n.y=u*(this._c*n.y+this._d),n},untransform:function(n,u){return u=u||1,new U((n.x/u-this._b)/this._a,(n.y/u-this._d)/this._c)}};function Z(n,u,f,y){return new vt(n,u,f,y)}var At=l({},Q,{code:"EPSG:3857",projection:Ct,transformation:function(){var n=.5/(Math.PI*Ct.R);return Z(n,.5,-n,.5)}()}),Gt=l({},At,{code:"EPSG:900913"});function Mt(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function ke(n,u){var f="",y,k,T,K,it,st;for(y=0,T=n.length;y<T;y++){for(it=n[y],k=0,K=it.length;k<K;k++)st=it[k],f+=(k?"L":"M")+st.x+" "+st.y;f+=u?Pt.svg?"z":"x":""}return f||"M0 0"}var ce=document.documentElement.style,Ne="ActiveXObject"in window,pt=Ne&&!document.addEventListener,ui="msLaunchUri"in navigator&&!("documentMode"in document),Zn=de("webkit"),Ye=de("android"),Ti=de("android 2")||de("android 3"),bt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),yn=Ye&&de("Google")&&bt<537&&!("AudioNode"in window),Xe=!!window.opera,Ni=!ui&&de("chrome"),St=de("gecko")&&!Zn&&!Xe&&!Ne,hr=!Ni&&de("safari"),Ht=de("phantom"),Tt="OTransition"in ce,io=navigator.platform.indexOf("Win")===0,Ve=Ne&&"transition"in ce,cr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ti,Lt="MozPerspective"in ce,ro=!window.L_DISABLE_3D&&(Ve||cr||Lt)&&!Tt&&!Ht,li=typeof orientation<"u"||de("mobile"),fr=li&&Zn,Fe=li&&cr,Un=!window.PointerEvent&&window.MSPointerEvent,qe=!!(window.PointerEvent||Un),gr="ontouchstart"in window||!!window.TouchEvent,bi=!window.L_NO_TOUCH&&(gr||qe),so=li&&Xe,ss=li&&St,Nn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,_t=function(){var n=!1;try{var u=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",I,u),window.removeEventListener("testPassiveEventSupport",I,u)}catch{}return n}(),Oi=function(){return!!document.createElement("canvas").getContext}(),Yn=!!(document.createElementNS&&Mt("svg").createSVGRect),hi=!!Yn&&function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),os=!Yn&&function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var u=n.firstChild;return u.style.behavior="url(#default#VML)",u&&typeof u.adj=="object"}catch{return!1}}(),dr=navigator.platform.indexOf("Mac")===0,as=navigator.platform.indexOf("Linux")===0;function de(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var Pt={ie:Ne,ielt9:pt,edge:ui,webkit:Zn,android:Ye,android23:Ti,androidStock:yn,opera:Xe,chrome:Ni,gecko:St,safari:hr,phantom:Ht,opera12:Tt,win:io,ie3d:Ve,webkit3d:cr,gecko3d:Lt,any3d:ro,mobile:li,mobileWebkit:fr,mobileWebkit3d:Fe,msPointer:Un,pointer:qe,touch:bi,touchNative:gr,mobileOpera:so,mobileGecko:ss,retina:Nn,passiveEvents:_t,canvas:Oi,svg:Yn,vml:os,inlineSvg:hi,mac:dr,linux:as},ci=Pt.msPointer?"MSPointerDown":"pointerdown",us=Pt.msPointer?"MSPointerMove":"pointermove",mr=Pt.msPointer?"MSPointerUp":"pointerup",ls=Pt.msPointer?"MSPointerCancel":"pointercancel",we={touchstart:ci,touchmove:us,touchend:mr,touchcancel:ls},Ai={touchstart:Fi,touchmove:Di,touchend:Di,touchcancel:Di},We={},vn=!1;function bn(n,u,f){return u==="touchstart"&&oo(),Ai[u]?(f=Ai[u].bind(this,f),n.addEventListener(we[u],f,!1),f):(console.warn("wrong event specified:",u),I)}function pr(n,u,f){if(!we[u]){console.warn("wrong event specified:",u);return}n.removeEventListener(we[u],f,!1)}function Ri(n){We[n.pointerId]=n}function fi(n){We[n.pointerId]&&(We[n.pointerId]=n)}function se(n){delete We[n.pointerId]}function oo(){vn||(document.addEventListener(ci,Ri,!0),document.addEventListener(us,fi,!0),document.addEventListener(mr,se,!0),document.addEventListener(ls,se,!0),vn=!0)}function Di(n,u){if(u.pointerType!==(u.MSPOINTER_TYPE_MOUSE||"mouse")){u.touches=[];for(var f in We)u.touches.push(We[f]);u.changedTouches=[u],n(u)}}function Fi(n,u){u.MSPOINTER_TYPE_TOUCH&&u.pointerType===u.MSPOINTER_TYPE_TOUCH&&ee(u),Di(n,u)}function gi(n){var u={},f,y;for(y in n)f=n[y],u[y]=f&&f.bind?f.bind(n):f;return n=u,u.type="dblclick",u.detail=2,u.isTrusted=!1,u._simulated=!0,u}var yr=200;function vr(n,u){n.addEventListener("dblclick",u);var f=0,y;function k(T){if(T.detail!==1){y=T.detail;return}if(!(T.pointerType==="mouse"||T.sourceCapabilities&&!T.sourceCapabilities.firesTouchEvents)){var K=pe(T);if(!(K.some(function(st){return st instanceof HTMLLabelElement&&st.attributes.for})&&!K.some(function(st){return st instanceof HTMLInputElement||st instanceof HTMLSelectElement}))){var it=Date.now();it-f<=yr?(y++,y===2&&u(gi(T))):y=1,f=it}}}return n.addEventListener("click",k),{dblclick:u,simDblclick:k}}function hs(n,u){n.removeEventListener("dblclick",u.dblclick),n.removeEventListener("click",u.simDblclick)}var _r=qi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ee=qi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),On=Ee==="webkitTransition"||Ee==="OTransition"?Ee+"End":"transitionend";function Bi(n){return typeof n=="string"?document.getElementById(n):n}function Ke(n,u){var f=n.style[u]||n.currentStyle&&n.currentStyle[u];if((!f||f==="auto")&&document.defaultView){var y=document.defaultView.getComputedStyle(n,null);f=y?y[u]:null}return f==="auto"?null:f}function Zt(n,u,f){var y=document.createElement(n);return y.className=u||"",f&&f.appendChild(y),y}function Qt(n){var u=n.parentNode;u&&u.removeChild(n)}function zi(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Xn(n){var u=n.parentNode;u&&u.lastChild!==n&&u.appendChild(n)}function An(n){var u=n.parentNode;u&&u.firstChild!==n&&u.insertBefore(n,u.firstChild)}function Gi(n,u){if(n.classList!==void 0)return n.classList.contains(u);var f=di(n);return f.length>0&&new RegExp("(^|\\s)"+u+"(\\s|$)").test(f)}function Ot(n,u){if(n.classList!==void 0)for(var f=z(u),y=0,k=f.length;y<k;y++)n.classList.add(f[y]);else if(!Gi(n,u)){var T=di(n);Je(n,(T?T+" ":"")+u)}}function Wt(n,u){n.classList!==void 0?n.classList.remove(u):Je(n,F((" "+di(n)+" ").replace(" "+u+" "," ")))}function Je(n,u){n.className.baseVal===void 0?n.className=u:n.className.baseVal=u}function di(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function fe(n,u){"opacity"in n.style?n.style.opacity=u:"filter"in n.style&&ao(n,u)}function ao(n,u){var f=!1,y="DXImageTransform.Microsoft.Alpha";try{f=n.filters.item(y)}catch{if(u===1)return}u=Math.round(u*100),f?(f.Enabled=u!==100,f.Opacity=u):n.style.filter+=" progid:"+y+"(opacity="+u+")"}function qi(n){for(var u=document.documentElement.style,f=0;f<n.length;f++)if(n[f]in u)return n[f];return!1}function Rn(n,u,f){var y=u||new U(0,0);n.style[_r]=(Pt.ie3d?"translate("+y.x+"px,"+y.y+"px)":"translate3d("+y.x+"px,"+y.y+"px,0)")+(f?" scale("+f+")":"")}function oe(n,u){n._leaflet_pos=u,Pt.any3d?Rn(n,u):(n.style.left=u.x+"px",n.style.top=u.y+"px")}function _n(n){return n._leaflet_pos||new U(0,0)}var hn,Vn,xr;if("onselectstart"in document)hn=function(){Rt(window,"selectstart",ee)},Vn=function(){Jt(window,"selectstart",ee)};else{var Wn=qi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);hn=function(){if(Wn){var n=document.documentElement.style;xr=n[Wn],n[Wn]="none"}},Vn=function(){Wn&&(document.documentElement.style[Wn]=xr,xr=void 0)}}function kr(){Rt(window,"dragstart",ee)}function mi(){Jt(window,"dragstart",ee)}var Kt,cn;function wr(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Kn(),Kt=n,cn=n.style.outlineStyle,n.style.outlineStyle="none",Rt(window,"keydown",Kn))}function Kn(){Kt&&(Kt.style.outlineStyle=cn,Kt=void 0,cn=void 0,Jt(window,"keydown",Kn))}function be(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function Le(n){var u=n.getBoundingClientRect();return{x:u.width/n.offsetWidth||1,y:u.height/n.offsetHeight||1,boundingClientRect:u}}var Hi={__proto__:null,TRANSFORM:_r,TRANSITION:Ee,TRANSITION_END:On,get:Bi,getStyle:Ke,create:Zt,remove:Qt,empty:zi,toFront:Xn,toBack:An,hasClass:Gi,addClass:Ot,removeClass:Wt,setClass:Je,getClass:di,setOpacity:fe,testProp:qi,setTransform:Rn,setPosition:oe,getPosition:_n,get disableTextSelection(){return hn},get enableTextSelection(){return Vn},disableImageDrag:kr,enableImageDrag:mi,preventOutline:wr,restoreOutline:Kn,getSizedParentNode:be,getScale:Le};function Rt(n,u,f,y){if(u&&typeof u=="object")for(var k in u)Zi(n,k,u[k],f);else{u=z(u);for(var T=0,K=u.length;T<K;T++)Zi(n,u[T],f,y)}return this}var je="_leaflet_events";function Jt(n,u,f,y){if(arguments.length===1)pi(n),delete n[je];else if(u&&typeof u=="object")for(var k in u)Yt(n,k,u[k],f);else if(u=z(u),arguments.length===2)pi(n,function(it){return R(u,it)!==-1});else for(var T=0,K=u.length;T<K;T++)Yt(n,u[T],f,y);return this}function pi(n,u){for(var f in n[je]){var y=f.split(/\d/)[0];(!u||u(y))&&Yt(n,y,null,null,f)}}var Er={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Zi(n,u,f,y){var k=u+_(f)+(y?"_"+_(y):"");if(n[je]&&n[je][k])return this;var T=function(it){return f.call(y||n,it||window.event)},K=T;!Pt.touchNative&&Pt.pointer&&u.indexOf("touch")===0?T=bn(n,u,T):Pt.touch&&u==="dblclick"?T=vr(n,T):"addEventListener"in n?u==="touchstart"||u==="touchmove"||u==="wheel"||u==="mousewheel"?n.addEventListener(Er[u]||u,T,Pt.passiveEvents?{passive:!1}:!1):u==="mouseenter"||u==="mouseleave"?(T=function(it){it=it||window.event,Ui(n,it)&&K(it)},n.addEventListener(Er[u],T,!1)):n.addEventListener(u,K,!1):n.attachEvent("on"+u,T),n[je]=n[je]||{},n[je][k]=T}function Yt(n,u,f,y,k){k=k||u+_(f)+(y?"_"+_(y):"");var T=n[je]&&n[je][k];if(!T)return this;!Pt.touchNative&&Pt.pointer&&u.indexOf("touch")===0?pr(n,u,T):Pt.touch&&u==="dblclick"?hs(n,T):"removeEventListener"in n?n.removeEventListener(Er[u]||u,T,!1):n.detachEvent("on"+u,T),n[je][k]=null}function me(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function yi(n){return Zi(n,"wheel",me),this}function Jn(n){return Rt(n,"mousedown touchstart dblclick contextmenu",me),n._leaflet_disable_click=!0,this}function ee(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function xn(n){return ee(n),me(n),this}function pe(n){if(n.composedPath)return n.composedPath();for(var u=[],f=n.target;f;)u.push(f),f=f.parentNode;return u}function Pr(n,u){if(!u)return new U(n.clientX,n.clientY);var f=Le(u),y=f.boundingClientRect;return new U((n.clientX-y.left)/f.x-u.clientLeft,(n.clientY-y.top)/f.y-u.clientTop)}var Ir=Pt.linux&&Pt.chrome?window.devicePixelRatio:Pt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Lr(n){return Pt.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Ir:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function Ui(n,u){var f=u.relatedTarget;if(!f)return!0;try{for(;f&&f!==n;)f=f.parentNode}catch{return!1}return f!==n}var uo={__proto__:null,on:Rt,off:Jt,stopPropagation:me,disableScrollPropagation:yi,disableClickPropagation:Jn,preventDefault:ee,stop:xn,getPropagationPath:pe,getMousePosition:Pr,getWheelDelta:Lr,isExternalTarget:Ui,addListener:Rt,removeListener:Jt},Mr=j.extend({run:function(n,u,f,y){this.stop(),this._el=n,this._inProgress=!0,this._duration=f||.25,this._easeOutPower=1/Math.max(y||.5,.2),this._startPos=_n(n),this._offset=u.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=A(this._animate,this),this._step()},_step:function(n){var u=+new Date-this._startTime,f=this._duration*1e3;u<f?this._runFrame(this._easeOut(u/f),n):(this._runFrame(1),this._complete())},_runFrame:function(n,u){var f=this._startPos.add(this._offset.multiplyBy(n));u&&f._round(),oe(this._el,f),this.fire("step")},_complete:function(){O(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),Dt=j.extend({options:{crs:At,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,u){u=et(this,u),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=d(this._onResize,this),this._initEvents(),u.maxBounds&&this.setMaxBounds(u.maxBounds),u.zoom!==void 0&&(this._zoom=this._limitZoom(u.zoom)),u.center&&u.zoom!==void 0&&this.setView(ft(u.center),u.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ee&&Pt.any3d&&!Pt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Rt(this._proxy,On,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,u,f){if(u=u===void 0?this._zoom:this._limitZoom(u),n=this._limitCenter(ft(n),u,this.options.maxBounds),f=f||{},this._stop(),this._loaded&&!f.reset&&f!==!0){f.animate!==void 0&&(f.zoom=l({animate:f.animate},f.zoom),f.pan=l({animate:f.animate,duration:f.duration},f.pan));var y=this._zoom!==u?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,u,f.zoom):this._tryAnimatedPan(n,f.pan);if(y)return clearTimeout(this._sizeTimer),this}return this._resetView(n,u,f.pan&&f.pan.noMoveStart),this},setZoom:function(n,u){return this._loaded?this.setView(this.getCenter(),n,{zoom:u}):(this._zoom=n,this)},zoomIn:function(n,u){return n=n||(Pt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,u)},zoomOut:function(n,u){return n=n||(Pt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,u)},setZoomAround:function(n,u,f){var y=this.getZoomScale(u),k=this.getSize().divideBy(2),T=n instanceof U?n:this.latLngToContainerPoint(n),K=T.subtract(k).multiplyBy(1-1/y),it=this.containerPointToLatLng(k.add(K));return this.setView(it,u,{zoom:f})},_getBoundsCenterZoom:function(n,u){u=u||{},n=n.getBounds?n.getBounds():at(n);var f=W(u.paddingTopLeft||u.padding||[0,0]),y=W(u.paddingBottomRight||u.padding||[0,0]),k=this.getBoundsZoom(n,!1,f.add(y));if(k=typeof u.maxZoom=="number"?Math.min(u.maxZoom,k):k,k===1/0)return{center:n.getCenter(),zoom:k};var T=y.subtract(f).divideBy(2),K=this.project(n.getSouthWest(),k),it=this.project(n.getNorthEast(),k),st=this.unproject(K.add(it).divideBy(2).add(T),k);return{center:st,zoom:k}},fitBounds:function(n,u){if(n=at(n),!n.isValid())throw new Error("Bounds are not valid.");var f=this._getBoundsCenterZoom(n,u);return this.setView(f.center,f.zoom,u)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,u){return this.setView(n,this._zoom,{pan:u})},panBy:function(n,u){if(n=W(n).round(),u=u||{},!n.x&&!n.y)return this.fire("moveend");if(u.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Mr,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),u.noMoveStart||this.fire("movestart"),u.animate!==!1){Ot(this._mapPane,"leaflet-pan-anim");var f=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,f,u.duration||.25,u.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,u,f){if(f=f||{},f.animate===!1||!Pt.any3d)return this.setView(n,u,f);this._stop();var y=this.project(this.getCenter()),k=this.project(n),T=this.getSize(),K=this._zoom;n=ft(n),u=u===void 0?K:u;var it=Math.max(T.x,T.y),st=it*this.getZoomScale(K,u),dt=k.distanceTo(y)||1,wt=1.42,Nt=wt*wt;function qt(le){var Ps=le?-1:1,el=le?st:it,nl=st*st-it*it+Ps*Nt*Nt*dt*dt,il=2*el*Nt*dt,ko=nl/il,sa=Math.sqrt(ko*ko+1)-ko,rl=sa<1e-9?-18:Math.log(sa);return rl}function Re(le){return(Math.exp(le)-Math.exp(-le))/2}function ve(le){return(Math.exp(le)+Math.exp(-le))/2}function rn(le){return Re(le)/ve(le)}var ze=qt(0);function tr(le){return it*(ve(ze)/ve(ze+wt*le))}function ju(le){return it*(ve(ze)*rn(ze+wt*le)-Re(ze))/Nt}function $u(le){return 1-Math.pow(1-le,1.5)}var Qu=Date.now(),ia=(qt(1)-ze)/wt,tl=f.duration?1e3*f.duration:1e3*ia*.8;function ra(){var le=(Date.now()-Qu)/tl,Ps=$u(le)*ia;le<=1?(this._flyToFrame=A(ra,this),this._move(this.unproject(y.add(k.subtract(y).multiplyBy(ju(Ps)/dt)),K),this.getScaleZoom(it/tr(Ps),K),{flyTo:!0})):this._move(n,u)._moveEnd(!0)}return this._moveStart(!0,f.noMoveStart),ra.call(this),this},flyToBounds:function(n,u){var f=this._getBoundsCenterZoom(n,u);return this.flyTo(f.center,f.zoom,u)},setMaxBounds:function(n){return n=at(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var u=this.options.minZoom;return this.options.minZoom=n,this._loaded&&u!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var u=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&u!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,u){this._enforcingBounds=!0;var f=this.getCenter(),y=this._limitCenter(f,this._zoom,at(n));return f.equals(y)||this.panTo(y,u),this._enforcingBounds=!1,this},panInside:function(n,u){u=u||{};var f=W(u.paddingTopLeft||u.padding||[0,0]),y=W(u.paddingBottomRight||u.padding||[0,0]),k=this.project(this.getCenter()),T=this.project(n),K=this.getPixelBounds(),it=ht([K.min.add(f),K.max.subtract(y)]),st=it.getSize();if(!it.contains(T)){this._enforcingBounds=!0;var dt=T.subtract(it.getCenter()),wt=it.extend(T).getSize().subtract(st);k.x+=dt.x<0?-wt.x:wt.x,k.y+=dt.y<0?-wt.y:wt.y,this.panTo(this.unproject(k),u),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=l({animate:!1,pan:!0},n===!0?{animate:!0}:n);var u=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var f=this.getSize(),y=u.divideBy(2).round(),k=f.divideBy(2).round(),T=y.subtract(k);return!T.x&&!T.y?this:(n.animate&&n.pan?this.panBy(T):(n.pan&&this._rawPanBy(T),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(d(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:u,newSize:f}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=l({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var u=d(this._handleGeolocationResponse,this),f=d(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(u,f,n):navigator.geolocation.getCurrentPosition(u,f,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var u=n.code,f=n.message||(u===1?"permission denied":u===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:u,message:"Geolocation error: "+f+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var u=n.coords.latitude,f=n.coords.longitude,y=new ct(u,f),k=y.toBounds(n.coords.accuracy*2),T=this._locateOptions;if(T.setView){var K=this.getBoundsZoom(k);this.setView(y,T.maxZoom?Math.min(K,T.maxZoom):K)}var it={latlng:y,bounds:k,timestamp:n.timestamp};for(var st in n.coords)typeof n.coords[st]=="number"&&(it[st]=n.coords[st]);this.fire("locationfound",it)}},addHandler:function(n,u){if(!u)return this;var f=this[n]=new u(this);return this._handlers.push(f),this.options[n]&&f.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Qt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(O(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)Qt(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,u){var f="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),y=Zt("div",f,u||this._mapPane);return n&&(this._panes[n]=y),y},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),u=this.unproject(n.getBottomLeft()),f=this.unproject(n.getTopRight());return new mt(u,f)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,u,f){n=at(n),f=W(f||[0,0]);var y=this.getZoom()||0,k=this.getMinZoom(),T=this.getMaxZoom(),K=n.getNorthWest(),it=n.getSouthEast(),st=this.getSize().subtract(f),dt=ht(this.project(it,y),this.project(K,y)).getSize(),wt=Pt.any3d?this.options.zoomSnap:1,Nt=st.x/dt.x,qt=st.y/dt.y,Re=u?Math.max(Nt,qt):Math.min(Nt,qt);return y=this.getScaleZoom(Re,y),wt&&(y=Math.round(y/(wt/100))*(wt/100),y=u?Math.ceil(y/wt)*wt:Math.floor(y/wt)*wt),Math.max(k,Math.min(T,y))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new U(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,u){var f=this._getTopLeftPoint(n,u);return new rt(f,f.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,u){var f=this.options.crs;return u=u===void 0?this._zoom:u,f.scale(n)/f.scale(u)},getScaleZoom:function(n,u){var f=this.options.crs;u=u===void 0?this._zoom:u;var y=f.zoom(n*f.scale(u));return isNaN(y)?1/0:y},project:function(n,u){return u=u===void 0?this._zoom:u,this.options.crs.latLngToPoint(ft(n),u)},unproject:function(n,u){return u=u===void 0?this._zoom:u,this.options.crs.pointToLatLng(W(n),u)},layerPointToLatLng:function(n){var u=W(n).add(this.getPixelOrigin());return this.unproject(u)},latLngToLayerPoint:function(n){var u=this.project(ft(n))._round();return u._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(ft(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(at(n))},distance:function(n,u){return this.options.crs.distance(ft(n),ft(u))},containerPointToLayerPoint:function(n){return W(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return W(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var u=this.containerPointToLayerPoint(W(n));return this.layerPointToLatLng(u)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ft(n)))},mouseEventToContainerPoint:function(n){return Pr(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var u=this._container=Bi(n);if(u){if(u._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Rt(u,"scroll",this._onScroll,this),this._containerId=_(u)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&Pt.any3d,Ot(n,"leaflet-container"+(Pt.touch?" leaflet-touch":"")+(Pt.retina?" leaflet-retina":"")+(Pt.ielt9?" leaflet-oldie":"")+(Pt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var u=Ke(n,"position");u!=="absolute"&&u!=="relative"&&u!=="fixed"&&u!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),oe(this._mapPane,new U(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ot(n.markerPane,"leaflet-zoom-hide"),Ot(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,u,f){oe(this._mapPane,new U(0,0));var y=!this._loaded;this._loaded=!0,u=this._limitZoom(u),this.fire("viewprereset");var k=this._zoom!==u;this._moveStart(k,f)._move(n,u)._moveEnd(k),this.fire("viewreset"),y&&this.fire("load")},_moveStart:function(n,u){return n&&this.fire("zoomstart"),u||this.fire("movestart"),this},_move:function(n,u,f,y){u===void 0&&(u=this._zoom);var k=this._zoom!==u;return this._zoom=u,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),y?f&&f.pinch&&this.fire("zoom",f):((k||f&&f.pinch)&&this.fire("zoom",f),this.fire("move",f)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return O(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){oe(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[_(this._container)]=this;var u=n?Jt:Rt;u(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&u(window,"resize",this._onResize,this),Pt.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){O(this._resizeRequest),this._resizeRequest=A(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,u){for(var f=[],y,k=u==="mouseout"||u==="mouseover",T=n.target||n.srcElement,K=!1;T;){if(y=this._targets[_(T)],y&&(u==="click"||u==="preclick")&&this._draggableMoved(y)){K=!0;break}if(y&&y.listens(u,!0)&&(k&&!Ui(T,n)||(f.push(y),k))||T===this._container)break;T=T.parentNode}return!f.length&&!K&&!k&&this.listens(u,!0)&&(f=[this]),f},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var u=n.target||n.srcElement;if(!(!this._loaded||u._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(u))){var f=n.type;f==="mousedown"&&wr(u),this._fireDOMEvent(n,f)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,u,f){if(n.type==="click"){var y=l({},n);y.type="preclick",this._fireDOMEvent(y,y.type,f)}var k=this._findEventTargets(n,u);if(f){for(var T=[],K=0;K<f.length;K++)f[K].listens(u,!0)&&T.push(f[K]);k=T.concat(k)}if(k.length){u==="contextmenu"&&ee(n);var it=k[0],st={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var dt=it.getLatLng&&(!it._radius||it._radius<=10);st.containerPoint=dt?this.latLngToContainerPoint(it.getLatLng()):this.mouseEventToContainerPoint(n),st.layerPoint=this.containerPointToLayerPoint(st.containerPoint),st.latlng=dt?it.getLatLng():this.layerPointToLatLng(st.layerPoint)}for(K=0;K<k.length;K++)if(k[K].fire(u,st,!0),st.originalEvent._stopped||k[K].options.bubblingMouseEvents===!1&&R(this._mouseEvents,u)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,u=this._handlers.length;n<u;n++)this._handlers[n].disable()},whenReady:function(n,u){return this._loaded?n.call(u||this,{target:this}):this.on("load",n,u),this},_getMapPanePos:function(){return _n(this._mapPane)||new U(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,u){var f=n&&u!==void 0?this._getNewPixelOrigin(n,u):this.getPixelOrigin();return f.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,u){var f=this.getSize()._divideBy(2);return this.project(n,u)._subtract(f)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,u,f){var y=this._getNewPixelOrigin(f,u);return this.project(n,u)._subtract(y)},_latLngBoundsToNewLayerBounds:function(n,u,f){var y=this._getNewPixelOrigin(f,u);return ht([this.project(n.getSouthWest(),u)._subtract(y),this.project(n.getNorthWest(),u)._subtract(y),this.project(n.getSouthEast(),u)._subtract(y),this.project(n.getNorthEast(),u)._subtract(y)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,u,f){if(!f)return n;var y=this.project(n,u),k=this.getSize().divideBy(2),T=new rt(y.subtract(k),y.add(k)),K=this._getBoundsOffset(T,f,u);return Math.abs(K.x)<=1&&Math.abs(K.y)<=1?n:this.unproject(y.add(K),u)},_limitOffset:function(n,u){if(!u)return n;var f=this.getPixelBounds(),y=new rt(f.min.add(n),f.max.add(n));return n.add(this._getBoundsOffset(y,u))},_getBoundsOffset:function(n,u,f){var y=ht(this.project(u.getNorthEast(),f),this.project(u.getSouthWest(),f)),k=y.min.subtract(n.min),T=y.max.subtract(n.max),K=this._rebound(k.x,-T.x),it=this._rebound(k.y,-T.y);return new U(K,it)},_rebound:function(n,u){return n+u>0?Math.round(n-u)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(u))},_limitZoom:function(n){var u=this.getMinZoom(),f=this.getMaxZoom(),y=Pt.any3d?this.options.zoomSnap:1;return y&&(n=Math.round(n/y)*y),Math.max(u,Math.min(f,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Wt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,u){var f=this._getCenterOffset(n)._trunc();return(u&&u.animate)!==!0&&!this.getSize().contains(f)?!1:(this.panBy(f,u),!0)},_createAnimProxy:function(){var n=this._proxy=Zt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(u){var f=_r,y=this._proxy.style[f];Rn(this._proxy,this.project(u.center,u.zoom),this.getZoomScale(u.zoom,1)),y===this._proxy.style[f]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Qt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),u=this.getZoom();Rn(this._proxy,this.project(n,u),this.getZoomScale(u,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,u,f){if(this._animatingZoom)return!0;if(f=f||{},!this._zoomAnimated||f.animate===!1||this._nothingToAnimate()||Math.abs(u-this._zoom)>this.options.zoomAnimationThreshold)return!1;var y=this.getZoomScale(u),k=this._getCenterOffset(n)._divideBy(1-1/y);return f.animate!==!0&&!this.getSize().contains(k)?!1:(A(function(){this._moveStart(!0,f.noMoveStart||!1)._animateZoom(n,u,!0)},this),!0)},_animateZoom:function(n,u,f,y){this._mapPane&&(f&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=u,Ot(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:u,noUpdate:y}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(d(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Wt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Yi(n,u){return new Dt(n,u)}var He=q.extend({options:{position:"topright"},initialize:function(n){et(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var u=this._map;return u&&u.removeControl(this),this.options.position=n,u&&u.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var u=this._container=this.onAdd(n),f=this.getPosition(),y=n._controlCorners[f];return Ot(u,"leaflet-control"),f.indexOf("bottom")!==-1?y.insertBefore(u,y.firstChild):y.appendChild(u),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Qt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),ye=function(n){return new He(n)};Dt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},u="leaflet-",f=this._controlContainer=Zt("div",u+"control-container",this._container);function y(k,T){var K=u+k+" "+u+T;n[k+T]=Zt("div",K,f)}y("top","left"),y("top","right"),y("bottom","left"),y("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)Qt(this._controlCorners[n]);Qt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Dn=He.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,u,f,y){return f<y?-1:y<f?1:0}},initialize:function(n,u,f){et(this,f),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var y in n)this._addLayer(n[y],y);for(y in u)this._addLayer(u[y],y,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return He.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,u){return this._addLayer(n,u),this._map?this._update():this},addOverlay:function(n,u){return this._addLayer(n,u,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var u=this._getLayer(_(n));return u&&this._layers.splice(this._layers.indexOf(u),1),this._map?this._update():this},expand:function(){Ot(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(Ot(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Wt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Wt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",u=this._container=Zt("div",n),f=this.options.collapsed;u.setAttribute("aria-haspopup",!0),Jn(u),yi(u);var y=this._section=Zt("section",n+"-list");f&&(this._map.on("click",this.collapse,this),Rt(u,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var k=this._layersLink=Zt("a",n+"-toggle",u);k.href="#",k.title="Layers",k.setAttribute("role","button"),Rt(k,{keydown:function(T){T.keyCode===13&&this._expandSafely()},click:function(T){ee(T),this._expandSafely()}},this),f||this.expand(),this._baseLayersList=Zt("div",n+"-base",y),this._separator=Zt("div",n+"-separator",y),this._overlaysList=Zt("div",n+"-overlays",y),u.appendChild(y)},_getLayer:function(n){for(var u=0;u<this._layers.length;u++)if(this._layers[u]&&_(this._layers[u].layer)===n)return this._layers[u]},_addLayer:function(n,u,f){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:u,overlay:f}),this.options.sortLayers&&this._layers.sort(d(function(y,k){return this.options.sortFunction(y.layer,k.layer,y.name,k.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;zi(this._baseLayersList),zi(this._overlaysList),this._layerControlInputs=[];var n,u,f,y,k=0;for(f=0;f<this._layers.length;f++)y=this._layers[f],this._addItem(y),u=u||y.overlay,n=n||!y.overlay,k+=y.overlay?0:1;return this.options.hideSingleBase&&(n=n&&k>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=u&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var u=this._getLayer(_(n.target)),f=u.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;f&&this._map.fire(f,u)},_createRadioElement:function(n,u){var f='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(u?' checked="checked"':"")+"/>",y=document.createElement("div");return y.innerHTML=f,y.firstChild},_addItem:function(n){var u=document.createElement("label"),f=this._map.hasLayer(n.layer),y;n.overlay?(y=document.createElement("input"),y.type="checkbox",y.className="leaflet-control-layers-selector",y.defaultChecked=f):y=this._createRadioElement("leaflet-base-layers_"+_(this),f),this._layerControlInputs.push(y),y.layerId=_(n.layer),Rt(y,"click",this._onInputClick,this);var k=document.createElement("span");k.innerHTML=" "+n.name;var T=document.createElement("span");u.appendChild(T),T.appendChild(y),T.appendChild(k);var K=n.overlay?this._overlaysList:this._baseLayersList;return K.appendChild(u),this._checkDisabledLayers(),u},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,u,f,y=[],k=[];this._handlingClick=!0;for(var T=n.length-1;T>=0;T--)u=n[T],f=this._getLayer(u.layerId).layer,u.checked?y.push(f):u.checked||k.push(f);for(T=0;T<k.length;T++)this._map.hasLayer(k[T])&&this._map.removeLayer(k[T]);for(T=0;T<y.length;T++)this._map.hasLayer(y[T])||this._map.addLayer(y[T]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,u,f,y=this._map.getZoom(),k=n.length-1;k>=0;k--)u=n[k],f=this._getLayer(u.layerId).layer,u.disabled=f.options.minZoom!==void 0&&y<f.options.minZoom||f.options.maxZoom!==void 0&&y>f.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,Rt(n,"click",ee),this.expand();var u=this;setTimeout(function(){Jt(n,"click",ee),u._preventClick=!1})}}),lo=function(n,u,f){return new Dn(n,u,f)},kn=He.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var u="leaflet-control-zoom",f=Zt("div",u+" leaflet-bar"),y=this.options;return this._zoomInButton=this._createButton(y.zoomInText,y.zoomInTitle,u+"-in",f,this._zoomIn),this._zoomOutButton=this._createButton(y.zoomOutText,y.zoomOutTitle,u+"-out",f,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),f},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,u,f,y,k){var T=Zt("a",f,y);return T.innerHTML=n,T.href="#",T.title=u,T.setAttribute("role","button"),T.setAttribute("aria-label",u),Jn(T),Rt(T,"click",xn),Rt(T,"click",k,this),Rt(T,"click",this._refocusOnMap,this),T},_updateDisabled:function(){var n=this._map,u="leaflet-disabled";Wt(this._zoomInButton,u),Wt(this._zoomOutButton,u),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(Ot(this._zoomOutButton,u),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(Ot(this._zoomInButton,u),this._zoomInButton.setAttribute("aria-disabled","true"))}});Dt.mergeOptions({zoomControl:!0}),Dt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new kn,this.addControl(this.zoomControl))});var cs=function(n){return new kn(n)},Fn=He.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var u="leaflet-control-scale",f=Zt("div",u),y=this.options;return this._addScales(y,u+"-line",f),n.on(y.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),f},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,u,f){n.metric&&(this._mScale=Zt("div",u,f)),n.imperial&&(this._iScale=Zt("div",u,f))},_update:function(){var n=this._map,u=n.getSize().y/2,f=n.distance(n.containerPointToLatLng([0,u]),n.containerPointToLatLng([this.options.maxWidth,u]));this._updateScales(f)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var u=this._getRoundNum(n),f=u<1e3?u+" m":u/1e3+" km";this._updateScale(this._mScale,f,u/n)},_updateImperial:function(n){var u=n*3.2808399,f,y,k;u>5280?(f=u/5280,y=this._getRoundNum(f),this._updateScale(this._iScale,y+" mi",y/f)):(k=this._getRoundNum(u),this._updateScale(this._iScale,k+" ft",k/u))},_updateScale:function(n,u,f){n.style.width=Math.round(this.options.maxWidth*f)+"px",n.innerHTML=u},_getRoundNum:function(n){var u=Math.pow(10,(Math.floor(n)+"").length-1),f=n/u;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:1,u*f}}),ho=function(n){return new Fn(n)},$e='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Xi=He.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Pt.inlineSvg?$e+" ":"")+"Leaflet</a>"},initialize:function(n){et(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=Zt("div","leaflet-control-attribution"),Jn(this._container);for(var u in n._layers)n._layers[u].getAttribution&&this.addAttribution(n._layers[u].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var u in this._attributions)this._attributions[u]&&n.push(u);var f=[];this.options.prefix&&f.push(this.options.prefix),n.length&&f.push(n.join(", ")),this._container.innerHTML=f.join(' <span aria-hidden="true">|</span> ')}}});Dt.mergeOptions({attributionControl:!0}),Dt.addInitHook(function(){this.options.attributionControl&&new Xi().addTo(this)});var co=function(n){return new Xi(n)};He.Layers=Dn,He.Zoom=kn,He.Scale=Fn,He.Attribution=Xi,ye.layers=lo,ye.zoom=cs,ye.scale=ho,ye.attribution=co;var Qe=q.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Qe.addTo=function(n,u){return n.addHandler(u,this),this};var fo={Events:B},fs=Pt.touch?"touchstart mousedown":"mousedown",wn=j.extend({options:{clickTolerance:3},initialize:function(n,u,f,y){et(this,y),this._element=n,this._dragStartTarget=u||n,this._preventOutline=f},enable:function(){this._enabled||(Rt(this._dragStartTarget,fs,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(wn._dragging===this&&this.finishDrag(!0),Jt(this._dragStartTarget,fs,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!Gi(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){wn._dragging===this&&this.finishDrag();return}if(!(wn._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(wn._dragging=this,this._preventOutline&&wr(this._element),kr(),hn(),!this._moving)){this.fire("down");var u=n.touches?n.touches[0]:n,f=be(this._element);this._startPoint=new U(u.clientX,u.clientY),this._startPos=_n(this._element),this._parentScale=Le(f);var y=n.type==="mousedown";Rt(document,y?"mousemove":"touchmove",this._onMove,this),Rt(document,y?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var u=n.touches&&n.touches.length===1?n.touches[0]:n,f=new U(u.clientX,u.clientY)._subtract(this._startPoint);!f.x&&!f.y||Math.abs(f.x)+Math.abs(f.y)<this.options.clickTolerance||(f.x/=this._parentScale.x,f.y/=this._parentScale.y,ee(n),this._moved||(this.fire("dragstart"),this._moved=!0,Ot(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ot(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(f),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),oe(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Wt(document.body,"leaflet-dragging"),this._lastTarget&&(Wt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Jt(document,"mousemove touchmove",this._onMove,this),Jt(document,"mouseup touchend touchcancel",this._onUp,this),mi(),Vn();var u=this._moved&&this._moving;this._moving=!1,wn._dragging=!1,u&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function gs(n,u,f){var y,k=[1,4,2,8],T,K,it,st,dt,wt,Nt,qt;for(T=0,wt=n.length;T<wt;T++)n[T]._code=ue(n[T],u);for(it=0;it<4;it++){for(Nt=k[it],y=[],T=0,wt=n.length,K=wt-1;T<wt;K=T++)st=n[T],dt=n[K],st._code&Nt?dt._code&Nt||(qt=vi(dt,st,Nt,u,f),qt._code=ue(qt,u),y.push(qt)):(dt._code&Nt&&(qt=vi(dt,st,Nt,u,f),qt._code=ue(qt,u),y.push(qt)),y.push(st));n=y}return n}function ds(n,u){var f,y,k,T,K,it,st,dt,wt;if(!n||n.length===0)throw new Error("latlngs not passed");Ae(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Nt=ft([0,0]),qt=at(n),Re=qt.getNorthWest().distanceTo(qt.getSouthWest())*qt.getNorthEast().distanceTo(qt.getNorthWest());Re<1700&&(Nt=fn(n));var ve=n.length,rn=[];for(f=0;f<ve;f++){var ze=ft(n[f]);rn.push(u.project(ft([ze.lat-Nt.lat,ze.lng-Nt.lng])))}for(it=st=dt=0,f=0,y=ve-1;f<ve;y=f++)k=rn[f],T=rn[y],K=k.y*T.x-T.y*k.x,st+=(k.x+T.x)*K,dt+=(k.y+T.y)*K,it+=K*3;it===0?wt=rn[0]:wt=[st/it,dt/it];var tr=u.unproject(W(wt));return ft([tr.lat+Nt.lat,tr.lng+Nt.lng])}function fn(n){for(var u=0,f=0,y=0,k=0;k<n.length;k++){var T=ft(n[k]);u+=T.lat,f+=T.lng,y++}return ft([u/y,f/y])}var Oe={__proto__:null,clipPolygon:gs,polygonCenter:ds,centroid:fn};function ms(n,u){if(!u||!n.length)return n.slice();var f=u*u;return n=Tr(n,f),n=Cr(n,f),n}function Sr(n,u,f){return Math.sqrt(xi(n,u,f,!0))}function go(n,u,f){return xi(n,u,f)}function Cr(n,u){var f=n.length,y=typeof Uint8Array<"u"?Uint8Array:Array,k=new y(f);k[0]=k[f-1]=1,Vi(n,k,u,0,f-1);var T,K=[];for(T=0;T<f;T++)k[T]&&K.push(n[T]);return K}function Vi(n,u,f,y,k){var T=0,K,it,st;for(it=y+1;it<=k-1;it++)st=xi(n[it],n[y],n[k],!0),st>T&&(K=it,T=st);T>f&&(u[K]=1,Vi(n,u,f,y,K),Vi(n,u,f,K,k))}function Tr(n,u){for(var f=[n[0]],y=1,k=0,T=n.length;y<T;y++)_i(n[y],n[k])>u&&(f.push(n[y]),k=y);return k<T-1&&f.push(n[T-1]),f}var Nr;function Be(n,u,f,y,k){var T=y?Nr:ue(n,f),K=ue(u,f),it,st,dt;for(Nr=K;;){if(!(T|K))return[n,u];if(T&K)return!1;it=T||K,st=vi(n,u,it,f,k),dt=ue(st,f),it===T?(n=st,T=dt):(u=st,K=dt)}}function vi(n,u,f,y,k){var T=u.x-n.x,K=u.y-n.y,it=y.min,st=y.max,dt,wt;return f&8?(dt=n.x+T*(st.y-n.y)/K,wt=st.y):f&4?(dt=n.x+T*(it.y-n.y)/K,wt=it.y):f&2?(dt=st.x,wt=n.y+K*(st.x-n.x)/T):f&1&&(dt=it.x,wt=n.y+K*(it.x-n.x)/T),new U(dt,wt,k)}function ue(n,u){var f=0;return n.x<u.min.x?f|=1:n.x>u.max.x&&(f|=2),n.y<u.min.y?f|=4:n.y>u.max.y&&(f|=8),f}function _i(n,u){var f=u.x-n.x,y=u.y-n.y;return f*f+y*y}function xi(n,u,f,y){var k=u.x,T=u.y,K=f.x-k,it=f.y-T,st=K*K+it*it,dt;return st>0&&(dt=((n.x-k)*K+(n.y-T)*it)/st,dt>1?(k=f.x,T=f.y):dt>0&&(k+=K*dt,T+=it*dt)),K=n.x-k,it=n.y-T,y?K*K+it*it:new U(k,T)}function Ae(n){return!G(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function br(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ae(n)}function Or(n,u){var f,y,k,T,K,it,st,dt;if(!n||n.length===0)throw new Error("latlngs not passed");Ae(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var wt=ft([0,0]),Nt=at(n),qt=Nt.getNorthWest().distanceTo(Nt.getSouthWest())*Nt.getNorthEast().distanceTo(Nt.getNorthWest());qt<1700&&(wt=fn(n));var Re=n.length,ve=[];for(f=0;f<Re;f++){var rn=ft(n[f]);ve.push(u.project(ft([rn.lat-wt.lat,rn.lng-wt.lng])))}for(f=0,y=0;f<Re-1;f++)y+=ve[f].distanceTo(ve[f+1])/2;if(y===0)dt=ve[0];else for(f=0,T=0;f<Re-1;f++)if(K=ve[f],it=ve[f+1],k=K.distanceTo(it),T+=k,T>y){st=(T-y)/k,dt=[it.x-st*(it.x-K.x),it.y-st*(it.y-K.y)];break}var ze=u.unproject(W(dt));return ft([ze.lat+wt.lat,ze.lng+wt.lng])}var Ar={__proto__:null,simplify:ms,pointToSegmentDistance:Sr,closestPointOnSegment:go,clipSegment:Be,_getEdgeIntersection:vi,_getBitCode:ue,_sqClosestPointOnSegment:xi,isFlat:Ae,_flat:br,polylineCenter:Or},Rr={project:function(n){return new U(n.lng,n.lat)},unproject:function(n){return new ct(n.y,n.x)},bounds:new rt([-180,-90],[180,90])},Dr={R:6378137,R_MINOR:6356752314245179e-9,bounds:new rt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var u=Math.PI/180,f=this.R,y=n.lat*u,k=this.R_MINOR/f,T=Math.sqrt(1-k*k),K=T*Math.sin(y),it=Math.tan(Math.PI/4-y/2)/Math.pow((1-K)/(1+K),T/2);return y=-f*Math.log(Math.max(it,1e-10)),new U(n.lng*u*f,y)},unproject:function(n){for(var u=180/Math.PI,f=this.R,y=this.R_MINOR/f,k=Math.sqrt(1-y*y),T=Math.exp(-n.y/f),K=Math.PI/2-2*Math.atan(T),it=0,st=.1,dt;it<15&&Math.abs(st)>1e-7;it++)dt=k*Math.sin(K),dt=Math.pow((1-dt)/(1+dt),k/2),st=Math.PI/2-2*Math.atan(T*dt)-K,K+=st;return new ct(K*u,n.x*u/f)}},mo={__proto__:null,LonLat:Rr,Mercator:Dr,SphericalMercator:Ct},po=l({},Q,{code:"EPSG:3395",projection:Dr,transformation:function(){var n=.5/(Math.PI*Dr.R);return Z(n,.5,-n,.5)}()}),ps=l({},Q,{code:"EPSG:4326",projection:Rr,transformation:Z(1/180,1,-1/180,.5)}),yo=l({},kt,{projection:Rr,transformation:Z(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,u){var f=u.lng-n.lng,y=u.lat-n.lat;return Math.sqrt(f*f+y*y)},infinite:!0});kt.Earth=Q,kt.EPSG3395=po,kt.EPSG3857=At,kt.EPSG900913=Gt,kt.EPSG4326=ps,kt.Simple=yo;var Ze=j.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[_(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[_(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var u=n.target;if(u.hasLayer(this)){if(this._map=u,this._zoomAnimated=u._zoomAnimated,this.getEvents){var f=this.getEvents();u.on(f,this),this.once("remove",function(){u.off(f,this)},this)}this.onAdd(u),this.fire("add"),u.fire("layeradd",{layer:this})}}});Dt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var u=_(n);return this._layers[u]?this:(this._layers[u]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var u=_(n);return this._layers[u]?(this._loaded&&n.onRemove(this),delete this._layers[u],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return _(n)in this._layers},eachLayer:function(n,u){for(var f in this._layers)n.call(u,this._layers[f]);return this},_addLayers:function(n){n=n?G(n)?n:[n]:[];for(var u=0,f=n.length;u<f;u++)this.addLayer(n[u])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[_(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var u=_(n);this._zoomBoundLayers[u]&&(delete this._zoomBoundLayers[u],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,u=-1/0,f=this._getZoomSpan();for(var y in this._zoomBoundLayers){var k=this._zoomBoundLayers[y].options;n=k.minZoom===void 0?n:Math.min(n,k.minZoom),u=k.maxZoom===void 0?u:Math.max(u,k.maxZoom)}this._layersMaxZoom=u===-1/0?void 0:u,this._layersMinZoom=n===1/0?void 0:n,f!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var jn=Ze.extend({initialize:function(n,u){et(this,u),this._layers={};var f,y;if(n)for(f=0,y=n.length;f<y;f++)this.addLayer(n[f])},addLayer:function(n){var u=this.getLayerId(n);return this._layers[u]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var u=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[u]&&this._map.removeLayer(this._layers[u]),delete this._layers[u],this},hasLayer:function(n){var u=typeof n=="number"?n:this.getLayerId(n);return u in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var u=Array.prototype.slice.call(arguments,1),f,y;for(f in this._layers)y=this._layers[f],y[n]&&y[n].apply(y,u);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,u){for(var f in this._layers)n.call(u,this._layers[f]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return _(n)}}),ys=function(n,u){return new jn(n,u)},gn=jn.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),jn.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),jn.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new mt;for(var u in this._layers){var f=this._layers[u];n.extend(f.getBounds?f.getBounds():f.getLatLng())}return n}}),vs=function(n,u){return new gn(n,u)},$n=q.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){et(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,u){var f=this._getIconUrl(n);if(!f){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var y=this._createImg(f,u&&u.tagName==="IMG"?u:null);return this._setIconStyles(y,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),y},_setIconStyles:function(n,u){var f=this.options,y=f[u+"Size"];typeof y=="number"&&(y=[y,y]);var k=W(y),T=W(u==="shadow"&&f.shadowAnchor||f.iconAnchor||k&&k.divideBy(2,!0));n.className="leaflet-marker-"+u+" "+(f.className||""),T&&(n.style.marginLeft=-T.x+"px",n.style.marginTop=-T.y+"px"),k&&(n.style.width=k.x+"px",n.style.height=k.y+"px")},_createImg:function(n,u){return u=u||document.createElement("img"),u.src=n,u},_getIconUrl:function(n){return Pt.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function vo(n){return new $n(n)}var ki=$n.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof ki.imagePath!="string"&&(ki.imagePath=this._detectIconPath()),(this.options.imagePath||ki.imagePath)+$n.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var u=function(f,y,k){var T=y.exec(f);return T&&T[k]};return n=u(n,/^url\((['"])?(.+)\1\)$/,2),n&&u(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=Zt("div","leaflet-default-icon-path",document.body),u=Ke(n,"background-image")||Ke(n,"backgroundImage");if(document.body.removeChild(n),u=this._stripUrl(u),u)return u;var f=document.querySelector('link[href$="leaflet.css"]');return f?f.href.substring(0,f.href.length-11-1):""}}),_s=Qe.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new wn(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ot(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Wt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var u=this._marker,f=u._map,y=this._marker.options.autoPanSpeed,k=this._marker.options.autoPanPadding,T=_n(u._icon),K=f.getPixelBounds(),it=f.getPixelOrigin(),st=ht(K.min._subtract(it).add(k),K.max._subtract(it).subtract(k));if(!st.contains(T)){var dt=W((Math.max(st.max.x,T.x)-st.max.x)/(K.max.x-st.max.x)-(Math.min(st.min.x,T.x)-st.min.x)/(K.min.x-st.min.x),(Math.max(st.max.y,T.y)-st.max.y)/(K.max.y-st.max.y)-(Math.min(st.min.y,T.y)-st.min.y)/(K.min.y-st.min.y)).multiplyBy(y);f.panBy(dt,{animate:!1}),this._draggable._newPos._add(dt),this._draggable._startPos._add(dt),oe(u._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=A(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(O(this._panRequest),this._panRequest=A(this._adjustPan.bind(this,n)))},_onDrag:function(n){var u=this._marker,f=u._shadow,y=_n(u._icon),k=u._map.layerPointToLatLng(y);f&&oe(f,y),u._latlng=k,n.latlng=k,n.oldLatLng=this._oldLatLng,u.fire("move",n).fire("drag",n)},_onDragEnd:function(n){O(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),Wi=Ze.extend({options:{icon:new ki,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,u){et(this,u),this._latlng=ft(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var u=this._latlng;return this._latlng=ft(n),this.update(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,u="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),f=n.icon.createIcon(this._icon),y=!1;f!==this._icon&&(this._icon&&this._removeIcon(),y=!0,n.title&&(f.title=n.title),f.tagName==="IMG"&&(f.alt=n.alt||"")),Ot(f,u),n.keyboard&&(f.tabIndex="0",f.setAttribute("role","button")),this._icon=f,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Rt(f,"focus",this._panOnFocus,this);var k=n.icon.createShadow(this._shadow),T=!1;k!==this._shadow&&(this._removeShadow(),T=!0),k&&(Ot(k,u),k.alt=""),this._shadow=k,n.opacity<1&&this._updateOpacity(),y&&this.getPane().appendChild(this._icon),this._initInteraction(),k&&T&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Jt(this._icon,"focus",this._panOnFocus,this),Qt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Qt(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&oe(this._icon,n),this._shadow&&oe(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var u=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(u)},_initInteraction:function(){if(this.options.interactive&&(Ot(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),_s)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new _s(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&fe(this._icon,n),this._shadow&&fe(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var u=this.options.icon.options,f=u.iconSize?W(u.iconSize):W(0,0),y=u.iconAnchor?W(u.iconAnchor):W(0,0);n.panInside(this._latlng,{paddingTopLeft:y,paddingBottomRight:f.subtract(y)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function _o(n,u){return new Wi(n,u)}var En=Ze.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return et(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),wi=En.extend({options:{fill:!0,radius:10},initialize:function(n,u){et(this,u),this._latlng=ft(n),this._radius=this.options.radius},setLatLng:function(n){var u=this._latlng;return this._latlng=ft(n),this.redraw(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var u=n&&n.radius||this._radius;return En.prototype.setStyle.call(this,n),this.setRadius(u),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,u=this._radiusY||n,f=this._clickTolerance(),y=[n+f,u+f];this._pxBounds=new rt(this._point.subtract(y),this._point.add(y))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function xs(n,u){return new wi(n,u)}var Ki=wi.extend({initialize:function(n,u,f){if(typeof u=="number"&&(u=l({},f,{radius:u})),et(this,u),this._latlng=ft(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new mt(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:En.prototype.setStyle,_project:function(){var n=this._latlng.lng,u=this._latlng.lat,f=this._map,y=f.options.crs;if(y.distance===Q.distance){var k=Math.PI/180,T=this._mRadius/Q.R/k,K=f.project([u+T,n]),it=f.project([u-T,n]),st=K.add(it).divideBy(2),dt=f.unproject(st).lat,wt=Math.acos((Math.cos(T*k)-Math.sin(u*k)*Math.sin(dt*k))/(Math.cos(u*k)*Math.cos(dt*k)))/k;(isNaN(wt)||wt===0)&&(wt=T/Math.cos(Math.PI/180*u)),this._point=st.subtract(f.getPixelOrigin()),this._radius=isNaN(wt)?0:st.x-f.project([dt,n-wt]).x,this._radiusY=st.y-K.y}else{var Nt=y.unproject(y.project(this._latlng).subtract([this._mRadius,0]));this._point=f.latLngToLayerPoint(this._latlng),this._radius=this._point.x-f.latLngToLayerPoint(Nt).x}this._updateBounds()}});function xo(n,u,f){return new Ki(n,u,f)}var tn=En.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,u){et(this,u),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var u=1/0,f=null,y=xi,k,T,K=0,it=this._parts.length;K<it;K++)for(var st=this._parts[K],dt=1,wt=st.length;dt<wt;dt++){k=st[dt-1],T=st[dt];var Nt=y(n,k,T,!0);Nt<u&&(u=Nt,f=y(n,k,T))}return f&&(f.distance=Math.sqrt(u)),f},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Or(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,u){return u=u||this._defaultShape(),n=ft(n),u.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new mt,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return Ae(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var u=[],f=Ae(n),y=0,k=n.length;y<k;y++)f?(u[y]=ft(n[y]),this._bounds.extend(u[y])):u[y]=this._convertLatLngs(n[y]);return u},_project:function(){var n=new rt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),u=new U(n,n);this._rawPxBounds&&(this._pxBounds=new rt([this._rawPxBounds.min.subtract(u),this._rawPxBounds.max.add(u)]))},_projectLatlngs:function(n,u,f){var y=n[0]instanceof ct,k=n.length,T,K;if(y){for(K=[],T=0;T<k;T++)K[T]=this._map.latLngToLayerPoint(n[T]),f.extend(K[T]);u.push(K)}else for(T=0;T<k;T++)this._projectLatlngs(n[T],u,f)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var u=this._parts,f,y,k,T,K,it,st;for(f=0,k=0,T=this._rings.length;f<T;f++)for(st=this._rings[f],y=0,K=st.length;y<K-1;y++)it=Be(st[y],st[y+1],n,y,!0),it&&(u[k]=u[k]||[],u[k].push(it[0]),(it[1]!==st[y+1]||y===K-2)&&(u[k].push(it[1]),k++))}},_simplifyPoints:function(){for(var n=this._parts,u=this.options.smoothFactor,f=0,y=n.length;f<y;f++)n[f]=ms(n[f],u)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,u){var f,y,k,T,K,it,st=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(f=0,T=this._parts.length;f<T;f++)for(it=this._parts[f],y=0,K=it.length,k=K-1;y<K;k=y++)if(!(!u&&y===0)&&Sr(n,it[k],it[y])<=st)return!0;return!1}});function Fr(n,u){return new tn(n,u)}tn._flat=br;var Qn=tn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ds(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var u=tn.prototype._convertLatLngs.call(this,n),f=u.length;return f>=2&&u[0]instanceof ct&&u[0].equals(u[f-1])&&u.pop(),u},_setLatLngs:function(n){tn.prototype._setLatLngs.call(this,n),Ae(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ae(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,u=this.options.weight,f=new U(u,u);if(n=new rt(n.min.subtract(f),n.max.add(f)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var y=0,k=this._rings.length,T;y<k;y++)T=gs(this._rings[y],n,!0),T.length&&this._parts.push(T)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var u=!1,f,y,k,T,K,it,st,dt;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(T=0,st=this._parts.length;T<st;T++)for(f=this._parts[T],K=0,dt=f.length,it=dt-1;K<dt;it=K++)y=f[K],k=f[it],y.y>n.y!=k.y>n.y&&n.x<(k.x-y.x)*(n.y-y.y)/(k.y-y.y)+y.x&&(u=!u);return u||tn.prototype._containsPoint.call(this,n,!0)}});function ks(n,u){return new Qn(n,u)}var en=gn.extend({initialize:function(n,u){et(this,u),this._layers={},n&&this.addData(n)},addData:function(n){var u=G(n)?n:n.features,f,y,k;if(u){for(f=0,y=u.length;f<y;f++)k=u[f],(k.geometries||k.geometry||k.features||k.coordinates)&&this.addData(k);return this}var T=this.options;if(T.filter&&!T.filter(n))return this;var K=Ji(n,T);return K?(K.feature=s(n),K.defaultOptions=K.options,this.resetStyle(K),T.onEachFeature&&T.onEachFeature(n,K),this.addLayer(K)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=l({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(u){this._setLayerStyle(u,n)},this)},_setLayerStyle:function(n,u){n.setStyle&&(typeof u=="function"&&(u=u(n.feature)),n.setStyle(u))}});function Ji(n,u){var f=n.type==="Feature"?n.geometry:n,y=f?f.coordinates:null,k=[],T=u&&u.pointToLayer,K=u&&u.coordsToLatLng||Pn,it,st,dt,wt;if(!y&&!f)return null;switch(f.type){case"Point":return it=K(y),ws(T,n,it,u);case"MultiPoint":for(dt=0,wt=y.length;dt<wt;dt++)it=K(y[dt]),k.push(ws(T,n,it,u));return new gn(k);case"LineString":case"MultiLineString":return st=ji(y,f.type==="LineString"?0:1,K),new tn(st,u);case"Polygon":case"MultiPolygon":return st=ji(y,f.type==="Polygon"?1:2,K),new Qn(st,u);case"GeometryCollection":for(dt=0,wt=f.geometries.length;dt<wt;dt++){var Nt=Ji({geometry:f.geometries[dt],type:"Feature",properties:n.properties},u);Nt&&k.push(Nt)}return new gn(k);case"FeatureCollection":for(dt=0,wt=f.features.length;dt<wt;dt++){var qt=Ji(f.features[dt],u);qt&&k.push(qt)}return new gn(k);default:throw new Error("Invalid GeoJSON object.")}}function ws(n,u,f,y){return n?n(u,f):new Wi(f,y&&y.markersInheritOptions&&y)}function Pn(n){return new ct(n[1],n[0],n[2])}function ji(n,u,f){for(var y=[],k=0,T=n.length,K;k<T;k++)K=u?ji(n[k],u-1,f):(f||Pn)(n[k]),y.push(K);return y}function $i(n,u){return n=ft(n),n.alt!==void 0?[b(n.lng,u),b(n.lat,u),b(n.alt,u)]:[b(n.lng,u),b(n.lat,u)]}function Pe(n,u,f,y){for(var k=[],T=0,K=n.length;T<K;T++)k.push(u?Pe(n[T],Ae(n[T])?0:u-1,f,y):$i(n[T],y));return!u&&f&&k.length>0&&k.push(k[0].slice()),k}function Ie(n,u){return n.feature?l({},n.feature,{geometry:u}):s(u)}function s(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var t={toGeoJSON:function(n){return Ie(this,{type:"Point",coordinates:$i(this.getLatLng(),n)})}};Wi.include(t),Ki.include(t),wi.include(t),tn.include({toGeoJSON:function(n){var u=!Ae(this._latlngs),f=Pe(this._latlngs,u?1:0,!1,n);return Ie(this,{type:(u?"Multi":"")+"LineString",coordinates:f})}}),Qn.include({toGeoJSON:function(n){var u=!Ae(this._latlngs),f=u&&!Ae(this._latlngs[0]),y=Pe(this._latlngs,f?2:u?1:0,!0,n);return u||(y=[y]),Ie(this,{type:(f?"Multi":"")+"Polygon",coordinates:y})}}),jn.include({toMultiPoint:function(n){var u=[];return this.eachLayer(function(f){u.push(f.toGeoJSON(n).geometry.coordinates)}),Ie(this,{type:"MultiPoint",coordinates:u})},toGeoJSON:function(n){var u=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(u==="MultiPoint")return this.toMultiPoint(n);var f=u==="GeometryCollection",y=[];return this.eachLayer(function(k){if(k.toGeoJSON){var T=k.toGeoJSON(n);if(f)y.push(T.geometry);else{var K=s(T);K.type==="FeatureCollection"?y.push.apply(y,K.features):y.push(K)}}}),f?Ie(this,{geometries:y,type:"GeometryCollection"}):{type:"FeatureCollection",features:y}}});function e(n,u){return new en(n,u)}var r=e,c=Ze.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,u,f){this._url=n,this._bounds=at(u),et(this,f)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ot(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Qt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Xn(this._image),this},bringToBack:function(){return this._map&&An(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=at(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",u=this._image=n?this._url:Zt("img");if(Ot(u,"leaflet-image-layer"),this._zoomAnimated&&Ot(u,"leaflet-zoom-animated"),this.options.className&&Ot(u,this.options.className),u.onselectstart=I,u.onmousemove=I,u.onload=d(this.fire,this,"load"),u.onerror=d(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=u.src;return}u.src=this._url,u.alt=this.options.alt},_animateZoom:function(n){var u=this._map.getZoomScale(n.zoom),f=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;Rn(this._image,f,u)},_reset:function(){var n=this._image,u=new rt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),f=u.getSize();oe(n,u.min),n.style.width=f.x+"px",n.style.height=f.y+"px"},_updateOpacity:function(){fe(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),p=function(n,u,f){return new c(n,u,f)},v=c.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",u=this._image=n?this._url:Zt("video");if(Ot(u,"leaflet-image-layer"),this._zoomAnimated&&Ot(u,"leaflet-zoom-animated"),this.options.className&&Ot(u,this.options.className),u.onselectstart=I,u.onmousemove=I,u.onloadeddata=d(this.fire,this,"load"),n){for(var f=u.getElementsByTagName("source"),y=[],k=0;k<f.length;k++)y.push(f[k].src);this._url=f.length>0?y:[u.src];return}G(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(u.style,"objectFit")&&(u.style.objectFit="fill"),u.autoplay=!!this.options.autoplay,u.loop=!!this.options.loop,u.muted=!!this.options.muted,u.playsInline=!!this.options.playsInline;for(var T=0;T<this._url.length;T++){var K=Zt("source");K.src=this._url[T],u.appendChild(K)}}});function E(n,u,f){return new v(n,u,f)}var C=c.extend({_initImage:function(){var n=this._image=this._url;Ot(n,"leaflet-image-layer"),this._zoomAnimated&&Ot(n,"leaflet-zoom-animated"),this.options.className&&Ot(n,this.options.className),n.onselectstart=I,n.onmousemove=I}});function D(n,u,f){return new C(n,u,f)}var $=Ze.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,u){n&&(n instanceof ct||G(n))?(this._latlng=ft(n),et(this,u)):(et(this,n),this._source=u),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&fe(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&fe(this._container,1),this.bringToFront(),this.options.interactive&&(Ot(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(fe(this._container,0),this._removeTimeout=setTimeout(d(Qt,void 0,this._container),200)):Qt(this._container),this.options.interactive&&(Wt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=ft(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Xn(this._container),this},bringToBack:function(){return this._map&&An(this._container),this},_prepareOpen:function(n){var u=this._source;if(!u._map)return!1;if(u instanceof gn){u=null;var f=this._source._layers;for(var y in f)if(f[y]._map){u=f[y];break}if(!u)return!1;this._source=u}if(!n)if(u.getCenter)n=u.getCenter();else if(u.getLatLng)n=u.getLatLng();else if(u.getBounds)n=u.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,u=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof u=="string")n.innerHTML=u;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(u)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),u=W(this.options.offset),f=this._getAnchor();this._zoomAnimated?oe(this._container,n.add(f)):u=u.add(n).add(f);var y=this._containerBottom=-u.y,k=this._containerLeft=-Math.round(this._containerWidth/2)+u.x;this._container.style.bottom=y+"px",this._container.style.left=k+"px"}},_getAnchor:function(){return[0,0]}});Dt.include({_initOverlay:function(n,u,f,y){var k=u;return k instanceof n||(k=new n(y).setContent(u)),f&&k.setLatLng(f),k}}),Ze.include({_initOverlay:function(n,u,f,y){var k=f;return k instanceof n?(et(k,y),k._source=this):(k=u&&!y?u:new n(y,this),k.setContent(f)),k}});var nt=$.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,$.prototype.openOn.call(this,n)},onAdd:function(n){$.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof En||this._source.on("preclick",me))},onRemove:function(n){$.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof En||this._source.off("preclick",me))},getEvents:function(){var n=$.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",u=this._container=Zt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),f=this._wrapper=Zt("div",n+"-content-wrapper",u);if(this._contentNode=Zt("div",n+"-content",f),Jn(u),yi(this._contentNode),Rt(u,"contextmenu",me),this._tipContainer=Zt("div",n+"-tip-container",u),this._tip=Zt("div",n+"-tip",this._tipContainer),this.options.closeButton){var y=this._closeButton=Zt("a",n+"-close-button",u);y.setAttribute("role","button"),y.setAttribute("aria-label","Close popup"),y.href="#close",y.innerHTML='<span aria-hidden="true">&#215;</span>',Rt(y,"click",function(k){ee(k),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,u=n.style;u.width="",u.whiteSpace="nowrap";var f=n.offsetWidth;f=Math.min(f,this.options.maxWidth),f=Math.max(f,this.options.minWidth),u.width=f+1+"px",u.whiteSpace="",u.height="";var y=n.offsetHeight,k=this.options.maxHeight,T="leaflet-popup-scrolled";k&&y>k?(u.height=k+"px",Ot(n,T)):Wt(n,T),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var u=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),f=this._getAnchor();oe(this._container,u.add(f))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,u=parseInt(Ke(this._container,"marginBottom"),10)||0,f=this._container.offsetHeight+u,y=this._containerWidth,k=new U(this._containerLeft,-f-this._containerBottom);k._add(_n(this._container));var T=n.layerPointToContainerPoint(k),K=W(this.options.autoPanPadding),it=W(this.options.autoPanPaddingTopLeft||K),st=W(this.options.autoPanPaddingBottomRight||K),dt=n.getSize(),wt=0,Nt=0;T.x+y+st.x>dt.x&&(wt=T.x+y-dt.x+st.x),T.x-wt-it.x<0&&(wt=T.x-it.x),T.y+f+st.y>dt.y&&(Nt=T.y+f-dt.y+st.y),T.y-Nt-it.y<0&&(Nt=T.y-it.y),(wt||Nt)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([wt,Nt]))}},_getAnchor:function(){return W(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),gt=function(n,u){return new nt(n,u)};Dt.mergeOptions({closePopupOnClick:!0}),Dt.include({openPopup:function(n,u,f){return this._initOverlay(nt,n,u,f).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),Ze.include({bindPopup:function(n,u){return this._popup=this._initOverlay(nt,this._popup,n,u),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof gn||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){xn(n);var u=n.layer||n.target;if(this._popup._source===u&&!(u instanceof En)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=u,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var xt=$.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){$.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){$.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=$.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",u=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Zt("div",u),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+_(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var u,f,y=this._map,k=this._container,T=y.latLngToContainerPoint(y.getCenter()),K=y.layerPointToContainerPoint(n),it=this.options.direction,st=k.offsetWidth,dt=k.offsetHeight,wt=W(this.options.offset),Nt=this._getAnchor();it==="top"?(u=st/2,f=dt):it==="bottom"?(u=st/2,f=0):it==="center"?(u=st/2,f=dt/2):it==="right"?(u=0,f=dt/2):it==="left"?(u=st,f=dt/2):K.x<T.x?(it="right",u=0,f=dt/2):(it="left",u=st+(wt.x+Nt.x)*2,f=dt/2),n=n.subtract(W(u,f,!0)).add(wt).add(Nt),Wt(k,"leaflet-tooltip-right"),Wt(k,"leaflet-tooltip-left"),Wt(k,"leaflet-tooltip-top"),Wt(k,"leaflet-tooltip-bottom"),Ot(k,"leaflet-tooltip-"+it),oe(k,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&fe(this._container,n)},_animateZoom:function(n){var u=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(u)},_getAnchor:function(){return W(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Et=function(n,u){return new xt(n,u)};Dt.include({openTooltip:function(n,u,f){return this._initOverlay(xt,n,u,f).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),Ze.include({bindTooltip:function(n,u){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(xt,this._tooltip,n,u),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var u=n?"off":"on",f={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?f.add=this._openTooltip:(f.mouseover=this._openTooltip,f.mouseout=this.closeTooltip,f.click=this._openTooltip,this._map?this._addFocusListeners():f.add=this._addFocusListeners),this._tooltip.options.sticky&&(f.mousemove=this._moveTooltip),this[u](f),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof gn||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var u=typeof n.getElement=="function"&&n.getElement();u&&(Rt(u,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),Rt(u,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var u=typeof n.getElement=="function"&&n.getElement();u&&u.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var u=this;this._map.once("moveend",function(){u._openOnceFlag=!1,u._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var u=n.latlng,f,y;this._tooltip.options.sticky&&n.originalEvent&&(f=this._map.mouseEventToContainerPoint(n.originalEvent),y=this._map.containerPointToLayerPoint(f),u=this._map.layerPointToLatLng(y)),this._tooltip.setLatLng(u)}});var It=$n.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var u=n&&n.tagName==="DIV"?n:document.createElement("div"),f=this.options;if(f.html instanceof Element?(zi(u),u.appendChild(f.html)):u.innerHTML=f.html!==!1?f.html:"",f.bgPos){var y=W(f.bgPos);u.style.backgroundPosition=-y.x+"px "+-y.y+"px"}return this._setIconStyles(u,"icon"),u},createShadow:function(){return null}});function Ut(n){return new It(n)}$n.Default=ki;var zt=Ze.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Pt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){et(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),Qt(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Xn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(An(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=x(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof U?n:new U(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var u=this.getPane().children,f=-n(-1/0,1/0),y=0,k=u.length,T;y<k;y++)T=u[y].style.zIndex,u[y]!==this._container&&T&&(f=n(f,+T));isFinite(f)&&(this.options.zIndex=f+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Pt.ielt9){fe(this._container,this.options.opacity);var n=+new Date,u=!1,f=!1;for(var y in this._tiles){var k=this._tiles[y];if(!(!k.current||!k.loaded)){var T=Math.min(1,(n-k.loaded)/200);fe(k.el,T),T<1?u=!0:(k.active?f=!0:this._onOpaqueTile(k),k.active=!0)}}f&&!this._noPrune&&this._pruneTiles(),u&&(O(this._fadeFrame),this._fadeFrame=A(this._updateOpacity,this))}},_onOpaqueTile:I,_initContainer:function(){this._container||(this._container=Zt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,u=this.options.maxZoom;if(n!==void 0){for(var f in this._levels)f=Number(f),this._levels[f].el.children.length||f===n?(this._levels[f].el.style.zIndex=u-Math.abs(n-f),this._onUpdateLevel(f)):(Qt(this._levels[f].el),this._removeTilesAtZoom(f),this._onRemoveLevel(f),delete this._levels[f]);var y=this._levels[n],k=this._map;return y||(y=this._levels[n]={},y.el=Zt("div","leaflet-tile-container leaflet-zoom-animated",this._container),y.el.style.zIndex=u,y.origin=k.project(k.unproject(k.getPixelOrigin()),n).round(),y.zoom=n,this._setZoomTransform(y,k.getCenter(),k.getZoom()),I(y.el.offsetWidth),this._onCreateLevel(y)),this._level=y,y}},_onUpdateLevel:I,_onRemoveLevel:I,_onCreateLevel:I,_pruneTiles:function(){if(this._map){var n,u,f=this._map.getZoom();if(f>this.options.maxZoom||f<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)u=this._tiles[n],u.retain=u.current;for(n in this._tiles)if(u=this._tiles[n],u.current&&!u.active){var y=u.coords;this._retainParent(y.x,y.y,y.z,y.z-5)||this._retainChildren(y.x,y.y,y.z,y.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var u in this._tiles)this._tiles[u].coords.z===n&&this._removeTile(u)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)Qt(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,u,f,y){var k=Math.floor(n/2),T=Math.floor(u/2),K=f-1,it=new U(+k,+T);it.z=+K;var st=this._tileCoordsToKey(it),dt=this._tiles[st];return dt&&dt.active?(dt.retain=!0,!0):(dt&&dt.loaded&&(dt.retain=!0),K>y?this._retainParent(k,T,K,y):!1)},_retainChildren:function(n,u,f,y){for(var k=2*n;k<2*n+2;k++)for(var T=2*u;T<2*u+2;T++){var K=new U(k,T);K.z=f+1;var it=this._tileCoordsToKey(K),st=this._tiles[it];if(st&&st.active){st.retain=!0;continue}else st&&st.loaded&&(st.retain=!0);f+1<y&&this._retainChildren(k,T,f+1,y)}},_resetView:function(n){var u=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),u,u)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var u=this.options;return u.minNativeZoom!==void 0&&n<u.minNativeZoom?u.minNativeZoom:u.maxNativeZoom!==void 0&&u.maxNativeZoom<n?u.maxNativeZoom:n},_setView:function(n,u,f,y){var k=Math.round(u);this.options.maxZoom!==void 0&&k>this.options.maxZoom||this.options.minZoom!==void 0&&k<this.options.minZoom?k=void 0:k=this._clampZoom(k);var T=this.options.updateWhenZooming&&k!==this._tileZoom;(!y||T)&&(this._tileZoom=k,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),k!==void 0&&this._update(n),f||this._pruneTiles(),this._noPrune=!!f),this._setZoomTransforms(n,u)},_setZoomTransforms:function(n,u){for(var f in this._levels)this._setZoomTransform(this._levels[f],n,u)},_setZoomTransform:function(n,u,f){var y=this._map.getZoomScale(f,n.zoom),k=n.origin.multiplyBy(y).subtract(this._map._getNewPixelOrigin(u,f)).round();Pt.any3d?Rn(n.el,k,y):oe(n.el,k)},_resetGrid:function(){var n=this._map,u=n.options.crs,f=this._tileSize=this.getTileSize(),y=this._tileZoom,k=this._map.getPixelWorldBounds(this._tileZoom);k&&(this._globalTileRange=this._pxBoundsToTileRange(k)),this._wrapX=u.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,u.wrapLng[0]],y).x/f.x),Math.ceil(n.project([0,u.wrapLng[1]],y).x/f.y)],this._wrapY=u.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([u.wrapLat[0],0],y).y/f.x),Math.ceil(n.project([u.wrapLat[1],0],y).y/f.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var u=this._map,f=u._animatingZoom?Math.max(u._animateToZoom,u.getZoom()):u.getZoom(),y=u.getZoomScale(f,this._tileZoom),k=u.project(n,this._tileZoom).floor(),T=u.getSize().divideBy(y*2);return new rt(k.subtract(T),k.add(T))},_update:function(n){var u=this._map;if(u){var f=this._clampZoom(u.getZoom());if(n===void 0&&(n=u.getCenter()),this._tileZoom!==void 0){var y=this._getTiledPixelBounds(n),k=this._pxBoundsToTileRange(y),T=k.getCenter(),K=[],it=this.options.keepBuffer,st=new rt(k.getBottomLeft().subtract([it,-it]),k.getTopRight().add([it,-it]));if(!(isFinite(k.min.x)&&isFinite(k.min.y)&&isFinite(k.max.x)&&isFinite(k.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var dt in this._tiles){var wt=this._tiles[dt].coords;(wt.z!==this._tileZoom||!st.contains(new U(wt.x,wt.y)))&&(this._tiles[dt].current=!1)}if(Math.abs(f-this._tileZoom)>1){this._setView(n,f);return}for(var Nt=k.min.y;Nt<=k.max.y;Nt++)for(var qt=k.min.x;qt<=k.max.x;qt++){var Re=new U(qt,Nt);if(Re.z=this._tileZoom,!!this._isValidTile(Re)){var ve=this._tiles[this._tileCoordsToKey(Re)];ve?ve.current=!0:K.push(Re)}}if(K.sort(function(ze,tr){return ze.distanceTo(T)-tr.distanceTo(T)}),K.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var rn=document.createDocumentFragment();for(qt=0;qt<K.length;qt++)this._addTile(K[qt],rn);this._level.el.appendChild(rn)}}}},_isValidTile:function(n){var u=this._map.options.crs;if(!u.infinite){var f=this._globalTileRange;if(!u.wrapLng&&(n.x<f.min.x||n.x>f.max.x)||!u.wrapLat&&(n.y<f.min.y||n.y>f.max.y))return!1}if(!this.options.bounds)return!0;var y=this._tileCoordsToBounds(n);return at(this.options.bounds).overlaps(y)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var u=this._map,f=this.getTileSize(),y=n.scaleBy(f),k=y.add(f),T=u.unproject(y,n.z),K=u.unproject(k,n.z);return[T,K]},_tileCoordsToBounds:function(n){var u=this._tileCoordsToNwSe(n),f=new mt(u[0],u[1]);return this.options.noWrap||(f=this._map.wrapLatLngBounds(f)),f},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var u=n.split(":"),f=new U(+u[0],+u[1]);return f.z=+u[2],f},_removeTile:function(n){var u=this._tiles[n];u&&(Qt(u.el),delete this._tiles[n],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){Ot(n,"leaflet-tile");var u=this.getTileSize();n.style.width=u.x+"px",n.style.height=u.y+"px",n.onselectstart=I,n.onmousemove=I,Pt.ielt9&&this.options.opacity<1&&fe(n,this.options.opacity)},_addTile:function(n,u){var f=this._getTilePos(n),y=this._tileCoordsToKey(n),k=this.createTile(this._wrapCoords(n),d(this._tileReady,this,n));this._initTile(k),this.createTile.length<2&&A(d(this._tileReady,this,n,null,k)),oe(k,f),this._tiles[y]={el:k,coords:n,current:!0},u.appendChild(k),this.fire("tileloadstart",{tile:k,coords:n})},_tileReady:function(n,u,f){u&&this.fire("tileerror",{error:u,tile:f,coords:n});var y=this._tileCoordsToKey(n);f=this._tiles[y],f&&(f.loaded=+new Date,this._map._fadeAnimated?(fe(f.el,0),O(this._fadeFrame),this._fadeFrame=A(this._updateOpacity,this)):(f.active=!0,this._pruneTiles()),u||(Ot(f.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:f.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Pt.ielt9||!this._map._fadeAnimated?A(this._pruneTiles,this):setTimeout(d(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var u=new U(this._wrapX?w(n.x,this._wrapX):n.x,this._wrapY?w(n.y,this._wrapY):n.y);return u.z=n.z,u},_pxBoundsToTileRange:function(n){var u=this.getTileSize();return new rt(n.min.unscaleBy(u).floor(),n.max.unscaleBy(u).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function jt(n){return new zt(n)}var te=zt.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,u){this._url=n,u=et(this,u),u.detectRetina&&Pt.retina&&u.maxZoom>0?(u.tileSize=Math.floor(u.tileSize/2),u.zoomReverse?(u.zoomOffset--,u.minZoom=Math.min(u.maxZoom,u.minZoom+1)):(u.zoomOffset++,u.maxZoom=Math.max(u.minZoom,u.maxZoom-1)),u.minZoom=Math.max(0,u.minZoom)):u.zoomReverse?u.minZoom=Math.min(u.maxZoom,u.minZoom):u.maxZoom=Math.max(u.minZoom,u.maxZoom),typeof u.subdomains=="string"&&(u.subdomains=u.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,u){return this._url===n&&u===void 0&&(u=!0),this._url=n,u||this.redraw(),this},createTile:function(n,u){var f=document.createElement("img");return Rt(f,"load",d(this._tileOnLoad,this,u,f)),Rt(f,"error",d(this._tileOnError,this,u,f)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(f.referrerPolicy=this.options.referrerPolicy),f.alt="",f.src=this.getTileUrl(n),f},getTileUrl:function(n){var u={r:Pt.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var f=this._globalTileRange.max.y-n.y;this.options.tms&&(u.y=f),u["-y"]=f}return S(this._url,l(u,this.options))},_tileOnLoad:function(n,u){Pt.ielt9?setTimeout(d(n,this,null,u),0):n(null,u)},_tileOnError:function(n,u,f){var y=this.options.errorTileUrl;y&&u.getAttribute("src")!==y&&(u.src=y),n(f,u)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,u=this.options.maxZoom,f=this.options.zoomReverse,y=this.options.zoomOffset;return f&&(n=u-n),n+y},_getSubdomain:function(n){var u=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[u]},_abortLoading:function(){var n,u;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(u=this._tiles[n].el,u.onload=I,u.onerror=I,!u.complete)){u.src=H;var f=this._tiles[n].coords;Qt(u),delete this._tiles[n],this.fire("tileabort",{tile:u,coords:f})}},_removeTile:function(n){var u=this._tiles[n];if(u)return u.el.setAttribute("src",H),zt.prototype._removeTile.call(this,n)},_tileReady:function(n,u,f){if(!(!this._map||f&&f.getAttribute("src")===H))return zt.prototype._tileReady.call(this,n,u,f)}});function ge(n,u){return new te(n,u)}var In=te.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,u){this._url=n;var f=l({},this.defaultWmsParams);for(var y in u)y in this.options||(f[y]=u[y]);u=et(this,u);var k=u.detectRetina&&Pt.retina?2:1,T=this.getTileSize();f.width=T.x*k,f.height=T.y*k,this.wmsParams=f},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var u=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[u]=this._crs.code,te.prototype.onAdd.call(this,n)},getTileUrl:function(n){var u=this._tileCoordsToNwSe(n),f=this._crs,y=ht(f.project(u[0]),f.project(u[1])),k=y.min,T=y.max,K=(this._wmsVersion>=1.3&&this._crs===ps?[k.y,k.x,T.y,T.x]:[k.x,k.y,T.x,T.y]).join(","),it=te.prototype.getTileUrl.call(this,n);return it+ot(this.wmsParams,it,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+K},setParams:function(n,u){return l(this.wmsParams,n),u||this.redraw(),this}});function Ei(n,u){return new In(n,u)}te.WMS=In,ge.wms=Ei;var nn=Ze.extend({options:{padding:.1},initialize:function(n){et(this,n),_(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ot(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,u){var f=this._map.getZoomScale(u,this._zoom),y=this._map.getSize().multiplyBy(.5+this.options.padding),k=this._map.project(this._center,u),T=y.multiplyBy(-f).add(k).subtract(this._map._getNewPixelOrigin(n,u));Pt.any3d?Rn(this._container,T,f):oe(this._container,T)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,u=this._map.getSize(),f=this._map.containerPointToLayerPoint(u.multiplyBy(-n)).round();this._bounds=new rt(f,f.add(u.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Br=nn.extend({options:{tolerance:0},getEvents:function(){var n=nn.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){nn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");Rt(n,"mousemove",this._onMouseMove,this),Rt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Rt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){O(this._redrawRequest),delete this._ctx,Qt(this._container),Jt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var u in this._layers)n=this._layers[u],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){nn.prototype._update.call(this);var n=this._bounds,u=this._container,f=n.getSize(),y=Pt.retina?2:1;oe(u,n.min),u.width=y*f.x,u.height=y*f.y,u.style.width=f.x+"px",u.style.height=f.y+"px",Pt.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){nn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[_(n)]=n;var u=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=u),this._drawLast=u,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var u=n._order,f=u.next,y=u.prev;f?f.prev=y:this._drawLast=y,y?y.next=f:this._drawFirst=f,delete n._order,delete this._layers[_(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var u=n.options.dashArray.split(/[, ]+/),f=[],y,k;for(k=0;k<u.length;k++){if(y=Number(u[k]),isNaN(y))return;f.push(y)}n.options._dashArray=f}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||A(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var u=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new rt,this._redrawBounds.extend(n._pxBounds.min.subtract([u,u])),this._redrawBounds.extend(n._pxBounds.max.add([u,u]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var u=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,u.x,u.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,u=this._redrawBounds;if(this._ctx.save(),u){var f=u.getSize();this._ctx.beginPath(),this._ctx.rect(u.min.x,u.min.y,f.x,f.y),this._ctx.clip()}this._drawing=!0;for(var y=this._drawFirst;y;y=y.next)n=y.layer,(!u||n._pxBounds&&n._pxBounds.intersects(u))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,u){if(this._drawing){var f,y,k,T,K=n._parts,it=K.length,st=this._ctx;if(it){for(st.beginPath(),f=0;f<it;f++){for(y=0,k=K[f].length;y<k;y++)T=K[f][y],st[y?"lineTo":"moveTo"](T.x,T.y);u&&st.closePath()}this._fillStroke(st,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var u=n._point,f=this._ctx,y=Math.max(Math.round(n._radius),1),k=(Math.max(Math.round(n._radiusY),1)||y)/y;k!==1&&(f.save(),f.scale(1,k)),f.beginPath(),f.arc(u.x,u.y/k,y,0,Math.PI*2,!1),k!==1&&f.restore(),this._fillStroke(f,n)}},_fillStroke:function(n,u){var f=u.options;f.fill&&(n.globalAlpha=f.fillOpacity,n.fillStyle=f.fillColor||f.color,n.fill(f.fillRule||"evenodd")),f.stroke&&f.weight!==0&&(n.setLineDash&&n.setLineDash(u.options&&u.options._dashArray||[]),n.globalAlpha=f.opacity,n.lineWidth=f.weight,n.strokeStyle=f.color,n.lineCap=f.lineCap,n.lineJoin=f.lineJoin,n.stroke())},_onClick:function(n){for(var u=this._map.mouseEventToLayerPoint(n),f,y,k=this._drawFirst;k;k=k.next)f=k.layer,f.options.interactive&&f._containsPoint(u)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(f))&&(y=f);this._fireEvent(y?[y]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var u=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,u)}},_handleMouseOut:function(n){var u=this._hoveredLayer;u&&(Wt(this._container,"leaflet-interactive"),this._fireEvent([u],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,u){if(!this._mouseHoverThrottled){for(var f,y,k=this._drawFirst;k;k=k.next)f=k.layer,f.options.interactive&&f._containsPoint(u)&&(y=f);y!==this._hoveredLayer&&(this._handleMouseOut(n),y&&(Ot(this._container,"leaflet-interactive"),this._fireEvent([y],n,"mouseover"),this._hoveredLayer=y)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(d(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,u,f){this._map._fireDOMEvent(u,f||u.type,n)},_bringToFront:function(n){var u=n._order;if(u){var f=u.next,y=u.prev;if(f)f.prev=y;else return;y?y.next=f:f&&(this._drawFirst=f),u.prev=this._drawLast,this._drawLast.next=u,u.next=null,this._drawLast=u,this._requestRedraw(n)}},_bringToBack:function(n){var u=n._order;if(u){var f=u.next,y=u.prev;if(y)y.next=f;else return;f?f.prev=y:y&&(this._drawLast=y),u.prev=null,u.next=this._drawFirst,this._drawFirst.prev=u,this._drawFirst=u,this._requestRedraw(n)}}});function zr(n){return Pt.canvas?new Br(n):null}var ti=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Es={_initContainer:function(){this._container=Zt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(nn.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var u=n._container=ti("shape");Ot(u,"leaflet-vml-shape "+(this.options.className||"")),u.coordsize="1 1",n._path=ti("path"),u.appendChild(n._path),this._updateStyle(n),this._layers[_(n)]=n},_addPath:function(n){var u=n._container;this._container.appendChild(u),n.options.interactive&&n.addInteractiveTarget(u)},_removePath:function(n){var u=n._container;Qt(u),n.removeInteractiveTarget(u),delete this._layers[_(n)]},_updateStyle:function(n){var u=n._stroke,f=n._fill,y=n.options,k=n._container;k.stroked=!!y.stroke,k.filled=!!y.fill,y.stroke?(u||(u=n._stroke=ti("stroke")),k.appendChild(u),u.weight=y.weight+"px",u.color=y.color,u.opacity=y.opacity,y.dashArray?u.dashStyle=G(y.dashArray)?y.dashArray.join(" "):y.dashArray.replace(/( *, *)/g," "):u.dashStyle="",u.endcap=y.lineCap.replace("butt","flat"),u.joinstyle=y.lineJoin):u&&(k.removeChild(u),n._stroke=null),y.fill?(f||(f=n._fill=ti("fill")),k.appendChild(f),f.color=y.fillColor||y.color,f.opacity=y.fillOpacity):f&&(k.removeChild(f),n._fill=null)},_updateCircle:function(n){var u=n._point.round(),f=Math.round(n._radius),y=Math.round(n._radiusY||f);this._setPath(n,n._empty()?"M0 0":"AL "+u.x+","+u.y+" "+f+","+y+" 0,"+65535*360)},_setPath:function(n,u){n._path.v=u},_bringToFront:function(n){Xn(n._container)},_bringToBack:function(n){An(n._container)}},Pi=Pt.vml?ti:Mt,Bn=nn.extend({_initContainer:function(){this._container=Pi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Pi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Qt(this._container),Jt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){nn.prototype._update.call(this);var n=this._bounds,u=n.getSize(),f=this._container;(!this._svgSize||!this._svgSize.equals(u))&&(this._svgSize=u,f.setAttribute("width",u.x),f.setAttribute("height",u.y)),oe(f,n.min),f.setAttribute("viewBox",[n.min.x,n.min.y,u.x,u.y].join(" ")),this.fire("update")}},_initPath:function(n){var u=n._path=Pi("path");n.options.className&&Ot(u,n.options.className),n.options.interactive&&Ot(u,"leaflet-interactive"),this._updateStyle(n),this._layers[_(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){Qt(n._path),n.removeInteractiveTarget(n._path),delete this._layers[_(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var u=n._path,f=n.options;u&&(f.stroke?(u.setAttribute("stroke",f.color),u.setAttribute("stroke-opacity",f.opacity),u.setAttribute("stroke-width",f.weight),u.setAttribute("stroke-linecap",f.lineCap),u.setAttribute("stroke-linejoin",f.lineJoin),f.dashArray?u.setAttribute("stroke-dasharray",f.dashArray):u.removeAttribute("stroke-dasharray"),f.dashOffset?u.setAttribute("stroke-dashoffset",f.dashOffset):u.removeAttribute("stroke-dashoffset")):u.setAttribute("stroke","none"),f.fill?(u.setAttribute("fill",f.fillColor||f.color),u.setAttribute("fill-opacity",f.fillOpacity),u.setAttribute("fill-rule",f.fillRule||"evenodd")):u.setAttribute("fill","none"))},_updatePoly:function(n,u){this._setPath(n,ke(n._parts,u))},_updateCircle:function(n){var u=n._point,f=Math.max(Math.round(n._radius),1),y=Math.max(Math.round(n._radiusY),1)||f,k="a"+f+","+y+" 0 1,0 ",T=n._empty()?"M0 0":"M"+(u.x-f)+","+u.y+k+f*2+",0 "+k+-f*2+",0 ";this._setPath(n,T)},_setPath:function(n,u){n._path.setAttribute("d",u)},_bringToFront:function(n){Xn(n._path)},_bringToBack:function(n){An(n._path)}});Pt.vml&&Bn.include(Es);function Qi(n){return Pt.svg||Pt.vml?new Bn(n):null}Dt.include({getRenderer:function(n){var u=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return u||(u=this._renderer=this._createRenderer()),this.hasLayer(u)||this.addLayer(u),u},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var u=this._paneRenderers[n];return u===void 0&&(u=this._createRenderer({pane:n}),this._paneRenderers[n]=u),u},_createRenderer:function(n){return this.options.preferCanvas&&zr(n)||Qi(n)}});var Ko=Qn.extend({initialize:function(n,u){Qn.prototype.initialize.call(this,this._boundsToLatLngs(n),u)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=at(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function Wu(n,u){return new Ko(n,u)}Bn.create=Pi,Bn.pointsToPath=ke,en.geometryToLayer=Ji,en.coordsToLatLng=Pn,en.coordsToLatLngs=ji,en.latLngToCoords=$i,en.latLngsToCoords=Pe,en.getFeature=Ie,en.asFeature=s,Dt.mergeOptions({boxZoom:!0});var Jo=Qe.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){Rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Jt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Qt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),hn(),kr(),this._startPoint=this._map.mouseEventToContainerPoint(n),Rt(document,{contextmenu:xn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=Zt("div","leaflet-zoom-box",this._container),Ot(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var u=new rt(this._point,this._startPoint),f=u.getSize();oe(this._box,u.min),this._box.style.width=f.x+"px",this._box.style.height=f.y+"px"},_finish:function(){this._moved&&(Qt(this._box),Wt(this._container,"leaflet-crosshair")),Vn(),mi(),Jt(document,{contextmenu:xn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(d(this._resetState,this),0);var u=new mt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(u).fire("boxzoomend",{boxZoomBounds:u})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Dt.addInitHook("addHandler","boxZoom",Jo),Dt.mergeOptions({doubleClickZoom:!0});var jo=Qe.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var u=this._map,f=u.getZoom(),y=u.options.zoomDelta,k=n.originalEvent.shiftKey?f-y:f+y;u.options.doubleClickZoom==="center"?u.setZoom(k):u.setZoomAround(n.containerPoint,k)}});Dt.addInitHook("addHandler","doubleClickZoom",jo),Dt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var $o=Qe.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new wn(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}Ot(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Wt(this._map._container,"leaflet-grab"),Wt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var u=at(this._map.options.maxBounds);this._offsetLimit=ht(this._map.latLngToContainerPoint(u.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(u.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var u=this._lastTime=+new Date,f=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(f),this._times.push(u),this._prunePositions(u)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),u=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=u.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,u){return n-(n-u)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),u=this._offsetLimit;n.x<u.min.x&&(n.x=this._viscousLimit(n.x,u.min.x)),n.y<u.min.y&&(n.y=this._viscousLimit(n.y,u.min.y)),n.x>u.max.x&&(n.x=this._viscousLimit(n.x,u.max.x)),n.y>u.max.y&&(n.y=this._viscousLimit(n.y,u.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,u=Math.round(n/2),f=this._initialWorldOffset,y=this._draggable._newPos.x,k=(y-u+f)%n+u-f,T=(y+u+f)%n-u-f,K=Math.abs(k+f)<Math.abs(T+f)?k:T;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=K},_onDragEnd:function(n){var u=this._map,f=u.options,y=!f.inertia||n.noInertia||this._times.length<2;if(u.fire("dragend",n),y)u.fire("moveend");else{this._prunePositions(+new Date);var k=this._lastPos.subtract(this._positions[0]),T=(this._lastTime-this._times[0])/1e3,K=f.easeLinearity,it=k.multiplyBy(K/T),st=it.distanceTo([0,0]),dt=Math.min(f.inertiaMaxSpeed,st),wt=it.multiplyBy(dt/st),Nt=dt/(f.inertiaDeceleration*K),qt=wt.multiplyBy(-Nt/2).round();!qt.x&&!qt.y?u.fire("moveend"):(qt=u._limitOffset(qt,u.options.maxBounds),A(function(){u.panBy(qt,{duration:Nt,easeLinearity:K,noMoveStart:!0,animate:!0})}))}}});Dt.addInitHook("addHandler","dragging",$o),Dt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Qo=Qe.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),Rt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Jt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,u=document.documentElement,f=n.scrollTop||u.scrollTop,y=n.scrollLeft||u.scrollLeft;this._map._container.focus(),window.scrollTo(y,f)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var u=this._panKeys={},f=this.keyCodes,y,k;for(y=0,k=f.left.length;y<k;y++)u[f.left[y]]=[-1*n,0];for(y=0,k=f.right.length;y<k;y++)u[f.right[y]]=[n,0];for(y=0,k=f.down.length;y<k;y++)u[f.down[y]]=[0,n];for(y=0,k=f.up.length;y<k;y++)u[f.up[y]]=[0,-1*n]},_setZoomDelta:function(n){var u=this._zoomKeys={},f=this.keyCodes,y,k;for(y=0,k=f.zoomIn.length;y<k;y++)u[f.zoomIn[y]]=n;for(y=0,k=f.zoomOut.length;y<k;y++)u[f.zoomOut[y]]=-n},_addHooks:function(){Rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Jt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var u=n.keyCode,f=this._map,y;if(u in this._panKeys){if(!f._panAnim||!f._panAnim._inProgress)if(y=this._panKeys[u],n.shiftKey&&(y=W(y).multiplyBy(3)),f.options.maxBounds&&(y=f._limitOffset(W(y),f.options.maxBounds)),f.options.worldCopyJump){var k=f.wrapLatLng(f.unproject(f.project(f.getCenter()).add(y)));f.panTo(k)}else f.panBy(y)}else if(u in this._zoomKeys)f.setZoom(f.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[u]);else if(u===27&&f._popup&&f._popup.options.closeOnEscapeKey)f.closePopup();else return;xn(n)}}});Dt.addInitHook("addHandler","keyboard",Qo),Dt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ta=Qe.extend({addHooks:function(){Rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Jt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var u=Lr(n),f=this._map.options.wheelDebounceTime;this._delta+=u,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var y=Math.max(f-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(d(this._performZoom,this),y),xn(n)},_performZoom:function(){var n=this._map,u=n.getZoom(),f=this._map.options.zoomSnap||0;n._stop();var y=this._delta/(this._map.options.wheelPxPerZoomLevel*4),k=4*Math.log(2/(1+Math.exp(-Math.abs(y))))/Math.LN2,T=f?Math.ceil(k/f)*f:k,K=n._limitZoom(u+(this._delta>0?T:-T))-u;this._delta=0,this._startTime=null,K&&(n.options.scrollWheelZoom==="center"?n.setZoom(u+K):n.setZoomAround(this._lastMousePos,u+K))}});Dt.addInitHook("addHandler","scrollWheelZoom",ta);var Ku=600;Dt.mergeOptions({tapHold:Pt.touchNative&&Pt.safari&&Pt.mobile,tapTolerance:15});var ea=Qe.extend({addHooks:function(){Rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Jt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var u=n.touches[0];this._startPos=this._newPos=new U(u.clientX,u.clientY),this._holdTimeout=setTimeout(d(function(){this._cancel(),this._isTapValid()&&(Rt(document,"touchend",ee),Rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",u))},this),Ku),Rt(document,"touchend touchcancel contextmenu",this._cancel,this),Rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){Jt(document,"touchend",ee),Jt(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),Jt(document,"touchend touchcancel contextmenu",this._cancel,this),Jt(document,"touchmove",this._onMove,this)},_onMove:function(n){var u=n.touches[0];this._newPos=new U(u.clientX,u.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,u){var f=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:u.screenX,screenY:u.screenY,clientX:u.clientX,clientY:u.clientY});f._simulated=!0,u.target.dispatchEvent(f)}});Dt.addInitHook("addHandler","tapHold",ea),Dt.mergeOptions({touchZoom:Pt.touch,bounceAtZoomLimits:!0});var na=Qe.extend({addHooks:function(){Ot(this._map._container,"leaflet-touch-zoom"),Rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Wt(this._map._container,"leaflet-touch-zoom"),Jt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var u=this._map;if(!(!n.touches||n.touches.length!==2||u._animatingZoom||this._zooming)){var f=u.mouseEventToContainerPoint(n.touches[0]),y=u.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=u.getSize()._divideBy(2),this._startLatLng=u.containerPointToLatLng(this._centerPoint),u.options.touchZoom!=="center"&&(this._pinchStartLatLng=u.containerPointToLatLng(f.add(y)._divideBy(2))),this._startDist=f.distanceTo(y),this._startZoom=u.getZoom(),this._moved=!1,this._zooming=!0,u._stop(),Rt(document,"touchmove",this._onTouchMove,this),Rt(document,"touchend touchcancel",this._onTouchEnd,this),ee(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var u=this._map,f=u.mouseEventToContainerPoint(n.touches[0]),y=u.mouseEventToContainerPoint(n.touches[1]),k=f.distanceTo(y)/this._startDist;if(this._zoom=u.getScaleZoom(k,this._startZoom),!u.options.bounceAtZoomLimits&&(this._zoom<u.getMinZoom()&&k<1||this._zoom>u.getMaxZoom()&&k>1)&&(this._zoom=u._limitZoom(this._zoom)),u.options.touchZoom==="center"){if(this._center=this._startLatLng,k===1)return}else{var T=f._add(y)._divideBy(2)._subtract(this._centerPoint);if(k===1&&T.x===0&&T.y===0)return;this._center=u.unproject(u.project(this._pinchStartLatLng,this._zoom).subtract(T),this._zoom)}this._moved||(u._moveStart(!0,!1),this._moved=!0),O(this._animRequest);var K=d(u._move,u,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=A(K,this,!0),ee(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,O(this._animRequest),Jt(document,"touchmove",this._onTouchMove,this),Jt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Dt.addInitHook("addHandler","touchZoom",na),Dt.BoxZoom=Jo,Dt.DoubleClickZoom=jo,Dt.Drag=$o,Dt.Keyboard=Qo,Dt.ScrollWheelZoom=ta,Dt.TapHold=ea,Dt.TouchZoom=na,o.Bounds=rt,o.Browser=Pt,o.CRS=kt,o.Canvas=Br,o.Circle=Ki,o.CircleMarker=wi,o.Class=q,o.Control=He,o.DivIcon=It,o.DivOverlay=$,o.DomEvent=uo,o.DomUtil=Hi,o.Draggable=wn,o.Evented=j,o.FeatureGroup=gn,o.GeoJSON=en,o.GridLayer=zt,o.Handler=Qe,o.Icon=$n,o.ImageOverlay=c,o.LatLng=ct,o.LatLngBounds=mt,o.Layer=Ze,o.LayerGroup=jn,o.LineUtil=Ar,o.Map=Dt,o.Marker=Wi,o.Mixin=fo,o.Path=En,o.Point=U,o.PolyUtil=Oe,o.Polygon=Qn,o.Polyline=tn,o.Popup=nt,o.PosAnimation=Mr,o.Projection=mo,o.Rectangle=Ko,o.Renderer=nn,o.SVG=Bn,o.SVGOverlay=C,o.TileLayer=te,o.Tooltip=xt,o.Transformation=vt,o.Util=V,o.VideoOverlay=v,o.bind=d,o.bounds=ht,o.canvas=zr,o.circle=xo,o.circleMarker=xs,o.control=ye,o.divIcon=Ut,o.extend=l,o.featureGroup=vs,o.geoJSON=e,o.geoJson=r,o.gridLayer=jt,o.icon=vo,o.imageOverlay=p,o.latLng=ft,o.latLngBounds=at,o.layerGroup=ys,o.map=Yi,o.marker=_o,o.point=W,o.polygon=ks,o.polyline=Fr,o.popup=gt,o.rectangle=Wu,o.setOptions=et,o.stamp=_,o.svg=Qi,o.svgOverlay=D,o.tileLayer=ge,o.tooltip=Et,o.transformation=Z,o.version=a,o.videoOverlay=E;var Ju=window.L;o.noConflict=function(){return window.L=Ju,this},window.L=o})}(Yr,Yr.exports)),Yr.exports}var yt=ol(),al=Object.defineProperty,ul=(h,i,o)=>i in h?al(h,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):h[i]=o,lt=(h,i,o)=>ul(h,typeof i!="symbol"?i+"":i,o),aa,ua;const ll=!0,hl=!0,cl=!1,fl={draw:!0,subtract:!0,deleteAll:!0,p2p:!0,attachElbow:!0,dragElbow:!0,dragPolygons:!0,edgeDeletion:!0},gl={realTimeUpdate:!1,showDragHandle:!1,opacity:.7,dragCursor:"move",hoverCursor:"grab",markerBehavior:"hide",markerAnimationDuration:200,autoMergeOnIntersect:!0,autoHoleOnContained:!1,dragInteractionBehavior:"auto",modifierSubtract:{enabled:!0,keys:{windows:"ctrlKey",mac:"metaKey",linux:"ctrlKey"},subtractColor:"#D9460F",hideMarkersOnDrag:!0}},dl={enabled:!0,modifierKey:"auto",hoverColor:"#D9460F",confirmDeletion:!1,minVertices:3},ml={deleteMarker:!0,infoMarker:!0,menuMarker:!0,coordsTitle:!0,zIndexOffset:0,markerIcon:{styleClasses:["polygon-marker"],zIndexOffset:null},holeIcon:{styleClasses:["polygon-marker","hole"],zIndexOffset:null},markerInfoIcon:{position:3,showArea:!0,showPerimeter:!0,useMetrics:!0,usePerimeterMinValue:!1,areaLabel:"Area",perimeterLabel:"Perimeter",values:{min:{metric:"50",imperial:"100"},unknown:{metric:"-",imperial:"-"}},units:{unknownUnit:"",metric:{onlyMetrics:!0,perimeter:{m:"m",km:"km"},area:{m2:"m²",km2:"km²",daa:"daa",ha:"ha"}},imperial:{perimeter:{feet:"ft",yards:"yd",miles:"mi"},area:{feet2:"ft²",yards2:"yd²",acres:"ac",miles2:"mi²"}}},styleClasses:["polygon-marker","info"],zIndexOffset:1e4},markerMenuIcon:{position:7,styleClasses:["polygon-marker","menu"],zIndexOffset:1e4},markerDeleteIcon:{position:5,styleClasses:["polygon-marker","delete"],zIndexOffset:1e4},visualOptimization:{sharpAngleThreshold:30,thresholdBoundingBox:.05,thresholdDistance:.05,useDistance:!0,useBoundingBox:!1,useAngles:!1}},pl={color:"#50622b",opacity:1,smoothFactor:0,noClip:!0,clickable:!1,weight:2},yl={color:"#50622b",opacity:1,smoothFactor:0,noClip:!0,clickable:!1,weight:2},vl={smoothFactor:.3,color:"#50622b",fillColor:"#b4cd8a",noClip:!0},_l={color:"#aa0000",fillColor:"#ffcccc",weight:2,opacity:1,fillOpacity:.5},xl={method:"concaveman",simplification:{mode:"simple",tolerance:1e-5,highQuality:!1}},kl={simplifyTolerance:{tolerance:1e-4,highQuality:!1,mutate:!1},dynamicMode:{fractionGuard:.9,multipiler:2}},wl={addMidPointMarkers:!0},El={resolution:1e4,sharpness:.75},Gn={touchSupport:ll,mergePolygons:hl,kinks:cl,modes:fl,dragPolygons:gl,edgeDeletion:dl,markers:ml,polyLineOptions:pl,subtractLineOptions:yl,polygonOptions:vl,holeOptions:_l,polygonCreation:xl,simplification:kl,boundingBox:wl,bezier:El};var Bt=(h=>(h[h.Off=0]="Off",h[h.Add=1]="Add",h[h.Edit=2]="Edit",h[h.Subtract=4]="Subtract",h[h.AppendMarker=8]="AppendMarker",h[h.LoadPredefined=16]="LoadPredefined",h[h.PointToPoint=32]="PointToPoint",h))(Bt||{}),on=(h=>(h[h.SouthWest=0]="SouthWest",h[h.South=1]="South",h[h.SouthEast=2]="SouthEast",h[h.East=3]="East",h[h.NorthEast=4]="NorthEast",h[h.North=5]="North",h[h.NorthWest=6]="NorthWest",h[h.West=7]="West",h[h.Hole=8]="Hole",h))(on||{}),Se=63710088e-1,uu={centimeters:Se*100,centimetres:Se*100,degrees:360/(2*Math.PI),feet:Se*3.28084,inches:Se*39.37,kilometers:Se/1e3,kilometres:Se/1e3,meters:Se,metres:Se,miles:Se/1609.344,millimeters:Se*1e3,millimetres:Se*1e3,nauticalmiles:Se/1852,radians:1,yards:Se*1.0936};function pn(h,i,o={}){const a={type:"Feature"};return(o.id===0||o.id)&&(a.id=o.id),o.bbox&&(a.bbox=o.bbox),a.properties=i||{},a.geometry=h,a}function ae(h,i,o={}){if(!h)throw new Error("coordinates is required");if(!Array.isArray(h))throw new Error("coordinates must be an Array");if(h.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!la(h[0])||!la(h[1]))throw new Error("coordinates must contain numbers");return pn({type:"Point",coordinates:h},i,o)}function he(h,i,o={}){for(const l of h){if(l.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(l[l.length-1].length!==l[0].length)throw new Error("First and last Position are not equivalent.");for(let g=0;g<l[l.length-1].length;g++)if(l[l.length-1][g]!==l[0][g])throw new Error("First and last Position are not equivalent.")}return pn({type:"Polygon",coordinates:h},i,o)}function Li(h,i,o={}){if(h.length<2)throw new Error("coordinates must be an array of two or more positions");return pn({type:"LineString",coordinates:h},i,o)}function Te(h,i={}){const o={type:"FeatureCollection"};return i.id&&(o.id=i.id),i.bbox&&(o.bbox=i.bbox),o.features=h,o}function Pl(h,i,o={}){return pn({type:"MultiLineString",coordinates:h},i,o)}function Mn(h,i,o={}){return pn({type:"MultiPolygon",coordinates:h},i,o)}function lu(h,i="kilometers"){const o=uu[i];if(!o)throw new Error(i+" units is invalid");return h*o}function hu(h,i="kilometers"){const o=uu[i];if(!o)throw new Error(i+" units is invalid");return h/o}function Do(h){return h%(2*Math.PI)*180/Math.PI}function mn(h){return h%360*Math.PI/180}function la(h){return!isNaN(h)&&h!==null&&!Array.isArray(h)}function Il(h){return h!==null&&typeof h=="object"&&!Array.isArray(h)}function Mi(h){if(!h)throw new Error("coord is required");if(!Array.isArray(h)){if(h.type==="Feature"&&h.geometry!==null&&h.geometry.type==="Point")return[...h.geometry.coordinates];if(h.type==="Point")return[...h.coordinates]}if(Array.isArray(h)&&h.length>=2&&!Array.isArray(h[0])&&!Array.isArray(h[1]))return[...h];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ue(h){if(Array.isArray(h))return h;if(h.type==="Feature"){if(h.geometry!==null)return h.geometry.coordinates}else if(h.coordinates)return h.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function si(h){return h.type==="Feature"?h.geometry:h}function Ll(h,i){return h.type==="FeatureCollection"?"FeatureCollection":h.type==="GeometryCollection"?"GeometryCollection":h.type==="Feature"&&h.geometry!==null?h.geometry.type:h.type}function cu(h,i,o={}){if(o.final===!0)return Ml(h,i);const a=Mi(h),l=Mi(i),g=mn(a[0]),d=mn(l[0]),m=mn(a[1]),_=mn(l[1]),x=Math.sin(d-g)*Math.cos(_),w=Math.cos(m)*Math.sin(_)-Math.sin(m)*Math.cos(_)*Math.cos(d-g);return Do(Math.atan2(x,w))}function Ml(h,i){let o=cu(i,h);return o=(o+180)%360,o}function Sl(h,i,o,a={}){const l=Mi(h),g=mn(l[0]),d=mn(l[1]),m=mn(o),_=hu(i,a.units),x=Math.asin(Math.sin(d)*Math.cos(_)+Math.cos(d)*Math.sin(_)*Math.cos(m)),w=g+Math.atan2(Math.sin(m)*Math.sin(_)*Math.cos(d),Math.cos(_)-Math.sin(d)*Math.sin(x)),I=Do(w),b=Do(x);return ae([I,b],a.properties)}function es(h,i,o={}){var a=Mi(h),l=Mi(i),g=mn(l[1]-a[1]),d=mn(l[0]-a[0]),m=mn(a[1]),_=mn(l[1]),x=Math.pow(Math.sin(g/2),2)+Math.pow(Math.sin(d/2),2)*Math.cos(m)*Math.cos(_);return lu(2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x)),o.units)}function ii(h,i,o){if(h!==null)for(var a,l,g,d,m,_,x,w=0,I=0,b,F=h.type,z=F==="FeatureCollection",et=F==="Feature",ot=z?h.features.length:1,ut=0;ut<ot;ut++){x=z?h.features[ut].geometry:et?h.geometry:h,b=x?x.type==="GeometryCollection":!1,m=b?x.geometries.length:1;for(var S=0;S<m;S++){var G=0,R=0;if(d=b?x.geometries[S]:x,d!==null){_=d.coordinates;var H=d.type;switch(w=o&&(H==="Polygon"||H==="MultiPolygon")?1:0,H){case null:break;case"Point":if(i(_,I,ut,G,R)===!1)return!1;I++,G++;break;case"LineString":case"MultiPoint":for(a=0;a<_.length;a++){if(i(_[a],I,ut,G,R)===!1)return!1;I++,H==="MultiPoint"&&G++}H==="LineString"&&G++;break;case"Polygon":case"MultiLineString":for(a=0;a<_.length;a++){for(l=0;l<_[a].length-w;l++){if(i(_[a][l],I,ut,G,R)===!1)return!1;I++}H==="MultiLineString"&&G++,H==="Polygon"&&R++}H==="Polygon"&&G++;break;case"MultiPolygon":for(a=0;a<_.length;a++){for(R=0,l=0;l<_[a].length;l++){for(g=0;g<_[a][l].length-w;g++){if(i(_[a][l][g],I,ut,G,R)===!1)return!1;I++}R++}G++}break;case"GeometryCollection":for(a=0;a<d.geometries.length;a++)if(ii(d.geometries[a],i,o)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function ri(h,i){if(h.type==="Feature")i(h,0);else if(h.type==="FeatureCollection")for(var o=0;o<h.features.length&&i(h.features[o],o)!==!1;o++);}function oi(h,i){var o,a,l,g,d,m,_,x,w,I,b=0,F=h.type==="FeatureCollection",z=h.type==="Feature",et=F?h.features.length:1;for(o=0;o<et;o++){for(m=F?h.features[o].geometry:z?h.geometry:h,x=F?h.features[o].properties:z?h.properties:{},w=F?h.features[o].bbox:z?h.bbox:void 0,I=F?h.features[o].id:z?h.id:void 0,_=m?m.type==="GeometryCollection":!1,d=_?m.geometries.length:1,l=0;l<d;l++){if(g=_?m.geometries[l]:m,g===null){if(i(null,b,x,w,I)===!1)return!1;continue}switch(g.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(i(g,b,x,w,I)===!1)return!1;break}case"GeometryCollection":{for(a=0;a<g.geometries.length;a++)if(i(g.geometries[a],b,x,w,I)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}b++}}function Cl(h,i,o){var a=o;return oi(h,function(l,g,d,m,_){a=i(a,l,g,d,m,_)}),a}function fu(h,i){oi(h,function(o,a,l,g,d){var m=o===null?null:o.type;switch(m){case null:case"Point":case"LineString":case"Polygon":return i(pn(o,l,{bbox:g,id:d}),a,0)===!1?!1:void 0}var _;switch(m){case"MultiPoint":_="Point";break;case"MultiLineString":_="LineString";break;case"MultiPolygon":_="Polygon";break}for(var x=0;x<o.coordinates.length;x++){var w=o.coordinates[x],I={type:_,coordinates:w};if(i(pn(I,l),a,x)===!1)return!1}})}function Tl(h,i){fu(h,function(o,a,l){var g=0;if(o.geometry){var d=o.geometry.type;if(!(d==="Point"||d==="MultiPoint")){var m,_=0,x=0,w=0;if(ii(o,function(I,b,F,z,et){if(m===void 0||a>_||z>x||et>w){m=I,_=a,x=z,w=et,g=0;return}var ot=Li([m,I],o.properties);if(i(ot,a,l,et,g)===!1)return!1;g++,m=I})===!1)return!1}}})}function Nl(h,i,o){var a=o,l=!1;return Tl(h,function(g,d,m,_,x){l===!1&&o===void 0?a=g:a=i(a,g,d,m,_,x),l=!0}),a}function ir(h){return Cl(h,(i,o)=>i+bl(o),0)}function bl(h){let i=0,o;switch(h.type){case"Polygon":return ha(h.coordinates);case"MultiPolygon":for(o=0;o<h.coordinates.length;o++)i+=ha(h.coordinates[o]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function ha(h){let i=0;if(h&&h.length>0){i+=Math.abs(ca(h[0]));for(let o=1;o<h.length;o++)i-=Math.abs(ca(h[o]))}return i}var Ol=Se*Se/2,wo=Math.PI/180;function ca(h){const i=h.length-1;if(i<=2)return 0;let o=0,a=0;for(;a<i;){const l=h[a],g=h[a+1===i?0:a+1],d=h[a+2>=i?(a+2)%i:a+2],m=l[0]*wo,_=g[1]*wo,x=d[0]*wo;o+=(x-m)*Math.sin(_),a++}return o*Ol}function Si(h,i={}){if(h.bbox!=null&&i.recompute!==!0)return h.bbox;const o=[1/0,1/0,-1/0,-1/0];return ii(h,a=>{o[0]>a[0]&&(o[0]=a[0]),o[1]>a[1]&&(o[1]=a[1]),o[2]<a[0]&&(o[2]=a[0]),o[3]<a[1]&&(o[3]=a[1])}),o}function Al(h,i={}){const o=Number(h[0]),a=Number(h[1]),l=Number(h[2]),g=Number(h[3]);if(h.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const d=[o,a];return he([[d,[l,a],[l,g],[o,g],d]],i.properties,{bbox:h,id:i.id})}var Rl=class{constructor(h){this.points=h.points||[],this.duration=h.duration||1e4,this.sharpness=h.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=h.stepLength||60,this.length=this.points.length,this.delay=0;for(let i=0;i<this.length;i++)this.points[i].z=this.points[i].z||0;for(let i=0;i<this.length-1;i++){const o=this.points[i],a=this.points[i+1];this.centers.push({x:(o.x+a.x)/2,y:(o.y+a.y)/2,z:(o.z+a.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(let i=0;i<this.centers.length-1;i++){const o=this.points[i+1].x-(this.centers[i].x+this.centers[i+1].x)/2,a=this.points[i+1].y-(this.centers[i].y+this.centers[i+1].y)/2,l=this.points[i+1].z-(this.centers[i].y+this.centers[i+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[i+1].x+this.sharpness*(this.centers[i].x+o),y:(1-this.sharpness)*this.points[i+1].y+this.sharpness*(this.centers[i].y+a),z:(1-this.sharpness)*this.points[i+1].z+this.sharpness*(this.centers[i].z+l)},{x:(1-this.sharpness)*this.points[i+1].x+this.sharpness*(this.centers[i+1].x+o),y:(1-this.sharpness)*this.points[i+1].y+this.sharpness*(this.centers[i+1].y+a),z:(1-this.sharpness)*this.points[i+1].z+this.sharpness*(this.centers[i+1].z+l)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}cacheSteps(h){const i=[];let o=this.pos(0);i.push(0);for(let a=0;a<this.duration;a+=10){const l=this.pos(a);Math.sqrt((l.x-o.x)*(l.x-o.x)+(l.y-o.y)*(l.y-o.y)+(l.z-o.z)*(l.z-o.z))>h&&(i.push(a),o=l)}return i}vector(h){const i=this.pos(h+10),o=this.pos(h-10);return{angle:180*Math.atan2(i.y-o.y,i.x-o.x)/3.14,speed:Math.sqrt((o.x-i.x)*(o.x-i.x)+(o.y-i.y)*(o.y-i.y)+(o.z-i.z)*(o.z-i.z))}}pos(h){let i=h-this.delay;i<0&&(i=0),i>this.duration&&(i=this.duration-1);const o=i/this.duration;if(o>=1)return this.points[this.length-1];const a=Math.floor((this.points.length-1)*o),l=(this.length-1)*o-a;return Dl(l,this.points[a],this.controls[a][1],this.controls[a+1][0],this.points[a+1])}};function Dl(h,i,o,a,l){const g=Fl(h);return{x:l.x*g[0]+a.x*g[1]+o.x*g[2]+i.x*g[3],y:l.y*g[0]+a.y*g[1]+o.y*g[2]+i.y*g[3],z:l.z*g[0]+a.z*g[1]+o.z*g[2]+i.z*g[3]}}function Fl(h){const i=h*h;return[i*h,3*i*(1-h),3*h*(1-h)*(1-h),(1-h)*(1-h)*(1-h)]}function Bl(h,i={}){const o=i.resolution||1e4,a=i.sharpness||.85,l=[],g=si(h).coordinates.map(x=>({x:x[0],y:x[1]})),d=new Rl({duration:o,points:g,sharpness:a}),m=x=>{var w=d.pos(x);Math.floor(x/100)%2===0&&l.push([w.x,w.y])};for(var _=0;_<d.duration;_+=10)m(_);return m(d.duration),Li(l,i.properties)}const qn=11102230246251565e-32,Me=134217729,zl=(3+8*qn)*qn;function Eo(h,i,o,a,l){let g,d,m,_,x=i[0],w=a[0],I=0,b=0;w>x==w>-x?(g=x,x=i[++I]):(g=w,w=a[++b]);let F=0;if(I<h&&b<o)for(w>x==w>-x?(d=x+g,m=g-(d-x),x=i[++I]):(d=w+g,m=g-(d-w),w=a[++b]),g=d,m!==0&&(l[F++]=m);I<h&&b<o;)w>x==w>-x?(d=g+x,_=d-g,m=g-(d-_)+(x-_),x=i[++I]):(d=g+w,_=d-g,m=g-(d-_)+(w-_),w=a[++b]),g=d,m!==0&&(l[F++]=m);for(;I<h;)d=g+x,_=d-g,m=g-(d-_)+(x-_),x=i[++I],g=d,m!==0&&(l[F++]=m);for(;b<o;)d=g+w,_=d-g,m=g-(d-_)+(w-_),w=a[++b],g=d,m!==0&&(l[F++]=m);return(g!==0||F===0)&&(l[F++]=g),F}function Gl(h,i){let o=i[0];for(let a=1;a<h;a++)o+=i[a];return o}function rs(h){return new Float64Array(h)}const ql=(3+16*qn)*qn,Hl=(2+12*qn)*qn,Zl=(9+64*qn)*qn*qn,er=rs(4),fa=rs(8),ga=rs(12),da=rs(16),De=rs(4);function Ul(h,i,o,a,l,g,d){let m,_,x,w,I,b,F,z,et,ot,ut,S,G,R,H,Y,J,P;const M=h-l,N=o-l,A=i-g,O=a-g;R=M*O,b=Me*M,F=b-(b-M),z=M-F,b=Me*O,et=b-(b-O),ot=O-et,H=z*ot-(R-F*et-z*et-F*ot),Y=A*N,b=Me*A,F=b-(b-A),z=A-F,b=Me*N,et=b-(b-N),ot=N-et,J=z*ot-(Y-F*et-z*et-F*ot),ut=H-J,I=H-ut,er[0]=H-(ut+I)+(I-J),S=R+ut,I=S-R,G=R-(S-I)+(ut-I),ut=G-Y,I=G-ut,er[1]=G-(ut+I)+(I-Y),P=S+ut,I=P-S,er[2]=S-(P-I)+(ut-I),er[3]=P;let V=Gl(4,er),q=Hl*d;if(V>=q||-V>=q||(I=h-M,m=h-(M+I)+(I-l),I=o-N,x=o-(N+I)+(I-l),I=i-A,_=i-(A+I)+(I-g),I=a-O,w=a-(O+I)+(I-g),m===0&&_===0&&x===0&&w===0)||(q=Zl*d+zl*Math.abs(V),V+=M*w+O*m-(A*x+N*_),V>=q||-V>=q))return V;R=m*O,b=Me*m,F=b-(b-m),z=m-F,b=Me*O,et=b-(b-O),ot=O-et,H=z*ot-(R-F*et-z*et-F*ot),Y=_*N,b=Me*_,F=b-(b-_),z=_-F,b=Me*N,et=b-(b-N),ot=N-et,J=z*ot-(Y-F*et-z*et-F*ot),ut=H-J,I=H-ut,De[0]=H-(ut+I)+(I-J),S=R+ut,I=S-R,G=R-(S-I)+(ut-I),ut=G-Y,I=G-ut,De[1]=G-(ut+I)+(I-Y),P=S+ut,I=P-S,De[2]=S-(P-I)+(ut-I),De[3]=P;const X=Eo(4,er,4,De,fa);R=M*w,b=Me*M,F=b-(b-M),z=M-F,b=Me*w,et=b-(b-w),ot=w-et,H=z*ot-(R-F*et-z*et-F*ot),Y=A*x,b=Me*A,F=b-(b-A),z=A-F,b=Me*x,et=b-(b-x),ot=x-et,J=z*ot-(Y-F*et-z*et-F*ot),ut=H-J,I=H-ut,De[0]=H-(ut+I)+(I-J),S=R+ut,I=S-R,G=R-(S-I)+(ut-I),ut=G-Y,I=G-ut,De[1]=G-(ut+I)+(I-Y),P=S+ut,I=P-S,De[2]=S-(P-I)+(ut-I),De[3]=P;const B=Eo(X,fa,4,De,ga);R=m*w,b=Me*m,F=b-(b-m),z=m-F,b=Me*w,et=b-(b-w),ot=w-et,H=z*ot-(R-F*et-z*et-F*ot),Y=_*x,b=Me*_,F=b-(b-_),z=_-F,b=Me*x,et=b-(b-x),ot=x-et,J=z*ot-(Y-F*et-z*et-F*ot),ut=H-J,I=H-ut,De[0]=H-(ut+I)+(I-J),S=R+ut,I=S-R,G=R-(S-I)+(ut-I),ut=G-Y,I=G-ut,De[1]=G-(ut+I)+(I-Y),P=S+ut,I=P-S,De[2]=S-(P-I)+(ut-I),De[3]=P;const j=Eo(B,ga,4,De,da);return da[j-1]}function Yl(h,i,o,a,l,g){const d=(i-g)*(o-l),m=(h-l)*(a-g),_=d-m,x=Math.abs(d+m);return Math.abs(_)>=ql*x?_:-Ul(h,i,o,a,l,g,x)}function Xl(h,i){var o,a,l=0,g,d,m,_,x,w,I,b=h[0],F=h[1],z=i.length;for(o=0;o<z;o++){a=0;var et=i[o],ot=et.length-1;if(w=et[0],w[0]!==et[ot][0]&&w[1]!==et[ot][1])throw new Error("First and last coordinates in a ring must be the same");for(d=w[0]-b,m=w[1]-F,a;a<ot;a++){if(I=et[a+1],_=I[0]-b,x=I[1]-F,m===0&&x===0){if(_<=0&&d>=0||d<=0&&_>=0)return 0}else if(x>=0&&m<=0||x<=0&&m>=0){if(g=Yl(d,_,m,x,0,0),g===0)return 0;(g>0&&x>0&&m<=0||g<0&&x<=0&&m>0)&&l++}w=I,m=x,d=_}}return l%2!==0}function Ce(h,i,o={}){if(!h)throw new Error("point is required");if(!i)throw new Error("polygon is required");const a=Mi(h),l=si(i),g=l.type,d=i.bbox;let m=l.coordinates;if(d&&Vl(a,d)===!1)return!1;g==="Polygon"&&(m=[m]);let _=!1;for(var x=0;x<m.length;++x){const w=Xl(a,m[x]);if(w===0)return!o.ignoreBoundary;w&&(_=!0)}return _}function Vl(h,i){return i[0]<=h[0]&&i[1]<=h[1]&&i[2]>=h[0]&&i[3]>=h[1]}function Vs(h,i,o={}){const a=Mi(h),l=Ue(i);for(let g=0;g<l.length-1;g++){let d=!1;if(o.ignoreEndVertices&&(g===0&&(d="start"),g===l.length-2&&(d="end"),g===0&&g+1===l.length-1&&(d="both")),Wl(l[g],l[g+1],a,d,typeof o.epsilon>"u"?null:o.epsilon))return!0}return!1}function Wl(h,i,o,a,l){const g=o[0],d=o[1],m=h[0],_=h[1],x=i[0],w=i[1],I=o[0]-m,b=o[1]-_,F=x-m,z=w-_,et=I*z-b*F;if(l!==null){if(Math.abs(et)>l)return!1}else if(et!==0)return!1;if(Math.abs(F)===Math.abs(z)&&Math.abs(F)===0)return a?!1:o[0]===h[0]&&o[1]===h[1];if(a){if(a==="start")return Math.abs(F)>=Math.abs(z)?F>0?m<g&&g<=x:x<=g&&g<m:z>0?_<d&&d<=w:w<=d&&d<_;if(a==="end")return Math.abs(F)>=Math.abs(z)?F>0?m<=g&&g<x:x<g&&g<=m:z>0?_<=d&&d<w:w<d&&d<=_;if(a==="both")return Math.abs(F)>=Math.abs(z)?F>0?m<g&&g<x:x<g&&g<m:z>0?_<d&&d<w:w<d&&d<_}else return Math.abs(F)>=Math.abs(z)?F>0?m<=g&&g<=x:x<=g&&g<=m:z>0?_<=d&&d<=w:w<=d&&d<=_;return!1}let gu=class{constructor(i=[],o=Kl){if(this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:o,compare:a}=this,l=o[i];for(;i>0;){const g=i-1>>1,d=o[g];if(a(l,d)>=0)break;o[i]=d,i=g}o[i]=l}_down(i){const{data:o,compare:a}=this,l=this.length>>1,g=o[i];for(;i<l;){let d=(i<<1)+1,m=o[d];const _=d+1;if(_<this.length&&a(o[_],m)<0&&(d=_,m=o[_]),a(m,g)>=0)break;o[i]=m,i=d}o[i]=g}};function Kl(h,i){return h<i?-1:h>i?1:0}function du(h,i){return h.p.x>i.p.x?1:h.p.x<i.p.x?-1:h.p.y!==i.p.y?h.p.y>i.p.y?1:-1:1}function Jl(h,i){return h.rightSweepEvent.p.x>i.rightSweepEvent.p.x?1:h.rightSweepEvent.p.x<i.rightSweepEvent.p.x?-1:h.rightSweepEvent.p.y!==i.rightSweepEvent.p.y?h.rightSweepEvent.p.y<i.rightSweepEvent.p.y?1:-1:1}class ma{constructor(i,o,a,l){this.p={x:i[0],y:i[1]},this.featureId=o,this.ringId=a,this.eventId=l,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(i){return this.p.x===i.p.x&&this.p.y===i.p.y}}function jl(h,i){if(h.type==="FeatureCollection"){const o=h.features;for(let a=0;a<o.length;a++)pa(o[a],i)}else pa(h,i)}let Is=0,Ls=0,Ms=0;function pa(h,i){const o=h.type==="Feature"?h.geometry:h;let a=o.coordinates;(o.type==="Polygon"||o.type==="MultiLineString")&&(a=[a]),o.type==="LineString"&&(a=[[a]]);for(let l=0;l<a.length;l++)for(let g=0;g<a[l].length;g++){let d=a[l][g][0],m=null;Ls=Ls+1;for(let _=0;_<a[l][g].length-1;_++){m=a[l][g][_+1];const x=new ma(d,Is,Ls,Ms),w=new ma(m,Is,Ls,Ms+1);x.otherEvent=w,w.otherEvent=x,du(x,w)>0?(w.isLeftEndpoint=!0,x.isLeftEndpoint=!1):(x.isLeftEndpoint=!0,w.isLeftEndpoint=!1),i.push(x),i.push(w),d=m,Ms=Ms+1}}Is=Is+1}let $l=class{constructor(i){this.leftSweepEvent=i,this.rightSweepEvent=i.otherEvent}};function Ql(h,i){if(h===null||i===null||h.leftSweepEvent.ringId===i.leftSweepEvent.ringId&&(h.rightSweepEvent.isSamePoint(i.leftSweepEvent)||h.rightSweepEvent.isSamePoint(i.leftSweepEvent)||h.rightSweepEvent.isSamePoint(i.rightSweepEvent)||h.leftSweepEvent.isSamePoint(i.leftSweepEvent)||h.leftSweepEvent.isSamePoint(i.rightSweepEvent)))return!1;const o=h.leftSweepEvent.p.x,a=h.leftSweepEvent.p.y,l=h.rightSweepEvent.p.x,g=h.rightSweepEvent.p.y,d=i.leftSweepEvent.p.x,m=i.leftSweepEvent.p.y,_=i.rightSweepEvent.p.x,x=i.rightSweepEvent.p.y,w=(x-m)*(l-o)-(_-d)*(g-a),I=(_-d)*(a-m)-(x-m)*(o-d),b=(l-o)*(a-m)-(g-a)*(o-d);if(w===0)return!1;const F=I/w,z=b/w;if(F>=0&&F<=1&&z>=0&&z<=1){const et=o+F*(l-o),ot=a+F*(g-a);return[et,ot]}return!1}function th(h,i){i=i||!1;const o=[],a=new gu([],Jl);for(;h.length;){const l=h.pop();if(l.isLeftEndpoint){const g=new $l(l);for(let d=0;d<a.data.length;d++){const m=a.data[d];if(i&&m.leftSweepEvent.featureId===l.featureId)continue;const _=Ql(g,m);_!==!1&&o.push(_)}a.push(g)}else l.isLeftEndpoint===!1&&a.pop()}return o}function eh(h,i){const o=new gu([],du);return jl(h,o),th(o,i)}var nh=eh;function ih(h,i,o={}){const{removeDuplicates:a=!0,ignoreSelfIntersections:l=!0}=o;let g=[];h.type==="FeatureCollection"?g=g.concat(h.features):h.type==="Feature"?g.push(h):(h.type==="LineString"||h.type==="Polygon"||h.type==="MultiLineString"||h.type==="MultiPolygon")&&g.push(pn(h)),i.type==="FeatureCollection"?g=g.concat(i.features):i.type==="Feature"?g.push(i):(i.type==="LineString"||i.type==="Polygon"||i.type==="MultiLineString"||i.type==="MultiPolygon")&&g.push(pn(i));const d=nh(Te(g),l);let m=[];if(a){const _={};d.forEach(x=>{const w=x.join(",");_[w]||(_[w]=!0,m.push(x))})}else m=d;return Te(m.map(_=>ae(_)))}function rh(h,i={}){const o=si(h);switch(!i.properties&&h.type==="Feature"&&(i.properties=h.properties),o.type){case"Polygon":return sh(o,i);case"MultiPolygon":return oh(o,i);default:throw new Error("invalid poly")}}function sh(h,i={}){const a=si(h).coordinates,l=i.properties?i.properties:h.type==="Feature"?h.properties:{};return mu(a,l)}function oh(h,i={}){const a=si(h).coordinates,l=i.properties?i.properties:h.type==="Feature"?h.properties:{},g=[];return a.forEach(d=>{g.push(mu(d,l))}),Te(g)}function mu(h,i){return h.length>1?Pl(h,i):Li(h[0],i)}function ah(h,i={}){var o=typeof i=="object"?i.mutate:i;if(!h)throw new Error("geojson is required");var a=Ll(h),l=[];switch(a){case"LineString":l=Po(h,a);break;case"MultiLineString":case"Polygon":Ue(h).forEach(function(d){l.push(Po(d,a))});break;case"MultiPolygon":Ue(h).forEach(function(d){var m=[];d.forEach(function(_){m.push(Po(_,a))}),l.push(m)});break;case"Point":return h;case"MultiPoint":var g={};Ue(h).forEach(function(d){var m=d.join("-");Object.prototype.hasOwnProperty.call(g,m)||(l.push(d),g[m]=!0)});break;default:throw new Error(a+" geometry not supported")}return h.coordinates?o===!0?(h.coordinates=l,h):{type:a,coordinates:l}:o===!0?(h.geometry.coordinates=l,h):pn({type:a,coordinates:l},h.properties,{bbox:h.bbox,id:h.id})}function Po(h,i){var o=Ue(h);if(o.length===2&&!ya(o[0],o[1]))return o;var a=[],l=o.length-1,g=a.length;a.push(o[0]);for(var d=1;d<l;d++){var m=a[a.length-1];o[d][0]===m[0]&&o[d][1]===m[1]||(a.push(o[d]),g=a.length,g>2&&va(a[g-3],a[g-1],a[g-2])&&a.splice(a.length-2,1))}if(a.push(o[o.length-1]),g=a.length,(i==="Polygon"||i==="MultiPolygon")&&ya(o[0],o[o.length-1])&&g<4)throw new Error("invalid polygon");return i==="LineString"&&g<3||va(a[g-3],a[g-1],a[g-2])&&a.splice(a.length-2,1),a}function ya(h,i){return h[0]===i[0]&&h[1]===i[1]}function va(h,i,o){var a=o[0],l=o[1],g=h[0],d=h[1],m=i[0],_=i[1],x=a-g,w=l-d,I=m-g,b=_-d,F=x*b-w*I;return F!==0?!1:Math.abs(I)>=Math.abs(b)?I>0?g<=a&&a<=m:m<=a&&a<=g:b>0?d<=l&&l<=_:_<=l&&l<=d}function uh(h,i,o,a,l){pu(h,i,o||0,a||h.length-1,l||lh)}function pu(h,i,o,a,l){for(;a>o;){if(a-o>600){var g=a-o+1,d=i-o+1,m=Math.log(g),_=.5*Math.exp(2*m/3),x=.5*Math.sqrt(m*_*(g-_)/g)*(d-g/2<0?-1:1),w=Math.max(o,Math.floor(i-d*_/g+x)),I=Math.min(a,Math.floor(i+(g-d)*_/g+x));pu(h,i,w,I,l)}var b=h[i],F=o,z=a;for(Gr(h,o,i),l(h[a],b)>0&&Gr(h,o,a);F<z;){for(Gr(h,F,z),F++,z--;l(h[F],b)<0;)F++;for(;l(h[z],b)>0;)z--}l(h[o],b)===0?Gr(h,o,z):(z++,Gr(h,z,a)),z<=i&&(o=z+1),i<=z&&(a=z-1)}}function Gr(h,i,o){var a=h[i];h[i]=h[o],h[o]=a}function lh(h,i){return h<i?-1:h>i?1:0}class yu{constructor(i=9){this._maxEntries=Math.max(4,i),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(i){let o=this.data;const a=[];if(!Cs(i,o))return a;const l=this.toBBox,g=[];for(;o;){for(let d=0;d<o.children.length;d++){const m=o.children[d],_=o.leaf?l(m):m;Cs(i,_)&&(o.leaf?a.push(m):Lo(i,_)?this._all(m,a):g.push(m))}o=g.pop()}return a}collides(i){let o=this.data;if(!Cs(i,o))return!1;const a=[];for(;o;){for(let l=0;l<o.children.length;l++){const g=o.children[l],d=o.leaf?this.toBBox(g):g;if(Cs(i,d)){if(o.leaf||Lo(i,d))return!0;a.push(g)}}o=a.pop()}return!1}load(i){if(!(i&&i.length))return this;if(i.length<this._minEntries){for(let a=0;a<i.length;a++)this.insert(i[a]);return this}let o=this._build(i.slice(),0,i.length-1,0);if(!this.data.children.length)this.data=o;else if(this.data.height===o.height)this._splitRoot(this.data,o);else{if(this.data.height<o.height){const a=this.data;this.data=o,o=a}this._insert(o,this.data.height-o.height-1,!0)}return this}insert(i){return i&&this._insert(i,this.data.height-1),this}clear(){return this.data=rr([]),this}remove(i,o){if(!i)return this;let a=this.data;const l=this.toBBox(i),g=[],d=[];let m,_,x;for(;a||g.length;){if(a||(a=g.pop(),_=g[g.length-1],m=d.pop(),x=!0),a.leaf){const w=hh(i,a.children,o);if(w!==-1)return a.children.splice(w,1),g.push(a),this._condense(g),this}!x&&!a.leaf&&Lo(a,l)?(g.push(a),d.push(m),m=0,_=a,a=a.children[0]):_?(m++,a=_.children[m],x=!1):a=null}return this}toBBox(i){return i}compareMinX(i,o){return i.minX-o.minX}compareMinY(i,o){return i.minY-o.minY}toJSON(){return this.data}fromJSON(i){return this.data=i,this}_all(i,o){const a=[];for(;i;)i.leaf?o.push(...i.children):a.push(...i.children),i=a.pop();return o}_build(i,o,a,l){const g=a-o+1;let d=this._maxEntries,m;if(g<=d)return m=rr(i.slice(o,a+1)),nr(m,this.toBBox),m;l||(l=Math.ceil(Math.log(g)/Math.log(d)),d=Math.ceil(g/Math.pow(d,l-1))),m=rr([]),m.leaf=!1,m.height=l;const _=Math.ceil(g/d),x=_*Math.ceil(Math.sqrt(d));_a(i,o,a,x,this.compareMinX);for(let w=o;w<=a;w+=x){const I=Math.min(w+x-1,a);_a(i,w,I,_,this.compareMinY);for(let b=w;b<=I;b+=_){const F=Math.min(b+_-1,I);m.children.push(this._build(i,b,F,l-1))}}return nr(m,this.toBBox),m}_chooseSubtree(i,o,a,l){for(;l.push(o),!(o.leaf||l.length-1===a);){let g=1/0,d=1/0,m;for(let _=0;_<o.children.length;_++){const x=o.children[_],w=Io(x),I=gh(i,x)-w;I<d?(d=I,g=w<g?w:g,m=x):I===d&&w<g&&(g=w,m=x)}o=m||o.children[0]}return o}_insert(i,o,a){const l=a?i:this.toBBox(i),g=[],d=this._chooseSubtree(l,this.data,o,g);for(d.children.push(i),Vr(d,l);o>=0&&g[o].children.length>this._maxEntries;)this._split(g,o),o--;this._adjustParentBBoxes(l,g,o)}_split(i,o){const a=i[o],l=a.children.length,g=this._minEntries;this._chooseSplitAxis(a,g,l);const d=this._chooseSplitIndex(a,g,l),m=rr(a.children.splice(d,a.children.length-d));m.height=a.height,m.leaf=a.leaf,nr(a,this.toBBox),nr(m,this.toBBox),o?i[o-1].children.push(m):this._splitRoot(a,m)}_splitRoot(i,o){this.data=rr([i,o]),this.data.height=i.height+1,this.data.leaf=!1,nr(this.data,this.toBBox)}_chooseSplitIndex(i,o,a){let l,g=1/0,d=1/0;for(let m=o;m<=a-o;m++){const _=Xr(i,0,m,this.toBBox),x=Xr(i,m,a,this.toBBox),w=dh(_,x),I=Io(_)+Io(x);w<g?(g=w,l=m,d=I<d?I:d):w===g&&I<d&&(d=I,l=m)}return l||a-o}_chooseSplitAxis(i,o,a){const l=i.leaf?this.compareMinX:ch,g=i.leaf?this.compareMinY:fh,d=this._allDistMargin(i,o,a,l),m=this._allDistMargin(i,o,a,g);d<m&&i.children.sort(l)}_allDistMargin(i,o,a,l){i.children.sort(l);const g=this.toBBox,d=Xr(i,0,o,g),m=Xr(i,a-o,a,g);let _=Ss(d)+Ss(m);for(let x=o;x<a-o;x++){const w=i.children[x];Vr(d,i.leaf?g(w):w),_+=Ss(d)}for(let x=a-o-1;x>=o;x--){const w=i.children[x];Vr(m,i.leaf?g(w):w),_+=Ss(m)}return _}_adjustParentBBoxes(i,o,a){for(let l=a;l>=0;l--)Vr(o[l],i)}_condense(i){for(let o=i.length-1,a;o>=0;o--)i[o].children.length===0?o>0?(a=i[o-1].children,a.splice(a.indexOf(i[o]),1)):this.clear():nr(i[o],this.toBBox)}}function hh(h,i,o){if(!o)return i.indexOf(h);for(let a=0;a<i.length;a++)if(o(h,i[a]))return a;return-1}function nr(h,i){Xr(h,0,h.children.length,i,h)}function Xr(h,i,o,a,l){l||(l=rr(null)),l.minX=1/0,l.minY=1/0,l.maxX=-1/0,l.maxY=-1/0;for(let g=i;g<o;g++){const d=h.children[g];Vr(l,h.leaf?a(d):d)}return l}function Vr(h,i){return h.minX=Math.min(h.minX,i.minX),h.minY=Math.min(h.minY,i.minY),h.maxX=Math.max(h.maxX,i.maxX),h.maxY=Math.max(h.maxY,i.maxY),h}function ch(h,i){return h.minX-i.minX}function fh(h,i){return h.minY-i.minY}function Io(h){return(h.maxX-h.minX)*(h.maxY-h.minY)}function Ss(h){return h.maxX-h.minX+(h.maxY-h.minY)}function gh(h,i){return(Math.max(i.maxX,h.maxX)-Math.min(i.minX,h.minX))*(Math.max(i.maxY,h.maxY)-Math.min(i.minY,h.minY))}function dh(h,i){const o=Math.max(h.minX,i.minX),a=Math.max(h.minY,i.minY),l=Math.min(h.maxX,i.maxX),g=Math.min(h.maxY,i.maxY);return Math.max(0,l-o)*Math.max(0,g-a)}function Lo(h,i){return h.minX<=i.minX&&h.minY<=i.minY&&i.maxX<=h.maxX&&i.maxY<=h.maxY}function Cs(h,i){return i.minX<=h.maxX&&i.minY<=h.maxY&&i.maxX>=h.minX&&i.maxY>=h.minY}function rr(h){return{children:h,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _a(h,i,o,a,l){const g=[i,o];for(;g.length;){if(o=g.pop(),i=g.pop(),o-i<=a)continue;const d=i+Math.ceil((o-i)/a/2)*a;uh(h,d,i,o,l),g.push(i,d,d,o)}}function vu(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}function mh(h){if(Object.prototype.hasOwnProperty.call(h,"__esModule"))return h;var i=h.default;if(typeof i=="function"){var o=function a(){return this instanceof a?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};o.prototype=i.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(h).forEach(function(a){var l=Object.getOwnPropertyDescriptor(h,a);Object.defineProperty(o,a,l.get?l:{enumerable:!0,get:function(){return h[a]}})}),o}function Mo(h,i){var o=si(h),a=si(i),l=o.type,g=a.type;switch(l){case"Point":switch(g){case"MultiPoint":return ph(o,a);case"LineString":return Vs(o,a,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return Ce(o,a,{ignoreBoundary:!0});default:throw new Error("feature2 "+g+" geometry not supported")}case"MultiPoint":switch(g){case"MultiPoint":return yh(o,a);case"LineString":return vh(o,a);case"Polygon":case"MultiPolygon":return _h(o,a);default:throw new Error("feature2 "+g+" geometry not supported")}case"LineString":switch(g){case"LineString":return xh(o,a);case"Polygon":case"MultiPolygon":return kh(o,a);default:throw new Error("feature2 "+g+" geometry not supported")}case"Polygon":switch(g){case"Polygon":case"MultiPolygon":return wh(o,a);default:throw new Error("feature2 "+g+" geometry not supported")}default:throw new Error("feature1 "+l+" geometry not supported")}}function ph(h,i){var o,a=!1;for(o=0;o<i.coordinates.length;o++)if(xu(i.coordinates[o],h.coordinates)){a=!0;break}return a}function yh(h,i){for(var o=0;o<h.coordinates.length;o++){for(var a=!1,l=0;l<i.coordinates.length;l++)xu(h.coordinates[o],i.coordinates[l])&&(a=!0);if(!a)return!1}return!0}function vh(h,i){for(var o=!1,a=0;a<h.coordinates.length;a++){if(!Vs(h.coordinates[a],i))return!1;o||(o=Vs(h.coordinates[a],i,{ignoreEndVertices:!0}))}return o}function _h(h,i){for(var o=!0,a=!1,l=0;l<h.coordinates.length;l++){if(a=Ce(h.coordinates[l],i),!a){o=!1;break}a=Ce(h.coordinates[l],i,{ignoreBoundary:!0})}return o&&a}function xh(h,i){for(var o=0;o<h.coordinates.length;o++)if(!Vs(h.coordinates[o],i))return!1;return!0}function kh(h,i){var o=Si(i),a=Si(h);if(!_u(o,a))return!1;for(var l=!1,g=0;g<h.coordinates.length;g++){if(!Ce(h.coordinates[g],i))return!1;if(l||(l=Ce(h.coordinates[g],i,{ignoreBoundary:!0})),!l&&g<h.coordinates.length-1){var d=Eh(h.coordinates[g],h.coordinates[g+1]);l=Ce(d,i,{ignoreBoundary:!0})}}return l}function wh(h,i){var o=Si(h),a=Si(i);if(!_u(a,o))return!1;for(var l=0;l<h.coordinates[0].length;l++)if(!Ce(h.coordinates[0][l],i))return!1;return!0}function _u(h,i){return!(h[0]>i[0]||h[2]<i[2]||h[1]>i[1]||h[3]<i[3])}function xu(h,i){return h[0]===i[0]&&h[1]===i[1]}function Eh(h,i){return[(h[0]+i[0])/2,(h[1]+i[1])/2]}function Ph(h,i={}){const o=Si(h),a=(o[0]+o[2])/2,l=(o[1]+o[3])/2;return ae([a,l],i.properties,i)}var zs={exports:{}},Ih=zs.exports,xa;function Lh(){return xa||(xa=1,function(h,i){(function(o,a){h.exports=a()})(Ih,function(){function o(s,t){(t==null||t>s.length)&&(t=s.length);for(var e=0,r=Array(t);e<t;e++)r[e]=s[e];return r}function a(s,t,e){return t=w(t),function(r,c){if(c&&(typeof c=="object"||typeof c=="function"))return c;if(c!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}(r)}(s,b()?Reflect.construct(t,e||[],w(s).constructor):t.apply(s,e))}function l(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function g(s,t,e){if(b())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var c=new(s.bind.apply(s,r));return e&&F(c,e.prototype),c}function d(s,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(s,ot(r.key),r)}}function m(s,t,e){return t&&d(s.prototype,t),e&&d(s,e),Object.defineProperty(s,"prototype",{writable:!1}),s}function _(s,t){var e=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!e){if(Array.isArray(s)||(e=ut(s))||t){e&&(s=e);var r=0,c=function(){};return{s:c,n:function(){return r>=s.length?{done:!0}:{done:!1,value:s[r++]}},e:function(C){throw C},f:c}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p,v=!0,E=!1;return{s:function(){e=e.call(s)},n:function(){var C=e.next();return v=C.done,C},e:function(C){E=!0,p=C},f:function(){try{v||e.return==null||e.return()}finally{if(E)throw p}}}}function x(){return x=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(s,t,e){var r=function(p,v){for(;!{}.hasOwnProperty.call(p,v)&&(p=w(p))!==null;);return p}(s,t);if(r){var c=Object.getOwnPropertyDescriptor(r,t);return c.get?c.get.call(arguments.length<3?s:e):c.value}},x.apply(null,arguments)}function w(s){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(s)}function I(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&F(s,t)}function b(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(b=function(){return!!s})()}function F(s,t){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e},F(s,t)}function z(s,t,e,r){var c=x(w(1&r?s.prototype:s),t,e);return 2&r&&typeof c=="function"?function(p){return c.apply(e,p)}:c}function et(s){return function(t){if(Array.isArray(t))return o(t)}(s)||function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(s)||ut(s)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ot(s){var t=function(e,r){if(typeof e!="object"||!e)return e;var c=e[Symbol.toPrimitive];if(c!==void 0){var p=c.call(e,r);if(typeof p!="object")return p;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(s,"string");return typeof t=="symbol"?t:t+""}function ut(s,t){if(s){if(typeof s=="string")return o(s,t);var e={}.toString.call(s).slice(8,-1);return e==="Object"&&s.constructor&&(e=s.constructor.name),e==="Map"||e==="Set"?Array.from(s):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?o(s,t):void 0}}function S(s){var t=typeof Map=="function"?new Map:void 0;return S=function(e){if(e===null||!function(c){try{return Function.toString.call(c).indexOf("[native code]")!==-1}catch{return typeof c=="function"}}(e))return e;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return g(e,arguments,w(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),F(r,e)},S(s)}var G=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(t){this._quadrantSegments=t,this._quadrantSegments===0&&(this._joinStyle=s.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=s.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==s.JOIN_ROUND&&(this._quadrantSegments=s.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(t){this._joinStyle=t}},{key:"setSimplifyFactor",value:function(t){this._simplifyFactor=t<0?0:t}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(t){this._endCapStyle=t}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(t){this._mitreLimit=t}},{key:"setSingleSided",value:function(t){this._isSingleSided=t}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=s.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=s.CAP_ROUND,this._joinStyle=s.JOIN_ROUND,this._mitreLimit=s.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=s.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setQuadrantSegments(t)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(r)}else if(arguments.length===4){var c=arguments[0],p=arguments[1],v=arguments[2],E=arguments[3];this.setQuadrantSegments(c),this.setEndCapStyle(p),this.setJoinStyle(v),this.setMitreLimit(E)}}}},{key:"bufferDistanceError",value:function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)}}])}();G.CAP_ROUND=1,G.CAP_FLAT=2,G.CAP_SQUARE=3,G.JOIN_ROUND=1,G.JOIN_MITRE=2,G.JOIN_BEVEL=3,G.DEFAULT_QUADRANT_SEGMENTS=8,G.DEFAULT_MITRE_LIMIT=5,G.DEFAULT_SIMPLIFY_FACTOR=.01;var R=function(s){function t(e){var r;return l(this,t),(r=a(this,t,[e])).name=Object.keys({Exception:t})[0],r}return I(t,s),m(t,[{key:"toString",value:function(){return this.message}}])}(S(Error)),H=function(s){function t(e){var r;return l(this,t),(r=a(this,t,[e])).name=Object.keys({IllegalArgumentException:t})[0],r}return I(t,s),m(t)}(R),Y=function(){return m(function s(){l(this,s)},[{key:"filter",value:function(s){}}])}();function J(){}function P(){}function M(){}var N,A,O,V,q,X,B,j,U=function(){return m(function s(){l(this,s)},null,[{key:"equalsWithTolerance",value:function(s,t,e){return Math.abs(s-t)<=e}}])}(),tt=function(){return m(function s(t,e){l(this,s),this.low=e||0,this.high=t||0},null,[{key:"toBinaryString",value:function(s){var t,e="";for(t=2147483648;t>0;t>>>=1)e+=(s.high&t)===t?"1":"0";for(t=2147483648;t>0;t>>>=1)e+=(s.low&t)===t?"1":"0";return e}}])}();function W(){}function rt(){}W.NaN=NaN,W.isNaN=function(s){return Number.isNaN(s)},W.isInfinite=function(s){return!Number.isFinite(s)},W.MAX_VALUE=Number.MAX_VALUE,W.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,W.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(X=2146435072,B=new Float64Array(1),j=new Int32Array(B.buffer),W.doubleToLongBits=function(s){B[0]=s;var t=0|j[0],e=0|j[1];return(e&X)===X&&1048575&e&&t!==0&&(t=0,e=2146959360),new tt(e,t)},W.longBitsToDouble=function(s){return j[0]=s.low,j[1]=s.high,B[0]}):(N=1023,A=Math.log2,O=Math.floor,V=Math.pow,q=function(){for(var s=53;s>0;s--){var t=V(2,s)-1;if(O(A(t))+1===s)return t}return 0}(),W.doubleToLongBits=function(s){var t,e,r,c,p,v,E,C,D;if(s<0||1/s===Number.NEGATIVE_INFINITY?(v=1<<31,s=-s):v=0,s===0)return new tt(C=v,D=0);if(s===1/0)return new tt(C=2146435072|v,D=0);if(s!=s)return new tt(C=2146959360,D=0);if(c=0,D=0,(t=O(s))>1)if(t<=q)(c=O(A(t)))<=20?(D=0,C=t<<20-c&1048575):(D=t%(e=V(2,r=c-20))<<32-r,C=t/e&1048575);else for(r=t,D=0;(r=O(e=r/2))!==0;)c++,D>>>=1,D|=(1&C)<<31,C>>>=1,e!==r&&(C|=524288);if(E=c+N,p=t===0,t=s-t,c<52&&t!==0)for(r=0;;){if((e=2*t)>=1?(t=e-1,p?(E--,p=!1):(r<<=1,r|=1,c++)):(t=e,p?--E==0&&(c++,p=!1):(r<<=1,c++)),c===20)C|=r,r=0;else if(c===52){D|=r;break}if(e===1){c<20?C|=r<<20-c:c<52&&(D|=r<<52-c);break}}return C|=E<<20,new tt(C|=v,D)},W.longBitsToDouble=function(s){var t,e,r,c,p=s.high,v=s.low,E=p&1<<31?-1:1;for(r=((2146435072&p)>>20)-N,c=0,e=1<<19,t=1;t<=20;t++)p&e&&(c+=V(2,-t)),e>>>=1;for(e=1<<31,t=21;t<=52;t++)v&e&&(c+=V(2,-t)),e>>>=1;if(r===-1023){if(c===0)return 0*E;r=-1022}else{if(r===1024)return c===0?E/0:NaN;c+=1}return E*c*V(2,r)});var ht=function(s){function t(e){var r;return l(this,t),(r=a(this,t,[e])).name=Object.keys({RuntimeException:t})[0],r}return I(t,s),m(t)}(R),mt=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,null,[{key:"constructor_",value:function(){if(arguments.length===0)ht.constructor_.call(this);else if(arguments.length===1){var e=arguments[0];ht.constructor_.call(this,e)}}}])}(ht),at=function(){function s(){l(this,s)}return m(s,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)s.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new mt("Should never reach here"+(t!==null?": "+t:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var t=arguments[0];s.isTrue(t,null)}else if(arguments.length===2){var e=arguments[1];if(!arguments[0])throw e===null?new mt:new mt(e)}}},{key:"equals",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];s.equals(t,e,null)}else if(arguments.length===3){var r=arguments[0],c=arguments[1],p=arguments[2];if(!c.equals(r))throw new mt("Expected "+r+" but encountered "+c+(p!==null?": "+p:""))}}}])}(),ct=new ArrayBuffer(8),ft=new Float64Array(ct),kt=new Int32Array(ct),Q=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"getM",value:function(){return W.NaN}},{key:"setOrdinate",value:function(t,e){switch(t){case s.X:this.x=e;break;case s.Y:this.y=e;break;case s.Z:this.setZ(e);break;default:throw new H("Invalid ordinate index: "+t)}}},{key:"equals2D",value:function(){if(arguments.length===1){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(arguments.length===2){var e=arguments[0],r=arguments[1];return!!U.equalsWithTolerance(this.x,e.x,r)&&!!U.equalsWithTolerance(this.y,e.y,r)}}},{key:"setM",value:function(t){throw new H("Invalid ordinate index: "+s.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(t){switch(t){case s.X:return this.x;case s.Y:return this.y;case s.Z:return this.getZ()}throw new H("Invalid ordinate index: "+t)}},{key:"equals3D",value:function(t){return this.x===t.x&&this.y===t.y&&(this.getZ()===t.getZ()||W.isNaN(this.getZ())&&W.isNaN(t.getZ()))}},{key:"equals",value:function(t){return t instanceof s&&this.equals2D(t)}},{key:"equalInZ",value:function(t,e){return U.equalsWithTolerance(this.getZ(),t.getZ(),e)}},{key:"setX",value:function(t){this.x=t}},{key:"compareTo",value:function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(t){this.z=t}},{key:"clone",value:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return at.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}},{key:"copy",value:function(){return new s(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(t){var e=this.x-t.x,r=this.y-t.y,c=this.getZ()-t.getZ();return Math.sqrt(e*e+r*r+c*c)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(t){this.y=t}},{key:"distance",value:function(t){var e=this.x-t.x,r=this.y-t.y;return Math.sqrt(e*e+r*r)}},{key:"hashCode",value:function(){var t=17;return t=37*(t=37*t+s.hashCode(this.x))+s.hashCode(this.y)}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}},{key:"interfaces_",get:function(){return[J,P,M]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)s.constructor_.call(this,0,0);else if(arguments.length===1){var t=arguments[0];s.constructor_.call(this,t.x,t.y,t.getZ())}else if(arguments.length===2){var e=arguments[0],r=arguments[1];s.constructor_.call(this,e,r,s.NULL_ORDINATE)}else if(arguments.length===3){var c=arguments[0],p=arguments[1],v=arguments[2];this.x=c,this.y=p,this.z=v}}},{key:"hashCode",value:function(t){return ft[0]=t,kt[0]^kt[1]}}])}(),Xt=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"compare",value:function(t,e){var r=s.compare(t.x,e.x);if(r!==0)return r;var c=s.compare(t.y,e.y);return c!==0?c:this._dimensionsToTest<=2?0:s.compare(t.getZ(),e.getZ())}},{key:"interfaces_",get:function(){return[rt]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)s.constructor_.call(this,2);else if(arguments.length===1){var t=arguments[0];if(t!==2&&t!==3)throw new H("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}},{key:"compare",value:function(t,e){return t<e?-1:t>e?1:W.isNaN(t)?W.isNaN(e)?0:-1:W.isNaN(e)?1:0}}])}();Q.DimensionalComparator=Xt,Q.NULL_ORDINATE=W.NaN,Q.X=0,Q.Y=1,Q.Z=2,Q.M=3;var Ct=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(t){if(!(t instanceof s))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()}},{key:"intersection",value:function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new s;var e=this._minx>t._minx?this._minx:t._minx,r=this._miny>t._miny?this._miny:t._miny;return new s(e,this._maxx<t._maxx?this._maxx:t._maxx,r,this._maxy<t._maxy?this._maxy:t._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof Q){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof s){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(arguments.length===2){var r=arguments[0],c=arguments[1];return!this.isNull()&&r>=this._minx&&r<=this._maxx&&c>=this._miny&&c<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof s){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof Q){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(arguments.length===2){if(arguments[0]instanceof Q&&arguments[1]instanceof Q){var r=arguments[0],c=arguments[1];return!this.isNull()&&!((r.x<c.x?r.x:c.x)>this._maxx)&&!((r.x>c.x?r.x:c.x)<this._minx)&&!((r.y<c.y?r.y:c.y)>this._maxy)&&!((r.y>c.y?r.y:c.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var p=arguments[0],v=arguments[1];return!this.isNull()&&!(p>this._maxx||p<this._minx||v>this._maxy||v<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return Math.sqrt(t*t+e*e)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof Q){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof s){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(arguments.length===2){var r=arguments[0],c=arguments[1];this.isNull()?(this._minx=r,this._maxx=r,this._miny=c,this._maxy=c):(r<this._minx&&(this._minx=r),r>this._maxx&&(this._maxx=r),c<this._miny&&(this._miny=c),c>this._maxy&&(this._maxy=c))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}},{key:"translate",value:function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}},{key:"copy",value:function(){return new s(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(t){return!(!this.isNull()&&!t.isNull())||t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e}},{key:"expandBy",value:function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=r,this._maxy+=r,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof s){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof Q){var e=arguments[0];return this.covers(e)}}else if(arguments.length===2){var r=arguments[0],c=arguments[1];return this.covers(r,c)}}},{key:"centre",value:function(){return this.isNull()?null:new Q((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof Q){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof s){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(arguments.length===2){var r=arguments[0],c=arguments[1];this.init(r.x,c.x,r.y,c.y)}else if(arguments.length===4){var p=arguments[0],v=arguments[1],E=arguments[2],C=arguments[3];p<v?(this._minx=p,this._maxx=v):(this._minx=v,this._maxx=p),E<C?(this._miny=E,this._maxy=C):(this._miny=C,this._maxy=E)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var r=0;return this._maxy<t._miny?r=t._miny-this._maxy:this._miny>t._maxy&&(r=this._miny-t._maxy),e===0?r:r===0?e:Math.sqrt(e*e+r*r)}},{key:"hashCode",value:function(){var t=17;return t=37*(t=37*(t=37*(t=37*t+Q.hashCode(this._minx))+Q.hashCode(this._maxx))+Q.hashCode(this._miny))+Q.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[J,M]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof Q){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof s){var e=arguments[0];this.init(e)}}else if(arguments.length===2){var r=arguments[0],c=arguments[1];this.init(r.x,c.x,r.y,c.y)}else if(arguments.length===4){var p=arguments[0],v=arguments[1],E=arguments[2],C=arguments[3];this.init(p,v,E,C)}}},{key:"intersects",value:function(){if(arguments.length===3){var t=arguments[0],e=arguments[1],r=arguments[2];return r.x>=(t.x<e.x?t.x:e.x)&&r.x<=(t.x>e.x?t.x:e.x)&&r.y>=(t.y<e.y?t.y:e.y)&&r.y<=(t.y>e.y?t.y:e.y)}if(arguments.length===4){var c=arguments[0],p=arguments[1],v=arguments[2],E=arguments[3],C=Math.min(v.x,E.x),D=Math.max(v.x,E.x),$=Math.min(c.x,p.x),nt=Math.max(c.x,p.x);return!($>D)&&!(nt<C)&&(C=Math.min(v.y,E.y),D=Math.max(v.y,E.y),$=Math.min(c.y,p.y),nt=Math.max(c.y,p.y),!($>D)&&!(nt<C))}}}])}(),vt=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===s.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(t){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(t){return this===t||this.equalsExact(t,0)}},{key:"geometryChanged",value:function(){this.apply(s.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(t){return t!==null&&this.norm().equalsExact(t.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var t;if(arguments.length===1){var e=arguments[0];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(arguments.length===2){var r=arguments[0],c=arguments[1];return t=r,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(r,c)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(t){if(t.getTypeCode()===s.TYPECODE_GEOMETRYCOLLECTION)throw new H("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(t,e,r){return r===0?t.equals(e):t.distance(e)<=r}},{key:"norm",value:function(){var t=this.copy();return t.normalize(),t}},{key:"reverse",value:function(){var t=this.reverseInternal();return this.envelope!=null&&(t.envelope=this.envelope.copy()),t.setSRID(this.getSRID()),t}},{key:"copy",value:function(){var t=this.copyInternal();return t.envelope=this._envelope==null?null:this._envelope.copy(),t._SRID=this._SRID,t._userData=this._userData,t}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Ct(this._envelope)}},{key:"setSRID",value:function(t){this._SRID=t}},{key:"setUserData",value:function(t){this._userData=t}},{key:"compare",value:function(t,e){for(var r=t.iterator(),c=e.iterator();r.hasNext()&&c.hasNext();){var p=r.next(),v=c.next(),E=p.compareTo(v);if(E!==0)return E}return r.hasNext()?1:c.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(t){return this.getClass()===t.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===s.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===s.TYPECODE_MULTIPOINT||this.getTypeCode()===s.TYPECODE_MULTILINESTRING||this.getTypeCode()===s.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[P,J,M]}},{key:"getClass",value:function(){return s}}],[{key:"hasNonEmptyElements",value:function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(t){for(var e=0;e<t.length;e++)if(t[e]===null)return!0;return!1}}])}();vt.constructor_=function(s){s&&(this._envelope=null,this._userData=null,this._factory=s,this._SRID=s.getSRID())},vt.TYPECODE_POINT=0,vt.TYPECODE_MULTIPOINT=1,vt.TYPECODE_LINESTRING=2,vt.TYPECODE_LINEARRING=3,vt.TYPECODE_MULTILINESTRING=4,vt.TYPECODE_POLYGON=5,vt.TYPECODE_MULTIPOLYGON=6,vt.TYPECODE_GEOMETRYCOLLECTION=7,vt.TYPENAME_POINT="Point",vt.TYPENAME_MULTIPOINT="MultiPoint",vt.TYPENAME_LINESTRING="LineString",vt.TYPENAME_LINEARRING="LinearRing",vt.TYPENAME_MULTILINESTRING="MultiLineString",vt.TYPENAME_POLYGON="Polygon",vt.TYPENAME_MULTIPOLYGON="MultiPolygon",vt.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",vt.geometryChangedFilter={get interfaces_(){return[Y]},filter:function(s){s.geometryChangedAction()}};var Z=function(){function s(){l(this,s)}return m(s,null,[{key:"toLocationSymbol",value:function(t){switch(t){case s.EXTERIOR:return"e";case s.BOUNDARY:return"b";case s.INTERIOR:return"i";case s.NONE:return"-"}throw new H("Unknown location value: "+t)}}])}();Z.INTERIOR=0,Z.BOUNDARY=1,Z.EXTERIOR=2,Z.NONE=-1;var At=function(){return m(function s(){l(this,s)},[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}])}(),Gt=function(s){function t(e){var r;return l(this,t),(r=a(this,t,[e])).name=Object.keys({NoSuchElementException:t})[0],r}return I(t,s),m(t)}(R),Mt=function(s){function t(e){var r;return l(this,t),(r=a(this,t,[e])).name=Object.keys({UnsupportedOperationException:t})[0],r}return I(t,s),m(t)}(R),ke=function(s){function t(){return l(this,t),a(this,t,arguments)}return I(t,s),m(t,[{key:"contains",value:function(){}}])}(At),ce=function(s){function t(e){var r;return l(this,t),(r=a(this,t)).map=new Map,e instanceof At&&r.addAll(e),r}return I(t,s),m(t,[{key:"contains",value:function(e){var r=e.hashCode?e.hashCode():e;return!!this.map.has(r)}},{key:"add",value:function(e){var r=e.hashCode?e.hashCode():e;return!this.map.has(r)&&!!this.map.set(r,e)}},{key:"addAll",value:function(e){var r,c=_(e);try{for(c.s();!(r=c.n()).done;){var p=r.value;this.add(p)}}catch(v){c.e(v)}finally{c.f()}return!0}},{key:"remove",value:function(){throw new Mt}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new Ne(this.map)}},{key:Symbol.iterator,value:function(){return this.map}}])}(ke),Ne=function(){return m(function s(t){l(this,s),this.iterator=t.values();var e=this.iterator.next(),r=e.done,c=e.value;this.done=r,this.value=c},[{key:"next",value:function(){if(this.done)throw new Gt;var s=this.value,t=this.iterator.next(),e=t.done,r=t.value;return this.done=e,this.value=r,s}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new Mt}}])}(),pt=function(){function s(){l(this,s)}return m(s,null,[{key:"opposite",value:function(t){return t===s.LEFT?s.RIGHT:t===s.RIGHT?s.LEFT:t}}])}();pt.ON=0,pt.LEFT=1,pt.RIGHT=2;var ui=function(s){function t(e){var r;return l(this,t),(r=a(this,t,[e])).name=Object.keys({EmptyStackException:t})[0],r}return I(t,s),m(t)}(R),Zn=function(s){function t(e){var r;return l(this,t),(r=a(this,t,[e])).name=Object.keys({IndexOutOfBoundsException:t})[0],r}return I(t,s),m(t)}(R),Ye=function(s){function t(){return l(this,t),a(this,t,arguments)}return I(t,s),m(t,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}])}(At),Ti=function(s){function t(){var e;return l(this,t),(e=a(this,t)).array=[],e}return I(t,s),m(t,[{key:"add",value:function(e){return this.array.push(e),!0}},{key:"get",value:function(e){if(e<0||e>=this.size())throw new Zn;return this.array[e]}},{key:"push",value:function(e){return this.array.push(e),e}},{key:"pop",value:function(){if(this.array.length===0)throw new ui;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new ui;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(e){return this.array.indexOf(e)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}])}(Ye);function bt(s,t){return s.interfaces_&&s.interfaces_.indexOf(t)>-1}var yn=function(){return m(function s(t){l(this,s),this.str=t},[{key:"append",value:function(s){this.str+=s}},{key:"setCharAt",value:function(s,t){this.str=this.str.substr(0,s)+t+this.str.substr(s+1)}},{key:"toString",value:function(){return this.str}}])}(),Xe=function(){function s(t){l(this,s),this.value=t}return m(s,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(t){return this.value<t?-1:this.value>t?1:0}}],[{key:"compare",value:function(t,e){return t<e?-1:t>e?1:0}},{key:"isNan",value:function(t){return Number.isNaN(t)}},{key:"valueOf",value:function(t){return new s(t)}}])}(),Ni=function(){return m(function s(){l(this,s)},null,[{key:"isWhitespace",value:function(s){return s<=32&&s>=0||s===127}},{key:"toUpperCase",value:function(s){return s.toUpperCase()}}])}(),St=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"le",value:function(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}},{key:"extractSignificantDigits",value:function(t,e){var r=this.abs(),c=s.magnitude(r._hi),p=s.TEN.pow(c);(r=r.divide(p)).gt(s.TEN)?(r=r.divide(s.TEN),c+=1):r.lt(s.ONE)&&(r=r.multiply(s.TEN),c-=1);for(var v=c+1,E=new yn,C=s.MAX_PRINT_DIGITS-1,D=0;D<=C;D++){t&&D===v&&E.append(".");var $=Math.trunc(r._hi);if($<0)break;var nt=!1,gt=0;$>9?(nt=!0,gt="9"):gt="0"+$,E.append(gt),r=r.subtract(s.valueOf($)).multiply(s.TEN),nt&&r.selfAdd(s.TEN);var xt=!0,Et=s.magnitude(r._hi);if(Et<0&&Math.abs(Et)>=C-D&&(xt=!1),!xt)break}return e[0]=c,E.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof s){var t=arguments[0];return this.add(t.negate())}if(typeof arguments[0]=="number"){var e=arguments[0];return this.add(-e)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof s){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof s){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(t){return this.le(t)?this:t}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof s){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfDivide(e,0)}}else if(arguments.length===2){var r,c,p,v,E=arguments[0],C=arguments[1],D=null,$=null,nt=null,gt=null;return p=this._hi/E,gt=(D=(nt=s.SPLIT*p)-(D=nt-p))*($=(gt=s.SPLIT*E)-($=gt-E))-(v=p*E)+D*(c=E-$)+(r=p-D)*$+r*c,gt=p+(nt=(this._hi-v-gt+this._lo-p*C)/E),this._hi=gt,this._lo=p-gt+nt,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof s){var t,e,r,c,p=arguments[0],v=null,E=null,C=null,D=null;return t=(r=this._hi/p._hi)-(v=(C=s.SPLIT*r)-(v=C-r)),D=v*(E=(D=s.SPLIT*p._hi)-(E=D-p._hi))-(c=r*p._hi)+v*(e=p._hi-E)+t*E+t*e,new s(D=r+(C=(this._hi-c-D+this._lo-r*p._lo)/p._hi),r-D+C)}if(typeof arguments[0]=="number"){var $=arguments[0];return W.isNaN($)?s.createNaN():s.copy(this).selfDivide($,0)}}},{key:"ge",value:function(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}},{key:"pow",value:function(t){if(t===0)return s.valueOf(1);var e=new s(this),r=s.valueOf(1),c=Math.abs(t);if(c>1)for(;c>0;)c%2==1&&r.selfMultiply(e),(c/=2)>0&&(e=e.sqr());else r=e;return t<0?r.reciprocal():r}},{key:"ceil",value:function(){if(this.isNaN())return s.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new s(t,e)}},{key:"compareTo",value:function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof s){var t=arguments[0];return this.init(t),this}if(typeof arguments[0]=="number"){var e=arguments[0];return this.init(e),this}}},{key:"max",value:function(t){return this.ge(t)?this:t}},{key:"sqrt",value:function(){if(this.isZero())return s.valueOf(0);if(this.isNegative())return s.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,r=s.valueOf(e),c=this.subtract(r.sqr())._hi*(.5*t);return r.add(c)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof s){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if(typeof arguments[0]=="number"){var e,r,c,p,v,E=arguments[0],C=null;return C=(c=this._hi+E)-(p=c-this._hi),r=(v=(C=E-p+(this._hi-C))+this._lo)+(c-(e=c+v)),this._hi=e+r,this._lo=r+(e-this._hi),this}}else if(arguments.length===2){var D,$,nt,gt,xt=arguments[0],Et=arguments[1],It=null,Ut=null,zt=null;nt=this._hi+xt,$=this._lo+Et,Ut=nt-(zt=nt-this._hi),It=$-(gt=$-this._lo);var jt=(D=nt+(zt=(Ut=xt-zt+(this._hi-Ut))+$))+(zt=(It=Et-gt+(this._lo-It))+(zt+(nt-D))),te=zt+(D-jt);return this._hi=jt,this._lo=te,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof s){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfMultiply(e,0)}}else if(arguments.length===2){var r,c,p=arguments[0],v=arguments[1],E=null,C=null,D=null,$=null;E=(D=s.SPLIT*this._hi)-this._hi,$=s.SPLIT*p,E=D-E,r=this._hi-E,C=$-p;var nt=(D=this._hi*p)+($=E*(C=$-C)-D+E*(c=p-C)+r*C+r*c+(this._hi*v+this._lo*p)),gt=$+(E=D-nt);return this._hi=nt,this._lo=gt,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return s.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new s(t,e)}},{key:"negate",value:function(){return this.isNaN()?this:new s(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}},{key:"multiply",value:function(){if(arguments[0]instanceof s){var t=arguments[0];return t.isNaN()?s.createNaN():s.copy(this).selfMultiply(t)}if(typeof arguments[0]=="number"){var e=arguments[0];return W.isNaN(e)?s.createNaN():s.copy(this).selfMultiply(e,0)}}},{key:"isNaN",value:function(){return W.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var t=s.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),r=this.extractSignificantDigits(!0,e),c=e[0]+1,p=r;if(r.charAt(0)===".")p="0"+r;else if(c<0)p="0."+s.stringOfChar("0",-c)+r;else if(r.indexOf(".")===-1){var v=c-r.length;p=r+s.stringOfChar("0",v)+".0"}return this.isNegative()?"-"+p:p}},{key:"reciprocal",value:function(){var t,e,r,c,p=null,v=null,E=null,C=null;t=(r=1/this._hi)-(p=(E=s.SPLIT*r)-(p=E-r)),v=(C=s.SPLIT*this._hi)-this._hi;var D=r+(E=(1-(c=r*this._hi)-(C=p*(v=C-v)-c+p*(e=this._hi-v)+t*v+t*e)-r*this._lo)/this._hi);return new s(D,r-D+E)}},{key:"toSciNotation",value:function(){if(this.isZero())return s.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),r=this.extractSignificantDigits(!1,e),c=s.SCI_NOT_EXPONENT_CHAR+e[0];if(r.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+r);var p="";r.length>1&&(p=r.substring(1));var v=r.charAt(0)+"."+p;return this.isNegative()?"-"+v+c:v+c}},{key:"abs",value:function(){return this.isNaN()?s.NaN:this.isNegative()?this.negate():new s(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}},{key:"add",value:function(){if(arguments[0]instanceof s){var t=arguments[0];return s.copy(this).selfAdd(t)}if(typeof arguments[0]=="number"){var e=arguments[0];return s.copy(this).selfAdd(e)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof s){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(arguments.length===2){var r=arguments[0],c=arguments[1];this._hi=r,this._lo=c}}},{key:"gt",value:function(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?s.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[M,J,P]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof s){var e=arguments[0];this.init(e)}else if(typeof arguments[0]=="string"){var r=arguments[0];s.constructor_.call(this,s.parse(r))}}else if(arguments.length===2){var c=arguments[0],p=arguments[1];this.init(c,p)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1],r=arguments[2],c=arguments[3];return s.determinant(s.valueOf(t),s.valueOf(e),s.valueOf(r),s.valueOf(c))}if(arguments[3]instanceof s&&arguments[2]instanceof s&&arguments[0]instanceof s&&arguments[1]instanceof s){var p=arguments[1],v=arguments[2],E=arguments[3];return arguments[0].multiply(E).selfSubtract(p.multiply(v))}}},{key:"sqr",value:function(t){return s.valueOf(t).selfMultiply(t)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var t=arguments[0];return s.parse(t)}if(typeof arguments[0]=="number")return new s(arguments[0])}},{key:"sqrt",value:function(t){return s.valueOf(t).sqrt()}},{key:"parse",value:function(t){for(var e=0,r=t.length;Ni.isWhitespace(t.charAt(e));)e++;var c=!1;if(e<r){var p=t.charAt(e);p!=="-"&&p!=="+"||(e++,p==="-"&&(c=!0))}for(var v=new s,E=0,C=0,D=0,$=!1;!(e>=r);){var nt=t.charAt(e);if(e++,Ni.isDigit(nt)){var gt=nt-"0";v.selfMultiply(s.TEN),v.selfAdd(gt),E++}else{if(nt!=="."){if(nt==="e"||nt==="E"){var xt=t.substring(e);try{D=Xe.parseInt(xt)}catch(jt){throw jt instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+xt+" in string "+t):jt}break}throw new NumberFormatException("Unexpected character '"+nt+"' at position "+e+" in string "+t)}C=E,$=!0}}var Et=v;$||(C=E);var It=E-C-D;if(It===0)Et=v;else if(It>0){var Ut=s.TEN.pow(It);Et=v.divide(Ut)}else if(It<0){var zt=s.TEN.pow(-It);Et=v.multiply(zt)}return c?Et.negate():Et}},{key:"createNaN",value:function(){return new s(W.NaN,W.NaN)}},{key:"copy",value:function(t){return new s(t)}},{key:"magnitude",value:function(t){var e=Math.abs(t),r=Math.log(e)/Math.log(10),c=Math.trunc(Math.floor(r));return 10*Math.pow(10,c)<=e&&(c+=1),c}},{key:"stringOfChar",value:function(t,e){for(var r=new yn,c=0;c<e;c++)r.append(t);return r.toString()}}])}();St.PI=new St(3.141592653589793,12246467991473532e-32),St.TWO_PI=new St(6.283185307179586,24492935982947064e-32),St.PI_2=new St(1.5707963267948966,6123233995736766e-32),St.E=new St(2.718281828459045,14456468917292502e-32),St.NaN=new St(W.NaN,W.NaN),St.EPS=123259516440783e-46,St.SPLIT=134217729,St.MAX_PRINT_DIGITS=32,St.TEN=St.valueOf(10),St.ONE=St.valueOf(1),St.SCI_NOT_EXPONENT_CHAR="E",St.SCI_NOT_ZERO="0.0E0";var hr=function(){function s(){l(this,s)}return m(s,null,[{key:"orientationIndex",value:function(t,e,r){var c=s.orientationIndexFilter(t,e,r);if(c<=1)return c;var p=St.valueOf(e.x).selfAdd(-t.x),v=St.valueOf(e.y).selfAdd(-t.y),E=St.valueOf(r.x).selfAdd(-e.x),C=St.valueOf(r.y).selfAdd(-e.y);return p.selfMultiply(C).selfSubtract(v.selfMultiply(E)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof St&&arguments[2]instanceof St&&arguments[0]instanceof St&&arguments[1]instanceof St){var t=arguments[1],e=arguments[2],r=arguments[3];return arguments[0].multiply(r).selfSubtract(t.multiply(e)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var c=arguments[0],p=arguments[1],v=arguments[2],E=arguments[3],C=St.valueOf(c),D=St.valueOf(p),$=St.valueOf(v),nt=St.valueOf(E);return C.multiply(nt).selfSubtract(D.multiply($)).signum()}}},{key:"intersection",value:function(t,e,r,c){var p=new St(t.y).selfSubtract(e.y),v=new St(e.x).selfSubtract(t.x),E=new St(t.x).selfMultiply(e.y).selfSubtract(new St(e.x).selfMultiply(t.y)),C=new St(r.y).selfSubtract(c.y),D=new St(c.x).selfSubtract(r.x),$=new St(r.x).selfMultiply(c.y).selfSubtract(new St(c.x).selfMultiply(r.y)),nt=v.multiply($).selfSubtract(D.multiply(E)),gt=C.multiply(E).selfSubtract(p.multiply($)),xt=p.multiply(D).selfSubtract(C.multiply(v)),Et=nt.selfDivide(xt).doubleValue(),It=gt.selfDivide(xt).doubleValue();return W.isNaN(Et)||W.isInfinite(Et)||W.isNaN(It)||W.isInfinite(It)?null:new Q(Et,It)}},{key:"orientationIndexFilter",value:function(t,e,r){var c=null,p=(t.x-r.x)*(e.y-r.y),v=(t.y-r.y)*(e.x-r.x),E=p-v;if(p>0){if(v<=0)return s.signum(E);c=p+v}else{if(!(p<0)||v>=0)return s.signum(E);c=-p-v}var C=s.DP_SAFE_EPSILON*c;return E>=C||-E>=C?s.signum(E):2}},{key:"signum",value:function(t){return t>0?1:t<0?-1:0}}])}();hr.DP_SAFE_EPSILON=1e-15;var Ht=function(){return m(function s(){l(this,s)},[{key:"getM",value:function(s){if(this.hasM()){var t=this.getDimension()-this.getMeasures();return this.getOrdinate(s,t)}return W.NaN}},{key:"setOrdinate",value:function(s,t,e){}},{key:"getZ",value:function(s){return this.hasZ()?this.getOrdinate(s,2):W.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(s,t){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(s){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(s){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(s){}},{key:"copy",value:function(){}},{key:"getY",value:function(s){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[P]}}])}();Ht.X=0,Ht.Y=1,Ht.Z=2,Ht.M=3;var Tt=function(){function s(){l(this,s)}return m(s,null,[{key:"index",value:function(t,e,r){return hr.orientationIndex(t,e,r)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var t=arguments[0],e=t.length-1;if(e<3)throw new H("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=t[0],c=0,p=1;p<=e;p++){var v=t[p];v.y>r.y&&(r=v,c=p)}var E=c;do(E-=1)<0&&(E=e);while(t[E].equals2D(r)&&E!==c);var C=c;do C=(C+1)%e;while(t[C].equals2D(r)&&C!==c);var D=t[E],$=t[C];if(D.equals2D(r)||$.equals2D(r)||D.equals2D($))return!1;var nt=s.index(D,r,$);return nt===0?D.x>$.x:nt>0}if(bt(arguments[0],Ht)){var gt=arguments[0],xt=gt.size()-1;if(xt<3)throw new H("Ring has fewer than 4 points, so orientation cannot be determined");for(var Et=gt.getCoordinate(0),It=0,Ut=1;Ut<=xt;Ut++){var zt=gt.getCoordinate(Ut);zt.y>Et.y&&(Et=zt,It=Ut)}var jt=null,te=It;do(te-=1)<0&&(te=xt),jt=gt.getCoordinate(te);while(jt.equals2D(Et)&&te!==It);var ge=null,In=It;do In=(In+1)%xt,ge=gt.getCoordinate(In);while(ge.equals2D(Et)&&In!==It);if(jt.equals2D(Et)||ge.equals2D(Et)||jt.equals2D(ge))return!1;var Ei=s.index(jt,Et,ge);return Ei===0?jt.x>ge.x:Ei>0}}}])}();Tt.CLOCKWISE=-1,Tt.RIGHT=Tt.CLOCKWISE,Tt.COUNTERCLOCKWISE=1,Tt.LEFT=Tt.COUNTERCLOCKWISE,Tt.COLLINEAR=0,Tt.STRAIGHT=Tt.COLLINEAR;var io=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(s,t){var e=this.getRightmostSideOfSegment(s,t);return e<0&&(e=this.getRightmostSideOfSegment(s,t-1)),e<0&&(this._minCoord=null,this.checkForRightmostCoordinate(s)),e}},{key:"findRightmostEdgeAtVertex",value:function(){var s=this._minDe.getEdge().getCoordinates();at.isTrue(this._minIndex>0&&this._minIndex<s.length,"rightmost point expected to be interior vertex of edge");var t=s[this._minIndex-1],e=s[this._minIndex+1],r=Tt.index(this._minCoord,e,t),c=!1;(t.y<this._minCoord.y&&e.y<this._minCoord.y&&r===Tt.COUNTERCLOCKWISE||t.y>this._minCoord.y&&e.y>this._minCoord.y&&r===Tt.CLOCKWISE)&&(c=!0),c&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(s,t){var e=s.getEdge().getCoordinates();if(t<0||t+1>=e.length||e[t].y===e[t+1].y)return-1;var r=pt.LEFT;return e[t].y<e[t+1].y&&(r=pt.RIGHT),r}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(s){for(var t=s.getEdge().getCoordinates(),e=0;e<t.length-1;e++)(this._minCoord===null||t[e].x>this._minCoord.x)&&(this._minDe=s,this._minIndex=e,this._minCoord=t[e])}},{key:"findRightmostEdgeAtNode",value:function(){var s=this._minDe.getNode().getEdges();this._minDe=s.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(s){for(var t=s.iterator();t.hasNext();){var e=t.next();e.isForward()&&this.checkForRightmostCoordinate(e)}at.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===pt.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}])}(),Ve=function(s){function t(e,r){var c;return l(this,t),(c=a(this,t,[r?e+" [ "+r+" ]":e])).pt=r?new Q(r):void 0,c.name=Object.keys({TopologyException:t})[0],c}return I(t,s),m(t,[{key:"getCoordinate",value:function(){return this.pt}}])}(ht),cr=function(){return m(function s(){l(this,s),this.array=[]},[{key:"addLast",value:function(s){this.array.push(s)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}])}(),Lt=function(s){function t(e){var r;return l(this,t),(r=a(this,t)).array=[],e instanceof At&&r.addAll(e),r}return I(t,s),m(t,[{key:"interfaces_",get:function(){return[Ye,At]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(e){return arguments.length===1?this.array.push(e):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(e){var r,c=_(e);try{for(c.s();!(r=c.n()).done;){var p=r.value;this.array.push(p)}}catch(v){c.e(v)}finally{c.f()}}},{key:"set",value:function(e,r){var c=this.array[e];return this.array[e]=r,c}},{key:"iterator",value:function(){return new ro(this)}},{key:"get",value:function(e){if(e<0||e>=this.size())throw new Zn;return this.array[e]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(e){e?this.array.sort(function(r,c){return e.compare(r,c)}):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(e){for(var r=0,c=this.array.length;r<c;r++)if(this.array[r]===e)return!!this.array.splice(r,1);return!1}},{key:Symbol.iterator,value:function(){return this.array.values()}}])}(Ye),ro=function(){return m(function s(t){l(this,s),this.arrayList=t,this.position=0},[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new Gt;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(s){return this.arrayList.set(this.position-1,s)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}])}(),li=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"clearVisitedEdges",value:function(){for(var s=this._dirEdgeList.iterator();s.hasNext();)s.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(s){for(var t=null,e=s.getEdges().iterator();e.hasNext();){var r=e.next();if(r.isVisited()||r.getSym().isVisited()){t=r;break}}if(t===null)throw new Ve("unable to find edge to compute depths at "+s.getCoordinate());s.getEdges().computeDepths(t);for(var c=s.getEdges().iterator();c.hasNext();){var p=c.next();p.setVisited(!0),this.copySymDepths(p)}}},{key:"computeDepth",value:function(s){this.clearVisitedEdges();var t=this._finder.getEdge();t.getNode(),t.getLabel(),t.setEdgeDepths(pt.RIGHT,s),this.copySymDepths(t),this.computeDepths(t)}},{key:"create",value:function(s){this.addReachable(s),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var s=this._dirEdgeList.iterator();s.hasNext();){var t=s.next();t.getDepth(pt.RIGHT)>=1&&t.getDepth(pt.LEFT)<=0&&!t.isInteriorAreaEdge()&&t.setInResult(!0)}}},{key:"computeDepths",value:function(s){var t=new ce,e=new cr,r=s.getNode();for(e.addLast(r),t.add(r),s.setVisited(!0);!e.isEmpty();){var c=e.removeFirst();t.add(c),this.computeNodeDepth(c);for(var p=c.getEdges().iterator();p.hasNext();){var v=p.next().getSym();if(!v.isVisited()){var E=v.getNode();t.contains(E)||(e.addLast(E),t.add(E))}}}}},{key:"compareTo",value:function(s){var t=s;return this._rightMostCoord.x<t._rightMostCoord.x?-1:this._rightMostCoord.x>t._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var s=new Ct,t=this._dirEdgeList.iterator();t.hasNext();)for(var e=t.next().getEdge().getCoordinates(),r=0;r<e.length-1;r++)s.expandToInclude(e[r]);this._env=s}return this._env}},{key:"addReachable",value:function(s){var t=new Ti;for(t.add(s);!t.empty();){var e=t.pop();this.add(e,t)}}},{key:"copySymDepths",value:function(s){var t=s.getSym();t.setDepth(pt.LEFT,s.getDepth(pt.RIGHT)),t.setDepth(pt.RIGHT,s.getDepth(pt.LEFT))}},{key:"add",value:function(s,t){s.setVisited(!0),this._nodes.add(s);for(var e=s.getEdges().iterator();e.hasNext();){var r=e.next();this._dirEdgeList.add(r);var c=r.getSym().getNode();c.isVisited()||t.push(c)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[J]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new Lt,this._nodes=new Lt,this._rightMostCoord=null,this._env=null,this._finder=new io}}])}(),fr=function(){return m(function s(){l(this,s)},null,[{key:"intersection",value:function(s,t,e,r){var c=s.x<t.x?s.x:t.x,p=s.y<t.y?s.y:t.y,v=s.x>t.x?s.x:t.x,E=s.y>t.y?s.y:t.y,C=e.x<r.x?e.x:r.x,D=e.y<r.y?e.y:r.y,$=e.x>r.x?e.x:r.x,nt=e.y>r.y?e.y:r.y,gt=((c>C?c:C)+(v<$?v:$))/2,xt=((p>D?p:D)+(E<nt?E:nt))/2,Et=s.x-gt,It=s.y-xt,Ut=t.x-gt,zt=t.y-xt,jt=e.x-gt,te=e.y-xt,ge=r.x-gt,In=r.y-xt,Ei=It-zt,nn=Ut-Et,Br=Et*zt-Ut*It,zr=te-In,ti=ge-jt,Es=jt*In-ge*te,Pi=Ei*ti-zr*nn,Bn=(nn*Es-ti*Br)/Pi,Qi=(zr*Br-Ei*Es)/Pi;return W.isNaN(Bn)||W.isInfinite(Bn)||W.isNaN(Qi)||W.isInfinite(Qi)?null:new Q(Bn+gt,Qi+xt)}}])}(),Fe=function(){return m(function s(){l(this,s)},null,[{key:"arraycopy",value:function(s,t,e,r,c){for(var p=0,v=t;v<t+c;v++)e[r+p]=s[v],p++}},{key:"getProperty",value:function(s){return{"line.separator":`
`}[s]}}])}(),Un=function(){function s(){l(this,s)}return m(s,null,[{key:"log10",value:function(t){var e=Math.log(t);return W.isInfinite(e)||W.isNaN(e)?e:e/s.LOG_10}},{key:"min",value:function(t,e,r,c){var p=t;return e<p&&(p=e),r<p&&(p=r),c<p&&(p=c),p}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1],r=arguments[2];return t<e?e:t>r?r:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var c=arguments[0],p=arguments[1],v=arguments[2];return c<p?p:c>v?v:c}}},{key:"wrap",value:function(t,e){return t<0?e- -t%e:t%e}},{key:"max",value:function(){if(arguments.length===3){var t=arguments[1],e=arguments[2],r=arguments[0];return t>r&&(r=t),e>r&&(r=e),r}if(arguments.length===4){var c=arguments[1],p=arguments[2],v=arguments[3],E=arguments[0];return c>E&&(E=c),p>E&&(E=p),v>E&&(E=v),E}}},{key:"average",value:function(t,e){return(t+e)/2}}])}();Un.LOG_10=Math.log(10);var qe=function(){function s(){l(this,s)}return m(s,null,[{key:"segmentToSegment",value:function(t,e,r,c){if(t.equals(e))return s.pointToSegment(t,r,c);if(r.equals(c))return s.pointToSegment(c,t,e);var p=!1;if(Ct.intersects(t,e,r,c)){var v=(e.x-t.x)*(c.y-r.y)-(e.y-t.y)*(c.x-r.x);if(v===0)p=!0;else{var E=(t.y-r.y)*(c.x-r.x)-(t.x-r.x)*(c.y-r.y),C=((t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y))/v,D=E/v;(D<0||D>1||C<0||C>1)&&(p=!0)}}else p=!0;return p?Un.min(s.pointToSegment(t,r,c),s.pointToSegment(e,r,c),s.pointToSegment(r,t,e),s.pointToSegment(c,t,e)):0}},{key:"pointToSegment",value:function(t,e,r){if(e.x===r.x&&e.y===r.y)return t.distance(e);var c=(r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y),p=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/c;if(p<=0)return t.distance(e);if(p>=1)return t.distance(r);var v=((e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y))/c;return Math.abs(v)*Math.sqrt(c)}},{key:"pointToLinePerpendicular",value:function(t,e,r){var c=(r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y),p=((e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y))/c;return Math.abs(p)*Math.sqrt(c)}},{key:"pointToSegmentString",value:function(t,e){if(e.length===0)throw new H("Line array must contain at least one vertex");for(var r=t.distance(e[0]),c=0;c<e.length-1;c++){var p=s.pointToSegment(t,e[c],e[c+1]);p<r&&(r=p)}return r}}])}(),gr=function(){return m(function s(){l(this,s)},[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||bt(arguments[0],Ht);else if(arguments.length!==2){if(arguments.length===3){var s=arguments[0],t=arguments[1];return this.create(s,t)}}}}])}(),bi=function(){return m(function s(){l(this,s)},[{key:"filter",value:function(s){}}])}(),so=function(){return m(function s(){l(this,s)},null,[{key:"ofLine",value:function(s){var t=s.size();if(t<=1)return 0;var e=0,r=new Q;s.getCoordinate(0,r);for(var c=r.x,p=r.y,v=1;v<t;v++){s.getCoordinate(v,r);var E=r.x,C=r.y,D=E-c,$=C-p;e+=Math.sqrt(D*D+$*$),c=E,p=C}return e}}])}(),ss=m(function s(){l(this,s)}),Nn=function(){function s(){l(this,s)}return m(s,null,[{key:"copyCoord",value:function(t,e,r,c){for(var p=Math.min(t.getDimension(),r.getDimension()),v=0;v<p;v++)r.setOrdinate(c,v,t.getOrdinate(e,v))}},{key:"isRing",value:function(t){var e=t.size();return e===0||!(e<=3)&&t.getOrdinate(0,Ht.X)===t.getOrdinate(e-1,Ht.X)&&t.getOrdinate(0,Ht.Y)===t.getOrdinate(e-1,Ht.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(bt(arguments[0],Ht)&&Number.isInteger(arguments[1])){var t=arguments[0],e=arguments[1];s.scroll(t,e,s.isRing(t))}else if(bt(arguments[0],Ht)&&arguments[1]instanceof Q){var r=arguments[0],c=arguments[1],p=s.indexOf(c,r);if(p<=0)return null;s.scroll(r,p)}}else if(arguments.length===3){var v=arguments[0],E=arguments[1],C=arguments[2];if(E<=0)return null;for(var D=v.copy(),$=C?v.size()-1:v.size(),nt=0;nt<$;nt++)for(var gt=0;gt<v.getDimension();gt++)v.setOrdinate(nt,gt,D.getOrdinate((E+nt)%$,gt));if(C)for(var xt=0;xt<v.getDimension();xt++)v.setOrdinate($,xt,v.getOrdinate(0,xt))}}},{key:"isEqual",value:function(t,e){var r=t.size();if(r!==e.size())return!1;for(var c=Math.min(t.getDimension(),e.getDimension()),p=0;p<r;p++)for(var v=0;v<c;v++){var E=t.getOrdinate(p,v),C=e.getOrdinate(p,v);if(t.getOrdinate(p,v)!==e.getOrdinate(p,v)&&(!W.isNaN(E)||!W.isNaN(C)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var t=arguments[0];return s.minCoordinateIndex(t,0,t.size()-1)}if(arguments.length===3){for(var e=arguments[0],r=arguments[2],c=-1,p=null,v=arguments[1];v<=r;v++){var E=e.getCoordinate(v);(p===null||p.compareTo(E)>0)&&(p=E,c=v)}return c}}},{key:"extend",value:function(t,e,r){var c=t.create(r,e.getDimension()),p=e.size();if(s.copy(e,0,c,0,p),p>0)for(var v=p;v<r;v++)s.copy(e,p-1,c,v,1);return c}},{key:"reverse",value:function(t){for(var e=t.size()-1,r=Math.trunc(e/2),c=0;c<=r;c++)s.swap(t,c,e-c)}},{key:"swap",value:function(t,e,r){if(e===r)return null;for(var c=0;c<t.getDimension();c++){var p=t.getOrdinate(e,c);t.setOrdinate(e,c,t.getOrdinate(r,c)),t.setOrdinate(r,c,p)}}},{key:"copy",value:function(t,e,r,c,p){for(var v=0;v<p;v++)s.copyCoord(t,e+v,r,c+v)}},{key:"ensureValidRing",value:function(t,e){var r=e.size();return r===0?e:r<=3?s.createClosedRing(t,e,4):e.getOrdinate(0,Ht.X)===e.getOrdinate(r-1,Ht.X)&&e.getOrdinate(0,Ht.Y)===e.getOrdinate(r-1,Ht.Y)?e:s.createClosedRing(t,e,r+1)}},{key:"indexOf",value:function(t,e){for(var r=0;r<e.size();r++)if(t.x===e.getOrdinate(r,Ht.X)&&t.y===e.getOrdinate(r,Ht.Y))return r;return-1}},{key:"createClosedRing",value:function(t,e,r){var c=t.create(r,e.getDimension()),p=e.size();s.copy(e,0,c,0,p);for(var v=p;v<r;v++)s.copy(e,0,c,v,1);return c}},{key:"minCoordinate",value:function(t){for(var e=null,r=0;r<t.size();r++){var c=t.getCoordinate(r);(e===null||e.compareTo(c)>0)&&(e=c)}return e}}])}(),_t=function(){function s(){l(this,s)}return m(s,null,[{key:"toDimensionSymbol",value:function(t){switch(t){case s.FALSE:return s.SYM_FALSE;case s.TRUE:return s.SYM_TRUE;case s.DONTCARE:return s.SYM_DONTCARE;case s.P:return s.SYM_P;case s.L:return s.SYM_L;case s.A:return s.SYM_A}throw new H("Unknown dimension value: "+t)}},{key:"toDimensionValue",value:function(t){switch(Ni.toUpperCase(t)){case s.SYM_FALSE:return s.FALSE;case s.SYM_TRUE:return s.TRUE;case s.SYM_DONTCARE:return s.DONTCARE;case s.SYM_P:return s.P;case s.SYM_L:return s.L;case s.SYM_A:return s.A}throw new H("Unknown dimension symbol: "+t)}}])}();_t.P=0,_t.L=1,_t.A=2,_t.FALSE=-1,_t.TRUE=-2,_t.DONTCARE=-3,_t.SYM_FALSE="F",_t.SYM_TRUE="T",_t.SYM_DONTCARE="*",_t.SYM_P="0",_t.SYM_L="1",_t.SYM_A="2";var Oi=function(){return m(function s(){l(this,s)},[{key:"filter",value:function(s){}}])}(),Yn=function(){return m(function s(){l(this,s)},[{key:"filter",value:function(s,t){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}])}(),hi=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new Ct:this._points.expandEnvelope(new Ct)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new t(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],r=arguments[1];if(!this.isEquivalentClass(e))return!1;var c=e;if(this._points.size()!==c._points.size())return!1;for(var p=0;p<this._points.size();p++)if(!this.equal(this._points.getCoordinate(p),c._points.getCoordinate(p),r))return!1;return!0}return z(t,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var e=0;e<Math.trunc(this._points.size()/2);e++){var r=this._points.size()-1-e;if(!this._points.getCoordinate(e).equals(this._points.getCoordinate(r))){if(this._points.getCoordinate(e).compareTo(this._points.getCoordinate(r))>0){var c=this._points.copy();Nn.reverse(c),this._points=c}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?_t.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var e=this._points.copy();return Nn.reverse(e),this.getFactory().createLineString(e)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return vt.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return so.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var e=arguments[0],r=0,c=0;r<this._points.size()&&c<e._points.size();){var p=this._points.getCoordinate(r).compareTo(e._points.getCoordinate(c));if(p!==0)return p;r++,c++}return r<this._points.size()?1:c<e._points.size()?-1:0}if(arguments.length===2){var v=arguments[0];return arguments[1].compare(this._points,v._points)}}},{key:"apply",value:function(){if(bt(arguments[0],bi))for(var e=arguments[0],r=0;r<this._points.size();r++)e.filter(this._points.getCoordinate(r));else if(bt(arguments[0],Yn)){var c=arguments[0];if(this._points.size()===0)return null;for(var p=0;p<this._points.size()&&(c.filter(this._points,p),!c.isDone());p++);c.isGeometryChanged()&&this.geometryChanged()}else bt(arguments[0],Oi)?arguments[0].filter(this):bt(arguments[0],Y)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new Mt}},{key:"isEquivalentClass",value:function(e){return e instanceof t}},{key:"getCoordinateN",value:function(e){return this._points.getCoordinate(e)}},{key:"getGeometryType",value:function(){return vt.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(e){if(e===null&&(e=this.getFactory().getCoordinateSequenceFactory().create([])),e.size()===1)throw new H("Invalid number of points in LineString (found "+e.size()+" - must be 0 or >= 2)");this._points=e}},{key:"isCoordinate",value:function(e){for(var r=0;r<this._points.size();r++)if(this._points.getCoordinate(r).equals(e))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(e){return this.getFactory().createPoint(this._points.getCoordinate(e))}},{key:"interfaces_",get:function(){return[ss]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var e=arguments[0],r=arguments[1];vt.constructor_.call(this,r),this.init(e)}}}}])}(vt),os=m(function s(){l(this,s)}),dr=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new Ct;var e=new Ct;return e.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),e}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new t(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],r=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),r))}return z(t,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return _t.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return vt.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var e=arguments[0];return this.getCoordinate().compareTo(e.getCoordinate())}if(arguments.length===2){var r=arguments[0];return arguments[1].compare(this._coordinates,r._coordinates)}}},{key:"apply",value:function(){if(bt(arguments[0],bi)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this.getCoordinate())}else if(bt(arguments[0],Yn)){var r=arguments[0];if(this.isEmpty())return null;r.filter(this._coordinates,0),r.isGeometryChanged()&&this.geometryChanged()}else bt(arguments[0],Oi)?arguments[0].filter(this):bt(arguments[0],Y)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return vt.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(e){e===null&&(e=this.getFactory().getCoordinateSequenceFactory().create([])),at.isTrue(e.size()<=1),this._coordinates=e}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[os]}}],[{key:"constructor_",value:function(){this._coordinates=null;var e=arguments[0],r=arguments[1];vt.constructor_.call(this,r),this.init(e)}}])}(vt),as=function(){function s(){l(this,s)}return m(s,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var t=arguments[0];return Math.abs(s.ofRingSigned(t))}if(bt(arguments[0],Ht)){var e=arguments[0];return Math.abs(s.ofRingSigned(e))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,r=t[0].x,c=1;c<t.length-1;c++){var p=t[c].x-r,v=t[c+1].y;e+=p*(t[c-1].y-v)}return e/2}if(bt(arguments[0],Ht)){var E=arguments[0],C=E.size();if(C<3)return 0;var D=new Q,$=new Q,nt=new Q;E.getCoordinate(0,$),E.getCoordinate(1,nt);var gt=$.x;nt.x-=gt;for(var xt=0,Et=1;Et<C-1;Et++)D.y=$.y,$.x=nt.x,$.y=nt.y,E.getCoordinate(Et+1,nt),nt.x-=gt,xt+=$.x*(D.y-nt.y);return xt/2}}}])}(),de=function(){return m(function s(){l(this,s)},null,[{key:"sort",value:function(){var s=arguments,t=arguments[0];if(arguments.length===1)t.sort(function(gt,xt){return gt.compareTo(xt)});else if(arguments.length===2)t.sort(function(gt,xt){return s[1].compare(gt,xt)});else if(arguments.length===3){var e=t.slice(arguments[1],arguments[2]);e.sort();var r=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);var c,p=_(r);try{for(p.s();!(c=p.n()).done;){var v=c.value;t.push(v)}}catch(gt){p.e(gt)}finally{p.f()}}else if(arguments.length===4){var E=t.slice(arguments[1],arguments[2]);E.sort(function(gt,xt){return s[3].compare(gt,xt)});var C=t.slice(0,arguments[1]).concat(E,t.slice(arguments[2],t.length));t.splice(0,t.length);var D,$=_(C);try{for($.s();!(D=$.n()).done;){var nt=D.value;t.push(nt)}}catch(gt){$.e(gt)}finally{$.f()}}}},{key:"asList",value:function(s){var t,e=new Lt,r=_(s);try{for(r.s();!(t=r.n()).done;){var c=t.value;e.add(c)}}catch(p){r.e(p)}finally{r.f()}return e}},{key:"copyOf",value:function(s,t){return s.slice(0,t)}}])}(),Pt=m(function s(){l(this,s)}),ci=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var e=new Array(this.getNumPoints()).fill(null),r=-1,c=this._shell.getCoordinates(),p=0;p<c.length;p++)e[++r]=c[p];for(var v=0;v<this._holes.length;v++)for(var E=this._holes[v].getCoordinates(),C=0;C<E.length;C++)e[++r]=E[C];return e}},{key:"getArea",value:function(){var e=0;e+=as.ofRing(this._shell.getCoordinateSequence());for(var r=0;r<this._holes.length;r++)e-=as.ofRing(this._holes[r].getCoordinateSequence());return e}},{key:"copyInternal",value:function(){for(var e=this._shell.copy(),r=new Array(this._holes.length).fill(null),c=0;c<this._holes.length;c++)r[c]=this._holes[c].copy();return new t(e,r,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var e=this._shell.getCoordinateSequence(),r=this.getEnvelopeInternal(),c=0;c<5;c++){var p=e.getX(c);if(p!==r.getMinX()&&p!==r.getMaxX())return!1;var v=e.getY(c);if(v!==r.getMinY()&&v!==r.getMaxY())return!1}for(var E=e.getX(0),C=e.getY(0),D=1;D<=4;D++){var $=e.getX(D),nt=e.getY(D);if($!==E==(nt!==C))return!1;E=$,C=nt}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],r=arguments[1];if(!this.isEquivalentClass(e))return!1;var c=e,p=this._shell,v=c._shell;if(!p.equalsExact(v,r)||this._holes.length!==c._holes.length)return!1;for(var E=0;E<this._holes.length;E++)if(!this._holes[E].equalsExact(c._holes[E],r))return!1;return!0}return z(t,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var e=0;e<this._holes.length;e++)this._holes[e]=this.normalized(this._holes[e],!1);de.sort(this._holes)}else if(arguments.length===2){var r=arguments[0],c=arguments[1];if(r.isEmpty())return null;var p=r.getCoordinateSequence(),v=Nn.minCoordinateIndex(p,0,p.size()-2);Nn.scroll(p,v,!0),Tt.isCCW(p)===c&&Nn.reverse(p)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var e=this.getExteriorRing().reverse(),r=new Array(this.getNumInteriorRing()).fill(null),c=0;c<r.length;c++)r[c]=this.getInteriorRingN(c).reverse();return this.getFactory().createPolygon(e,r)}},{key:"getTypeCode",value:function(){return vt.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var e=0;e+=this._shell.getLength();for(var r=0;r<this._holes.length;r++)e+=this._holes[r].getLength();return e}},{key:"getNumPoints",value:function(){for(var e=this._shell.getNumPoints(),r=0;r<this._holes.length;r++)e+=this._holes[r].getNumPoints();return e}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(e,r){var c=e.copy();return this.normalize(c,r),c}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var e=arguments[0],r=this._shell,c=e._shell;return r.compareToSameClass(c)}if(arguments.length===2){var p=arguments[1],v=arguments[0],E=this._shell,C=v._shell,D=E.compareToSameClass(C,p);if(D!==0)return D;for(var $=this.getNumInteriorRing(),nt=v.getNumInteriorRing(),gt=0;gt<$&&gt<nt;){var xt=this.getInteriorRingN(gt),Et=v.getInteriorRingN(gt),It=xt.compareToSameClass(Et,p);if(It!==0)return It;gt++}return gt<$?1:gt<nt?-1:0}}},{key:"apply",value:function(){if(bt(arguments[0],bi)){var e=arguments[0];this._shell.apply(e);for(var r=0;r<this._holes.length;r++)this._holes[r].apply(e)}else if(bt(arguments[0],Yn)){var c=arguments[0];if(this._shell.apply(c),!c.isDone())for(var p=0;p<this._holes.length&&(this._holes[p].apply(c),!c.isDone());p++);c.isGeometryChanged()&&this.geometryChanged()}else if(bt(arguments[0],Oi))arguments[0].filter(this);else if(bt(arguments[0],Y)){var v=arguments[0];v.filter(this),this._shell.apply(v);for(var E=0;E<this._holes.length;E++)this._holes[E].apply(v)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var e=new Array(this._holes.length+1).fill(null);e[0]=this._shell;for(var r=0;r<this._holes.length;r++)e[r+1]=this._holes[r];return e.length<=1?this.getFactory().createLinearRing(e[0].getCoordinateSequence()):this.getFactory().createMultiLineString(e)}},{key:"getGeometryType",value:function(){return vt.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(e){return this._holes[e]}},{key:"interfaces_",get:function(){return[Pt]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var e=arguments[0],r=arguments[1],c=arguments[2];if(vt.constructor_.call(this,c),e===null&&(e=this.getFactory().createLinearRing()),r===null&&(r=[]),vt.hasNullElements(r))throw new H("holes must not contain null elements");if(e.isEmpty()&&vt.hasNonEmptyElements(r))throw new H("shell is empty but holes are not");this._shell=e,this._holes=r}}])}(vt),us=function(s){function t(){return l(this,t),a(this,t,arguments)}return I(t,s),m(t)}(ke),mr=function(s){function t(e){var r;return l(this,t),(r=a(this,t)).array=[],e instanceof At&&r.addAll(e),r}return I(t,s),m(t,[{key:"contains",value:function(e){var r,c=_(this.array);try{for(c.s();!(r=c.n()).done;)if(r.value.compareTo(e)===0)return!0}catch(p){c.e(p)}finally{c.f()}return!1}},{key:"add",value:function(e){if(this.contains(e))return!1;for(var r=0,c=this.array.length;r<c;r++)if(this.array[r].compareTo(e)===1)return!!this.array.splice(r,0,e);return this.array.push(e),!0}},{key:"addAll",value:function(e){var r,c=_(e);try{for(c.s();!(r=c.n()).done;){var p=r.value;this.add(p)}}catch(v){c.e(v)}finally{c.f()}return!0}},{key:"remove",value:function(){throw new Mt}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new ls(this.array)}}])}(us),ls=function(){return m(function s(t){l(this,s),this.array=t,this.position=0},[{key:"next",value:function(){if(this.position===this.array.length)throw new Gt;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new Mt}}])}(),we=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"computeEnvelopeInternal",value:function(){for(var e=new Ct,r=0;r<this._geometries.length;r++)e.expandToInclude(this._geometries[r].getEnvelopeInternal());return e}},{key:"getGeometryN",value:function(e){return this._geometries[e]}},{key:"getCoordinates",value:function(){for(var e=new Array(this.getNumPoints()).fill(null),r=-1,c=0;c<this._geometries.length;c++)for(var p=this._geometries[c].getCoordinates(),v=0;v<p.length;v++)e[++r]=p[v];return e}},{key:"getArea",value:function(){for(var e=0,r=0;r<this._geometries.length;r++)e+=this._geometries[r].getArea();return e}},{key:"copyInternal",value:function(){for(var e=new Array(this._geometries.length).fill(null),r=0;r<e.length;r++)e[r]=this._geometries[r].copy();return new t(e,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],r=arguments[1];if(!this.isEquivalentClass(e))return!1;var c=e;if(this._geometries.length!==c._geometries.length)return!1;for(var p=0;p<this._geometries.length;p++)if(!this._geometries[p].equalsExact(c._geometries[p],r))return!1;return!0}return z(t,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var e=0;e<this._geometries.length;e++)this._geometries[e].normalize();de.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var e=_t.FALSE,r=0;r<this._geometries.length;r++)e=Math.max(e,this._geometries[r].getBoundaryDimension());return e}},{key:"reverseInternal",value:function(){for(var e=this._geometries.length,r=new Lt(e),c=0;c<e;c++)r.add(this._geometries[c].reverse());return this.getFactory().buildGeometry(r)}},{key:"getTypeCode",value:function(){return vt.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var e=_t.FALSE,r=0;r<this._geometries.length;r++)e=Math.max(e,this._geometries[r].getDimension());return e}},{key:"getLength",value:function(){for(var e=0,r=0;r<this._geometries.length;r++)e+=this._geometries[r].getLength();return e}},{key:"getNumPoints",value:function(){for(var e=0,r=0;r<this._geometries.length;r++)e+=this._geometries[r].getNumPoints();return e}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var e=arguments[0],r=new mr(de.asList(this._geometries)),c=new mr(de.asList(e._geometries));return this.compare(r,c)}if(arguments.length===2){for(var p=arguments[1],v=arguments[0],E=this.getNumGeometries(),C=v.getNumGeometries(),D=0;D<E&&D<C;){var $=this.getGeometryN(D),nt=v.getGeometryN(D),gt=$.compareToSameClass(nt,p);if(gt!==0)return gt;D++}return D<E?1:D<C?-1:0}}},{key:"apply",value:function(){if(bt(arguments[0],bi))for(var e=arguments[0],r=0;r<this._geometries.length;r++)this._geometries[r].apply(e);else if(bt(arguments[0],Yn)){var c=arguments[0];if(this._geometries.length===0)return null;for(var p=0;p<this._geometries.length&&(this._geometries[p].apply(c),!c.isDone());p++);c.isGeometryChanged()&&this.geometryChanged()}else if(bt(arguments[0],Oi)){var v=arguments[0];v.filter(this);for(var E=0;E<this._geometries.length;E++)this._geometries[E].apply(v)}else if(bt(arguments[0],Y)){var C=arguments[0];C.filter(this);for(var D=0;D<this._geometries.length;D++)this._geometries[D].apply(C)}}},{key:"getBoundary",value:function(){return vt.checkNotGeometryCollection(this),at.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return vt.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var e=arguments[0],r=arguments[1];if(vt.constructor_.call(this,r),e===null&&(e=[]),vt.hasNullElements(e))throw new H("geometries must not contain null elements");this._geometries=e}}}}])}(vt),Ai=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"copyInternal",value:function(){for(var e=new Array(this._geometries.length).fill(null),r=0;r<e.length;r++)e[r]=this._geometries[r].copy();return new t(e,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],r=arguments[1];return!!this.isEquivalentClass(e)&&z(t,"equalsExact",this,1).call(this,e,r)}return z(t,"equalsExact",this,1).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var e=arguments[0];return this._geometries[e].getCoordinate()}return z(t,"getCoordinate",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return _t.FALSE}},{key:"getTypeCode",value:function(){return vt.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return vt.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[os]}}],[{key:"constructor_",value:function(){var e=arguments[0],r=arguments[1];we.constructor_.call(this,e,r)}}])}(we),We=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"copyInternal",value:function(){return new t(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return _t.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||z(t,"isClosed",this,1).call(this)}},{key:"reverseInternal",value:function(){var e=this._points.copy();return Nn.reverse(e),this.getFactory().createLinearRing(e)}},{key:"getTypeCode",value:function(){return vt.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!z(t,"isClosed",this,1).call(this))throw new H("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new H("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return vt.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var e=arguments[0],r=arguments[1];hi.constructor_.call(this,e,r),this.validateConstruction()}}])}(hi);We.MINIMUM_VALID_SIZE=4;var vn=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"setOrdinate",value:function(e,r){switch(e){case t.X:this.x=r;break;case t.Y:this.y=r;break;default:throw new H("Invalid ordinate index: "+e)}}},{key:"getZ",value:function(){return Q.NULL_ORDINATE}},{key:"getOrdinate",value:function(e){switch(e){case t.X:return this.x;case t.Y:return this.y}throw new H("Invalid ordinate index: "+e)}},{key:"setZ",value:function(e){throw new H("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new t(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)Q.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof t){var e=arguments[0];Q.constructor_.call(this,e.x,e.y)}else if(arguments[0]instanceof Q){var r=arguments[0];Q.constructor_.call(this,r.x,r.y)}}else if(arguments.length===2){var c=arguments[0],p=arguments[1];Q.constructor_.call(this,c,p,Q.NULL_ORDINATE)}}}])}(Q);vn.X=0,vn.Y=1,vn.Z=-1,vn.M=-1;var bn=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(e,r){switch(e){case t.X:this.x=r;break;case t.Y:this.y=r;break;case t.M:this._m=r;break;default:throw new H("Invalid ordinate index: "+e)}}},{key:"setM",value:function(e){this._m=e}},{key:"getZ",value:function(){return Q.NULL_ORDINATE}},{key:"getOrdinate",value:function(e){switch(e){case t.X:return this.x;case t.Y:return this.y;case t.M:return this._m}throw new H("Invalid ordinate index: "+e)}},{key:"setZ",value:function(e){throw new H("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new t(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ(),this._m=e.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)Q.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof t){var e=arguments[0];Q.constructor_.call(this,e.x,e.y),this._m=e._m}else if(arguments[0]instanceof Q){var r=arguments[0];Q.constructor_.call(this,r.x,r.y),this._m=this.getM()}}else if(arguments.length===3){var c=arguments[0],p=arguments[1],v=arguments[2];Q.constructor_.call(this,c,p,Q.NULL_ORDINATE),this._m=v}}}])}(Q);bn.X=0,bn.Y=1,bn.Z=-1,bn.M=2;var pr=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(e,r){switch(e){case Q.X:this.x=r;break;case Q.Y:this.y=r;break;case Q.Z:this.z=r;break;case Q.M:this._m=r;break;default:throw new H("Invalid ordinate index: "+e)}}},{key:"setM",value:function(e){this._m=e}},{key:"getOrdinate",value:function(e){switch(e){case Q.X:return this.x;case Q.Y:return this.y;case Q.Z:return this.getZ();case Q.M:return this.getM()}throw new H("Invalid ordinate index: "+e)}},{key:"copy",value:function(){return new t(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ(),this._m=e.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)Q.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof t){var e=arguments[0];Q.constructor_.call(this,e),this._m=e._m}else if(arguments[0]instanceof Q){var r=arguments[0];Q.constructor_.call(this,r),this._m=this.getM()}}else if(arguments.length===4){var c=arguments[0],p=arguments[1],v=arguments[2],E=arguments[3];Q.constructor_.call(this,c,p,v),this._m=E}}}])}(Q),Ri=function(){function s(){l(this,s)}return m(s,null,[{key:"measures",value:function(t){return t instanceof vn?0:t instanceof bn||t instanceof pr?1:0}},{key:"dimension",value:function(t){return t instanceof vn?2:t instanceof bn?3:t instanceof pr?4:3}},{key:"create",value:function(){if(arguments.length===1){var t=arguments[0];return s.create(t,0)}if(arguments.length===2){var e=arguments[0],r=arguments[1];return e===2?new vn:e===3&&r===0?new Q:e===3&&r===1?new bn:e===4&&r===1?new pr:new Q}}}])}(),fi=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"getCoordinate",value:function(e){return this.get(e)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&bt(arguments[0],At)){for(var e=arguments[1],r=!1,c=arguments[0].iterator();c.hasNext();)this.add(c.next(),e),r=!0;return r}return z(t,"addAll",this,1).apply(this,arguments)}},{key:"clone",value:function(){for(var e=z(t,"clone",this,1).call(this),r=0;r<this.size();r++)e.add(r,this.get(r).clone());return e}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(t.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(t.coordArrayType);for(var e=this.size(),r=new Array(e).fill(null),c=0;c<e;c++)r[c]=this.get(e-c-1);return r}}},{key:"add",value:function(){if(arguments.length===1){var e=arguments[0];return z(t,"add",this,1).call(this,e)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var r=arguments[0],c=arguments[1];return this.add(r,c,!0),!0}if(arguments[0]instanceof Q&&typeof arguments[1]=="boolean"){var p=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(p))return null;z(t,"add",this,1).call(this,p)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var v=arguments[0],E=arguments[1];return this.add(v,E),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var C=arguments[0],D=arguments[1];if(arguments[2])for(var $=0;$<C.length;$++)this.add(C[$],D);else for(var nt=C.length-1;nt>=0;nt--)this.add(C[nt],D);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof Q){var gt=arguments[0],xt=arguments[1];if(!arguments[2]){var Et=this.size();if(Et>0&&(gt>0&&this.get(gt-1).equals2D(xt)||gt<Et&&this.get(gt).equals2D(xt)))return null}z(t,"add",this,1).call(this,gt,xt)}}else if(arguments.length===4){var It=arguments[0],Ut=arguments[1],zt=arguments[2],jt=arguments[3],te=1;zt>jt&&(te=-1);for(var ge=zt;ge!==jt;ge+=te)this.add(It[ge],Ut);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var e=this.get(0).copy();this.add(e,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(arguments.length===2){var r=arguments[0],c=arguments[1];this.ensureCapacity(r.length),this.add(r,c)}}}}])}(Lt);fi.coordArrayType=new Array(0).fill(null);var se=function(){function s(){l(this,s)}return m(s,null,[{key:"isRing",value:function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])}},{key:"ptNotInList",value:function(t,e){for(var r=0;r<t.length;r++){var c=t[r];if(s.indexOf(c,e)<0)return c}return null}},{key:"scroll",value:function(t,e){var r=s.indexOf(e,t);if(r<0)return null;var c=new Array(t.length).fill(null);Fe.arraycopy(t,r,c,0,t.length-r),Fe.arraycopy(t,0,c,t.length-r,r),Fe.arraycopy(c,0,t,0,t.length)}},{key:"equals",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(t===null||e===null||t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!t[r].equals(e[r]))return!1;return!0}if(arguments.length===3){var c=arguments[0],p=arguments[1],v=arguments[2];if(c===p)return!0;if(c===null||p===null||c.length!==p.length)return!1;for(var E=0;E<c.length;E++)if(v.compare(c[E],p[E])!==0)return!1;return!0}}},{key:"intersection",value:function(t,e){for(var r=new fi,c=0;c<t.length;c++)e.intersects(t[c])&&r.add(t[c],!0);return r.toCoordinateArray()}},{key:"measures",value:function(t){if(t===null||t.length===0)return 0;var e,r=0,c=_(t);try{for(c.s();!(e=c.n()).done;){var p=e.value;r=Math.max(r,Ri.measures(p))}}catch(v){c.e(v)}finally{c.f()}return r}},{key:"hasRepeatedPoints",value:function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(t){return s.hasRepeatedPoints(t)?new fi(t,!1).toCoordinateArray():t}},{key:"reverse",value:function(t){for(var e=t.length-1,r=Math.trunc(e/2),c=0;c<=r;c++){var p=t[c];t[c]=t[e-c],t[e-c]=p}}},{key:"removeNull",value:function(t){for(var e=0,r=0;r<t.length;r++)t[r]!==null&&e++;var c=new Array(e).fill(null);if(e===0)return c;for(var p=0,v=0;v<t.length;v++)t[v]!==null&&(c[p++]=t[v]);return c}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var t=arguments[0],e=new Array(t.length).fill(null),r=0;r<t.length;r++)e[r]=t[r].copy();return e}if(arguments.length===5)for(var c=arguments[0],p=arguments[1],v=arguments[2],E=arguments[3],C=arguments[4],D=0;D<C;D++)v[E+D]=c[p+D].copy()}},{key:"isEqualReversed",value:function(t,e){for(var r=0;r<t.length;r++){var c=t[r],p=e[t.length-r-1];if(c.compareTo(p)!==0)return!1}return!0}},{key:"envelope",value:function(t){for(var e=new Ct,r=0;r<t.length;r++)e.expandToInclude(t[r]);return e}},{key:"toCoordinateArray",value:function(t){return t.toArray(s.coordArrayType)}},{key:"dimension",value:function(t){if(t===null||t.length===0)return 3;var e,r=0,c=_(t);try{for(c.s();!(e=c.n()).done;){var p=e.value;r=Math.max(r,Ri.dimension(p))}}catch(v){c.e(v)}finally{c.f()}return r}},{key:"atLeastNCoordinatesOrNothing",value:function(t,e){return e.length>=t?e:[]}},{key:"indexOf",value:function(t,e){for(var r=0;r<e.length;r++)if(t.equals(e[r]))return r;return-1}},{key:"increasingDirection",value:function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var r=t.length-1-e,c=t[e].compareTo(t[r]);if(c!==0)return c}return 1}},{key:"compare",value:function(t,e){for(var r=0;r<t.length&&r<e.length;){var c=t[r].compareTo(e[r]);if(c!==0)return c;r++}return r<e.length?-1:r<t.length?1:0}},{key:"minCoordinate",value:function(t){for(var e=null,r=0;r<t.length;r++)(e===null||e.compareTo(t[r])>0)&&(e=t[r]);return e}},{key:"extract",value:function(t,e,r){e=Un.clamp(e,0,t.length);var c=(r=Un.clamp(r,-1,t.length))-e+1;r<0&&(c=0),e>=t.length&&(c=0),r<e&&(c=0);var p=new Array(c).fill(null);if(c===0)return p;for(var v=0,E=e;E<=r;E++)p[v++]=t[E];return p}}])}(),oo=function(){return m(function s(){l(this,s)},[{key:"compare",value:function(s,t){var e=s,r=t;return se.compare(e,r)}},{key:"interfaces_",get:function(){return[rt]}}])}(),Di=function(){return m(function s(){l(this,s)},[{key:"compare",value:function(s,t){var e=s,r=t;if(e.length<r.length)return-1;if(e.length>r.length)return 1;if(e.length===0)return 0;var c=se.compare(e,r);return se.isEqualReversed(e,r)?0:c}},{key:"OLDcompare",value:function(s,t){var e=s,r=t;if(e.length<r.length)return-1;if(e.length>r.length)return 1;if(e.length===0)return 0;for(var c=se.increasingDirection(e),p=se.increasingDirection(r),v=c>0?0:e.length-1,E=p>0?0:e.length-1,C=0;C<e.length;C++){var D=e[v].compareTo(r[E]);if(D!==0)return D;v+=c,E+=p}return 0}},{key:"interfaces_",get:function(){return[rt]}}])}();se.ForwardComparator=oo,se.BidirectionalComparator=Di,se.coordArrayType=new Array(0).fill(null);var Fi=function(){return m(function s(t){l(this,s),this.str=t},[{key:"append",value:function(s){this.str+=s}},{key:"setCharAt",value:function(s,t){this.str=this.str.substr(0,s)+t+this.str.substr(s+1)}},{key:"toString",value:function(){return this.str}}])}(),gi=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"getM",value:function(t){return this.hasM()?this._coordinates[t].getM():W.NaN}},{key:"setOrdinate",value:function(t,e,r){switch(e){case Ht.X:this._coordinates[t].x=r;break;case Ht.Y:this._coordinates[t].y=r;break;default:this._coordinates[t].setOrdinate(e,r)}}},{key:"getZ",value:function(t){return this.hasZ()?this._coordinates[t].getZ():W.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(t,e){switch(e){case Ht.X:return this._coordinates[t].x;case Ht.Y:return this._coordinates[t].y;default:return this._coordinates[t].getOrdinate(e)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var t=arguments[0];return this._coordinates[t]}if(arguments.length===2){var e=arguments[0];arguments[1].setCoordinate(this._coordinates[e])}}},{key:"getCoordinateCopy",value:function(t){var e=this.createCoordinate();return e.setCoordinate(this._coordinates[t]),e}},{key:"createCoordinate",value:function(){return Ri.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(t){return this._coordinates[t].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}},{key:"copy",value:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++){var r=this.createCoordinate();r.setCoordinate(this._coordinates[e]),t[e]=r}return new s(t,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var t=new Fi(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}},{key:"getY",value:function(t){return this._coordinates[t].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[Ht,M]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];s.constructor_.call(this,t,se.dimension(t),se.measures(t))}else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var r=0;r<e;r++)this._coordinates[r]=new Q}else if(bt(arguments[0],Ht)){var c=arguments[0];if(c===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=c.getDimension(),this._measures=c.getMeasures(),this._coordinates=new Array(c.size()).fill(null);for(var p=0;p<this._coordinates.length;p++)this._coordinates[p]=c.getCoordinateCopy(p)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var v=arguments[0],E=arguments[1];s.constructor_.call(this,v,E,se.measures(v))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var C=arguments[0],D=arguments[1];this._coordinates=new Array(C).fill(null),this._dimension=D;for(var $=0;$<C;$++)this._coordinates[$]=Ri.create(D)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var nt=arguments[0],gt=arguments[1],xt=arguments[2];this._dimension=gt,this._measures=xt,this._coordinates=nt===null?new Array(0).fill(null):nt}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var Et=arguments[0],It=arguments[1],Ut=arguments[2];this._coordinates=new Array(Et).fill(null),this._dimension=It,this._measures=Ut;for(var zt=0;zt<Et;zt++)this._coordinates[zt]=this.createCoordinate()}}}}])}(),yr=function(){function s(){l(this,s)}return m(s,[{key:"readResolve",value:function(){return s.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array)return new gi(arguments[0]);if(bt(arguments[0],Ht))return new gi(arguments[0])}else{if(arguments.length===2){var t=arguments[1];return t>3&&(t=3),t<2&&(t=2),new gi(arguments[0],t)}if(arguments.length===3){var e=arguments[2],r=arguments[1]-e;return e>1&&(e=1),r>3&&(r=3),r<2&&(r=2),new gi(arguments[0],r+e,e)}}}},{key:"interfaces_",get:function(){return[gr,M]}}],[{key:"instance",value:function(){return s.instanceObject}}])}();yr.instanceObject=new yr;var vr=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"copyInternal",value:function(){for(var e=new Array(this._geometries.length).fill(null),r=0;r<e.length;r++)e[r]=this._geometries[r].copy();return new t(e,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],r=arguments[1];return!!this.isEquivalentClass(e)&&z(t,"equalsExact",this,1).call(this,e,r)}return z(t,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return vt.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var e=new Lt,r=0;r<this._geometries.length;r++)for(var c=this._geometries[r].getBoundary(),p=0;p<c.getNumGeometries();p++)e.add(c.getGeometryN(p));var v=new Array(e.size()).fill(null);return this.getFactory().createMultiLineString(e.toArray(v))}},{key:"getGeometryType",value:function(){return vt.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Pt]}}],[{key:"constructor_",value:function(){var e=arguments[0],r=arguments[1];we.constructor_.call(this,e,r)}}])}(we),hs=function(){return m(function s(){l(this,s)},[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}])}(),_r=function(s){function t(){var e;return l(this,t),(e=a(this,t)).map=new Map,e}return I(t,s),m(t,[{key:"get",value:function(e){return this.map.get(e)||null}},{key:"put",value:function(e,r){return this.map.set(e,r),r}},{key:"values",value:function(){for(var e=new Lt,r=this.map.values(),c=r.next();!c.done;)e.add(c.value),c=r.next();return e}},{key:"entrySet",value:function(){var e=new ce;return this.map.entries().forEach(function(r){return e.add(r)}),e}},{key:"size",value:function(){return this.map.size()}}])}(hs),Ee=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"equals",value:function(t){if(!(t instanceof s))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale}},{key:"compareTo",value:function(t){var e=t,r=this.getMaximumSignificantDigits(),c=e.getMaximumSignificantDigits();return Xe.compare(r,c)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===s.FLOATING||this._modelType===s.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var t="UNKNOWN";return this._modelType===s.FLOATING?t="Floating":this._modelType===s.FLOATING_SINGLE?t="Floating-Single":this._modelType===s.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var t=arguments[0];return W.isNaN(t)||this._modelType===s.FLOATING_SINGLE?t:this._modelType===s.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof Q){var e=arguments[0];if(this._modelType===s.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}}},{key:"getMaximumSignificantDigits",value:function(){var t=16;return this._modelType===s.FLOATING?t=16:this._modelType===s.FLOATING_SINGLE?t=6:this._modelType===s.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}},{key:"setScale",value:function(t){this._scale=Math.abs(t)}},{key:"interfaces_",get:function(){return[M,J]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=s.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof On){var t=arguments[0];this._modelType=t,t===s.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var e=arguments[0];this._modelType=s.FIXED,this.setScale(e)}else if(arguments[0]instanceof s){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}}}},{key:"mostPrecise",value:function(t,e){return t.compareTo(e)>=0?t:e}}])}(),On=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"readResolve",value:function(){return s.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[M]}}],[{key:"constructor_",value:function(){this._name=null;var t=arguments[0];this._name=t,s.nameToTypeMap.put(t,this)}}])}();On.nameToTypeMap=new _r,Ee.Type=On,Ee.FIXED=new On("FIXED"),Ee.FLOATING=new On("FLOATING"),Ee.FLOATING_SINGLE=new On("FLOATING SINGLE"),Ee.maximumPreciseValue=9007199254740992;var Bi=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"copyInternal",value:function(){for(var e=new Array(this._geometries.length).fill(null),r=0;r<e.length;r++)e[r]=this._geometries[r].copy();return new t(e,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],r=arguments[1];return!!this.isEquivalentClass(e)&&z(t,"equalsExact",this,1).call(this,e,r)}return z(t,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?_t.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return vt.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new Mt}},{key:"getGeometryType",value:function(){return vt.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[ss]}}],[{key:"constructor_",value:function(){var e=arguments[0],r=arguments[1];we.constructor_.call(this,e,r)}}])}(we),Ke=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"createEmpty",value:function(t){switch(t){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new H("Invalid dimension: "+t)}}},{key:"toGeometry",value:function(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new Q(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new Q(t.getMinX(),t.getMinY()),new Q(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new Q(t.getMinX(),t.getMinY()),new Q(t.getMinX(),t.getMaxY()),new Q(t.getMaxX(),t.getMaxY()),new Q(t.getMaxX(),t.getMinY()),new Q(t.getMinX(),t.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLineString(t!==null?this.getCoordinateSequenceFactory().create(t):null)}if(bt(arguments[0],Ht))return new hi(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return arguments.length===0?new Bi(null,this):arguments.length===1?new Bi(arguments[0],this):void 0}},{key:"buildGeometry",value:function(t){for(var e=null,r=!1,c=!1,p=t.iterator();p.hasNext();){var v=p.next(),E=v.getTypeCode();e===null&&(e=E),E!==e&&(r=!0),v instanceof we&&(c=!0)}if(e===null)return this.createGeometryCollection();if(r||c)return this.createGeometryCollection(s.toGeometryArray(t));var C=t.iterator().next();if(t.size()>1){if(C instanceof ci)return this.createMultiPolygon(s.toPolygonArray(t));if(C instanceof hi)return this.createMultiLineString(s.toLineStringArray(t));if(C instanceof dr)return this.createMultiPoint(s.toPointArray(t));at.shouldNeverReachHere("Unhandled geometry type: "+C.getGeometryType())}return C}},{key:"createMultiPointFromCoords",value:function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Q){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}if(bt(arguments[0],Ht))return new dr(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(bt(arguments[0],Ht)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof We){var r=arguments[0];return this.createPolygon(r,null)}}else if(arguments.length===2)return new ci(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return arguments.length===0?new we(null,this):arguments.length===1?new we(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}if(bt(arguments[0],Ht))return new We(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return arguments.length===0?new vr(null,this):arguments.length===1?new vr(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Ai(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new Ai(arguments[0],this);if(bt(arguments[0],Ht)){var t=arguments[0];if(t===null)return this.createMultiPoint(new Array(0).fill(null));for(var e=new Array(t.size()).fill(null),r=0;r<t.size();r++){var c=this.getCoordinateSequenceFactory().create(1,t.getDimension(),t.getMeasures());Nn.copy(t,r,c,0,1),e[r]=this.createPoint(c)}return this.createMultiPoint(e)}}}},{key:"interfaces_",get:function(){return[M]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)s.constructor_.call(this,new Ee,0);else if(arguments.length===1){if(bt(arguments[0],gr)){var t=arguments[0];s.constructor_.call(this,new Ee,0,t)}else if(arguments[0]instanceof Ee){var e=arguments[0];s.constructor_.call(this,e,0,s.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var r=arguments[0],c=arguments[1];s.constructor_.call(this,r,c,s.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var p=arguments[0],v=arguments[1],E=arguments[2];this._precisionModel=p,this._coordinateSequenceFactory=E,this._SRID=v}}},{key:"toMultiPolygonArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toGeometryArray",value:function(t){if(t===null)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return yr.instance()}},{key:"toMultiLineStringArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toLineStringArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toMultiPointArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toLinearRingArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toPointArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toPolygonArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"createPointFromInternalCoord",value:function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}}])}(),Zt="XY",Qt="XYZ",zi="XYM",Xn="XYZM",An={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Gi="EMPTY",Ot=1,Wt=2,Je=3,di=4,fe=5,ao=6;for(var qi in An)An[qi].toUpperCase();var Rn=function(){return m(function s(t){l(this,s),this.wkt=t,this.index_=-1},[{key:"isAlpha_",value:function(s){return s>="a"&&s<="z"||s>="A"&&s<="Z"}},{key:"isNumeric_",value:function(s,t){return s>="0"&&s<="9"||s=="."&&!(t!==void 0&&t)}},{key:"isWhiteSpace_",value:function(s){return s==" "||s=="	"||s=="\r"||s==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var s,t=this.nextChar_(),e=this.index_,r=t;if(t=="(")s=Wt;else if(t==",")s=fe;else if(t==")")s=Je;else if(this.isNumeric_(t)||t=="-")s=di,r=this.readNumber_();else if(this.isAlpha_(t))s=Ot,r=this.readText_();else{if(this.isWhiteSpace_(t))return this.nextToken();if(t!=="")throw new Error("Unexpected character: "+t);s=ao}return{position:e,value:r,type:s}}},{key:"readNumber_",value:function(){var s,t=this.index_,e=!1,r=!1;do s=="."?e=!0:s!="e"&&s!="E"||(r=!0),s=this.nextChar_();while(this.isNumeric_(s,e)||!r&&(s=="e"||s=="E")||r&&(s=="-"||s=="+"));return parseFloat(this.wkt.substring(t,this.index_--))}},{key:"readText_",value:function(){var s,t=this.index_;do s=this.nextChar_();while(this.isAlpha_(s));return this.wkt.substring(t,this.index_--).toUpperCase()}}])}(),oe=function(){return m(function s(t,e){l(this,s),this.lexer_=t,this.token_,this.layout_=Zt,this.factory=e},[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(s){return this.token_.type==s}},{key:"match",value:function(s){var t=this.isTokenType(s);return t&&this.consume_(),t}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var s=Zt,t=this.token_;if(this.isTokenType(Ot)){var e=t.value;e==="Z"?s=Qt:e==="M"?s=zi:e==="ZM"&&(s=Xn),s!==Zt&&this.consume_()}return s}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(Wt)){var s=[];do s.push(this.parseGeometry_());while(this.match(fe));if(this.match(Je))return s}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(Wt)){var s=this.parsePoint_();if(this.match(Je))return s}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(Wt)){var s=this.parsePointList_();if(this.match(Je))return s}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(Wt)){var s=this.parseLineStringTextList_();if(this.match(Je))return s}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var s;if(this.match(Wt)){if(s=this.token_.type==Wt?this.parsePointTextList_():this.parsePointList_(),this.match(Je))return s}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(Wt)){var s=this.parseLineStringTextList_();if(this.match(Je))return s}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(Wt)){var s=this.parsePolygonTextList_();if(this.match(Je))return s}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var s=[],t=this.layout_.length,e=0;e<t;++e){var r=this.token_;if(!this.match(di))break;s.push(r.value)}if(s.length==t)return s;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var s=[this.parsePoint_()];this.match(fe);)s.push(this.parsePoint_());return s}},{key:"parsePointTextList_",value:function(){for(var s=[this.parsePointText_()];this.match(fe);)s.push(this.parsePointText_());return s}},{key:"parseLineStringTextList_",value:function(){for(var s=[this.parseLineStringText_()];this.match(fe);)s.push(this.parseLineStringText_());return s}},{key:"parsePolygonTextList_",value:function(){for(var s=[this.parsePolygonText_()];this.match(fe);)s.push(this.parsePolygonText_());return s}},{key:"isEmptyGeometry_",value:function(){var s=this.isTokenType(Ot)&&this.token_.value==Gi;return s&&this.consume_(),s}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var s=this.factory,t=function(It){return g(Q,et(It))},e=function(It){var Ut=It.map(function(zt){return s.createLinearRing(zt.map(t))});return Ut.length>1?s.createPolygon(Ut[0],Ut.slice(1)):s.createPolygon(Ut[0])},r=this.token_;if(this.match(Ot)){var c=r.value;if(this.layout_=this.parseGeometryLayout_(),c=="GEOMETRYCOLLECTION"){var p=this.parseGeometryCollectionText_();return s.createGeometryCollection(p)}switch(c){case"POINT":var v=this.parsePointText_();return v?s.createPoint(g(Q,et(v))):s.createPoint();case"LINESTRING":var E=this.parseLineStringText_().map(t);return s.createLineString(E);case"LINEARRING":var C=this.parseLineStringText_().map(t);return s.createLinearRing(C);case"POLYGON":var D=this.parsePolygonText_();return D&&D.length!==0?e(D):s.createPolygon();case"MULTIPOINT":var $=this.parseMultiPointText_();if(!$||$.length===0)return s.createMultiPoint();var nt=$.map(t).map(function(It){return s.createPoint(It)});return s.createMultiPoint(nt);case"MULTILINESTRING":var gt=this.parseMultiLineStringText_().map(function(It){return s.createLineString(It.map(t))});return s.createMultiLineString(gt);case"MULTIPOLYGON":var xt=this.parseMultiPolygonText_();if(!xt||xt.length===0)return s.createMultiPolygon();var Et=xt.map(e);return s.createMultiPolygon(Et);default:throw new Error("Invalid geometry type: "+c)}}throw new Error(this.formatErrorMessage_())}}])}();function _n(s){if(s.isEmpty())return"";var t=s.getCoordinate(),e=[t.x,t.y];return t.z===void 0||Number.isNaN(t.z)||e.push(t.z),t.m===void 0||Number.isNaN(t.m)||e.push(t.m),e.join(" ")}function hn(s){for(var t=s.getCoordinates().map(function(p){var v=[p.x,p.y];return p.z===void 0||Number.isNaN(p.z)||v.push(p.z),p.m===void 0||Number.isNaN(p.m)||v.push(p.m),v}),e=[],r=0,c=t.length;r<c;++r)e.push(t[r].join(" "));return e.join(", ")}function Vn(s){var t=[];t.push("("+hn(s.getExteriorRing())+")");for(var e=0,r=s.getNumInteriorRing();e<r;++e)t.push("("+hn(s.getInteriorRingN(e))+")");return t.join(", ")}var xr={Point:_n,LineString:hn,LinearRing:hn,Polygon:Vn,MultiPoint:function(s){for(var t=[],e=0,r=s.getNumGeometries();e<r;++e)t.push("("+_n(s.getGeometryN(e))+")");return t.join(", ")},MultiLineString:function(s){for(var t=[],e=0,r=s.getNumGeometries();e<r;++e)t.push("("+hn(s.getGeometryN(e))+")");return t.join(", ")},MultiPolygon:function(s){for(var t=[],e=0,r=s.getNumGeometries();e<r;++e)t.push("("+Vn(s.getGeometryN(e))+")");return t.join(", ")},GeometryCollection:function(s){for(var t=[],e=0,r=s.getNumGeometries();e<r;++e)t.push(Wn(s.getGeometryN(e)));return t.join(", ")}};function Wn(s){var t=s.getGeometryType(),e=xr[t];t=t.toUpperCase();var r=function(c){var p="";if(c.isEmpty())return p;var v=c.getCoordinate();return v.z===void 0||Number.isNaN(v.z)||(p+="Z"),v.m===void 0||Number.isNaN(v.m)||(p+="M"),p}(s);return r.length>0&&(t+=" "+r),s.isEmpty()?t+" "+Gi:t+" ("+e(s)+")"}var kr=function(){return m(function s(t){l(this,s),this.geometryFactory=t||new Ke,this.precisionModel=this.geometryFactory.getPrecisionModel()},[{key:"read",value:function(s){var t=new Rn(s);return new oe(t,this.geometryFactory).parse()}},{key:"write",value:function(s){return Wn(s)}}])}(),mi=function(){return m(function s(t){l(this,s),this.parser=new kr(t)},[{key:"write",value:function(s){return this.parser.write(s)}}],[{key:"toLineString",value:function(s,t){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+s.x+" "+s.y+", "+t.x+" "+t.y+" )"}}])}(),Kt=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"getIndexAlongSegment",value:function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}},{key:"getTopologySummary",value:function(){var t=new Fi;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}},{key:"computeIntersection",value:function(t,e,r,c){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=r,this._inputLines[1][1]=c,this._result=this.computeIntersect(t,e,r,c)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(t){this._precisionModel=t}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}}},{key:"getIntersection",value:function(t){return this._intPt[t]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==s.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(t,e){return s.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])}},{key:"isCollinear",value:function(){return this._result===s.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return mi.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+mi.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(t,e){return this._inputLines[t][e]}},{key:"isIntersection",value:function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Q,this._intPt[1]=new Q,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(t,e,r){var c=Math.abs(r.x-e.x),p=Math.abs(r.y-e.y),v=-1;if(t.equals(e))v=0;else if(t.equals(r))v=c>p?c:p;else{var E=Math.abs(t.x-e.x),C=Math.abs(t.y-e.y);(v=c>p?E:C)!==0||t.equals(e)||(v=Math.max(E,C))}return at.isTrue(!(v===0&&!t.equals(e)),"Bad distance calculation"),v}},{key:"nonRobustComputeEdgeDistance",value:function(t,e,r){var c=t.x-e.x,p=t.y-e.y,v=Math.sqrt(c*c+p*p);return at.isTrue(!(v===0&&!t.equals(e)),"Invalid distance calculation"),v}}])}();Kt.DONT_INTERSECT=0,Kt.DO_INTERSECT=1,Kt.COLLINEAR=2,Kt.NO_INTERSECTION=0,Kt.POINT_INTERSECTION=1,Kt.COLLINEAR_INTERSECTION=2;var cn=function(s){function t(){return l(this,t),a(this,t)}return I(t,s),m(t,[{key:"isInSegmentEnvelopes",value:function(e){var r=new Ct(this._inputLines[0][0],this._inputLines[0][1]),c=new Ct(this._inputLines[1][0],this._inputLines[1][1]);return r.contains(e)&&c.contains(e)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return z(t,"computeIntersection",this,1).apply(this,arguments);var e=arguments[0],r=arguments[1],c=arguments[2];if(this._isProper=!1,Ct.intersects(r,c,e)&&Tt.index(r,c,e)===0&&Tt.index(c,r,e)===0)return this._isProper=!0,(e.equals(r)||e.equals(c))&&(this._isProper=!1),this._result=Kt.POINT_INTERSECTION,null;this._result=Kt.NO_INTERSECTION}},{key:"intersection",value:function(e,r,c,p){var v=this.intersectionSafe(e,r,c,p);return this.isInSegmentEnvelopes(v)||(v=new Q(t.nearestEndpoint(e,r,c,p))),this._precisionModel!==null&&this._precisionModel.makePrecise(v),v}},{key:"checkDD",value:function(e,r,c,p,v){var E=hr.intersection(e,r,c,p),C=this.isInSegmentEnvelopes(E);Fe.out.println("DD in env = "+C+"  --------------------- "+E),v.distance(E)>1e-4&&Fe.out.println("Distance = "+v.distance(E))}},{key:"intersectionSafe",value:function(e,r,c,p){var v=fr.intersection(e,r,c,p);return v===null&&(v=t.nearestEndpoint(e,r,c,p)),v}},{key:"computeCollinearIntersection",value:function(e,r,c,p){var v=Ct.intersects(e,r,c),E=Ct.intersects(e,r,p),C=Ct.intersects(c,p,e),D=Ct.intersects(c,p,r);return v&&E?(this._intPt[0]=c,this._intPt[1]=p,Kt.COLLINEAR_INTERSECTION):C&&D?(this._intPt[0]=e,this._intPt[1]=r,Kt.COLLINEAR_INTERSECTION):v&&C?(this._intPt[0]=c,this._intPt[1]=e,!c.equals(e)||E||D?Kt.COLLINEAR_INTERSECTION:Kt.POINT_INTERSECTION):v&&D?(this._intPt[0]=c,this._intPt[1]=r,!c.equals(r)||E||C?Kt.COLLINEAR_INTERSECTION:Kt.POINT_INTERSECTION):E&&C?(this._intPt[0]=p,this._intPt[1]=e,!p.equals(e)||v||D?Kt.COLLINEAR_INTERSECTION:Kt.POINT_INTERSECTION):E&&D?(this._intPt[0]=p,this._intPt[1]=r,!p.equals(r)||v||C?Kt.COLLINEAR_INTERSECTION:Kt.POINT_INTERSECTION):Kt.NO_INTERSECTION}},{key:"computeIntersect",value:function(e,r,c,p){if(this._isProper=!1,!Ct.intersects(e,r,c,p))return Kt.NO_INTERSECTION;var v=Tt.index(e,r,c),E=Tt.index(e,r,p);if(v>0&&E>0||v<0&&E<0)return Kt.NO_INTERSECTION;var C=Tt.index(c,p,e),D=Tt.index(c,p,r);return C>0&&D>0||C<0&&D<0?Kt.NO_INTERSECTION:v===0&&E===0&&C===0&&D===0?this.computeCollinearIntersection(e,r,c,p):(v===0||E===0||C===0||D===0?(this._isProper=!1,e.equals2D(c)||e.equals2D(p)?this._intPt[0]=e:r.equals2D(c)||r.equals2D(p)?this._intPt[0]=r:v===0?this._intPt[0]=new Q(c):E===0?this._intPt[0]=new Q(p):C===0?this._intPt[0]=new Q(e):D===0&&(this._intPt[0]=new Q(r))):(this._isProper=!0,this._intPt[0]=this.intersection(e,r,c,p)),Kt.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(e,r,c,p){var v=e,E=qe.pointToSegment(e,c,p),C=qe.pointToSegment(r,c,p);return C<E&&(E=C,v=r),(C=qe.pointToSegment(c,e,r))<E&&(E=C,v=c),(C=qe.pointToSegment(p,e,r))<E&&(E=C,v=p),v}}])}(Kt),wr=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"countSegment",value:function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var r=t.x,c=e.x;return r>c&&(r=e.x,c=t.x),this._p.x>=r&&this._p.x<=c&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var p=Tt.index(t,e,this._p);if(p===Tt.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(p=-p),p===Tt.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==Z.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?Z.BOUNDARY:this._crossingCount%2==1?Z.INTERIOR:Z.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof Q&&bt(arguments[1],Ht)){for(var t=arguments[1],e=new s(arguments[0]),r=new Q,c=new Q,p=1;p<t.size();p++)if(t.getCoordinate(p,r),t.getCoordinate(p-1,c),e.countSegment(r,c),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof Q&&arguments[1]instanceof Array){for(var v=arguments[1],E=new s(arguments[0]),C=1;C<v.length;C++){var D=v[C],$=v[C-1];if(E.countSegment(D,$),E.isOnSegment())return E.getLocation()}return E.getLocation()}}}])}(),Kn=function(){function s(){l(this,s)}return m(s,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof Q&&bt(arguments[1],Ht)){for(var t=arguments[0],e=arguments[1],r=new cn,c=new Q,p=new Q,v=e.size(),E=1;E<v;E++)if(e.getCoordinate(E-1,c),e.getCoordinate(E,p),r.computeIntersection(t,c,p),r.hasIntersection())return!0;return!1}if(arguments[0]instanceof Q&&arguments[1]instanceof Array){for(var C=arguments[0],D=arguments[1],$=new cn,nt=1;nt<D.length;nt++){var gt=D[nt-1],xt=D[nt];if($.computeIntersection(C,gt,xt),$.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(t,e){return wr.locatePointInRing(t,e)}},{key:"isInRing",value:function(t,e){return s.locateInRing(t,e)!==Z.EXTERIOR}}])}(),be=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"setAllLocations",value:function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t}},{key:"isNull",value:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==Z.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(t){for(var e=0;e<this.location.length;e++)this.location[e]===Z.NONE&&(this.location[e]=t)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[pt.ON]=this.location[pt.ON],e[pt.LEFT]=Z.NONE,e[pt.RIGHT]=Z.NONE,this.location=e}for(var r=0;r<this.location.length;r++)this.location[r]===Z.NONE&&r<t.location.length&&(this.location[r]=t.location[r])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var t=this.location[pt.LEFT];this.location[pt.LEFT]=this.location[pt.RIGHT],this.location[pt.RIGHT]=t}},{key:"toString",value:function(){var t=new yn;return this.location.length>1&&t.append(Z.toLocationSymbol(this.location[pt.LEFT])),t.append(Z.toLocationSymbol(this.location[pt.ON])),this.location.length>1&&t.append(Z.toLocationSymbol(this.location[pt.RIGHT])),t.toString()}},{key:"setLocations",value:function(t,e,r){this.location[pt.ON]=t,this.location[pt.LEFT]=e,this.location[pt.RIGHT]=r}},{key:"get",value:function(t){return t<this.location.length?this.location[t]:Z.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===Z.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var t=arguments[0];this.setLocation(pt.ON,t)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];this.location[e]=r}}},{key:"init",value:function(t){this.location=new Array(t).fill(null),this.setAllLocations(Z.NONE)}},{key:"isEqualOnSide",value:function(t,e){return this.location[e]===t.location[e]}},{key:"allPositionsEqual",value:function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.init(1),this.location[pt.ON]=e}else if(arguments[0]instanceof s){var r=arguments[0];if(this.init(r.location.length),r!==null)for(var c=0;c<this.location.length;c++)this.location[c]=r.location[c]}}else if(arguments.length===3){var p=arguments[0],v=arguments[1],E=arguments[2];this.init(3),this.location[pt.ON]=p,this.location[pt.LEFT]=v,this.location[pt.RIGHT]=E}}}])}(),Le=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"getGeometryCount",value:function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}},{key:"setAllLocations",value:function(t,e){this.elt[t].setAllLocations(e)}},{key:"isNull",value:function(t){return this.elt[t].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];this.elt[e].setAllLocationsIfNull(r)}}},{key:"isLine",value:function(t){return this.elt[t].isLine()}},{key:"merge",value:function(t){for(var e=0;e<2;e++)this.elt[e]===null&&t.elt[e]!==null?this.elt[e]=new be(t.elt[e]):this.elt[e].merge(t.elt[e])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(pt.ON)}if(arguments.length===2){var e=arguments[0],r=arguments[1];return this.elt[e].get(r)}}},{key:"toString",value:function(){var t=new yn;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}}},{key:"isAnyNull",value:function(t){return this.elt[t].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(pt.ON,e)}else if(arguments.length===3){var r=arguments[0],c=arguments[1],p=arguments[2];this.elt[r].setLocation(c,p)}}},{key:"isEqualOnSide",value:function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}},{key:"allPositionsEqual",value:function(t,e){return this.elt[t].allPositionsEqual(e)}},{key:"toLine",value:function(t){this.elt[t].isArea()&&(this.elt[t]=new be(this.elt[t].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new be(t),this.elt[1]=new be(t)}else if(arguments[0]instanceof s){var e=arguments[0];this.elt[0]=new be(e.elt[0]),this.elt[1]=new be(e.elt[1])}}else if(arguments.length===2){var r=arguments[0],c=arguments[1];this.elt[0]=new be(Z.NONE),this.elt[1]=new be(Z.NONE),this.elt[r].setLocation(c)}else if(arguments.length===3){var p=arguments[0],v=arguments[1],E=arguments[2];this.elt[0]=new be(p,v,E),this.elt[1]=new be(p,v,E)}else if(arguments.length===4){var C=arguments[0],D=arguments[1],$=arguments[2],nt=arguments[3];this.elt[0]=new be(Z.NONE,Z.NONE,Z.NONE),this.elt[1]=new be(Z.NONE,Z.NONE,Z.NONE),this.elt[C].setLocations(D,$,nt)}}},{key:"toLineLabel",value:function(t){for(var e=new s(Z.NONE),r=0;r<2;r++)e.setLocation(r,t.getLocation(r));return e}}])}(),Hi=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var s=new Array(this._pts.size()).fill(null),t=0;t<this._pts.size();t++)s[t]=this._pts.get(t);this._ring=this._geometryFactory.createLinearRing(s),this._isHole=Tt.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(s){this._startDe=s;var t=s,e=!0;do{if(t===null)throw new Ve("Found null DirectedEdge");if(t.getEdgeRing()===this)throw new Ve("Directed Edge visited twice during ring-building at "+t.getCoordinate());this._edges.add(t);var r=t.getLabel();at.isTrue(r.isArea()),this.mergeLabel(r),this.addPoints(t.getEdge(),t.isForward(),e),e=!1,this.setEdgeRing(t,this),t=this.getNext(t)}while(t!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(s){return this._pts.get(s)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var s=this._startDe;do{var t=s.getNode().getEdges().getOutgoingDegree(this);t>this._maxNodeDegree&&(this._maxNodeDegree=t),s=this.getNext(s)}while(s!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(s,t,e){var r=s.getCoordinates();if(t){var c=1;e&&(c=0);for(var p=c;p<r.length;p++)this._pts.add(r[p])}else{var v=r.length-2;e&&(v=r.length-1);for(var E=v;E>=0;E--)this._pts.add(r[E])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var s=this._startDe;do s.getEdge().setInResult(!0),s=s.getNext();while(s!==this._startDe)}},{key:"containsPoint",value:function(s){var t=this.getLinearRing();if(!t.getEnvelopeInternal().contains(s)||!Kn.isInRing(s,t.getCoordinates()))return!1;for(var e=this._holes.iterator();e.hasNext();)if(e.next().containsPoint(s))return!1;return!0}},{key:"addHole",value:function(s){this._holes.add(s)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var s=arguments[0];this.mergeLabel(s,0),this.mergeLabel(s,1)}else if(arguments.length===2){var t=arguments[1],e=arguments[0].getLocation(t,pt.RIGHT);if(e===Z.NONE)return null;if(this._label.getLocation(t)===Z.NONE)return this._label.setLocation(t,e),null}}},{key:"setShell",value:function(s){this._shell=s,s!==null&&s.addHole(this)}},{key:"toPolygon",value:function(s){for(var t=new Array(this._holes.size()).fill(null),e=0;e<this._holes.size();e++)t[e]=this._holes.get(e).getLinearRing();return s.createPolygon(this.getLinearRing(),t)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new Lt,this._pts=new Lt,this._label=new Le(Z.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Lt,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var s=arguments[0],t=arguments[1];this._geometryFactory=t,this.computePoints(s),this.computeRing()}}}}])}(),Rt=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"setEdgeRing",value:function(e,r){e.setMinEdgeRing(r)}},{key:"getNext",value:function(e){return e.getNextMin()}}],[{key:"constructor_",value:function(){var e=arguments[0],r=arguments[1];Hi.constructor_.call(this,e,r)}}])}(Hi),je=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"buildMinimalRings",value:function(){var e=new Lt,r=this._startDe;do{if(r.getMinEdgeRing()===null){var c=new Rt(r,this._geometryFactory);e.add(c)}r=r.getNext()}while(r!==this._startDe);return e}},{key:"setEdgeRing",value:function(e,r){e.setEdgeRing(r)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var e=this._startDe;do e.getNode().getEdges().linkMinimalDirectedEdges(this),e=e.getNext();while(e!==this._startDe)}},{key:"getNext",value:function(e){return e.getNext()}}],[{key:"constructor_",value:function(){var e=arguments[0],r=arguments[1];Hi.constructor_.call(this,e,r)}}])}(Hi),Jt=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"setVisited",value:function(s){this._isVisited=s}},{key:"setInResult",value:function(s){this._isInResult=s}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(s){this._label=s}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(s){this._isCovered=s,this._isCoveredSet=!0}},{key:"updateIM",value:function(s){at.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(s)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var s=arguments[0];this._label=s}}}}])}(),pi=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"isIncidentEdgeInResult",value:function(){for(var e=this.getEdges().getEdges().iterator();e.hasNext();)if(e.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(e){e.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(e){}},{key:"computeMergedLocation",value:function(e,r){var c=Z.NONE;if(c=this._label.getLocation(r),!e.isNull(r)){var p=e.getLocation(r);c!==Z.BOUNDARY&&(c=p)}return c}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return z(t,"setLabel",this,1).apply(this,arguments);var e=arguments[0],r=arguments[1];this._label===null?this._label=new Le(e,r):this._label.setLocation(e,r)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof t){var e=arguments[0];this.mergeLabel(e._label)}else if(arguments[0]instanceof Le)for(var r=arguments[0],c=0;c<2;c++){var p=this.computeMergedLocation(r,c);this._label.getLocation(c)===Z.NONE&&this._label.setLocation(c,p)}}},{key:"add",value:function(e){this._edges.insert(e),e.setNode(this)}},{key:"setLabelBoundary",value:function(e){if(this._label===null)return null;var r=Z.NONE;this._label!==null&&(r=this._label.getLocation(e));var c=null;switch(r){case Z.BOUNDARY:c=Z.INTERIOR;break;case Z.INTERIOR:default:c=Z.BOUNDARY}this._label.setLocation(e,c)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var e=arguments[0],r=arguments[1];this._coord=e,this._edges=r,this._label=new Le(0,Z.NONE)}}])}(Jt),Er=function(s){function t(){return l(this,t),a(this,t,arguments)}return I(t,s),m(t)}(hs);function Zi(s){return s==null?0:s.color}function Yt(s){return s==null?null:s.parent}function me(s,t){s!==null&&(s.color=t)}function yi(s){return s==null?null:s.left}function Jn(s){return s==null?null:s.right}var ee=function(s){function t(){var e;return l(this,t),(e=a(this,t)).root_=null,e.size_=0,e}return I(t,s),m(t,[{key:"get",value:function(e){for(var r=this.root_;r!==null;){var c=e.compareTo(r.key);if(c<0)r=r.left;else{if(!(c>0))return r.value;r=r.right}}return null}},{key:"put",value:function(e,r){if(this.root_===null)return this.root_={key:e,value:r,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var c,p,v=this.root_;do if(c=v,(p=e.compareTo(v.key))<0)v=v.left;else{if(!(p>0)){var E=v.value;return v.value=r,E}v=v.right}while(v!==null);var C={key:e,left:null,right:null,value:r,parent:c,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return p<0?c.left=C:c.right=C,this.fixAfterInsertion(C),this.size_++,null}},{key:"fixAfterInsertion",value:function(e){var r;for(e.color=1;e!=null&&e!==this.root_&&e.parent.color===1;)Yt(e)===yi(Yt(Yt(e)))?Zi(r=Jn(Yt(Yt(e))))===1?(me(Yt(e),0),me(r,0),me(Yt(Yt(e)),1),e=Yt(Yt(e))):(e===Jn(Yt(e))&&(e=Yt(e),this.rotateLeft(e)),me(Yt(e),0),me(Yt(Yt(e)),1),this.rotateRight(Yt(Yt(e)))):Zi(r=yi(Yt(Yt(e))))===1?(me(Yt(e),0),me(r,0),me(Yt(Yt(e)),1),e=Yt(Yt(e))):(e===yi(Yt(e))&&(e=Yt(e),this.rotateRight(e)),me(Yt(e),0),me(Yt(Yt(e)),1),this.rotateLeft(Yt(Yt(e))));this.root_.color=0}},{key:"values",value:function(){var e=new Lt,r=this.getFirstEntry();if(r!==null)for(e.add(r.value);(r=t.successor(r))!==null;)e.add(r.value);return e}},{key:"entrySet",value:function(){var e=new ce,r=this.getFirstEntry();if(r!==null)for(e.add(r);(r=t.successor(r))!==null;)e.add(r);return e}},{key:"rotateLeft",value:function(e){if(e!=null){var r=e.right;e.right=r.left,r.left!=null&&(r.left.parent=e),r.parent=e.parent,e.parent==null?this.root_=r:e.parent.left===e?e.parent.left=r:e.parent.right=r,r.left=e,e.parent=r}}},{key:"rotateRight",value:function(e){if(e!=null){var r=e.left;e.left=r.right,r.right!=null&&(r.right.parent=e),r.parent=e.parent,e.parent==null?this.root_=r:e.parent.right===e?e.parent.right=r:e.parent.left=r,r.right=e,e.parent=r}}},{key:"getFirstEntry",value:function(){var e=this.root_;if(e!=null)for(;e.left!=null;)e=e.left;return e}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(e){for(var r=this.root_;r!==null;){var c=e.compareTo(r.key);if(c<0)r=r.left;else{if(!(c>0))return!0;r=r.right}}return!1}}],[{key:"successor",value:function(e){var r;if(e===null)return null;if(e.right!==null){for(r=e.right;r.left!==null;)r=r.left;return r}r=e.parent;for(var c=e;r!==null&&c===r.right;)c=r,r=r.parent;return r}}])}(Er),xn=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"find",value:function(s){return this.nodeMap.get(s)}},{key:"addNode",value:function(){if(arguments[0]instanceof Q){var s=arguments[0],t=this.nodeMap.get(s);return t===null&&(t=this.nodeFact.createNode(s),this.nodeMap.put(s,t)),t}if(arguments[0]instanceof pi){var e=arguments[0],r=this.nodeMap.get(e.getCoordinate());return r===null?(this.nodeMap.put(e.getCoordinate(),e),e):(r.mergeLabel(e),r)}}},{key:"print",value:function(s){for(var t=this.iterator();t.hasNext();)t.next().print(s)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(s){for(var t=new Lt,e=this.iterator();e.hasNext();){var r=e.next();r.getLabel().getLocation(s)===Z.BOUNDARY&&t.add(r)}return t}},{key:"add",value:function(s){var t=s.getCoordinate();this.addNode(t).add(s)}}],[{key:"constructor_",value:function(){this.nodeMap=new ee,this.nodeFact=null;var s=arguments[0];this.nodeFact=s}}])}(),pe=function(){function s(){l(this,s)}return m(s,null,[{key:"isNorthern",value:function(t){return t===s.NE||t===s.NW}},{key:"isOpposite",value:function(t,e){return t!==e&&(t-e+4)%4===2}},{key:"commonHalfPlane",value:function(t,e){if(t===e)return t;if((t-e+4)%4===2)return-1;var r=t<e?t:e;return r===0&&(t>e?t:e)===3?3:r}},{key:"isInHalfPlane",value:function(t,e){return e===s.SE?t===s.SE||t===s.SW:t===e||t===e+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new H("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?s.NE:s.SE:e>=0?s.NW:s.SW}if(arguments[0]instanceof Q&&arguments[1]instanceof Q){var r=arguments[0],c=arguments[1];if(c.x===r.x&&c.y===r.y)throw new H("Cannot compute the quadrant for two identical points "+r);return c.x>=r.x?c.y>=r.y?s.NE:s.SE:c.y>=r.y?s.NW:s.SW}}}])}();pe.NE=0,pe.NW=1,pe.SW=2,pe.SE=3;var Pr=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"compareDirection",value:function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:Tt.index(t._p0,t._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(t){this._node=t}},{key:"print",value:function(t){var e=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),c=r.lastIndexOf("."),p=r.substring(c+1);t.print("  "+p+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}},{key:"compareTo",value:function(t){var e=t;return this.compareDirection(e)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),r=e.lastIndexOf(".");return"  "+e.substring(r+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}},{key:"computeLabel",value:function(t){}},{key:"init",value:function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=pe.quadrant(this._dx,this._dy),at.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[J]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var t=arguments[0];this._edge=t}else if(arguments.length===3){var e=arguments[0],r=arguments[1],c=arguments[2];s.constructor_.call(this,e,r,c,null)}else if(arguments.length===4){var p=arguments[0],v=arguments[1],E=arguments[2],C=arguments[3];s.constructor_.call(this,p),this.init(v,E),this._label=C}}}])}(),Ir=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(e){return this._depth[e]}},{key:"setVisited",value:function(e){this._isVisited=e}},{key:"computeDirectedLabel",value:function(){this._label=new Le(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(e,r){if(this._depth[e]!==-999&&this._depth[e]!==r)throw new Ve("assigned depths do not match",this.getCoordinate());this._depth[e]=r}},{key:"isInteriorAreaEdge",value:function(){for(var e=!0,r=0;r<2;r++)this._label.isArea(r)&&this._label.getLocation(r,pt.LEFT)===Z.INTERIOR&&this._label.getLocation(r,pt.RIGHT)===Z.INTERIOR||(e=!1);return e}},{key:"setNextMin",value:function(e){this._nextMin=e}},{key:"print",value:function(e){z(t,"print",this,1).call(this,e),e.print(" "+this._depth[pt.LEFT]+"/"+this._depth[pt.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")}},{key:"setMinEdgeRing",value:function(e){this._minEdgeRing=e}},{key:"isLineEdge",value:function(){var e=this._label.isLine(0)||this._label.isLine(1),r=!this._label.isArea(0)||this._label.allPositionsEqual(0,Z.EXTERIOR),c=!this._label.isArea(1)||this._label.allPositionsEqual(1,Z.EXTERIOR);return e&&r&&c}},{key:"setEdgeRing",value:function(e){this._edgeRing=e}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var e=this._edge.getDepthDelta();return this._isForward||(e=-e),e}},{key:"setInResult",value:function(e){this._isInResult=e}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(e){this.print(e),e.print(" "),this._isForward?this._edge.print(e):this._edge.printReverse(e)}},{key:"setSym",value:function(e){this._sym=e}},{key:"setVisitedEdge",value:function(e){this.setVisited(e),this._sym.setVisited(e)}},{key:"setEdgeDepths",value:function(e,r){var c=this.getEdge().getDepthDelta();this._isForward||(c=-c);var p=1;e===pt.LEFT&&(p=-1);var v=pt.opposite(e),E=r+c*p;this.setDepth(e,r),this.setDepth(v,E)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(e){this._next=e}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var e=arguments[0],r=arguments[1];if(Pr.constructor_.call(this,e),this._isForward=r,r)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var c=e.getNumPoints()-1;this.init(e.getCoordinate(c),e.getCoordinate(c-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(e,r){return e===Z.EXTERIOR&&r===Z.INTERIOR?1:e===Z.INTERIOR&&r===Z.EXTERIOR?-1:0}}])}(Pr),Lr=function(){return m(function s(){l(this,s)},[{key:"createNode",value:function(s){return new pi(s,null)}}])}(),Ui=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"printEdges",value:function(s){s.println("Edges:");for(var t=0;t<this._edges.size();t++){s.println("edge "+t+":");var e=this._edges.get(t);e.print(s),e.eiList.print(s)}}},{key:"find",value:function(s){return this._nodes.find(s)}},{key:"addNode",value:function(){if(arguments[0]instanceof pi){var s=arguments[0];return this._nodes.addNode(s)}if(arguments[0]instanceof Q){var t=arguments[0];return this._nodes.addNode(t)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var s=this._nodes.iterator();s.hasNext();)s.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(s){Fe.out.println(s)}},{key:"isBoundaryNode",value:function(s,t){var e=this._nodes.find(t);if(e===null)return!1;var r=e.getLabel();return r!==null&&r.getLocation(s)===Z.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var s=this._nodes.iterator();s.hasNext();)s.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(s,t,e,r){return!!s.equals(e)&&Tt.index(s,t,r)===Tt.COLLINEAR&&pe.quadrant(s,t)===pe.quadrant(e,r)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(s){Fe.out.print(s)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(s,t){for(var e=0;e<this._edges.size();e++){var r=this._edges.get(e),c=r.getCoordinates();if(this.matchInSameDirection(s,t,c[0],c[1])||this.matchInSameDirection(s,t,c[c.length-1],c[c.length-2]))return r}return null}},{key:"insertEdge",value:function(s){this._edges.add(s)}},{key:"findEdgeEnd",value:function(s){for(var t=this.getEdgeEnds().iterator();t.hasNext();){var e=t.next();if(e.getEdge()===s)return e}return null}},{key:"addEdges",value:function(s){for(var t=s.iterator();t.hasNext();){var e=t.next();this._edges.add(e);var r=new Ir(e,!0),c=new Ir(e,!1);r.setSym(c),c.setSym(r),this.add(r),this.add(c)}}},{key:"add",value:function(s){this._nodes.add(s),this._edgeEndList.add(s)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(s,t){for(var e=0;e<this._edges.size();e++){var r=this._edges.get(e),c=r.getCoordinates();if(s.equals(c[0])&&t.equals(c[1]))return r}return null}}],[{key:"constructor_",value:function(){if(this._edges=new Lt,this._nodes=null,this._edgeEndList=new Lt,arguments.length===0)this._nodes=new xn(new Lr);else if(arguments.length===1){var s=arguments[0];this._nodes=new xn(s)}}},{key:"linkResultDirectedEdges",value:function(s){for(var t=s.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()}}])}(),uo=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"sortShellsAndHoles",value:function(t,e,r){for(var c=t.iterator();c.hasNext();){var p=c.next();p.isHole()?r.add(p):e.add(p)}}},{key:"computePolygons",value:function(t){for(var e=new Lt,r=t.iterator();r.hasNext();){var c=r.next().toPolygon(this._geometryFactory);e.add(c)}return e}},{key:"placeFreeHoles",value:function(t,e){for(var r=e.iterator();r.hasNext();){var c=r.next();if(c.getShell()===null){var p=s.findEdgeRingContaining(c,t);if(p===null)throw new Ve("unable to assign hole to a shell",c.getCoordinate(0));c.setShell(p)}}}},{key:"buildMinimalEdgeRings",value:function(t,e,r){for(var c=new Lt,p=t.iterator();p.hasNext();){var v=p.next();if(v.getMaxNodeDegree()>2){v.linkDirectedEdgesForMinimalEdgeRings();var E=v.buildMinimalRings(),C=this.findShell(E);C!==null?(this.placePolygonHoles(C,E),e.add(C)):r.addAll(E)}else c.add(v)}return c}},{key:"buildMaximalEdgeRings",value:function(t){for(var e=new Lt,r=t.iterator();r.hasNext();){var c=r.next();if(c.isInResult()&&c.getLabel().isArea()&&c.getEdgeRing()===null){var p=new je(c,this._geometryFactory);e.add(p),p.setInResult()}}return e}},{key:"placePolygonHoles",value:function(t,e){for(var r=e.iterator();r.hasNext();){var c=r.next();c.isHole()&&c.setShell(t)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(t){for(var e=0,r=null,c=t.iterator();c.hasNext();){var p=c.next();p.isHole()||(r=p,e++)}return at.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),r}},{key:"add",value:function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var e=arguments[0],r=arguments[1];Ui.linkResultDirectedEdges(r);var c=this.buildMaximalEdgeRings(e),p=new Lt,v=this.buildMinimalEdgeRings(c,this._shellList,p);this.sortShellsAndHoles(v,this._shellList,p),this.placeFreeHoles(this._shellList,p)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new Lt;var t=arguments[0];this._geometryFactory=t}},{key:"findEdgeRingContaining",value:function(t,e){for(var r=t.getLinearRing(),c=r.getEnvelopeInternal(),p=r.getCoordinateN(0),v=null,E=null,C=e.iterator();C.hasNext();){var D=C.next(),$=D.getLinearRing(),nt=$.getEnvelopeInternal();if(!nt.equals(c)&&nt.contains(c)){p=se.ptNotInList(r.getCoordinates(),$.getCoordinates());var gt=!1;Kn.isInRing(p,$.getCoordinates())&&(gt=!0),gt&&(v===null||E.contains(nt))&&(E=(v=D).getLinearRing().getEnvelopeInternal())}}return v}}])}(),Mr=function(){return m(function s(){l(this,s)},[{key:"getBounds",value:function(){}}])}(),Dt=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[Mr,M]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var s=arguments[0],t=arguments[1];this._bounds=s,this._item=t}}])}(),Yi=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"poll",value:function(){if(this.isEmpty())return null;var s=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),s}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(s){for(var t=null,e=this._items.get(s);2*s<=this._size&&((t=2*s)!==this._size&&this._items.get(t+1).compareTo(this._items.get(t))<0&&t++,this._items.get(t).compareTo(e)<0);s=t)this._items.set(s,this._items.get(t));this._items.set(s,e)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(s){this._items.add(null),this._size+=1;var t=this._size;for(this._items.set(0,s);s.compareTo(this._items.get(Math.trunc(t/2)))<0;t/=2)this._items.set(t,this._items.get(Math.trunc(t/2)));this._items.set(t,s)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new Lt,this._items.add(null)}}])}(),He=function(){return m(function s(){l(this,s)},[{key:"insert",value:function(s,t){}},{key:"remove",value:function(s,t){}},{key:"query",value:function(){}}])}(),ye=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(s){at.isTrue(this._bounds===null),this._childBoundables.add(s)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[Mr,M]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new Lt,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var s=arguments[0];this._level=s}}}}])}(),Dn={reverseOrder:function(){return{compare:function(s,t){return t.compareTo(s)}}},min:function(s){return Dn.sort(s),s.get(0)},sort:function(s,t){var e=s.toArray();t?de.sort(e,t):de.sort(e);for(var r=s.iterator(),c=0,p=e.length;c<p;c++)r.next(),r.set(e[c])},singletonList:function(s){var t=new Lt;return t.add(s),t}},lo=function(){function s(){l(this,s)}return m(s,null,[{key:"maxDistance",value:function(t,e,r,c,p,v,E,C){var D=s.distance(t,e,p,v);return D=Math.max(D,s.distance(t,e,E,C)),D=Math.max(D,s.distance(r,c,p,v)),D=Math.max(D,s.distance(r,c,E,C))}},{key:"distance",value:function(t,e,r,c){var p=r-t,v=c-e;return Math.sqrt(p*p+v*v)}},{key:"maximumDistance",value:function(t,e){var r=Math.min(t.getMinX(),e.getMinX()),c=Math.min(t.getMinY(),e.getMinY()),p=Math.max(t.getMaxX(),e.getMaxX()),v=Math.max(t.getMaxY(),e.getMaxY());return s.distance(r,c,p,v)}},{key:"minMaxDistance",value:function(t,e){var r=t.getMinX(),c=t.getMinY(),p=t.getMaxX(),v=t.getMaxY(),E=e.getMinX(),C=e.getMinY(),D=e.getMaxX(),$=e.getMaxY(),nt=s.maxDistance(r,c,r,v,E,C,E,$);return nt=Math.min(nt,s.maxDistance(r,c,r,v,E,C,D,C)),nt=Math.min(nt,s.maxDistance(r,c,r,v,D,$,E,$)),nt=Math.min(nt,s.maxDistance(r,c,r,v,D,$,D,C)),nt=Math.min(nt,s.maxDistance(r,c,p,c,E,C,E,$)),nt=Math.min(nt,s.maxDistance(r,c,p,c,E,C,D,C)),nt=Math.min(nt,s.maxDistance(r,c,p,c,D,$,E,$)),nt=Math.min(nt,s.maxDistance(r,c,p,c,D,$,D,C)),nt=Math.min(nt,s.maxDistance(p,v,r,v,E,C,E,$)),nt=Math.min(nt,s.maxDistance(p,v,r,v,E,C,D,C)),nt=Math.min(nt,s.maxDistance(p,v,r,v,D,$,E,$)),nt=Math.min(nt,s.maxDistance(p,v,r,v,D,$,D,C)),nt=Math.min(nt,s.maxDistance(p,v,p,c,E,C,E,$)),nt=Math.min(nt,s.maxDistance(p,v,p,c,E,C,D,C)),nt=Math.min(nt,s.maxDistance(p,v,p,c,D,$,E,$)),nt=Math.min(nt,s.maxDistance(p,v,p,c,D,$,D,C))}}])}(),kn=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"maximumDistance",value:function(){return lo.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(t,e){var r=s.isComposite(this._boundable1),c=s.isComposite(this._boundable2);if(r&&c)return s.area(this._boundable1)>s.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,t,e),null):(this.expand(this._boundable2,this._boundable1,!0,t,e),null);if(r)return this.expand(this._boundable1,this._boundable2,!1,t,e),null;if(c)return this.expand(this._boundable2,this._boundable1,!0,t,e),null;throw new H("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(s.isComposite(this._boundable1)||s.isComposite(this._boundable2))}},{key:"compareTo",value:function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0}},{key:"expand",value:function(t,e,r,c,p){for(var v=t.getChildBoundables().iterator();v.hasNext();){var E=v.next(),C=null;(C=r?new s(e,E,this._itemDistance):new s(E,e,this._itemDistance)).getDistance()<p&&c.add(C)}}},{key:"getBoundable",value:function(t){return t===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[J]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],r=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=r,this._distance=this.distance()}},{key:"area",value:function(t){return t.getBounds().getArea()}},{key:"isComposite",value:function(t){return t instanceof ye}}])}(),cs=function(){return m(function s(){l(this,s)},[{key:"visitItem",value:function(s){}}])}(),Fn=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"queryInternal",value:function(){if(bt(arguments[2],cs)&&arguments[0]instanceof Object&&arguments[1]instanceof ye)for(var t=arguments[0],e=arguments[2],r=arguments[1].getChildBoundables(),c=0;c<r.size();c++){var p=r.get(c);this.getIntersectsOp().intersects(p.getBounds(),t)&&(p instanceof ye?this.queryInternal(t,p,e):p instanceof Dt?e.visitItem(p.getItem()):at.shouldNeverReachHere())}else if(bt(arguments[2],Ye)&&arguments[0]instanceof Object&&arguments[1]instanceof ye)for(var v=arguments[0],E=arguments[2],C=arguments[1].getChildBoundables(),D=0;D<C.size();D++){var $=C.get(D);this.getIntersectsOp().intersects($.getBounds(),v)&&($ instanceof ye?this.queryInternal(v,$,E):$ instanceof Dt?E.add($.getItem()):at.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(t){return t.get(t.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var r=e.next();r instanceof ye?t+=this.size(r):r instanceof Dt&&(t+=1)}return t}}},{key:"removeItem",value:function(t,e){for(var r=null,c=t.getChildBoundables().iterator();c.hasNext();){var p=c.next();p instanceof Dt&&p.getItem()===e&&(r=p)}return r!==null&&(t.getChildBoundables().remove(r),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var t=this.itemsTree(this._root);return t===null?new Lt:t}if(arguments.length===1){for(var e=arguments[0],r=new Lt,c=e.getChildBoundables().iterator();c.hasNext();){var p=c.next();if(p instanceof ye){var v=this.itemsTree(p);v!==null&&r.add(v)}else p instanceof Dt?r.add(p.getItem()):at.shouldNeverReachHere()}return r.size()<=0?null:r}}},{key:"insert",value:function(t,e){at.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Dt(t,e))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var t=arguments[0],e=new Lt;return this.boundablesAtLevel(t,this._root,e),e}if(arguments.length===3){var r=arguments[0],c=arguments[1],p=arguments[2];if(at.isTrue(r>-2),c.getLevel()===r)return p.add(c),null;for(var v=c.getChildBoundables().iterator();v.hasNext();){var E=v.next();E instanceof ye?this.boundablesAtLevel(r,E,p):(at.isTrue(E instanceof Dt),r===-1&&p.add(E))}return null}}},{key:"query",value:function(){if(arguments.length===1){var t=arguments[0];this.build();var e=new Lt;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e),e}if(arguments.length===2){var r=arguments[0],c=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),r)&&this.queryInternal(r,this._root,c)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(arguments.length===3){var r=arguments[0],c=arguments[1],p=arguments[2],v=this.removeItem(c,p);if(v)return!0;for(var E=null,C=c.getChildBoundables().iterator();C.hasNext();){var D=C.next();if(this.getIntersectsOp().intersects(D.getBounds(),r)&&D instanceof ye&&(v=this.remove(r,D,p))){E=D;break}}return E!==null&&E.getChildBoundables().isEmpty()&&c.getChildBoundables().remove(E),v}}},{key:"createHigherLevels",value:function(t,e){at.isTrue(!t.isEmpty());var r=this.createParentBoundables(t,e+1);return r.size()===1?r.get(0):this.createHigherLevels(r,e+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var r=e.next();if(r instanceof ye){var c=this.depth(r);c>t&&(t=c)}}return t+1}}},{key:"createParentBoundables",value:function(t,e){at.isTrue(!t.isEmpty());var r=new Lt;r.add(this.createNode(e));var c=new Lt(t);Dn.sort(c,this.getComparator());for(var p=c.iterator();p.hasNext();){var v=p.next();this.lastNode(r).getChildBoundables().size()===this.getNodeCapacity()&&r.add(this.createNode(e)),this.lastNode(r).addChildBoundable(v)}return r}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[M]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new Lt,this._nodeCapacity=null,arguments.length===0)s.constructor_.call(this,s.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var t=arguments[0];at.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}}},{key:"compareDoubles",value:function(t,e){return t>e?1:t<e?-1:0}}])}();Fn.IntersectsOp=function(){},Fn.DEFAULT_NODE_CAPACITY=10;var ho=function(){return m(function s(){l(this,s)},[{key:"distance",value:function(s,t){}}])}(),$e=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"createParentBoundablesFromVerticalSlices",value:function(e,r){at.isTrue(e.length>0);for(var c=new Lt,p=0;p<e.length;p++)c.addAll(this.createParentBoundablesFromVerticalSlice(e[p],r));return c}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var e=arguments[0],r=arguments[1];return this.nearestNeighbourK(e,W.POSITIVE_INFINITY,r)}if(arguments.length===3){var c=arguments[0],p=arguments[2],v=arguments[1],E=new Yi;E.add(c);for(var C=new Yi;!E.isEmpty()&&v>=0;){var D=E.poll(),$=D.getDistance();if($>=v)break;D.isLeaves()?C.size()<p?C.add(D):(C.peek().getDistance()>$&&(C.poll(),C.add(D)),v=C.peek().getDistance()):D.expandToQueue(E,v)}return t.getItems(C)}}},{key:"createNode",value:function(e){return new Xi(e)}},{key:"size",value:function(){return arguments.length===0?z(t,"size",this,1).call(this):z(t,"size",this,1).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ct))return z(t,"insert",this,1).apply(this,arguments);var e=arguments[0],r=arguments[1];if(e.isNull())return null;z(t,"insert",this,1).call(this,e,r)}},{key:"getIntersectsOp",value:function(){return t.intersectsOp}},{key:"verticalSlices",value:function(e,r){for(var c=Math.trunc(Math.ceil(e.size()/r)),p=new Array(r).fill(null),v=e.iterator(),E=0;E<r;E++){p[E]=new Lt;for(var C=0;v.hasNext()&&C<c;){var D=v.next();p[E].add(D),C++}}return p}},{key:"query",value:function(){if(arguments.length===1){var e=arguments[0];return z(t,"query",this,1).call(this,e)}if(arguments.length===2){var r=arguments[0],c=arguments[1];z(t,"query",this,1).call(this,r,c)}}},{key:"getComparator",value:function(){return t.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(e,r){return z(t,"createParentBoundables",this,1).call(this,e,r)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ct){var e=arguments[0],r=arguments[1];return z(t,"remove",this,1).call(this,e,r)}return z(t,"remove",this,1).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?z(t,"depth",this,1).call(this):z(t,"depth",this,1).apply(this,arguments)}},{key:"createParentBoundables",value:function(e,r){at.isTrue(!e.isEmpty());var c=Math.trunc(Math.ceil(e.size()/this.getNodeCapacity())),p=new Lt(e);Dn.sort(p,t.xComparator);var v=this.verticalSlices(p,Math.trunc(Math.ceil(Math.sqrt(c))));return this.createParentBoundablesFromVerticalSlices(v,r)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(bt(arguments[0],ho)){var e=arguments[0];if(this.isEmpty())return null;var r=new kn(this.getRoot(),this.getRoot(),e);return this.nearestNeighbour(r)}if(arguments[0]instanceof kn){var c=arguments[0],p=W.POSITIVE_INFINITY,v=null,E=new Yi;for(E.add(c);!E.isEmpty()&&p>0;){var C=E.poll(),D=C.getDistance();if(D>=p)break;C.isLeaves()?(p=D,v=C):C.expandToQueue(E,p)}return v===null?null:[v.getBoundable(0).getItem(),v.getBoundable(1).getItem()]}}else{if(arguments.length===2){var $=arguments[0],nt=arguments[1];if(this.isEmpty()||$.isEmpty())return null;var gt=new kn(this.getRoot(),$.getRoot(),nt);return this.nearestNeighbour(gt)}if(arguments.length===3){var xt=arguments[2],Et=new Dt(arguments[0],arguments[1]),It=new kn(this.getRoot(),Et,xt);return this.nearestNeighbour(It)[0]}if(arguments.length===4){var Ut=arguments[2],zt=arguments[3],jt=new Dt(arguments[0],arguments[1]),te=new kn(this.getRoot(),jt,Ut);return this.nearestNeighbourK(te,zt)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var e=arguments[0],r=arguments[1],c=W.POSITIVE_INFINITY,p=new Yi;for(p.add(e);!p.isEmpty();){var v=p.poll(),E=v.getDistance();if(E>r)return!1;if(v.maximumDistance()<=r)return!0;if(v.isLeaves()){if((c=E)<=r)return!0}else v.expandToQueue(p,c)}return!1}if(arguments.length===3){var C=arguments[0],D=arguments[1],$=arguments[2],nt=new kn(this.getRoot(),C.getRoot(),D);return this.isWithinDistance(nt,$)}}},{key:"interfaces_",get:function(){return[He,M]}}],[{key:"constructor_",value:function(){if(arguments.length===0)t.constructor_.call(this,t.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var e=arguments[0];Fn.constructor_.call(this,e)}}},{key:"centreX",value:function(e){return t.avg(e.getMinX(),e.getMaxX())}},{key:"avg",value:function(e,r){return(e+r)/2}},{key:"getItems",value:function(e){for(var r=new Array(e.size()).fill(null),c=0;!e.isEmpty();){var p=e.poll();r[c]=p.getBoundable(0).getItem(),c++}return r}},{key:"centreY",value:function(e){return t.avg(e.getMinY(),e.getMaxY())}}])}(Fn),Xi=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"computeBounds",value:function(){for(var e=null,r=this.getChildBoundables().iterator();r.hasNext();){var c=r.next();e===null?e=new Ct(c.getBounds()):e.expandToInclude(c.getBounds())}return e}}],[{key:"constructor_",value:function(){var e=arguments[0];ye.constructor_.call(this,e)}}])}(ye);$e.STRtreeNode=Xi,$e.xComparator=new(function(){return m(function s(){l(this,s)},[{key:"interfaces_",get:function(){return[rt]}},{key:"compare",value:function(s,t){return Fn.compareDoubles($e.centreX(s.getBounds()),$e.centreX(t.getBounds()))}}])}()),$e.yComparator=new(function(){return m(function s(){l(this,s)},[{key:"interfaces_",get:function(){return[rt]}},{key:"compare",value:function(s,t){return Fn.compareDoubles($e.centreY(s.getBounds()),$e.centreY(t.getBounds()))}}])}()),$e.intersectsOp=new(function(){return m(function s(){l(this,s)},[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(s,t){return s.intersects(t)}}])}()),$e.DEFAULT_NODE_CAPACITY=10;var co=function(){function s(){l(this,s)}return m(s,null,[{key:"relativeSign",value:function(t,e){return t<e?-1:t>e?1:0}},{key:"compare",value:function(t,e,r){if(e.equals2D(r))return 0;var c=s.relativeSign(e.x,r.x),p=s.relativeSign(e.y,r.y);switch(t){case 0:return s.compareValue(c,p);case 1:return s.compareValue(p,c);case 2:return s.compareValue(p,-c);case 3:return s.compareValue(-c,p);case 4:return s.compareValue(-c,-p);case 5:return s.compareValue(-p,-c);case 6:return s.compareValue(-p,c);case 7:return s.compareValue(c,-p)}return at.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0}}])}(),Qe=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(s){s.print(this.coord),s.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(s){var t=s;return this.segmentIndex<t.segmentIndex?-1:this.segmentIndex>t.segmentIndex?1:this.coord.equals2D(t.coord)?0:this._isInterior?t._isInterior?co.compare(this._segmentOctant,this.coord,t.coord):1:-1}},{key:"isEndPoint",value:function(s){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===s}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[J]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var s=arguments[0],t=arguments[1],e=arguments[2],r=arguments[3];this._segString=s,this.coord=new Q(t),this.segmentIndex=e,this._segmentOctant=r,this._isInterior=!t.equals2D(s.getCoordinate(e))}}])}(),fo=function(){return m(function s(){l(this,s)},[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}])}(),fs=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"getSplitCoordinates",value:function(){var s=new fi;this.addEndpoints();for(var t=this.iterator(),e=t.next();t.hasNext();){var r=t.next();this.addEdgeCoordinates(e,r,s),e=r}return s.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var s=new Lt;this.findCollapsesFromInsertedNodes(s),this.findCollapsesFromExistingVertices(s);for(var t=s.iterator();t.hasNext();){var e=t.next().intValue();this.add(this._edge.getCoordinate(e),e)}}},{key:"createSplitEdgePts",value:function(s,t){var e=t.segmentIndex-s.segmentIndex+2;if(e===2)return[new Q(s.coord),new Q(t.coord)];var r=this._edge.getCoordinate(t.segmentIndex),c=t.isInterior()||!t.coord.equals2D(r);c||e--;var p=new Array(e).fill(null),v=0;p[v++]=new Q(s.coord);for(var E=s.segmentIndex+1;E<=t.segmentIndex;E++)p[v++]=this._edge.getCoordinate(E);return c&&(p[v]=new Q(t.coord)),p}},{key:"print",value:function(s){s.println("Intersections:");for(var t=this.iterator();t.hasNext();)t.next().print(s)}},{key:"findCollapsesFromExistingVertices",value:function(s){for(var t=0;t<this._edge.size()-2;t++){var e=this._edge.getCoordinate(t);this._edge.getCoordinate(t+1);var r=this._edge.getCoordinate(t+2);e.equals2D(r)&&s.add(Xe.valueOf(t+1))}}},{key:"addEdgeCoordinates",value:function(s,t,e){var r=this.createSplitEdgePts(s,t);e.add(r,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(s){this.addEndpoints(),this.addCollapsedNodes();for(var t=this.iterator(),e=t.next();t.hasNext();){var r=t.next(),c=this.createSplitEdge(e,r);s.add(c),e=r}}},{key:"findCollapseIndex",value:function(s,t,e){if(!s.coord.equals2D(t.coord))return!1;var r=t.segmentIndex-s.segmentIndex;return t.isInterior()||r--,r===1&&(e[0]=s.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(s){for(var t=new Array(1).fill(null),e=this.iterator(),r=e.next();e.hasNext();){var c=e.next();this.findCollapseIndex(r,c,t)&&s.add(Xe.valueOf(t[0])),r=c}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var s=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(s),s)}},{key:"createSplitEdge",value:function(s,t){var e=this.createSplitEdgePts(s,t);return new fn(e,this._edge.getData())}},{key:"add",value:function(s,t){var e=new Qe(this._edge,s,t,this._edge.getSegmentOctant(t)),r=this._nodeMap.get(e);return r!==null?(at.isTrue(r.coord.equals2D(s),"Found equal nodes with different coordinates"),r):(this._nodeMap.put(e,e),e)}},{key:"checkSplitEdgesCorrectness",value:function(s){var t=this._edge.getCoordinates(),e=s.get(0).getCoordinate(0);if(!e.equals2D(t[0]))throw new ht("bad split edge start point at "+e);var r=s.get(s.size()-1).getCoordinates(),c=r[r.length-1];if(!c.equals2D(t[t.length-1]))throw new ht("bad split edge end point at "+c)}}],[{key:"constructor_",value:function(){this._nodeMap=new ee,this._edge=null;var s=arguments[0];this._edge=s}}])}(),wn=function(){function s(){l(this,s)}return m(s,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new H("Cannot compute the octant for point ( "+t+", "+e+" )");var r=Math.abs(t),c=Math.abs(e);return t>=0?e>=0?r>=c?0:1:r>=c?7:6:e>=0?r>=c?3:2:r>=c?4:5}if(arguments[0]instanceof Q&&arguments[1]instanceof Q){var p=arguments[0],v=arguments[1],E=v.x-p.x,C=v.y-p.y;if(E===0&&C===0)throw new H("Cannot compute the octant for two identical points "+p);return s.octant(E,C)}}}])}(),gs=function(){return m(function s(){l(this,s)},[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(s){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(s){}},{key:"getData",value:function(){}}])}(),ds=function(){return m(function s(){l(this,s)},[{key:"addIntersection",value:function(s,t){}},{key:"interfaces_",get:function(){return[gs]}}])}(),fn=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(t){return this._pts[t]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))}},{key:"setData",value:function(t){this._data=t}},{key:"safeOctant",value:function(t,e){return t.equals2D(e)?0:wn.octant(t,e)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(arguments.length===4){var r=arguments[1],c=arguments[3],p=new Q(arguments[0].getIntersection(c));this.addIntersection(p,r)}}},{key:"toString",value:function(){return mi.toLineString(new gi(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(t,e){var r=e,c=r+1;if(c<this._pts.length){var p=this._pts[c];t.equals2D(p)&&(r=c)}return this._nodeList.add(t,r)}},{key:"addIntersections",value:function(t,e,r){for(var c=0;c<t.getIntersectionNum();c++)this.addIntersection(t,e,r,c)}},{key:"interfaces_",get:function(){return[ds]}}],[{key:"constructor_",value:function(){this._nodeList=new fs(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var t=arguments[0],e=new Lt;return s.getNodedSubstrings(t,e),e}if(arguments.length===2)for(var r=arguments[1],c=arguments[0].iterator();c.hasNext();)c.next().getNodeList().addSplitEdges(r)}}])}(),Oe=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof s){var t=arguments[0],e=Tt.index(this.p0,this.p1,t.p0),r=Tt.index(this.p0,this.p1,t.p1);return e>=0&&r>=0||e<=0&&r<=0?Math.max(e,r):0}if(arguments[0]instanceof Q){var c=arguments[0];return Tt.index(this.p0,this.p1,c)}}},{key:"toGeometry",value:function(t){return t.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(t){if(!(t instanceof s))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)}},{key:"intersection",value:function(t){var e=new cn;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof Q){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new Q(t);var e=this.projectionFactor(t),r=new Q;return r.x=this.p0.x+e*(this.p1.x-this.p0.x),r.y=this.p0.y+e*(this.p1.y-this.p0.y),r}if(arguments[0]instanceof s){var c=arguments[0],p=this.projectionFactor(c.p0),v=this.projectionFactor(c.p1);if(p>=1&&v>=1||p<=0&&v<=0)return null;var E=this.project(c.p0);p<0&&(E=this.p0),p>1&&(E=this.p1);var C=this.project(c.p1);return v<0&&(C=this.p0),v>1&&(C=this.p1),new s(E,C)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(t){return t===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(t){return qe.pointToLinePerpendicular(t,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return s.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,c=e*e+r*r;return c<=0?W.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*r)/c}},{key:"closestPoints",value:function(t){var e=this.intersection(t);if(e!==null)return[e,e];var r=new Array(2).fill(null),c=W.MAX_VALUE,p=null,v=this.closestPoint(t.p0);c=v.distance(t.p0),r[0]=v,r[1]=t.p0;var E=this.closestPoint(t.p1);(p=E.distance(t.p1))<c&&(c=p,r[0]=E,r[1]=t.p1);var C=t.closestPoint(this.p0);(p=C.distance(this.p0))<c&&(c=p,r[0]=this.p0,r[1]=C);var D=t.closestPoint(this.p1);return(p=D.distance(this.p1))<c&&(c=p,r[0]=this.p1,r[1]=D),r}},{key:"closestPoint",value:function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(t){var e=t,r=this.p0.compareTo(e.p0);return r!==0?r:this.p1.compareTo(e.p1)}},{key:"reverse",value:function(){var t=this.p0;this.p0=this.p1,this.p1=t}},{key:"equalsTopo",value:function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}},{key:"lineIntersection",value:function(t){return fr.intersection(this.p0,this.p1,t.p0,t.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(t,e){var r=this.p0.x+t*(this.p1.x-this.p0.x),c=this.p0.y+t*(this.p1.y-this.p0.y),p=this.p1.x-this.p0.x,v=this.p1.y-this.p0.y,E=Math.sqrt(p*p+v*v),C=0,D=0;if(e!==0){if(E<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");C=e*p/E,D=e*v/E}return new Q(r-D,c+C)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=r.x,this.p1.y=r.y}}},{key:"segmentFraction",value:function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||W.isNaN(e))&&(e=1),e}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(t){var e=this.p1.getY()-this.p0.getY(),r=this.p0.getX()-this.p1.getX(),c=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),p=e*e+r*r,v=e*e-r*r,E=t.getX(),C=t.getY();return new Q((-v*E-2*e*r*C-2*e*c)/p,(v*C-2*e*r*E-2*r*c)/p)}},{key:"distance",value:function(){if(arguments[0]instanceof s){var t=arguments[0];return qe.segmentToSegment(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof Q){var e=arguments[0];return qe.pointToSegment(e,this.p0,this.p1)}}},{key:"pointAlong",value:function(t){var e=new Q;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}},{key:"hashCode",value:function(){var t=W.doubleToLongBits(this.p0.x);t^=31*W.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),r=W.doubleToLongBits(this.p1.x);return r^=31*W.doubleToLongBits(this.p1.y),e^(Math.trunc(r)^Math.trunc(r>>32))}},{key:"interfaces_",get:function(){return[J,M]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)s.constructor_.call(this,new Q,new Q);else if(arguments.length===1){var t=arguments[0];s.constructor_.call(this,t.p0,t.p1)}else if(arguments.length===2){var e=arguments[0],r=arguments[1];this.p0=e,this.p1=r}else if(arguments.length===4){var c=arguments[0],p=arguments[1],v=arguments[2],E=arguments[3];s.constructor_.call(this,new Q(c,p),new Q(v,E))}}},{key:"midPoint",value:function(t,e){return new Q((t.x+e.x)/2,(t.y+e.y)/2)}}])}(),ms=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var s=arguments[1],t=arguments[2],e=arguments[3];arguments[0].getLineSegment(s,this._overlapSeg1),t.getLineSegment(e,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new Oe,this._overlapSeg2=new Oe}}])}(),Sr=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"getLineSegment",value:function(s,t){t.p0=this._pts[s],t.p1=this._pts[s+1]}},{key:"computeSelect",value:function(s,t,e,r){var c=this._pts[t],p=this._pts[e];if(e-t==1)return r.select(this,t),null;if(!s.intersects(c,p))return null;var v=Math.trunc((t+e)/2);t<v&&this.computeSelect(s,t,v,r),v<e&&this.computeSelect(s,v,e,r)}},{key:"getCoordinates",value:function(){for(var s=new Array(this._end-this._start+1).fill(null),t=0,e=this._start;e<=this._end;e++)s[t++]=this._pts[e];return s}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var s=arguments[0],t=arguments[1];this.computeOverlaps(this._start,this._end,s,s._start,s._end,t)}else if(arguments.length===6){var e=arguments[0],r=arguments[1],c=arguments[2],p=arguments[3],v=arguments[4],E=arguments[5];if(r-e==1&&v-p==1)return E.overlap(this,e,c,p),null;if(!this.overlaps(e,r,c,p,v))return null;var C=Math.trunc((e+r)/2),D=Math.trunc((p+v)/2);e<C&&(p<D&&this.computeOverlaps(e,C,c,p,D,E),D<v&&this.computeOverlaps(e,C,c,D,v,E)),C<r&&(p<D&&this.computeOverlaps(C,r,c,p,D,E),D<v&&this.computeOverlaps(C,r,c,D,v,E))}}},{key:"setId",value:function(s){this._id=s}},{key:"select",value:function(s,t){this.computeSelect(s,this._start,this._end,t)}},{key:"getEnvelope",value:function(){if(this._env===null){var s=this._pts[this._start],t=this._pts[this._end];this._env=new Ct(s,t)}return this._env}},{key:"overlaps",value:function(s,t,e,r,c){return Ct.intersects(this._pts[s],this._pts[t],e._pts[r],e._pts[c])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var s=arguments[0],t=arguments[1],e=arguments[2],r=arguments[3];this._pts=s,this._start=t,this._end=e,this._context=r}}])}(),go=function(){function s(){l(this,s)}return m(s,null,[{key:"findChainEnd",value:function(t,e){for(var r=e;r<t.length-1&&t[r].equals2D(t[r+1]);)r++;if(r>=t.length-1)return t.length-1;for(var c=pe.quadrant(t[r],t[r+1]),p=e+1;p<t.length&&!(!t[p-1].equals2D(t[p])&&pe.quadrant(t[p-1],t[p])!==c);)p++;return p-1}},{key:"getChains",value:function(){if(arguments.length===1){var t=arguments[0];return s.getChains(t,null)}if(arguments.length===2){var e=arguments[0],r=arguments[1],c=new Lt,p=0;do{var v=s.findChainEnd(e,p),E=new Sr(e,p,v,r);c.add(E),p=v}while(p<e.length-1);return c}}}])}(),Cr=function(){return m(function s(){l(this,s)},[{key:"computeNodes",value:function(s){}},{key:"getNodedSubstrings",value:function(){}}])}(),Vi=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"setSegmentIntersector",value:function(s){this._segInt=s}},{key:"interfaces_",get:function(){return[Cr]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var s=arguments[0];this.setSegmentIntersector(s)}}}}])}(),Tr=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return fn.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(e){for(var r=go.getChains(e.getCoordinates(),e).iterator();r.hasNext();){var c=r.next();c.setId(this._idCounter++),this._index.insert(c.getEnvelope(),c),this._monoChains.add(c)}}},{key:"computeNodes",value:function(e){this._nodedSegStrings=e;for(var r=e.iterator();r.hasNext();)this.add(r.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var e=new Nr(this._segInt),r=this._monoChains.iterator();r.hasNext();)for(var c=r.next(),p=this._index.query(c.getEnvelope()).iterator();p.hasNext();){var v=p.next();if(v.getId()>c.getId()&&(c.computeOverlaps(v,e),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new Lt,this._index=new $e,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var e=arguments[0];Vi.constructor_.call(this,e)}}}}])}(Vi),Nr=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"overlap",value:function(){if(arguments.length!==4)return z(t,"overlap",this,1).apply(this,arguments);var e=arguments[1],r=arguments[2],c=arguments[3],p=arguments[0].getContext(),v=r.getContext();this._si.processIntersections(p,e,v,c)}}],[{key:"constructor_",value:function(){this._si=null;var e=arguments[0];this._si=e}}])}(ms);Tr.SegmentOverlapAction=Nr;var Be=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"isDeletable",value:function(t,e,r,c){var p=this._inputLine[t],v=this._inputLine[e],E=this._inputLine[r];return!!this.isConcave(p,v,E)&&!!this.isShallow(p,v,E,c)&&this.isShallowSampled(p,v,t,r,c)}},{key:"deleteShallowConcavities",value:function(){for(var t=1,e=this.findNextNonDeletedIndex(t),r=this.findNextNonDeletedIndex(e),c=!1;r<this._inputLine.length;){var p=!1;this.isDeletable(t,e,r,this._distanceTol)&&(this._isDeleted[e]=s.DELETE,p=!0,c=!0),t=p?r:e,e=this.findNextNonDeletedIndex(t),r=this.findNextNonDeletedIndex(e)}return c}},{key:"isShallowConcavity",value:function(t,e,r,c){return Tt.index(t,e,r)===this._angleOrientation&&qe.pointToSegment(e,t,r)<c}},{key:"isShallowSampled",value:function(t,e,r,c,p){var v=Math.trunc((c-r)/s.NUM_PTS_TO_CHECK);v<=0&&(v=1);for(var E=r;E<c;E+=v)if(!this.isShallow(t,e,this._inputLine[E],p))return!1;return!0}},{key:"isConcave",value:function(t,e,r){var c=Tt.index(t,e,r)===this._angleOrientation;return c}},{key:"simplify",value:function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=Tt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do e=this.deleteShallowConcavities();while(e);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===s.DELETE;)e++;return e}},{key:"isShallow",value:function(t,e,r,c){return qe.pointToSegment(e,t,r)<c}},{key:"collapseLine",value:function(){for(var t=new fi,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==s.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Tt.COUNTERCLOCKWISE;var t=arguments[0];this._inputLine=t}},{key:"simplify",value:function(t,e){return new s(t).simplify(e)}}])}();Be.INIT=0,Be.DELETE=1,Be.KEEP=1,Be.NUM_PTS_TO_CHECK=10;var vi=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"getCoordinates",value:function(){return this._ptList.toArray(s.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(t){this._precisionModel=t}},{key:"addPt",value:function(t){var e=new Q(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(t,e){if(e)for(var r=0;r<t.length;r++)this.addPt(t[r]);else for(var c=t.length-1;c>=0;c--)this.addPt(t[c])}},{key:"isRedundant",value:function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Ke().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var t=new Q(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)}},{key:"setMinimumVertexDistance",value:function(t){this._minimimVertexDistance=t}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Lt}}])}();vi.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var ue=function(){function s(){l(this,s)}return m(s,null,[{key:"toDegrees",value:function(t){return 180*t/Math.PI}},{key:"normalize",value:function(t){for(;t>Math.PI;)t-=s.PI_TIMES_2;for(;t<=-Math.PI;)t+=s.PI_TIMES_2;return t}},{key:"angle",value:function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}if(arguments.length===2){var e=arguments[0],r=arguments[1],c=r.x-e.x,p=r.y-e.y;return Math.atan2(p,c)}}},{key:"isAcute",value:function(t,e,r){var c=t.x-e.x,p=t.y-e.y;return c*(r.x-e.x)+p*(r.y-e.y)>0}},{key:"isObtuse",value:function(t,e,r){var c=t.x-e.x,p=t.y-e.y;return c*(r.x-e.x)+p*(r.y-e.y)<0}},{key:"interiorAngle",value:function(t,e,r){var c=s.angle(e,t),p=s.angle(e,r);return Math.abs(p-c)}},{key:"normalizePositive",value:function(t){if(t<0){for(;t<0;)t+=s.PI_TIMES_2;t>=s.PI_TIMES_2&&(t=0)}else{for(;t>=s.PI_TIMES_2;)t-=s.PI_TIMES_2;t<0&&(t=0)}return t}},{key:"angleBetween",value:function(t,e,r){var c=s.angle(e,t),p=s.angle(e,r);return s.diff(c,p)}},{key:"diff",value:function(t,e){var r=null;return(r=t<e?e-t:t-e)>Math.PI&&(r=2*Math.PI-r),r}},{key:"toRadians",value:function(t){return t*Math.PI/180}},{key:"getTurn",value:function(t,e){var r=Math.sin(e-t);return r>0?s.COUNTERCLOCKWISE:r<0?s.CLOCKWISE:s.NONE}},{key:"angleBetweenOriented",value:function(t,e,r){var c=s.angle(e,t),p=s.angle(e,r)-c;return p<=-Math.PI?p+s.PI_TIMES_2:p>Math.PI?p-s.PI_TIMES_2:p}}])}();ue.PI_TIMES_2=2*Math.PI,ue.PI_OVER_2=Math.PI/2,ue.PI_OVER_4=Math.PI/4,ue.COUNTERCLOCKWISE=Tt.COUNTERCLOCKWISE,ue.CLOCKWISE=Tt.CLOCKWISE,ue.NONE=Tt.COLLINEAR;var _i=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"addNextSegment",value:function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var r=Tt.index(this._s0,this._s1,this._s2),c=r===Tt.CLOCKWISE&&this._side===pt.LEFT||r===Tt.COUNTERCLOCKWISE&&this._side===pt.RIGHT;r===0?this.addCollinear(e):c?this.addOutsideTurn(r,e):this.addInsideTurn(r,e)}},{key:"addLineEndCap",value:function(t,e){var r=new Oe(t,e),c=new Oe;this.computeOffsetSegment(r,pt.LEFT,this._distance,c);var p=new Oe;this.computeOffsetSegment(r,pt.RIGHT,this._distance,p);var v=e.x-t.x,E=e.y-t.y,C=Math.atan2(E,v);switch(this._bufParams.getEndCapStyle()){case G.CAP_ROUND:this._segList.addPt(c.p1),this.addDirectedFillet(e,C+Math.PI/2,C-Math.PI/2,Tt.CLOCKWISE,this._distance),this._segList.addPt(p.p1);break;case G.CAP_FLAT:this._segList.addPt(c.p1),this._segList.addPt(p.p1);break;case G.CAP_SQUARE:var D=new Q;D.x=Math.abs(this._distance)*Math.cos(C),D.y=Math.abs(this._distance)*Math.sin(C);var $=new Q(c.p1.x+D.x,c.p1.y+D.y),nt=new Q(p.p1.x+D.x,p.p1.y+D.y);this._segList.addPt($),this._segList.addPt(nt)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(t,e,r,c){var p=fr.intersection(e.p0,e.p1,r.p0,r.p1);if(p!==null&&(c<=0?1:p.distance(t)/Math.abs(c))<=this._bufParams.getMitreLimit())return this._segList.addPt(p),null;this.addLimitedMitreJoin(e,r,c,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*s.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===G.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===G.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(t){this._segList.addPt(new Q(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new Q(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new Q(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new Q(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(t,e){this._segList.addPts(t,e)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(t,e,r,c,p){var v=e.x-t.x,E=e.y-t.y,C=Math.atan2(E,v),D=r.x-t.x,$=r.y-t.y,nt=Math.atan2($,D);c===Tt.CLOCKWISE?C<=nt&&(C+=2*Math.PI):C>=nt&&(C-=2*Math.PI),this._segList.addPt(e),this.addDirectedFillet(t,C,nt,c,p),this._segList.addPt(r)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(t,e,r){this._s1=t,this._s2=e,this._side=r,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,r,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(t,e,r,c){var p=this._seg0.p1,v=ue.angle(p,this._seg0.p0),E=ue.angleBetweenOriented(this._seg0.p0,p,this._seg1.p1)/2,C=ue.normalize(v+E),D=ue.normalize(C+Math.PI),$=c*r,nt=r-$*Math.abs(Math.sin(E)),gt=p.x+$*Math.cos(D),xt=p.y+$*Math.sin(D),Et=new Q(gt,xt),It=new Oe(p,Et),Ut=It.pointAlongOffset(1,nt),zt=It.pointAlongOffset(1,-nt);this._side===pt.LEFT?(this._segList.addPt(Ut),this._segList.addPt(zt)):(this._segList.addPt(zt),this._segList.addPt(Ut))}},{key:"addDirectedFillet",value:function(t,e,r,c,p){var v=c===Tt.CLOCKWISE?-1:1,E=Math.abs(e-r),C=Math.trunc(E/this._filletAngleQuantum+.5);if(C<1)return null;for(var D=E/C,$=new Q,nt=0;nt<C;nt++){var gt=e+v*nt*D;$.x=t.x+p*Math.cos(gt),$.y=t.y+p*Math.sin(gt),this._segList.addPt($)}}},{key:"computeOffsetSegment",value:function(t,e,r,c){var p=e===pt.LEFT?1:-1,v=t.p1.x-t.p0.x,E=t.p1.y-t.p0.y,C=Math.sqrt(v*v+E*E),D=p*r*v/C,$=p*r*E/C;c.p0.x=t.p0.x-$,c.p0.y=t.p0.y+D,c.p1.x=t.p1.x-$,c.p1.y=t.p1.y+D}},{key:"addInsideTurn",value:function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*s.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var r=new Q((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r);var c=new Q((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(c)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(t){var e=new Q(t.x+this._distance,t.y);this._segList.addPt(e),this.addDirectedFillet(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)}},{key:"init",value:function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new vi,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*s.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===G.JOIN_BEVEL||this._bufParams.getJoinStyle()===G.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,Tt.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Oe,this._seg1=new Oe,this._offset0=new Oe,this._offset1=new Oe,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],r=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new cn,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===G.JOIN_ROUND&&(this._closingSegLengthFactor=s.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)}}])}();_i.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,_i.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,_i.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,_i.MAX_CLOSING_SEG_LEN_FACTOR=80;var xi=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"getOffsetCurve",value:function(t,e){if(this._distance=e,e===0)return null;var r=e<0,c=Math.abs(e),p=this.getSegGen(c);t.length<=1?this.computePointCurve(t[0],p):this.computeOffsetCurve(t,r,p);var v=p.getCoordinates();return r&&se.reverse(v),v}},{key:"computeSingleSidedBufferCurve",value:function(t,e,r){var c=this.simplifyTolerance(this._distance);if(e){r.addSegments(t,!0);var p=Be.simplify(t,-c),v=p.length-1;r.initSideSegments(p[v],p[v-1],pt.LEFT),r.addFirstSegment();for(var E=v-2;E>=0;E--)r.addNextSegment(p[E],!0)}else{r.addSegments(t,!1);var C=Be.simplify(t,c),D=C.length-1;r.initSideSegments(C[0],C[1],pt.LEFT),r.addFirstSegment();for(var $=2;$<=D;$++)r.addNextSegment(C[$],!0)}r.addLastSegment(),r.closeRing()}},{key:"computeRingBufferCurve",value:function(t,e,r){var c=this.simplifyTolerance(this._distance);e===pt.RIGHT&&(c=-c);var p=Be.simplify(t,c),v=p.length-1;r.initSideSegments(p[v-1],p[0],e);for(var E=1;E<=v;E++){var C=E!==1;r.addNextSegment(p[E],C)}r.closeRing()}},{key:"computeLineBufferCurve",value:function(t,e){var r=this.simplifyTolerance(this._distance),c=Be.simplify(t,r),p=c.length-1;e.initSideSegments(c[0],c[1],pt.LEFT);for(var v=2;v<=p;v++)e.addNextSegment(c[v],!0);e.addLastSegment(),e.addLineEndCap(c[p-1],c[p]);var E=Be.simplify(t,-r),C=E.length-1;e.initSideSegments(E[C],E[C-1],pt.LEFT);for(var D=C-2;D>=0;D--)e.addNextSegment(E[D],!0);e.addLastSegment(),e.addLineEndCap(E[1],E[0]),e.closeRing()}},{key:"computePointCurve",value:function(t,e){switch(this._bufParams.getEndCapStyle()){case G.CAP_ROUND:e.createCircle(t);break;case G.CAP_SQUARE:e.createSquare(t)}}},{key:"getLineCurve",value:function(t,e){if(this._distance=e,this.isLineOffsetEmpty(e))return null;var r=Math.abs(e),c=this.getSegGen(r);if(t.length<=1)this.computePointCurve(t[0],c);else if(this._bufParams.isSingleSided()){var p=e<0;this.computeSingleSidedBufferCurve(t,p,c)}else this.computeLineBufferCurve(t,c);return c.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(t){return t*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(t,e,r){if(this._distance=r,t.length<=2)return this.getLineCurve(t,r);if(r===0)return s.copyCoordinates(t);var c=this.getSegGen(r);return this.computeRingBufferCurve(t,e,c),c.getCoordinates()}},{key:"computeOffsetCurve",value:function(t,e,r){var c=this.simplifyTolerance(this._distance);if(e){var p=Be.simplify(t,-c),v=p.length-1;r.initSideSegments(p[v],p[v-1],pt.LEFT),r.addFirstSegment();for(var E=v-2;E>=0;E--)r.addNextSegment(p[E],!0)}else{var C=Be.simplify(t,c),D=C.length-1;r.initSideSegments(C[0],C[1],pt.LEFT),r.addFirstSegment();for(var $=2;$<=D;$++)r.addNextSegment(C[$],!0)}r.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(t){return t===0||t<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(t){return new _i(this._precisionModel,this._bufParams,t)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e}},{key:"copyCoordinates",value:function(t){for(var e=new Array(t.length).fill(null),r=0;r<e.length;r++)e[r]=new Q(t[r]);return e}}])}(),Ae=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var s=arguments[0],t=new Lt,e=this._subgraphs.iterator();e.hasNext();){var r=e.next(),c=r.getEnvelope();s.y<c.getMinY()||s.y>c.getMaxY()||this.findStabbedSegments(s,r.getDirectedEdges(),t)}return t}if(arguments.length===3){if(bt(arguments[2],Ye)&&arguments[0]instanceof Q&&arguments[1]instanceof Ir){for(var p=arguments[0],v=arguments[1],E=arguments[2],C=v.getEdge().getCoordinates(),D=0;D<C.length-1;D++)if(this._seg.p0=C[D],this._seg.p1=C[D+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<p.x||this._seg.isHorizontal()||p.y<this._seg.p0.y||p.y>this._seg.p1.y||Tt.index(this._seg.p0,this._seg.p1,p)===Tt.RIGHT)){var $=v.getDepth(pt.LEFT);this._seg.p0.equals(C[D])||($=v.getDepth(pt.RIGHT));var nt=new br(this._seg,$);E.add(nt)}}else if(bt(arguments[2],Ye)&&arguments[0]instanceof Q&&bt(arguments[1],Ye))for(var gt=arguments[0],xt=arguments[2],Et=arguments[1].iterator();Et.hasNext();){var It=Et.next();It.isForward()&&this.findStabbedSegments(gt,It,xt)}}}},{key:"getDepth",value:function(s){var t=this.findStabbedSegments(s);return t.size()===0?0:Dn.min(t)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new Oe;var s=arguments[0];this._subgraphs=s}}])}(),br=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"compareTo",value:function(s){var t=s;if(this._upwardSeg.minX()>=t._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=t._upwardSeg.minX())return-1;var e=this._upwardSeg.orientationIndex(t._upwardSeg);return e!==0||(e=-1*t._upwardSeg.orientationIndex(this._upwardSeg))!==0?e:this._upwardSeg.compareTo(t._upwardSeg)}},{key:"compareX",value:function(s,t){var e=s.p0.compareTo(t.p0);return e!==0?e:s.p1.compareTo(t.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[J]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var s=arguments[0],t=arguments[1];this._upwardSeg=new Oe(s),this._leftDepth=t}}])}();Ae.DepthSegment=br;var Or=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,null,[{key:"constructor_",value:function(){R.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}])}(R),Ar=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"getY",value:function(){var t=this.y/this.w;if(W.isNaN(t)||W.isInfinite(t))throw new Or;return t}},{key:"getX",value:function(){var t=this.x/this.w;if(W.isNaN(t)||W.isInfinite(t))throw new Or;return t}},{key:"getCoordinate",value:function(){var t=new Q;return t.x=this.getX(),t.y=this.getY(),t}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],r=arguments[1];this.x=e,this.y=r,this.w=1}else if(arguments[0]instanceof s&&arguments[1]instanceof s){var c=arguments[0],p=arguments[1];this.x=c.y*p.w-p.y*c.w,this.y=p.x*c.w-c.x*p.w,this.w=c.x*p.y-p.x*c.y}else if(arguments[0]instanceof Q&&arguments[1]instanceof Q){var v=arguments[0],E=arguments[1];this.x=v.y-E.y,this.y=E.x-v.x,this.w=v.x*E.y-E.x*v.y}}else if(arguments.length===3){var C=arguments[0],D=arguments[1],$=arguments[2];this.x=C,this.y=D,this.w=$}else if(arguments.length===4){var nt=arguments[0],gt=arguments[1],xt=arguments[2],Et=arguments[3],It=nt.y-gt.y,Ut=gt.x-nt.x,zt=nt.x*gt.y-gt.x*nt.y,jt=xt.y-Et.y,te=Et.x-xt.x,ge=xt.x*Et.y-Et.x*xt.y;this.x=Ut*ge-te*zt,this.y=jt*zt-It*ge,this.w=It*te-jt*Ut}}}])}(),Rr=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"area",value:function(){return s.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return s.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(t){if(t===null)throw new H("Supplied point is null.");return s.interpolateZ(t,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return s.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return s.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return s.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return s.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return s.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return s.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var t=arguments[0],e=arguments[1],r=arguments[2];this.p0=t,this.p1=e,this.p2=r}},{key:"area",value:function(t,e,r){return Math.abs(((r.x-t.x)*(e.y-t.y)-(e.x-t.x)*(r.y-t.y))/2)}},{key:"signedArea",value:function(t,e,r){return((r.x-t.x)*(e.y-t.y)-(e.x-t.x)*(r.y-t.y))/2}},{key:"det",value:function(t,e,r,c){return t*c-e*r}},{key:"interpolateZ",value:function(t,e,r,c){var p=e.x,v=e.y,E=r.x-p,C=c.x-p,D=r.y-v,$=c.y-v,nt=E*$-C*D,gt=t.x-p,xt=t.y-v,Et=($*gt-C*xt)/nt,It=(-D*gt+E*xt)/nt;return e.getZ()+Et*(r.getZ()-e.getZ())+It*(c.getZ()-e.getZ())}},{key:"longestSideLength",value:function(t,e,r){var c=t.distance(e),p=e.distance(r),v=r.distance(t),E=c;return p>E&&(E=p),v>E&&(E=v),E}},{key:"circumcentreDD",value:function(t,e,r){var c=St.valueOf(t.x).subtract(r.x),p=St.valueOf(t.y).subtract(r.y),v=St.valueOf(e.x).subtract(r.x),E=St.valueOf(e.y).subtract(r.y),C=St.determinant(c,p,v,E).multiply(2),D=c.sqr().add(p.sqr()),$=v.sqr().add(E.sqr()),nt=St.determinant(p,D,E,$),gt=St.determinant(c,D,v,$),xt=St.valueOf(r.x).subtract(nt.divide(C)).doubleValue(),Et=St.valueOf(r.y).add(gt.divide(C)).doubleValue();return new Q(xt,Et)}},{key:"isAcute",value:function(t,e,r){return!!ue.isAcute(t,e,r)&&!!ue.isAcute(e,r,t)&&!!ue.isAcute(r,t,e)}},{key:"circumcentre",value:function(t,e,r){var c=r.x,p=r.y,v=t.x-c,E=t.y-p,C=e.x-c,D=e.y-p,$=2*s.det(v,E,C,D),nt=s.det(E,v*v+E*E,D,C*C+D*D),gt=s.det(v,v*v+E*E,C,C*C+D*D);return new Q(c-nt/$,p+gt/$)}},{key:"perpendicularBisector",value:function(t,e){var r=e.x-t.x,c=e.y-t.y,p=new Ar(t.x+r/2,t.y+c/2,1),v=new Ar(t.x-c+r/2,t.y+r+c/2,1);return new Ar(p,v)}},{key:"angleBisector",value:function(t,e,r){var c=e.distance(t),p=c/(c+e.distance(r)),v=r.x-t.x,E=r.y-t.y;return new Q(t.x+p*v,t.y+p*E)}},{key:"area3D",value:function(t,e,r){var c=e.x-t.x,p=e.y-t.y,v=e.getZ()-t.getZ(),E=r.x-t.x,C=r.y-t.y,D=r.getZ()-t.getZ(),$=p*D-v*C,nt=v*E-c*D,gt=c*C-p*E,xt=$*$+nt*nt+gt*gt,Et=Math.sqrt(xt)/2;return Et}},{key:"centroid",value:function(t,e,r){var c=(t.x+e.x+r.x)/3,p=(t.y+e.y+r.y)/3;return new Q(c,p)}},{key:"inCentre",value:function(t,e,r){var c=e.distance(r),p=t.distance(r),v=t.distance(e),E=c+p+v,C=(c*t.x+p*e.x+v*r.x)/E,D=(c*t.y+p*e.y+v*r.y)/E;return new Q(C,D)}}])}(),Dr=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"addRingSide",value:function(s,t,e,r,c){if(t===0&&s.length<We.MINIMUM_VALID_SIZE)return null;var p=r,v=c;s.length>=We.MINIMUM_VALID_SIZE&&Tt.isCCW(s)&&(p=c,v=r,e=pt.opposite(e));var E=this._curveBuilder.getRingCurve(s,e,t);this.addCurve(E,p,v)}},{key:"addRingBothSides",value:function(s,t){this.addRingSide(s,t,pt.LEFT,Z.EXTERIOR,Z.INTERIOR),this.addRingSide(s,t,pt.RIGHT,Z.INTERIOR,Z.EXTERIOR)}},{key:"addPoint",value:function(s){if(this._distance<=0)return null;var t=s.getCoordinates(),e=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(e,Z.EXTERIOR,Z.INTERIOR)}},{key:"addPolygon",value:function(s){var t=this._distance,e=pt.LEFT;this._distance<0&&(t=-this._distance,e=pt.RIGHT);var r=s.getExteriorRing(),c=se.removeRepeatedPoints(r.getCoordinates());if(this._distance<0&&this.isErodedCompletely(r,this._distance)||this._distance<=0&&c.length<3)return null;this.addRingSide(c,t,e,Z.EXTERIOR,Z.INTERIOR);for(var p=0;p<s.getNumInteriorRing();p++){var v=s.getInteriorRingN(p),E=se.removeRepeatedPoints(v.getCoordinates());this._distance>0&&this.isErodedCompletely(v,-this._distance)||this.addRingSide(E,t,pt.opposite(e),Z.INTERIOR,Z.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(s,t){var e=new Rr(s[0],s[1],s[2]),r=e.inCentre();return qe.pointToSegment(r,e.p0,e.p1)<Math.abs(t)}},{key:"addLineString",value:function(s){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var t=se.removeRepeatedPoints(s.getCoordinates());if(se.isRing(t)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(t,this._distance);else{var e=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(e,Z.EXTERIOR,Z.INTERIOR)}}},{key:"addCurve",value:function(s,t,e){if(s===null||s.length<2)return null;var r=new fn(s,new Le(0,Z.BOUNDARY,t,e));this._curveList.add(r)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(s){if(s.isEmpty())return null;if(s instanceof ci)this.addPolygon(s);else if(s instanceof hi)this.addLineString(s);else if(s instanceof dr)this.addPoint(s);else if(s instanceof Ai)this.addCollection(s);else if(s instanceof Bi)this.addCollection(s);else if(s instanceof vr)this.addCollection(s);else{if(!(s instanceof we))throw new Mt(s.getGeometryType());this.addCollection(s)}}},{key:"isErodedCompletely",value:function(s,t){var e=s.getCoordinates();if(e.length<4)return t<0;if(e.length===4)return this.isTriangleErodedCompletely(e,t);var r=s.getEnvelopeInternal(),c=Math.min(r.getHeight(),r.getWidth());return t<0&&2*Math.abs(t)>c}},{key:"addCollection",value:function(s){for(var t=0;t<s.getNumGeometries();t++){var e=s.getGeometryN(t);this.add(e)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Lt;var s=arguments[0],t=arguments[1],e=arguments[2];this._inputGeom=s,this._distance=t,this._curveBuilder=e}}])}(),mo=function(){return m(function s(){l(this,s)},[{key:"locate",value:function(s){}}])}(),po=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,s.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Gt;var t=this._parent.getGeometryN(this._index++);return t instanceof we?(this._subcollectionIterator=new s(t),this._subcollectionIterator.next()):t}},{key:"remove",value:function(){throw new Mt(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[fo]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()}},{key:"isAtomic",value:function(t){return!(t instanceof we)}}])}(),ps=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"locate",value:function(t){return s.locate(t,this._geom)}},{key:"interfaces_",get:function(){return[mo]}}],[{key:"constructor_",value:function(){this._geom=null;var t=arguments[0];this._geom=t}},{key:"locatePointInPolygon",value:function(t,e){if(e.isEmpty())return Z.EXTERIOR;var r=e.getExteriorRing(),c=s.locatePointInRing(t,r);if(c!==Z.INTERIOR)return c;for(var p=0;p<e.getNumInteriorRing();p++){var v=e.getInteriorRingN(p),E=s.locatePointInRing(t,v);if(E===Z.BOUNDARY)return Z.BOUNDARY;if(E===Z.INTERIOR)return Z.EXTERIOR}return Z.INTERIOR}},{key:"locatePointInRing",value:function(t,e){return e.getEnvelopeInternal().intersects(t)?Kn.locateInRing(t,e.getCoordinates()):Z.EXTERIOR}},{key:"containsPointInPolygon",value:function(t,e){return Z.EXTERIOR!==s.locatePointInPolygon(t,e)}},{key:"locateInGeometry",value:function(t,e){if(e instanceof ci)return s.locatePointInPolygon(t,e);if(e instanceof we)for(var r=new po(e);r.hasNext();){var c=r.next();if(c!==e){var p=s.locateInGeometry(t,c);if(p!==Z.EXTERIOR)return p}}return Z.EXTERIOR}},{key:"isContained",value:function(t,e){return Z.EXTERIOR!==s.locate(t,e)}},{key:"locate",value:function(t,e){return e.isEmpty()?Z.EXTERIOR:e.getEnvelopeInternal().intersects(t)?s.locateInGeometry(t,e):Z.EXTERIOR}}])}(),yo=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"getNextCW",value:function(s){this.getEdges();var t=this._edgeList.indexOf(s),e=t-1;return t===0&&(e=this._edgeList.size()-1),this._edgeList.get(e)}},{key:"propagateSideLabels",value:function(s){for(var t=Z.NONE,e=this.iterator();e.hasNext();){var r=e.next().getLabel();r.isArea(s)&&r.getLocation(s,pt.LEFT)!==Z.NONE&&(t=r.getLocation(s,pt.LEFT))}if(t===Z.NONE)return null;for(var c=t,p=this.iterator();p.hasNext();){var v=p.next(),E=v.getLabel();if(E.getLocation(s,pt.ON)===Z.NONE&&E.setLocation(s,pt.ON,c),E.isArea(s)){var C=E.getLocation(s,pt.LEFT),D=E.getLocation(s,pt.RIGHT);if(D!==Z.NONE){if(D!==c)throw new Ve("side location conflict",v.getCoordinate());C===Z.NONE&&at.shouldNeverReachHere("found single null side (at "+v.getCoordinate()+")"),c=C}else at.isTrue(E.getLocation(s,pt.LEFT)===Z.NONE,"found single null side"),E.setLocation(s,pt.RIGHT,c),E.setLocation(s,pt.LEFT,c)}}}},{key:"getCoordinate",value:function(){var s=this.iterator();return s.hasNext()?s.next().getCoordinate():null}},{key:"print",value:function(s){Fe.out.println("EdgeEndStar:   "+this.getCoordinate());for(var t=this.iterator();t.hasNext();)t.next().print(s)}},{key:"isAreaLabelsConsistent",value:function(s){return this.computeEdgeEndLabels(s.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(s){var t=this.getEdges();if(t.size()<=0)return!0;var e=t.size()-1,r=t.get(e).getLabel().getLocation(s,pt.LEFT);at.isTrue(r!==Z.NONE,"Found unlabelled area edge");for(var c=r,p=this.iterator();p.hasNext();){var v=p.next().getLabel();at.isTrue(v.isArea(s),"Found non-area edge");var E=v.getLocation(s,pt.LEFT),C=v.getLocation(s,pt.RIGHT);if(E===C||C!==c)return!1;c=E}return!0}},{key:"findIndex",value:function(s){this.iterator();for(var t=0;t<this._edgeList.size();t++)if(this._edgeList.get(t)===s)return t;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new Lt(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(s,t,e){return this._ptInAreaLocation[s]===Z.NONE&&(this._ptInAreaLocation[s]=ps.locate(t,e[s].getGeometry())),this._ptInAreaLocation[s]}},{key:"toString",value:function(){var s=new yn;s.append("EdgeEndStar:   "+this.getCoordinate()),s.append(`
`);for(var t=this.iterator();t.hasNext();){var e=t.next();s.append(e),s.append(`
`)}return s.toString()}},{key:"computeEdgeEndLabels",value:function(s){for(var t=this.iterator();t.hasNext();)t.next().computeLabel(s)}},{key:"computeLabelling",value:function(s){this.computeEdgeEndLabels(s[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var t=[!1,!1],e=this.iterator();e.hasNext();)for(var r=e.next().getLabel(),c=0;c<2;c++)r.isLine(c)&&r.getLocation(c)===Z.BOUNDARY&&(t[c]=!0);for(var p=this.iterator();p.hasNext();)for(var v=p.next(),E=v.getLabel(),C=0;C<2;C++)if(E.isAnyNull(C)){var D=Z.NONE;if(t[C])D=Z.EXTERIOR;else{var $=v.getCoordinate();D=this.getLocation(C,$,s)}E.setAllLocationsIfNull(C,D)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(s,t){this._edgeMap.put(s,t),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new ee,this._edgeList=null,this._ptInAreaLocation=[Z.NONE,Z.NONE]}}])}(),Ze=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var e=null,r=null,c=this._SCANNING_FOR_INCOMING,p=0;p<this._resultAreaEdgeList.size();p++){var v=this._resultAreaEdgeList.get(p),E=v.getSym();if(v.getLabel().isArea())switch(e===null&&v.isInResult()&&(e=v),c){case this._SCANNING_FOR_INCOMING:if(!E.isInResult())continue;r=E,c=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!v.isInResult())continue;r.setNext(v),c=this._SCANNING_FOR_INCOMING}}if(c===this._LINKING_TO_OUTGOING){if(e===null)throw new Ve("no outgoing dirEdge found",this.getCoordinate());at.isTrue(e.isInResult(),"unable to link last incoming dirEdge"),r.setNext(e)}}},{key:"insert",value:function(e){var r=e;this.insertEdgeEnd(r,r)}},{key:"getRightmostEdge",value:function(){var e=this.getEdges(),r=e.size();if(r<1)return null;var c=e.get(0);if(r===1)return c;var p=e.get(r-1),v=c.getQuadrant(),E=p.getQuadrant();return pe.isNorthern(v)&&pe.isNorthern(E)?c:pe.isNorthern(v)||pe.isNorthern(E)?c.getDy()!==0?c:p.getDy()!==0?p:(at.shouldNeverReachHere("found two horizontal edges incident on node"),null):p}},{key:"print",value:function(e){Fe.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var r=this.iterator();r.hasNext();){var c=r.next();e.print("out "),c.print(e),e.println(),e.print("in "),c.getSym().print(e),e.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Lt;for(var e=this.iterator();e.hasNext();){var r=e.next();(r.isInResult()||r.getSym().isInResult())&&this._resultAreaEdgeList.add(r)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(e){for(var r=this.iterator();r.hasNext();){var c=r.next().getLabel();c.setAllLocationsIfNull(0,e.getLocation(0)),c.setAllLocationsIfNull(1,e.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var e=null,r=null,c=this._edgeList.size()-1;c>=0;c--){var p=this._edgeList.get(c),v=p.getSym();r===null&&(r=v),e!==null&&v.setNext(e),e=p}r.setNext(e)}},{key:"computeDepths",value:function(){if(arguments.length===1){var e=arguments[0],r=this.findIndex(e),c=e.getDepth(pt.LEFT),p=e.getDepth(pt.RIGHT),v=this.computeDepths(r+1,this._edgeList.size(),c);if(this.computeDepths(0,r,v)!==p)throw new Ve("depth mismatch at "+e.getCoordinate())}else if(arguments.length===3){for(var E=arguments[1],C=arguments[2],D=arguments[0];D<E;D++){var $=this._edgeList.get(D);$.setEdgeDepths(pt.RIGHT,C),C=$.getDepth(pt.LEFT)}return C}}},{key:"mergeSymLabels",value:function(){for(var e=this.iterator();e.hasNext();){var r=e.next();r.getLabel().merge(r.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(e){for(var r=null,c=null,p=this._SCANNING_FOR_INCOMING,v=this._resultAreaEdgeList.size()-1;v>=0;v--){var E=this._resultAreaEdgeList.get(v),C=E.getSym();switch(r===null&&E.getEdgeRing()===e&&(r=E),p){case this._SCANNING_FOR_INCOMING:if(C.getEdgeRing()!==e)continue;c=C,p=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(E.getEdgeRing()!==e)continue;c.setNextMin(E),p=this._SCANNING_FOR_INCOMING}}p===this._LINKING_TO_OUTGOING&&(at.isTrue(r!==null,"found null for first outgoing dirEdge"),at.isTrue(r.getEdgeRing()===e,"unable to link last incoming dirEdge"),c.setNextMin(r))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var e=0,r=this.iterator();r.hasNext();)r.next().isInResult()&&e++;return e}if(arguments.length===1){for(var c=arguments[0],p=0,v=this.iterator();v.hasNext();)v.next().getEdgeRing()===c&&p++;return p}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var e=Z.NONE,r=this.iterator();r.hasNext();){var c=r.next(),p=c.getSym();if(!c.isLineEdge()){if(c.isInResult()){e=Z.INTERIOR;break}if(p.isInResult()){e=Z.EXTERIOR;break}}}if(e===Z.NONE)return null;for(var v=e,E=this.iterator();E.hasNext();){var C=E.next(),D=C.getSym();C.isLineEdge()?C.getEdge().setCovered(v===Z.INTERIOR):(C.isInResult()&&(v=Z.EXTERIOR),D.isInResult()&&(v=Z.INTERIOR))}}},{key:"computeLabelling",value:function(e){z(t,"computeLabelling",this,1).call(this,e),this._label=new Le(Z.NONE);for(var r=this.iterator();r.hasNext();)for(var c=r.next().getEdge().getLabel(),p=0;p<2;p++){var v=c.getLocation(p);v!==Z.INTERIOR&&v!==Z.BOUNDARY||this._label.setLocation(p,Z.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}])}(yo),jn=function(s){function t(){return l(this,t),a(this,t)}return I(t,s),m(t,[{key:"createNode",value:function(e){return new pi(e,new Ze)}}])}(Lr),ys=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"compareTo",value:function(t){var e=t;return s.compareOriented(this._pts,this._orientation,e._pts,e._orientation)}},{key:"interfaces_",get:function(){return[J]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=s.orientation(t)}},{key:"orientation",value:function(t){return se.increasingDirection(t)===1}},{key:"compareOriented",value:function(t,e,r,c){for(var p=e?1:-1,v=c?1:-1,E=e?t.length:-1,C=c?r.length:-1,D=e?0:t.length-1,$=c?0:r.length-1;;){var nt=t[D].compareTo(r[$]);if(nt!==0)return nt;var gt=(D+=p)===E,xt=($+=v)===C;if(gt&&!xt)return-1;if(!gt&&xt)return 1;if(gt&&xt)return 0}}}])}(),gn=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"print",value:function(s){s.print("MULTILINESTRING ( ");for(var t=0;t<this._edges.size();t++){var e=this._edges.get(t);t>0&&s.print(","),s.print("(");for(var r=e.getCoordinates(),c=0;c<r.length;c++)c>0&&s.print(","),s.print(r[c].x+" "+r[c].y);s.println(")")}s.print(")  ")}},{key:"addAll",value:function(s){for(var t=s.iterator();t.hasNext();)this.add(t.next())}},{key:"findEdgeIndex",value:function(s){for(var t=0;t<this._edges.size();t++)if(this._edges.get(t).equals(s))return t;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(s){return this._edges.get(s)}},{key:"findEqualEdge",value:function(s){var t=new ys(s.getCoordinates());return this._ocaMap.get(t)}},{key:"add",value:function(s){this._edges.add(s);var t=new ys(s.getCoordinates());this._ocaMap.put(t,s)}}],[{key:"constructor_",value:function(){this._edges=new Lt,this._ocaMap=new ee}}])}(),vs=function(){return m(function s(){l(this,s)},[{key:"processIntersections",value:function(s,t,e,r){}},{key:"isDone",value:function(){}}])}(),$n=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"isTrivialIntersection",value:function(t,e,r,c){if(t===r&&this._li.getIntersectionNum()===1){if(s.isAdjacentSegments(e,c))return!0;if(t.isClosed()){var p=t.size()-1;if(e===0&&c===p||c===0&&e===p)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(t,e,r,c){if(t===r&&e===c)return null;this.numTests++;var p=t.getCoordinates()[e],v=t.getCoordinates()[e+1],E=r.getCoordinates()[c],C=r.getCoordinates()[c+1];this._li.computeIntersection(p,v,E,C),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,r,c)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),r.addIntersections(this._li,c,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[vs]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t}},{key:"isAdjacentSegments",value:function(t,e){return Math.abs(t-e)===1}}])}(),vo=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(s){s.print(this.coord),s.print(" seg # = "+this.segmentIndex),s.println(" dist = "+this.dist)}},{key:"compareTo",value:function(s){var t=s;return this.compare(t.segmentIndex,t.dist)}},{key:"isEndPoint",value:function(s){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===s}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(s,t){return this.segmentIndex<s?-1:this.segmentIndex>s?1:this.dist<t?-1:this.dist>t?1:0}},{key:"interfaces_",get:function(){return[J]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var s=arguments[0],t=arguments[1],e=arguments[2];this.coord=new Q(s),this.segmentIndex=t,this.dist=e}}])}(),ki=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"print",value:function(s){s.println("Intersections:");for(var t=this.iterator();t.hasNext();)t.next().print(s)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(s){this.addEndpoints();for(var t=this.iterator(),e=t.next();t.hasNext();){var r=t.next(),c=this.createSplitEdge(e,r);s.add(c),e=r}}},{key:"addEndpoints",value:function(){var s=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[s],s,0)}},{key:"createSplitEdge",value:function(s,t){var e=t.segmentIndex-s.segmentIndex+2,r=this.edge.pts[t.segmentIndex],c=t.dist>0||!t.coord.equals2D(r);c||e--;var p=new Array(e).fill(null),v=0;p[v++]=new Q(s.coord);for(var E=s.segmentIndex+1;E<=t.segmentIndex;E++)p[v++]=this.edge.pts[E];return c&&(p[v]=t.coord),new xs(p,new Le(this.edge._label))}},{key:"add",value:function(s,t,e){var r=new vo(s,t,e),c=this._nodeMap.get(r);return c!==null?c:(this._nodeMap.put(r,r),r)}},{key:"isIntersection",value:function(s){for(var t=this.iterator();t.hasNext();)if(t.next().coord.equals(s))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new ee,this.edge=null;var s=arguments[0];this.edge=s}}])}(),_s=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(s.isTrue(this._matrix[Z.INTERIOR][Z.INTERIOR])||s.isTrue(this._matrix[Z.INTERIOR][Z.BOUNDARY])||s.isTrue(this._matrix[Z.BOUNDARY][Z.INTERIOR])||s.isTrue(this._matrix[Z.BOUNDARY][Z.BOUNDARY]))&&this._matrix[Z.EXTERIOR][Z.INTERIOR]===_t.FALSE&&this._matrix[Z.EXTERIOR][Z.BOUNDARY]===_t.FALSE}},{key:"isCoveredBy",value:function(){return(s.isTrue(this._matrix[Z.INTERIOR][Z.INTERIOR])||s.isTrue(this._matrix[Z.INTERIOR][Z.BOUNDARY])||s.isTrue(this._matrix[Z.BOUNDARY][Z.INTERIOR])||s.isTrue(this._matrix[Z.BOUNDARY][Z.BOUNDARY]))&&this._matrix[Z.INTERIOR][Z.EXTERIOR]===_t.FALSE&&this._matrix[Z.BOUNDARY][Z.EXTERIOR]===_t.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var t=arguments[0],e=0;e<t.length;e++){var r=Math.trunc(e/3),c=e%3;this._matrix[r][c]=_t.toDimensionValue(t.charAt(e))}else if(arguments.length===3){var p=arguments[0],v=arguments[1],E=arguments[2];this._matrix[p][v]=E}}},{key:"isContains",value:function(){return s.isTrue(this._matrix[Z.INTERIOR][Z.INTERIOR])&&this._matrix[Z.EXTERIOR][Z.INTERIOR]===_t.FALSE&&this._matrix[Z.EXTERIOR][Z.BOUNDARY]===_t.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var t=arguments[0],e=0;e<t.length;e++){var r=Math.trunc(e/3),c=e%3;this.setAtLeast(r,c,_t.toDimensionValue(t.charAt(e)))}else if(arguments.length===3){var p=arguments[0],v=arguments[1],E=arguments[2];this._matrix[p][v]<E&&(this._matrix[p][v]=E)}}},{key:"setAtLeastIfValid",value:function(t,e,r){t>=0&&e>=0&&this.setAtLeast(t,e,r)}},{key:"isWithin",value:function(){return s.isTrue(this._matrix[Z.INTERIOR][Z.INTERIOR])&&this._matrix[Z.INTERIOR][Z.EXTERIOR]===_t.FALSE&&this._matrix[Z.BOUNDARY][Z.EXTERIOR]===_t.FALSE}},{key:"isTouches",value:function(t,e){return t>e?this.isTouches(e,t):(t===_t.A&&e===_t.A||t===_t.L&&e===_t.L||t===_t.L&&e===_t.A||t===_t.P&&e===_t.A||t===_t.P&&e===_t.L)&&this._matrix[Z.INTERIOR][Z.INTERIOR]===_t.FALSE&&(s.isTrue(this._matrix[Z.INTERIOR][Z.BOUNDARY])||s.isTrue(this._matrix[Z.BOUNDARY][Z.INTERIOR])||s.isTrue(this._matrix[Z.BOUNDARY][Z.BOUNDARY]))}},{key:"isOverlaps",value:function(t,e){return t===_t.P&&e===_t.P||t===_t.A&&e===_t.A?s.isTrue(this._matrix[Z.INTERIOR][Z.INTERIOR])&&s.isTrue(this._matrix[Z.INTERIOR][Z.EXTERIOR])&&s.isTrue(this._matrix[Z.EXTERIOR][Z.INTERIOR]):t===_t.L&&e===_t.L&&this._matrix[Z.INTERIOR][Z.INTERIOR]===1&&s.isTrue(this._matrix[Z.INTERIOR][Z.EXTERIOR])&&s.isTrue(this._matrix[Z.EXTERIOR][Z.INTERIOR])}},{key:"isEquals",value:function(t,e){return t===e&&s.isTrue(this._matrix[Z.INTERIOR][Z.INTERIOR])&&this._matrix[Z.INTERIOR][Z.EXTERIOR]===_t.FALSE&&this._matrix[Z.BOUNDARY][Z.EXTERIOR]===_t.FALSE&&this._matrix[Z.EXTERIOR][Z.INTERIOR]===_t.FALSE&&this._matrix[Z.EXTERIOR][Z.BOUNDARY]===_t.FALSE}},{key:"toString",value:function(){for(var t=new Fi("123456789"),e=0;e<3;e++)for(var r=0;r<3;r++)t.setCharAt(3*e+r,_t.toDimensionSymbol(this._matrix[e][r]));return t.toString()}},{key:"setAll",value:function(t){for(var e=0;e<3;e++)for(var r=0;r<3;r++)this._matrix[e][r]=t}},{key:"get",value:function(t,e){return this._matrix[t][e]}},{key:"transpose",value:function(){var t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}},{key:"matches",value:function(t){if(t.length!==9)throw new H("Should be length 9: "+t);for(var e=0;e<3;e++)for(var r=0;r<3;r++)if(!s.matches(this._matrix[e][r],t.charAt(3*e+r)))return!1;return!0}},{key:"add",value:function(t){for(var e=0;e<3;e++)for(var r=0;r<3;r++)this.setAtLeast(e,r,t.get(e,r))}},{key:"isDisjoint",value:function(){return this._matrix[Z.INTERIOR][Z.INTERIOR]===_t.FALSE&&this._matrix[Z.INTERIOR][Z.BOUNDARY]===_t.FALSE&&this._matrix[Z.BOUNDARY][Z.INTERIOR]===_t.FALSE&&this._matrix[Z.BOUNDARY][Z.BOUNDARY]===_t.FALSE}},{key:"isCrosses",value:function(t,e){return t===_t.P&&e===_t.L||t===_t.P&&e===_t.A||t===_t.L&&e===_t.A?s.isTrue(this._matrix[Z.INTERIOR][Z.INTERIOR])&&s.isTrue(this._matrix[Z.INTERIOR][Z.EXTERIOR]):t===_t.L&&e===_t.P||t===_t.A&&e===_t.P||t===_t.A&&e===_t.L?s.isTrue(this._matrix[Z.INTERIOR][Z.INTERIOR])&&s.isTrue(this._matrix[Z.EXTERIOR][Z.INTERIOR]):t===_t.L&&e===_t.L&&this._matrix[Z.INTERIOR][Z.INTERIOR]===0}},{key:"interfaces_",get:function(){return[P]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(_t.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var t=arguments[0];s.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof s){var e=arguments[0];s.constructor_.call(this),this._matrix[Z.INTERIOR][Z.INTERIOR]=e._matrix[Z.INTERIOR][Z.INTERIOR],this._matrix[Z.INTERIOR][Z.BOUNDARY]=e._matrix[Z.INTERIOR][Z.BOUNDARY],this._matrix[Z.INTERIOR][Z.EXTERIOR]=e._matrix[Z.INTERIOR][Z.EXTERIOR],this._matrix[Z.BOUNDARY][Z.INTERIOR]=e._matrix[Z.BOUNDARY][Z.INTERIOR],this._matrix[Z.BOUNDARY][Z.BOUNDARY]=e._matrix[Z.BOUNDARY][Z.BOUNDARY],this._matrix[Z.BOUNDARY][Z.EXTERIOR]=e._matrix[Z.BOUNDARY][Z.EXTERIOR],this._matrix[Z.EXTERIOR][Z.INTERIOR]=e._matrix[Z.EXTERIOR][Z.INTERIOR],this._matrix[Z.EXTERIOR][Z.BOUNDARY]=e._matrix[Z.EXTERIOR][Z.BOUNDARY],this._matrix[Z.EXTERIOR][Z.EXTERIOR]=e._matrix[Z.EXTERIOR][Z.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var t=arguments[0],e=arguments[1];return e===_t.SYM_DONTCARE||e===_t.SYM_TRUE&&(t>=0||t===_t.TRUE)||e===_t.SYM_FALSE&&t===_t.FALSE||e===_t.SYM_P&&t===_t.P||e===_t.SYM_L&&t===_t.L||e===_t.SYM_A&&t===_t.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var r=arguments[1];return new s(arguments[0]).matches(r)}}},{key:"isTrue",value:function(t){return t>=0||t===_t.TRUE}}])}(),Wi=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(t){return t===null||t.length===0?null:(this.ensureCapacity(this._size+t.length),Fe.arraycopy(t,0,this._data,this._size,t.length),void(this._size+=t.length))}},{key:"ensureCapacity",value:function(t){if(t<=this._data.length)return null;var e=Math.max(t,2*this._data.length);this._data=de.copyOf(this._data,e)}},{key:"toArray",value:function(){var t=new Array(this._size).fill(null);return Fe.arraycopy(this._data,0,t,0,this._size),t}},{key:"add",value:function(t){this.ensureCapacity(this._size+1),this._data[this._size]=t,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)s.constructor_.call(this,10);else if(arguments.length===1){var t=arguments[0];this._data=new Array(t).fill(null)}}}])}(),_o=function(){function s(){l(this,s)}return m(s,[{key:"getChainStartIndices",value:function(t){var e=0,r=new Wi(Math.trunc(t.length/2));r.add(e);do{var c=this.findChainEnd(t,e);r.add(c),e=c}while(e<t.length-1);return r.toArray()}},{key:"findChainEnd",value:function(t,e){for(var r=pe.quadrant(t[e],t[e+1]),c=e+1;c<t.length&&pe.quadrant(t[c-1],t[c])===r;)c++;return c-1}},{key:"OLDgetChainStartIndices",value:function(t){var e=0,r=new Lt;r.add(e);do{var c=this.findChainEnd(t,e);r.add(c),e=c}while(e<t.length-1);return s.toIntArray(r)}}],[{key:"toIntArray",value:function(t){for(var e=new Array(t.size()).fill(null),r=0;r<e.length;r++)e[r]=t.get(r).intValue();return e}}])}(),En=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(s){var t=this.pts[this.startIndex[s]].x,e=this.pts[this.startIndex[s+1]].x;return t>e?t:e}},{key:"getMinX",value:function(s){var t=this.pts[this.startIndex[s]].x,e=this.pts[this.startIndex[s+1]].x;return t<e?t:e}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var s=arguments[0],t=arguments[1],e=arguments[2],r=arguments[3];this.computeIntersectsForChain(this.startIndex[s],this.startIndex[s+1],t,t.startIndex[e],t.startIndex[e+1],r)}else if(arguments.length===6){var c=arguments[0],p=arguments[1],v=arguments[2],E=arguments[3],C=arguments[4],D=arguments[5];if(p-c==1&&C-E==1)return D.addIntersections(this.e,c,v.e,E),null;if(!this.overlaps(c,p,v,E,C))return null;var $=Math.trunc((c+p)/2),nt=Math.trunc((E+C)/2);c<$&&(E<nt&&this.computeIntersectsForChain(c,$,v,E,nt,D),nt<C&&this.computeIntersectsForChain(c,$,v,nt,C,D)),$<p&&(E<nt&&this.computeIntersectsForChain($,p,v,E,nt,D),nt<C&&this.computeIntersectsForChain($,p,v,nt,C,D))}}},{key:"overlaps",value:function(s,t,e,r,c){return Ct.intersects(this.pts[s],this.pts[t],e.pts[r],e.pts[c])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(s,t){for(var e=0;e<this.startIndex.length-1;e++)for(var r=0;r<s.startIndex.length-1;r++)this.computeIntersectsForChain(e,s,r,t)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var s=arguments[0];this.e=s,this.pts=s.getCoordinates();var t=new _o;this.startIndex=t.getChainStartIndices(this.pts)}}])}(),wi=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"getDepth",value:function(t,e){return this._depth[t][e]}},{key:"setDepth",value:function(t,e,r){this._depth[t][e]=r}},{key:"isNull",value:function(){if(arguments.length===0){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==s.NULL_VALUE)return!1;return!0}if(arguments.length===1){var r=arguments[0];return this._depth[r][1]===s.NULL_VALUE}if(arguments.length===2){var c=arguments[0],p=arguments[1];return this._depth[c][p]===s.NULL_VALUE}}},{key:"normalize",value:function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var r=1;r<3;r++){var c=0;this._depth[t][r]>e&&(c=1),this._depth[t][r]=c}}}},{key:"getDelta",value:function(t){return this._depth[t][pt.RIGHT]-this._depth[t][pt.LEFT]}},{key:"getLocation",value:function(t,e){return this._depth[t][e]<=0?Z.EXTERIOR:Z.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var t=arguments[0],e=0;e<2;e++)for(var r=1;r<3;r++){var c=t.getLocation(e,r);c!==Z.EXTERIOR&&c!==Z.INTERIOR||(this.isNull(e,r)?this._depth[e][r]=s.depthAtLocation(c):this._depth[e][r]+=s.depthAtLocation(c))}else if(arguments.length===3){var p=arguments[0],v=arguments[1];arguments[2]===Z.INTERIOR&&this._depth[p][v]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var e=0;e<3;e++)this._depth[t][e]=s.NULL_VALUE}},{key:"depthAtLocation",value:function(t){return t===Z.EXTERIOR?0:t===Z.INTERIOR?1:s.NULL_VALUE}}])}();wi.NULL_VALUE=-1;var xs=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var e=new Array(2).fill(null);return e[0]=this.pts[0],e[1]=this.pts[1],new t(e,Le.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(e){this._isIsolated=e}},{key:"setName",value:function(e){this._name=e}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var r=e;if(this.pts.length!==r.pts.length)return!1;for(var c=!0,p=!0,v=this.pts.length,E=0;E<this.pts.length;E++)if(this.pts[E].equals2D(r.pts[E])||(c=!1),this.pts[E].equals2D(r.pts[--v])||(p=!1),!c&&!p)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var e=arguments[0];return this.pts[e]}}},{key:"print",value:function(e){e.print("edge "+this._name+": "),e.print("LINESTRING (");for(var r=0;r<this.pts.length;r++)r>0&&e.print(","),e.print(this.pts[r].x+" "+this.pts[r].y);e.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(e){t.updateIM(this._label,e)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(e){e.print("edge "+this._name+": ");for(var r=this.pts.length-1;r>=0;r--)e.print(this.pts[r]+" ");e.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new En(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new Ct;for(var e=0;e<this.pts.length;e++)this._env.expandToInclude(this.pts[e])}return this._env}},{key:"addIntersection",value:function(e,r,c,p){var v=new Q(e.getIntersection(p)),E=r,C=e.getEdgeDistance(c,p),D=E+1;if(D<this.pts.length){var $=this.pts[D];v.equals2D($)&&(E=D,C=0)}this.eiList.add(v,E,C)}},{key:"toString",value:function(){var e=new Fi;e.append("edge "+this._name+": "),e.append("LINESTRING (");for(var r=0;r<this.pts.length;r++)r>0&&e.append(","),e.append(this.pts[r].x+" "+this.pts[r].y);return e.append(")  "+this._label+" "+this._depthDelta),e.toString()}},{key:"isPointwiseEqual",value:function(e){if(this.pts.length!==e.pts.length)return!1;for(var r=0;r<this.pts.length;r++)if(!this.pts[r].equals2D(e.pts[r]))return!1;return!0}},{key:"setDepthDelta",value:function(e){this._depthDelta=e}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(e,r,c){for(var p=0;p<e.getIntersectionNum();p++)this.addIntersection(e,r,c,p)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new ki(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new wi,this._depthDelta=0,arguments.length===1){var e=arguments[0];t.constructor_.call(this,e,null)}else if(arguments.length===2){var r=arguments[0],c=arguments[1];this.pts=r,this._label=c}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof _s&&arguments[0]instanceof Le))return z(t,"updateIM",this).apply(this,arguments);var e=arguments[0],r=arguments[1];r.setAtLeastIfValid(e.getLocation(0,pt.ON),e.getLocation(1,pt.ON),1),e.isArea()&&(r.setAtLeastIfValid(e.getLocation(0,pt.LEFT),e.getLocation(1,pt.LEFT),2),r.setAtLeastIfValid(e.getLocation(0,pt.RIGHT),e.getLocation(1,pt.RIGHT),2))}}])}(Jt),Ki=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"setWorkingPrecisionModel",value:function(t){this._workingPrecisionModel=t}},{key:"insertUniqueEdge",value:function(t){var e=this._edgeList.findEqualEdge(t);if(e!==null){var r=e.getLabel(),c=t.getLabel();e.isPointwiseEqual(t)||(c=new Le(t.getLabel())).flip(),r.merge(c);var p=s.depthDelta(c),v=e.getDepthDelta()+p;e.setDepthDelta(v)}else this._edgeList.add(t),t.setDepthDelta(s.depthDelta(t.getLabel()))}},{key:"buildSubgraphs",value:function(t,e){for(var r=new Lt,c=t.iterator();c.hasNext();){var p=c.next(),v=p.getRightmostCoordinate(),E=new Ae(r).getDepth(v);p.computeDepth(E),p.findResultEdges(),r.add(p),e.add(p.getDirectedEdges(),p.getNodes())}}},{key:"createSubgraphs",value:function(t){for(var e=new Lt,r=t.getNodes().iterator();r.hasNext();){var c=r.next();if(!c.isVisited()){var p=new li;p.create(c),e.add(p)}}return Dn.sort(e,Dn.reverseOrder()),e}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(t){if(this._workingNoder!==null)return this._workingNoder;var e=new Tr,r=new cn;return r.setPrecisionModel(t),e.setSegmentIntersector(new $n(r)),e}},{key:"buffer",value:function(t,e){var r=this._workingPrecisionModel;r===null&&(r=t.getPrecisionModel()),this._geomFact=t.getFactory();var c=new xi(r,this._bufParams),p=new Dr(t,e,c).getCurves();if(p.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(p,r),this._graph=new Ui(new jn),this._graph.addEdges(this._edgeList.getEdges());var v=this.createSubgraphs(this._graph),E=new uo(this._geomFact);this.buildSubgraphs(v,E);var C=E.getPolygons();return C.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(C)}},{key:"computeNodedEdges",value:function(t,e){var r=this.getNoder(e);r.computeNodes(t);for(var c=r.getNodedSubstrings().iterator();c.hasNext();){var p=c.next(),v=p.getCoordinates();if(v.length!==2||!v[0].equals2D(v[1])){var E=p.getData(),C=new xs(p.getCoordinates(),new Le(E));this.insertUniqueEdge(C)}}}},{key:"setNoder",value:function(t){this._workingNoder=t}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new gn;var t=arguments[0];this._bufParams=t}},{key:"depthDelta",value:function(t){var e=t.getLocation(0,pt.LEFT),r=t.getLocation(0,pt.RIGHT);return e===Z.INTERIOR&&r===Z.EXTERIOR?1:e===Z.EXTERIOR&&r===Z.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(t){for(var e=new Ke,r=new Lt;t.hasNext();){var c=t.next(),p=e.createLineString(c.getCoordinates());r.add(p)}return e.buildGeometry(r)}}])}(),xo=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"rescale",value:function(){if(bt(arguments[0],At))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var r=arguments[0],c=0;c<r.length;c++)r[c].x=r[c].x/this._scaleFactor+this._offsetX,r[c].y=r[c].y/this._scaleFactor+this._offsetY;r.length===2&&r[0].equals2D(r[1])&&Fe.out.println(r)}}},{key:"scale",value:function(){if(bt(arguments[0],At)){for(var t=arguments[0],e=new Lt(t.size()),r=t.iterator();r.hasNext();){var c=r.next();e.add(new fn(this.scale(c.getCoordinates()),c.getData()))}return e}if(arguments[0]instanceof Array){for(var p=arguments[0],v=new Array(p.length).fill(null),E=0;E<p.length;E++)v[E]=new Q(Math.round((p[E].x-this._offsetX)*this._scaleFactor),Math.round((p[E].y-this._offsetY)*this._scaleFactor),p[E].getZ());return se.removeRepeatedPoints(v)}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t}},{key:"computeNodes",value:function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)}},{key:"interfaces_",get:function(){return[Cr]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var t=arguments[0],e=arguments[1];s.constructor_.call(this,t,e,0,0)}else if(arguments.length===4){var r=arguments[0],c=arguments[1];this._noder=r,this._scaleFactor=c,this._isScaled=!this.isIntegerPrecision()}}}])}(),tn=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(arguments.length===2){for(var r=arguments[0],c=arguments[1].iterator();c.hasNext();)for(var p=c.next().getCoordinates(),v=1;v<p.length-1;v++)if(p[v].equals(r))throw new ht("found endpt/interior pt intersection at index "+v+" :pt "+r)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),r=this._segStrings.iterator();r.hasNext();){var c=r.next();this.checkInteriorIntersections(e,c)}else if(arguments.length===2)for(var p=arguments[0],v=arguments[1],E=p.getCoordinates(),C=v.getCoordinates(),D=0;D<E.length-1;D++)for(var $=0;$<C.length-1;$++)this.checkInteriorIntersections(p,D,v,$);else if(arguments.length===4){var nt=arguments[0],gt=arguments[1],xt=arguments[2],Et=arguments[3];if(nt===xt&&gt===Et)return null;var It=nt.getCoordinates()[gt],Ut=nt.getCoordinates()[gt+1],zt=xt.getCoordinates()[Et],jt=xt.getCoordinates()[Et+1];if(this._li.computeIntersection(It,Ut,zt,jt),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,It,Ut)||this.hasInteriorIntersection(this._li,zt,jt)))throw new ht("found non-noded intersection at "+It+"-"+Ut+" and "+zt+"-"+jt)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(arguments.length===1)for(var r=arguments[0].getCoordinates(),c=0;c<r.length-2;c++)this.checkCollapse(r[c],r[c+1],r[c+2])}},{key:"hasInteriorIntersection",value:function(t,e,r){for(var c=0;c<t.getIntersectionNum();c++){var p=t.getIntersection(c);if(!p.equals(e)&&!p.equals(r))return!0}return!1}},{key:"checkCollapse",value:function(t,e,r){if(t.equals(r))throw new ht("found non-noded collapse at "+s.fact.createLineString([t,e,r]))}}],[{key:"constructor_",value:function(){this._li=new cn,this._segStrings=null;var t=arguments[0];this._segStrings=t}}])}();tn.fact=new Ke;var Fr=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"intersectsScaled",value:function(t,e){var r=Math.min(t.x,e.x),c=Math.max(t.x,e.x),p=Math.min(t.y,e.y),v=Math.max(t.y,e.y),E=this._maxx<r||this._minx>c||this._maxy<p||this._miny>v;if(E)return!1;var C=this.intersectsToleranceSquare(t,e);return at.isTrue(!(E&&C),"Found bad envelope test"),C}},{key:"initCorners",value:function(t){var e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new Q(this._maxx,this._maxy),this._corner[1]=new Q(this._minx,this._maxy),this._corner[2]=new Q(this._minx,this._miny),this._corner[3]=new Q(this._maxx,this._miny)}},{key:"intersects",value:function(t,e){return this._scaleFactor===1?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(t){return Math.round(t*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var t=s.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ct(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(t,e){var r=!1,c=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(c=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!r||!c)||!!t.equals(this._pt)||!!e.equals(this._pt))))}},{key:"addSnappedNode",value:function(t,e){var r=t.getCoordinate(e),c=t.getCoordinate(e+1);return!!this.intersects(r,c)&&(t.addIntersection(this.getCoordinate(),e),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],r=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=r,e<=0)throw new H("Scale factor must be non-zero");e!==1&&(this._pt=new Q(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new Q,this._p1Scaled=new Q),this.initCorners(this._pt)}}])}();Fr.SAFE_ENV_EXPANSION_FACTOR=.75;var Qn=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var s=arguments[1];arguments[0].getLineSegment(s,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new Oe}}])}(),ks=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"snap",value:function(){if(arguments.length===1){var s=arguments[0];return this.snap(s,null,-1)}if(arguments.length===3){var t=arguments[0],e=arguments[1],r=arguments[2],c=t.getSafeEnvelope(),p=new en(t,e,r);return this._index.query(c,new(function(){return m(function v(){l(this,v)},[{key:"interfaces_",get:function(){return[cs]}},{key:"visitItem",value:function(v){v.select(c,p)}}])}())),p.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var s=arguments[0];this._index=s}}])}(),en=function(s){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,s),m(t,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof Sr))return z(t,"select",this,1).apply(this,arguments);var e=arguments[1],r=arguments[0].getContext();if(this._parentEdge===r&&(e===this._hotPixelVertexIndex||e+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(r,e)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],r=arguments[1],c=arguments[2];this._hotPixel=e,this._parentEdge=r,this._hotPixelVertexIndex=c}}])}(Qn);ks.HotPixelSnapAction=en;var Ji=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"processIntersections",value:function(s,t,e,r){if(s===e&&t===r)return null;var c=s.getCoordinates()[t],p=s.getCoordinates()[t+1],v=e.getCoordinates()[r],E=e.getCoordinates()[r+1];if(this._li.computeIntersection(c,p,v,E),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var C=0;C<this._li.getIntersectionNum();C++)this._interiorIntersections.add(this._li.getIntersection(C));s.addIntersections(this._li,t,0),e.addIntersections(this._li,r,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[vs]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var s=arguments[0];this._li=s,this._interiorIntersections=new Lt}}])}(),ws=function(){return m(function s(){l(this,s),s.constructor_.apply(this,arguments)},[{key:"checkCorrectness",value:function(s){var t=fn.getNodedSubstrings(s),e=new tn(t);try{e.checkValid()}catch(r){if(!(r instanceof R))throw r;r.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return fn.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(s,t){var e=this.findInteriorIntersections(s,t);this.computeIntersectionSnaps(e),this.computeVertexSnaps(s)}},{key:"findInteriorIntersections",value:function(s,t){var e=new Ji(t);return this._noder.setSegmentIntersector(e),this._noder.computeNodes(s),e.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(bt(arguments[0],At))for(var s=arguments[0].iterator();s.hasNext();){var t=s.next();this.computeVertexSnaps(t)}else if(arguments[0]instanceof fn)for(var e=arguments[0],r=e.getCoordinates(),c=0;c<r.length;c++){var p=new Fr(r[c],this._scaleFactor,this._li);this._pointSnapper.snap(p,e,c)&&e.addIntersection(r[c],c)}}},{key:"computeNodes",value:function(s){this._nodedSegStrings=s,this._noder=new Tr,this._pointSnapper=new ks(this._noder.getIndex()),this.snapRound(s,this._li)}},{key:"computeIntersectionSnaps",value:function(s){for(var t=s.iterator();t.hasNext();){var e=t.next(),r=new Fr(e,this._scaleFactor,this._li);this._pointSnapper.snap(r)}}},{key:"interfaces_",get:function(){return[Cr]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var s=arguments[0];this._pm=s,this._li=new cn,this._li.setPrecisionModel(s),this._scaleFactor=s.getScale()}}])}(),Pn=function(){function s(){l(this,s),s.constructor_.apply(this,arguments)}return m(s,[{key:"bufferFixedPrecision",value:function(t){var e=new xo(new ws(new Ee(1)),t.getScale()),r=new Ki(this._bufParams);r.setWorkingPrecisionModel(t),r.setNoder(e),this._resultGeometry=r.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var t=s.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(p){if(!(p instanceof Ve))throw p;this._saveException=p}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var e=arguments[0],r=s.precisionScaleFactor(this._argGeom,this._distance,e),c=new Ee(r);this.bufferFixedPrecision(c)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Ee.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(t){this._bufParams.setQuadrantSegments(t)}},{key:"bufferOriginalPrecision",value:function(){try{var t=new Ki(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(e){if(!(e instanceof ht))throw e;this._saveException=e}}},{key:"getResultGeometry",value:function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(t){this._bufParams.setEndCapStyle(t)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new G,this._resultGeometry=null,this._saveException=null,arguments.length===1){var t=arguments[0];this._argGeom=t}else if(arguments.length===2){var e=arguments[0],r=arguments[1];this._argGeom=e,this._bufParams=r}}},{key:"bufferOp",value:function(){if(arguments.length===2){var t=arguments[1];return new s(arguments[0]).getResultGeometry(t)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof vt&&typeof arguments[1]=="number"){var e=arguments[1],r=arguments[2],c=new s(arguments[0]);return c.setQuadrantSegments(r),c.getResultGeometry(e)}if(arguments[2]instanceof G&&arguments[0]instanceof vt&&typeof arguments[1]=="number"){var p=arguments[1];return new s(arguments[0],arguments[2]).getResultGeometry(p)}}else if(arguments.length===4){var v=arguments[1],E=arguments[2],C=arguments[3],D=new s(arguments[0]);return D.setQuadrantSegments(E),D.setEndCapStyle(C),D.getResultGeometry(v)}}},{key:"precisionScaleFactor",value:function(t,e,r){var c=t.getEnvelopeInternal(),p=Un.max(Math.abs(c.getMaxX()),Math.abs(c.getMaxY()),Math.abs(c.getMinX()),Math.abs(c.getMinY()))+2*(e>0?e:0),v=r-Math.trunc(Math.log(p)/Math.log(10)+1);return Math.pow(10,v)}}])}();Pn.CAP_ROUND=G.CAP_ROUND,Pn.CAP_BUTT=G.CAP_FLAT,Pn.CAP_FLAT=G.CAP_FLAT,Pn.CAP_SQUARE=G.CAP_SQUARE,Pn.MAX_PRECISION_DIGITS=12;var ji=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],$i=function(){return m(function s(t){l(this,s),this.geometryFactory=t||new Ke},[{key:"read",value:function(s){var t,e=(t=typeof s=="string"?JSON.parse(s):s).type;if(!Pe[e])throw new Error("Unknown GeoJSON type: "+t.type);return ji.indexOf(e)!==-1?Pe[e].call(this,t.coordinates):e==="GeometryCollection"?Pe[e].call(this,t.geometries):Pe[e].call(this,t)}},{key:"write",value:function(s){var t=s.getGeometryType();if(!Ie[t])throw new Error("Geometry is not supported");return Ie[t].call(this,s)}}])}(),Pe={Feature:function(s){var t={};for(var e in s)t[e]=s[e];if(s.geometry){var r=s.geometry.type;if(!Pe[r])throw new Error("Unknown GeoJSON type: "+s.type);t.geometry=this.read(s.geometry)}return s.bbox&&(t.bbox=Pe.bbox.call(this,s.bbox)),t},FeatureCollection:function(s){var t={};if(s.features){t.features=[];for(var e=0;e<s.features.length;++e)t.features.push(this.read(s.features[e]))}return s.bbox&&(t.bbox=this.parse.bbox.call(this,s.bbox)),t},coordinates:function(s){for(var t=[],e=0;e<s.length;++e){var r=s[e];t.push(g(Q,et(r)))}return t},bbox:function(s){return this.geometryFactory.createLinearRing([new Q(s[0],s[1]),new Q(s[2],s[1]),new Q(s[2],s[3]),new Q(s[0],s[3]),new Q(s[0],s[1])])},Point:function(s){var t=g(Q,et(s));return this.geometryFactory.createPoint(t)},MultiPoint:function(s){for(var t=[],e=0;e<s.length;++e)t.push(Pe.Point.call(this,s[e]));return this.geometryFactory.createMultiPoint(t)},LineString:function(s){var t=Pe.coordinates.call(this,s);return this.geometryFactory.createLineString(t)},MultiLineString:function(s){for(var t=[],e=0;e<s.length;++e)t.push(Pe.LineString.call(this,s[e]));return this.geometryFactory.createMultiLineString(t)},Polygon:function(s){for(var t=Pe.coordinates.call(this,s[0]),e=this.geometryFactory.createLinearRing(t),r=[],c=1;c<s.length;++c){var p=s[c],v=Pe.coordinates.call(this,p),E=this.geometryFactory.createLinearRing(v);r.push(E)}return this.geometryFactory.createPolygon(e,r)},MultiPolygon:function(s){for(var t=[],e=0;e<s.length;++e){var r=s[e];t.push(Pe.Polygon.call(this,r))}return this.geometryFactory.createMultiPolygon(t)},GeometryCollection:function(s){for(var t=[],e=0;e<s.length;++e){var r=s[e];t.push(this.read(r))}return this.geometryFactory.createGeometryCollection(t)}},Ie={coordinate:function(s){var t=[s.x,s.y];return s.z&&t.push(s.z),s.m&&t.push(s.m),t},Point:function(s){return{type:"Point",coordinates:Ie.coordinate.call(this,s.getCoordinate())}},MultiPoint:function(s){for(var t=[],e=0;e<s._geometries.length;++e){var r=s._geometries[e],c=Ie.Point.call(this,r);t.push(c.coordinates)}return{type:"MultiPoint",coordinates:t}},LineString:function(s){for(var t=[],e=s.getCoordinates(),r=0;r<e.length;++r){var c=e[r];t.push(Ie.coordinate.call(this,c))}return{type:"LineString",coordinates:t}},MultiLineString:function(s){for(var t=[],e=0;e<s._geometries.length;++e){var r=s._geometries[e],c=Ie.LineString.call(this,r);t.push(c.coordinates)}return{type:"MultiLineString",coordinates:t}},Polygon:function(s){var t=[],e=Ie.LineString.call(this,s._shell);t.push(e.coordinates);for(var r=0;r<s._holes.length;++r){var c=s._holes[r],p=Ie.LineString.call(this,c);t.push(p.coordinates)}return{type:"Polygon",coordinates:t}},MultiPolygon:function(s){for(var t=[],e=0;e<s._geometries.length;++e){var r=s._geometries[e],c=Ie.Polygon.call(this,r);t.push(c.coordinates)}return{type:"MultiPolygon",coordinates:t}},GeometryCollection:function(s){for(var t=[],e=0;e<s._geometries.length;++e){var r=s._geometries[e],c=r.getGeometryType();t.push(Ie[c].call(this,r))}return{type:"GeometryCollection",geometries:t}}};return{BufferOp:Pn,GeoJSONReader:function(){return m(function s(t){l(this,s),this.parser=new $i(t||new Ke)},[{key:"read",value:function(s){return this.parser.read(s)}}])}(),GeoJSONWriter:function(){return m(function s(){l(this,s),this.parser=new $i(this.geometryFactory)},[{key:"write",value:function(s){return this.parser.write(s)}}])}()}})}(zs)),zs.exports}var Mh=Lh();const Sh=vu(Mh);function ai(){return new Ws}function Ws(){this.reset()}Ws.prototype={constructor:Ws,reset:function(){this.s=this.t=0},add:function(h){ka(Ts,h,this.t),ka(this,Ts.s,this.s),this.s?this.t+=Ts.t:this.s=Ts.t},valueOf:function(){return this.s}};var Ts=new Ws;function ka(h,i,o){var a=h.s=i+o,l=a-i,g=a-l;h.t=i-g+(o-l)}var $t=1e-6,Vt=Math.PI,Sn=Vt/2,wa=Vt/4,Tn=Vt*2,ei=180/Vt,ln=Vt/180,xe=Math.abs,Ch=Math.atan,or=Math.atan2,ie=Math.cos,re=Math.sin,lr=Math.sqrt;function ku(h){return h>1?0:h<-1?Vt:Math.acos(h)}function Ci(h){return h>1?Sn:h<-1?-Sn:Math.asin(h)}function Wr(){}function Ks(h,i){h&&Pa.hasOwnProperty(h.type)&&Pa[h.type](h,i)}var Ea={Feature:function(h,i){Ks(h.geometry,i)},FeatureCollection:function(h,i){for(var o=h.features,a=-1,l=o.length;++a<l;)Ks(o[a].geometry,i)}},Pa={Sphere:function(h,i){i.sphere()},Point:function(h,i){h=h.coordinates,i.point(h[0],h[1],h[2])},MultiPoint:function(h,i){for(var o=h.coordinates,a=-1,l=o.length;++a<l;)h=o[a],i.point(h[0],h[1],h[2])},LineString:function(h,i){Fo(h.coordinates,i,0)},MultiLineString:function(h,i){for(var o=h.coordinates,a=-1,l=o.length;++a<l;)Fo(o[a],i,0)},Polygon:function(h,i){Ia(h.coordinates,i)},MultiPolygon:function(h,i){for(var o=h.coordinates,a=-1,l=o.length;++a<l;)Ia(o[a],i)},GeometryCollection:function(h,i){for(var o=h.geometries,a=-1,l=o.length;++a<l;)Ks(o[a],i)}};function Fo(h,i,o){var a=-1,l=h.length-o,g;for(i.lineStart();++a<l;)g=h[a],i.point(g[0],g[1],g[2]);i.lineEnd()}function Ia(h,i){var o=-1,a=h.length;for(i.polygonStart();++o<a;)Fo(h[o],i,1);i.polygonEnd()}function Th(h,i){h&&Ea.hasOwnProperty(h.type)?Ea[h.type](h,i):Ks(h,i)}ai();ai();function Bo(h){return[or(h[1],h[0]),Ci(h[2])]}function ar(h){var i=h[0],o=h[1],a=ie(o);return[a*ie(i),a*re(i),re(o)]}function Ns(h,i){return h[0]*i[0]+h[1]*i[1]+h[2]*i[2]}function Js(h,i){return[h[1]*i[2]-h[2]*i[1],h[2]*i[0]-h[0]*i[2],h[0]*i[1]-h[1]*i[0]]}function So(h,i){h[0]+=i[0],h[1]+=i[1],h[2]+=i[2]}function bs(h,i){return[h[0]*i,h[1]*i,h[2]*i]}function zo(h){var i=lr(h[0]*h[0]+h[1]*h[1]+h[2]*h[2]);h[0]/=i,h[1]/=i,h[2]/=i}ai();function wu(h,i){function o(a,l){return a=h(a,l),i(a[0],a[1])}return h.invert&&i.invert&&(o.invert=function(a,l){return a=i.invert(a,l),a&&h.invert(a[0],a[1])}),o}function Go(h,i){return[h>Vt?h-Tn:h<-Vt?h+Tn:h,i]}Go.invert=Go;function Nh(h,i,o){return(h%=Tn)?i||o?wu(Ma(h),Sa(i,o)):Ma(h):i||o?Sa(i,o):Go}function La(h){return function(i,o){return i+=h,[i>Vt?i-Tn:i<-Vt?i+Tn:i,o]}}function Ma(h){var i=La(h);return i.invert=La(-h),i}function Sa(h,i){var o=ie(h),a=re(h),l=ie(i),g=re(i);function d(m,_){var x=ie(_),w=ie(m)*x,I=re(m)*x,b=re(_),F=b*o+w*a;return[or(I*l-F*g,w*o-b*a),Ci(F*l+I*g)]}return d.invert=function(m,_){var x=ie(_),w=ie(m)*x,I=re(m)*x,b=re(_),F=b*l-I*g;return[or(I*l+b*g,w*o+F*a),Ci(F*o-w*a)]},d}function bh(h,i,o,a,l,g){if(o){var d=ie(i),m=re(i),_=a*o;l==null?(l=i+a*Tn,g=i-_/2):(l=Ca(d,l),g=Ca(d,g),(a>0?l<g:l>g)&&(l+=a*Tn));for(var x,w=l;a>0?w>g:w<g;w-=_)x=Bo([d,-m*ie(w),-m*re(w)]),h.point(x[0],x[1])}}function Ca(h,i){i=ar(i),i[0]-=h,zo(i);var o=ku(-i[1]);return((-i[2]<0?-o:o)+Tn-$t)%Tn}function Eu(){var h=[],i;return{point:function(o,a){i.push([o,a])},lineStart:function(){h.push(i=[])},lineEnd:Wr,rejoin:function(){h.length>1&&h.push(h.pop().concat(h.shift()))},result:function(){var o=h;return h=[],i=null,o}}}function Oh(h,i,o,a,l,g){var d=h[0],m=h[1],_=i[0],x=i[1],w=0,I=1,b=_-d,F=x-m,z;if(z=o-d,!(!b&&z>0)){if(z/=b,b<0){if(z<w)return;z<I&&(I=z)}else if(b>0){if(z>I)return;z>w&&(w=z)}if(z=l-d,!(!b&&z<0)){if(z/=b,b<0){if(z>I)return;z>w&&(w=z)}else if(b>0){if(z<w)return;z<I&&(I=z)}if(z=a-m,!(!F&&z>0)){if(z/=F,F<0){if(z<w)return;z<I&&(I=z)}else if(F>0){if(z>I)return;z>w&&(w=z)}if(z=g-m,!(!F&&z<0)){if(z/=F,F<0){if(z>I)return;z>w&&(w=z)}else if(F>0){if(z<w)return;z<I&&(I=z)}return w>0&&(h[0]=d+w*b,h[1]=m+w*F),I<1&&(i[0]=d+I*b,i[1]=m+I*F),!0}}}}}function Gs(h,i){return xe(h[0]-i[0])<$t&&xe(h[1]-i[1])<$t}function Os(h,i,o,a){this.x=h,this.z=i,this.o=o,this.e=a,this.v=!1,this.n=this.p=null}function Pu(h,i,o,a,l){var g=[],d=[],m,_;if(h.forEach(function(z){if(!((et=z.length-1)<=0)){var et,ot=z[0],ut=z[et],S;if(Gs(ot,ut)){for(l.lineStart(),m=0;m<et;++m)l.point((ot=z[m])[0],ot[1]);l.lineEnd();return}g.push(S=new Os(ot,z,null,!0)),d.push(S.o=new Os(ot,null,S,!1)),g.push(S=new Os(ut,z,null,!1)),d.push(S.o=new Os(ut,null,S,!0))}}),!!g.length){for(d.sort(i),Ta(g),Ta(d),m=0,_=d.length;m<_;++m)d[m].e=o=!o;for(var x=g[0],w,I;;){for(var b=x,F=!0;b.v;)if((b=b.n)===x)return;w=b.z,l.lineStart();do{if(b.v=b.o.v=!0,b.e){if(F)for(m=0,_=w.length;m<_;++m)l.point((I=w[m])[0],I[1]);else a(b.x,b.n.x,1,l);b=b.n}else{if(F)for(w=b.p.z,m=w.length-1;m>=0;--m)l.point((I=w[m])[0],I[1]);else a(b.x,b.p.x,-1,l);b=b.p}b=b.o,w=b.z,F=!F}while(!b.v);l.lineEnd()}}}function Ta(h){if(i=h.length){for(var i,o=0,a=h[0],l;++o<i;)a.n=l=h[o],l.p=a,a=l;a.n=l=h[0],l.p=a}}function Iu(h,i){return h<i?-1:h>i?1:h>=i?0:NaN}function Ah(h){return h.length===1&&(h=Rh(h)),{left:function(i,o,a,l){for(a==null&&(a=0),l==null&&(l=i.length);a<l;){var g=a+l>>>1;h(i[g],o)<0?a=g+1:l=g}return a},right:function(i,o,a,l){for(a==null&&(a=0),l==null&&(l=i.length);a<l;){var g=a+l>>>1;h(i[g],o)>0?l=g:a=g+1}return a}}}function Rh(h){return function(i,o){return Iu(h(i),o)}}Ah(Iu);function Lu(h){for(var i=h.length,o,a=-1,l=0,g,d;++a<i;)l+=h[a].length;for(g=new Array(l);--i>=0;)for(d=h[i],o=d.length;--o>=0;)g[--l]=d[o];return g}var Kr=1e9,As=-Kr;function Dh(h,i,o,a){function l(x,w){return h<=x&&x<=o&&i<=w&&w<=a}function g(x,w,I,b){var F=0,z=0;if(x==null||(F=d(x,I))!==(z=d(w,I))||_(x,w)<0^I>0)do b.point(F===0||F===3?h:o,F>1?a:i);while((F=(F+I+4)%4)!==z);else b.point(w[0],w[1])}function d(x,w){return xe(x[0]-h)<$t?w>0?0:3:xe(x[0]-o)<$t?w>0?2:1:xe(x[1]-i)<$t?w>0?1:0:w>0?3:2}function m(x,w){return _(x.x,w.x)}function _(x,w){var I=d(x,1),b=d(w,1);return I!==b?I-b:I===0?w[1]-x[1]:I===1?x[0]-w[0]:I===2?x[1]-w[1]:w[0]-x[0]}return function(x){var w=x,I=Eu(),b,F,z,et,ot,ut,S,G,R,H,Y,J={point:P,lineStart:O,lineEnd:V,polygonStart:N,polygonEnd:A};function P(X,B){l(X,B)&&w.point(X,B)}function M(){for(var X=0,B=0,j=F.length;B<j;++B)for(var U=F[B],tt=1,W=U.length,rt=U[0],ht,mt,at=rt[0],ct=rt[1];tt<W;++tt)ht=at,mt=ct,rt=U[tt],at=rt[0],ct=rt[1],mt<=a?ct>a&&(at-ht)*(a-mt)>(ct-mt)*(h-ht)&&++X:ct<=a&&(at-ht)*(a-mt)<(ct-mt)*(h-ht)&&--X;return X}function N(){w=I,b=[],F=[],Y=!0}function A(){var X=M(),B=Y&&X,j=(b=Lu(b)).length;(B||j)&&(x.polygonStart(),B&&(x.lineStart(),g(null,null,1,x),x.lineEnd()),j&&Pu(b,m,X,g,x),x.polygonEnd()),w=x,b=F=z=null}function O(){J.point=q,F&&F.push(z=[]),H=!0,R=!1,S=G=NaN}function V(){b&&(q(et,ot),ut&&R&&I.rejoin(),b.push(I.result())),J.point=P,R&&w.lineEnd()}function q(X,B){var j=l(X,B);if(F&&z.push([X,B]),H)et=X,ot=B,ut=j,H=!1,j&&(w.lineStart(),w.point(X,B));else if(j&&R)w.point(X,B);else{var U=[S=Math.max(As,Math.min(Kr,S)),G=Math.max(As,Math.min(Kr,G))],tt=[X=Math.max(As,Math.min(Kr,X)),B=Math.max(As,Math.min(Kr,B))];Oh(U,tt,h,i,o,a)?(R||(w.lineStart(),w.point(U[0],U[1])),w.point(tt[0],tt[1]),j||w.lineEnd(),Y=!1):j&&(w.lineStart(),w.point(X,B),Y=!1)}S=X,G=B,R=j}return J}}var Co=ai();function Fh(h,i){var o=i[0],a=i[1],l=[re(o),-ie(o),0],g=0,d=0;Co.reset();for(var m=0,_=h.length;m<_;++m)if(w=(x=h[m]).length)for(var x,w,I=x[w-1],b=I[0],F=I[1]/2+wa,z=re(F),et=ie(F),ot=0;ot<w;++ot,b=S,z=R,et=H,I=ut){var ut=x[ot],S=ut[0],G=ut[1]/2+wa,R=re(G),H=ie(G),Y=S-b,J=Y>=0?1:-1,P=J*Y,M=P>Vt,N=z*R;if(Co.add(or(N*J*re(P),et*H+N*ie(P))),g+=M?Y+J*Tn:Y,M^b>=o^S>=o){var A=Js(ar(I),ar(ut));zo(A);var O=Js(l,A);zo(O);var V=(M^Y>=0?-1:1)*Ci(O[2]);(a>V||a===V&&(A[0]||A[1]))&&(d+=M^Y>=0?1:-1)}}return(g<-$t||g<$t&&Co<-$t)^d&1}ai();function Na(h){return h}ai();ai();var ur=1/0,js=ur,ns=-ur,$s=ns,ba={point:Bh,lineStart:Wr,lineEnd:Wr,polygonStart:Wr,polygonEnd:Wr,result:function(){var h=[[ur,js],[ns,$s]];return ns=$s=-(js=ur=1/0),h}};function Bh(h,i){h<ur&&(ur=h),h>ns&&(ns=h),i<js&&(js=i),i>$s&&($s=i)}ai();function Mu(h,i,o,a){return function(l,g){var d=i(g),m=l.invert(a[0],a[1]),_=Eu(),x=i(_),w=!1,I,b,F,z={point:et,lineStart:ut,lineEnd:S,polygonStart:function(){z.point=G,z.lineStart=R,z.lineEnd=H,b=[],I=[]},polygonEnd:function(){z.point=et,z.lineStart=ut,z.lineEnd=S,b=Lu(b);var Y=Fh(I,m);b.length?(w||(g.polygonStart(),w=!0),Pu(b,Gh,Y,o,g)):Y&&(w||(g.polygonStart(),w=!0),g.lineStart(),o(null,null,1,g),g.lineEnd()),w&&(g.polygonEnd(),w=!1),b=I=null},sphere:function(){g.polygonStart(),g.lineStart(),o(null,null,1,g),g.lineEnd(),g.polygonEnd()}};function et(Y,J){var P=l(Y,J);h(Y=P[0],J=P[1])&&g.point(Y,J)}function ot(Y,J){var P=l(Y,J);d.point(P[0],P[1])}function ut(){z.point=ot,d.lineStart()}function S(){z.point=et,d.lineEnd()}function G(Y,J){F.push([Y,J]);var P=l(Y,J);x.point(P[0],P[1])}function R(){x.lineStart(),F=[]}function H(){G(F[0][0],F[0][1]),x.lineEnd();var Y=x.clean(),J=_.result(),P,M=J.length,N,A,O;if(F.pop(),I.push(F),F=null,!!M){if(Y&1){if(A=J[0],(N=A.length-1)>0){for(w||(g.polygonStart(),w=!0),g.lineStart(),P=0;P<N;++P)g.point((O=A[P])[0],O[1]);g.lineEnd()}return}M>1&&Y&2&&J.push(J.pop().concat(J.shift())),b.push(J.filter(zh))}}return z}}function zh(h){return h.length>1}function Gh(h,i){return((h=h.x)[0]<0?h[1]-Sn-$t:Sn-h[1])-((i=i.x)[0]<0?i[1]-Sn-$t:Sn-i[1])}const Oa=Mu(function(){return!0},qh,Zh,[-Vt,-Sn]);function qh(h){var i=NaN,o=NaN,a=NaN,l;return{lineStart:function(){h.lineStart(),l=1},point:function(g,d){var m=g>0?Vt:-Vt,_=xe(g-i);xe(_-Vt)<$t?(h.point(i,o=(o+d)/2>0?Sn:-Sn),h.point(a,o),h.lineEnd(),h.lineStart(),h.point(m,o),h.point(g,o),l=0):a!==m&&_>=Vt&&(xe(i-a)<$t&&(i-=a*$t),xe(g-m)<$t&&(g-=m*$t),o=Hh(i,o,g,d),h.point(a,o),h.lineEnd(),h.lineStart(),h.point(m,o),l=0),h.point(i=g,o=d),a=m},lineEnd:function(){h.lineEnd(),i=o=NaN},clean:function(){return 2-l}}}function Hh(h,i,o,a){var l,g,d=re(h-o);return xe(d)>$t?Ch((re(i)*(g=ie(a))*re(o)-re(a)*(l=ie(i))*re(h))/(l*g*d)):(i+a)/2}function Zh(h,i,o,a){var l;if(h==null)l=o*Sn,a.point(-Vt,l),a.point(0,l),a.point(Vt,l),a.point(Vt,0),a.point(Vt,-l),a.point(0,-l),a.point(-Vt,-l),a.point(-Vt,0),a.point(-Vt,l);else if(xe(h[0]-i[0])>$t){var g=h[0]<i[0]?Vt:-Vt;l=o*g/2,a.point(-g,l),a.point(0,l),a.point(g,l)}else a.point(i[0],i[1])}function Uh(h,i){var o=ie(h),a=o>0,l=xe(o)>$t;function g(w,I,b,F){bh(F,h,i,b,w,I)}function d(w,I){return ie(w)*ie(I)>o}function m(w){var I,b,F,z,et;return{lineStart:function(){z=F=!1,et=1},point:function(ot,ut){var S=[ot,ut],G,R=d(ot,ut),H=a?R?0:x(ot,ut):R?x(ot+(ot<0?Vt:-Vt),ut):0;if(!I&&(z=F=R)&&w.lineStart(),R!==F&&(G=_(I,S),(!G||Gs(I,G)||Gs(S,G))&&(S[0]+=$t,S[1]+=$t,R=d(S[0],S[1]))),R!==F)et=0,R?(w.lineStart(),G=_(S,I),w.point(G[0],G[1])):(G=_(I,S),w.point(G[0],G[1]),w.lineEnd()),I=G;else if(l&&I&&a^R){var Y;!(H&b)&&(Y=_(S,I,!0))&&(et=0,a?(w.lineStart(),w.point(Y[0][0],Y[0][1]),w.point(Y[1][0],Y[1][1]),w.lineEnd()):(w.point(Y[1][0],Y[1][1]),w.lineEnd(),w.lineStart(),w.point(Y[0][0],Y[0][1])))}R&&(!I||!Gs(I,S))&&w.point(S[0],S[1]),I=S,F=R,b=H},lineEnd:function(){F&&w.lineEnd(),I=null},clean:function(){return et|(z&&F)<<1}}}function _(w,I,b){var F=ar(w),z=ar(I),et=[1,0,0],ot=Js(F,z),ut=Ns(ot,ot),S=ot[0],G=ut-S*S;if(!G)return!b&&w;var R=o*ut/G,H=-o*S/G,Y=Js(et,ot),J=bs(et,R),P=bs(ot,H);So(J,P);var M=Y,N=Ns(J,M),A=Ns(M,M),O=N*N-A*(Ns(J,J)-1);if(!(O<0)){var V=lr(O),q=bs(M,(-N-V)/A);if(So(q,J),q=Bo(q),!b)return q;var X=w[0],B=I[0],j=w[1],U=I[1],tt;B<X&&(tt=X,X=B,B=tt);var W=B-X,rt=xe(W-Vt)<$t,ht=rt||W<$t;if(!rt&&U<j&&(tt=j,j=U,U=tt),ht?rt?j+U>0^q[1]<(xe(q[0]-X)<$t?j:U):j<=q[1]&&q[1]<=U:W>Vt^(X<=q[0]&&q[0]<=B)){var mt=bs(M,(-N+V)/A);return So(mt,J),[q,Bo(mt)]}}}function x(w,I){var b=a?h:Vt-h,F=0;return w<-b?F|=1:w>b&&(F|=2),I<-b?F|=4:I>b&&(F|=8),F}return Mu(d,m,g,a?[0,-h]:[-Vt,h-Vt])}function Su(h){return function(i){var o=new qo;for(var a in h)o[a]=h[a];return o.stream=i,o}}function qo(){}qo.prototype={constructor:qo,point:function(h,i){this.stream.point(h,i)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Cu(h,i,o){var a=i[1][0]-i[0][0],l=i[1][1]-i[0][1],g=h.clipExtent&&h.clipExtent();h.scale(150).translate([0,0]),g!=null&&h.clipExtent(null),Th(o,h.stream(ba));var d=ba.result(),m=Math.min(a/(d[1][0]-d[0][0]),l/(d[1][1]-d[0][1])),_=+i[0][0]+(a-m*(d[1][0]+d[0][0]))/2,x=+i[0][1]+(l-m*(d[1][1]+d[0][1]))/2;return g!=null&&h.clipExtent(g),h.scale(m*150).translate([_,x])}function Yh(h,i,o){return Cu(h,[[0,0],i],o)}var Aa=16,Xh=ie(30*ln);function Ra(h,i){return+i?Wh(h,i):Vh(h)}function Vh(h){return Su({point:function(i,o){i=h(i,o),this.stream.point(i[0],i[1])}})}function Wh(h,i){function o(a,l,g,d,m,_,x,w,I,b,F,z,et,ot){var ut=x-a,S=w-l,G=ut*ut+S*S;if(G>4*i&&et--){var R=d+b,H=m+F,Y=_+z,J=lr(R*R+H*H+Y*Y),P=Ci(Y/=J),M=xe(xe(Y)-1)<$t||xe(g-I)<$t?(g+I)/2:or(H,R),N=h(M,P),A=N[0],O=N[1],V=A-a,q=O-l,X=S*V-ut*q;(X*X/G>i||xe((ut*V+S*q)/G-.5)>.3||d*b+m*F+_*z<Xh)&&(o(a,l,g,d,m,_,A,O,M,R/=J,H/=J,Y,et,ot),ot.point(A,O),o(A,O,M,R,H,Y,x,w,I,b,F,z,et,ot))}}return function(a){var l,g,d,m,_,x,w,I,b,F,z,et,ot={point:ut,lineStart:S,lineEnd:R,polygonStart:function(){a.polygonStart(),ot.lineStart=H},polygonEnd:function(){a.polygonEnd(),ot.lineStart=S}};function ut(P,M){P=h(P,M),a.point(P[0],P[1])}function S(){I=NaN,ot.point=G,a.lineStart()}function G(P,M){var N=ar([P,M]),A=h(P,M);o(I,b,w,F,z,et,I=A[0],b=A[1],w=P,F=N[0],z=N[1],et=N[2],Aa,a),a.point(I,b)}function R(){ot.point=ut,a.lineEnd()}function H(){S(),ot.point=Y,ot.lineEnd=J}function Y(P,M){G(l=P,M),g=I,d=b,m=F,_=z,x=et,ot.point=G}function J(){o(I,b,w,F,z,et,g,d,l,m,_,x,Aa,a),ot.lineEnd=R,R()}return ot}}var Kh=Su({point:function(h,i){this.stream.point(h*ln,i*ln)}});function Jh(h){return jh(function(){return h})()}function jh(h){var i,o=150,a=480,l=250,g,d,m=0,_=0,x=0,w=0,I=0,b,F,z=null,et=Oa,ot=null,ut,S,G,R=Na,H=.5,Y=Ra(A,H),J,P;function M(q){return q=F(q[0]*ln,q[1]*ln),[q[0]*o+g,d-q[1]*o]}function N(q){return q=F.invert((q[0]-g)/o,(d-q[1])/o),q&&[q[0]*ei,q[1]*ei]}function A(q,X){return q=i(q,X),[q[0]*o+g,d-q[1]*o]}M.stream=function(q){return J&&P===q?J:J=Kh(et(b,Y(R(P=q))))},M.clipAngle=function(q){return arguments.length?(et=+q?Uh(z=q*ln,6*ln):(z=null,Oa),V()):z*ei},M.clipExtent=function(q){return arguments.length?(R=q==null?(ot=ut=S=G=null,Na):Dh(ot=+q[0][0],ut=+q[0][1],S=+q[1][0],G=+q[1][1]),V()):ot==null?null:[[ot,ut],[S,G]]},M.scale=function(q){return arguments.length?(o=+q,O()):o},M.translate=function(q){return arguments.length?(a=+q[0],l=+q[1],O()):[a,l]},M.center=function(q){return arguments.length?(m=q[0]%360*ln,_=q[1]%360*ln,O()):[m*ei,_*ei]},M.rotate=function(q){return arguments.length?(x=q[0]%360*ln,w=q[1]%360*ln,I=q.length>2?q[2]%360*ln:0,O()):[x*ei,w*ei,I*ei]},M.precision=function(q){return arguments.length?(Y=Ra(A,H=q*q),V()):lr(H)},M.fitExtent=function(q,X){return Cu(M,q,X)},M.fitSize=function(q,X){return Yh(M,q,X)};function O(){F=wu(b=Nh(x,w,I),i);var q=i(m,_);return g=a-q[0]*o,d=l+q[1]*o,V()}function V(){return J=P=null,M}return function(){return i=h.apply(this,arguments),M.invert=i.invert&&N,O()}}function Tu(h){return function(i,o){var a=ie(i),l=ie(o),g=h(a*l);return[g*l*re(i),g*re(o)]}}function Nu(h){return function(i,o){var a=lr(i*i+o*o),l=h(a),g=re(l),d=ie(l);return[or(i*g,a*d),Ci(a&&o*g/a)]}}var $h=Tu(function(h){return lr(2/(1+h))});$h.invert=Nu(function(h){return 2*Ci(h/2)});var bu=Tu(function(h){return(h=ku(h))&&h/re(h)});bu.invert=Nu(function(h){return h});function Qh(){return Jh(bu).scale(79.4188).clipAngle(180-.001)}function Da(h,i){return[h,i]}Da.invert=Da;var{BufferOp:tc,GeoJSONReader:ec,GeoJSONWriter:nc}=Sh;function ic(h,i,o){o=o||{};var a=o.units||"kilometers",l=o.steps||8;if(!h)throw new Error("geojson is required");if(typeof o!="object")throw new Error("options must be an object");if(typeof l!="number")throw new Error("steps must be an number");if(l<=0)throw new Error("steps must be greater than 0");var g=[];switch(h.type){case"GeometryCollection":return oi(h,function(d){var m=qs(d,i,a,l);m&&g.push(m)}),Te(g);case"FeatureCollection":return ri(h,function(d){var m=qs(d,i,a,l);m&&ri(m,function(_){_&&g.push(_)})}),Te(g)}return qs(h,i,a,l)}function qs(h,i,o,a){var l=h.properties||{},g=h.type==="Feature"?h.geometry:h;if(g.type==="GeometryCollection"){var d=[];return oi(h,function(et){var ot=qs(et,i,o,a);ot&&d.push(ot)}),Te(d)}var m=rc(g),_={type:g.type,coordinates:Au(g.coordinates,m)},x=new ec,w=x.read(_),I=lu(hu(i,o),"meters"),b=tc.bufferOp(w,I,a),F=new nc;if(b=F.write(b),!Ou(b.coordinates)){var z={type:b.type,coordinates:Ru(b.coordinates,m)};return pn(z,l)}}function Ou(h){return Array.isArray(h[0])?Ou(h[0]):isNaN(h[0])}function Au(h,i){return typeof h[0]!="object"?i(h):h.map(function(o){return Au(o,i)})}function Ru(h,i){return typeof h[0]!="object"?i.invert(h):h.map(function(o){return Ru(o,i)})}function rc(h){var i=Ph(h).geometry.coordinates,o=[-i[0],-i[1]];return Qh().rotate(o).scale(Se)}function sc(h,i={}){let o=0,a=0,l=0;return ii(h,function(g){o+=g[0],a+=g[1],l++},!0),ae([o/l,a/l],i.properties)}var Rs={exports:{}},Hs={exports:{}},oc=Hs.exports,Fa;function ac(){return Fa||(Fa=1,function(h,i){(function(o,a){h.exports=a()})(oc,function(){function o(S,G,R,H,Y){(function J(P,M,N,A,O){for(;A>N;){if(A-N>600){var V=A-N+1,q=M-N+1,X=Math.log(V),B=.5*Math.exp(2*X/3),j=.5*Math.sqrt(X*B*(V-B)/V)*(q-V/2<0?-1:1),U=Math.max(N,Math.floor(M-q*B/V+j)),tt=Math.min(A,Math.floor(M+(V-q)*B/V+j));J(P,M,U,tt,O)}var W=P[M],rt=N,ht=A;for(a(P,N,M),O(P[A],W)>0&&a(P,N,A);rt<ht;){for(a(P,rt,ht),rt++,ht--;O(P[rt],W)<0;)rt++;for(;O(P[ht],W)>0;)ht--}O(P[N],W)===0?a(P,N,ht):a(P,++ht,A),ht<=M&&(N=ht+1),M<=ht&&(A=ht-1)}})(S,G,R||0,H||S.length-1,Y||l)}function a(S,G,R){var H=S[G];S[G]=S[R],S[R]=H}function l(S,G){return S<G?-1:S>G?1:0}var g=function(S){S===void 0&&(S=9),this._maxEntries=Math.max(4,S),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function d(S,G,R){if(!R)return G.indexOf(S);for(var H=0;H<G.length;H++)if(R(S,G[H]))return H;return-1}function m(S,G){_(S,0,S.children.length,G,S)}function _(S,G,R,H,Y){Y||(Y=ot(null)),Y.minX=1/0,Y.minY=1/0,Y.maxX=-1/0,Y.maxY=-1/0;for(var J=G;J<R;J++){var P=S.children[J];x(Y,S.leaf?H(P):P)}return Y}function x(S,G){return S.minX=Math.min(S.minX,G.minX),S.minY=Math.min(S.minY,G.minY),S.maxX=Math.max(S.maxX,G.maxX),S.maxY=Math.max(S.maxY,G.maxY),S}function w(S,G){return S.minX-G.minX}function I(S,G){return S.minY-G.minY}function b(S){return(S.maxX-S.minX)*(S.maxY-S.minY)}function F(S){return S.maxX-S.minX+(S.maxY-S.minY)}function z(S,G){return S.minX<=G.minX&&S.minY<=G.minY&&G.maxX<=S.maxX&&G.maxY<=S.maxY}function et(S,G){return G.minX<=S.maxX&&G.minY<=S.maxY&&G.maxX>=S.minX&&G.maxY>=S.minY}function ot(S){return{children:S,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ut(S,G,R,H,Y){for(var J=[G,R];J.length;)if(!((R=J.pop())-(G=J.pop())<=H)){var P=G+Math.ceil((R-G)/H/2)*H;o(S,P,G,R,Y),J.push(G,P,P,R)}}return g.prototype.all=function(){return this._all(this.data,[])},g.prototype.search=function(S){var G=this.data,R=[];if(!et(S,G))return R;for(var H=this.toBBox,Y=[];G;){for(var J=0;J<G.children.length;J++){var P=G.children[J],M=G.leaf?H(P):P;et(S,M)&&(G.leaf?R.push(P):z(S,M)?this._all(P,R):Y.push(P))}G=Y.pop()}return R},g.prototype.collides=function(S){var G=this.data;if(!et(S,G))return!1;for(var R=[];G;){for(var H=0;H<G.children.length;H++){var Y=G.children[H],J=G.leaf?this.toBBox(Y):Y;if(et(S,J)){if(G.leaf||z(S,J))return!0;R.push(Y)}}G=R.pop()}return!1},g.prototype.load=function(S){if(!S||!S.length)return this;if(S.length<this._minEntries){for(var G=0;G<S.length;G++)this.insert(S[G]);return this}var R=this._build(S.slice(),0,S.length-1,0);if(this.data.children.length)if(this.data.height===R.height)this._splitRoot(this.data,R);else{if(this.data.height<R.height){var H=this.data;this.data=R,R=H}this._insert(R,this.data.height-R.height-1,!0)}else this.data=R;return this},g.prototype.insert=function(S){return S&&this._insert(S,this.data.height-1),this},g.prototype.clear=function(){return this.data=ot([]),this},g.prototype.remove=function(S,G){if(!S)return this;for(var R,H,Y,J=this.data,P=this.toBBox(S),M=[],N=[];J||M.length;){if(J||(J=M.pop(),H=M[M.length-1],R=N.pop(),Y=!0),J.leaf){var A=d(S,J.children,G);if(A!==-1)return J.children.splice(A,1),M.push(J),this._condense(M),this}Y||J.leaf||!z(J,P)?H?(R++,J=H.children[R],Y=!1):J=null:(M.push(J),N.push(R),R=0,H=J,J=J.children[0])}return this},g.prototype.toBBox=function(S){return S},g.prototype.compareMinX=function(S,G){return S.minX-G.minX},g.prototype.compareMinY=function(S,G){return S.minY-G.minY},g.prototype.toJSON=function(){return this.data},g.prototype.fromJSON=function(S){return this.data=S,this},g.prototype._all=function(S,G){for(var R=[];S;)S.leaf?G.push.apply(G,S.children):R.push.apply(R,S.children),S=R.pop();return G},g.prototype._build=function(S,G,R,H){var Y,J=R-G+1,P=this._maxEntries;if(J<=P)return m(Y=ot(S.slice(G,R+1)),this.toBBox),Y;H||(H=Math.ceil(Math.log(J)/Math.log(P)),P=Math.ceil(J/Math.pow(P,H-1))),(Y=ot([])).leaf=!1,Y.height=H;var M=Math.ceil(J/P),N=M*Math.ceil(Math.sqrt(P));ut(S,G,R,N,this.compareMinX);for(var A=G;A<=R;A+=N){var O=Math.min(A+N-1,R);ut(S,A,O,M,this.compareMinY);for(var V=A;V<=O;V+=M){var q=Math.min(V+M-1,O);Y.children.push(this._build(S,V,q,H-1))}}return m(Y,this.toBBox),Y},g.prototype._chooseSubtree=function(S,G,R,H){for(;H.push(G),!G.leaf&&H.length-1!==R;){for(var Y=1/0,J=1/0,P=void 0,M=0;M<G.children.length;M++){var N=G.children[M],A=b(N),O=(V=S,q=N,(Math.max(q.maxX,V.maxX)-Math.min(q.minX,V.minX))*(Math.max(q.maxY,V.maxY)-Math.min(q.minY,V.minY))-A);O<J?(J=O,Y=A<Y?A:Y,P=N):O===J&&A<Y&&(Y=A,P=N)}G=P||G.children[0]}var V,q;return G},g.prototype._insert=function(S,G,R){var H=R?S:this.toBBox(S),Y=[],J=this._chooseSubtree(H,this.data,G,Y);for(J.children.push(S),x(J,H);G>=0&&Y[G].children.length>this._maxEntries;)this._split(Y,G),G--;this._adjustParentBBoxes(H,Y,G)},g.prototype._split=function(S,G){var R=S[G],H=R.children.length,Y=this._minEntries;this._chooseSplitAxis(R,Y,H);var J=this._chooseSplitIndex(R,Y,H),P=ot(R.children.splice(J,R.children.length-J));P.height=R.height,P.leaf=R.leaf,m(R,this.toBBox),m(P,this.toBBox),G?S[G-1].children.push(P):this._splitRoot(R,P)},g.prototype._splitRoot=function(S,G){this.data=ot([S,G]),this.data.height=S.height+1,this.data.leaf=!1,m(this.data,this.toBBox)},g.prototype._chooseSplitIndex=function(S,G,R){for(var H,Y,J,P,M,N,A,O=1/0,V=1/0,q=G;q<=R-G;q++){var X=_(S,0,q,this.toBBox),B=_(S,q,R,this.toBBox),j=(Y=X,J=B,P=void 0,M=void 0,N=void 0,A=void 0,P=Math.max(Y.minX,J.minX),M=Math.max(Y.minY,J.minY),N=Math.min(Y.maxX,J.maxX),A=Math.min(Y.maxY,J.maxY),Math.max(0,N-P)*Math.max(0,A-M)),U=b(X)+b(B);j<O?(O=j,H=q,V=U<V?U:V):j===O&&U<V&&(V=U,H=q)}return H||R-G},g.prototype._chooseSplitAxis=function(S,G,R){var H=S.leaf?this.compareMinX:w,Y=S.leaf?this.compareMinY:I;this._allDistMargin(S,G,R,H)<this._allDistMargin(S,G,R,Y)&&S.children.sort(H)},g.prototype._allDistMargin=function(S,G,R,H){S.children.sort(H);for(var Y=this.toBBox,J=_(S,0,G,Y),P=_(S,R-G,R,Y),M=F(J)+F(P),N=G;N<R-G;N++){var A=S.children[N];x(J,S.leaf?Y(A):A),M+=F(J)}for(var O=R-G-1;O>=G;O--){var V=S.children[O];x(P,S.leaf?Y(V):V),M+=F(P)}return M},g.prototype._adjustParentBBoxes=function(S,G,R){for(var H=R;H>=0;H--)x(G[H],S)},g.prototype._condense=function(S){for(var G=S.length-1,R=void 0;G>=0;G--)S[G].children.length===0?G>0?(R=S[G-1].children).splice(R.indexOf(S[G]),1):this.clear():m(S[G],this.toBBox)},g})}(Hs)),Hs.exports}class uc{constructor(i=[],o=lc){if(this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:o,compare:a}=this,l=o[i];for(;i>0;){const g=i-1>>1,d=o[g];if(a(l,d)>=0)break;o[i]=d,i=g}o[i]=l}_down(i){const{data:o,compare:a}=this,l=this.length>>1,g=o[i];for(;i<l;){let d=(i<<1)+1,m=o[d];const _=d+1;if(_<this.length&&a(o[_],m)<0&&(d=_,m=o[_]),a(m,g)>=0)break;o[i]=m,i=d}o[i]=g}}function lc(h,i){return h<i?-1:h>i?1:0}const hc=Object.freeze(Object.defineProperty({__proto__:null,default:uc},Symbol.toStringTag,{value:"Module"})),cc=mh(hc);var qr={exports:{}},To,Ba;function fc(){return Ba||(Ba=1,To=function(i,o,a,l){var g=i[0],d=i[1],m=!1;a===void 0&&(a=0),l===void 0&&(l=o.length);for(var _=(l-a)/2,x=0,w=_-1;x<_;w=x++){var I=o[a+x*2+0],b=o[a+x*2+1],F=o[a+w*2+0],z=o[a+w*2+1],et=b>d!=z>d&&g<(F-I)*(d-b)/(z-b)+I;et&&(m=!m)}return m}),To}var No,za;function gc(){return za||(za=1,No=function(i,o,a,l){var g=i[0],d=i[1],m=!1;a===void 0&&(a=0),l===void 0&&(l=o.length);for(var _=l-a,x=0,w=_-1;x<_;w=x++){var I=o[x+a][0],b=o[x+a][1],F=o[w+a][0],z=o[w+a][1],et=b>d!=z>d&&g<(F-I)*(d-b)/(z-b)+I;et&&(m=!m)}return m}),No}var Ga;function dc(){if(Ga)return qr.exports;Ga=1;var h=fc(),i=gc();return qr.exports=function(a,l,g,d){return l.length>0&&Array.isArray(l[0])?i(a,l,g,d):h(a,l,g,d)},qr.exports.nested=i,qr.exports.flat=h,qr.exports}var Jr={exports:{}},mc=Jr.exports,qa;function pc(){return qa||(qa=1,function(h,i){(function(o,a){a(i)})(mc,function(o){const l=33306690738754706e-32;function g(et,ot,ut,S,G){let R,H,Y,J,P=ot[0],M=S[0],N=0,A=0;M>P==M>-P?(R=P,P=ot[++N]):(R=M,M=S[++A]);let O=0;if(N<et&&A<ut)for(M>P==M>-P?(Y=R-((H=P+R)-P),P=ot[++N]):(Y=R-((H=M+R)-M),M=S[++A]),R=H,Y!==0&&(G[O++]=Y);N<et&&A<ut;)M>P==M>-P?(Y=R-((H=R+P)-(J=H-R))+(P-J),P=ot[++N]):(Y=R-((H=R+M)-(J=H-R))+(M-J),M=S[++A]),R=H,Y!==0&&(G[O++]=Y);for(;N<et;)Y=R-((H=R+P)-(J=H-R))+(P-J),P=ot[++N],R=H,Y!==0&&(G[O++]=Y);for(;A<ut;)Y=R-((H=R+M)-(J=H-R))+(M-J),M=S[++A],R=H,Y!==0&&(G[O++]=Y);return R===0&&O!==0||(G[O++]=R),O}function d(et){return new Float64Array(et)}const m=33306690738754716e-32,_=22204460492503146e-32,x=11093356479670487e-47,w=d(4),I=d(8),b=d(12),F=d(16),z=d(4);o.orient2d=function(et,ot,ut,S,G,R){const H=(ot-R)*(ut-G),Y=(et-G)*(S-R),J=H-Y;if(H===0||Y===0||H>0!=Y>0)return J;const P=Math.abs(H+Y);return Math.abs(J)>=m*P?J:-function(M,N,A,O,V,q,X){let B,j,U,tt,W,rt,ht,mt,at,ct,ft,kt,Q,Xt,Ct,vt,Z,At;const Gt=M-V,Mt=A-V,ke=N-q,ce=O-q;W=(Ct=(mt=Gt-(ht=(rt=134217729*Gt)-(rt-Gt)))*(ct=ce-(at=(rt=134217729*ce)-(rt-ce)))-((Xt=Gt*ce)-ht*at-mt*at-ht*ct))-(ft=Ct-(Z=(mt=ke-(ht=(rt=134217729*ke)-(rt-ke)))*(ct=Mt-(at=(rt=134217729*Mt)-(rt-Mt)))-((vt=ke*Mt)-ht*at-mt*at-ht*ct))),w[0]=Ct-(ft+W)+(W-Z),W=(Q=Xt-((kt=Xt+ft)-(W=kt-Xt))+(ft-W))-(ft=Q-vt),w[1]=Q-(ft+W)+(W-vt),W=(At=kt+ft)-kt,w[2]=kt-(At-W)+(ft-W),w[3]=At;let Ne=function(Ti,bt){let yn=bt[0];for(let Xe=1;Xe<Ti;Xe++)yn+=bt[Xe];return yn}(4,w),pt=_*X;if(Ne>=pt||-Ne>=pt||(B=M-(Gt+(W=M-Gt))+(W-V),U=A-(Mt+(W=A-Mt))+(W-V),j=N-(ke+(W=N-ke))+(W-q),tt=O-(ce+(W=O-ce))+(W-q),B===0&&j===0&&U===0&&tt===0)||(pt=x*X+l*Math.abs(Ne),(Ne+=Gt*tt+ce*B-(ke*U+Mt*j))>=pt||-Ne>=pt))return Ne;W=(Ct=(mt=B-(ht=(rt=134217729*B)-(rt-B)))*(ct=ce-(at=(rt=134217729*ce)-(rt-ce)))-((Xt=B*ce)-ht*at-mt*at-ht*ct))-(ft=Ct-(Z=(mt=j-(ht=(rt=134217729*j)-(rt-j)))*(ct=Mt-(at=(rt=134217729*Mt)-(rt-Mt)))-((vt=j*Mt)-ht*at-mt*at-ht*ct))),z[0]=Ct-(ft+W)+(W-Z),W=(Q=Xt-((kt=Xt+ft)-(W=kt-Xt))+(ft-W))-(ft=Q-vt),z[1]=Q-(ft+W)+(W-vt),W=(At=kt+ft)-kt,z[2]=kt-(At-W)+(ft-W),z[3]=At;const ui=g(4,w,4,z,I);W=(Ct=(mt=Gt-(ht=(rt=134217729*Gt)-(rt-Gt)))*(ct=tt-(at=(rt=134217729*tt)-(rt-tt)))-((Xt=Gt*tt)-ht*at-mt*at-ht*ct))-(ft=Ct-(Z=(mt=ke-(ht=(rt=134217729*ke)-(rt-ke)))*(ct=U-(at=(rt=134217729*U)-(rt-U)))-((vt=ke*U)-ht*at-mt*at-ht*ct))),z[0]=Ct-(ft+W)+(W-Z),W=(Q=Xt-((kt=Xt+ft)-(W=kt-Xt))+(ft-W))-(ft=Q-vt),z[1]=Q-(ft+W)+(W-vt),W=(At=kt+ft)-kt,z[2]=kt-(At-W)+(ft-W),z[3]=At;const Zn=g(ui,I,4,z,b);W=(Ct=(mt=B-(ht=(rt=134217729*B)-(rt-B)))*(ct=tt-(at=(rt=134217729*tt)-(rt-tt)))-((Xt=B*tt)-ht*at-mt*at-ht*ct))-(ft=Ct-(Z=(mt=j-(ht=(rt=134217729*j)-(rt-j)))*(ct=U-(at=(rt=134217729*U)-(rt-U)))-((vt=j*U)-ht*at-mt*at-ht*ct))),z[0]=Ct-(ft+W)+(W-Z),W=(Q=Xt-((kt=Xt+ft)-(W=kt-Xt))+(ft-W))-(ft=Q-vt),z[1]=Q-(ft+W)+(W-vt),W=(At=kt+ft)-kt,z[2]=kt-(At-W)+(ft-W),z[3]=At;const Ye=g(Zn,b,4,z,F);return F[Ye-1]}(et,ot,ut,S,G,R,P)},o.orient2dfast=function(et,ot,ut,S,G,R){return(ot-R)*(ut-G)-(et-G)*(S-R)},Object.defineProperty(o,"__esModule",{value:!0})})}(Jr,Jr.exports)),Jr.exports}var Ha;function yc(){if(Ha)return Rs.exports;Ha=1;var h=ac(),i=cc,o=dc(),a=pc().orient2d;i.default&&(i=i.default),Rs.exports=l,Rs.exports.default=l;function l(R,H,Y){H=Math.max(0,H===void 0?2:H),Y=Y||0;var J=F(R),P=new h(16);P.toBBox=function(ht){return{minX:ht[0],minY:ht[1],maxX:ht[0],maxY:ht[1]}},P.compareMinX=function(ht,mt){return ht[0]-mt[0]},P.compareMinY=function(ht,mt){return ht[1]-mt[1]},P.load(R);for(var M=[],N=0,A;N<J.length;N++){var O=J[N];P.remove(O),A=z(O,A),M.push(A)}var V=new h(16);for(N=0;N<M.length;N++)V.insert(b(M[N]));for(var q=H*H,X=Y*Y;M.length;){var B=M.shift(),j=B.p,U=B.next.p,tt=et(j,U);if(!(tt<X)){var W=tt/q;O=g(P,B.prev.p,j,U,B.next.next.p,W,V),O&&Math.min(et(O,j),et(O,U))<=W&&(M.push(B),M.push(z(O,B)),P.remove(O),V.remove(B),V.insert(b(B)),V.insert(b(B.next)))}}B=A;var rt=[];do rt.push(B.p),B=B.next;while(B!==A);return rt.push(B.p),rt}function g(R,H,Y,J,P,M,N){for(var A=new i([],d),O=R.data;O;){for(var V=0;V<O.children.length;V++){var q=O.children[V],X=O.leaf?ot(q,Y,J):m(Y,J,q);X>M||A.push({node:q,dist:X})}for(;A.length&&!A.peek().node.children;){var B=A.pop(),j=B.node,U=ot(j,H,Y),tt=ot(j,J,P);if(B.dist<U&&B.dist<tt&&x(Y,j,N)&&x(J,j,N))return j}O=A.pop(),O&&(O=O.node)}return null}function d(R,H){return R.dist-H.dist}function m(R,H,Y){if(_(R,Y)||_(H,Y))return 0;var J=ut(R[0],R[1],H[0],H[1],Y.minX,Y.minY,Y.maxX,Y.minY);if(J===0)return 0;var P=ut(R[0],R[1],H[0],H[1],Y.minX,Y.minY,Y.minX,Y.maxY);if(P===0)return 0;var M=ut(R[0],R[1],H[0],H[1],Y.maxX,Y.minY,Y.maxX,Y.maxY);if(M===0)return 0;var N=ut(R[0],R[1],H[0],H[1],Y.minX,Y.maxY,Y.maxX,Y.maxY);return N===0?0:Math.min(J,P,M,N)}function _(R,H){return R[0]>=H.minX&&R[0]<=H.maxX&&R[1]>=H.minY&&R[1]<=H.maxY}function x(R,H,Y){for(var J=Math.min(R[0],H[0]),P=Math.min(R[1],H[1]),M=Math.max(R[0],H[0]),N=Math.max(R[1],H[1]),A=Y.search({minX:J,minY:P,maxX:M,maxY:N}),O=0;O<A.length;O++)if(I(A[O].p,A[O].next.p,R,H))return!1;return!0}function w(R,H,Y){return a(R[0],R[1],H[0],H[1],Y[0],Y[1])}function I(R,H,Y,J){return R!==J&&H!==Y&&w(R,H,Y)>0!=w(R,H,J)>0&&w(Y,J,R)>0!=w(Y,J,H)>0}function b(R){var H=R.p,Y=R.next.p;return R.minX=Math.min(H[0],Y[0]),R.minY=Math.min(H[1],Y[1]),R.maxX=Math.max(H[0],Y[0]),R.maxY=Math.max(H[1],Y[1]),R}function F(R){for(var H=R[0],Y=R[0],J=R[0],P=R[0],M=0;M<R.length;M++){var N=R[M];N[0]<H[0]&&(H=N),N[0]>J[0]&&(J=N),N[1]<Y[1]&&(Y=N),N[1]>P[1]&&(P=N)}var A=[H,Y,J,P],O=A.slice();for(M=0;M<R.length;M++)o(R[M],A)||O.push(R[M]);return G(O)}function z(R,H){var Y={p:R,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return H?(Y.next=H.next,Y.prev=H,H.next.prev=Y,H.next=Y):(Y.prev=Y,Y.next=Y),Y}function et(R,H){var Y=R[0]-H[0],J=R[1]-H[1];return Y*Y+J*J}function ot(R,H,Y){var J=H[0],P=H[1],M=Y[0]-J,N=Y[1]-P;if(M!==0||N!==0){var A=((R[0]-J)*M+(R[1]-P)*N)/(M*M+N*N);A>1?(J=Y[0],P=Y[1]):A>0&&(J+=M*A,P+=N*A)}return M=R[0]-J,N=R[1]-P,M*M+N*N}function ut(R,H,Y,J,P,M,N,A){var O=Y-R,V=J-H,q=N-P,X=A-M,B=R-P,j=H-M,U=O*O+V*V,tt=O*q+V*X,W=q*q+X*X,rt=O*B+V*j,ht=q*B+X*j,mt=U*W-tt*tt,at,ct,ft,kt,Q=mt,Xt=mt;mt===0?(ct=0,Q=1,kt=ht,Xt=W):(ct=tt*ht-W*rt,kt=U*ht-tt*rt,ct<0?(ct=0,kt=ht,Xt=W):ct>Q&&(ct=Q,kt=ht+tt,Xt=W)),kt<0?(kt=0,-rt<0?ct=0:-rt>U?ct=Q:(ct=-rt,Q=U)):kt>Xt&&(kt=Xt,-rt+tt<0?ct=0:-rt+tt>U?ct=Q:(ct=-rt+tt,Q=U)),at=ct===0?0:ct/Q,ft=kt===0?0:kt/Xt;var Ct=(1-at)*R+at*Y,vt=(1-at)*H+at*J,Z=(1-ft)*P+ft*N,At=(1-ft)*M+ft*A,Gt=Z-Ct,Mt=At-vt;return Gt*Gt+Mt*Mt}function S(R,H){return R[0]===H[0]?R[1]-H[1]:R[0]-H[0]}function G(R){R.sort(S);for(var H=[],Y=0;Y<R.length;Y++){for(;H.length>=2&&w(H[H.length-2],H[H.length-1],R[Y])<=0;)H.pop();H.push(R[Y])}for(var J=[],P=R.length-1;P>=0;P--){for(;J.length>=2&&w(J[J.length-2],J[J.length-1],R[P])<=0;)J.pop();J.push(R[P])}return J.pop(),H.pop(),H.concat(J)}return Rs.exports}var vc=yc();const Du=vu(vc);function Za(h,i={}){i.concavity=i.concavity||1/0;const o=[];if(ii(h,l=>{o.push([l[0],l[1]])}),!o.length)return null;const a=Du(o,i.concavity);return a.length>3?he([a]):null}function Vo(h){if(!h)throw new Error("geojson is required");switch(h.type){case"Feature":return Fu(h);case"FeatureCollection":return _c(h);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Wo(h);default:throw new Error("unknown GeoJSON type")}}function Fu(h){const i={type:"Feature"};return Object.keys(h).forEach(o=>{switch(o){case"type":case"properties":case"geometry":return;default:i[o]=h[o]}}),i.properties=Bu(h.properties),h.geometry==null?i.geometry=null:i.geometry=Wo(h.geometry),i}function Bu(h){const i={};return h&&Object.keys(h).forEach(o=>{const a=h[o];typeof a=="object"?a===null?i[o]=null:Array.isArray(a)?i[o]=a.map(l=>l):i[o]=Bu(a):i[o]=a}),i}function _c(h){const i={type:"FeatureCollection"};return Object.keys(h).forEach(o=>{switch(o){case"type":case"features":return;default:i[o]=h[o]}}),i.features=h.features.map(o=>Fu(o)),i}function Wo(h){const i={type:h.type};return h.bbox&&(i.bbox=h.bbox),h.type==="GeometryCollection"?(i.geometries=h.geometries.map(o=>Wo(o)),i):(i.coordinates=zu(h.coordinates),i)}function zu(h){const i=h;return typeof i[0]!="object"?i.slice():i.map(o=>zu(o))}var xc=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,bo=Math.ceil,an=Math.floor,Ge="[BigNumber Error] ",Ua=Ge+"Number primitive has more than 15 significant digits: ",dn=1e14,Ft=14,Oo=9007199254740991,Ao=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],ni=1e7,_e=1e9;function Gu(h){var i,o,a,l=S.prototype={constructor:S,toString:null,valueOf:null},g=new S(1),d=20,m=4,_=-7,x=21,w=-1e7,I=1e7,b=!1,F=1,z=0,et={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},ot="0123456789abcdefghijklmnopqrstuvwxyz",ut=!0;function S(P,M){var N,A,O,V,q,X,B,j,U=this;if(!(U instanceof S))return new S(P,M);if(M==null){if(P&&P._isBigNumber===!0){U.s=P.s,!P.c||P.e>I?U.c=U.e=null:P.e<w?U.c=[U.e=0]:(U.e=P.e,U.c=P.c.slice());return}if((X=typeof P=="number")&&P*0==0){if(U.s=1/P<0?(P=-P,-1):1,P===~~P){for(V=0,q=P;q>=10;q/=10,V++);V>I?U.c=U.e=null:(U.e=V,U.c=[P]);return}j=String(P)}else{if(!xc.test(j=String(P)))return a(U,j,X);U.s=j.charCodeAt(0)==45?(j=j.slice(1),-1):1}(V=j.indexOf("."))>-1&&(j=j.replace(".","")),(q=j.search(/e/i))>0?(V<0&&(V=q),V+=+j.slice(q+1),j=j.substring(0,q)):V<0&&(V=j.length)}else{if(ne(M,2,ot.length,"Base"),M==10&&ut)return U=new S(P),Y(U,d+U.e+1,m);if(j=String(P),X=typeof P=="number"){if(P*0!=0)return a(U,j,X,M);if(U.s=1/P<0?(j=j.slice(1),-1):1,S.DEBUG&&j.replace(/^0\.0*|\./,"").length>15)throw Error(Ua+P)}else U.s=j.charCodeAt(0)===45?(j=j.slice(1),-1):1;for(N=ot.slice(0,M),V=q=0,B=j.length;q<B;q++)if(N.indexOf(A=j.charAt(q))<0){if(A=="."){if(q>V){V=B;continue}}else if(!O&&(j==j.toUpperCase()&&(j=j.toLowerCase())||j==j.toLowerCase()&&(j=j.toUpperCase()))){O=!0,q=-1,V=0;continue}return a(U,String(P),X,M)}X=!1,j=o(j,M,10,U.s),(V=j.indexOf("."))>-1?j=j.replace(".",""):V=j.length}for(q=0;j.charCodeAt(q)===48;q++);for(B=j.length;j.charCodeAt(--B)===48;);if(j=j.slice(q,++B)){if(B-=q,X&&S.DEBUG&&B>15&&(P>Oo||P!==an(P)))throw Error(Ua+U.s*P);if((V=V-q-1)>I)U.c=U.e=null;else if(V<w)U.c=[U.e=0];else{if(U.e=V,U.c=[],q=(V+1)%Ft,V<0&&(q+=Ft),q<B){for(q&&U.c.push(+j.slice(0,q)),B-=Ft;q<B;)U.c.push(+j.slice(q,q+=Ft));q=Ft-(j=j.slice(q)).length}else q-=B;for(;q--;j+="0");U.c.push(+j)}}else U.c=[U.e=0]}S.clone=Gu,S.ROUND_UP=0,S.ROUND_DOWN=1,S.ROUND_CEIL=2,S.ROUND_FLOOR=3,S.ROUND_HALF_UP=4,S.ROUND_HALF_DOWN=5,S.ROUND_HALF_EVEN=6,S.ROUND_HALF_CEIL=7,S.ROUND_HALF_FLOOR=8,S.EUCLID=9,S.config=S.set=function(P){var M,N;if(P!=null)if(typeof P=="object"){if(P.hasOwnProperty(M="DECIMAL_PLACES")&&(N=P[M],ne(N,0,_e,M),d=N),P.hasOwnProperty(M="ROUNDING_MODE")&&(N=P[M],ne(N,0,8,M),m=N),P.hasOwnProperty(M="EXPONENTIAL_AT")&&(N=P[M],N&&N.pop?(ne(N[0],-_e,0,M),ne(N[1],0,_e,M),_=N[0],x=N[1]):(ne(N,-_e,_e,M),_=-(x=N<0?-N:N))),P.hasOwnProperty(M="RANGE"))if(N=P[M],N&&N.pop)ne(N[0],-_e,-1,M),ne(N[1],1,_e,M),w=N[0],I=N[1];else if(ne(N,-_e,_e,M),N)w=-(I=N<0?-N:N);else throw Error(Ge+M+" cannot be zero: "+N);if(P.hasOwnProperty(M="CRYPTO"))if(N=P[M],N===!!N)if(N)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))b=N;else throw b=!N,Error(Ge+"crypto unavailable");else b=N;else throw Error(Ge+M+" not true or false: "+N);if(P.hasOwnProperty(M="MODULO_MODE")&&(N=P[M],ne(N,0,9,M),F=N),P.hasOwnProperty(M="POW_PRECISION")&&(N=P[M],ne(N,0,_e,M),z=N),P.hasOwnProperty(M="FORMAT"))if(N=P[M],typeof N=="object")et=N;else throw Error(Ge+M+" not an object: "+N);if(P.hasOwnProperty(M="ALPHABET"))if(N=P[M],typeof N=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(N))ut=N.slice(0,10)=="0123456789",ot=N;else throw Error(Ge+M+" invalid: "+N)}else throw Error(Ge+"Object expected: "+P);return{DECIMAL_PLACES:d,ROUNDING_MODE:m,EXPONENTIAL_AT:[_,x],RANGE:[w,I],CRYPTO:b,MODULO_MODE:F,POW_PRECISION:z,FORMAT:et,ALPHABET:ot}},S.isBigNumber=function(P){if(!P||P._isBigNumber!==!0)return!1;if(!S.DEBUG)return!0;var M,N,A=P.c,O=P.e,V=P.s;t:if({}.toString.call(A)=="[object Array]"){if((V===1||V===-1)&&O>=-_e&&O<=_e&&O===an(O)){if(A[0]===0){if(O===0&&A.length===1)return!0;break t}if(M=(O+1)%Ft,M<1&&(M+=Ft),String(A[0]).length==M){for(M=0;M<A.length;M++)if(N=A[M],N<0||N>=dn||N!==an(N))break t;if(N!==0)return!0}}}else if(A===null&&O===null&&(V===null||V===1||V===-1))return!0;throw Error(Ge+"Invalid BigNumber: "+P)},S.maximum=S.max=function(){return R(arguments,-1)},S.minimum=S.min=function(){return R(arguments,1)},S.random=function(){var P=9007199254740992,M=Math.random()*P&2097151?function(){return an(Math.random()*P)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(N){var A,O,V,q,X,B=0,j=[],U=new S(g);if(N==null?N=d:ne(N,0,_e),q=bo(N/Ft),b)if(crypto.getRandomValues){for(A=crypto.getRandomValues(new Uint32Array(q*=2));B<q;)X=A[B]*131072+(A[B+1]>>>11),X>=9e15?(O=crypto.getRandomValues(new Uint32Array(2)),A[B]=O[0],A[B+1]=O[1]):(j.push(X%1e14),B+=2);B=q/2}else if(crypto.randomBytes){for(A=crypto.randomBytes(q*=7);B<q;)X=(A[B]&31)*281474976710656+A[B+1]*1099511627776+A[B+2]*4294967296+A[B+3]*16777216+(A[B+4]<<16)+(A[B+5]<<8)+A[B+6],X>=9e15?crypto.randomBytes(7).copy(A,B):(j.push(X%1e14),B+=7);B=q/7}else throw b=!1,Error(Ge+"crypto unavailable");if(!b)for(;B<q;)X=M(),X<9e15&&(j[B++]=X%1e14);for(q=j[--B],N%=Ft,q&&N&&(X=Ao[Ft-N],j[B]=an(q/X)*X);j[B]===0;j.pop(),B--);if(B<0)j=[V=0];else{for(V=-1;j[0]===0;j.splice(0,1),V-=Ft);for(B=1,X=j[0];X>=10;X/=10,B++);B<Ft&&(V-=Ft-B)}return U.e=V,U.c=j,U}}(),S.sum=function(){for(var P=1,M=arguments,N=new S(M[0]);P<M.length;)N=N.plus(M[P++]);return N},o=function(){var P="0123456789";function M(N,A,O,V){for(var q,X=[0],B,j=0,U=N.length;j<U;){for(B=X.length;B--;X[B]*=A);for(X[0]+=V.indexOf(N.charAt(j++)),q=0;q<X.length;q++)X[q]>O-1&&(X[q+1]==null&&(X[q+1]=0),X[q+1]+=X[q]/O|0,X[q]%=O)}return X.reverse()}return function(N,A,O,V,q){var X,B,j,U,tt,W,rt,ht,mt=N.indexOf("."),at=d,ct=m;for(mt>=0&&(U=z,z=0,N=N.replace(".",""),ht=new S(A),W=ht.pow(N.length-mt),z=U,ht.c=M(zn(sn(W.c),W.e,"0"),10,O,P),ht.e=ht.c.length),rt=M(N,A,O,q?(X=ot,P):(X=P,ot)),j=U=rt.length;rt[--U]==0;rt.pop());if(!rt[0])return X.charAt(0);if(mt<0?--j:(W.c=rt,W.e=j,W.s=V,W=i(W,ht,at,ct,O),rt=W.c,tt=W.r,j=W.e),B=j+at+1,mt=rt[B],U=O/2,tt=tt||B<0||rt[B+1]!=null,tt=ct<4?(mt!=null||tt)&&(ct==0||ct==(W.s<0?3:2)):mt>U||mt==U&&(ct==4||tt||ct==6&&rt[B-1]&1||ct==(W.s<0?8:7)),B<1||!rt[0])N=tt?zn(X.charAt(1),-at,X.charAt(0)):X.charAt(0);else{if(rt.length=B,tt)for(--O;++rt[--B]>O;)rt[B]=0,B||(++j,rt=[1].concat(rt));for(U=rt.length;!rt[--U];);for(mt=0,N="";mt<=U;N+=X.charAt(rt[mt++]));N=zn(N,j,X.charAt(0))}return N}}(),i=function(){function P(A,O,V){var q,X,B,j,U=0,tt=A.length,W=O%ni,rt=O/ni|0;for(A=A.slice();tt--;)B=A[tt]%ni,j=A[tt]/ni|0,q=rt*B+j*W,X=W*B+q%ni*ni+U,U=(X/V|0)+(q/ni|0)+rt*j,A[tt]=X%V;return U&&(A=[U].concat(A)),A}function M(A,O,V,q){var X,B;if(V!=q)B=V>q?1:-1;else for(X=B=0;X<V;X++)if(A[X]!=O[X]){B=A[X]>O[X]?1:-1;break}return B}function N(A,O,V,q){for(var X=0;V--;)A[V]-=X,X=A[V]<O[V]?1:0,A[V]=X*q+A[V]-O[V];for(;!A[0]&&A.length>1;A.splice(0,1));}return function(A,O,V,q,X){var B,j,U,tt,W,rt,ht,mt,at,ct,ft,kt,Q,Xt,Ct,vt,Z,At=A.s==O.s?1:-1,Gt=A.c,Mt=O.c;if(!Gt||!Gt[0]||!Mt||!Mt[0])return new S(!A.s||!O.s||(Gt?Mt&&Gt[0]==Mt[0]:!Mt)?NaN:Gt&&Gt[0]==0||!Mt?At*0:At/0);for(mt=new S(At),at=mt.c=[],j=A.e-O.e,At=V+j+1,X||(X=dn,j=un(A.e/Ft)-un(O.e/Ft),At=At/Ft|0),U=0;Mt[U]==(Gt[U]||0);U++);if(Mt[U]>(Gt[U]||0)&&j--,At<0)at.push(1),tt=!0;else{for(Xt=Gt.length,vt=Mt.length,U=0,At+=2,W=an(X/(Mt[0]+1)),W>1&&(Mt=P(Mt,W,X),Gt=P(Gt,W,X),vt=Mt.length,Xt=Gt.length),Q=vt,ct=Gt.slice(0,vt),ft=ct.length;ft<vt;ct[ft++]=0);Z=Mt.slice(),Z=[0].concat(Z),Ct=Mt[0],Mt[1]>=X/2&&Ct++;do{if(W=0,B=M(Mt,ct,vt,ft),B<0){if(kt=ct[0],vt!=ft&&(kt=kt*X+(ct[1]||0)),W=an(kt/Ct),W>1)for(W>=X&&(W=X-1),rt=P(Mt,W,X),ht=rt.length,ft=ct.length;M(rt,ct,ht,ft)==1;)W--,N(rt,vt<ht?Z:Mt,ht,X),ht=rt.length,B=1;else W==0&&(B=W=1),rt=Mt.slice(),ht=rt.length;if(ht<ft&&(rt=[0].concat(rt)),N(ct,rt,ft,X),ft=ct.length,B==-1)for(;M(Mt,ct,vt,ft)<1;)W++,N(ct,vt<ft?Z:Mt,ft,X),ft=ct.length}else B===0&&(W++,ct=[0]);at[U++]=W,ct[0]?ct[ft++]=Gt[Q]||0:(ct=[Gt[Q]],ft=1)}while((Q++<Xt||ct[0]!=null)&&At--);tt=ct[0]!=null,at[0]||at.splice(0,1)}if(X==dn){for(U=1,At=at[0];At>=10;At/=10,U++);Y(mt,V+(mt.e=U+j*Ft-1)+1,q,tt)}else mt.e=j,mt.r=+tt;return mt}}();function G(P,M,N,A){var O,V,q,X,B;if(N==null?N=m:ne(N,0,8),!P.c)return P.toString();if(O=P.c[0],q=P.e,M==null)B=sn(P.c),B=A==1||A==2&&(q<=_||q>=x)?Fs(B,q):zn(B,q,"0");else if(P=Y(new S(P),M,N),V=P.e,B=sn(P.c),X=B.length,A==1||A==2&&(M<=V||V<=_)){for(;X<M;B+="0",X++);B=Fs(B,V)}else if(M-=q,B=zn(B,V,"0"),V+1>X){if(--M>0)for(B+=".";M--;B+="0");}else if(M+=V-X,M>0)for(V+1==X&&(B+=".");M--;B+="0");return P.s<0&&O?"-"+B:B}function R(P,M){for(var N,A,O=1,V=new S(P[0]);O<P.length;O++)A=new S(P[O]),(!A.s||(N=Ii(V,A))===M||N===0&&V.s===M)&&(V=A);return V}function H(P,M,N){for(var A=1,O=M.length;!M[--O];M.pop());for(O=M[0];O>=10;O/=10,A++);return(N=A+N*Ft-1)>I?P.c=P.e=null:N<w?P.c=[P.e=0]:(P.e=N,P.c=M),P}a=function(){var P=/^(-?)0([xbo])(?=\w[\w.]*$)/i,M=/^([^.]+)\.$/,N=/^\.([^.]+)$/,A=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(V,q,X,B){var j,U=X?q:q.replace(O,"");if(A.test(U))V.s=isNaN(U)?null:U<0?-1:1;else{if(!X&&(U=U.replace(P,function(tt,W,rt){return j=(rt=rt.toLowerCase())=="x"?16:rt=="b"?2:8,!B||B==j?W:tt}),B&&(j=B,U=U.replace(M,"$1").replace(N,"0.$1")),q!=U))return new S(U,j);if(S.DEBUG)throw Error(Ge+"Not a"+(B?" base "+B:"")+" number: "+q);V.s=null}V.c=V.e=null}}();function Y(P,M,N,A){var O,V,q,X,B,j,U,tt=P.c,W=Ao;if(tt){t:{for(O=1,X=tt[0];X>=10;X/=10,O++);if(V=M-O,V<0)V+=Ft,q=M,B=tt[j=0],U=an(B/W[O-q-1]%10);else if(j=bo((V+1)/Ft),j>=tt.length)if(A){for(;tt.length<=j;tt.push(0));B=U=0,O=1,V%=Ft,q=V-Ft+1}else break t;else{for(B=X=tt[j],O=1;X>=10;X/=10,O++);V%=Ft,q=V-Ft+O,U=q<0?0:an(B/W[O-q-1]%10)}if(A=A||M<0||tt[j+1]!=null||(q<0?B:B%W[O-q-1]),A=N<4?(U||A)&&(N==0||N==(P.s<0?3:2)):U>5||U==5&&(N==4||A||N==6&&(V>0?q>0?B/W[O-q]:0:tt[j-1])%10&1||N==(P.s<0?8:7)),M<1||!tt[0])return tt.length=0,A?(M-=P.e+1,tt[0]=W[(Ft-M%Ft)%Ft],P.e=-M||0):tt[0]=P.e=0,P;if(V==0?(tt.length=j,X=1,j--):(tt.length=j+1,X=W[Ft-V],tt[j]=q>0?an(B/W[O-q]%W[q])*X:0),A)for(;;)if(j==0){for(V=1,q=tt[0];q>=10;q/=10,V++);for(q=tt[0]+=X,X=1;q>=10;q/=10,X++);V!=X&&(P.e++,tt[0]==dn&&(tt[0]=1));break}else{if(tt[j]+=X,tt[j]!=dn)break;tt[j--]=0,X=1}for(V=tt.length;tt[--V]===0;tt.pop());}P.e>I?P.c=P.e=null:P.e<w&&(P.c=[P.e=0])}return P}function J(P){var M,N=P.e;return N===null?P.toString():(M=sn(P.c),M=N<=_||N>=x?Fs(M,N):zn(M,N,"0"),P.s<0?"-"+M:M)}return l.absoluteValue=l.abs=function(){var P=new S(this);return P.s<0&&(P.s=1),P},l.comparedTo=function(P,M){return Ii(this,new S(P,M))},l.decimalPlaces=l.dp=function(P,M){var N,A,O,V=this;if(P!=null)return ne(P,0,_e),M==null?M=m:ne(M,0,8),Y(new S(V),P+V.e+1,M);if(!(N=V.c))return null;if(A=((O=N.length-1)-un(this.e/Ft))*Ft,O=N[O])for(;O%10==0;O/=10,A--);return A<0&&(A=0),A},l.dividedBy=l.div=function(P,M){return i(this,new S(P,M),d,m)},l.dividedToIntegerBy=l.idiv=function(P,M){return i(this,new S(P,M),0,1)},l.exponentiatedBy=l.pow=function(P,M){var N,A,O,V,q,X,B,j,U,tt=this;if(P=new S(P),P.c&&!P.isInteger())throw Error(Ge+"Exponent not an integer: "+J(P));if(M!=null&&(M=new S(M)),X=P.e>14,!tt.c||!tt.c[0]||tt.c[0]==1&&!tt.e&&tt.c.length==1||!P.c||!P.c[0])return U=new S(Math.pow(+J(tt),X?P.s*(2-Ds(P)):+J(P))),M?U.mod(M):U;if(B=P.s<0,M){if(M.c?!M.c[0]:!M.s)return new S(NaN);A=!B&&tt.isInteger()&&M.isInteger(),A&&(tt=tt.mod(M))}else{if(P.e>9&&(tt.e>0||tt.e<-1||(tt.e==0?tt.c[0]>1||X&&tt.c[1]>=24e7:tt.c[0]<8e13||X&&tt.c[0]<=9999975e7)))return V=tt.s<0&&Ds(P)?-0:0,tt.e>-1&&(V=1/V),new S(B?1/V:V);z&&(V=bo(z/Ft+2))}for(X?(N=new S(.5),B&&(P.s=1),j=Ds(P)):(O=Math.abs(+J(P)),j=O%2),U=new S(g);;){if(j){if(U=U.times(tt),!U.c)break;V?U.c.length>V&&(U.c.length=V):A&&(U=U.mod(M))}if(O){if(O=an(O/2),O===0)break;j=O%2}else if(P=P.times(N),Y(P,P.e+1,1),P.e>14)j=Ds(P);else{if(O=+J(P),O===0)break;j=O%2}tt=tt.times(tt),V?tt.c&&tt.c.length>V&&(tt.c.length=V):A&&(tt=tt.mod(M))}return A?U:(B&&(U=g.div(U)),M?U.mod(M):V?Y(U,z,m,q):U)},l.integerValue=function(P){var M=new S(this);return P==null?P=m:ne(P,0,8),Y(M,M.e+1,P)},l.isEqualTo=l.eq=function(P,M){return Ii(this,new S(P,M))===0},l.isFinite=function(){return!!this.c},l.isGreaterThan=l.gt=function(P,M){return Ii(this,new S(P,M))>0},l.isGreaterThanOrEqualTo=l.gte=function(P,M){return(M=Ii(this,new S(P,M)))===1||M===0},l.isInteger=function(){return!!this.c&&un(this.e/Ft)>this.c.length-2},l.isLessThan=l.lt=function(P,M){return Ii(this,new S(P,M))<0},l.isLessThanOrEqualTo=l.lte=function(P,M){return(M=Ii(this,new S(P,M)))===-1||M===0},l.isNaN=function(){return!this.s},l.isNegative=function(){return this.s<0},l.isPositive=function(){return this.s>0},l.isZero=function(){return!!this.c&&this.c[0]==0},l.minus=function(P,M){var N,A,O,V,q=this,X=q.s;if(P=new S(P,M),M=P.s,!X||!M)return new S(NaN);if(X!=M)return P.s=-M,q.plus(P);var B=q.e/Ft,j=P.e/Ft,U=q.c,tt=P.c;if(!B||!j){if(!U||!tt)return U?(P.s=-M,P):new S(tt?q:NaN);if(!U[0]||!tt[0])return tt[0]?(P.s=-M,P):new S(U[0]?q:m==3?-0:0)}if(B=un(B),j=un(j),U=U.slice(),X=B-j){for((V=X<0)?(X=-X,O=U):(j=B,O=tt),O.reverse(),M=X;M--;O.push(0));O.reverse()}else for(A=(V=(X=U.length)<(M=tt.length))?X:M,X=M=0;M<A;M++)if(U[M]!=tt[M]){V=U[M]<tt[M];break}if(V&&(O=U,U=tt,tt=O,P.s=-P.s),M=(A=tt.length)-(N=U.length),M>0)for(;M--;U[N++]=0);for(M=dn-1;A>X;){if(U[--A]<tt[A]){for(N=A;N&&!U[--N];U[N]=M);--U[N],U[A]+=dn}U[A]-=tt[A]}for(;U[0]==0;U.splice(0,1),--j);return U[0]?H(P,U,j):(P.s=m==3?-1:1,P.c=[P.e=0],P)},l.modulo=l.mod=function(P,M){var N,A,O=this;return P=new S(P,M),!O.c||!P.s||P.c&&!P.c[0]?new S(NaN):!P.c||O.c&&!O.c[0]?new S(O):(F==9?(A=P.s,P.s=1,N=i(O,P,0,3),P.s=A,N.s*=A):N=i(O,P,0,F),P=O.minus(N.times(P)),!P.c[0]&&F==1&&(P.s=O.s),P)},l.multipliedBy=l.times=function(P,M){var N,A,O,V,q,X,B,j,U,tt,W,rt,ht,mt,at,ct=this,ft=ct.c,kt=(P=new S(P,M)).c;if(!ft||!kt||!ft[0]||!kt[0])return!ct.s||!P.s||ft&&!ft[0]&&!kt||kt&&!kt[0]&&!ft?P.c=P.e=P.s=null:(P.s*=ct.s,!ft||!kt?P.c=P.e=null:(P.c=[0],P.e=0)),P;for(A=un(ct.e/Ft)+un(P.e/Ft),P.s*=ct.s,B=ft.length,tt=kt.length,B<tt&&(ht=ft,ft=kt,kt=ht,O=B,B=tt,tt=O),O=B+tt,ht=[];O--;ht.push(0));for(mt=dn,at=ni,O=tt;--O>=0;){for(N=0,W=kt[O]%at,rt=kt[O]/at|0,q=B,V=O+q;V>O;)j=ft[--q]%at,U=ft[q]/at|0,X=rt*j+U*W,j=W*j+X%at*at+ht[V]+N,N=(j/mt|0)+(X/at|0)+rt*U,ht[V--]=j%mt;ht[V]=N}return N?++A:ht.splice(0,1),H(P,ht,A)},l.negated=function(){var P=new S(this);return P.s=-P.s||null,P},l.plus=function(P,M){var N,A=this,O=A.s;if(P=new S(P,M),M=P.s,!O||!M)return new S(NaN);if(O!=M)return P.s=-M,A.minus(P);var V=A.e/Ft,q=P.e/Ft,X=A.c,B=P.c;if(!V||!q){if(!X||!B)return new S(O/0);if(!X[0]||!B[0])return B[0]?P:new S(X[0]?A:O*0)}if(V=un(V),q=un(q),X=X.slice(),O=V-q){for(O>0?(q=V,N=B):(O=-O,N=X),N.reverse();O--;N.push(0));N.reverse()}for(O=X.length,M=B.length,O-M<0&&(N=B,B=X,X=N,M=O),O=0;M;)O=(X[--M]=X[M]+B[M]+O)/dn|0,X[M]=dn===X[M]?0:X[M]%dn;return O&&(X=[O].concat(X),++q),H(P,X,q)},l.precision=l.sd=function(P,M){var N,A,O,V=this;if(P!=null&&P!==!!P)return ne(P,1,_e),M==null?M=m:ne(M,0,8),Y(new S(V),P,M);if(!(N=V.c))return null;if(O=N.length-1,A=O*Ft+1,O=N[O]){for(;O%10==0;O/=10,A--);for(O=N[0];O>=10;O/=10,A++);}return P&&V.e+1>A&&(A=V.e+1),A},l.shiftedBy=function(P){return ne(P,-Oo,Oo),this.times("1e"+P)},l.squareRoot=l.sqrt=function(){var P,M,N,A,O,V=this,q=V.c,X=V.s,B=V.e,j=d+4,U=new S("0.5");if(X!==1||!q||!q[0])return new S(!X||X<0&&(!q||q[0])?NaN:q?V:1/0);if(X=Math.sqrt(+J(V)),X==0||X==1/0?(M=sn(q),(M.length+B)%2==0&&(M+="0"),X=Math.sqrt(+M),B=un((B+1)/2)-(B<0||B%2),X==1/0?M="5e"+B:(M=X.toExponential(),M=M.slice(0,M.indexOf("e")+1)+B),N=new S(M)):N=new S(X+""),N.c[0]){for(B=N.e,X=B+j,X<3&&(X=0);;)if(O=N,N=U.times(O.plus(i(V,O,j,1))),sn(O.c).slice(0,X)===(M=sn(N.c)).slice(0,X))if(N.e<B&&--X,M=M.slice(X-3,X+1),M=="9999"||!A&&M=="4999"){if(!A&&(Y(O,O.e+d+2,0),O.times(O).eq(V))){N=O;break}j+=4,X+=4,A=1}else{(!+M||!+M.slice(1)&&M.charAt(0)=="5")&&(Y(N,N.e+d+2,1),P=!N.times(N).eq(V));break}}return Y(N,N.e+d+1,m,P)},l.toExponential=function(P,M){return P!=null&&(ne(P,0,_e),P++),G(this,P,M,1)},l.toFixed=function(P,M){return P!=null&&(ne(P,0,_e),P=P+this.e+1),G(this,P,M)},l.toFormat=function(P,M,N){var A,O=this;if(N==null)P!=null&&M&&typeof M=="object"?(N=M,M=null):P&&typeof P=="object"?(N=P,P=M=null):N=et;else if(typeof N!="object")throw Error(Ge+"Argument not an object: "+N);if(A=O.toFixed(P,M),O.c){var V,q=A.split("."),X=+N.groupSize,B=+N.secondaryGroupSize,j=N.groupSeparator||"",U=q[0],tt=q[1],W=O.s<0,rt=W?U.slice(1):U,ht=rt.length;if(B&&(V=X,X=B,B=V,ht-=V),X>0&&ht>0){for(V=ht%X||X,U=rt.substr(0,V);V<ht;V+=X)U+=j+rt.substr(V,X);B>0&&(U+=j+rt.slice(V)),W&&(U="-"+U)}A=tt?U+(N.decimalSeparator||"")+((B=+N.fractionGroupSize)?tt.replace(new RegExp("\\d{"+B+"}\\B","g"),"$&"+(N.fractionGroupSeparator||"")):tt):U}return(N.prefix||"")+A+(N.suffix||"")},l.toFraction=function(P){var M,N,A,O,V,q,X,B,j,U,tt,W,rt=this,ht=rt.c;if(P!=null&&(X=new S(P),!X.isInteger()&&(X.c||X.s!==1)||X.lt(g)))throw Error(Ge+"Argument "+(X.isInteger()?"out of range: ":"not an integer: ")+J(X));if(!ht)return new S(rt);for(M=new S(g),j=N=new S(g),A=B=new S(g),W=sn(ht),V=M.e=W.length-rt.e-1,M.c[0]=Ao[(q=V%Ft)<0?Ft+q:q],P=!P||X.comparedTo(M)>0?V>0?M:j:X,q=I,I=1/0,X=new S(W),B.c[0]=0;U=i(X,M,0,1),O=N.plus(U.times(A)),O.comparedTo(P)!=1;)N=A,A=O,j=B.plus(U.times(O=j)),B=O,M=X.minus(U.times(O=M)),X=O;return O=i(P.minus(N),A,0,1),B=B.plus(O.times(j)),N=N.plus(O.times(A)),B.s=j.s=rt.s,V=V*2,tt=i(j,A,V,m).minus(rt).abs().comparedTo(i(B,N,V,m).minus(rt).abs())<1?[j,A]:[B,N],I=q,tt},l.toNumber=function(){return+J(this)},l.toPrecision=function(P,M){return P!=null&&ne(P,1,_e),G(this,P,M,2)},l.toString=function(P){var M,N=this,A=N.s,O=N.e;return O===null?A?(M="Infinity",A<0&&(M="-"+M)):M="NaN":(P==null?M=O<=_||O>=x?Fs(sn(N.c),O):zn(sn(N.c),O,"0"):P===10&&ut?(N=Y(new S(N),d+O+1,m),M=zn(sn(N.c),N.e,"0")):(ne(P,2,ot.length,"Base"),M=o(zn(sn(N.c),O,"0"),10,P,A,!0)),A<0&&N.c[0]&&(M="-"+M)),M},l.valueOf=l.toJSON=function(){return J(this)},l._isBigNumber=!0,l[Symbol.toStringTag]="BigNumber",l[Symbol.for("nodejs.util.inspect.custom")]=l.valueOf,h!=null&&S.set(h),S}function un(h){var i=h|0;return h>0||h===i?i:i-1}function sn(h){for(var i,o,a=1,l=h.length,g=h[0]+"";a<l;){for(i=h[a++]+"",o=Ft-i.length;o--;i="0"+i);g+=i}for(l=g.length;g.charCodeAt(--l)===48;);return g.slice(0,l+1||1)}function Ii(h,i){var o,a,l=h.c,g=i.c,d=h.s,m=i.s,_=h.e,x=i.e;if(!d||!m)return null;if(o=l&&!l[0],a=g&&!g[0],o||a)return o?a?0:-m:d;if(d!=m)return d;if(o=d<0,a=_==x,!l||!g)return a?0:!l^o?1:-1;if(!a)return _>x^o?1:-1;for(m=(_=l.length)<(x=g.length)?_:x,d=0;d<m;d++)if(l[d]!=g[d])return l[d]>g[d]^o?1:-1;return _==x?0:_>x^o?1:-1}function ne(h,i,o,a){if(h<i||h>o||h!==an(h))throw Error(Ge+(a||"Argument")+(typeof h=="number"?h<i||h>o?" out of range: ":" not an integer: ":" not a primitive number: ")+String(h))}function Ds(h){var i=h.c.length-1;return un(h.e/Ft)==i&&h.c[i]%2!=0}function Fs(h,i){return(h.length>1?h.charAt(0)+"."+h.slice(1):h)+(i<0?"e":"e+")+i}function zn(h,i,o){var a,l;if(i<0){for(l=o+".";++i;l+=o);h=l+h}else if(a=h.length,++i>a){for(l=o,i-=a;--i;l+=o);h+=l}else i<a&&(h=h.slice(0,i)+"."+h.slice(i));return h}var Cn=Gu(),kc=class{constructor(h){lt(this,"key"),lt(this,"left",null),lt(this,"right",null),this.key=h}},Hr=class extends kc{constructor(h){super(h)}},wc=class{constructor(){lt(this,"size",0),lt(this,"modificationCount",0),lt(this,"splayCount",0)}splay(h){const i=this.root;if(i==null)return this.compare(h,h),-1;let o=null,a=null,l=null,g=null,d=i;const m=this.compare;let _;for(;;)if(_=m(d.key,h),_>0){let x=d.left;if(x==null||(_=m(x.key,h),_>0&&(d.left=x.right,x.right=d,d=x,x=d.left,x==null)))break;o==null?a=d:o.left=d,o=d,d=x}else if(_<0){let x=d.right;if(x==null||(_=m(x.key,h),_<0&&(d.right=x.left,x.left=d,d=x,x=d.right,x==null)))break;l==null?g=d:l.right=d,l=d,d=x}else break;return l!=null&&(l.right=d.left,d.left=g),o!=null&&(o.left=d.right,d.right=a),this.root!==d&&(this.root=d,this.splayCount++),_}splayMin(h){let i=h,o=i.left;for(;o!=null;){const a=o;i.left=a.right,a.right=i,i=a,o=i.left}return i}splayMax(h){let i=h,o=i.right;for(;o!=null;){const a=o;i.right=a.left,a.left=i,i=a,o=i.right}return i}_delete(h){if(this.root==null||this.splay(h)!=0)return null;let o=this.root;const a=o,l=o.left;if(this.size--,l==null)this.root=o.right;else{const g=o.right;o=this.splayMax(l),o.right=g,this.root=o}return this.modificationCount++,a}addNewRoot(h,i){this.size++,this.modificationCount++;const o=this.root;if(o==null){this.root=h;return}i<0?(h.left=o,h.right=o.right,o.right=null):(h.right=o,h.left=o.left,o.left=null),this.root=h}_first(){const h=this.root;return h==null?null:(this.root=this.splayMin(h),this.root)}_last(){const h=this.root;return h==null?null:(this.root=this.splayMax(h),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(h){return this.validKey(h)&&this.splay(h)==0}defaultCompare(){return(h,i)=>h<i?-1:h>i?1:0}wrap(){return{getRoot:()=>this.root,setRoot:h=>{this.root=h},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:h=>{this.splayCount=h},splay:h=>this.splay(h),has:h=>this.has(h)}}},Qs=class jr extends wc{constructor(i,o){super(),lt(this,"root",null),lt(this,"compare"),lt(this,"validKey"),lt(this,aa,"[object Set]"),this.compare=i??this.defaultCompare(),this.validKey=o??(a=>a!=null&&a!=null)}delete(i){return this.validKey(i)?this._delete(i)!=null:!1}deleteAll(i){for(const o of i)this.delete(o)}forEach(i){const o=this[Symbol.iterator]();let a;for(;a=o.next(),!a.done;)i(a.value,a.value,this)}add(i){const o=this.splay(i);return o!=0&&this.addNewRoot(new Hr(i),o),this}addAndReturn(i){const o=this.splay(i);return o!=0&&this.addNewRoot(new Hr(i),o),this.root.key}addAll(i){for(const o of i)this.add(o)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(i){if(i==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(i)<0)return this.root.key;let a=this.root.left;if(a==null)return null;let l=a.right;for(;l!=null;)a=l,l=a.right;return a.key}firstAfter(i){if(i==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(i)>0)return this.root.key;let a=this.root.right;if(a==null)return null;let l=a.left;for(;l!=null;)a=l,l=a.left;return a.key}retainAll(i){const o=new jr(this.compare,this.validKey),a=this.modificationCount;for(const l of i){if(a!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(l)&&this.splay(l)==0&&o.add(this.root.key)}o.size!=this.size&&(this.root=o.root,this.size=o.size,this.modificationCount++)}lookup(i){return!this.validKey(i)||this.splay(i)!=0?null:this.root.key}intersection(i){const o=new jr(this.compare,this.validKey);for(const a of this)i.has(a)&&o.add(a);return o}difference(i){const o=new jr(this.compare,this.validKey);for(const a of this)i.has(a)||o.add(a);return o}union(i){const o=this.clone();return o.addAll(i),o}clone(){const i=new jr(this.compare,this.validKey);return i.size=this.size,i.root=this.copyNode(this.root),i}copyNode(i){if(i==null)return null;function o(l,g){let d,m;do{if(d=l.left,m=l.right,d!=null){const _=new Hr(d.key);g.left=_,o(d,_)}if(m!=null){const _=new Hr(m.key);g.right=_,l=m,g=_}}while(m!=null)}const a=new Hr(i.key);return o(i,a),a}toSet(){return this.clone()}entries(){return new Pc(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(ua=Symbol.iterator,aa=Symbol.toStringTag,ua)](){return new Ec(this.wrap())}},qu=class{constructor(h){lt(this,"tree"),lt(this,"path",new Array),lt(this,"modificationCount",null),lt(this,"splayCount"),this.tree=h,this.splayCount=h.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const h=this.path[this.path.length-1];return this.getValue(h)}rebuildPath(h){this.path.splice(0,this.path.length),this.tree.splay(h),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(h){for(;h!=null;)this.path.push(h),h=h.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let o=this.tree.getRoot();for(;o!=null;)this.path.push(o),o=o.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let h=this.path[this.path.length-1],i=h.right;if(i!=null){for(;i!=null;)this.path.push(i),i=i.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===h;)h=this.path.pop();return this.path.length>0}},Ec=class extends qu{getValue(h){return h.key}},Pc=class extends qu{getValue(h){return[h.key,h.key]}},Hu=h=>()=>h,Ho=h=>{const i=h?(o,a)=>a.minus(o).abs().isLessThanOrEqualTo(h):Hu(!1);return(o,a)=>i(o,a)?0:o.comparedTo(a)};function Ic(h){const i=h?(o,a,l,g,d)=>o.exponentiatedBy(2).isLessThanOrEqualTo(g.minus(a).exponentiatedBy(2).plus(d.minus(l).exponentiatedBy(2)).times(h)):Hu(!1);return(o,a,l)=>{const g=o.x,d=o.y,m=l.x,_=l.y,x=d.minus(_).times(a.x.minus(m)).minus(g.minus(m).times(a.y.minus(_)));return i(x,g,d,m,_)?0:x.comparedTo(0)}}var Lc=h=>h,Mc=h=>{if(h){const i=new Qs(Ho(h)),o=new Qs(Ho(h)),a=(g,d)=>d.addAndReturn(g),l=g=>({x:a(g.x,i),y:a(g.y,o)});return l({x:new Cn(0),y:new Cn(0)}),l}return Lc},Zo=h=>({set:i=>{Hn=Zo(i)},reset:()=>Zo(h),compare:Ho(h),snap:Mc(h),orient:Ic(h)}),Hn=Zo(),Zr=(h,i)=>h.ll.x.isLessThanOrEqualTo(i.x)&&i.x.isLessThanOrEqualTo(h.ur.x)&&h.ll.y.isLessThanOrEqualTo(i.y)&&i.y.isLessThanOrEqualTo(h.ur.y),Uo=(h,i)=>{if(i.ur.x.isLessThan(h.ll.x)||h.ur.x.isLessThan(i.ll.x)||i.ur.y.isLessThan(h.ll.y)||h.ur.y.isLessThan(i.ll.y))return null;const o=h.ll.x.isLessThan(i.ll.x)?i.ll.x:h.ll.x,a=h.ur.x.isLessThan(i.ur.x)?h.ur.x:i.ur.x,l=h.ll.y.isLessThan(i.ll.y)?i.ll.y:h.ll.y,g=h.ur.y.isLessThan(i.ur.y)?h.ur.y:i.ur.y;return{ll:{x:o,y:l},ur:{x:a,y:g}}},Zs=(h,i)=>h.x.times(i.y).minus(h.y.times(i.x)),Zu=(h,i)=>h.x.times(i.x).plus(h.y.times(i.y)),to=h=>Zu(h,h).sqrt(),Sc=(h,i,o)=>{const a={x:i.x.minus(h.x),y:i.y.minus(h.y)},l={x:o.x.minus(h.x),y:o.y.minus(h.y)};return Zs(l,a).div(to(l)).div(to(a))},Cc=(h,i,o)=>{const a={x:i.x.minus(h.x),y:i.y.minus(h.y)},l={x:o.x.minus(h.x),y:o.y.minus(h.y)};return Zu(l,a).div(to(l)).div(to(a))},Ya=(h,i,o)=>i.y.isZero()?null:{x:h.x.plus(i.x.div(i.y).times(o.minus(h.y))),y:o},Xa=(h,i,o)=>i.x.isZero()?null:{x:o,y:h.y.plus(i.y.div(i.x).times(o.minus(h.x)))},Tc=(h,i,o,a)=>{if(i.x.isZero())return Xa(o,a,h.x);if(a.x.isZero())return Xa(h,i,o.x);if(i.y.isZero())return Ya(o,a,h.y);if(a.y.isZero())return Ya(h,i,o.y);const l=Zs(i,a);if(l.isZero())return null;const g={x:o.x.minus(h.x),y:o.y.minus(h.y)},d=Zs(g,i).div(l),m=Zs(g,a).div(l),_=h.x.plus(m.times(i.x)),x=o.x.plus(d.times(a.x)),w=h.y.plus(m.times(i.y)),I=o.y.plus(d.times(a.y)),b=_.plus(x).div(2),F=w.plus(I).div(2);return{x:b,y:F}},Ln=class Uu{constructor(i,o){lt(this,"point"),lt(this,"isLeft"),lt(this,"segment"),lt(this,"otherSE"),lt(this,"consumedBy"),i.events===void 0?i.events=[this]:i.events.push(this),this.point=i,this.isLeft=o}static compare(i,o){const a=Uu.comparePoints(i.point,o.point);return a!==0?a:(i.point!==o.point&&i.link(o),i.isLeft!==o.isLeft?i.isLeft?1:-1:eo.compare(i.segment,o.segment))}static comparePoints(i,o){return i.x.isLessThan(o.x)?-1:i.x.isGreaterThan(o.x)?1:i.y.isLessThan(o.y)?-1:i.y.isGreaterThan(o.y)?1:0}link(i){if(i.point===this.point)throw new Error("Tried to link already linked events");const o=i.point.events;for(let a=0,l=o.length;a<l;a++){const g=o[a];this.point.events.push(g),g.point=this.point}this.checkForConsuming()}checkForConsuming(){const i=this.point.events.length;for(let o=0;o<i;o++){const a=this.point.events[o];if(a.segment.consumedBy===void 0)for(let l=o+1;l<i;l++){const g=this.point.events[l];g.consumedBy===void 0&&a.otherSE.point.events===g.otherSE.point.events&&a.segment.consume(g.segment)}}}getAvailableLinkedEvents(){const i=[];for(let o=0,a=this.point.events.length;o<a;o++){const l=this.point.events[o];l!==this&&!l.segment.ringOut&&l.segment.isInResult()&&i.push(l)}return i}getLeftmostComparator(i){const o=new Map,a=l=>{const g=l.otherSE;o.set(l,{sine:Sc(this.point,i.point,g.point),cosine:Cc(this.point,i.point,g.point)})};return(l,g)=>{o.has(l)||a(l),o.has(g)||a(g);const{sine:d,cosine:m}=o.get(l),{sine:_,cosine:x}=o.get(g);return d.isGreaterThanOrEqualTo(0)&&_.isGreaterThanOrEqualTo(0)?m.isLessThan(x)?1:m.isGreaterThan(x)?-1:0:d.isLessThan(0)&&_.isLessThan(0)?m.isLessThan(x)?-1:m.isGreaterThan(x)?1:0:_.isLessThan(d)?-1:_.isGreaterThan(d)?1:0}}},Nc=class Yo{constructor(i){lt(this,"events"),lt(this,"poly"),lt(this,"_isExteriorRing"),lt(this,"_enclosingRing"),this.events=i;for(let o=0,a=i.length;o<a;o++)i[o].segment.ringOut=this;this.poly=null}static factory(i){const o=[];for(let a=0,l=i.length;a<l;a++){const g=i[a];if(!g.isInResult()||g.ringOut)continue;let d=null,m=g.leftSE,_=g.rightSE;const x=[m],w=m.point,I=[];for(;d=m,m=_,x.push(m),m.point!==w;)for(;;){const b=m.getAvailableLinkedEvents();if(b.length===0){const et=x[0].point,ot=x[x.length-1].point;throw new Error(`Unable to complete output ring starting at [${et.x}, ${et.y}]. Last matching segment found ends at [${ot.x}, ${ot.y}].`)}if(b.length===1){_=b[0].otherSE;break}let F=null;for(let et=0,ot=I.length;et<ot;et++)if(I[et].point===m.point){F=et;break}if(F!==null){const et=I.splice(F)[0],ot=x.splice(et.index);ot.unshift(ot[0].otherSE),o.push(new Yo(ot.reverse()));continue}I.push({index:x.length,point:m.point});const z=m.getLeftmostComparator(d);_=b.sort(z)[0].otherSE;break}o.push(new Yo(x))}return o}getGeom(){let i=this.events[0].point;const o=[i];for(let x=1,w=this.events.length-1;x<w;x++){const I=this.events[x].point,b=this.events[x+1].point;Hn.orient(I,i,b)!==0&&(o.push(I),i=I)}if(o.length===1)return null;const a=o[0],l=o[1];Hn.orient(a,i,l)===0&&o.shift(),o.push(o[0]);const g=this.isExteriorRing()?1:-1,d=this.isExteriorRing()?0:o.length-1,m=this.isExteriorRing()?o.length:-1,_=[];for(let x=d;x!=m;x+=g)_.push([o[x].x.toNumber(),o[x].y.toNumber()]);return _}isExteriorRing(){if(this._isExteriorRing===void 0){const i=this.enclosingRing();this._isExteriorRing=i?!i.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var i,o;let a=this.events[0];for(let d=1,m=this.events.length;d<m;d++){const _=this.events[d];Ln.compare(a,_)>0&&(a=_)}let l=a.segment.prevInResult(),g=l?l.prevInResult():null;for(;;){if(!l)return null;if(!g)return l.ringOut;if(g.ringOut!==l.ringOut)return((i=g.ringOut)==null?void 0:i.enclosingRing())!==l.ringOut?l.ringOut:(o=l.ringOut)==null?void 0:o.enclosingRing();l=g.prevInResult(),g=l?l.prevInResult():null}}},Va=class{constructor(h){lt(this,"exteriorRing"),lt(this,"interiorRings"),this.exteriorRing=h,h.poly=this,this.interiorRings=[]}addInterior(h){this.interiorRings.push(h),h.poly=this}getGeom(){const h=this.exteriorRing.getGeom();if(h===null)return null;const i=[h];for(let o=0,a=this.interiorRings.length;o<a;o++){const l=this.interiorRings[o].getGeom();l!==null&&i.push(l)}return i}},bc=class{constructor(h){lt(this,"rings"),lt(this,"polys"),this.rings=h,this.polys=this._composePolys(h)}getGeom(){const h=[];for(let i=0,o=this.polys.length;i<o;i++){const a=this.polys[i].getGeom();a!==null&&h.push(a)}return h}_composePolys(h){var i;const o=[];for(let a=0,l=h.length;a<l;a++){const g=h[a];if(!g.poly)if(g.isExteriorRing())o.push(new Va(g));else{const d=g.enclosingRing();d!=null&&d.poly||o.push(new Va(d)),(i=d==null?void 0:d.poly)==null||i.addInterior(g)}}return o}},Oc=class{constructor(h,i=eo.compare){lt(this,"queue"),lt(this,"tree"),lt(this,"segments"),this.queue=h,this.tree=new Qs(i),this.segments=[]}process(h){const i=h.segment,o=[];if(h.consumedBy)return h.isLeft?this.queue.delete(h.otherSE):this.tree.delete(i),o;h.isLeft&&this.tree.add(i);let a=i,l=i;do a=this.tree.lastBefore(a);while(a!=null&&a.consumedBy!=null);do l=this.tree.firstAfter(l);while(l!=null&&l.consumedBy!=null);if(h.isLeft){let g=null;if(a){const m=a.getIntersection(i);if(m!==null&&(i.isAnEndpoint(m)||(g=m),!a.isAnEndpoint(m))){const _=this._splitSafely(a,m);for(let x=0,w=_.length;x<w;x++)o.push(_[x])}}let d=null;if(l){const m=l.getIntersection(i);if(m!==null&&(i.isAnEndpoint(m)||(d=m),!l.isAnEndpoint(m))){const _=this._splitSafely(l,m);for(let x=0,w=_.length;x<w;x++)o.push(_[x])}}if(g!==null||d!==null){let m=null;g===null?m=d:d===null?m=g:m=Ln.comparePoints(g,d)<=0?g:d,this.queue.delete(i.rightSE),o.push(i.rightSE);const _=i.split(m);for(let x=0,w=_.length;x<w;x++)o.push(_[x])}o.length>0?(this.tree.delete(i),o.push(h)):(this.segments.push(i),i.prev=a)}else{if(a&&l){const g=a.getIntersection(l);if(g!==null){if(!a.isAnEndpoint(g)){const d=this._splitSafely(a,g);for(let m=0,_=d.length;m<_;m++)o.push(d[m])}if(!l.isAnEndpoint(g)){const d=this._splitSafely(l,g);for(let m=0,_=d.length;m<_;m++)o.push(d[m])}}}this.tree.delete(i)}return o}_splitSafely(h,i){this.tree.delete(h);const o=h.rightSE;this.queue.delete(o);const a=h.split(i);return a.push(o),h.consumedBy===void 0&&this.tree.add(h),a}},Ac=class{constructor(){lt(this,"type"),lt(this,"numMultiPolys")}run(h,i,o){$r.type=h;const a=[new Ka(i,!0)];for(let x=0,w=o.length;x<w;x++)a.push(new Ka(o[x],!1));if($r.numMultiPolys=a.length,$r.type==="difference"){const x=a[0];let w=1;for(;w<a.length;)Uo(a[w].bbox,x.bbox)!==null?w++:a.splice(w,1)}if($r.type==="intersection")for(let x=0,w=a.length;x<w;x++){const I=a[x];for(let b=x+1,F=a.length;b<F;b++)if(Uo(I.bbox,a[b].bbox)===null)return[]}const l=new Qs(Ln.compare);for(let x=0,w=a.length;x<w;x++){const I=a[x].getSweepEvents();for(let b=0,F=I.length;b<F;b++)l.add(I[b])}const g=new Oc(l);let d=null;for(l.size!=0&&(d=l.first(),l.delete(d));d;){const x=g.process(d);for(let w=0,I=x.length;w<I;w++){const b=x[w];b.consumedBy===void 0&&l.add(b)}l.size!=0?(d=l.first(),l.delete(d)):d=null}Hn.reset();const m=Nc.factory(g.segments);return new bc(m).getGeom()}},$r=new Ac,is=$r,Rc=0,eo=class Us{constructor(i,o,a,l){lt(this,"id"),lt(this,"leftSE"),lt(this,"rightSE"),lt(this,"rings"),lt(this,"windings"),lt(this,"ringOut"),lt(this,"consumedBy"),lt(this,"prev"),lt(this,"_prevInResult"),lt(this,"_beforeState"),lt(this,"_afterState"),lt(this,"_isInResult"),this.id=++Rc,this.leftSE=i,i.segment=this,i.otherSE=o,this.rightSE=o,o.segment=this,o.otherSE=i,this.rings=a,this.windings=l}static compare(i,o){const a=i.leftSE.point.x,l=o.leftSE.point.x,g=i.rightSE.point.x,d=o.rightSE.point.x;if(d.isLessThan(a))return 1;if(g.isLessThan(l))return-1;const m=i.leftSE.point.y,_=o.leftSE.point.y,x=i.rightSE.point.y,w=o.rightSE.point.y;if(a.isLessThan(l)){if(_.isLessThan(m)&&_.isLessThan(x))return 1;if(_.isGreaterThan(m)&&_.isGreaterThan(x))return-1;const I=i.comparePoint(o.leftSE.point);if(I<0)return 1;if(I>0)return-1;const b=o.comparePoint(i.rightSE.point);return b!==0?b:-1}if(a.isGreaterThan(l)){if(m.isLessThan(_)&&m.isLessThan(w))return-1;if(m.isGreaterThan(_)&&m.isGreaterThan(w))return 1;const I=o.comparePoint(i.leftSE.point);if(I!==0)return I;const b=i.comparePoint(o.rightSE.point);return b<0?1:b>0?-1:1}if(m.isLessThan(_))return-1;if(m.isGreaterThan(_))return 1;if(g.isLessThan(d)){const I=o.comparePoint(i.rightSE.point);if(I!==0)return I}if(g.isGreaterThan(d)){const I=i.comparePoint(o.rightSE.point);if(I<0)return 1;if(I>0)return-1}if(!g.eq(d)){const I=x.minus(m),b=g.minus(a),F=w.minus(_),z=d.minus(l);if(I.isGreaterThan(b)&&F.isLessThan(z))return 1;if(I.isLessThan(b)&&F.isGreaterThan(z))return-1}return g.isGreaterThan(d)?1:g.isLessThan(d)||x.isLessThan(w)?-1:x.isGreaterThan(w)?1:i.id<o.id?-1:i.id>o.id?1:0}static fromRing(i,o,a){let l,g,d;const m=Ln.comparePoints(i,o);if(m<0)l=i,g=o,d=1;else if(m>0)l=o,g=i,d=-1;else throw new Error(`Tried to create degenerate segment at [${i.x}, ${i.y}]`);const _=new Ln(l,!0),x=new Ln(g,!1);return new Us(_,x,[a],[d])}replaceRightSE(i){this.rightSE=i,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const i=this.leftSE.point.y,o=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:i.isLessThan(o)?i:o},ur:{x:this.rightSE.point.x,y:i.isGreaterThan(o)?i:o}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(i){return i.x.eq(this.leftSE.point.x)&&i.y.eq(this.leftSE.point.y)||i.x.eq(this.rightSE.point.x)&&i.y.eq(this.rightSE.point.y)}comparePoint(i){return Hn.orient(this.leftSE.point,i,this.rightSE.point)}getIntersection(i){const o=this.bbox(),a=i.bbox(),l=Uo(o,a);if(l===null)return null;const g=this.leftSE.point,d=this.rightSE.point,m=i.leftSE.point,_=i.rightSE.point,x=Zr(o,m)&&this.comparePoint(m)===0,w=Zr(a,g)&&i.comparePoint(g)===0,I=Zr(o,_)&&this.comparePoint(_)===0,b=Zr(a,d)&&i.comparePoint(d)===0;if(w&&x)return b&&!I?d:!b&&I?_:null;if(w)return I&&g.x.eq(_.x)&&g.y.eq(_.y)?null:g;if(x)return b&&d.x.eq(m.x)&&d.y.eq(m.y)?null:m;if(b&&I)return null;if(b)return d;if(I)return _;const F=Tc(g,this.vector(),m,i.vector());return F===null||!Zr(l,F)?null:Hn.snap(F)}split(i){const o=[],a=i.events!==void 0,l=new Ln(i,!0),g=new Ln(i,!1),d=this.rightSE;this.replaceRightSE(g),o.push(g),o.push(l);const m=new Us(l,d,this.rings.slice(),this.windings.slice());return Ln.comparePoints(m.leftSE.point,m.rightSE.point)>0&&m.swapEvents(),Ln.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),a&&(l.checkForConsuming(),g.checkForConsuming()),o}swapEvents(){const i=this.rightSE;this.rightSE=this.leftSE,this.leftSE=i,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let o=0,a=this.windings.length;o<a;o++)this.windings[o]*=-1}consume(i){let o=this,a=i;for(;o.consumedBy;)o=o.consumedBy;for(;a.consumedBy;)a=a.consumedBy;const l=Us.compare(o,a);if(l!==0){if(l>0){const g=o;o=a,a=g}if(o.prev===a){const g=o;o=a,a=g}for(let g=0,d=a.rings.length;g<d;g++){const m=a.rings[g],_=a.windings[g],x=o.rings.indexOf(m);x===-1?(o.rings.push(m),o.windings.push(_)):o.windings[x]+=_}a.rings=null,a.windings=null,a.consumedBy=o,a.leftSE.consumedBy=o.leftSE,a.rightSE.consumedBy=o.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const i=this.prev.consumedBy||this.prev;this._beforeState=i.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const i=this.beforeState();this._afterState={rings:i.rings.slice(0),windings:i.windings.slice(0),multiPolys:[]};const o=this._afterState.rings,a=this._afterState.windings,l=this._afterState.multiPolys;for(let m=0,_=this.rings.length;m<_;m++){const x=this.rings[m],w=this.windings[m],I=o.indexOf(x);I===-1?(o.push(x),a.push(w)):a[I]+=w}const g=[],d=[];for(let m=0,_=o.length;m<_;m++){if(a[m]===0)continue;const x=o[m],w=x.poly;if(d.indexOf(w)===-1)if(x.isExterior)g.push(w);else{d.indexOf(w)===-1&&d.push(w);const I=g.indexOf(x.poly);I!==-1&&g.splice(I,1)}}for(let m=0,_=g.length;m<_;m++){const x=g[m].multiPoly;l.indexOf(x)===-1&&l.push(x)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const i=this.beforeState().multiPolys,o=this.afterState().multiPolys;switch(is.type){case"union":{const a=i.length===0,l=o.length===0;this._isInResult=a!==l;break}case"intersection":{let a,l;i.length<o.length?(a=i.length,l=o.length):(a=o.length,l=i.length),this._isInResult=l===is.numMultiPolys&&a<l;break}case"xor":{const a=Math.abs(i.length-o.length);this._isInResult=a%2===1;break}case"difference":{const a=l=>l.length===1&&l[0].isSubject;this._isInResult=a(i)!==a(o);break}}return this._isInResult}},Wa=class{constructor(h,i,o){if(lt(this,"poly"),lt(this,"isExterior"),lt(this,"segments"),lt(this,"bbox"),!Array.isArray(h)||h.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=i,this.isExterior=o,this.segments=[],typeof h[0][0]!="number"||typeof h[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const a=Hn.snap({x:new Cn(h[0][0]),y:new Cn(h[0][1])});this.bbox={ll:{x:a.x,y:a.y},ur:{x:a.x,y:a.y}};let l=a;for(let g=1,d=h.length;g<d;g++){if(typeof h[g][0]!="number"||typeof h[g][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const m=Hn.snap({x:new Cn(h[g][0]),y:new Cn(h[g][1])});m.x.eq(l.x)&&m.y.eq(l.y)||(this.segments.push(eo.fromRing(l,m,this)),m.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=m.x),m.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=m.y),m.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=m.x),m.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=m.y),l=m)}(!a.x.eq(l.x)||!a.y.eq(l.y))&&this.segments.push(eo.fromRing(l,a,this))}getSweepEvents(){const h=[];for(let i=0,o=this.segments.length;i<o;i++){const a=this.segments[i];h.push(a.leftSE),h.push(a.rightSE)}return h}},Dc=class{constructor(h,i){if(lt(this,"multiPoly"),lt(this,"exteriorRing"),lt(this,"interiorRings"),lt(this,"bbox"),!Array.isArray(h))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Wa(h[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let o=1,a=h.length;o<a;o++){const l=new Wa(h[o],this,!1);l.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=l.bbox.ll.x),l.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=l.bbox.ll.y),l.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=l.bbox.ur.x),l.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=l.bbox.ur.y),this.interiorRings.push(l)}this.multiPoly=i}getSweepEvents(){const h=this.exteriorRing.getSweepEvents();for(let i=0,o=this.interiorRings.length;i<o;i++){const a=this.interiorRings[i].getSweepEvents();for(let l=0,g=a.length;l<g;l++)h.push(a[l])}return h}},Ka=class{constructor(h,i){if(lt(this,"isSubject"),lt(this,"polys"),lt(this,"bbox"),!Array.isArray(h))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof h[0][0][0]=="number"&&(h=[h])}catch{}this.polys=[],this.bbox={ll:{x:new Cn(Number.POSITIVE_INFINITY),y:new Cn(Number.POSITIVE_INFINITY)},ur:{x:new Cn(Number.NEGATIVE_INFINITY),y:new Cn(Number.NEGATIVE_INFINITY)}};for(let o=0,a=h.length;o<a;o++){const l=new Dc(h[o],this);l.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=l.bbox.ll.x),l.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=l.bbox.ll.y),l.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=l.bbox.ur.x),l.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=l.bbox.ur.y),this.polys.push(l)}this.isSubject=i}getSweepEvents(){const h=[];for(let i=0,o=this.polys.length;i<o;i++){const a=this.polys[i].getSweepEvents();for(let l=0,g=a.length;l<g;l++)h.push(a[l])}return h}},Fc=(h,...i)=>is.run("union",h,i),Bc=(h,...i)=>is.run("intersection",h,i),zc=(h,...i)=>is.run("difference",h,i);Hn.set;function Gc(h){const i=[];if(oi(h,l=>{i.push(l.coordinates)}),i.length<2)throw new Error("Must have at least two features");const o=h.features[0].properties||{},a=zc(i[0],...i.slice(1));return a.length===0?null:a.length===1?he(a[0],o):Mn(a,o)}function Bs(h){const i=[];return h.type==="FeatureCollection"?ri(h,function(o){ii(o,function(a){i.push(ae(a,o.properties))})}):h.type==="Feature"?ii(h,function(o){i.push(ae(o,h.properties))}):ii(h,function(o){i.push(ae(o))}),Te(i)}function Ja(h,i={}){const o=[];if(oi(h,l=>{o.push(l.coordinates)}),o.length<2)throw new Error("Must specify at least 2 geometries");const a=Bc(o[0],...o.slice(1));return a.length===0?null:a.length===1?he(a[0],i.properties):Mn(a,i.properties)}function ja(h){let i,o;const a={type:"FeatureCollection",features:[]};if(h.type==="Feature"?o=h.geometry:o=h,o.type==="LineString")i=[o.coordinates];else if(o.type==="MultiLineString")i=o.coordinates;else if(o.type==="MultiPolygon")i=[].concat(...o.coordinates);else if(o.type==="Polygon")i=o.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return i.forEach(l=>{i.forEach(g=>{for(let d=0;d<l.length-1;d++)for(let m=d;m<g.length-1;m++){if(l===g&&(Math.abs(d-m)===1||d===0&&m===l.length-2&&l[d][0]===l[l.length-1][0]&&l[d][1]===l[l.length-1][1]))continue;const _=qc(l[d][0],l[d][1],l[d+1][0],l[d+1][1],g[m][0],g[m][1],g[m+1][0],g[m+1][1]);_&&a.features.push(ae([_[0],_[1]]))}})}),a}function qc(h,i,o,a,l,g,d,m){let _,x,w,I,b;const F={x:null,y:null,onLine1:!1,onLine2:!1};return _=(m-g)*(o-h)-(d-l)*(a-i),_===0?F.x!==null&&F.y!==null?F:!1:(x=i-g,w=h-l,I=(d-l)*x-(m-g)*w,b=(o-h)*x-(a-i)*w,x=I/_,w=b/_,F.x=h+x*(o-h),F.y=i+x*(a-i),x>=0&&x<=1&&(F.onLine1=!0),w>=0&&w<=1&&(F.onLine2=!0),F.onLine1&&F.onLine2?[F.x,F.y]:!1)}function Hc(h,i={}){return Nl(h,(o,a)=>{const l=a.geometry.coordinates;return o+es(l[0],l[1],i)},0)}function Zc(h,i={}){var o,a,l,g=i.properties,d=(o=i.autoComplete)!=null?o:!0,m=(a=i.orderCoords)!=null?a:!0,_=(l=i.mutate)!=null?l:!1;switch(_||(h=Vo(h)),h.type){case"FeatureCollection":var x=[];return h.features.forEach(function(w){x.push(Ue($a(w,{},d,m)))}),Mn(x,g);default:return $a(h,g,d,m)}}function $a(h,i,o,a){i=i||(h.type==="Feature"?h.properties:{});var l=si(h),g=l.coordinates,d=l.type;if(!g.length)throw new Error("line must contain coordinates");switch(d){case"LineString":return o&&(g=Qa(g)),he([g],i);case"MultiLineString":var m=[],_=0;return g.forEach(function(x){if(o&&(x=Qa(x)),a){var w=Uc(Si(Li(x)));w>_?(m.unshift(x),_=w):m.push(x)}else m.push(x)}),he(m,i);default:throw new Error("geometry type "+d+" is not supported")}}function Qa(h){var i=h[0],o=i[0],a=i[1],l=h[h.length-1],g=l[0],d=l[1];return(o!==g||a!==d)&&h.push(i),h}function Uc(h){var i=h[0],o=h[1],a=h[2],l=h[3];return Math.abs(i-a)*Math.abs(o-l)}function tu(h,i){const o=es(h,i),a=cu(h,i);return Sl(h,o/2,a)}var Yc=Object.defineProperty,Xc=Object.defineProperties,Vc=Object.getOwnPropertyDescriptors,eu=Object.getOwnPropertySymbols,Wc=Object.prototype.hasOwnProperty,Kc=Object.prototype.propertyIsEnumerable,nu=(h,i,o)=>i in h?Yc(h,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):h[i]=o,iu=(h,i)=>{for(var o in i||(i={}))Wc.call(i,o)&&nu(h,o,i[o]);if(eu)for(var o of eu(i))Kc.call(i,o)&&nu(h,o,i[o]);return h},ru=(h,i)=>Xc(h,Vc(i));function Jc(h,i,o={}){if(!h)throw new Error("targetPoint is required");if(!i)throw new Error("points is required");let a=1/0,l=0;ri(i,(d,m)=>{const _=es(h,d,o);_<a&&(l=m,a=_)});const g=Vo(i.features[l]);return ru(iu({},g),{properties:ru(iu({},g.properties),{featureIndex:l,distanceToPoint:a})})}function jc(h,i){var o=h[0]-i[0],a=h[1]-i[1];return o*o+a*a}function $c(h,i,o){var a=i[0],l=i[1],g=o[0]-a,d=o[1]-l;if(g!==0||d!==0){var m=((h[0]-a)*g+(h[1]-l)*d)/(g*g+d*d);m>1?(a=o[0],l=o[1]):m>0&&(a+=g*m,l+=d*m)}return g=h[0]-a,d=h[1]-l,g*g+d*d}function Qc(h,i){for(var o=h[0],a=[o],l,g=1,d=h.length;g<d;g++)l=h[g],jc(l,o)>i&&(a.push(l),o=l);return o!==l&&a.push(l),a}function Xo(h,i,o,a,l){for(var g=a,d,m=i+1;m<o;m++){var _=$c(h[m],h[i],h[o]);_>g&&(d=m,g=_)}g>a&&(d-i>1&&Xo(h,i,d,a,l),l.push(h[d]),o-d>1&&Xo(h,d,o,a,l))}function tf(h,i){var o=h.length-1,a=[h[0]];return Xo(h,0,o,i,a),a.push(h[o]),a}function no(h,i,o){if(h.length<=2)return h;var a=i!==void 0?i*i:1;return h=o?h:Qc(h,a),h=tf(h,a),h}function Ur(h,i={}){var o,a,l;if(i=i??{},!Il(i))throw new Error("options is invalid");const g=(o=i.tolerance)!=null?o:1,d=(a=i.highQuality)!=null?a:!1,m=(l=i.mutate)!=null?l:!1;if(!h)throw new Error("geojson is required");if(g&&g<0)throw new Error("invalid tolerance");return m!==!0&&(h=Vo(h)),oi(h,function(_){ef(_,g,d)}),h}function ef(h,i,o){const a=h.type;if(a==="Point"||a==="MultiPoint")return h;if(ah(h,{mutate:!0}),a!=="GeometryCollection")switch(a){case"LineString":h.coordinates=no(h.coordinates,i,o);break;case"MultiLineString":h.coordinates=h.coordinates.map(l=>no(l,i,o));break;case"Polygon":h.coordinates=su(h.coordinates,i,o);break;case"MultiPolygon":h.coordinates=h.coordinates.map(l=>su(l,i,o))}return h}function su(h,i,o){return h.map(function(a){if(a.length<4)throw new Error("invalid polygon");let l=i,g=no(a,l,o);for(;!nf(g);)l-=l*.01,g=no(a,l,o);return(g[g.length-1][0]!==g[0][0]||g[g.length-1][1]!==g[0][1])&&g.push(g[0]),g})}function nf(h){return h.length<3?!1:!(h.length===3&&h[2][0]===h[0][0]&&h[2][1]===h[0][1])}function rf(h,i={}){const o=[];if(oi(h,l=>{o.push(l.coordinates)}),o.length<2)throw new Error("Must have at least 2 geometries");const a=Fc(o[0],...o.slice(1));return a.length===0?null:a.length===1?he(a[0],i.properties):Mn(a,i.properties)}function sf(h,i,o){if(h.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");o===void 0&&(o=1);var a=h.geometry.coordinates,l=[],g={};if(o){for(var d=[],m=0;m<a.length;m++)for(var _=0;_<a[m].length-1;_++)d.push(ot(m,_));var x=new yu;x.load(d)}for(var w=0;w<a.length;w++)for(var I=0;I<a[w].length-1;I++)if(o){var b=x.search(ot(w,I));b.forEach(function(ut){var S=ut.ring,G=ut.edge;et(w,I,S,G)})}else for(var F=0;F<a.length;F++)for(var z=0;z<a[F].length-1;z++)et(w,I,F,z);return i||(l={type:"Feature",geometry:{type:"MultiPoint",coordinates:l}}),l;function et(ut,S,G,R){var H=a[ut][S],Y=a[ut][S+1],J=a[G][R],P=a[G][R+1],M=of(H,Y,J,P);if(M!==null){var N,A;if(Y[0]!==H[0]?N=(M[0]-H[0])/(Y[0]-H[0]):N=(M[1]-H[1])/(Y[1]-H[1]),P[0]!==J[0]?A=(M[0]-J[0])/(P[0]-J[0]):A=(M[1]-J[1])/(P[1]-J[1]),!(N>=1||N<=0||A>=1||A<=0)){var O=M,V=!g[O];V&&(g[O]=!0),i?l.push(i(M,ut,S,H,Y,N,G,R,J,P,A,V)):l.push(M)}}}function ot(ut,S){var G=a[ut][S],R=a[ut][S+1],H,Y,J,P;return G[0]<R[0]?(H=G[0],Y=R[0]):(H=R[0],Y=G[0]),G[1]<R[1]?(J=G[1],P=R[1]):(J=R[1],P=G[1]),{minX:H,minY:J,maxX:Y,maxY:P,ring:ut,edge:S}}}function of(h,i,o,a){if(Qr(h,o)||Qr(h,a)||Qr(i,o)||Qr(a,o))return null;var l=h[0],g=h[1],d=i[0],m=i[1],_=o[0],x=o[1],w=a[0],I=a[1],b=(l-d)*(x-I)-(g-m)*(_-w);if(b===0)return null;var F=((l*m-g*d)*(_-w)-(l-d)*(_*I-x*w))/b,z=((l*m-g*d)*(x-I)-(g-m)*(_*I-x*w))/b;return[F,z]}function Qr(h,i){if(!h||!i||h.length!==i.length)return!1;for(var o=0,a=h.length;o<a;o++)if(h[o]instanceof Array&&i[o]instanceof Array){if(!Qr(h[o],i[o]))return!1}else if(h[o]!==i[o])return!1;return!0}function af(h){if(h.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(h.geometry===void 0||h.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(h.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var i=h.geometry.coordinates.length,o=[],S=0;S<i;S++){var a=h.geometry.coordinates[S];ts(a[0],a[a.length-1])||a.push(a[0]);for(var l=0;l<a.length-1;l++)o.push(a[l])}if(!lf(o))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var g=o.length,d=sf(h,function(at,ct,ft,kt,Q,Xt,Ct,vt,Z,At,Gt,Mt){return[at,ct,ft,kt,Q,Xt,Ct,vt,Z,At,Gt,Mt]}),m=d.length;if(m==0){for(var J=[],S=0;S<i;S++)J.push(he([h.geometry.coordinates[S]],{parent:-1,winding:uf(h.geometry.coordinates[S])}));var tt=Te(J);return W(),rt(),tt}for(var _=[],x=[],S=0;S<i;S++){_.push([]);for(var l=0;l<h.geometry.coordinates[S].length-1;l++)_[S].push([new ou(h.geometry.coordinates[S][sr(l+1,h.geometry.coordinates[S].length-1)],1,[S,l],[S,sr(l+1,h.geometry.coordinates[S].length-1)],void 0)]),x.push(new au(h.geometry.coordinates[S][l],[S,sr(l-1,h.geometry.coordinates[S].length-1)],[S,l],void 0,void 0,!1,!0))}for(var S=0;S<m;S++)_[d[S][1]][d[S][2]].push(new ou(d[S][0],d[S][5],[d[S][1],d[S][2]],[d[S][6],d[S][7]],void 0)),d[S][11]&&x.push(new au(d[S][0],[d[S][1],d[S][2]],[d[S][6],d[S][7]],void 0,void 0,!0,!0));for(var w=x.length,S=0;S<_.length;S++)for(var l=0;l<_[S].length;l++)_[S][l].sort(function(ct,ft){return ct.param<ft.param?-1:1});for(var I=[],S=0;S<w;S++)I.push({minX:x[S].coord[0],minY:x[S].coord[1],maxX:x[S].coord[0],maxY:x[S].coord[1],index:S});var b=new yu;b.load(I);for(var S=0;S<_.length;S++)for(var l=0;l<_[S].length;l++)for(var F=0;F<_[S][l].length;F++){var z;F==_[S][l].length-1?z=_[S][sr(l+1,h.geometry.coordinates[S].length-1)][0].coord:z=_[S][l][F+1].coord;var et=b.search({minX:z[0],minY:z[1],maxX:z[0],maxY:z[1]})[0];_[S][l][F].nxtIsectAlongEdgeIn=et.index}for(var S=0;S<_.length;S++)for(var l=0;l<_[S].length;l++)for(var F=0;F<_[S][l].length;F++){var z=_[S][l][F].coord,et=b.search({minX:z[0],minY:z[1],maxX:z[0],maxY:z[1]})[0],ot=et.index;ot<g?x[ot].nxtIsectAlongRingAndEdge2=_[S][l][F].nxtIsectAlongEdgeIn:ts(x[ot].ringAndEdge1,_[S][l][F].ringAndEdgeIn)?x[ot].nxtIsectAlongRingAndEdge1=_[S][l][F].nxtIsectAlongEdgeIn:x[ot].nxtIsectAlongRingAndEdge2=_[S][l][F].nxtIsectAlongEdgeIn}for(var ut=[],S=0,l=0;l<i;l++){for(var G=S,F=0;F<h.geometry.coordinates[l].length-1;F++)x[S].coord[0]<x[G].coord[0]&&(G=S),S++;for(var R=x[G].nxtIsectAlongRingAndEdge2,F=0;F<x.length;F++)if(x[F].nxtIsectAlongRingAndEdge1==G||x[F].nxtIsectAlongRingAndEdge2==G){var H=F;break}var Y=Ys([x[H].coord,x[G].coord,x[R].coord],!0)?1:-1;ut.push({isect:G,parent:-1,winding:Y})}ut.sort(function(mt,at){return x[mt.isect].coord>x[at.isect].coord?-1:1});for(var J=[];ut.length>0;){var P=ut.pop(),M=P.isect,N=P.parent,A=P.winding,O=J.length,V=[x[M].coord],q=M;if(x[M].ringAndEdge1Walkable)var X=x[M].ringAndEdge1,B=x[M].nxtIsectAlongRingAndEdge1;else var X=x[M].ringAndEdge2,B=x[M].nxtIsectAlongRingAndEdge2;for(;!ts(x[M].coord,x[B].coord);){V.push(x[B].coord);for(var j=void 0,S=0;S<ut.length;S++)if(ut[S].isect==B){j=S;break}if(j!=null&&ut.splice(j,1),ts(X,x[B].ringAndEdge1)){if(X=x[B].ringAndEdge2,x[B].ringAndEdge2Walkable=!1,x[B].ringAndEdge1Walkable){var U={isect:B};Ys([x[q].coord,x[B].coord,x[x[B].nxtIsectAlongRingAndEdge2].coord],A==1)?(U.parent=N,U.winding=-A):(U.parent=O,U.winding=A),ut.push(U)}q=B,B=x[B].nxtIsectAlongRingAndEdge2}else{if(X=x[B].ringAndEdge1,x[B].ringAndEdge1Walkable=!1,x[B].ringAndEdge2Walkable){var U={isect:B};Ys([x[q].coord,x[B].coord,x[x[B].nxtIsectAlongRingAndEdge1].coord],A==1)?(U.parent=N,U.winding=-A):(U.parent=O,U.winding=A),ut.push(U)}q=B,B=x[B].nxtIsectAlongRingAndEdge1}}V.push(x[B].coord),J.push(he([V],{index:O,parent:N,winding:A,netWinding:void 0}))}var tt=Te(J);W(),rt();function W(){for(var mt=[],at=0;at<tt.features.length;at++)tt.features[at].properties.parent==-1&&mt.push(at);if(mt.length>1)for(var at=0;at<mt.length;at++){for(var ct=-1,ft=1/0,kt=0;kt<tt.features.length;kt++)mt[at]!=kt&&Ce(tt.features[mt[at]].geometry.coordinates[0][0],tt.features[kt],{ignoreBoundary:!0})&&ir(tt.features[kt])<ft&&(ct=kt);tt.features[mt[at]].properties.parent=ct}}function rt(){for(var mt=0;mt<tt.features.length;mt++)if(tt.features[mt].properties.parent==-1){var at=tt.features[mt].properties.winding;tt.features[mt].properties.netWinding=at,ht(mt,at)}}function ht(mt,at){for(var ct=0;ct<tt.features.length;ct++)if(tt.features[ct].properties.parent==mt){var ft=at+tt.features[ct].properties.winding;tt.features[ct].properties.netWinding=ft,ht(ct,ft)}}return tt}var ou=function(h,i,o,a,l){this.coord=h,this.param=i,this.ringAndEdgeIn=o,this.ringAndEdgeOut=a,this.nxtIsectAlongEdgeIn=l},au=function(h,i,o,a,l,g,d){this.coord=h,this.ringAndEdge1=i,this.ringAndEdge2=o,this.nxtIsectAlongRingAndEdge1=a,this.nxtIsectAlongRingAndEdge2=l,this.ringAndEdge1Walkable=g,this.ringAndEdge2Walkable=d};function Ys(h,i){if(typeof i>"u"&&(i=!0),h.length!=3)throw new Error("This function requires an array of three points [x,y]");var o=(h[1][0]-h[0][0])*(h[2][1]-h[0][1])-(h[1][1]-h[0][1])*(h[2][0]-h[0][0]);return o>=0==i}function uf(h){for(var i=0,o=0;o<h.length-1;o++)h[o][0]<h[i][0]&&(i=o);if(Ys([h[sr(i-1,h.length-1)],h[i],h[sr(i+1,h.length-1)]],!0))var a=1;else var a=-1;return a}function ts(h,i){if(!h||!i||h.length!=i.length)return!1;for(var o=0,a=h.length;o<a;o++)if(h[o]instanceof Array&&i[o]instanceof Array){if(!ts(h[o],i[o]))return!1}else if(h[o]!=i[o])return!1;return!0}function sr(h,i){return(h%i+i)%i}function lf(h){for(var i={},o=1,a=0,l=h.length;a<l;++a){if(Object.prototype.hasOwnProperty.call(i,h[a])){o=0;break}i[h[a]]=1}return o}function Ro(h){var i=[];return fu(h,function(o){o.geometry.type==="Polygon"&&ri(af(o),function(a){i.push(he(a.geometry.coordinates,o.properties))})}),Te(i)}class Yu{constructor(i){lt(this,"config",null),this.config={...Gn,...i}}union(i,o){try{const a=Te([i,o]),l=rf(a);return l?this.getTurfPolygon(l):null}catch(a){return console.warn("Error in union:",a.message),null}}createPolygonFromTrace(i){var o;const a=((o=this.config.polygonCreation)==null?void 0:o.method)||"concaveman";switch(a){case"concaveman":return this.turfConcaveman(i);case"convex":return this.createConvexPolygon(i);case"direct":return this.createDirectPolygon(i);case"buffer":return this.createBufferedPolygon(i);default:return console.warn(`Unknown polygon creation method: ${a}, falling back to concaveman`),this.turfConcaveman(i)}}turfConcaveman(i){const a=Bs(i).features.map(l=>l.geometry.coordinates);return Mn([[Du(a)]])}createConvexPolygon(i){const o=Bs(i),a=Za(o);return a?this.getTurfPolygon(a):this.createDirectPolygon(i)}createDirectPolygon(i){let o;if(i.geometry.type==="LineString"?o=i.geometry.coordinates:i.geometry.type==="Polygon"?o=i.geometry.coordinates[0]:o=Bs(i).features.map(l=>l.geometry.coordinates),o.length>0){const a=o[0],l=o[o.length-1];(a[0]!==l[0]||a[1]!==l[1])&&o.push([a[0],a[1]])}return o.length<4?(console.warn("Not enough points for direct polygon, falling back to concaveman"),this.turfConcaveman(i)):Mn([[o]])}createBufferedPolygon(i){try{let o;if(i.geometry.type==="LineString")o=i;else{const g=Bs(i).features.map(d=>d.geometry.coordinates);o=Li(g)}const a=ic(o,.001,{units:"kilometers"});return a?this.getTurfPolygon(a):this.createDirectPolygon(i)}catch(o){return console.warn("Buffer polygon creation failed:",o.message),this.createDirectPolygon(i)}}getSimplified(i,o=!1){var a,l,g,d,m,_;const x=((l=(a=this.config.polygonCreation)==null?void 0:a.simplification)==null?void 0:l.mode)||"simple";if(x==="simple"){const w={tolerance:((d=(g=this.config.polygonCreation)==null?void 0:g.simplification)==null?void 0:d.tolerance)||1e-4,highQuality:((_=(m=this.config.polygonCreation)==null?void 0:m.simplification)==null?void 0:_.highQuality)||!1,mutate:!1};return Ur(i,w)}else if(x==="dynamic"){const w=i.geometry.coordinates[0][0].length,I=this.config.simplification.simplifyTolerance;if(o){let b=Ur(i,I);const F=this.config.simplification.dynamicMode.fractionGuard,z=this.config.simplification.dynamicMode.multipiler;for(;b.geometry.coordinates[0][0].length>4&&b.geometry.coordinates[0][0].length/(w+2)>F;)I.tolerance=I.tolerance*z,b=Ur(i,I);return b}else return Ur(i,I)}else return x==="none"?i:(console.warn(`Unknown simplification mode: ${x}, falling back to simple`),Ur(i,{tolerance:1e-4,highQuality:!1,mutate:!1}))}getTurfPolygon(i){let o;return i.geometry.type==="Polygon"?o=Mn([i.geometry.coordinates]):o=Mn(i.geometry.coordinates),o}getMultiPolygon(i){return Mn(i)}getKinks(i){try{if(!i||!i.geometry||!i.geometry.coordinates)return[i];const o=this.removeDuplicateVertices(i);if(!o||!o.geometry||!o.geometry.coordinates)return console.warn("Feature became invalid after cleaning in getKinks"),[i];if(this.polygonHasHoles(o))return this.getKinksWithHolePreservation(o);{const l=Ro(o),g=[];return ri(l,d=>{g.push(d)}),g}}catch(o){return console.warn("Error processing kinks:",o.message),[i]}}getCoords(i){return Ue(i)}hasKinks(i){return ja(i).features.length>0}getConvexHull(i){try{const o=Te([i]);return Za(o)}catch(o){return console.warn("Error in getConvexHull:",o.message),null}}getMidpoint(i,o){const a=ae([i.lng,i.lat]),l=ae([o.lng,o.lat]),g=tu(a,l);return{lat:g.geometry.coordinates[1],lng:g.geometry.coordinates[0]}}polygonIntersect(i,o){try{if(!i||!i.geometry||!i.geometry.coordinates||!o||!o.geometry||!o.geometry.coordinates)return console.warn("Invalid features passed to polygonIntersect"),!1;try{const a=Te([i,o]),l=Ja(a);if(l&&l.geometry&&(l.geometry.type==="Polygon"||l.geometry.type==="MultiPolygon")&&ir(l)>1e-6)return!0}catch{}try{const a=Ue(i),l=Ue(o);for(const g of l)for(const d of g[0]){const m=ae(d);if(Ce(m,i))return!0}for(const g of a)for(const d of g[0]){const m=ae(d);if(Ce(m,o))return!0}}catch{}try{const a=Ue(i),l=Ue(o);for(const g of a){const d=g[0];for(let m=0;m<d.length-1;m++){const _=Li([d[m],d[m+1]]);for(const x of l){const w=x[0];for(let I=0;I<w.length-1;I++){const b=Li([w[I],w[I+1]]);try{const F=ih(_,b);if(F&&F.features&&F.features.length>0)return!0}catch{}}}}}}catch{}return!1}catch(a){return console.warn("Error in polygonIntersect:",a.message),!1}}getIntersection(i,o){try{const a=Te([i,o]),l=Ja(a);return l&&l.geometry&&(l.geometry.type==="Polygon"||l.geometry.type==="MultiPolygon")?l:null}catch(a){return console.warn("Error in getIntersection:",a.message),null}}getDistance(i,o){return es(i,o)}isWithin(i,o){return Mo(he([i]),he([o]))}isPolygonCompletelyWithin(i,o){try{return Mo(i,o)}catch{const l=Ue(i),g=Ue(o);for(const d of l)for(const m of d)for(const _ of m){const x=ae(_);let w=!1;for(const I of g){for(const b of I){const F=he([b]);if(Ce(x,F)){w=!0;break}}if(w)break}if(!w)return!1}return!0}}equalPolygons(i,o){}convertToBoundingBoxPolygon(i){const o=Si(i.geometry);return Al(o)}polygonToMultiPolygon(i){return Mn([i.geometry.coordinates])}injectPointToPolygon(i,o){const a=JSON.parse(JSON.stringify(i));if(a.geometry.type==="MultiPolygon"){const l=a.geometry.coordinates[0][0];let g=1/0,d=0;for(let m=0;m<l.length-1;m++){const _=l[m],x=l[m+1],w=this.distanceToLineSegment(o,_,x);w<g&&(g=w,d=m+1)}l.splice(d,0,o)}else if(a.geometry.type==="Polygon"){const l=a.geometry.coordinates[0];let g=1/0,d=0;for(let m=0;m<l.length-1;m++){const _=l[m],x=l[m+1],w=this.distanceToLineSegment(o,_,x);w<g&&(g=w,d=m+1)}l.splice(d,0,o)}return a}distanceToLineSegment(i,o,a){const l=i[0]-o[0],g=i[1]-o[1],d=a[0]-o[0],m=a[1]-o[1],_=l*d+g*m,x=d*d+m*m;if(x===0)return Math.sqrt(l*l+g*g);const w=_/x;let I,b;w<0?(I=o[0],b=o[1]):w>1?(I=a[0],b=a[1]):(I=o[0]+w*d,b=o[1]+w*m);const F=i[0]-I,z=i[1]-b;return Math.sqrt(F*F+z*z)}polygonDifference(i,o){try{const a=Te([i,o]),l=Gc(a);return l?this.getTurfPolygon(l):null}catch(a){return console.warn("Error in polygonDifference:",a.message),null}}getBoundingBoxCompassPosition(i,o,a,l){return null}getNearestPointIndex(i,o){return Jc(i,o).properties.featureIndex}getCoord(i){return[i.lng,i.lat]}getFeaturePointCollection(i){const o=[];return i.forEach(l=>{const g=ae([l.lng,l.lat],{});o.push(g)}),Te(o)}getPolygonArea(i){return ir(i)}getPolygonPerimeter(i){return Hc(i,{units:"kilometers"})}getDoubleElbowLatLngs(i){const o=[],a=i.length,l=i[0].lat===i[a-1].lat&&i[0].lng===i[a-1].lng?a-1:a;for(let g=0;g<l;g++){const d=i[g],m=i[(g+1)%l];o.push(new yt.LatLng(d.lat,d.lng));const _=tu(ae([d.lng,d.lat]),ae([m.lng,m.lat]));o.push(new yt.LatLng(_.geometry.coordinates[1],_.geometry.coordinates[0]))}return o}getBezierMultiPolygon(i){const o=rh(this.getMultiPolygon(i));o.features[0].geometry.coordinates.push(o.features[0].geometry.coordinates[0]);const a=Bl(o.features[0],{resolution:this.config.bezier.resolution,sharpness:this.config.bezier.sharpness});return Zc(a)}polygonHasHoles(i){try{return i.geometry.type==="Polygon"?i.geometry.coordinates.length>1:i.geometry.type==="MultiPolygon"?i.geometry.coordinates.some(o=>o.length>1):!1}catch(o){return console.warn("Error checking for holes:",o.message),!1}}getKinksWithHolePreservation(i){try{if(i.geometry.type==="Polygon"){const o=i.geometry.coordinates,a=o[0],l=o.slice(1),g={type:"Feature",geometry:{type:"Polygon",coordinates:[a]},properties:i.properties||{}},d=this.hasKinks(g),m=this.checkOuterRingHoleIntersection(a,l);if(d||m){if(this.checkIfDragCompletelyThroughHole(a,l))return this.handleCompleteHoleTraversal(g,l);const x=Ro(g),w=[];return ri(x,I=>{const b=this.subtractIntersectingHoles(I,l);w.push(b)}),w}else return[i]}else if(i.geometry.type==="MultiPolygon"){const o=[];for(const a of i.geometry.coordinates){const l={type:"Feature",geometry:{type:"Polygon",coordinates:a},properties:i.properties||{}},g=this.getKinksWithHolePreservation(l);o.push(...g)}return o}return[i]}catch(o){return console.warn("Error in getKinksWithHolePreservation:",o.message),[i]}}checkIfDragCompletelyThroughHole(i,o){try{if(this.findDuplicatePoints(i).length>0)return!0;const l=this.findSelfIntersectionLine(i);if(l&&o.length>0){for(const g of o)if(this.lineCompletelyTraversesHole(l,g))return!0}if(this.hasKinks({type:"Feature",geometry:{type:"Polygon",coordinates:[i]},properties:{}})){for(const g of o)if(this.holeIsCutByKinks(i,g))return!0}return!1}catch(a){return console.warn("Error checking complete hole traversal:",a.message),!1}}findSelfIntersectionLine(i){try{const o=new Map;for(let a=0;a<i.length-1;a++){const l=i[a],g=`${l[0]},${l[1]}`;o.has(g)?o.get(g).indices.push(a):o.set(g,{point:l,indices:[a]})}for(const[a,l]of o)if(l.indices.length>=2){const g=l.indices[0],d=l.indices[1],m=[];for(let _=g;_<=d;_++)m.push(i[_]);return m}return null}catch(o){return console.warn("Error finding self-intersection line:",o.message),null}}lineCompletelyTraversesHole(i,o){try{if(i.length<2)return!1;const a=i[0],l=i[i.length-1],g=he([o]),d=Ce(ae(a),g),m=Ce(ae(l),g);return d!==m}catch(a){return console.warn("Error checking line hole traversal:",a.message),!1}}holeIsCutByKinks(i,o){try{const a=he([i]),l=he([o]),g=ja(a);if(g.features.length===0)return!1;for(const d of g.features){const m=d.geometry.coordinates;try{if(es(ae(m),sc(l))<.01||Ce(ae(m),l))return!0}catch{if(Ce(ae(m),l))return!0}}return!1}catch(a){return console.warn("Error checking hole cut by kinks:",a.message),!1}}findDuplicatePoints(i){const o=[],a=new Set;for(let l=0;l<i.length-1;l++){const g=i[l],d=`${g[0]},${g[1]}`;a.has(d)?o.push(g):a.add(d)}return o}checkOuterRingHoleIntersection(i,o){try{if(o.length===0)return!1;const a=he([i]);for(const l of o){const g=he([l]);if(this.getIntersection(a,g))return!0;for(let m=0;m<i.length-1;m++){const _=i[m];if(Ce(ae(_),g))return!0}}return!1}catch{return!1}}handleCompleteHoleTraversal(i,o){try{const a={type:"Feature",geometry:{type:"Polygon",coordinates:[i.geometry.coordinates[0]]},properties:i.properties||{}},l=Ro(a),g=[];return ri(l,d=>{d._polydrawHoleTraversalOccurred=!0,g.push(d)}),g}catch(a){console.warn("Error handling complete hole traversal:",a.message);try{const l={...i,geometry:{...i.geometry,coordinates:[i.geometry.coordinates[0]]}};return l._polydrawHoleTraversalOccurred=!0,[l]}catch{return[i]}}}assignHolesToPolygon(i,o){try{const a=[];for(const l of o){const g=he([l]),d=this.analyzeHolePolygonRelationship(g,i);d.isCompletelyContained?a.push(l):d.hasIntersection}return{type:"Feature",geometry:{type:"Polygon",coordinates:[i.geometry.coordinates[0],...a]},properties:i.properties||{}}}catch(a){return console.warn("Error assigning holes to polygon:",a.message),i}}analyzeHolePolygonRelationship(i,o){try{if(Mo(i,o))return{isCompletelyContained:!0,hasIntersection:!1,intersectionArea:0};const l=this.getIntersection(i,o),g=l!==null;let d=0;if(g){d=ir(l);const m=ir(i);if(d/m<.1)return{isCompletelyContained:!1,hasIntersection:!1,intersectionArea:0}}return{isCompletelyContained:!1,hasIntersection:g,intersectionArea:d}}catch(a){return console.warn("Error analyzing hole-polygon relationship:",a.message),{isCompletelyContained:!1,hasIntersection:!1,intersectionArea:0}}}subtractIntersectingHoles(i,o){try{let a=i;for(const l of o){const g=he([l]);if(this.getIntersection(g,a)){const m=this.polygonDifference(a,g);if(m){if(m.geometry.type==="Polygon")a=m;else if(m.geometry.type==="MultiPolygon"){const _=m;let x=0,w=null;for(const I of _.geometry.coordinates){const b={type:"Feature",geometry:{type:"Polygon",coordinates:I},properties:{}},F=ir(b);F>x&&(x=F,w=b)}w&&(a=w)}}}}return a}catch(a){return console.warn("Error subtracting intersecting holes:",a.message),i}}calculateRingArea(i){let o=0;const a=i.length;for(let l=0;l<a-1;l++)o+=i[l][0]*i[l+1][1],o-=i[l+1][0]*i[l][1];return Math.abs(o)/2}removeDuplicateVertices(i){if(!i||!i.geometry||!i.geometry.coordinates)return console.warn("Invalid feature passed to removeDuplicateVertices"),i;const o=a=>{if(!a||a.length<3)return console.warn("Invalid coordinates array - need at least 3 points for a polygon"),a||[];const l=[],g=1e-6;for(let d=0;d<a.length;d++){const m=a[d],_=a[(d+1)%a.length];if(!m||!Array.isArray(m)||m.length<2||!_||!Array.isArray(_)||_.length<2)continue;const x=Math.abs(m[1]-_[1]),w=Math.abs(m[0]-_[0]);(x>g||w>g)&&l.push(m)}if(l.length<3)return console.warn("After cleaning, polygon has less than 3 points"),a;if(l.length>0){const d=l[0],m=l[l.length-1],_=Math.abs(d[1]-m[1]),x=Math.abs(d[0]-m[0]);(_>g||x>g)&&l.push([d[0],d[1]])}return l};try{if(i.geometry.type==="Polygon"){const a=i.geometry.coordinates.map(l=>o(l));return a.some(l=>l.length<4)?(console.warn("Cleaned polygon has invalid ring with less than 4 coordinates"),i):{...i,geometry:{...i.geometry,coordinates:a}}}else if(i.geometry.type==="MultiPolygon"){const a=i.geometry.coordinates.map(l=>l.map(g=>o(g)));return a.some(l=>l.some(g=>g.length<4))?(console.warn("Cleaned multipolygon has invalid ring with less than 4 coordinates"),i):{...i,geometry:{...i.geometry,coordinates:a}}}}catch(a){return console.warn("Error in removeDuplicateVertices:",a.message),i}return i}createBiteFromHoleIntersection(i,o){try{const a=this.getIntersection(o,i);if(!a)return i;const l=this.polygonDifference(i,a);return l&&l.geometry.type==="Polygon"?l:i}catch(a){return console.warn("Error creating bite from hole intersection:",a.message),i}}}function hf(h,i,o,a,l,g,d,m){const _=yt.DomUtil.create("a","icon-activate",h);if(_.href="#",_.title="Activate",_.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M5 17V7M5 17C3.89543 17 3 17.8954 3 19C3 20.1046 3.89543 21 5 21C6.10457 21 7 20.1046 7 19M5 17C6.10457 17 7 17.8954 7 19M5 7C6.10457 7 7 6.10457 7 5M5 7C3.89543 7 3 6.10457 3 5C3 3.89543 3.89543 3 5 3C6.10457 3 7 3.89543 7 5M7 5H17M17 5C17 6.10457 17.8954 7 19 7C20.1046 7 21 6.10457 21 5C21 3.89543 20.1046 3 19 3C17.8954 3 17 3.89543 17 5ZM7 19H17M17 19C17 20.1046 17.8954 21 19 21C20.1046 21 21 20.1046 21 19C21 17.8954 20.1046 17 19 17C17.8954 17 17 17.8954 17 19ZM17.9247 6.6737L15.1955 10.3776M15.1955 13.6223L17.9222 17.3223M16 12C16 13.1046 15.1046 14 14 14C12.8954 14 12 13.1046 12 12C12 10.8954 12.8954 10 14 10C15.1046 10 16 10.8954 16 12Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>',yt.DomEvent.on(_,"click",yt.DomEvent.stop).on(_,"click",a),o.modes.draw){const x=yt.DomUtil.create("a","icon-draw",i);x.href="#",x.title="Draw",x.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M15 7.49996L17.5 9.99996M7.5 20L19.25 8.24996C19.9404 7.5596 19.9404 6.44032 19.25 5.74996V5.74996C18.5596 5.0596 17.4404 5.05961 16.75 5.74996L5 17.5V20H7.5ZM7.5 20H15.8787C17.0503 20 18 19.0502 18 17.8786V17.8786C18 17.316 17.7765 16.7765 17.3787 16.3786L17 16M4.5 4.99996C6.5 2.99996 10 3.99996 10 5.99996C10 8.5 4 8.5 4 11C4 11.8759 4.53314 12.5256 5.22583 13" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>',yt.DomEvent.on(x,"click",yt.DomEvent.stop).on(x,"click",l)}if(o.modes.subtract){const x=yt.DomUtil.create("a","icon-subtract",i);x.href="#",x.title="Subtract",x.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M15.0722 3.9967L20.7508 9.83395L17.0544 13.5304L13.0758 17.5H21.0041V19H7.93503L4.00195 15.0669L15.0722 3.9967ZM10.952 17.5L15.4628 12.9994L11.8268 9.3634L6.12327 15.0669L8.55635 17.5H10.952Z" fill="#1F2328"></path> </g></svg>',yt.DomEvent.on(x,"click",yt.DomEvent.stop).on(x,"click",g)}if(o.modes.p2p){const x=yt.DomUtil.create("a","icon-p2p",i);x.href="#",x.title="Point to Point",x.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M5 17V7M5 17C3.89543 17 3 17.8954 3 19C3 20.1046 3.89543 21 5 21C6.10457 21 7 20.1046 7 19M5 17C6.10457 17 7 17.8954 7 19M5 7C6.10457 7 7 6.10457 7 5M5 7C3.89543 7 3 6.10457 3 5C3 3.89543 3.89543 3 5 3C6.10457 3 7 3.89543 7 5M7 5H17M17 5C17 6.10457 17.8954 7 19 7C20.1046 7 21 6.10457 21 5C21 3.89543 20.1046 3 19 3C17.8954 3 17 3.89543 17 5ZM7 19H17M17 19C17 20.1046 17.8954 21 19 21C20.1046 21 21 20.1046 21 19C21 17.8954 20.1046 17 19 17C17.8954 17 17 17.8954 17 19ZM17.9247 6.6737L15.1955 10.3776M15.1955 13.6223L17.9222 17.3223M16 12C16 13.1046 15.1046 14 14 14C12.8954 14 12 13.1046 12 12C12 10.8954 12.8954 10 14 10C15.1046 10 16 10.8954 16 12Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>',yt.DomEvent.on(x,"click",yt.DomEvent.stop).on(x,"click",m)}if(o.modes.deleteAll){const x=yt.DomUtil.create("a","icon-erase",i);x.href="#",x.title="Erase All",x.innerHTML=`<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 21.0.2, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 48 48" style="enable-background:new 0 0 48 48;" xml:space="preserve">
<style type="text/css">
	.st0{fill:#000000}
	.st1{fill:#333333;fill-opacity:0;}
</style>
<title>trash</title>
<rect class="st1" width="48" height="48"/>
<polygon class="st0" points="26.6,10 26.6,7.8 21.4,7.8 21.4,10 12.6,10 12.6,12.8 35.4,12.8 35.4,10 "/>
<path class="st0" d="M35.4,15.4H12.6v4.3h1.8V37c0,1.1,0.9,2,2,2h15.2c1.1,0,2-0.9,2-2V19.7h1.8V15.4z M19.7,34.2c0,0.5-0.4,1-1,1
	c-0.5,0-1-0.4-1-1V22.6c0-0.5,0.4-1,1-1c0.5,0,1,0.4,1,1V34.2z M25.3,33.8c0,0.7-0.6,1.3-1.3,1.3c-0.7,0-1.3-0.6-1.3-1.3V23
	c0-0.7,0.6-1.3,1.3-1.3c0.7,0,1.3,0.6,1.3,1.3V33.8z M30.3,34.2c0,0.5-0.4,1-1,1c-0.5,0-1-0.4-1-1V22.6c0-0.5,0.4-1,1-1
	c0.5,0,1,0.4,1,1V34.2z"/>
</svg>`,yt.DomEvent.on(x,"click",yt.DomEvent.stop).on(x,"click",d)}}class Xs{static getCenter(i){const o=Math.PI;let a=0,l=0,g=0;i.forEach(w=>{let I=w.lat,b=w.lng;I=I*o/180,b=b*o/180,a+=Math.cos(I)*Math.cos(b),l+=Math.cos(I)*Math.sin(b),g+=Math.sin(I)});let d=Math.atan2(l,a);const m=Math.sqrt(a*a+l*l);let _=Math.atan2(g,m);return _=_*180/o,d=d*180/o,{lat:_,lng:d}}static getSouthWest(i){return this.getBounds(i).getSouthWest()}static getNorthEast(i){return this.getBounds(i).getNorthEast()}static getNorthWest(i){return this.getBounds(i).getNorthWest()}static getSouthEast(i){return this.getBounds(i).getSouthEast()}static getNorth(i){return this.getBounds(i).getNorth()}static getSouth(i){return this.getBounds(i).getSouth()}static getWest(i){return this.getBounds(i).getWest()}static getEast(i){return this.getBounds(i).getEast()}static getSqmArea(i){const a=new yt.Polygon(i).toGeoJSON();return this.turfHelper.getPolygonArea(a)}static getPerimeter(i){const a=new yt.Polygon(i).toGeoJSON();return this.turfHelper.getPolygonPerimeter(a)*1e3}static getPolygonChecksum(i){const o=i.filter((a,l,g)=>g.indexOf(g.find(d=>d.lat===a.lat&&d.lng===a.lng))===l);return o.reduce((a,l)=>+a+ +l.lat,0)*o.reduce((a,l)=>+a+ +l.lng,0)}static getMidPoint(i,o){const a=this.turfHelper.getMidpoint(i,o);return{lat:a.lat,lng:a.lng}}static getBounds(i){const o=[];return i.forEach(g=>{isNaN(g.lat)||isNaN(g.lng),o.push(g)}),new yt.Polyline(o).getBounds()}}lt(Xs,"turfHelper",new Yu(Gn));class cf{constructor(i){if(lt(this,"polygon",[]),lt(this,"trashcanPoint",[]),lt(this,"sqmArea",[]),lt(this,"perimeter",[]),!!Array.isArray(i)){if(i.length>0&&Array.isArray(i[0])&&i[0].length>0&&typeof i[0][0]=="object"&&"lat"in i[0][0]){const o=i[0];this.trashcanPoint[0]=this.getTrashcanPoint(o),this.sqmArea[0]=this.calculatePolygonArea(o),this.perimeter[0]=this.calculatePolygonPerimeter(o),this.polygon[0]=[o];return}if(i.length>0&&i[0]&&typeof i[0]=="object"&&"lat"in i[0]){const o=[[i]];this.trashcanPoint[0]=this.getTrashcanPoint(i),this.sqmArea[0]=this.calculatePolygonArea(i),this.perimeter[0]=this.calculatePolygonPerimeter(i),this.polygon[0]=o[0];return}i.forEach((o,a)=>{!o||!Array.isArray(o)||!o[0]||!Array.isArray(o[0])||(this.trashcanPoint[a]=this.getTrashcanPoint(o[0]),this.sqmArea[a]=this.calculatePolygonArea(o[0]),this.perimeter[a]=this.calculatePolygonPerimeter(o[0]),this.polygon[a]=o)})}}setSqmArea(i){this.sqmArea[0]=i}getTrashcanPoint(i){if(!Array.isArray(i)||i.length===0)return console.warn("getTrashcanPoint: Invalid polygon array:",i),{lat:0,lng:0};const o=i.filter(x=>x&&typeof x=="object"&&typeof x.lat=="number"&&typeof x.lng=="number"&&!isNaN(x.lat)&&!isNaN(x.lng));if(o.length===0)return console.warn("getTrashcanPoint: No valid coordinates found:",i),{lat:0,lng:0};const a=Math.max(...o.map(x=>x.lat)),l=o.findIndex(x=>x.lat===a);if(l===-1)return console.warn("getTrashcanPoint: Could not find max lat coordinate"),{lat:0,lng:0};let g,d;if(l>0?(g=o[l-1],l<o.length-1?d=o[l+1]:d=o[0]):(g=o[o.length-1],d=o[l+1]),!g||!d)return console.warn("getTrashcanPoint: Could not determine previous/next points"),o[l]||{lat:0,lng:0};const m=g.lng<d.lng?g:d;return Xs.getMidPoint(o[l],m)}calculatePolygonArea(i){return Xs.getSqmArea(i)}calculatePolygonPerimeter(i){return Xs.getPerimeter(i)}}class ff{constructor(i){lt(this,"polygonInfoListeners",[]),lt(this,"polygonDrawStateListeners",[]),lt(this,"polygonInformationStorage",[]),this.mapStateService=i}onPolygonInfoUpdated(i){this.polygonInfoListeners.push(i)}emitPolygonInfoUpdated(){for(const i of this.polygonInfoListeners)i(this.polygonInformationStorage)}onPolygonDrawStateUpdated(i){this.polygonDrawStateListeners.push(i)}emitPolygonDrawStateUpdated(i){for(const o of this.polygonDrawStateListeners)o(i)}updatePolygons(){let i=null;this.polygonInformationStorage.length>0&&(i=[],this.polygonInformationStorage.forEach(o=>{const a=[];o.polygon.forEach(l=>{l.forEach(g=>{const d=[...g];g.length>0&&g[0].toString()!==g[g.length-1].toString()&&d.push(g[0]),a.push(d)})}),i.push(a)})),this.mapStateService.updatePolygons(i),this.saveCurrentState()}saveCurrentState(){this.emitPolygonInfoUpdated()}deleteTrashcan(i){const o=this.polygonInformationStorage.findIndex(a=>a.polygon[0]===i);o!==-1&&(this.polygonInformationStorage.splice(o,1),this.updatePolygons())}deleteTrashCanOnMulti(i){let o=0;this.polygonInformationStorage.forEach((a,l)=>{const g=a.polygon.findIndex(d=>d.toString()===i.toString());g>=0&&(o=l,a.trashcanPoint.splice(g,1),a.sqmArea.splice(g,1),a.perimeter.splice(g,1),a.polygon.splice(g,1))}),this.updatePolygons(),this.polygonInformationStorage.length>1&&this.polygonInformationStorage.splice(o,1)}deletePolygonInformationStorage(){this.polygonInformationStorage=[]}createPolygonInformationStorage(i){i.length>0&&(i.forEach(o=>{var a;const l=(a=o.getLayers)==null?void 0:a.call(o);if(l!=null&&l[0]){const g=l[0].getLatLngs(),d=new cf(g);this.polygonInformationStorage.push(d)}}),this.updatePolygons())}}class gf{constructor(){lt(this,"map",null),lt(this,"mapListeners",[])}onMapUpdated(i){this.map&&i(this.map),this.mapListeners.push(i)}emitMapUpdated(){if(this.map)for(const i of this.mapListeners)i(this.map)}updateMapState(i){this.map=i,this.emitMapUpdated()}updatePolygons(i){}}class df{constructor(i){lt(this,"state"),lt(this,"config"),this.config=i,this.state=this.createInitialState()}createInitialState(){return{polygonDragging:this.config.modes.dragPolygons??!1,markerDragging:this.config.modes.dragElbow??!1,edgeClicking:!0,polygonClicking:!0,canStartDrawing:!0,canCompletePolygon:!1,mapDragging:!0,mapZooming:!0,mapDoubleClickZoom:!0,currentMode:Bt.Off,isDrawingActive:!1,isModifierKeyHeld:!1,showCrosshairCursor:!1,showDragCursor:!1}}updateStateForMode(i){switch(this.state.currentMode=i,i){case Bt.Off:this.setOffModeState();break;case Bt.Add:this.setDrawingModeState();break;case Bt.Subtract:this.setDrawingModeState();break;case Bt.PointToPoint:this.setPointToPointModeState();break}this.state.isDrawingActive=i!==Bt.Off}setOffModeState(){this.state.polygonDragging=this.config.modes.dragPolygons??!1,this.state.markerDragging=this.config.modes.dragElbow??!1,this.state.edgeClicking=!0,this.state.polygonClicking=!0,this.state.canStartDrawing=!0,this.state.canCompletePolygon=!1,this.state.mapDragging=!0,this.state.mapZooming=!0,this.state.mapDoubleClickZoom=!0,this.state.showCrosshairCursor=!1,this.state.showDragCursor=!1}setDrawingModeState(){this.state.polygonDragging=!1,this.state.markerDragging=!1,this.state.edgeClicking=!1,this.state.polygonClicking=!1,this.state.canStartDrawing=!0,this.state.canCompletePolygon=!0,this.state.mapDragging=!1,this.state.mapZooming=!1,this.state.mapDoubleClickZoom=!1,this.state.showCrosshairCursor=!0,this.state.showDragCursor=!1}setPointToPointModeState(){this.state.polygonDragging=!1,this.state.markerDragging=!1,this.state.edgeClicking=!1,this.state.polygonClicking=!1,this.state.canStartDrawing=!0,this.state.canCompletePolygon=!0,this.state.mapDragging=!1,this.state.mapZooming=!1,this.state.mapDoubleClickZoom=!1,this.state.showCrosshairCursor=!0,this.state.showDragCursor=!1}setModifierKeyState(i){this.state.isModifierKeyHeld=i,this.state.currentMode,Bt.Off}canPerformAction(i){switch(i){case"polygonDrag":return this.state.polygonDragging;case"markerDrag":return this.state.markerDragging;case"edgeClick":return this.state.edgeClicking;case"polygonClick":return this.state.polygonClicking;case"startDrawing":return this.state.canStartDrawing;case"completePolygon":return this.state.canCompletePolygon;case"mapDrag":return this.state.mapDragging;case"mapZoom":return this.state.mapZooming;case"mapDoubleClickZoom":return this.state.mapDoubleClickZoom;default:return!1}}isInDrawingMode(){return this.state.isDrawingActive}isInOffMode(){return this.state.currentMode===Bt.Off}getCurrentMode(){return this.state.currentMode}getState(){return{...this.state}}shouldShowCrosshairCursor(){return this.state.showCrosshairCursor}shouldShowDragCursor(){return this.state.showDragCursor}updateConfig(i){this.config=i,this.updateStateForMode(this.state.currentMode)}}class mf{constructor(i){lt(this,"turfHelper"),lt(this,"config"),this.turfHelper=i.turfHelper,this.config=i.config}checkPolygonIntersection(i,o){try{const a=this.turfHelper.isPolygonCompletelyWithin(i,o),l=this.turfHelper.isPolygonCompletelyWithin(o,i);if(a||l)return!0}catch{}try{if(this.turfHelper.polygonIntersect(i,o))return!0}catch{}try{const a=this.turfHelper.getIntersection(i,o);if(a&&a.geometry&&(a.geometry.type==="Polygon"||a.geometry.type==="MultiPolygon")&&this.turfHelper.getPolygonArea(a)>1e-6)return!0}catch{}try{const a=this.turfHelper.getCoords(i),l=this.turfHelper.getCoords(o);for(const g of l)for(const d of g[0]){const m={type:"Feature",geometry:{type:"Point",coordinates:d},properties:{}};if(this.turfHelper.isPolygonCompletelyWithin(m,i))return!0}for(const g of a)for(const d of g[0]){const m={type:"Feature",geometry:{type:"Point",coordinates:d},properties:{}};if(this.turfHelper.isPolygonCompletelyWithin(m,o))return!0}}catch{}return!1}unionPolygons(i,o){try{let a=o;for(const l of i)if(this.shouldCreateDonutPolygon(a,l)){const d=this.createDonutPolygon(a,l);d?a=d:a=this.turfHelper.union(a,l)}else a=this.turfHelper.union(a,l);return{success:!0,result:a}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error in unionPolygons"}}}subtractPolygon(i,o){try{const a=this.turfHelper.polygonDifference(i,o);if(a){const l=this.turfHelper.getCoords(a),g=[];for(const d of l)g.push(this.turfHelper.getMultiPolygon([d]));return{success:!0,results:g}}else return{success:!0,results:[]}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error in subtractPolygon"}}}simplifyPolygon(i){try{const o=this.turfHelper.getCoords(i);if(!o||o.length===0)return{success:!1,error:"Invalid polygon coordinates"};const a=o.map(g=>{const d=g[0];if(d.length<=4)return g;const m=[];for(let w=0;w<d.length;w+=2)m.push(d[w]);const _=m[0],x=m[m.length-1];return(_[0]!==x[0]||_[1]!==x[1])&&m.push(_),m.length<4?g:[m,...g.slice(1)]}),l=this.turfHelper.getMultiPolygon(a);return{success:!0,result:this.turfHelper.getTurfPolygon(l)}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Unknown error in simplifyPolygon"}}}convertToBoundingBox(i){try{const o=this.turfHelper.convertToBoundingBoxPolygon(i);return{success:!0,result:this.turfHelper.getTurfPolygon(o)}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Unknown error in convertToBoundingBox"}}}bezierifyPolygon(i){try{const o=this.turfHelper.getCoords(i),a=this.turfHelper.getBezierMultiPolygon(o);return{success:!0,result:this.turfHelper.getTurfPolygon(a)}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Unknown error in bezierifyPolygon"}}}doubleElbowsPolygon(i){try{const a=[[this.turfHelper.getDoubleElbowLatLngs(i).map(g=>[g.lng,g.lat])]],l=this.turfHelper.getMultiPolygon(a);return{success:!0,result:this.turfHelper.getTurfPolygon(l)}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Unknown error in doubleElbowsPolygon"}}}getPolygonCenter(i){try{if(!i||!i.geometry||!i.geometry.coordinates)return null;let o;if(i.geometry.type==="Polygon")o=i.geometry.coordinates[0];else if(i.geometry.type==="MultiPolygon")o=i.geometry.coordinates[0][0];else return null;if(!Array.isArray(o)||o.length===0)return null;let a=0,l=0,g=0;for(const d of o)if(Array.isArray(d)&&d.length>=2){const m=d[0],_=d[1];typeof m=="number"&&typeof _=="number"&&!isNaN(m)&&!isNaN(_)&&(l+=m,a+=_,g++)}return g===0?null:{lat:a/g,lng:l/g}}catch{return null}}getBoundingBox(i){try{if(!i||!i.geometry||!i.geometry.coordinates)return null;let o;if(i.geometry.type==="Polygon")o=i.geometry.coordinates[0];else if(i.geometry.type==="MultiPolygon")o=i.geometry.coordinates[0][0];else return null;if(!Array.isArray(o)||o.length===0)return null;let a=1/0,l=-1/0,g=1/0,d=-1/0;for(const m of o)if(Array.isArray(m)&&m.length>=2){const _=m[0],x=m[1];typeof _=="number"&&typeof x=="number"&&!isNaN(_)&&!isNaN(x)&&(g=Math.min(g,_),d=Math.max(d,_),a=Math.min(a,x),l=Math.max(l,x))}return a===1/0||l===-1/0||g===1/0||d===-1/0?null:{minLat:a,maxLat:l,minLng:g,maxLng:d}}catch{return null}}shouldCreateDonutPolygon(i,o){try{return!1}catch(a){return console.warn("Error in shouldCreateDonutPolygon:",a.message),!1}}createDonutPolygon(i,o){try{const a=this.turfHelper.getPolygonArea(i),l=this.turfHelper.getPolygonArea(o);let g,d;return a>l?(g=i,d=o):(g=o,d=i),this.turfHelper.isPolygonCompletelyWithin(d,g)?this.createDonutFromContainment(g,d):this.createDonutFromIntersection(g,d)}catch(a){return console.warn("Error in createDonutPolygon:",a.message),null}}createDonutFromContainment(i,o){try{const a=this.turfHelper.getCoords(i),l=this.turfHelper.getCoords(o);return{type:"Feature",geometry:{type:"Polygon",coordinates:[a[0][0],l[0][0]]},properties:{}}}catch(a){return console.warn("Error in createDonutFromContainment:",a.message),null}}createDonutFromIntersection(i,o){try{const a=this.turfHelper.union(i,o);if(!a)return null;const l=this.turfHelper.getIntersection(i,o);return l?this.turfHelper.polygonDifference(a,l):a}catch(a){return console.warn("Error in createDonutFromIntersection:",a.message),null}}}class pf{constructor(i){lt(this,"turfHelper"),lt(this,"map"),lt(this,"config"),lt(this,"modeManager"),lt(this,"tracer"),lt(this,"eventListeners",new Map),lt(this,"p2pMarkers",[]),this.turfHelper=i.turfHelper,this.map=i.map,this.config=i.config,this.modeManager=i.modeManager,this.tracer=i.tracer}on(i,o){this.eventListeners.has(i)||this.eventListeners.set(i,[]),this.eventListeners.get(i).push(o)}emit(i,o){const a=this.eventListeners.get(i);a&&a.forEach(l=>l(o))}mouseMove(i){if("latlng"in i&&i.latlng)this.tracer.addLatLng(i.latlng);else if("touches"in i&&i.touches&&i.touches.length>0){const o=this.map.containerPointToLatLng([i.touches[0].clientX,i.touches[0].clientY]);this.tracer.addLatLng(o)}}async mouseUpLeave(i){const o=this.tracer.toGeoJSON();if(!o||!o.geometry||!o.geometry.coordinates||o.geometry.coordinates.length<3)return{success:!1,error:"Not enough points to form a valid polygon"};let a;try{a=this.turfHelper.createPolygonFromTrace(o)}catch(l){return{success:!1,error:l instanceof Error?l.message:"Failed to create polygon from trace"}}return!a||!a.geometry||!a.geometry.coordinates||a.geometry.coordinates.length===0?{success:!1,error:"Invalid polygon created from trace"}:(this.emit("drawCompleted",{polygon:a,mode:this.modeManager.getCurrentMode()}),{success:!0,polygon:a})}handlePointToPointClick(i){if(!i)return;if(this.tracer.getLatLngs().length>=3&&this.p2pMarkers.length>0){const a=this.p2pMarkers[0].getLatLng();if(this.isClickingFirstPoint(i,a)){this.completePointToPointPolygon();return}}this.tracer.addLatLng(i);try{const a=this.p2pMarkers.length===0,l=a?"leaflet-polydraw-p2p-marker leaflet-polydraw-p2p-first-marker":"leaflet-polydraw-p2p-marker",g=new yt.Marker(i,{icon:yt.divIcon({className:l,iconSize:a?[20,20]:[10,10]})}).addTo(this.map);g.on("mousedown",d=>{yt.DomEvent.stopPropagation(d)}),a&&(g.on("mouseover",()=>{if(this.tracer.getLatLngs().length>=3){const d=g.getElement();d&&(d.style.backgroundColor="#4CAF50",d.style.borderColor="#4CAF50",d.style.cursor="pointer",d.title="Click to close polygon")}}),g.on("mouseout",()=>{const d=g.getElement();d&&(d.style.backgroundColor="",d.style.borderColor="",d.style.cursor="",d.title="")}),g.on("click",d=>{this.tracer.getLatLngs().length>=3&&(yt.DomEvent.stopPropagation(d),this.completePointToPointPolygon())})),this.p2pMarkers.push(g)}catch{}if(this.tracer.getLatLngs().length>=2)try{this.tracer.setStyle({color:this.config.polyLineOptions.color,dashArray:"5, 5"})}catch{}}handleDoubleClick(i){if(this.modeManager.getCurrentMode()!==Bt.PointToPoint)return;this.tracer.getLatLngs().length>=3&&this.completePointToPointPolygon()}completePointToPointPolygon(){const i=this.tracer.getLatLngs();if(i.length<3)return;const o=[...i],a=i[0],l=i[i.length-1];(a.lat!==l.lat||a.lng!==l.lng)&&o.push(a);try{const g=o.map(m=>[m.lng,m.lat]),d=this.turfHelper.getMultiPolygon([[g]]);this.clearP2pMarkers(),this.resetTracer(),this.emit("drawCompleted",{polygon:d,mode:Bt.PointToPoint,isPointToPoint:!0})}catch(g){console.warn("Error completing point-to-point polygon:",g),this.clearP2pMarkers(),this.resetTracer()}}cancelPointToPointDrawing(){this.clearP2pMarkers(),this.resetTracer(),this.emit("drawCancelled",{mode:Bt.PointToPoint})}clearP2pMarkers(){this.p2pMarkers.forEach(i=>this.map.removeLayer(i)),this.p2pMarkers=[]}resetTracer(){this.tracer.setLatLngs([])}isClickingFirstPoint(i,o){if(!o)return!1;const a=this.map.getZoom(),g=5e-4/Math.pow(2,Math.max(0,a-10)),d=Math.abs(i.lat-o.lat),m=Math.abs(i.lng-o.lng);return d<g&&m<g}getP2pMarkers(){return[...this.p2pMarkers]}isInPointToPointMode(){return this.modeManager.getCurrentMode()===Bt.PointToPoint}getTracerPointsCount(){return this.tracer.getLatLngs().length}}class yf{static createDivIcon(i){const o=i.join(" ");return yt.divIcon({className:o})}}class vf{static getBounds(i,o=0){const a=[];i.forEach(d=>{isNaN(d.lat)||isNaN(d.lng),a.push(d)});const g=new yt.Polyline(a).getBounds();return o!==0?g.pad(o):g}}class _f{constructor(i=0,o=0,a=0,l=0){lt(this,"direction",{East:new yt.LatLng(0,0),North:new yt.LatLng(0,0),NorthEast:new yt.LatLng(0,0),NorthWest:new yt.LatLng(0,0),South:new yt.LatLng(0,0),SouthEast:new yt.LatLng(0,0),SouthWest:new yt.LatLng(0,0),West:new yt.LatLng(0,0)}),this.direction.North=new yt.LatLng(a,(o+l)/2),this.direction.NorthEast=new yt.LatLng(a,l),this.direction.East=new yt.LatLng((i+a)/2,l),this.direction.SouthEast=new yt.LatLng(i,l),this.direction.South=new yt.LatLng(i,(o+l)/2),this.direction.SouthWest=new yt.LatLng(i,o),this.direction.West=new yt.LatLng((i+a)/2,o),this.direction.NorthWest=new yt.LatLng(a,o)}getDirection(i){switch(i){case on.SouthWest:return this.direction.SouthWest;case on.West:return this.direction.West;case on.NorthWest:return this.direction.NorthWest;case on.North:return this.direction.North;case on.NorthEast:return this.direction.NorthEast;case on.East:return this.direction.East;case on.SouthEast:return this.direction.SouthEast;case on.South:return this.direction.South;default:throw new Error}}getPositions(i=on.SouthWest,o=!1,a=!0){const l=[],g=this.getPositionAsArray(i,o);return g.forEach(d=>{l.push([d.lng,d.lat])}),a&&l.push([g[0].lng,g[0].lat]),l}getPositionAsArray(i=on.NorthEast,o=!1){const a=[];return o?(a.push(this.direction.SouthWest),a.push(this.direction.West),a.push(this.direction.NorthWest),a.push(this.direction.North),a.push(this.direction.NorthEast),a.push(this.direction.East),a.push(this.direction.SouthEast),a.push(this.direction.South)):(a.push(this.direction.SouthWest),a.push(this.direction.South),a.push(this.direction.SouthEast),a.push(this.direction.East),a.push(this.direction.NorthEast),a.push(this.direction.North),a.push(this.direction.NorthWest),a.push(this.direction.West)),i!==on.SouthWest&&a.splice(0,i).forEach((g,d)=>{a.splice(i+d,0,g)}),a}}class xf{constructor(i,o){if(lt(this,"metricLength",""),lt(this,"metricUnit",""),lt(this,"imperialLength",""),lt(this,"imperialUnit",""),i!==null||i!==void 0){i===0?o.markers.markerInfoIcon.usePerimeterMinValue?(this.metricLength=o.markers.markerInfoIcon.values.min.metric,this.metricUnit=o.markers.markerInfoIcon.units.metric.perimeter.m,this.imperialLength=o.markers.markerInfoIcon.values.min.imperial,this.imperialUnit=o.markers.markerInfoIcon.units.imperial.perimeter.feet):(this.metricLength=o.markers.markerInfoIcon.values.unknown.metric,this.metricUnit=o.markers.markerInfoIcon.units.unknownUnit,this.imperialLength=o.markers.markerInfoIcon.values.unknown.imperial,this.imperialUnit=o.markers.markerInfoIcon.units.unknownUnit):i<100?(this.metricLength=(Math.ceil(i/10)*10).toString(),this.metricUnit=o.markers.markerInfoIcon.units.metric.perimeter.m):i<500?(this.metricLength=(Math.ceil(i/50)*50).toString(),this.metricUnit=o.markers.markerInfoIcon.units.metric.perimeter.m):i<1e3?(this.metricLength=(Math.ceil(i/100)*100).toString(),this.metricUnit=o.markers.markerInfoIcon.units.metric.perimeter.m):i<1e4?(this.metricLength=(Math.ceil(i/100)*100/1e3).toFixed(1),this.metricUnit=o.markers.markerInfoIcon.units.metric.perimeter.km):(this.metricLength=(Math.ceil(i/1e3)*1e3/1e3).toString(),this.metricUnit=o.markers.markerInfoIcon.units.metric.perimeter.km);const l=i/.0254/12,g=l/3,d=g/1760;i<1e3/2.54?(this.imperialLength=(Math.ceil(l/10)*10).toString(),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.perimeter.feet):i<1e3/2.54*3?(this.imperialLength=(Math.ceil(g/10)*10).toString(),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.perimeter.yards):i<1609?(this.imperialLength=d.toFixed(2),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.perimeter.miles):i<16093?(this.imperialLength=d.toFixed(1),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.perimeter.miles):(this.imperialLength=d.toFixed(0),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.perimeter.miles)}}}class kf{constructor(i,o){lt(this,"metricArea",""),lt(this,"metricUnit",""),lt(this,"imperialArea",""),lt(this,"imperialUnit","");const a=i,l=o.markers.markerInfoIcon.units.metric.onlyMetrics;if(a!==null||a!==void 0){a===0?(this.metricArea="-",this.metricUnit=o.markers.markerInfoIcon.units.unknownUnit,this.imperialArea="-",this.imperialUnit=o.markers.markerInfoIcon.units.unknownUnit):a<1e4?(this.metricArea=Math.round(a).toString(),this.metricUnit=o.markers.markerInfoIcon.units.metric.area.m2):a<1e5?l?(this.metricArea=(a/1e6).toFixed(2),this.metricUnit=o.markers.markerInfoIcon.units.metric.area.km2):(this.metricArea=(a/1e3).toFixed(1),this.metricUnit=o.markers.markerInfoIcon.units.metric.area.daa):a<1e7?l?(this.metricArea=(a/1e6).toFixed(2),this.metricUnit=o.markers.markerInfoIcon.units.metric.area.km2):(this.metricArea=Math.round(a/1e3).toString(),this.metricUnit=o.markers.markerInfoIcon.units.metric.area.daa):a<1e8?l?(this.metricArea=(a/1e6).toFixed(1),this.metricUnit=o.markers.markerInfoIcon.units.metric.area.km2):(this.metricArea=Math.round(a/1e4).toString(),this.metricUnit=o.markers.markerInfoIcon.units.metric.area.ha):(this.metricArea=Math.round(a/1e6).toString(),this.metricUnit=o.markers.markerInfoIcon.units.metric.area.km2);const d=a*1550*.0069444,m=d*.11111,_=m*20661e-8,x=m*32283e-11;a<92.9?(this.imperialArea=Math.round(d).toString(),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.area.feet2):a<836.14?(this.imperialArea=m.toFixed(0),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.area.yards2):a<40469.6?(this.imperialArea=_.toFixed(2),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.area.acres):a<404696?(this.imperialArea=_.toFixed(1),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.area.acres):a<4046960?(this.imperialArea=_.toFixed(0),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.area.acres):a<25900404?(this.imperialArea=x.toFixed(2),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.area.miles2):a<259004040?(this.imperialArea=x.toFixed(1),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.area.miles2):(this.imperialArea=x.toFixed(0),this.imperialUnit=o.markers.markerInfoIcon.units.imperial.area.miles2)}}}class wf{constructor(i,o){lt(this,"turfHelper"),lt(this,"polygonInformation"),lt(this,"map"),lt(this,"config"),lt(this,"modeManager"),lt(this,"eventListeners",new Map),lt(this,"currentDragPolygon",null),lt(this,"currentModifierDragMode",!1),lt(this,"isModifierKeyHeld",!1),lt(this,"getFeatureGroups"),lt(this,"addFeatureGroup"),lt(this,"removeFeatureGroup"),lt(this,"onPolygonMouseMove",a=>{if(!this.currentDragPolygon||!this.currentDragPolygon._polydrawDragData.isDragging)return;const l=this.currentDragPolygon,g=l._polydrawDragData,d=a.originalEvent&&"metaKey"in a.originalEvent?a.originalEvent:a;this.detectModifierKey(d)!==this.currentModifierDragMode&&this.handleModifierToggleDuringDrag(d);const _=g.startPosition,x=a.latlng,w=x.lat-_.lat,I=x.lng-_.lng,b=this.offsetPolygonCoordinates(g.startLatLngs,w,I);l.setLatLngs(b),this.updateMarkersAndHoleLinesDuringDrag(l,w,I)}),lt(this,"onPolygonMouseUp",a=>{if(!this.currentDragPolygon||!this.currentDragPolygon._polydrawDragData.isDragging)return;const l=this.currentDragPolygon,g=l._polydrawDragData;g.isDragging=!1,this.map.off("mousemove",this.onPolygonMouseMove,this),this.map.off("mouseup",this.onPolygonMouseUp,this),this.map.dragging&&this.map.dragging.enable();try{const d=this.map.getContainer();d.style.cursor=""}catch{}this.updatePolygonAfterDrag(l),l._polydrawOriginalMarkerPositions&&(l._polydrawOriginalMarkerPositions.clear(),delete l._polydrawOriginalMarkerPositions),l._polydrawOriginalHoleLinePositions&&(l._polydrawOriginalHoleLinePositions.clear(),delete l._polydrawOriginalHoleLinePositions),l._polydrawCurrentDragSession&&delete l._polydrawCurrentDragSession,this.currentDragPolygon=null}),lt(this,"onMarkerHoverForEdgeDeletionEvent",a=>{if(!this.isModifierKeyHeld)return;const l=a.target;l&&(l.style.backgroundColor="#D9460F",l.style.borderColor="#D9460F",l.classList.add("edge-deletion-hover"))}),lt(this,"onMarkerLeaveForEdgeDeletionEvent",a=>{const l=a.target;l&&(l.style.backgroundColor="",l.style.borderColor="",l.classList.remove("edge-deletion-hover"))}),this.turfHelper=i.turfHelper,this.polygonInformation=i.polygonInformation,this.map=i.map,this.config=i.config,this.modeManager=i.modeManager,this.getFeatureGroups=o.getFeatureGroups,this.addFeatureGroup=o.addFeatureGroup,this.removeFeatureGroup=o.removeFeatureGroup}on(i,o){this.eventListeners.has(i)||this.eventListeners.set(i,[]),this.eventListeners.get(i).push(o)}emit(i,o){const a=this.eventListeners.get(i);a&&a.forEach(l=>l(o))}addMarkers(i,o){let a=this.getMarkerIndex(i,this.config.markers.markerMenuIcon.position),l=this.getMarkerIndex(i,this.config.markers.markerDeleteIcon.position),g=this.getMarkerIndex(i,this.config.markers.markerInfoIcon.position);const d=this.ensureMarkerSeparation(i.length,{menu:{index:a,enabled:this.config.markers.menuMarker},delete:{index:l,enabled:this.config.markers.deleteMarker},info:{index:g,enabled:this.config.markers.infoMarker}});a=d.menu,l=d.delete,g=d.info,i.forEach((m,_)=>{let x=this.config.markers.markerIcon.styleClasses;_===a&&this.config.markers.menuMarker&&(x=this.config.markers.markerMenuIcon.styleClasses),_===l&&this.config.markers.deleteMarker&&(x=this.config.markers.markerDeleteIcon.styleClasses),_===g&&this.config.markers.infoMarker&&(x=this.config.markers.markerInfoIcon.styleClasses);const w=Array.isArray(x)?x:[x],I=new yt.Marker(m,{icon:this.createDivIcon(w),draggable:this.config.modes.dragElbow,title:this.config.markers.coordsTitle?this.getLatLngInfoString(m):"",zIndexOffset:this.config.markers.markerIcon.zIndexOffset??this.config.markers.zIndexOffset});if(o.addLayer(I).addTo(this.map),_===a||_===l||_===g){const b=I.getElement();b&&(b.style.zIndex="10000")}if(this.config.modes.dragElbow&&(I.on("drag",b=>{this.modeManager.canPerformAction("markerDrag")&&this.markerDrag(o)}),I.on("dragend",b=>{this.modeManager.canPerformAction("markerDrag")&&this.markerDragEnd(o)})),_===a&&this.config.markers.menuMarker){const b=this.generateMenuMarkerPopup(i,o);I.options.zIndexOffset=this.config.markers.markerMenuIcon.zIndexOffset??this.config.markers.zIndexOffset,I.bindPopup(b,{className:"alter-marker"})}if(_===g&&this.config.markers.infoMarker){const b=this.getPolygonGeoJSONFromFeatureGroup(o),F=this.turfHelper.getPolygonArea(b),z=this.getTotalPolygonPerimeter(b),et=this.generateInfoMarkerPopup(F,z);I.options.zIndexOffset=this.config.markers.markerInfoIcon.zIndexOffset??this.config.markers.zIndexOffset,I.bindPopup(et,{className:"info-marker"})}I.on("mousedown",b=>{this.modeManager.isInOffMode()||(yt.DomEvent.stopPropagation(b),this.map.fire("mousedown",b))}),I.on("click",b=>{var F;if(this.modeManager.isInOffMode())if(this.isModifierKeyPressed(b.originalEvent)){const z=(F=o.getLayers().find(et=>et instanceof yt.Polygon))==null?void 0:F.toGeoJSON();z&&this.elbowClicked(b,z)}else _===l&&this.config.markers.deleteMarker&&(this.removeFeatureGroup(o),this.polygonInformation.createPolygonInformationStorage(this.getFeatureGroups()),this.emit("polygonDeleted"))}),I.on("mouseover",()=>this.onMarkerHoverForEdgeDeletion(I,!0)),I.on("mouseout",()=>this.onMarkerHoverForEdgeDeletion(I,!1))})}addHoleMarkers(i,o){i.forEach((a,l)=>{const g=this.config.markers.holeIcon.styleClasses,d=Array.isArray(g)?g:[g],m=new yt.Marker(a,{icon:this.createDivIcon(d),draggable:!0,title:this.getLatLngInfoString(a),zIndexOffset:this.config.markers.holeIcon.zIndexOffset??this.config.markers.zIndexOffset});o.addLayer(m).addTo(this.map),m.on("drag",_=>{this.markerDrag(o)}),m.on("dragend",_=>{this.markerDragEnd(o)})})}addEdgeClickListeners(i,o){const a=i.getLatLngs();let l;if(Array.isArray(a)&&a.length>0)if(Array.isArray(a[0]))if(Array.isArray(a[0][0])&&a[0][0].length>0){const g=a[0][0][0];g&&typeof g=="object"&&"lat"in g,l=a[0]}else a[0][0]&&typeof a[0][0]=="object"&&"lat"in a[0][0]?l=a:l=a[0];else a[0]&&typeof a[0]=="object"&&"lat"in a[0]?l=[a]:l=[a];else return;l.forEach((g,d)=>{for(let m=0;m<g.length;m++){const _=g[m],x=g[(m+1)%g.length];if(_.lat===x.lat&&_.lng===x.lng)continue;const w=yt.polyline([_,x],{color:"transparent",weight:10,opacity:0,interactive:!0});w._polydrawEdgeInfo={ringIndex:d,edgeIndex:m,startPoint:_,endPoint:x,parentPolygon:i,parentFeatureGroup:o},w.on("click",I=>{this.onEdgeClick(I,w)}),w.on("mouseover",()=>{this.highlightEdgeOnHover(w,!0)}),w.on("mouseout",()=>{this.highlightEdgeOnHover(w,!1)}),o.addLayer(w)}})}enablePolygonDragging(i,o){this.config.modes.dragPolygons&&(i._polydrawOriginalLatLngs=o,i._polydrawDragData={isDragging:!1,startPosition:null,startLatLngs:null},i.on("mousedown",a=>{if(!this.modeManager.isInOffMode()){yt.DomEvent.stopPropagation(a),this.map.fire("mousedown",a);return}if(!this.modeManager.canPerformAction("polygonDrag"))return;yt.DomEvent.stopPropagation(a),yt.DomEvent.preventDefault(a);const l=this.detectModifierKey(a.originalEvent||a);this.currentModifierDragMode=l,this.isModifierKeyHeld=l,i._polydrawDragData.isDragging=!0,i._polydrawDragData.startPosition=a.latlng,i._polydrawDragData.startLatLngs=i.getLatLngs(),this.map.dragging&&this.map.dragging.disable(),this.setSubtractVisualMode(i,l);try{const g=this.map.getContainer();g.style.cursor=this.config.dragPolygons.dragCursor||"move"}catch{}this.map.on("mousemove",this.onPolygonMouseMove,this),this.map.on("mouseup",this.onPolygonMouseUp,this),this.currentDragPolygon=i}),i.on("mouseover",()=>{if(!i._polydrawDragData.isDragging)try{const a=this.map.getContainer();a.style.cursor=this.config.dragPolygons.hoverCursor||"grab"}catch{}}),i.on("mouseout",()=>{if(!i._polydrawDragData.isDragging)try{const a=this.map.getContainer();a.style.cursor=""}catch{}}))}updateMarkerDraggableState(){const i=this.modeManager.canPerformAction("markerDrag");this.getFeatureGroups().forEach(o=>{o.eachLayer(a=>{if(a instanceof yt.Marker){const l=a;try{l.options.draggable=i,l.dragging&&(i?l.dragging.enable():l.dragging.disable())}catch{}}})})}updateAllMarkersForEdgeDeletion(i){this.getFeatureGroups().forEach(o=>{o.eachLayer(a=>{a instanceof yt.Marker&&this.updateMarkerForEdgeDeletion(a,i)})})}updateMarkerForEdgeDeletion(i,o){const a=i.getElement();a&&(o?(a.addEventListener("mouseenter",this.onMarkerHoverForEdgeDeletionEvent),a.addEventListener("mouseleave",this.onMarkerLeaveForEdgeDeletionEvent)):(a.removeEventListener("mouseenter",this.onMarkerHoverForEdgeDeletionEvent),a.removeEventListener("mouseleave",this.onMarkerLeaveForEdgeDeletionEvent),a.style.backgroundColor="",a.style.borderColor=""))}setModifierKeyHeld(i){this.isModifierKeyHeld=i}onEdgeClick(i,o){if(!this.config.modes.attachElbow||!this.modeManager.isInOffMode())return;const a=o._polydrawEdgeInfo;if(!a)return;const l=i.latlng,g=a.parentPolygon,d=a.parentFeatureGroup;if(g&&d)try{if(typeof g.toGeoJSON!="function")return;const m=g.toGeoJSON();if(m.geometry.type==="MultiPolygon"||m.geometry.type==="Polygon"){const _=this.turfHelper.injectPointToPolygon(m,[l.lng,l.lat]);if(_){const w=g._polydrawOptimizationLevel||0;this.removeFeatureGroup(d),this.emit("polygonModified",{operation:"addVertex",polygon:_,optimizationLevel:w})}}}catch{}yt.DomEvent.stopPropagation(i)}highlightEdgeOnHover(i,o){o?i.setStyle({color:"#7a9441",weight:4,opacity:1}):i.setStyle({color:"transparent",weight:10,opacity:0})}elbowClicked(i,o){if(!this.config.modes.edgeDeletion||!this.isModifierKeyPressed(i.originalEvent))return;const a=i.latlng,l=o.geometry.coordinates[0];let g=-1,d=-1;for(let I=0;I<l.length;I++){const F=l[I].findIndex(z=>Math.abs(z[1]-a.lat)<1e-4&&Math.abs(z[0]-a.lng)<1e-4);if(F!==-1){g=I,d=F;break}}if(g===-1||d===-1||l[g].length<=4)return;const _=l.map((I,b)=>{if(b===g){const F=[...I];return F.splice(d,1),F}else return[...I]}),x=this.findFeatureGroupForPoly(o);x&&this.removeFeatureGroup(x);const w=this.turfHelper.getMultiPolygon([_]);this.emit("polygonModified",{operation:"removeVertex",polygon:w})}findFeatureGroupForPoly(i){for(const o of this.getFeatureGroups()){const a=o.toGeoJSON();if(a&&a.features&&a.features[0]){const l=a.features[0];if(JSON.stringify(l.geometry.coordinates)===JSON.stringify(i.geometry.coordinates))return o}}return null}markerDrag(i){const o=[];let a=[],l=[];const g=i.getLayers(),d=g[0].getLatLngs();let m=0;const _=g.filter(x=>x instanceof yt.Marker);if(d.length>1)for(let x=0;x<d.length;x++)if(a=[],l=[],x===0){if(d[0].length>1)for(let w=0;w<d[0].length;w++){for(let I=0;I<d[0][w].length;I++)_[I]&&a.push(_[I].getLatLng());l.push(a)}else{for(let w=0;w<d[0][0].length;w++)_[w]&&a.push(_[w].getLatLng());l.push(a)}o.push(l)}else{m+=d[x-1][0].length;for(let w=m;w<d[x][0].length+m;w++)_[w]&&a.push(_[w].getLatLng());l.push(a),o.push(l)}else{l=[];let x=0;for(let w=0;w<d[0].length;w++){if(a=[],w===0)if(d[0][w].length>1)for(let I=0;I<d[0][w].length;I++)_[I]&&a.push(_[I].getLatLng());else for(let I=0;I<d[0][0].length;I++)_[I]&&a.push(_[I].getLatLng());else{x+=d[0][w-1].length;for(let I=x;I<d[0][w].length+x;I++)_[I]&&a.push(_[I].getLatLng())}l.push(a)}o.push(l)}g[0].setLatLngs(o)}async markerDragEnd(i){this.polygonInformation.deletePolygonInformationStorage();const o=i.toGeoJSON();if(this.removeFeatureGroup(i),o.features[0].geometry.coordinates.length>1)for(const a of o.features[0].geometry.coordinates){const l=this.turfHelper.getMultiPolygon([a]);if(this.turfHelper.hasKinks(l)){const g=this.turfHelper.getKinks(l);for(const d of g)this.emit("polygonModified",{operation:"markerDrag",polygon:this.turfHelper.getTurfPolygon(d),allowMerge:!0})}else this.emit("polygonModified",{operation:"markerDrag",polygon:l,allowMerge:!0})}else{const a=this.turfHelper.getMultiPolygon(o.features[0].geometry.coordinates);if(this.turfHelper.hasKinks(a)){const l=this.turfHelper.getKinks(a);for(const g of l)this.emit("polygonModified",{operation:"markerDrag",polygon:this.turfHelper.getTurfPolygon(g),allowMerge:!0})}else this.emit("polygonModified",{operation:"markerDrag",polygon:a,allowMerge:!0})}this.polygonInformation.createPolygonInformationStorage(this.getFeatureGroups())}offsetPolygonCoordinates(i,o,a){return i&&(Array.isArray(i[0])?i.map(l=>this.offsetPolygonCoordinates(l,o,a)):i.lat!==void 0&&i.lng!==void 0?{lat:i.lat+o,lng:i.lng+a}:i.map(l=>this.offsetPolygonCoordinates(l,o,a)))}updateMarkersAndHoleLinesDuringDrag(i,o,a){try{let l=null;for(const d of this.getFeatureGroups()){let m=!1;if(d.eachLayer(_=>{_===i&&(m=!0)}),m){l=d;break}}if(!l)return;const g="_polydrawDragSession_"+Date.now()+"_"+yt.Util.stamp(i);i._polydrawCurrentDragSession||(i._polydrawCurrentDragSession=g,i._polydrawOriginalMarkerPositions=new Map,i._polydrawOriginalHoleLinePositions=new Map,l.eachLayer(d=>{d instanceof yt.Marker?i._polydrawOriginalMarkerPositions.set(d,d.getLatLng()):d instanceof yt.Polyline&&!(d instanceof yt.Polygon)&&i._polydrawOriginalHoleLinePositions.set(d,d.getLatLngs())})),l.eachLayer(d=>{if(d instanceof yt.Marker){const m=i._polydrawOriginalMarkerPositions.get(d);if(m){const _={lat:m.lat+o,lng:m.lng+a};d.setLatLng(_)}}else if(d instanceof yt.Polyline&&!(d instanceof yt.Polygon)){const m=i._polydrawOriginalHoleLinePositions.get(d);if(m){const _=m.map(x=>({lat:x.lat+o,lng:x.lng+a}));d.setLatLngs(_)}}})}catch(l){console.warn("Error updating markers during drag:",l)}}async updatePolygonAfterDrag(i){try{let o=null;for(const g of this.getFeatureGroups())if(g.eachLayer(d=>{d===i&&(o=g)}),o)break;if(!o)return;const a=i.toGeoJSON();if(this.isModifierDragActive()){this.performModifierSubtract(a,o),this.currentModifierDragMode=!1,this.isModifierKeyHeld=!1;return}this.removeFeatureGroup(o);const l=this.turfHelper.getTurfPolygon(a);this.emit("polygonModified",{operation:"polygonDrag",polygon:l,allowMerge:!0}),this.polygonInformation.createPolygonInformationStorage(this.getFeatureGroups())}catch{}}detectModifierKey(i){var o,a;return(a=(o=this.config.dragPolygons)==null?void 0:o.modifierSubtract)!=null&&a.enabled?navigator.userAgent.toLowerCase().includes("mac")?i.metaKey:i.ctrlKey:!1}setSubtractVisualMode(i,o){if(!(!i||!i.setStyle))try{o?i.setStyle({color:this.config.dragPolygons.modifierSubtract.subtractColor}):i.setStyle({color:this.config.polygonOptions.color}),this.updateMarkerColorsForSubtractMode(i,o)}catch{}}updateMarkerColorsForSubtractMode(i,o){var a,l;try{let g=null;for(const m of this.getFeatureGroups())if(m.eachLayer(_=>{_===i&&(g=m)}),g)break;if(!g)return;const d=((l=(a=this.config.dragPolygons)==null?void 0:a.modifierSubtract)==null?void 0:l.hideMarkersOnDrag)??!1;g.eachLayer(m=>{if(m instanceof yt.Marker){const x=m.getElement();x&&(o?d?(x.style.display="none",x.classList.add("subtract-mode-hidden")):(x.style.backgroundColor=this.config.dragPolygons.modifierSubtract.subtractColor,x.style.borderColor=this.config.dragPolygons.modifierSubtract.subtractColor,x.classList.add("subtract-mode")):d?(x.style.display="",x.classList.remove("subtract-mode-hidden")):(x.style.backgroundColor="",x.style.borderColor="",x.classList.remove("subtract-mode")))}})}catch{}}handleModifierToggleDuringDrag(i){const o=this.detectModifierKey(i);this.currentModifierDragMode=o,this.isModifierKeyHeld=o,this.currentDragPolygon&&this.setSubtractVisualMode(this.currentDragPolygon,o)}isModifierDragActive(){return this.currentModifierDragMode}performModifierSubtract(i,o){try{const a=this.turfHelper.getTurfPolygon(i),l=[];this.getFeatureGroups().forEach(g=>{if(g!==o)try{const d=g.toGeoJSON();if(!d||!d.features||!d.features[0])return;const m=d.features[0];if(!m.geometry||!m.geometry.coordinates)return;const _=this.turfHelper.getTurfPolygon(m);try{const x=this.turfHelper.getIntersection(_,a);x&&x.geometry&&x.geometry.coordinates.length>0&&l.push(g)}catch{try{this.turfHelper.polygonIntersect(_,a)&&l.push(g)}catch{}}}catch{}}),this.removeFeatureGroup(o),l.forEach(g=>{try{const d=g.toGeoJSON(),m=this.turfHelper.getTurfPolygon(d.features[0]);this.removeFeatureGroup(g);try{const _=this.turfHelper.polygonDifference(m,a);if(_&&_.geometry){const x=this.turfHelper.getCoords(_);for(const w of x){const I=this.turfHelper.getMultiPolygon([w]);this.emit("polygonModified",{operation:"modifierSubtract",polygon:this.turfHelper.getTurfPolygon(I),allowMerge:!1})}}}catch(_){console.warn("Failed to perform difference operation:",_),this.emit("polygonModified",{operation:"modifierSubtractFallback",polygon:m,allowMerge:!1})}}catch(d){console.warn("Error in modifier subtract operation:",d)}}),this.polygonInformation.createPolygonInformationStorage(this.getFeatureGroups())}catch(a){console.warn("Error in performModifierSubtract:",a)}}boundingBoxesOverlap(i,o){return!(i[2]<o[0]||o[2]<i[0]||i[3]<o[1]||o[3]<i[1])}isModifierKeyPressed(i){return navigator.userAgent.toLowerCase().includes("mac")?i.metaKey:i.ctrlKey}onMarkerHoverForEdgeDeletion(i,o){const a=i.getElement();if(a)if(o){const l=d=>{var m,_,x,w;if(this.detectModifierKey(d)){a.style.backgroundColor=((_=(m=this.config.dragPolygons)==null?void 0:m.modifierSubtract)==null?void 0:_.subtractColor)||"#D9460F",a.style.borderColor=((w=(x=this.config.dragPolygons)==null?void 0:x.modifierSubtract)==null?void 0:w.subtractColor)||"#D9460F",a.classList.add("edge-deletion-hover");try{const b=this.map.getContainer();b.style.cursor="pointer"}catch{}}else{a.style.backgroundColor="",a.style.borderColor="",a.classList.remove("edge-deletion-hover");try{const b=this.map.getContainer();b.style.cursor=""}catch{}}},g=new MouseEvent("mouseover");l(g),i._polydrawModifierHandler=l,document.addEventListener("keydown",l),document.addEventListener("keyup",l),a.addEventListener("mousemove",l)}else{a.style.backgroundColor="",a.style.borderColor="",a.classList.remove("edge-deletion-hover");try{const g=this.map.getContainer();g.style.cursor=""}catch{}const l=i._polydrawModifierHandler;l&&(document.removeEventListener("keydown",l),document.removeEventListener("keyup",l),a.removeEventListener("mousemove",l),delete i._polydrawModifierHandler)}}getMarkerIndex(i,o){const a=vf.getBounds(i,Math.sqrt(2)/2),g=new _f(a.getSouth(),a.getWest(),a.getNorth(),a.getEast()).getDirection(o),d={lat:g.lat,lng:g.lng},m=this.turfHelper.getCoord(d),_=this.turfHelper.getFeaturePointCollection(i);return this.turfHelper.getNearestPointIndex(m,_)}ensureMarkerSeparation(i,o){const a=[];if(o.menu.enabled&&a.push({type:"menu",index:o.menu.index}),o.delete.enabled&&a.push({type:"delete",index:o.delete.index}),o.info.enabled&&a.push({type:"info",index:o.info.index}),a.length<2)return{menu:o.menu.index,delete:o.delete.index,info:o.info.index};const l={...o},g=new Set,d=["info","delete","menu"];for(const m of d){const _=l[m];if(_.enabled)if(g.has(_.index)){const x=this.findAlternativeMarkerPosition(i,_.index,g);l[m].index=x,g.add(x)}else g.add(_.index)}return{menu:l.menu.index,delete:l.delete.index,info:l.info.index}}findAlternativeMarkerPosition(i,o,a){const l=i,g=Math.max(1,Math.floor(i/8));for(let d=1;d<l;d++){const m=[(o+d*g)%i,(o-d*g+i)%i];for(const _ of m)if(!a.has(_))return _}for(let d=0;d<i;d++)if(!a.has(d))return d;return o}createDivIcon(i){return yf.createDivIcon(i)}getLatLngInfoString(i){return"Latitude: "+i.lat+" Longitude: "+i.lng}generateMenuMarkerPopup(i,o){const a=document.createElement("div");a.classList.add("alter-marker-outer-wrapper");const l=document.createElement("div");l.classList.add("alter-marker-wrapper");const g=document.createElement("i");g.classList.add("inverted-corner");const d=document.createElement("div");d.classList.add("content");const m=document.createElement("div");m.classList.add("marker-menu-content");const _=document.createElement("div");_.classList.add("marker-menu-button","simplify"),_.title="Simplify";const x=document.createElement("div");x.classList.add("marker-menu-button","double-elbows"),x.title="DoubleElbows";const w=document.createElement("div");w.classList.add("marker-menu-button","bbox"),w.title="Bounding box";const I=document.createElement("div");I.classList.add("marker-menu-button","bezier"),I.title="Curve";const b=document.createElement("div");return b.classList.add("separator"),a.appendChild(l),l.appendChild(g),l.appendChild(d),d.appendChild(m),m.appendChild(_),m.appendChild(b.cloneNode()),m.appendChild(x),m.appendChild(b.cloneNode()),m.appendChild(w),m.appendChild(b.cloneNode()),m.appendChild(I),_.onclick=()=>{this.emit("menuAction",{action:"simplify",latLngs:i,featureGroup:o})},w.onclick=()=>{this.emit("menuAction",{action:"bbox",latLngs:i,featureGroup:o})},x.onclick=()=>{this.emit("menuAction",{action:"doubleElbows",latLngs:i,featureGroup:o})},I.onclick=()=>{this.emit("menuAction",{action:"bezier",latLngs:i,featureGroup:o})},a}getPolygonGeoJSONFromFeatureGroup(i){try{let o=null;if(i.eachLayer(a=>{a instanceof yt.Polygon&&(o=a)}),!o)throw new Error("No polygon found in feature group");return o.toGeoJSON()}catch(o){return console.warn("Error getting polygon GeoJSON from feature group:",o.message),{type:"Feature",geometry:{type:"Polygon",coordinates:[[[0,0],[0,1],[1,1],[1,0],[0,0]]]},properties:{}}}}getTotalPolygonPerimeter(i){try{if(!i||!i.geometry)return 0;let o=0;if(i.geometry.type==="Polygon"){const a=i.geometry.coordinates;for(const l of a){const g={type:"Feature",geometry:{type:"Polygon",coordinates:[l]},properties:{}},d=this.turfHelper.getPolygonPerimeter(g);o+=d}}else if(i.geometry.type==="MultiPolygon"){const a=i.geometry.coordinates;for(const l of a)for(const g of l){const d={type:"Feature",geometry:{type:"Polygon",coordinates:[g]},properties:{}},m=this.turfHelper.getPolygonPerimeter(d);o+=m}}return o*1e3}catch(o){return console.warn("Error calculating total polygon perimeter:",o.message),this.turfHelper.getPolygonPerimeter(i)*1e3}}generateInfoMarkerPopup(i,o){const a=new xf(o,this.config),l=new kf(i,this.config),g=document.createElement("div");g.classList.add("info-marker-outer-wrapper");const d=document.createElement("div");d.classList.add("info-marker-wrapper");const m=document.createElement("i");m.classList.add("inverted-corner");const _=document.createElement("div");_.classList.add("content");const x=document.createElement("div");x.classList.add("info-marker-content");const w=document.createElement("div");w.classList.add("info-item","area"),w.innerHTML=`<strong>Area:</strong> ${l.metricArea} ${l.metricUnit}`;const I=document.createElement("div");return I.classList.add("info-item","perimeter"),I.innerHTML=`<strong>Perimeter:</strong> ${a.metricLength} ${a.metricUnit}`,x.appendChild(w),x.appendChild(I),_.appendChild(x),g.appendChild(d),d.appendChild(m),d.appendChild(_),g}}class Ef{constructor(i){lt(this,"turfHelper"),lt(this,"polygonInformation"),lt(this,"map"),lt(this,"config"),lt(this,"modeManager"),lt(this,"getFeatureGroups"),lt(this,"eventListeners",new Map),lt(this,"geometryManager"),lt(this,"drawManager"),lt(this,"interactionManager"),this.turfHelper=i.turfHelper,this.polygonInformation=i.polygonInformation,this.map=i.map,this.config=i.config,this.modeManager=i.modeManager,this.getFeatureGroups=i.getFeatureGroups,this.initializeSpecializedManagers(i)}initializeSpecializedManagers(i){this.geometryManager=new mf({turfHelper:i.turfHelper,config:i.config});const o=yt.polyline([],this.config.polyLineOptions);this.drawManager=new pf({turfHelper:i.turfHelper,map:i.map,config:i.config,modeManager:i.modeManager,tracer:o}),this.interactionManager=new wf({turfHelper:i.turfHelper,polygonInformation:i.polygonInformation,map:i.map,config:i.config,modeManager:i.modeManager},{getFeatureGroups:this.getFeatureGroups,addFeatureGroup:a=>this.addFeatureGroupInternal(a),removeFeatureGroup:a=>this.removeFeatureGroupInternal(a)}),this.setupEventForwarding()}setupEventForwarding(){this.drawManager.on("drawCompleted",i=>{this.handleDrawCompleted(i)}),this.drawManager.on("drawCancelled",i=>{this.emit("drawCancelled",i)}),this.interactionManager.on("polygonModified",i=>{this.handlePolygonModified(i)}),this.interactionManager.on("menuAction",i=>{this.handleMenuAction(i)}),this.interactionManager.on("checkIntersection",i=>{const o=this.geometryManager.checkPolygonIntersection(i.polygon1,i.polygon2);i.callback(o)}),this.interactionManager.on("performSubtractOperation",i=>{this.subtractPolygon(i.subtractPolygon)}),this.interactionManager.on("polygonDeleted",()=>{this.emit("polygonDeleted")})}async handleDrawCompleted(i){await this.addPolygon(i.polygon,{simplify:!0})}async handlePolygonModified(i){const a={simplify:i.operation!=="addVertex"&&i.operation!=="markerDrag"&&i.operation!=="polygonDrag",noMerge:!i.allowMerge,visualOptimizationLevel:i.optimizationLevel||0};await this.addPolygon(i.polygon,a)}async handleMenuAction(i){const{action:o,latLngs:a,featureGroup:l}=i;this.removeFeatureGroupInternal(l);let g;switch(o){case"simplify":{const d=[[a.map(_=>[_.lng,_.lat])]],m=this.turfHelper.getMultiPolygon(d);g=this.geometryManager.simplifyPolygon(this.turfHelper.getTurfPolygon(m));break}case"bbox":{const d=[[a.map(_=>[_.lng,_.lat])]],m=this.turfHelper.getMultiPolygon(d);g=this.geometryManager.convertToBoundingBox(this.turfHelper.getTurfPolygon(m));break}case"doubleElbows":{g=this.geometryManager.doubleElbowsPolygon(a);break}case"bezier":{const d=[[a.map(_=>[_.lng,_.lat])]],m=this.turfHelper.getMultiPolygon(d);g=this.geometryManager.bezierifyPolygon(this.turfHelper.getTurfPolygon(m));break}default:return}g.success&&g.result&&await this.addPolygon(g.result,{simplify:!1})}get polygonInteractionManager(){return this.interactionManager}on(i,o){this.eventListeners.has(i)||this.eventListeners.set(i,[]),this.eventListeners.get(i).push(o)}emit(i,o){const a=this.eventListeners.get(i);a&&a.forEach(l=>l(o))}async addPolygon(i,o={}){const{simplify:a=!0,noMerge:l=!1}=o;try{return this.config.mergePolygons&&!l&&this.getFeatureGroups().length>0&&!this.config.kinks?await this.mergePolygon(i,o):await this.addPolygonLayer(i,o)}catch(g){return{success:!1,error:g instanceof Error?g.message:"Unknown error in addPolygon"}}}async subtractPolygon(i){try{const o=[];this.getFeatureGroups().forEach(l=>{try{const g=l.toGeoJSON();if(!g||!g.features||!g.features[0])return;const d=g.features[0];if(!d.geometry||!d.geometry.coordinates)return;const m=this.turfHelper.getTurfPolygon(d);this.geometryManager.checkPolygonIntersection(m,i)&&o.push(l)}catch{}});const a=[];for(const l of o)try{const g=l.toGeoJSON(),d=this.turfHelper.getTurfPolygon(g.features[0]),m=this.geometryManager.subtractPolygon(d,i);if(this.removeFeatureGroupInternal(l),m.success&&m.results)for(const _ of m.results){const x=await this.addPolygonLayer(_,{simplify:!0});x.success&&x.featureGroups&&a.push(...x.featureGroups)}}catch{}return this.emit("polygonSubtracted",{subtractedPolygon:i,affectedFeatureGroups:o,resultFeatureGroups:a}),this.emit("polygonOperationComplete",{operation:"subtract",polygon:i,resultFeatureGroups:a}),{success:!0,featureGroups:a}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Unknown error in subtractPolygon"}}}async addPolygonLayer(i,o={}){const{simplify:a=!0,dynamicTolerance:l=!1,visualOptimizationLevel:g=0}=o;try{if(!i||!i.geometry||!i.geometry.coordinates)return{success:!1,error:"Invalid polygon data"};const d=new yt.FeatureGroup,m=a?this.turfHelper.getSimplified(i,l):i;let _;try{if(_=this.getPolygon(m),!_)return{success:!1,error:"Failed to create polygon"};_._polydrawOptimizationLevel=g,d.addLayer(_)}catch{return{success:!1,error:"Failed to create polygon layer"}}let x;try{x=_.getLatLngs(),(!x||!Array.isArray(x))&&(x=[])}catch{x=[]}try{x.forEach(w=>{!w||!Array.isArray(w)||w.forEach((I,b)=>{if(!(!I||!Array.isArray(I)||I.length===0))try{if(b===0)this.interactionManager.addMarkers(I,d);else{const F=yt.polyline(I,{color:this.config.holeOptions.color,weight:this.config.holeOptions.weight||2,opacity:this.config.holeOptions.opacity||1});d.addLayer(F),this.interactionManager.addHoleMarkers(I,d)}}catch{}})})}catch{}try{this.interactionManager.addEdgeClickListeners(_,d)}catch{}this.getFeatureGroups().push(d);try{d.addTo(this.map)}catch{}return this.emit("polygonAdded",{polygon:m,featureGroup:d}),this.emit("polygonOperationComplete",{operation:"add",polygon:m,featureGroup:d}),{success:!0,featureGroups:[d]}}catch(d){return{success:!1,error:d instanceof Error?d.message:"Unknown error in addPolygonLayer"}}}async mergePolygon(i,o={}){try{const a=[],l=[];let g=!1;return this.getFeatureGroups().forEach(d=>{try{const m=d.toGeoJSON();if(!m||!m.features||!m.features[0])return;const _=m.features[0];if(!_.geometry||!_.geometry.coordinates)return;if(_.geometry.coordinates.length>1)_.geometry.coordinates.forEach(x=>{try{const w=this.turfHelper.getMultiPolygon([x]);g=this.geometryManager.checkPolygonIntersection(w,i),g&&(l.push(d),a.push(w))}catch{}});else try{const x=this.turfHelper.getTurfPolygon(_);g=this.geometryManager.checkPolygonIntersection(x,i),g&&(l.push(d),a.push(x))}catch{}}catch{}}),l.length>0?await this.unionPolygons(l,i,a,o):await this.addPolygonLayer(i,o)}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error in mergePolygon"}}}async unionPolygons(i,o,a,l={}){try{i.forEach(d=>{this.removeFeatureGroupInternal(d)});const g=this.geometryManager.unionPolygons(a,o);if(g.success&&g.result){const d=await this.addPolygonLayer(g.result,l);return this.emit("polygonsUnioned",{originalPolygons:a,resultPolygon:g.result,featureGroups:d.featureGroups}),d}else return{success:!1,error:g.error||"Failed to union polygons"}}catch(g){return{success:!1,error:g instanceof Error?g.message:"Unknown error in unionPolygons"}}}getPolygon(i){const o=yt.GeoJSON.geometryToLayer(i);return o.setStyle(this.config.polygonOptions),o._polydrawUniqueId=yt.Util.stamp(o)+"_"+Date.now(),delete o._polydrawDragData,delete o._polydrawOriginalLatLngs,delete o._polydrawCurrentDragSession,delete o._polydrawOriginalMarkerPositions,delete o._polydrawOriginalHoleLinePositions,this.config.modes.dragPolygons&&this.interactionManager.enablePolygonDragging(o,i),o}addFeatureGroupInternal(i){this.getFeatureGroups().push(i)}removeFeatureGroupInternal(i){i.clearLayers();const o=this.getFeatureGroups(),a=o.indexOf(i);a>-1&&o.splice(a,1),this.map.removeLayer(i)}updateMarkerDraggableState(){this.interactionManager.updateMarkerDraggableState()}updateAllMarkersForEdgeDeletion(i){this.interactionManager.updateAllMarkersForEdgeDeletion(i)}setModifierKeyHeld(i){this.interactionManager.setModifierKeyHeld(i)}checkPolygonIntersection(i,o){return this.geometryManager.checkPolygonIntersection(i,o)}getPolygonCenter(i){try{if(!i||!i.geometry||!i.geometry.coordinates)return null;let o;if(i.geometry.type==="Polygon")o=i.geometry.coordinates[0];else if(i.geometry.type==="MultiPolygon")o=i.geometry.coordinates[0][0];else return null;if(!Array.isArray(o)||o.length===0)return null;let a=0,l=0,g=0;for(const d of o)if(Array.isArray(d)&&d.length>=2){const m=d[0],_=d[1];typeof m=="number"&&typeof _=="number"&&!isNaN(m)&&!isNaN(_)&&(l+=m,a+=_,g++)}return g===0?null:{lat:a/g,lng:l/g}}catch{return null}}getBoundingBox(i){try{if(!i||!i.geometry||!i.geometry.coordinates)return null;let o;if(i.geometry.type==="Polygon")o=i.geometry.coordinates[0];else if(i.geometry.type==="MultiPolygon")o=i.geometry.coordinates[0][0];else return null;if(!Array.isArray(o)||o.length===0)return null;let a=1/0,l=-1/0,g=1/0,d=-1/0;for(const m of o)if(Array.isArray(m)&&m.length>=2){const _=m[0],x=m[1];typeof _=="number"&&typeof x=="number"&&!isNaN(_)&&!isNaN(x)&&(g=Math.min(g,_),d=Math.max(d,_),a=Math.min(a,x),l=Math.max(l,x))}return a===1/0||l===-1/0||g===1/0||d===-1/0?null:{minLat:a,maxLat:l,minLng:g,maxLng:d}}catch{return null}}addMarker(i,o){this.interactionManager.addMarkers(i,o)}addHoleMarker(i,o){this.interactionManager.addHoleMarkers(i,o)}addEdgeClickListeners(i,o){this.interactionManager.addEdgeClickListeners(i,o)}enablePolygonDragging(i,o){this.interactionManager.enablePolygonDragging(i,o)}getMarkerIndex(i,o){return 0}ensureMarkerSeparation(i,o){var a,l,g;return{menu:((a=o.menu)==null?void 0:a.index)||0,delete:((l=o.delete)==null?void 0:l.index)||1,info:((g=o.info)==null?void 0:g.index)||2}}findAlternativeMarkerPosition(i,o,a){return(o+1)%i}createDivIcon(i){return yt.divIcon({className:i.join(" ")})}getLatLngInfoString(i){return"Latitude: "+i.lat+" Longitude: "+i.lng}generateMenuMarkerPopup(i,o){const a=document.createElement("div");return a.innerHTML="Menu",a}getPolygonGeoJSONFromFeatureGroup(i){return{type:"Feature",geometry:{type:"Polygon",coordinates:[[[0,0],[0,1],[1,1],[1,0],[0,0]]]},properties:{}}}getTotalPolygonPerimeter(i){return 1e3}generateInfoMarkerPopup(i,o){const a=document.createElement("div");return a.innerHTML=`Area: ${i}, Perimeter: ${o}`,a}onMarkerHoverForEdgeDeletion(i,o){}highlightEdgeOnHover(i,o){}onEdgeClick(i,o){}removeFeatureGroup(i){this.removeFeatureGroupInternal(i)}onPolygonMouseMove(i){}onPolygonMouseUp(i){}updatePolygonAfterDrag(i){}setSubtractVisualMode(i,o){}performModifierSubtract(i,o){try{const a=this.turfHelper.getTurfPolygon(i),l=[];this.getFeatureGroups().forEach(g=>{if(g!==o)try{const d=g.toGeoJSON();if(!d||!d.features||!d.features[0])return;const m=d.features[0];if(!m.geometry||!m.geometry.coordinates)return;const _=this.turfHelper.getTurfPolygon(m);this.geometryManager.checkPolygonIntersection(_,a)&&l.push(g)}catch{}}),this.removeFeatureGroupInternal(o),l.forEach(g=>{try{const d=g.toGeoJSON(),m=this.turfHelper.getTurfPolygon(d.features[0]);this.removeFeatureGroupInternal(g);const _=this.geometryManager.subtractPolygon(m,a);if(_.success&&_.results)for(const x of _.results)this.addPolygonLayer(x,{simplify:!0})}catch{}})}catch{}}}class Xu extends yt.Control{constructor(i){super(i),lt(this,"map"),lt(this,"tracer",{}),lt(this,"turfHelper"),lt(this,"subContainer"),lt(this,"config"),lt(this,"mapStateService"),lt(this,"polygonInformation"),lt(this,"modeManager"),lt(this,"polygonMutationManager"),lt(this,"arrayOfFeatureGroups",[]),lt(this,"p2pMarkers",[]),lt(this,"drawMode",Bt.Off),lt(this,"drawModeListeners",[]),lt(this,"_boundKeyDownHandler"),lt(this,"_boundKeyUpHandler"),lt(this,"isModifierKeyHeld",!1),lt(this,"onMarkerHoverForEdgeDeletionEvent",o=>{if(!this.isModifierKeyHeld)return;const a=o.target;a&&(a.style.backgroundColor="#D9460F",a.style.borderColor="#D9460F",a.classList.add("edge-deletion-hover"))}),lt(this,"onMarkerLeaveForEdgeDeletionEvent",o=>{const a=o.target;a&&(a.style.backgroundColor="",a.style.borderColor="",a.classList.remove("edge-deletion-hover"))}),this.config=Gn,i!=null&&i.configPath?this.loadExternalConfig(i.configPath,i==null?void 0:i.config):(this.config={...Gn,...(i==null?void 0:i.config)||{}},this.initializeComponents())}async loadExternalConfig(i,o){try{const a=await fetch(i);if(!a.ok)throw new Error(`Failed to load config from ${i}: ${a.status} ${a.statusText}`);const l=await a.json();this.config={...Gn,...l,...o||{}},this.initializeComponents()}catch(a){console.warn("Failed to load external config, falling back to default + inline config:",a),this.config={...Gn,...o||{}},this.initializeComponents()}}initializeComponents(){this.turfHelper=new Yu(this.config),this.mapStateService=new gf,this.polygonInformation=new ff(this.mapStateService),this.modeManager=new df(this.config),this.polygonInformation.onPolygonInfoUpdated(i=>{this.updateActivateButtonIndicator()}),this._boundKeyDownHandler=this.handleKeyDown.bind(this),this.polygonMutationManager=null}onAdd(i){this.map=i;const o=document.createElement("style");o.innerHTML=`
      .leaflet-control a { background-color: #fff; color: #000; display: flex; align-items: center; justify-content: center; }
      .leaflet-control a:hover { background-color: #f4f4f4; }
      .leaflet-control a.active { background-color:rgb(128, 218, 255); color: #fff; }
      .polydraw-indicator-active { background-color: #ffcc00 !important; }
      .crosshair-cursor-enabled { cursor: crosshair !important; }
      .crosshair-cursor-enabled * { cursor: crosshair !important; }
      .leaflet-polydraw-p2p-marker { background-color: #fff; border: 2px solid #50622b; border-radius: 50%; box-sizing: border-box; }
      .leaflet-polydraw-p2p-first-marker { position: relative; }
      .leaflet-polydraw-p2p-first-marker:hover { transform: scale(1.5); transition: all 0.2s ease; }
    `,document.head.appendChild(o),this.setupKeyboardHandlers();const a=yt.DomUtil.create("div","leaflet-control leaflet-bar");a.style.display="flex",a.style.flexDirection="column-reverse",this.subContainer=yt.DomUtil.create("div","sub-buttons",a),this.subContainer.style.maxHeight="0px",this.subContainer.style.overflow="hidden",this.subContainer.style.transition="max-height 0.3s ease";const l=()=>{const w=a.querySelector(".icon-activate");yt.DomUtil.hasClass(w,"active")?(yt.DomUtil.removeClass(w,"active"),this.subContainer&&(this.subContainer.style.maxHeight="0px")):(yt.DomUtil.addClass(w,"active"),this.subContainer&&(this.subContainer.style.maxHeight="250px")),this.updateActivateButtonIndicator()},g=w=>{if(w&&(w.preventDefault(),w.stopPropagation()),this.modeManager.getCurrentMode()===Bt.Add){this.setDrawMode(Bt.Off);return}this.setDrawMode(Bt.Add),this.polygonInformation.saveCurrentState()},d=w=>{if(w&&(w.preventDefault(),w.stopPropagation()),this.modeManager.getCurrentMode()===Bt.Subtract){this.setDrawMode(Bt.Off);return}this.setDrawMode(Bt.Subtract),this.polygonInformation.saveCurrentState()},m=w=>{w&&(w.preventDefault(),w.stopPropagation()),this.arrayOfFeatureGroups.length!==0&&this.removeAllFeatureGroups()},_=w=>{if(w&&(w.preventDefault(),w.stopPropagation()),this.modeManager.getCurrentMode()===Bt.PointToPoint){this.setDrawMode(Bt.Off);return}this.setDrawMode(Bt.PointToPoint),this.polygonInformation.saveCurrentState()};hf(a,this.subContainer,this.config,l,g,d,m,_);const x=w=>{const I=a.querySelector(".icon-draw"),b=a.querySelector(".icon-subtract");I&&I.classList.toggle("active",w===Bt.Add),b&&b.classList.toggle("active",w===Bt.Subtract)};this.drawModeListeners.push(x),this.tracer=yt.polyline([],this.config.polyLineOptions);try{this.tracer.addTo(this.map)}catch{}return this.polygonMutationManager=new Ef({turfHelper:this.turfHelper,polygonInformation:this.polygonInformation,map:this.map,config:this.config,modeManager:this.modeManager,getFeatureGroups:()=>this.arrayOfFeatureGroups}),this.polygonMutationManager.on("polygonOperationComplete",w=>{this.updateActivateButtonIndicator(),this.modeManager.updateStateForMode(Bt.Off),this.drawMode=Bt.Off,this.emitDrawModeChanged(),this.updateMarkerDraggableState();const I=this.modeManager.shouldShowCrosshairCursor(),b=this.modeManager.canPerformAction("mapDrag"),F=this.modeManager.canPerformAction("mapZoom"),z=this.modeManager.canPerformAction("mapDoubleClickZoom");I?yt.DomUtil.addClass(this.map.getContainer(),"crosshair-cursor-enabled"):yt.DomUtil.removeClass(this.map.getContainer(),"crosshair-cursor-enabled"),this.events(!1),this.setLeafletMapEvents(b,z,F);try{this.tracer.setStyle({color:""})}catch{}}),this.polygonMutationManager.on("polygonDeleted",()=>{this.updateActivateButtonIndicator()}),a}addTo(i){return super.addTo(i),this}getFeatureGroups(){return this.arrayOfFeatureGroups}onRemove(i){this.removeKeyboardHandlers(),this.tracer&&this.map.removeLayer(this.tracer),this.removeAllFeatureGroups()}async addPredefinedPolygon(i,o){if(!i||i.length===0)throw new Error("Cannot add empty polygon array");if(!this.map)throw new Error("Map not initialized");if(!this.polygonMutationManager)throw new Error("PolygonMutationManager not initialized");const a=(o==null?void 0:o.visualOptimizationLevel)??0;for(const[l,g]of i.entries()){if(!g||!g[0]||g[0].length<4)throw new Error(`Invalid polygon data at index ${l}: A polygon must have at least 3 unique vertices.`);try{const d=g.map(x=>x.map(w=>[w.lng,w.lat])),m=this.turfHelper.getMultiPolygon([d]),_=await this.polygonMutationManager.addPolygon(m,{simplify:!1,noMerge:!1,visualOptimizationLevel:a});if(!_.success)throw console.error("Error adding polygon via manager:",_.error),new Error(_.error||"Failed to add polygon");this.polygonInformation.createPolygonInformationStorage(this.arrayOfFeatureGroups)}catch(d){throw console.error("Error adding auto polygon:",d),d}}}setDrawMode(i){const o=this.drawMode;if(this.drawMode=i,this.modeManager.updateStateForMode(i),this.emitDrawModeChanged(),this.updateMarkerDraggableState(),o===Bt.PointToPoint&&i!==Bt.PointToPoint?(this.clearP2pMarkers(),this.stopDraw()):i===Bt.Off?this.stopDraw():i!==Bt.PointToPoint&&this.stopDraw(),this.map){const a=this.modeManager.shouldShowCrosshairCursor(),l=this.modeManager.canPerformAction("mapDrag"),g=this.modeManager.canPerformAction("mapZoom"),d=this.modeManager.canPerformAction("mapDoubleClickZoom");a?yt.DomUtil.addClass(this.map.getContainer(),"crosshair-cursor-enabled"):yt.DomUtil.removeClass(this.map.getContainer(),"crosshair-cursor-enabled"),this.events(i!==Bt.Off);try{switch(i){case Bt.Off:this.tracer.setStyle({color:""});break;case Bt.Add:this.tracer.setStyle({color:Gn.polyLineOptions.color,dashArray:null});break;case Bt.Subtract:this.tracer.setStyle({color:"#D9460F",dashArray:null});break;case Bt.PointToPoint:this.tracer.setStyle({color:Gn.polyLineOptions.color,dashArray:"5, 5"});break}}catch{}this.setLeafletMapEvents(l,d,g)}}getDrawMode(){return this.modeManager.getCurrentMode()}onDrawModeChangeListener(i){this.drawModeListeners.push(i)}offDrawModeChangeListener(i){const o=this.drawModeListeners.indexOf(i);o>-1&&this.drawModeListeners.splice(o,1)}emitDrawModeChanged(){for(const i of this.drawModeListeners)i(this.modeManager.getCurrentMode())}updateMarkerDraggableState(){const i=this.modeManager.canPerformAction("markerDrag");this.arrayOfFeatureGroups.forEach(o=>{o.eachLayer(a=>{if(a instanceof yt.Marker){const l=a;try{l.options.draggable=i,l.dragging&&(i?l.dragging.enable():l.dragging.disable())}catch{}}})})}removeAllFeatureGroups(){this.arrayOfFeatureGroups.forEach(i=>{try{this.map.removeLayer(i)}catch{}}),this.arrayOfFeatureGroups.length=0,this.polygonInformation.deletePolygonInformationStorage(),this.polygonInformation.updatePolygons(),this.updateActivateButtonIndicator()}stopDraw(){this.resetTracker(),this.drawStartedEvents(!1)}setLeafletMapEvents(i,o,a){i?this.map.dragging.enable():this.map.dragging.disable(),o?this.map.doubleClickZoom.enable():this.map.doubleClickZoom.disable(),a?this.map.scrollWheelZoom.enable():this.map.scrollWheelZoom.disable()}resetTracker(){this.tracer.setLatLngs([])}drawStartedEvents(i){const o=i?"on":"off";if(this.map[o]("mousemove",this.mouseMove,this),this.map[o]("mouseup",this.mouseUpLeave,this),i)try{this.map.getContainer().addEventListener("touchmove",a=>this.mouseMove(a)),this.map.getContainer().addEventListener("touchend",a=>this.mouseUpLeave(a))}catch{}else try{this.map.getContainer().removeEventListener("touchmove",a=>this.mouseMove(a),!0),this.map.getContainer().removeEventListener("touchend",a=>this.mouseUpLeave(a),!0)}catch{}}mouseMove(i){if("latlng"in i&&i.latlng)this.tracer.addLatLng(i.latlng);else if("touches"in i&&i.touches&&i.touches.length>0){const o=this.map.containerPointToLatLng([i.touches[0].clientX,i.touches[0].clientY]);this.tracer.addLatLng(o)}}async mouseUpLeave(i){this.polygonInformation.deletePolygonInformationStorage();const o=this.tracer.toGeoJSON();if(!o||!o.geometry||!o.geometry.coordinates||o.geometry.coordinates.length<3){this.stopDraw();return}let a;try{a=this.turfHelper.createPolygonFromTrace(o)}catch{this.stopDraw();return}if(!a||!a.geometry||!a.geometry.coordinates||a.geometry.coordinates.length===0){this.stopDraw();return}this.stopDraw();try{switch(this.modeManager.getCurrentMode()){case Bt.Add:{const l=await this.polygonMutationManager.addPolygon(a,{simplify:!0,noMerge:!1});l.success||console.error("Error adding polygon via manager:",l.error);break}case Bt.Subtract:{const l=await this.polygonMutationManager.subtractPolygon(a);l.success||console.error("Error subtracting polygon via manager:",l.error);break}default:break}}catch(l){console.error("Error in mouseUpLeave polygon operation:",l)}this.polygonInformation.createPolygonInformationStorage(this.arrayOfFeatureGroups)}events(i){const o=i?"on":"off";if(this.map[o]("mousedown",this.mouseDown,this),this.map[o]("dblclick",this.handleDoubleClick,this),i)try{this.map.getContainer().addEventListener("touchstart",a=>this.mouseDown(a))}catch{}else try{this.map.getContainer().removeEventListener("touchstart",a=>this.mouseDown(a),!0)}catch{}}mouseDown(i){if(this.modeManager.isInOffMode())return;let o;if("latlng"in i&&i.latlng?o=i.latlng:"touches"in i&&i.touches&&i.touches.length>0&&(o=this.map.containerPointToLatLng([i.touches[0].clientX,i.touches[0].clientY])),!!o){if(this.modeManager.getCurrentMode()===Bt.PointToPoint){this.handlePointToPointClick(o);return}this.tracer.setLatLngs([o]),this.startDraw()}}startDraw(){this.drawStartedEvents(!0)}setupKeyboardHandlers(){this._boundKeyUpHandler=this.handleKeyUp.bind(this),document.addEventListener("keydown",this._boundKeyDownHandler),document.addEventListener("keyup",this._boundKeyUpHandler)}removeKeyboardHandlers(){document.removeEventListener("keydown",this._boundKeyDownHandler),document.removeEventListener("keyup",this._boundKeyUpHandler)}handleKeyDown(i){i.key==="Escape"&&this.modeManager.getCurrentMode()===Bt.PointToPoint&&this.cancelPointToPointDrawing(),this.isModifierKeyPressed(i)&&!this.isModifierKeyHeld&&(this.isModifierKeyHeld=!0,this.updateAllMarkersForEdgeDeletion(!0))}handleKeyUp(i){!this.isModifierKeyPressed(i)&&this.isModifierKeyHeld&&(this.isModifierKeyHeld=!1,this.updateAllMarkersForEdgeDeletion(!1))}updateAllMarkersForEdgeDeletion(i){this.arrayOfFeatureGroups.forEach(o=>{o.eachLayer(a=>{a instanceof yt.Marker&&this.updateMarkerForEdgeDeletion(a,i)})})}updateMarkerForEdgeDeletion(i,o){const a=i.getElement();a&&(o?(a.addEventListener("mouseenter",this.onMarkerHoverForEdgeDeletionEvent),a.addEventListener("mouseleave",this.onMarkerLeaveForEdgeDeletionEvent)):(a.removeEventListener("mouseenter",this.onMarkerHoverForEdgeDeletionEvent),a.removeEventListener("mouseleave",this.onMarkerLeaveForEdgeDeletionEvent),a.style.backgroundColor="",a.style.borderColor=""))}cancelPointToPointDrawing(){this.clearP2pMarkers(),this.stopDraw(),this.setDrawMode(Bt.Off)}handlePointToPointClick(i){if(!i)return;if(this.tracer.getLatLngs().length>=3&&this.p2pMarkers.length>0){const a=this.p2pMarkers[0].getLatLng();if(this.isClickingFirstPoint(i,a)){this.completePointToPointPolygon();return}}this.tracer.addLatLng(i);try{const a=this.p2pMarkers.length===0,l=a?"leaflet-polydraw-p2p-marker leaflet-polydraw-p2p-first-marker":"leaflet-polydraw-p2p-marker",g=new yt.Marker(i,{icon:yt.divIcon({className:l,iconSize:a?[20,20]:[10,10]})}).addTo(this.map);g.on("mousedown",d=>{yt.DomEvent.stopPropagation(d)}),a&&(g.on("mouseover",()=>{if(this.tracer.getLatLngs().length>=3){const d=g.getElement();d&&(d.style.backgroundColor="#4CAF50",d.style.borderColor="#4CAF50",d.style.cursor="pointer",d.title="Click to close polygon")}}),g.on("mouseout",()=>{const d=g.getElement();d&&(d.style.backgroundColor="",d.style.borderColor="",d.style.cursor="",d.title="")}),g.on("click",d=>{this.tracer.getLatLngs().length>=3&&(yt.DomEvent.stopPropagation(d),this.completePointToPointPolygon())})),this.p2pMarkers.push(g)}catch{}if(this.tracer.getLatLngs().length>=2)try{this.tracer.setStyle({color:Gn.polyLineOptions.color,dashArray:"5, 5"})}catch{}}isClickingFirstPoint(i,o){if(!o)return!1;const a=this.map.getZoom(),g=5e-4/Math.pow(2,Math.max(0,a-10)),d=Math.abs(i.lat-o.lat),m=Math.abs(i.lng-o.lng);return d<g&&m<g}handleDoubleClick(i){if(this.modeManager.getCurrentMode()!==Bt.PointToPoint)return;this.tracer.getLatLngs().length>=3&&this.completePointToPointPolygon()}completePointToPointPolygon(){const i=this.tracer.getLatLngs();if(i.length<3)return;const o=[...i],a=i[0],l=i[i.length-1];(a.lat!==l.lat||a.lng!==l.lng)&&o.push(a);try{const g=o.map(m=>[m.lng,m.lat]),d=this.turfHelper.getMultiPolygon([[g]]);this.clearP2pMarkers(),this.stopDraw(),this.polygonMutationManager.addPolygon(d,{simplify:!1,noMerge:!1}),this.polygonInformation.createPolygonInformationStorage(this.arrayOfFeatureGroups)}catch(g){console.warn("Error completing point-to-point polygon:",g),this.clearP2pMarkers(),this.stopDraw()}}clearP2pMarkers(){this.p2pMarkers.forEach(i=>this.map.removeLayer(i)),this.p2pMarkers=[]}isModifierKeyPressed(i){return navigator.userAgent.toLowerCase().includes("mac")?i.metaKey:i.ctrlKey}updateActivateButtonIndicator(){if(typeof this.getContainer!="function")return;const i=this.getContainer();if(!i)return;const o=i.querySelector(".icon-activate");if(!o)return;const a=this.arrayOfFeatureGroups.length>0,l=!yt.DomUtil.hasClass(o,"active");a&&l?yt.DomUtil.addClass(o,"polydraw-indicator-active"):yt.DomUtil.removeClass(o,"polydraw-indicator-active")}}yt.control.polydraw=function(h){return new Xu(h)};const Vu=yt.map("map").setView([51.505,-.09],13);yt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(Vu);const Pf=new Xu;Pf.addTo(Vu);
