(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const g of l)if(g.type==="childList")for(const m of g.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function r(l){const g={};return l.integrity&&(g.integrity=l.integrity),l.referrerPolicy&&(g.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?g.credentials="include":l.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function a(l){if(l.ep)return;l.ep=!0;const g=r(l);fetch(l.href,g)}})();var $r={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var Ll=$r.exports,xa;function Sl(){return xa||(xa=1,function(h,i){(function(r,a){a(i)})(Ll,function(r){var a="1.9.4";function l(n){var u,f,y,k;for(f=1,y=arguments.length;f<y;f++){k=arguments[f];for(u in k)n[u]=k[u]}return n}var g=Object.create||function(){function n(){}return function(u){return n.prototype=u,new n}}();function m(n,u){var f=Array.prototype.slice;if(n.bind)return n.bind.apply(n,f.call(arguments,1));var y=f.call(arguments,2);return function(){return n.apply(u,y.length?y.concat(f.call(arguments)):arguments)}}var d=0;function x(n){return"_leaflet_id"in n||(n._leaflet_id=++d),n._leaflet_id}function v(n,u,f){var y,k,T,$;return $=function(){y=!1,k&&(T.apply(f,k),k=!1)},T=function(){y?k=arguments:(n.apply(f,arguments),setTimeout($,u),y=!0)},T}function P(n,u,f){var y=u[1],k=u[0],T=y-k;return n===y&&f?n:((n-k)%T+T)%T+k}function I(){return!1}function b(n,u){if(u===!1)return n;var f=Math.pow(10,u===void 0?6:u);return Math.round(n*f)/f}function O(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function R(n){return O(n).split(/\s+/)}function W(n,u){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?g(n.options):{});for(var f in u)n.options[f]=u[f];return n.options}function j(n,u,f){var y=[];for(var k in n)y.push(encodeURIComponent(f?k.toUpperCase():k)+"="+encodeURIComponent(n[k]));return(!u||u.indexOf("?")===-1?"?":"&")+y.join("&")}var st=/\{ *([\w_ -]+) *\}/g;function M(n,u){return n.replace(st,function(f,y){var k=u[y];if(k===void 0)throw new Error("No value provided for variable "+f);return typeof k=="function"&&(k=k(u)),k})}var q=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function A(n,u){for(var f=0;f<n.length;f++)if(n[f]===u)return f;return-1}var F="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function H(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var K=0;function E(n){var u=+new Date,f=Math.max(0,16-(u-K));return K=u+f,window.setTimeout(n,f)}var S=window.requestAnimationFrame||H("RequestAnimationFrame")||E,N=window.cancelAnimationFrame||H("CancelAnimationFrame")||H("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function B(n,u,f){if(f&&S===E)n.call(u);else return S.call(window,m(n,u))}function D(n){n&&N.call(window,n)}var V={__proto__:null,extend:l,create:g,bind:m,get lastId(){return d},stamp:x,throttle:v,wrapNum:P,falseFn:I,formatNum:b,trim:O,splitWords:R,setOptions:W,getParamString:j,template:M,isArray:q,indexOf:A,emptyImageUrl:F,requestFn:S,cancelFn:N,requestAnimFrame:B,cancelAnimFrame:D};function Z(){}Z.extend=function(n){var u=function(){W(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},f=u.__super__=this.prototype,y=g(f);y.constructor=u,u.prototype=y;for(var k in this)Object.prototype.hasOwnProperty.call(this,k)&&k!=="prototype"&&k!=="__super__"&&(u[k]=this[k]);return n.statics&&l(u,n.statics),n.includes&&(U(n.includes),l.apply(null,[y].concat(n.includes))),l(y,n),delete y.statics,delete y.includes,y.options&&(y.options=f.options?g(f.options):{},l(y.options,n.options)),y._initHooks=[],y.callInitHooks=function(){if(!this._initHooksCalled){f.callInitHooks&&f.callInitHooks.call(this),this._initHooksCalled=!0;for(var T=0,$=y._initHooks.length;T<$;T++)y._initHooks[T].call(this)}},u},Z.include=function(n){var u=this.prototype.options;return l(this.prototype,n),n.options&&(this.prototype.options=u,this.mergeOptions(n.options)),this},Z.mergeOptions=function(n){return l(this.prototype.options,n),this},Z.addInitHook=function(n){var u=Array.prototype.slice.call(arguments,1),f=typeof n=="function"?n:function(){this[n].apply(this,u)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(f),this};function U(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=q(n)?n:[n];for(var u=0;u<n.length;u++)n[u]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var G={on:function(n,u,f){if(typeof n=="object")for(var y in n)this._on(y,n[y],u);else{n=R(n);for(var k=0,T=n.length;k<T;k++)this._on(n[k],u,f)}return this},off:function(n,u,f){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var y in n)this._off(y,n[y],u);else{n=R(n);for(var k=arguments.length===1,T=0,$=n.length;T<$;T++)k?this._off(n[T]):this._off(n[T],u,f)}return this},_on:function(n,u,f,y){if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}if(this._listens(n,u,f)===!1){f===this&&(f=void 0);var k={fn:u,ctx:f};y&&(k.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(k)}},_off:function(n,u,f){var y,k,T;if(this._events&&(y=this._events[n],!!y)){if(arguments.length===1){if(this._firingCount)for(k=0,T=y.length;k<T;k++)y[k].fn=I;delete this._events[n];return}if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}var $=this._listens(n,u,f);if($!==!1){var rt=y[$];this._firingCount&&(rt.fn=I,this._events[n]=y=y.slice()),y.splice($,1)}}},fire:function(n,u,f){if(!this.listens(n,f))return this;var y=l({},u,{type:n,target:this,sourceTarget:u&&u.sourceTarget||this});if(this._events){var k=this._events[n];if(k){this._firingCount=this._firingCount+1||1;for(var T=0,$=k.length;T<$;T++){var rt=k[T],ut=rt.fn;rt.once&&this.off(n,ut,rt.ctx),ut.call(rt.ctx||this,y)}this._firingCount--}}return f&&this._propagateEvent(y),this},listens:function(n,u,f,y){typeof n!="string"&&console.warn('"string" type argument expected');var k=u;typeof u!="function"&&(y=!!u,k=void 0,f=void 0);var T=this._events&&this._events[n];if(T&&T.length&&this._listens(n,k,f)!==!1)return!0;if(y){for(var $ in this._eventParents)if(this._eventParents[$].listens(n,u,f,y))return!0}return!1},_listens:function(n,u,f){if(!this._events)return!1;var y=this._events[n]||[];if(!u)return!!y.length;f===this&&(f=void 0);for(var k=0,T=y.length;k<T;k++)if(y[k].fn===u&&y[k].ctx===f)return k;return!1},once:function(n,u,f){if(typeof n=="object")for(var y in n)this._on(y,n[y],u,!0);else{n=R(n);for(var k=0,T=n.length;k<T;k++)this._on(n[k],u,f,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[x(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[x(n)],this},_propagateEvent:function(n){for(var u in this._eventParents)this._eventParents[u].fire(n.type,l({layer:n.target,propagatedFrom:n.target},n),!0)}};G.addEventListener=G.on,G.removeEventListener=G.clearAllEventListeners=G.off,G.addOneTimeEventListener=G.once,G.fireEvent=G.fire,G.hasEventListeners=G.listens;var Q=Z.extend(G);function X(n,u,f){this.x=f?Math.round(n):n,this.y=f?Math.round(u):u}var nt=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};X.prototype={clone:function(){return new X(this.x,this.y)},add:function(n){return this.clone()._add(J(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(J(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new X(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new X(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=nt(this.x),this.y=nt(this.y),this},distanceTo:function(n){n=J(n);var u=n.x-this.x,f=n.y-this.y;return Math.sqrt(u*u+f*f)},equals:function(n){return n=J(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=J(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+b(this.x)+", "+b(this.y)+")"}};function J(n,u,f){return n instanceof X?n:q(n)?new X(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new X(n.x,n.y):new X(n,u,f)}function ot(n,u){if(n)for(var f=u?[n,u]:n,y=0,k=f.length;y<k;y++)this.extend(f[y])}ot.prototype={extend:function(n){var u,f;if(!n)return this;if(n instanceof X||typeof n[0]=="number"||"x"in n)u=f=J(n);else if(n=ct(n),u=n.min,f=n.max,!u||!f)return this;return!this.min&&!this.max?(this.min=u.clone(),this.max=f.clone()):(this.min.x=Math.min(u.x,this.min.x),this.max.x=Math.max(f.x,this.max.x),this.min.y=Math.min(u.y,this.min.y),this.max.y=Math.max(f.y,this.max.y)),this},getCenter:function(n){return J((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return J(this.min.x,this.max.y)},getTopRight:function(){return J(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var u,f;return typeof n[0]=="number"||n instanceof X?n=J(n):n=ct(n),n instanceof ot?(u=n.min,f=n.max):u=f=n,u.x>=this.min.x&&f.x<=this.max.x&&u.y>=this.min.y&&f.y<=this.max.y},intersects:function(n){n=ct(n);var u=this.min,f=this.max,y=n.min,k=n.max,T=k.x>=u.x&&y.x<=f.x,$=k.y>=u.y&&y.y<=f.y;return T&&$},overlaps:function(n){n=ct(n);var u=this.min,f=this.max,y=n.min,k=n.max,T=k.x>u.x&&y.x<f.x,$=k.y>u.y&&y.y<f.y;return T&&$},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var u=this.min,f=this.max,y=Math.abs(u.x-f.x)*n,k=Math.abs(u.y-f.y)*n;return ct(J(u.x-y,u.y-k),J(f.x+y,f.y+k))},equals:function(n){return n?(n=ct(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function ct(n,u){return!n||n instanceof ot?n:new ot(n,u)}function pt(n,u){if(n)for(var f=u?[n,u]:n,y=0,k=f.length;y<k;y++)this.extend(f[y])}pt.prototype={extend:function(n){var u=this._southWest,f=this._northEast,y,k;if(n instanceof ft)y=n,k=n;else if(n instanceof pt){if(y=n._southWest,k=n._northEast,!y||!k)return this}else return n?this.extend(gt(n)||ht(n)):this;return!u&&!f?(this._southWest=new ft(y.lat,y.lng),this._northEast=new ft(k.lat,k.lng)):(u.lat=Math.min(y.lat,u.lat),u.lng=Math.min(y.lng,u.lng),f.lat=Math.max(k.lat,f.lat),f.lng=Math.max(k.lng,f.lng)),this},pad:function(n){var u=this._southWest,f=this._northEast,y=Math.abs(u.lat-f.lat)*n,k=Math.abs(u.lng-f.lng)*n;return new pt(new ft(u.lat-y,u.lng-k),new ft(f.lat+y,f.lng+k))},getCenter:function(){return new ft((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ft(this.getNorth(),this.getWest())},getSouthEast:function(){return new ft(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof ft||"lat"in n?n=gt(n):n=ht(n);var u=this._southWest,f=this._northEast,y,k;return n instanceof pt?(y=n.getSouthWest(),k=n.getNorthEast()):y=k=n,y.lat>=u.lat&&k.lat<=f.lat&&y.lng>=u.lng&&k.lng<=f.lng},intersects:function(n){n=ht(n);var u=this._southWest,f=this._northEast,y=n.getSouthWest(),k=n.getNorthEast(),T=k.lat>=u.lat&&y.lat<=f.lat,$=k.lng>=u.lng&&y.lng<=f.lng;return T&&$},overlaps:function(n){n=ht(n);var u=this._southWest,f=this._northEast,y=n.getSouthWest(),k=n.getNorthEast(),T=k.lat>u.lat&&y.lat<f.lat,$=k.lng>u.lng&&y.lng<f.lng;return T&&$},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,u){return n?(n=ht(n),this._southWest.equals(n.getSouthWest(),u)&&this._northEast.equals(n.getNorthEast(),u)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ht(n,u){return n instanceof pt?n:new pt(n,u)}function ft(n,u,f){if(isNaN(n)||isNaN(u))throw new Error("Invalid LatLng object: ("+n+", "+u+")");this.lat=+n,this.lng=+u,f!==void 0&&(this.alt=+f)}ft.prototype={equals:function(n,u){if(!n)return!1;n=gt(n);var f=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return f<=(u===void 0?1e-9:u)},toString:function(n){return"LatLng("+b(this.lat,n)+", "+b(this.lng,n)+")"},distanceTo:function(n){return et.distance(this,gt(n))},wrap:function(){return et.wrapLatLng(this)},toBounds:function(n){var u=180*n/40075017,f=u/Math.cos(Math.PI/180*this.lat);return ht([this.lat-u,this.lng-f],[this.lat+u,this.lng+f])},clone:function(){return new ft(this.lat,this.lng,this.alt)}};function gt(n,u,f){return n instanceof ft?n:q(n)&&typeof n[0]!="object"?n.length===3?new ft(n[0],n[1],n[2]):n.length===2?new ft(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new ft(n.lat,"lng"in n?n.lng:n.lon,n.alt):u===void 0?null:new ft(n,u,f)}var kt={latLngToPoint:function(n,u){var f=this.projection.project(n),y=this.scale(u);return this.transformation._transform(f,y)},pointToLatLng:function(n,u){var f=this.scale(u),y=this.transformation.untransform(n,f);return this.projection.unproject(y)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var u=this.projection.bounds,f=this.scale(n),y=this.transformation.transform(u.min,f),k=this.transformation.transform(u.max,f);return new ot(y,k)},infinite:!1,wrapLatLng:function(n){var u=this.wrapLng?P(n.lng,this.wrapLng,!0):n.lng,f=this.wrapLat?P(n.lat,this.wrapLat,!0):n.lat,y=n.alt;return new ft(f,u,y)},wrapLatLngBounds:function(n){var u=n.getCenter(),f=this.wrapLatLng(u),y=u.lat-f.lat,k=u.lng-f.lng;if(y===0&&k===0)return n;var T=n.getSouthWest(),$=n.getNorthEast(),rt=new ft(T.lat-y,T.lng-k),ut=new ft($.lat-y,$.lng-k);return new pt(rt,ut)}},et=l({},kt,{wrapLng:[-180,180],R:6371e3,distance:function(n,u){var f=Math.PI/180,y=n.lat*f,k=u.lat*f,T=Math.sin((u.lat-n.lat)*f/2),$=Math.sin((u.lng-n.lng)*f/2),rt=T*T+Math.cos(y)*Math.cos(k)*$*$,ut=2*Math.atan2(Math.sqrt(rt),Math.sqrt(1-rt));return this.R*ut}}),Vt=6378137,Ct={R:Vt,MAX_LATITUDE:85.0511287798,project:function(n){var u=Math.PI/180,f=this.MAX_LATITUDE,y=Math.max(Math.min(f,n.lat),-f),k=Math.sin(y*u);return new X(this.R*n.lng*u,this.R*Math.log((1+k)/(1-k))/2)},unproject:function(n){var u=180/Math.PI;return new ft((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*u,n.x*u/this.R)},bounds:function(){var n=Vt*Math.PI;return new ot([-n,-n],[n,n])}()};function vt(n,u,f,y){if(q(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=u,this._c=f,this._d=y}vt.prototype={transform:function(n,u){return this._transform(n.clone(),u)},_transform:function(n,u){return u=u||1,n.x=u*(this._a*n.x+this._b),n.y=u*(this._c*n.y+this._d),n},untransform:function(n,u){return u=u||1,new X((n.x/u-this._b)/this._a,(n.y/u-this._d)/this._c)}};function Y(n,u,f,y){return new vt(n,u,f,y)}var At=l({},et,{code:"EPSG:3857",projection:Ct,transformation:function(){var n=.5/(Math.PI*Ct.R);return Y(n,.5,-n,.5)}()}),Gt=l({},At,{code:"EPSG:900913"});function Lt(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function xe(n,u){var f="",y,k,T,$,rt,ut;for(y=0,T=n.length;y<T;y++){for(rt=n[y],k=0,$=rt.length;k<$;k++)ut=rt[k],f+=(k?"L":"M")+ut.x+" "+ut.y;f+=u?Pt.svg?"z":"x":""}return f||"M0 0"}var he=document.documentElement.style,Ce="ActiveXObject"in window,yt=Ce&&!document.addEventListener,ui="msLaunchUri"in navigator&&!("documentMode"in document),Yn=ge("webkit"),qe=ge("android"),bi=ge("android 2")||ge("android 3"),Nt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),dn=qe&&ge("Google")&&Nt<537&&!("AudioNode"in window),Ze=!!window.opera,Ti=!ui&&ge("chrome"),St=ge("gecko")&&!Yn&&!Ze&&!Ce,pr=!Ti&&ge("safari"),qt=ge("phantom"),bt="OTransition"in he,go=navigator.platform.indexOf("Win")===0,Ue=Ce&&"transition"in he,yr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!bi,It="MozPerspective"in he,mo=!window.L_DISABLE_3D&&(Ue||yr||It)&&!bt&&!qt,li=typeof orientation<"u"||ge("mobile"),vr=li&&Yn,Re=li&&yr,Xn=!window.PointerEvent&&window.MSPointerEvent,ze=!!(window.PointerEvent||Xn),_r="ontouchstart"in window||!!window.TouchEvent,Ni=!window.L_NO_TOUCH&&(_r||ze),po=li&&Ze,fs=li&&St,Cn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,_t=function(){var n=!1;try{var u=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",I,u),window.removeEventListener("testPassiveEventSupport",I,u)}catch{}return n}(),Oi=function(){return!!document.createElement("canvas").getContext}(),Vn=!!(document.createElementNS&&Lt("svg").createSVGRect),hi=!!Vn&&function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),gs=!Vn&&function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var u=n.firstChild;return u.style.behavior="url(#default#VML)",u&&typeof u.adj=="object"}catch{return!1}}(),xr=navigator.platform.indexOf("Mac")===0,ds=navigator.platform.indexOf("Linux")===0;function ge(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var Pt={ie:Ce,ielt9:yt,edge:ui,webkit:Yn,android:qe,android23:bi,androidStock:dn,opera:Ze,chrome:Ti,gecko:St,safari:pr,phantom:qt,opera12:bt,win:go,ie3d:Ue,webkit3d:yr,gecko3d:It,any3d:mo,mobile:li,mobileWebkit:vr,mobileWebkit3d:Re,msPointer:Xn,pointer:ze,touch:Ni,touchNative:_r,mobileOpera:po,mobileGecko:fs,retina:Cn,passiveEvents:_t,canvas:Oi,svg:Vn,vml:gs,inlineSvg:hi,mac:xr,linux:ds},ci=Pt.msPointer?"MSPointerDown":"pointerdown",ms=Pt.msPointer?"MSPointerMove":"pointermove",kr=Pt.msPointer?"MSPointerUp":"pointerup",ps=Pt.msPointer?"MSPointerCancel":"pointercancel",ke={touchstart:ci,touchmove:ms,touchend:kr,touchcancel:ps},Ai={touchstart:Fi,touchmove:Di,touchend:Di,touchcancel:Di},Ye={},mn=!1;function bn(n,u,f){return u==="touchstart"&&yo(),Ai[u]?(f=Ai[u].bind(this,f),n.addEventListener(ke[u],f,!1),f):(console.warn("wrong event specified:",u),I)}function wr(n,u,f){if(!ke[u]){console.warn("wrong event specified:",u);return}n.removeEventListener(ke[u],f,!1)}function Ri(n){Ye[n.pointerId]=n}function fi(n){Ye[n.pointerId]&&(Ye[n.pointerId]=n)}function oe(n){delete Ye[n.pointerId]}function yo(){mn||(document.addEventListener(ci,Ri,!0),document.addEventListener(ms,fi,!0),document.addEventListener(kr,oe,!0),document.addEventListener(ps,oe,!0),mn=!0)}function Di(n,u){if(u.pointerType!==(u.MSPOINTER_TYPE_MOUSE||"mouse")){u.touches=[];for(var f in Ye)u.touches.push(Ye[f]);u.changedTouches=[u],n(u)}}function Fi(n,u){u.MSPOINTER_TYPE_TOUCH&&u.pointerType===u.MSPOINTER_TYPE_TOUCH&&ne(u),Di(n,u)}function gi(n){var u={},f,y;for(y in n)f=n[y],u[y]=f&&f.bind?f.bind(n):f;return n=u,u.type="dblclick",u.detail=2,u.isTrusted=!1,u._simulated=!0,u}var Er=200;function Pr(n,u){n.addEventListener("dblclick",u);var f=0,y;function k(T){if(T.detail!==1){y=T.detail;return}if(!(T.pointerType==="mouse"||T.sourceCapabilities&&!T.sourceCapabilities.firesTouchEvents)){var $=me(T);if(!($.some(function(ut){return ut instanceof HTMLLabelElement&&ut.attributes.for})&&!$.some(function(ut){return ut instanceof HTMLInputElement||ut instanceof HTMLSelectElement}))){var rt=Date.now();rt-f<=Er?(y++,y===2&&u(gi(T))):y=1,f=rt}}}return n.addEventListener("click",k),{dblclick:u,simDblclick:k}}function ys(n,u){n.removeEventListener("dblclick",u.dblclick),n.removeEventListener("click",u.simDblclick)}var Mr=Hi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),we=Hi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Tn=we==="webkitTransition"||we==="OTransition"?we+"End":"transitionend";function Bi(n){return typeof n=="string"?document.getElementById(n):n}function Xe(n,u){var f=n.style[u]||n.currentStyle&&n.currentStyle[u];if((!f||f==="auto")&&document.defaultView){var y=document.defaultView.getComputedStyle(n,null);f=y?y[u]:null}return f==="auto"?null:f}function Zt(n,u,f){var y=document.createElement(n);return y.className=u||"",f&&f.appendChild(y),y}function te(n){var u=n.parentNode;u&&u.removeChild(n)}function zi(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Wn(n){var u=n.parentNode;u&&u.lastChild!==n&&u.appendChild(n)}function Nn(n){var u=n.parentNode;u&&u.firstChild!==n&&u.insertBefore(n,u.firstChild)}function Gi(n,u){if(n.classList!==void 0)return n.classList.contains(u);var f=di(n);return f.length>0&&new RegExp("(^|\\s)"+u+"(\\s|$)").test(f)}function Ot(n,u){if(n.classList!==void 0)for(var f=R(u),y=0,k=f.length;y<k;y++)n.classList.add(f[y]);else if(!Gi(n,u)){var T=di(n);Ve(n,(T?T+" ":"")+u)}}function Kt(n,u){n.classList!==void 0?n.classList.remove(u):Ve(n,O((" "+di(n)+" ").replace(" "+u+" "," ")))}function Ve(n,u){n.className.baseVal===void 0?n.className=u:n.className.baseVal=u}function di(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function ce(n,u){"opacity"in n.style?n.style.opacity=u:"filter"in n.style&&vo(n,u)}function vo(n,u){var f=!1,y="DXImageTransform.Microsoft.Alpha";try{f=n.filters.item(y)}catch{if(u===1)return}u=Math.round(u*100),f?(f.Enabled=u!==100,f.Opacity=u):n.style.filter+=" progid:"+y+"(opacity="+u+")"}function Hi(n){for(var u=document.documentElement.style,f=0;f<n.length;f++)if(n[f]in u)return n[f];return!1}function On(n,u,f){var y=u||new X(0,0);n.style[Mr]=(Pt.ie3d?"translate("+y.x+"px,"+y.y+"px)":"translate3d("+y.x+"px,"+y.y+"px,0)")+(f?" scale("+f+")":"")}function ae(n,u){n._leaflet_pos=u,Pt.any3d?On(n,u):(n.style.left=u.x+"px",n.style.top=u.y+"px")}function pn(n){return n._leaflet_pos||new X(0,0)}var an,Kn,Ir;if("onselectstart"in document)an=function(){Rt(window,"selectstart",ne)},Kn=function(){$t(window,"selectstart",ne)};else{var Jn=Hi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);an=function(){if(Jn){var n=document.documentElement.style;Ir=n[Jn],n[Jn]="none"}},Kn=function(){Jn&&(document.documentElement.style[Jn]=Ir,Ir=void 0)}}function Lr(){Rt(window,"dragstart",ne)}function mi(){$t(window,"dragstart",ne)}var Jt,un;function Sr(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&($n(),Jt=n,un=n.style.outlineStyle,n.style.outlineStyle="none",Rt(window,"keydown",$n))}function $n(){Jt&&(Jt.style.outlineStyle=un,Jt=void 0,un=void 0,$t(window,"keydown",$n))}function be(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function Ie(n){var u=n.getBoundingClientRect();return{x:u.width/n.offsetWidth||1,y:u.height/n.offsetHeight||1,boundingClientRect:u}}var qi={__proto__:null,TRANSFORM:Mr,TRANSITION:we,TRANSITION_END:Tn,get:Bi,getStyle:Xe,create:Zt,remove:te,empty:zi,toFront:Wn,toBack:Nn,hasClass:Gi,addClass:Ot,removeClass:Kt,setClass:Ve,getClass:di,setOpacity:ce,testProp:Hi,setTransform:On,setPosition:ae,getPosition:pn,get disableTextSelection(){return an},get enableTextSelection(){return Kn},disableImageDrag:Lr,enableImageDrag:mi,preventOutline:Sr,restoreOutline:$n,getSizedParentNode:be,getScale:Ie};function Rt(n,u,f,y){if(u&&typeof u=="object")for(var k in u)Zi(n,k,u[k],f);else{u=R(u);for(var T=0,$=u.length;T<$;T++)Zi(n,u[T],f,y)}return this}var We="_leaflet_events";function $t(n,u,f,y){if(arguments.length===1)pi(n),delete n[We];else if(u&&typeof u=="object")for(var k in u)Yt(n,k,u[k],f);else if(u=R(u),arguments.length===2)pi(n,function(rt){return A(u,rt)!==-1});else for(var T=0,$=u.length;T<$;T++)Yt(n,u[T],f,y);return this}function pi(n,u){for(var f in n[We]){var y=f.split(/\d/)[0];(!u||u(y))&&Yt(n,y,null,null,f)}}var Cr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Zi(n,u,f,y){var k=u+x(f)+(y?"_"+x(y):"");if(n[We]&&n[We][k])return this;var T=function(rt){return f.call(y||n,rt||window.event)},$=T;!Pt.touchNative&&Pt.pointer&&u.indexOf("touch")===0?T=bn(n,u,T):Pt.touch&&u==="dblclick"?T=Pr(n,T):"addEventListener"in n?u==="touchstart"||u==="touchmove"||u==="wheel"||u==="mousewheel"?n.addEventListener(Cr[u]||u,T,Pt.passiveEvents?{passive:!1}:!1):u==="mouseenter"||u==="mouseleave"?(T=function(rt){rt=rt||window.event,Ui(n,rt)&&$(rt)},n.addEventListener(Cr[u],T,!1)):n.addEventListener(u,$,!1):n.attachEvent("on"+u,T),n[We]=n[We]||{},n[We][k]=T}function Yt(n,u,f,y,k){k=k||u+x(f)+(y?"_"+x(y):"");var T=n[We]&&n[We][k];if(!T)return this;!Pt.touchNative&&Pt.pointer&&u.indexOf("touch")===0?wr(n,u,T):Pt.touch&&u==="dblclick"?ys(n,T):"removeEventListener"in n?n.removeEventListener(Cr[u]||u,T,!1):n.detachEvent("on"+u,T),n[We][k]=null}function de(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function yi(n){return Zi(n,"wheel",de),this}function jn(n){return Rt(n,"mousedown touchstart dblclick contextmenu",de),n._leaflet_disable_click=!0,this}function ne(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function yn(n){return ne(n),de(n),this}function me(n){if(n.composedPath)return n.composedPath();for(var u=[],f=n.target;f;)u.push(f),f=f.parentNode;return u}function br(n,u){if(!u)return new X(n.clientX,n.clientY);var f=Ie(u),y=f.boundingClientRect;return new X((n.clientX-y.left)/f.x-u.clientLeft,(n.clientY-y.top)/f.y-u.clientTop)}var Tr=Pt.linux&&Pt.chrome?window.devicePixelRatio:Pt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Nr(n){return Pt.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Tr:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function Ui(n,u){var f=u.relatedTarget;if(!f)return!0;try{for(;f&&f!==n;)f=f.parentNode}catch{return!1}return f!==n}var _o={__proto__:null,on:Rt,off:$t,stopPropagation:de,disableScrollPropagation:yi,disableClickPropagation:jn,preventDefault:ne,stop:yn,getPropagationPath:me,getMousePosition:br,getWheelDelta:Nr,isExternalTarget:Ui,addListener:Rt,removeListener:$t},Or=Q.extend({run:function(n,u,f,y){this.stop(),this._el=n,this._inProgress=!0,this._duration=f||.25,this._easeOutPower=1/Math.max(y||.5,.2),this._startPos=pn(n),this._offset=u.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=B(this._animate,this),this._step()},_step:function(n){var u=+new Date-this._startTime,f=this._duration*1e3;u<f?this._runFrame(this._easeOut(u/f),n):(this._runFrame(1),this._complete())},_runFrame:function(n,u){var f=this._startPos.add(this._offset.multiplyBy(n));u&&f._round(),ae(this._el,f),this.fire("step")},_complete:function(){D(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),Dt=Q.extend({options:{crs:At,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,u){u=W(this,u),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=m(this._onResize,this),this._initEvents(),u.maxBounds&&this.setMaxBounds(u.maxBounds),u.zoom!==void 0&&(this._zoom=this._limitZoom(u.zoom)),u.center&&u.zoom!==void 0&&this.setView(gt(u.center),u.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=we&&Pt.any3d&&!Pt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Rt(this._proxy,Tn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,u,f){if(u=u===void 0?this._zoom:this._limitZoom(u),n=this._limitCenter(gt(n),u,this.options.maxBounds),f=f||{},this._stop(),this._loaded&&!f.reset&&f!==!0){f.animate!==void 0&&(f.zoom=l({animate:f.animate},f.zoom),f.pan=l({animate:f.animate,duration:f.duration},f.pan));var y=this._zoom!==u?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,u,f.zoom):this._tryAnimatedPan(n,f.pan);if(y)return clearTimeout(this._sizeTimer),this}return this._resetView(n,u,f.pan&&f.pan.noMoveStart),this},setZoom:function(n,u){return this._loaded?this.setView(this.getCenter(),n,{zoom:u}):(this._zoom=n,this)},zoomIn:function(n,u){return n=n||(Pt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,u)},zoomOut:function(n,u){return n=n||(Pt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,u)},setZoomAround:function(n,u,f){var y=this.getZoomScale(u),k=this.getSize().divideBy(2),T=n instanceof X?n:this.latLngToContainerPoint(n),$=T.subtract(k).multiplyBy(1-1/y),rt=this.containerPointToLatLng(k.add($));return this.setView(rt,u,{zoom:f})},_getBoundsCenterZoom:function(n,u){u=u||{},n=n.getBounds?n.getBounds():ht(n);var f=J(u.paddingTopLeft||u.padding||[0,0]),y=J(u.paddingBottomRight||u.padding||[0,0]),k=this.getBoundsZoom(n,!1,f.add(y));if(k=typeof u.maxZoom=="number"?Math.min(u.maxZoom,k):k,k===1/0)return{center:n.getCenter(),zoom:k};var T=y.subtract(f).divideBy(2),$=this.project(n.getSouthWest(),k),rt=this.project(n.getNorthEast(),k),ut=this.unproject($.add(rt).divideBy(2).add(T),k);return{center:ut,zoom:k}},fitBounds:function(n,u){if(n=ht(n),!n.isValid())throw new Error("Bounds are not valid.");var f=this._getBoundsCenterZoom(n,u);return this.setView(f.center,f.zoom,u)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,u){return this.setView(n,this._zoom,{pan:u})},panBy:function(n,u){if(n=J(n).round(),u=u||{},!n.x&&!n.y)return this.fire("moveend");if(u.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Or,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),u.noMoveStart||this.fire("movestart"),u.animate!==!1){Ot(this._mapPane,"leaflet-pan-anim");var f=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,f,u.duration||.25,u.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,u,f){if(f=f||{},f.animate===!1||!Pt.any3d)return this.setView(n,u,f);this._stop();var y=this.project(this.getCenter()),k=this.project(n),T=this.getSize(),$=this._zoom;n=gt(n),u=u===void 0?$:u;var rt=Math.max(T.x,T.y),ut=rt*this.getZoomScale($,u),mt=k.distanceTo(y)||1,wt=1.42,Tt=wt*wt;function Ht(le){var Ts=le?-1:1,El=le?ut:rt,Pl=ut*ut-rt*rt+Ts*Tt*Tt*mt*mt,Ml=2*El*Tt*mt,To=Pl/Ml,_a=Math.sqrt(To*To+1)-To,Il=_a<1e-9?-18:Math.log(_a);return Il}function Oe(le){return(Math.exp(le)-Math.exp(-le))/2}function ye(le){return(Math.exp(le)+Math.exp(-le))/2}function tn(le){return Oe(le)/ye(le)}var Fe=Ht(0);function tr(le){return rt*(ye(Fe)/ye(Fe+wt*le))}function _l(le){return rt*(ye(Fe)*tn(Fe+wt*le)-Oe(Fe))/Tt}function xl(le){return 1-Math.pow(1-le,1.5)}var kl=Date.now(),ya=(Ht(1)-Fe)/wt,wl=f.duration?1e3*f.duration:1e3*ya*.8;function va(){var le=(Date.now()-kl)/wl,Ts=xl(le)*ya;le<=1?(this._flyToFrame=B(va,this),this._move(this.unproject(y.add(k.subtract(y).multiplyBy(_l(Ts)/mt)),$),this.getScaleZoom(rt/tr(Ts),$),{flyTo:!0})):this._move(n,u)._moveEnd(!0)}return this._moveStart(!0,f.noMoveStart),va.call(this),this},flyToBounds:function(n,u){var f=this._getBoundsCenterZoom(n,u);return this.flyTo(f.center,f.zoom,u)},setMaxBounds:function(n){return n=ht(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var u=this.options.minZoom;return this.options.minZoom=n,this._loaded&&u!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var u=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&u!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,u){this._enforcingBounds=!0;var f=this.getCenter(),y=this._limitCenter(f,this._zoom,ht(n));return f.equals(y)||this.panTo(y,u),this._enforcingBounds=!1,this},panInside:function(n,u){u=u||{};var f=J(u.paddingTopLeft||u.padding||[0,0]),y=J(u.paddingBottomRight||u.padding||[0,0]),k=this.project(this.getCenter()),T=this.project(n),$=this.getPixelBounds(),rt=ct([$.min.add(f),$.max.subtract(y)]),ut=rt.getSize();if(!rt.contains(T)){this._enforcingBounds=!0;var mt=T.subtract(rt.getCenter()),wt=rt.extend(T).getSize().subtract(ut);k.x+=mt.x<0?-wt.x:wt.x,k.y+=mt.y<0?-wt.y:wt.y,this.panTo(this.unproject(k),u),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=l({animate:!1,pan:!0},n===!0?{animate:!0}:n);var u=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var f=this.getSize(),y=u.divideBy(2).round(),k=f.divideBy(2).round(),T=y.subtract(k);return!T.x&&!T.y?this:(n.animate&&n.pan?this.panBy(T):(n.pan&&this._rawPanBy(T),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(m(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:u,newSize:f}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=l({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var u=m(this._handleGeolocationResponse,this),f=m(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(u,f,n):navigator.geolocation.getCurrentPosition(u,f,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var u=n.code,f=n.message||(u===1?"permission denied":u===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:u,message:"Geolocation error: "+f+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var u=n.coords.latitude,f=n.coords.longitude,y=new ft(u,f),k=y.toBounds(n.coords.accuracy*2),T=this._locateOptions;if(T.setView){var $=this.getBoundsZoom(k);this.setView(y,T.maxZoom?Math.min($,T.maxZoom):$)}var rt={latlng:y,bounds:k,timestamp:n.timestamp};for(var ut in n.coords)typeof n.coords[ut]=="number"&&(rt[ut]=n.coords[ut]);this.fire("locationfound",rt)}},addHandler:function(n,u){if(!u)return this;var f=this[n]=new u(this);return this._handlers.push(f),this.options[n]&&f.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),te(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(D(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)te(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,u){var f="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),y=Zt("div",f,u||this._mapPane);return n&&(this._panes[n]=y),y},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),u=this.unproject(n.getBottomLeft()),f=this.unproject(n.getTopRight());return new pt(u,f)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,u,f){n=ht(n),f=J(f||[0,0]);var y=this.getZoom()||0,k=this.getMinZoom(),T=this.getMaxZoom(),$=n.getNorthWest(),rt=n.getSouthEast(),ut=this.getSize().subtract(f),mt=ct(this.project(rt,y),this.project($,y)).getSize(),wt=Pt.any3d?this.options.zoomSnap:1,Tt=ut.x/mt.x,Ht=ut.y/mt.y,Oe=u?Math.max(Tt,Ht):Math.min(Tt,Ht);return y=this.getScaleZoom(Oe,y),wt&&(y=Math.round(y/(wt/100))*(wt/100),y=u?Math.ceil(y/wt)*wt:Math.floor(y/wt)*wt),Math.max(k,Math.min(T,y))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new X(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,u){var f=this._getTopLeftPoint(n,u);return new ot(f,f.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,u){var f=this.options.crs;return u=u===void 0?this._zoom:u,f.scale(n)/f.scale(u)},getScaleZoom:function(n,u){var f=this.options.crs;u=u===void 0?this._zoom:u;var y=f.zoom(n*f.scale(u));return isNaN(y)?1/0:y},project:function(n,u){return u=u===void 0?this._zoom:u,this.options.crs.latLngToPoint(gt(n),u)},unproject:function(n,u){return u=u===void 0?this._zoom:u,this.options.crs.pointToLatLng(J(n),u)},layerPointToLatLng:function(n){var u=J(n).add(this.getPixelOrigin());return this.unproject(u)},latLngToLayerPoint:function(n){var u=this.project(gt(n))._round();return u._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(gt(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(ht(n))},distance:function(n,u){return this.options.crs.distance(gt(n),gt(u))},containerPointToLayerPoint:function(n){return J(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return J(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var u=this.containerPointToLayerPoint(J(n));return this.layerPointToLatLng(u)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(gt(n)))},mouseEventToContainerPoint:function(n){return br(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var u=this._container=Bi(n);if(u){if(u._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Rt(u,"scroll",this._onScroll,this),this._containerId=x(u)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&Pt.any3d,Ot(n,"leaflet-container"+(Pt.touch?" leaflet-touch":"")+(Pt.retina?" leaflet-retina":"")+(Pt.ielt9?" leaflet-oldie":"")+(Pt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var u=Xe(n,"position");u!=="absolute"&&u!=="relative"&&u!=="fixed"&&u!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ae(this._mapPane,new X(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ot(n.markerPane,"leaflet-zoom-hide"),Ot(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,u,f){ae(this._mapPane,new X(0,0));var y=!this._loaded;this._loaded=!0,u=this._limitZoom(u),this.fire("viewprereset");var k=this._zoom!==u;this._moveStart(k,f)._move(n,u)._moveEnd(k),this.fire("viewreset"),y&&this.fire("load")},_moveStart:function(n,u){return n&&this.fire("zoomstart"),u||this.fire("movestart"),this},_move:function(n,u,f,y){u===void 0&&(u=this._zoom);var k=this._zoom!==u;return this._zoom=u,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),y?f&&f.pinch&&this.fire("zoom",f):((k||f&&f.pinch)&&this.fire("zoom",f),this.fire("move",f)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return D(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){ae(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[x(this._container)]=this;var u=n?$t:Rt;u(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&u(window,"resize",this._onResize,this),Pt.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){D(this._resizeRequest),this._resizeRequest=B(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,u){for(var f=[],y,k=u==="mouseout"||u==="mouseover",T=n.target||n.srcElement,$=!1;T;){if(y=this._targets[x(T)],y&&(u==="click"||u==="preclick")&&this._draggableMoved(y)){$=!0;break}if(y&&y.listens(u,!0)&&(k&&!Ui(T,n)||(f.push(y),k))||T===this._container)break;T=T.parentNode}return!f.length&&!$&&!k&&this.listens(u,!0)&&(f=[this]),f},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var u=n.target||n.srcElement;if(!(!this._loaded||u._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(u))){var f=n.type;f==="mousedown"&&Sr(u),this._fireDOMEvent(n,f)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,u,f){if(n.type==="click"){var y=l({},n);y.type="preclick",this._fireDOMEvent(y,y.type,f)}var k=this._findEventTargets(n,u);if(f){for(var T=[],$=0;$<f.length;$++)f[$].listens(u,!0)&&T.push(f[$]);k=T.concat(k)}if(k.length){u==="contextmenu"&&ne(n);var rt=k[0],ut={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var mt=rt.getLatLng&&(!rt._radius||rt._radius<=10);ut.containerPoint=mt?this.latLngToContainerPoint(rt.getLatLng()):this.mouseEventToContainerPoint(n),ut.layerPoint=this.containerPointToLayerPoint(ut.containerPoint),ut.latlng=mt?rt.getLatLng():this.layerPointToLatLng(ut.layerPoint)}for($=0;$<k.length;$++)if(k[$].fire(u,ut,!0),ut.originalEvent._stopped||k[$].options.bubblingMouseEvents===!1&&A(this._mouseEvents,u)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,u=this._handlers.length;n<u;n++)this._handlers[n].disable()},whenReady:function(n,u){return this._loaded?n.call(u||this,{target:this}):this.on("load",n,u),this},_getMapPanePos:function(){return pn(this._mapPane)||new X(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,u){var f=n&&u!==void 0?this._getNewPixelOrigin(n,u):this.getPixelOrigin();return f.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,u){var f=this.getSize()._divideBy(2);return this.project(n,u)._subtract(f)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,u,f){var y=this._getNewPixelOrigin(f,u);return this.project(n,u)._subtract(y)},_latLngBoundsToNewLayerBounds:function(n,u,f){var y=this._getNewPixelOrigin(f,u);return ct([this.project(n.getSouthWest(),u)._subtract(y),this.project(n.getNorthWest(),u)._subtract(y),this.project(n.getSouthEast(),u)._subtract(y),this.project(n.getNorthEast(),u)._subtract(y)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,u,f){if(!f)return n;var y=this.project(n,u),k=this.getSize().divideBy(2),T=new ot(y.subtract(k),y.add(k)),$=this._getBoundsOffset(T,f,u);return Math.abs($.x)<=1&&Math.abs($.y)<=1?n:this.unproject(y.add($),u)},_limitOffset:function(n,u){if(!u)return n;var f=this.getPixelBounds(),y=new ot(f.min.add(n),f.max.add(n));return n.add(this._getBoundsOffset(y,u))},_getBoundsOffset:function(n,u,f){var y=ct(this.project(u.getNorthEast(),f),this.project(u.getSouthWest(),f)),k=y.min.subtract(n.min),T=y.max.subtract(n.max),$=this._rebound(k.x,-T.x),rt=this._rebound(k.y,-T.y);return new X($,rt)},_rebound:function(n,u){return n+u>0?Math.round(n-u)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(u))},_limitZoom:function(n){var u=this.getMinZoom(),f=this.getMaxZoom(),y=Pt.any3d?this.options.zoomSnap:1;return y&&(n=Math.round(n/y)*y),Math.max(u,Math.min(f,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Kt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,u){var f=this._getCenterOffset(n)._trunc();return(u&&u.animate)!==!0&&!this.getSize().contains(f)?!1:(this.panBy(f,u),!0)},_createAnimProxy:function(){var n=this._proxy=Zt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(u){var f=Mr,y=this._proxy.style[f];On(this._proxy,this.project(u.center,u.zoom),this.getZoomScale(u.zoom,1)),y===this._proxy.style[f]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){te(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),u=this.getZoom();On(this._proxy,this.project(n,u),this.getZoomScale(u,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,u,f){if(this._animatingZoom)return!0;if(f=f||{},!this._zoomAnimated||f.animate===!1||this._nothingToAnimate()||Math.abs(u-this._zoom)>this.options.zoomAnimationThreshold)return!1;var y=this.getZoomScale(u),k=this._getCenterOffset(n)._divideBy(1-1/y);return f.animate!==!0&&!this.getSize().contains(k)?!1:(B(function(){this._moveStart(!0,f.noMoveStart||!1)._animateZoom(n,u,!0)},this),!0)},_animateZoom:function(n,u,f,y){this._mapPane&&(f&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=u,Ot(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:u,noUpdate:y}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(m(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Kt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Yi(n,u){return new Dt(n,u)}var Ge=Z.extend({options:{position:"topright"},initialize:function(n){W(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var u=this._map;return u&&u.removeControl(this),this.options.position=n,u&&u.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var u=this._container=this.onAdd(n),f=this.getPosition(),y=n._controlCorners[f];return Ot(u,"leaflet-control"),f.indexOf("bottom")!==-1?y.insertBefore(u,y.firstChild):y.appendChild(u),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(te(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),pe=function(n){return new Ge(n)};Dt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},u="leaflet-",f=this._controlContainer=Zt("div",u+"control-container",this._container);function y(k,T){var $=u+k+" "+u+T;n[k+T]=Zt("div",$,f)}y("top","left"),y("top","right"),y("bottom","left"),y("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)te(this._controlCorners[n]);te(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var An=Ge.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,u,f,y){return f<y?-1:y<f?1:0}},initialize:function(n,u,f){W(this,f),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var y in n)this._addLayer(n[y],y);for(y in u)this._addLayer(u[y],y,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return Ge.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,u){return this._addLayer(n,u),this._map?this._update():this},addOverlay:function(n,u){return this._addLayer(n,u,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var u=this._getLayer(x(n));return u&&this._layers.splice(this._layers.indexOf(u),1),this._map?this._update():this},expand:function(){Ot(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(Ot(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Kt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Kt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",u=this._container=Zt("div",n),f=this.options.collapsed;u.setAttribute("aria-haspopup",!0),jn(u),yi(u);var y=this._section=Zt("section",n+"-list");f&&(this._map.on("click",this.collapse,this),Rt(u,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var k=this._layersLink=Zt("a",n+"-toggle",u);k.href="#",k.title="Layers",k.setAttribute("role","button"),Rt(k,{keydown:function(T){T.keyCode===13&&this._expandSafely()},click:function(T){ne(T),this._expandSafely()}},this),f||this.expand(),this._baseLayersList=Zt("div",n+"-base",y),this._separator=Zt("div",n+"-separator",y),this._overlaysList=Zt("div",n+"-overlays",y),u.appendChild(y)},_getLayer:function(n){for(var u=0;u<this._layers.length;u++)if(this._layers[u]&&x(this._layers[u].layer)===n)return this._layers[u]},_addLayer:function(n,u,f){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:u,overlay:f}),this.options.sortLayers&&this._layers.sort(m(function(y,k){return this.options.sortFunction(y.layer,k.layer,y.name,k.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;zi(this._baseLayersList),zi(this._overlaysList),this._layerControlInputs=[];var n,u,f,y,k=0;for(f=0;f<this._layers.length;f++)y=this._layers[f],this._addItem(y),u=u||y.overlay,n=n||!y.overlay,k+=y.overlay?0:1;return this.options.hideSingleBase&&(n=n&&k>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=u&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var u=this._getLayer(x(n.target)),f=u.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;f&&this._map.fire(f,u)},_createRadioElement:function(n,u){var f='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(u?' checked="checked"':"")+"/>",y=document.createElement("div");return y.innerHTML=f,y.firstChild},_addItem:function(n){var u=document.createElement("label"),f=this._map.hasLayer(n.layer),y;n.overlay?(y=document.createElement("input"),y.type="checkbox",y.className="leaflet-control-layers-selector",y.defaultChecked=f):y=this._createRadioElement("leaflet-base-layers_"+x(this),f),this._layerControlInputs.push(y),y.layerId=x(n.layer),Rt(y,"click",this._onInputClick,this);var k=document.createElement("span");k.innerHTML=" "+n.name;var T=document.createElement("span");u.appendChild(T),T.appendChild(y),T.appendChild(k);var $=n.overlay?this._overlaysList:this._baseLayersList;return $.appendChild(u),this._checkDisabledLayers(),u},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,u,f,y=[],k=[];this._handlingClick=!0;for(var T=n.length-1;T>=0;T--)u=n[T],f=this._getLayer(u.layerId).layer,u.checked?y.push(f):u.checked||k.push(f);for(T=0;T<k.length;T++)this._map.hasLayer(k[T])&&this._map.removeLayer(k[T]);for(T=0;T<y.length;T++)this._map.hasLayer(y[T])||this._map.addLayer(y[T]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,u,f,y=this._map.getZoom(),k=n.length-1;k>=0;k--)u=n[k],f=this._getLayer(u.layerId).layer,u.disabled=f.options.minZoom!==void 0&&y<f.options.minZoom||f.options.maxZoom!==void 0&&y>f.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,Rt(n,"click",ne),this.expand();var u=this;setTimeout(function(){$t(n,"click",ne),u._preventClick=!1})}}),xo=function(n,u,f){return new An(n,u,f)},vn=Ge.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var u="leaflet-control-zoom",f=Zt("div",u+" leaflet-bar"),y=this.options;return this._zoomInButton=this._createButton(y.zoomInText,y.zoomInTitle,u+"-in",f,this._zoomIn),this._zoomOutButton=this._createButton(y.zoomOutText,y.zoomOutTitle,u+"-out",f,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),f},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,u,f,y,k){var T=Zt("a",f,y);return T.innerHTML=n,T.href="#",T.title=u,T.setAttribute("role","button"),T.setAttribute("aria-label",u),jn(T),Rt(T,"click",yn),Rt(T,"click",k,this),Rt(T,"click",this._refocusOnMap,this),T},_updateDisabled:function(){var n=this._map,u="leaflet-disabled";Kt(this._zoomInButton,u),Kt(this._zoomOutButton,u),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(Ot(this._zoomOutButton,u),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(Ot(this._zoomInButton,u),this._zoomInButton.setAttribute("aria-disabled","true"))}});Dt.mergeOptions({zoomControl:!0}),Dt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new vn,this.addControl(this.zoomControl))});var vs=function(n){return new vn(n)},Rn=Ge.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var u="leaflet-control-scale",f=Zt("div",u),y=this.options;return this._addScales(y,u+"-line",f),n.on(y.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),f},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,u,f){n.metric&&(this._mScale=Zt("div",u,f)),n.imperial&&(this._iScale=Zt("div",u,f))},_update:function(){var n=this._map,u=n.getSize().y/2,f=n.distance(n.containerPointToLatLng([0,u]),n.containerPointToLatLng([this.options.maxWidth,u]));this._updateScales(f)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var u=this._getRoundNum(n),f=u<1e3?u+" m":u/1e3+" km";this._updateScale(this._mScale,f,u/n)},_updateImperial:function(n){var u=n*3.2808399,f,y,k;u>5280?(f=u/5280,y=this._getRoundNum(f),this._updateScale(this._iScale,y+" mi",y/f)):(k=this._getRoundNum(u),this._updateScale(this._iScale,k+" ft",k/u))},_updateScale:function(n,u,f){n.style.width=Math.round(this.options.maxWidth*f)+"px",n.innerHTML=u},_getRoundNum:function(n){var u=Math.pow(10,(Math.floor(n)+"").length-1),f=n/u;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:1,u*f}}),ko=function(n){return new Rn(n)},Ke='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Xi=Ge.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Pt.inlineSvg?Ke+" ":"")+"Leaflet</a>"},initialize:function(n){W(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=Zt("div","leaflet-control-attribution"),jn(this._container);for(var u in n._layers)n._layers[u].getAttribution&&this.addAttribution(n._layers[u].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var u in this._attributions)this._attributions[u]&&n.push(u);var f=[];this.options.prefix&&f.push(this.options.prefix),n.length&&f.push(n.join(", ")),this._container.innerHTML=f.join(' <span aria-hidden="true">|</span> ')}}});Dt.mergeOptions({attributionControl:!0}),Dt.addInitHook(function(){this.options.attributionControl&&new Xi().addTo(this)});var wo=function(n){return new Xi(n)};Ge.Layers=An,Ge.Zoom=vn,Ge.Scale=Rn,Ge.Attribution=Xi,pe.layers=xo,pe.zoom=vs,pe.scale=ko,pe.attribution=wo;var Je=Z.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Je.addTo=function(n,u){return n.addHandler(u,this),this};var Eo={Events:G},_s=Pt.touch?"touchstart mousedown":"mousedown",_n=Q.extend({options:{clickTolerance:3},initialize:function(n,u,f,y){W(this,y),this._element=n,this._dragStartTarget=u||n,this._preventOutline=f},enable:function(){this._enabled||(Rt(this._dragStartTarget,_s,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(_n._dragging===this&&this.finishDrag(!0),$t(this._dragStartTarget,_s,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!Gi(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){_n._dragging===this&&this.finishDrag();return}if(!(_n._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(_n._dragging=this,this._preventOutline&&Sr(this._element),Lr(),an(),!this._moving)){this.fire("down");var u=n.touches?n.touches[0]:n,f=be(this._element);this._startPoint=new X(u.clientX,u.clientY),this._startPos=pn(this._element),this._parentScale=Ie(f);var y=n.type==="mousedown";Rt(document,y?"mousemove":"touchmove",this._onMove,this),Rt(document,y?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var u=n.touches&&n.touches.length===1?n.touches[0]:n,f=new X(u.clientX,u.clientY)._subtract(this._startPoint);!f.x&&!f.y||Math.abs(f.x)+Math.abs(f.y)<this.options.clickTolerance||(f.x/=this._parentScale.x,f.y/=this._parentScale.y,ne(n),this._moved||(this.fire("dragstart"),this._moved=!0,Ot(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ot(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(f),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),ae(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Kt(document.body,"leaflet-dragging"),this._lastTarget&&(Kt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),$t(document,"mousemove touchmove",this._onMove,this),$t(document,"mouseup touchend touchcancel",this._onUp,this),mi(),Kn();var u=this._moved&&this._moving;this._moving=!1,_n._dragging=!1,u&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function xs(n,u,f){var y,k=[1,4,2,8],T,$,rt,ut,mt,wt,Tt,Ht;for(T=0,wt=n.length;T<wt;T++)n[T]._code=ue(n[T],u);for(rt=0;rt<4;rt++){for(Tt=k[rt],y=[],T=0,wt=n.length,$=wt-1;T<wt;$=T++)ut=n[T],mt=n[$],ut._code&Tt?mt._code&Tt||(Ht=vi(mt,ut,Tt,u,f),Ht._code=ue(Ht,u),y.push(Ht)):(mt._code&Tt&&(Ht=vi(mt,ut,Tt,u,f),Ht._code=ue(Ht,u),y.push(Ht)),y.push(ut));n=y}return n}function ks(n,u){var f,y,k,T,$,rt,ut,mt,wt;if(!n||n.length===0)throw new Error("latlngs not passed");Ne(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Tt=gt([0,0]),Ht=ht(n),Oe=Ht.getNorthWest().distanceTo(Ht.getSouthWest())*Ht.getNorthEast().distanceTo(Ht.getNorthWest());Oe<1700&&(Tt=ln(n));var ye=n.length,tn=[];for(f=0;f<ye;f++){var Fe=gt(n[f]);tn.push(u.project(gt([Fe.lat-Tt.lat,Fe.lng-Tt.lng])))}for(rt=ut=mt=0,f=0,y=ye-1;f<ye;y=f++)k=tn[f],T=tn[y],$=k.y*T.x-T.y*k.x,ut+=(k.x+T.x)*$,mt+=(k.y+T.y)*$,rt+=$*3;rt===0?wt=tn[0]:wt=[ut/rt,mt/rt];var tr=u.unproject(J(wt));return gt([tr.lat+Tt.lat,tr.lng+Tt.lng])}function ln(n){for(var u=0,f=0,y=0,k=0;k<n.length;k++){var T=gt(n[k]);u+=T.lat,f+=T.lng,y++}return gt([u/y,f/y])}var Te={__proto__:null,clipPolygon:xs,polygonCenter:ks,centroid:ln};function ws(n,u){if(!u||!n.length)return n.slice();var f=u*u;return n=Dr(n,f),n=Rr(n,f),n}function Ar(n,u,f){return Math.sqrt(xi(n,u,f,!0))}function Po(n,u,f){return xi(n,u,f)}function Rr(n,u){var f=n.length,y=typeof Uint8Array<"u"?Uint8Array:Array,k=new y(f);k[0]=k[f-1]=1,Vi(n,k,u,0,f-1);var T,$=[];for(T=0;T<f;T++)k[T]&&$.push(n[T]);return $}function Vi(n,u,f,y,k){var T=0,$,rt,ut;for(rt=y+1;rt<=k-1;rt++)ut=xi(n[rt],n[y],n[k],!0),ut>T&&($=rt,T=ut);T>f&&(u[$]=1,Vi(n,u,f,y,$),Vi(n,u,f,$,k))}function Dr(n,u){for(var f=[n[0]],y=1,k=0,T=n.length;y<T;y++)_i(n[y],n[k])>u&&(f.push(n[y]),k=y);return k<T-1&&f.push(n[T-1]),f}var Fr;function De(n,u,f,y,k){var T=y?Fr:ue(n,f),$=ue(u,f),rt,ut,mt;for(Fr=$;;){if(!(T|$))return[n,u];if(T&$)return!1;rt=T||$,ut=vi(n,u,rt,f,k),mt=ue(ut,f),rt===T?(n=ut,T=mt):(u=ut,$=mt)}}function vi(n,u,f,y,k){var T=u.x-n.x,$=u.y-n.y,rt=y.min,ut=y.max,mt,wt;return f&8?(mt=n.x+T*(ut.y-n.y)/$,wt=ut.y):f&4?(mt=n.x+T*(rt.y-n.y)/$,wt=rt.y):f&2?(mt=ut.x,wt=n.y+$*(ut.x-n.x)/T):f&1&&(mt=rt.x,wt=n.y+$*(rt.x-n.x)/T),new X(mt,wt,k)}function ue(n,u){var f=0;return n.x<u.min.x?f|=1:n.x>u.max.x&&(f|=2),n.y<u.min.y?f|=4:n.y>u.max.y&&(f|=8),f}function _i(n,u){var f=u.x-n.x,y=u.y-n.y;return f*f+y*y}function xi(n,u,f,y){var k=u.x,T=u.y,$=f.x-k,rt=f.y-T,ut=$*$+rt*rt,mt;return ut>0&&(mt=((n.x-k)*$+(n.y-T)*rt)/ut,mt>1?(k=f.x,T=f.y):mt>0&&(k+=$*mt,T+=rt*mt)),$=n.x-k,rt=n.y-T,y?$*$+rt*rt:new X(k,T)}function Ne(n){return!q(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Br(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ne(n)}function zr(n,u){var f,y,k,T,$,rt,ut,mt;if(!n||n.length===0)throw new Error("latlngs not passed");Ne(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var wt=gt([0,0]),Tt=ht(n),Ht=Tt.getNorthWest().distanceTo(Tt.getSouthWest())*Tt.getNorthEast().distanceTo(Tt.getNorthWest());Ht<1700&&(wt=ln(n));var Oe=n.length,ye=[];for(f=0;f<Oe;f++){var tn=gt(n[f]);ye.push(u.project(gt([tn.lat-wt.lat,tn.lng-wt.lng])))}for(f=0,y=0;f<Oe-1;f++)y+=ye[f].distanceTo(ye[f+1])/2;if(y===0)mt=ye[0];else for(f=0,T=0;f<Oe-1;f++)if($=ye[f],rt=ye[f+1],k=$.distanceTo(rt),T+=k,T>y){ut=(T-y)/k,mt=[rt.x-ut*(rt.x-$.x),rt.y-ut*(rt.y-$.y)];break}var Fe=u.unproject(J(mt));return gt([Fe.lat+wt.lat,Fe.lng+wt.lng])}var Gr={__proto__:null,simplify:ws,pointToSegmentDistance:Ar,closestPointOnSegment:Po,clipSegment:De,_getEdgeIntersection:vi,_getBitCode:ue,_sqClosestPointOnSegment:xi,isFlat:Ne,_flat:Br,polylineCenter:zr},Hr={project:function(n){return new X(n.lng,n.lat)},unproject:function(n){return new ft(n.y,n.x)},bounds:new ot([-180,-90],[180,90])},qr={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ot([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var u=Math.PI/180,f=this.R,y=n.lat*u,k=this.R_MINOR/f,T=Math.sqrt(1-k*k),$=T*Math.sin(y),rt=Math.tan(Math.PI/4-y/2)/Math.pow((1-$)/(1+$),T/2);return y=-f*Math.log(Math.max(rt,1e-10)),new X(n.lng*u*f,y)},unproject:function(n){for(var u=180/Math.PI,f=this.R,y=this.R_MINOR/f,k=Math.sqrt(1-y*y),T=Math.exp(-n.y/f),$=Math.PI/2-2*Math.atan(T),rt=0,ut=.1,mt;rt<15&&Math.abs(ut)>1e-7;rt++)mt=k*Math.sin($),mt=Math.pow((1-mt)/(1+mt),k/2),ut=Math.PI/2-2*Math.atan(T*mt)-$,$+=ut;return new ft($*u,n.x*u/f)}},Mo={__proto__:null,LonLat:Hr,Mercator:qr,SphericalMercator:Ct},Io=l({},et,{code:"EPSG:3395",projection:qr,transformation:function(){var n=.5/(Math.PI*qr.R);return Y(n,.5,-n,.5)}()}),Es=l({},et,{code:"EPSG:4326",projection:Hr,transformation:Y(1/180,1,-1/180,.5)}),Lo=l({},kt,{projection:Hr,transformation:Y(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,u){var f=u.lng-n.lng,y=u.lat-n.lat;return Math.sqrt(f*f+y*y)},infinite:!0});kt.Earth=et,kt.EPSG3395=Io,kt.EPSG3857=At,kt.EPSG900913=Gt,kt.EPSG4326=Es,kt.Simple=Lo;var He=Q.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[x(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[x(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var u=n.target;if(u.hasLayer(this)){if(this._map=u,this._zoomAnimated=u._zoomAnimated,this.getEvents){var f=this.getEvents();u.on(f,this),this.once("remove",function(){u.off(f,this)},this)}this.onAdd(u),this.fire("add"),u.fire("layeradd",{layer:this})}}});Dt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var u=x(n);return this._layers[u]?this:(this._layers[u]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var u=x(n);return this._layers[u]?(this._loaded&&n.onRemove(this),delete this._layers[u],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return x(n)in this._layers},eachLayer:function(n,u){for(var f in this._layers)n.call(u,this._layers[f]);return this},_addLayers:function(n){n=n?q(n)?n:[n]:[];for(var u=0,f=n.length;u<f;u++)this.addLayer(n[u])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[x(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var u=x(n);this._zoomBoundLayers[u]&&(delete this._zoomBoundLayers[u],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,u=-1/0,f=this._getZoomSpan();for(var y in this._zoomBoundLayers){var k=this._zoomBoundLayers[y].options;n=k.minZoom===void 0?n:Math.min(n,k.minZoom),u=k.maxZoom===void 0?u:Math.max(u,k.maxZoom)}this._layersMaxZoom=u===-1/0?void 0:u,this._layersMinZoom=n===1/0?void 0:n,f!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Qn=He.extend({initialize:function(n,u){W(this,u),this._layers={};var f,y;if(n)for(f=0,y=n.length;f<y;f++)this.addLayer(n[f])},addLayer:function(n){var u=this.getLayerId(n);return this._layers[u]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var u=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[u]&&this._map.removeLayer(this._layers[u]),delete this._layers[u],this},hasLayer:function(n){var u=typeof n=="number"?n:this.getLayerId(n);return u in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var u=Array.prototype.slice.call(arguments,1),f,y;for(f in this._layers)y=this._layers[f],y[n]&&y[n].apply(y,u);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,u){for(var f in this._layers)n.call(u,this._layers[f]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return x(n)}}),Ps=function(n,u){return new Qn(n,u)},hn=Qn.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),Qn.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),Qn.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new pt;for(var u in this._layers){var f=this._layers[u];n.extend(f.getBounds?f.getBounds():f.getLatLng())}return n}}),Ms=function(n,u){return new hn(n,u)},ti=Z.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){W(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,u){var f=this._getIconUrl(n);if(!f){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var y=this._createImg(f,u&&u.tagName==="IMG"?u:null);return this._setIconStyles(y,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),y},_setIconStyles:function(n,u){var f=this.options,y=f[u+"Size"];typeof y=="number"&&(y=[y,y]);var k=J(y),T=J(u==="shadow"&&f.shadowAnchor||f.iconAnchor||k&&k.divideBy(2,!0));n.className="leaflet-marker-"+u+" "+(f.className||""),T&&(n.style.marginLeft=-T.x+"px",n.style.marginTop=-T.y+"px"),k&&(n.style.width=k.x+"px",n.style.height=k.y+"px")},_createImg:function(n,u){return u=u||document.createElement("img"),u.src=n,u},_getIconUrl:function(n){return Pt.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function So(n){return new ti(n)}var ki=ti.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof ki.imagePath!="string"&&(ki.imagePath=this._detectIconPath()),(this.options.imagePath||ki.imagePath)+ti.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var u=function(f,y,k){var T=y.exec(f);return T&&T[k]};return n=u(n,/^url\((['"])?(.+)\1\)$/,2),n&&u(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=Zt("div","leaflet-default-icon-path",document.body),u=Xe(n,"background-image")||Xe(n,"backgroundImage");if(document.body.removeChild(n),u=this._stripUrl(u),u)return u;var f=document.querySelector('link[href$="leaflet.css"]');return f?f.href.substring(0,f.href.length-11-1):""}}),Is=Je.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new _n(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ot(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Kt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var u=this._marker,f=u._map,y=this._marker.options.autoPanSpeed,k=this._marker.options.autoPanPadding,T=pn(u._icon),$=f.getPixelBounds(),rt=f.getPixelOrigin(),ut=ct($.min._subtract(rt).add(k),$.max._subtract(rt).subtract(k));if(!ut.contains(T)){var mt=J((Math.max(ut.max.x,T.x)-ut.max.x)/($.max.x-ut.max.x)-(Math.min(ut.min.x,T.x)-ut.min.x)/($.min.x-ut.min.x),(Math.max(ut.max.y,T.y)-ut.max.y)/($.max.y-ut.max.y)-(Math.min(ut.min.y,T.y)-ut.min.y)/($.min.y-ut.min.y)).multiplyBy(y);f.panBy(mt,{animate:!1}),this._draggable._newPos._add(mt),this._draggable._startPos._add(mt),ae(u._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=B(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(D(this._panRequest),this._panRequest=B(this._adjustPan.bind(this,n)))},_onDrag:function(n){var u=this._marker,f=u._shadow,y=pn(u._icon),k=u._map.layerPointToLatLng(y);f&&ae(f,y),u._latlng=k,n.latlng=k,n.oldLatLng=this._oldLatLng,u.fire("move",n).fire("drag",n)},_onDragEnd:function(n){D(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),Wi=He.extend({options:{icon:new ki,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,u){W(this,u),this._latlng=gt(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var u=this._latlng;return this._latlng=gt(n),this.update(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,u="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),f=n.icon.createIcon(this._icon),y=!1;f!==this._icon&&(this._icon&&this._removeIcon(),y=!0,n.title&&(f.title=n.title),f.tagName==="IMG"&&(f.alt=n.alt||"")),Ot(f,u),n.keyboard&&(f.tabIndex="0",f.setAttribute("role","button")),this._icon=f,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Rt(f,"focus",this._panOnFocus,this);var k=n.icon.createShadow(this._shadow),T=!1;k!==this._shadow&&(this._removeShadow(),T=!0),k&&(Ot(k,u),k.alt=""),this._shadow=k,n.opacity<1&&this._updateOpacity(),y&&this.getPane().appendChild(this._icon),this._initInteraction(),k&&T&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&$t(this._icon,"focus",this._panOnFocus,this),te(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&te(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&ae(this._icon,n),this._shadow&&ae(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var u=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(u)},_initInteraction:function(){if(this.options.interactive&&(Ot(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Is)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Is(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&ce(this._icon,n),this._shadow&&ce(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var u=this.options.icon.options,f=u.iconSize?J(u.iconSize):J(0,0),y=u.iconAnchor?J(u.iconAnchor):J(0,0);n.panInside(this._latlng,{paddingTopLeft:y,paddingBottomRight:f.subtract(y)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Co(n,u){return new Wi(n,u)}var xn=He.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return W(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),wi=xn.extend({options:{fill:!0,radius:10},initialize:function(n,u){W(this,u),this._latlng=gt(n),this._radius=this.options.radius},setLatLng:function(n){var u=this._latlng;return this._latlng=gt(n),this.redraw(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var u=n&&n.radius||this._radius;return xn.prototype.setStyle.call(this,n),this.setRadius(u),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,u=this._radiusY||n,f=this._clickTolerance(),y=[n+f,u+f];this._pxBounds=new ot(this._point.subtract(y),this._point.add(y))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ls(n,u){return new wi(n,u)}var Ki=wi.extend({initialize:function(n,u,f){if(typeof u=="number"&&(u=l({},f,{radius:u})),W(this,u),this._latlng=gt(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new pt(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:xn.prototype.setStyle,_project:function(){var n=this._latlng.lng,u=this._latlng.lat,f=this._map,y=f.options.crs;if(y.distance===et.distance){var k=Math.PI/180,T=this._mRadius/et.R/k,$=f.project([u+T,n]),rt=f.project([u-T,n]),ut=$.add(rt).divideBy(2),mt=f.unproject(ut).lat,wt=Math.acos((Math.cos(T*k)-Math.sin(u*k)*Math.sin(mt*k))/(Math.cos(u*k)*Math.cos(mt*k)))/k;(isNaN(wt)||wt===0)&&(wt=T/Math.cos(Math.PI/180*u)),this._point=ut.subtract(f.getPixelOrigin()),this._radius=isNaN(wt)?0:ut.x-f.project([mt,n-wt]).x,this._radiusY=ut.y-$.y}else{var Tt=y.unproject(y.project(this._latlng).subtract([this._mRadius,0]));this._point=f.latLngToLayerPoint(this._latlng),this._radius=this._point.x-f.latLngToLayerPoint(Tt).x}this._updateBounds()}});function bo(n,u,f){return new Ki(n,u,f)}var $e=xn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,u){W(this,u),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var u=1/0,f=null,y=xi,k,T,$=0,rt=this._parts.length;$<rt;$++)for(var ut=this._parts[$],mt=1,wt=ut.length;mt<wt;mt++){k=ut[mt-1],T=ut[mt];var Tt=y(n,k,T,!0);Tt<u&&(u=Tt,f=y(n,k,T))}return f&&(f.distance=Math.sqrt(u)),f},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return zr(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,u){return u=u||this._defaultShape(),n=gt(n),u.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new pt,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return Ne(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var u=[],f=Ne(n),y=0,k=n.length;y<k;y++)f?(u[y]=gt(n[y]),this._bounds.extend(u[y])):u[y]=this._convertLatLngs(n[y]);return u},_project:function(){var n=new ot;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),u=new X(n,n);this._rawPxBounds&&(this._pxBounds=new ot([this._rawPxBounds.min.subtract(u),this._rawPxBounds.max.add(u)]))},_projectLatlngs:function(n,u,f){var y=n[0]instanceof ft,k=n.length,T,$;if(y){for($=[],T=0;T<k;T++)$[T]=this._map.latLngToLayerPoint(n[T]),f.extend($[T]);u.push($)}else for(T=0;T<k;T++)this._projectLatlngs(n[T],u,f)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var u=this._parts,f,y,k,T,$,rt,ut;for(f=0,k=0,T=this._rings.length;f<T;f++)for(ut=this._rings[f],y=0,$=ut.length;y<$-1;y++)rt=De(ut[y],ut[y+1],n,y,!0),rt&&(u[k]=u[k]||[],u[k].push(rt[0]),(rt[1]!==ut[y+1]||y===$-2)&&(u[k].push(rt[1]),k++))}},_simplifyPoints:function(){for(var n=this._parts,u=this.options.smoothFactor,f=0,y=n.length;f<y;f++)n[f]=ws(n[f],u)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,u){var f,y,k,T,$,rt,ut=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(f=0,T=this._parts.length;f<T;f++)for(rt=this._parts[f],y=0,$=rt.length,k=$-1;y<$;k=y++)if(!(!u&&y===0)&&Ar(n,rt[k],rt[y])<=ut)return!0;return!1}});function Zr(n,u){return new $e(n,u)}$e._flat=Br;var ei=$e.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ks(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var u=$e.prototype._convertLatLngs.call(this,n),f=u.length;return f>=2&&u[0]instanceof ft&&u[0].equals(u[f-1])&&u.pop(),u},_setLatLngs:function(n){$e.prototype._setLatLngs.call(this,n),Ne(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ne(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,u=this.options.weight,f=new X(u,u);if(n=new ot(n.min.subtract(f),n.max.add(f)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var y=0,k=this._rings.length,T;y<k;y++)T=xs(this._rings[y],n,!0),T.length&&this._parts.push(T)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var u=!1,f,y,k,T,$,rt,ut,mt;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(T=0,ut=this._parts.length;T<ut;T++)for(f=this._parts[T],$=0,mt=f.length,rt=mt-1;$<mt;rt=$++)y=f[$],k=f[rt],y.y>n.y!=k.y>n.y&&n.x<(k.x-y.x)*(n.y-y.y)/(k.y-y.y)+y.x&&(u=!u);return u||$e.prototype._containsPoint.call(this,n,!0)}});function Ss(n,u){return new ei(n,u)}var je=hn.extend({initialize:function(n,u){W(this,u),this._layers={},n&&this.addData(n)},addData:function(n){var u=q(n)?n:n.features,f,y,k;if(u){for(f=0,y=u.length;f<y;f++)k=u[f],(k.geometries||k.geometry||k.features||k.coordinates)&&this.addData(k);return this}var T=this.options;if(T.filter&&!T.filter(n))return this;var $=Ji(n,T);return $?($.feature=o(n),$.defaultOptions=$.options,this.resetStyle($),T.onEachFeature&&T.onEachFeature(n,$),this.addLayer($)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=l({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(u){this._setLayerStyle(u,n)},this)},_setLayerStyle:function(n,u){n.setStyle&&(typeof u=="function"&&(u=u(n.feature)),n.setStyle(u))}});function Ji(n,u){var f=n.type==="Feature"?n.geometry:n,y=f?f.coordinates:null,k=[],T=u&&u.pointToLayer,$=u&&u.coordsToLatLng||kn,rt,ut,mt,wt;if(!y&&!f)return null;switch(f.type){case"Point":return rt=$(y),Cs(T,n,rt,u);case"MultiPoint":for(mt=0,wt=y.length;mt<wt;mt++)rt=$(y[mt]),k.push(Cs(T,n,rt,u));return new hn(k);case"LineString":case"MultiLineString":return ut=$i(y,f.type==="LineString"?0:1,$),new $e(ut,u);case"Polygon":case"MultiPolygon":return ut=$i(y,f.type==="Polygon"?1:2,$),new ei(ut,u);case"GeometryCollection":for(mt=0,wt=f.geometries.length;mt<wt;mt++){var Tt=Ji({geometry:f.geometries[mt],type:"Feature",properties:n.properties},u);Tt&&k.push(Tt)}return new hn(k);case"FeatureCollection":for(mt=0,wt=f.features.length;mt<wt;mt++){var Ht=Ji(f.features[mt],u);Ht&&k.push(Ht)}return new hn(k);default:throw new Error("Invalid GeoJSON object.")}}function Cs(n,u,f,y){return n?n(u,f):new Wi(f,y&&y.markersInheritOptions&&y)}function kn(n){return new ft(n[1],n[0],n[2])}function $i(n,u,f){for(var y=[],k=0,T=n.length,$;k<T;k++)$=u?$i(n[k],u-1,f):(f||kn)(n[k]),y.push($);return y}function ji(n,u){return n=gt(n),n.alt!==void 0?[b(n.lng,u),b(n.lat,u),b(n.alt,u)]:[b(n.lng,u),b(n.lat,u)]}function Ee(n,u,f,y){for(var k=[],T=0,$=n.length;T<$;T++)k.push(u?Ee(n[T],Ne(n[T])?0:u-1,f,y):ji(n[T],y));return!u&&f&&k.length>0&&k.push(k[0].slice()),k}function Pe(n,u){return n.feature?l({},n.feature,{geometry:u}):o(u)}function o(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var t={toGeoJSON:function(n){return Pe(this,{type:"Point",coordinates:ji(this.getLatLng(),n)})}};Wi.include(t),Ki.include(t),wi.include(t),$e.include({toGeoJSON:function(n){var u=!Ne(this._latlngs),f=Ee(this._latlngs,u?1:0,!1,n);return Pe(this,{type:(u?"Multi":"")+"LineString",coordinates:f})}}),ei.include({toGeoJSON:function(n){var u=!Ne(this._latlngs),f=u&&!Ne(this._latlngs[0]),y=Ee(this._latlngs,f?2:u?1:0,!0,n);return u||(y=[y]),Pe(this,{type:(f?"Multi":"")+"Polygon",coordinates:y})}}),Qn.include({toMultiPoint:function(n){var u=[];return this.eachLayer(function(f){u.push(f.toGeoJSON(n).geometry.coordinates)}),Pe(this,{type:"MultiPoint",coordinates:u})},toGeoJSON:function(n){var u=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(u==="MultiPoint")return this.toMultiPoint(n);var f=u==="GeometryCollection",y=[];return this.eachLayer(function(k){if(k.toGeoJSON){var T=k.toGeoJSON(n);if(f)y.push(T.geometry);else{var $=o(T);$.type==="FeatureCollection"?y.push.apply(y,$.features):y.push($)}}}),f?Pe(this,{geometries:y,type:"GeometryCollection"}):{type:"FeatureCollection",features:y}}});function e(n,u){return new je(n,u)}var s=e,c=He.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,u,f){this._url=n,this._bounds=ht(u),W(this,f)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ot(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){te(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Wn(this._image),this},bringToBack:function(){return this._map&&Nn(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=ht(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",u=this._image=n?this._url:Zt("img");if(Ot(u,"leaflet-image-layer"),this._zoomAnimated&&Ot(u,"leaflet-zoom-animated"),this.options.className&&Ot(u,this.options.className),u.onselectstart=I,u.onmousemove=I,u.onload=m(this.fire,this,"load"),u.onerror=m(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=u.src;return}u.src=this._url,u.alt=this.options.alt},_animateZoom:function(n){var u=this._map.getZoomScale(n.zoom),f=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;On(this._image,f,u)},_reset:function(){var n=this._image,u=new ot(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),f=u.getSize();ae(n,u.min),n.style.width=f.x+"px",n.style.height=f.y+"px"},_updateOpacity:function(){ce(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),p=function(n,u,f){return new c(n,u,f)},_=c.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",u=this._image=n?this._url:Zt("video");if(Ot(u,"leaflet-image-layer"),this._zoomAnimated&&Ot(u,"leaflet-zoom-animated"),this.options.className&&Ot(u,this.options.className),u.onselectstart=I,u.onmousemove=I,u.onloadeddata=m(this.fire,this,"load"),n){for(var f=u.getElementsByTagName("source"),y=[],k=0;k<f.length;k++)y.push(f[k].src);this._url=f.length>0?y:[u.src];return}q(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(u.style,"objectFit")&&(u.style.objectFit="fill"),u.autoplay=!!this.options.autoplay,u.loop=!!this.options.loop,u.muted=!!this.options.muted,u.playsInline=!!this.options.playsInline;for(var T=0;T<this._url.length;T++){var $=Zt("source");$.src=this._url[T],u.appendChild($)}}});function w(n,u,f){return new _(n,u,f)}var C=c.extend({_initImage:function(){var n=this._image=this._url;Ot(n,"leaflet-image-layer"),this._zoomAnimated&&Ot(n,"leaflet-zoom-animated"),this.options.className&&Ot(n,this.options.className),n.onselectstart=I,n.onmousemove=I}});function z(n,u,f){return new C(n,u,f)}var tt=He.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,u){n&&(n instanceof ft||q(n))?(this._latlng=gt(n),W(this,u)):(W(this,n),this._source=u),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&ce(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&ce(this._container,1),this.bringToFront(),this.options.interactive&&(Ot(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(ce(this._container,0),this._removeTimeout=setTimeout(m(te,void 0,this._container),200)):te(this._container),this.options.interactive&&(Kt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=gt(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Wn(this._container),this},bringToBack:function(){return this._map&&Nn(this._container),this},_prepareOpen:function(n){var u=this._source;if(!u._map)return!1;if(u instanceof hn){u=null;var f=this._source._layers;for(var y in f)if(f[y]._map){u=f[y];break}if(!u)return!1;this._source=u}if(!n)if(u.getCenter)n=u.getCenter();else if(u.getLatLng)n=u.getLatLng();else if(u.getBounds)n=u.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,u=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof u=="string")n.innerHTML=u;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(u)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),u=J(this.options.offset),f=this._getAnchor();this._zoomAnimated?ae(this._container,n.add(f)):u=u.add(n).add(f);var y=this._containerBottom=-u.y,k=this._containerLeft=-Math.round(this._containerWidth/2)+u.x;this._container.style.bottom=y+"px",this._container.style.left=k+"px"}},_getAnchor:function(){return[0,0]}});Dt.include({_initOverlay:function(n,u,f,y){var k=u;return k instanceof n||(k=new n(y).setContent(u)),f&&k.setLatLng(f),k}}),He.include({_initOverlay:function(n,u,f,y){var k=f;return k instanceof n?(W(k,y),k._source=this):(k=u&&!y?u:new n(y,this),k.setContent(f)),k}});var it=tt.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,tt.prototype.openOn.call(this,n)},onAdd:function(n){tt.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof xn||this._source.on("preclick",de))},onRemove:function(n){tt.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof xn||this._source.off("preclick",de))},getEvents:function(){var n=tt.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",u=this._container=Zt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),f=this._wrapper=Zt("div",n+"-content-wrapper",u);if(this._contentNode=Zt("div",n+"-content",f),jn(u),yi(this._contentNode),Rt(u,"contextmenu",de),this._tipContainer=Zt("div",n+"-tip-container",u),this._tip=Zt("div",n+"-tip",this._tipContainer),this.options.closeButton){var y=this._closeButton=Zt("a",n+"-close-button",u);y.setAttribute("role","button"),y.setAttribute("aria-label","Close popup"),y.href="#close",y.innerHTML='<span aria-hidden="true">&#215;</span>',Rt(y,"click",function(k){ne(k),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,u=n.style;u.width="",u.whiteSpace="nowrap";var f=n.offsetWidth;f=Math.min(f,this.options.maxWidth),f=Math.max(f,this.options.minWidth),u.width=f+1+"px",u.whiteSpace="",u.height="";var y=n.offsetHeight,k=this.options.maxHeight,T="leaflet-popup-scrolled";k&&y>k?(u.height=k+"px",Ot(n,T)):Kt(n,T),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var u=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),f=this._getAnchor();ae(this._container,u.add(f))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,u=parseInt(Xe(this._container,"marginBottom"),10)||0,f=this._container.offsetHeight+u,y=this._containerWidth,k=new X(this._containerLeft,-f-this._containerBottom);k._add(pn(this._container));var T=n.layerPointToContainerPoint(k),$=J(this.options.autoPanPadding),rt=J(this.options.autoPanPaddingTopLeft||$),ut=J(this.options.autoPanPaddingBottomRight||$),mt=n.getSize(),wt=0,Tt=0;T.x+y+ut.x>mt.x&&(wt=T.x+y-mt.x+ut.x),T.x-wt-rt.x<0&&(wt=T.x-rt.x),T.y+f+ut.y>mt.y&&(Tt=T.y+f-mt.y+ut.y),T.y-Tt-rt.y<0&&(Tt=T.y-rt.y),(wt||Tt)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([wt,Tt]))}},_getAnchor:function(){return J(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),dt=function(n,u){return new it(n,u)};Dt.mergeOptions({closePopupOnClick:!0}),Dt.include({openPopup:function(n,u,f){return this._initOverlay(it,n,u,f).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),He.include({bindPopup:function(n,u){return this._popup=this._initOverlay(it,this._popup,n,u),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof hn||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){yn(n);var u=n.layer||n.target;if(this._popup._source===u&&!(u instanceof xn)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=u,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var xt=tt.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){tt.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){tt.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=tt.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",u=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Zt("div",u),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+x(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var u,f,y=this._map,k=this._container,T=y.latLngToContainerPoint(y.getCenter()),$=y.layerPointToContainerPoint(n),rt=this.options.direction,ut=k.offsetWidth,mt=k.offsetHeight,wt=J(this.options.offset),Tt=this._getAnchor();rt==="top"?(u=ut/2,f=mt):rt==="bottom"?(u=ut/2,f=0):rt==="center"?(u=ut/2,f=mt/2):rt==="right"?(u=0,f=mt/2):rt==="left"?(u=ut,f=mt/2):$.x<T.x?(rt="right",u=0,f=mt/2):(rt="left",u=ut+(wt.x+Tt.x)*2,f=mt/2),n=n.subtract(J(u,f,!0)).add(wt).add(Tt),Kt(k,"leaflet-tooltip-right"),Kt(k,"leaflet-tooltip-left"),Kt(k,"leaflet-tooltip-top"),Kt(k,"leaflet-tooltip-bottom"),Ot(k,"leaflet-tooltip-"+rt),ae(k,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&ce(this._container,n)},_animateZoom:function(n){var u=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(u)},_getAnchor:function(){return J(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Et=function(n,u){return new xt(n,u)};Dt.include({openTooltip:function(n,u,f){return this._initOverlay(xt,n,u,f).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),He.include({bindTooltip:function(n,u){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(xt,this._tooltip,n,u),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var u=n?"off":"on",f={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?f.add=this._openTooltip:(f.mouseover=this._openTooltip,f.mouseout=this.closeTooltip,f.click=this._openTooltip,this._map?this._addFocusListeners():f.add=this._addFocusListeners),this._tooltip.options.sticky&&(f.mousemove=this._moveTooltip),this[u](f),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof hn||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var u=typeof n.getElement=="function"&&n.getElement();u&&(Rt(u,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),Rt(u,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var u=typeof n.getElement=="function"&&n.getElement();u&&u.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var u=this;this._map.once("moveend",function(){u._openOnceFlag=!1,u._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var u=n.latlng,f,y;this._tooltip.options.sticky&&n.originalEvent&&(f=this._map.mouseEventToContainerPoint(n.originalEvent),y=this._map.containerPointToLayerPoint(f),u=this._map.layerPointToLatLng(y)),this._tooltip.setLatLng(u)}});var Mt=ti.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var u=n&&n.tagName==="DIV"?n:document.createElement("div"),f=this.options;if(f.html instanceof Element?(zi(u),u.appendChild(f.html)):u.innerHTML=f.html!==!1?f.html:"",f.bgPos){var y=J(f.bgPos);u.style.backgroundPosition=-y.x+"px "+-y.y+"px"}return this._setIconStyles(u,"icon"),u},createShadow:function(){return null}});function Ut(n){return new Mt(n)}ti.Default=ki;var zt=He.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Pt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){W(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),te(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Wn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Nn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=v(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof X?n:new X(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var u=this.getPane().children,f=-n(-1/0,1/0),y=0,k=u.length,T;y<k;y++)T=u[y].style.zIndex,u[y]!==this._container&&T&&(f=n(f,+T));isFinite(f)&&(this.options.zIndex=f+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Pt.ielt9){ce(this._container,this.options.opacity);var n=+new Date,u=!1,f=!1;for(var y in this._tiles){var k=this._tiles[y];if(!(!k.current||!k.loaded)){var T=Math.min(1,(n-k.loaded)/200);ce(k.el,T),T<1?u=!0:(k.active?f=!0:this._onOpaqueTile(k),k.active=!0)}}f&&!this._noPrune&&this._pruneTiles(),u&&(D(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this))}},_onOpaqueTile:I,_initContainer:function(){this._container||(this._container=Zt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,u=this.options.maxZoom;if(n!==void 0){for(var f in this._levels)f=Number(f),this._levels[f].el.children.length||f===n?(this._levels[f].el.style.zIndex=u-Math.abs(n-f),this._onUpdateLevel(f)):(te(this._levels[f].el),this._removeTilesAtZoom(f),this._onRemoveLevel(f),delete this._levels[f]);var y=this._levels[n],k=this._map;return y||(y=this._levels[n]={},y.el=Zt("div","leaflet-tile-container leaflet-zoom-animated",this._container),y.el.style.zIndex=u,y.origin=k.project(k.unproject(k.getPixelOrigin()),n).round(),y.zoom=n,this._setZoomTransform(y,k.getCenter(),k.getZoom()),I(y.el.offsetWidth),this._onCreateLevel(y)),this._level=y,y}},_onUpdateLevel:I,_onRemoveLevel:I,_onCreateLevel:I,_pruneTiles:function(){if(this._map){var n,u,f=this._map.getZoom();if(f>this.options.maxZoom||f<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)u=this._tiles[n],u.retain=u.current;for(n in this._tiles)if(u=this._tiles[n],u.current&&!u.active){var y=u.coords;this._retainParent(y.x,y.y,y.z,y.z-5)||this._retainChildren(y.x,y.y,y.z,y.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var u in this._tiles)this._tiles[u].coords.z===n&&this._removeTile(u)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)te(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,u,f,y){var k=Math.floor(n/2),T=Math.floor(u/2),$=f-1,rt=new X(+k,+T);rt.z=+$;var ut=this._tileCoordsToKey(rt),mt=this._tiles[ut];return mt&&mt.active?(mt.retain=!0,!0):(mt&&mt.loaded&&(mt.retain=!0),$>y?this._retainParent(k,T,$,y):!1)},_retainChildren:function(n,u,f,y){for(var k=2*n;k<2*n+2;k++)for(var T=2*u;T<2*u+2;T++){var $=new X(k,T);$.z=f+1;var rt=this._tileCoordsToKey($),ut=this._tiles[rt];if(ut&&ut.active){ut.retain=!0;continue}else ut&&ut.loaded&&(ut.retain=!0);f+1<y&&this._retainChildren(k,T,f+1,y)}},_resetView:function(n){var u=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),u,u)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var u=this.options;return u.minNativeZoom!==void 0&&n<u.minNativeZoom?u.minNativeZoom:u.maxNativeZoom!==void 0&&u.maxNativeZoom<n?u.maxNativeZoom:n},_setView:function(n,u,f,y){var k=Math.round(u);this.options.maxZoom!==void 0&&k>this.options.maxZoom||this.options.minZoom!==void 0&&k<this.options.minZoom?k=void 0:k=this._clampZoom(k);var T=this.options.updateWhenZooming&&k!==this._tileZoom;(!y||T)&&(this._tileZoom=k,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),k!==void 0&&this._update(n),f||this._pruneTiles(),this._noPrune=!!f),this._setZoomTransforms(n,u)},_setZoomTransforms:function(n,u){for(var f in this._levels)this._setZoomTransform(this._levels[f],n,u)},_setZoomTransform:function(n,u,f){var y=this._map.getZoomScale(f,n.zoom),k=n.origin.multiplyBy(y).subtract(this._map._getNewPixelOrigin(u,f)).round();Pt.any3d?On(n.el,k,y):ae(n.el,k)},_resetGrid:function(){var n=this._map,u=n.options.crs,f=this._tileSize=this.getTileSize(),y=this._tileZoom,k=this._map.getPixelWorldBounds(this._tileZoom);k&&(this._globalTileRange=this._pxBoundsToTileRange(k)),this._wrapX=u.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,u.wrapLng[0]],y).x/f.x),Math.ceil(n.project([0,u.wrapLng[1]],y).x/f.y)],this._wrapY=u.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([u.wrapLat[0],0],y).y/f.x),Math.ceil(n.project([u.wrapLat[1],0],y).y/f.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var u=this._map,f=u._animatingZoom?Math.max(u._animateToZoom,u.getZoom()):u.getZoom(),y=u.getZoomScale(f,this._tileZoom),k=u.project(n,this._tileZoom).floor(),T=u.getSize().divideBy(y*2);return new ot(k.subtract(T),k.add(T))},_update:function(n){var u=this._map;if(u){var f=this._clampZoom(u.getZoom());if(n===void 0&&(n=u.getCenter()),this._tileZoom!==void 0){var y=this._getTiledPixelBounds(n),k=this._pxBoundsToTileRange(y),T=k.getCenter(),$=[],rt=this.options.keepBuffer,ut=new ot(k.getBottomLeft().subtract([rt,-rt]),k.getTopRight().add([rt,-rt]));if(!(isFinite(k.min.x)&&isFinite(k.min.y)&&isFinite(k.max.x)&&isFinite(k.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var mt in this._tiles){var wt=this._tiles[mt].coords;(wt.z!==this._tileZoom||!ut.contains(new X(wt.x,wt.y)))&&(this._tiles[mt].current=!1)}if(Math.abs(f-this._tileZoom)>1){this._setView(n,f);return}for(var Tt=k.min.y;Tt<=k.max.y;Tt++)for(var Ht=k.min.x;Ht<=k.max.x;Ht++){var Oe=new X(Ht,Tt);if(Oe.z=this._tileZoom,!!this._isValidTile(Oe)){var ye=this._tiles[this._tileCoordsToKey(Oe)];ye?ye.current=!0:$.push(Oe)}}if($.sort(function(Fe,tr){return Fe.distanceTo(T)-tr.distanceTo(T)}),$.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var tn=document.createDocumentFragment();for(Ht=0;Ht<$.length;Ht++)this._addTile($[Ht],tn);this._level.el.appendChild(tn)}}}},_isValidTile:function(n){var u=this._map.options.crs;if(!u.infinite){var f=this._globalTileRange;if(!u.wrapLng&&(n.x<f.min.x||n.x>f.max.x)||!u.wrapLat&&(n.y<f.min.y||n.y>f.max.y))return!1}if(!this.options.bounds)return!0;var y=this._tileCoordsToBounds(n);return ht(this.options.bounds).overlaps(y)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var u=this._map,f=this.getTileSize(),y=n.scaleBy(f),k=y.add(f),T=u.unproject(y,n.z),$=u.unproject(k,n.z);return[T,$]},_tileCoordsToBounds:function(n){var u=this._tileCoordsToNwSe(n),f=new pt(u[0],u[1]);return this.options.noWrap||(f=this._map.wrapLatLngBounds(f)),f},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var u=n.split(":"),f=new X(+u[0],+u[1]);return f.z=+u[2],f},_removeTile:function(n){var u=this._tiles[n];u&&(te(u.el),delete this._tiles[n],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){Ot(n,"leaflet-tile");var u=this.getTileSize();n.style.width=u.x+"px",n.style.height=u.y+"px",n.onselectstart=I,n.onmousemove=I,Pt.ielt9&&this.options.opacity<1&&ce(n,this.options.opacity)},_addTile:function(n,u){var f=this._getTilePos(n),y=this._tileCoordsToKey(n),k=this.createTile(this._wrapCoords(n),m(this._tileReady,this,n));this._initTile(k),this.createTile.length<2&&B(m(this._tileReady,this,n,null,k)),ae(k,f),this._tiles[y]={el:k,coords:n,current:!0},u.appendChild(k),this.fire("tileloadstart",{tile:k,coords:n})},_tileReady:function(n,u,f){u&&this.fire("tileerror",{error:u,tile:f,coords:n});var y=this._tileCoordsToKey(n);f=this._tiles[y],f&&(f.loaded=+new Date,this._map._fadeAnimated?(ce(f.el,0),D(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this)):(f.active=!0,this._pruneTiles()),u||(Ot(f.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:f.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Pt.ielt9||!this._map._fadeAnimated?B(this._pruneTiles,this):setTimeout(m(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var u=new X(this._wrapX?P(n.x,this._wrapX):n.x,this._wrapY?P(n.y,this._wrapY):n.y);return u.z=n.z,u},_pxBoundsToTileRange:function(n){var u=this.getTileSize();return new ot(n.min.unscaleBy(u).floor(),n.max.unscaleBy(u).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function jt(n){return new zt(n)}var ee=zt.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,u){this._url=n,u=W(this,u),u.detectRetina&&Pt.retina&&u.maxZoom>0?(u.tileSize=Math.floor(u.tileSize/2),u.zoomReverse?(u.zoomOffset--,u.minZoom=Math.min(u.maxZoom,u.minZoom+1)):(u.zoomOffset++,u.maxZoom=Math.max(u.minZoom,u.maxZoom-1)),u.minZoom=Math.max(0,u.minZoom)):u.zoomReverse?u.minZoom=Math.min(u.maxZoom,u.minZoom):u.maxZoom=Math.max(u.minZoom,u.maxZoom),typeof u.subdomains=="string"&&(u.subdomains=u.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,u){return this._url===n&&u===void 0&&(u=!0),this._url=n,u||this.redraw(),this},createTile:function(n,u){var f=document.createElement("img");return Rt(f,"load",m(this._tileOnLoad,this,u,f)),Rt(f,"error",m(this._tileOnError,this,u,f)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(f.referrerPolicy=this.options.referrerPolicy),f.alt="",f.src=this.getTileUrl(n),f},getTileUrl:function(n){var u={r:Pt.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var f=this._globalTileRange.max.y-n.y;this.options.tms&&(u.y=f),u["-y"]=f}return M(this._url,l(u,this.options))},_tileOnLoad:function(n,u){Pt.ielt9?setTimeout(m(n,this,null,u),0):n(null,u)},_tileOnError:function(n,u,f){var y=this.options.errorTileUrl;y&&u.getAttribute("src")!==y&&(u.src=y),n(f,u)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,u=this.options.maxZoom,f=this.options.zoomReverse,y=this.options.zoomOffset;return f&&(n=u-n),n+y},_getSubdomain:function(n){var u=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[u]},_abortLoading:function(){var n,u;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(u=this._tiles[n].el,u.onload=I,u.onerror=I,!u.complete)){u.src=F;var f=this._tiles[n].coords;te(u),delete this._tiles[n],this.fire("tileabort",{tile:u,coords:f})}},_removeTile:function(n){var u=this._tiles[n];if(u)return u.el.setAttribute("src",F),zt.prototype._removeTile.call(this,n)},_tileReady:function(n,u,f){if(!(!this._map||f&&f.getAttribute("src")===F))return zt.prototype._tileReady.call(this,n,u,f)}});function fe(n,u){return new ee(n,u)}var wn=ee.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,u){this._url=n;var f=l({},this.defaultWmsParams);for(var y in u)y in this.options||(f[y]=u[y]);u=W(this,u);var k=u.detectRetina&&Pt.retina?2:1,T=this.getTileSize();f.width=T.x*k,f.height=T.y*k,this.wmsParams=f},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var u=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[u]=this._crs.code,ee.prototype.onAdd.call(this,n)},getTileUrl:function(n){var u=this._tileCoordsToNwSe(n),f=this._crs,y=ct(f.project(u[0]),f.project(u[1])),k=y.min,T=y.max,$=(this._wmsVersion>=1.3&&this._crs===Es?[k.y,k.x,T.y,T.x]:[k.x,k.y,T.x,T.y]).join(","),rt=ee.prototype.getTileUrl.call(this,n);return rt+j(this.wmsParams,rt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+$},setParams:function(n,u){return l(this.wmsParams,n),u||this.redraw(),this}});function Ei(n,u){return new wn(n,u)}ee.WMS=wn,fe.wms=Ei;var Qe=He.extend({options:{padding:.1},initialize:function(n){W(this,n),x(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ot(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,u){var f=this._map.getZoomScale(u,this._zoom),y=this._map.getSize().multiplyBy(.5+this.options.padding),k=this._map.project(this._center,u),T=y.multiplyBy(-f).add(k).subtract(this._map._getNewPixelOrigin(n,u));Pt.any3d?On(this._container,T,f):ae(this._container,T)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,u=this._map.getSize(),f=this._map.containerPointToLayerPoint(u.multiplyBy(-n)).round();this._bounds=new ot(f,f.add(u.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ur=Qe.extend({options:{tolerance:0},getEvents:function(){var n=Qe.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Qe.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");Rt(n,"mousemove",this._onMouseMove,this),Rt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Rt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){D(this._redrawRequest),delete this._ctx,te(this._container),$t(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var u in this._layers)n=this._layers[u],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Qe.prototype._update.call(this);var n=this._bounds,u=this._container,f=n.getSize(),y=Pt.retina?2:1;ae(u,n.min),u.width=y*f.x,u.height=y*f.y,u.style.width=f.x+"px",u.style.height=f.y+"px",Pt.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){Qe.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[x(n)]=n;var u=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=u),this._drawLast=u,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var u=n._order,f=u.next,y=u.prev;f?f.prev=y:this._drawLast=y,y?y.next=f:this._drawFirst=f,delete n._order,delete this._layers[x(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var u=n.options.dashArray.split(/[, ]+/),f=[],y,k;for(k=0;k<u.length;k++){if(y=Number(u[k]),isNaN(y))return;f.push(y)}n.options._dashArray=f}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||B(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var u=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ot,this._redrawBounds.extend(n._pxBounds.min.subtract([u,u])),this._redrawBounds.extend(n._pxBounds.max.add([u,u]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var u=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,u.x,u.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,u=this._redrawBounds;if(this._ctx.save(),u){var f=u.getSize();this._ctx.beginPath(),this._ctx.rect(u.min.x,u.min.y,f.x,f.y),this._ctx.clip()}this._drawing=!0;for(var y=this._drawFirst;y;y=y.next)n=y.layer,(!u||n._pxBounds&&n._pxBounds.intersects(u))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,u){if(this._drawing){var f,y,k,T,$=n._parts,rt=$.length,ut=this._ctx;if(rt){for(ut.beginPath(),f=0;f<rt;f++){for(y=0,k=$[f].length;y<k;y++)T=$[f][y],ut[y?"lineTo":"moveTo"](T.x,T.y);u&&ut.closePath()}this._fillStroke(ut,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var u=n._point,f=this._ctx,y=Math.max(Math.round(n._radius),1),k=(Math.max(Math.round(n._radiusY),1)||y)/y;k!==1&&(f.save(),f.scale(1,k)),f.beginPath(),f.arc(u.x,u.y/k,y,0,Math.PI*2,!1),k!==1&&f.restore(),this._fillStroke(f,n)}},_fillStroke:function(n,u){var f=u.options;f.fill&&(n.globalAlpha=f.fillOpacity,n.fillStyle=f.fillColor||f.color,n.fill(f.fillRule||"evenodd")),f.stroke&&f.weight!==0&&(n.setLineDash&&n.setLineDash(u.options&&u.options._dashArray||[]),n.globalAlpha=f.opacity,n.lineWidth=f.weight,n.strokeStyle=f.color,n.lineCap=f.lineCap,n.lineJoin=f.lineJoin,n.stroke())},_onClick:function(n){for(var u=this._map.mouseEventToLayerPoint(n),f,y,k=this._drawFirst;k;k=k.next)f=k.layer,f.options.interactive&&f._containsPoint(u)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(f))&&(y=f);this._fireEvent(y?[y]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var u=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,u)}},_handleMouseOut:function(n){var u=this._hoveredLayer;u&&(Kt(this._container,"leaflet-interactive"),this._fireEvent([u],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,u){if(!this._mouseHoverThrottled){for(var f,y,k=this._drawFirst;k;k=k.next)f=k.layer,f.options.interactive&&f._containsPoint(u)&&(y=f);y!==this._hoveredLayer&&(this._handleMouseOut(n),y&&(Ot(this._container,"leaflet-interactive"),this._fireEvent([y],n,"mouseover"),this._hoveredLayer=y)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(m(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,u,f){this._map._fireDOMEvent(u,f||u.type,n)},_bringToFront:function(n){var u=n._order;if(u){var f=u.next,y=u.prev;if(f)f.prev=y;else return;y?y.next=f:f&&(this._drawFirst=f),u.prev=this._drawLast,this._drawLast.next=u,u.next=null,this._drawLast=u,this._requestRedraw(n)}},_bringToBack:function(n){var u=n._order;if(u){var f=u.next,y=u.prev;if(y)y.next=f;else return;f?f.prev=y:y&&(this._drawLast=y),u.prev=null,u.next=this._drawFirst,this._drawFirst.prev=u,this._drawFirst=u,this._requestRedraw(n)}}});function Yr(n){return Pt.canvas?new Ur(n):null}var ni=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),bs={_initContainer:function(){this._container=Zt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Qe.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var u=n._container=ni("shape");Ot(u,"leaflet-vml-shape "+(this.options.className||"")),u.coordsize="1 1",n._path=ni("path"),u.appendChild(n._path),this._updateStyle(n),this._layers[x(n)]=n},_addPath:function(n){var u=n._container;this._container.appendChild(u),n.options.interactive&&n.addInteractiveTarget(u)},_removePath:function(n){var u=n._container;te(u),n.removeInteractiveTarget(u),delete this._layers[x(n)]},_updateStyle:function(n){var u=n._stroke,f=n._fill,y=n.options,k=n._container;k.stroked=!!y.stroke,k.filled=!!y.fill,y.stroke?(u||(u=n._stroke=ni("stroke")),k.appendChild(u),u.weight=y.weight+"px",u.color=y.color,u.opacity=y.opacity,y.dashArray?u.dashStyle=q(y.dashArray)?y.dashArray.join(" "):y.dashArray.replace(/( *, *)/g," "):u.dashStyle="",u.endcap=y.lineCap.replace("butt","flat"),u.joinstyle=y.lineJoin):u&&(k.removeChild(u),n._stroke=null),y.fill?(f||(f=n._fill=ni("fill")),k.appendChild(f),f.color=y.fillColor||y.color,f.opacity=y.fillOpacity):f&&(k.removeChild(f),n._fill=null)},_updateCircle:function(n){var u=n._point.round(),f=Math.round(n._radius),y=Math.round(n._radiusY||f);this._setPath(n,n._empty()?"M0 0":"AL "+u.x+","+u.y+" "+f+","+y+" 0,"+65535*360)},_setPath:function(n,u){n._path.v=u},_bringToFront:function(n){Wn(n._container)},_bringToBack:function(n){Nn(n._container)}},Pi=Pt.vml?ni:Lt,Dn=Qe.extend({_initContainer:function(){this._container=Pi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Pi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){te(this._container),$t(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Qe.prototype._update.call(this);var n=this._bounds,u=n.getSize(),f=this._container;(!this._svgSize||!this._svgSize.equals(u))&&(this._svgSize=u,f.setAttribute("width",u.x),f.setAttribute("height",u.y)),ae(f,n.min),f.setAttribute("viewBox",[n.min.x,n.min.y,u.x,u.y].join(" ")),this.fire("update")}},_initPath:function(n){var u=n._path=Pi("path");n.options.className&&Ot(u,n.options.className),n.options.interactive&&Ot(u,"leaflet-interactive"),this._updateStyle(n),this._layers[x(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){te(n._path),n.removeInteractiveTarget(n._path),delete this._layers[x(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var u=n._path,f=n.options;u&&(f.stroke?(u.setAttribute("stroke",f.color),u.setAttribute("stroke-opacity",f.opacity),u.setAttribute("stroke-width",f.weight),u.setAttribute("stroke-linecap",f.lineCap),u.setAttribute("stroke-linejoin",f.lineJoin),f.dashArray?u.setAttribute("stroke-dasharray",f.dashArray):u.removeAttribute("stroke-dasharray"),f.dashOffset?u.setAttribute("stroke-dashoffset",f.dashOffset):u.removeAttribute("stroke-dashoffset")):u.setAttribute("stroke","none"),f.fill?(u.setAttribute("fill",f.fillColor||f.color),u.setAttribute("fill-opacity",f.fillOpacity),u.setAttribute("fill-rule",f.fillRule||"evenodd")):u.setAttribute("fill","none"))},_updatePoly:function(n,u){this._setPath(n,xe(n._parts,u))},_updateCircle:function(n){var u=n._point,f=Math.max(Math.round(n._radius),1),y=Math.max(Math.round(n._radiusY),1)||f,k="a"+f+","+y+" 0 1,0 ",T=n._empty()?"M0 0":"M"+(u.x-f)+","+u.y+k+f*2+",0 "+k+-f*2+",0 ";this._setPath(n,T)},_setPath:function(n,u){n._path.setAttribute("d",u)},_bringToFront:function(n){Wn(n._path)},_bringToBack:function(n){Nn(n._path)}});Pt.vml&&Dn.include(bs);function Qi(n){return Pt.svg||Pt.vml?new Dn(n):null}Dt.include({getRenderer:function(n){var u=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return u||(u=this._renderer=this._createRenderer()),this.hasLayer(u)||this.addLayer(u),u},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var u=this._paneRenderers[n];return u===void 0&&(u=this._createRenderer({pane:n}),this._paneRenderers[n]=u),u},_createRenderer:function(n){return this.options.preferCanvas&&Yr(n)||Qi(n)}});var la=ei.extend({initialize:function(n,u){ei.prototype.initialize.call(this,this._boundsToLatLngs(n),u)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=ht(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function pl(n,u){return new la(n,u)}Dn.create=Pi,Dn.pointsToPath=xe,je.geometryToLayer=Ji,je.coordsToLatLng=kn,je.coordsToLatLngs=$i,je.latLngToCoords=ji,je.latLngsToCoords=Ee,je.getFeature=Pe,je.asFeature=o,Dt.mergeOptions({boxZoom:!0});var ha=Je.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){Rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){$t(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){te(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),an(),Lr(),this._startPoint=this._map.mouseEventToContainerPoint(n),Rt(document,{contextmenu:yn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=Zt("div","leaflet-zoom-box",this._container),Ot(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var u=new ot(this._point,this._startPoint),f=u.getSize();ae(this._box,u.min),this._box.style.width=f.x+"px",this._box.style.height=f.y+"px"},_finish:function(){this._moved&&(te(this._box),Kt(this._container,"leaflet-crosshair")),Kn(),mi(),$t(document,{contextmenu:yn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(m(this._resetState,this),0);var u=new pt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(u).fire("boxzoomend",{boxZoomBounds:u})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Dt.addInitHook("addHandler","boxZoom",ha),Dt.mergeOptions({doubleClickZoom:!0});var ca=Je.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var u=this._map,f=u.getZoom(),y=u.options.zoomDelta,k=n.originalEvent.shiftKey?f-y:f+y;u.options.doubleClickZoom==="center"?u.setZoom(k):u.setZoomAround(n.containerPoint,k)}});Dt.addInitHook("addHandler","doubleClickZoom",ca),Dt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var fa=Je.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new _n(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}Ot(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Kt(this._map._container,"leaflet-grab"),Kt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var u=ht(this._map.options.maxBounds);this._offsetLimit=ct(this._map.latLngToContainerPoint(u.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(u.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var u=this._lastTime=+new Date,f=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(f),this._times.push(u),this._prunePositions(u)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),u=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=u.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,u){return n-(n-u)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),u=this._offsetLimit;n.x<u.min.x&&(n.x=this._viscousLimit(n.x,u.min.x)),n.y<u.min.y&&(n.y=this._viscousLimit(n.y,u.min.y)),n.x>u.max.x&&(n.x=this._viscousLimit(n.x,u.max.x)),n.y>u.max.y&&(n.y=this._viscousLimit(n.y,u.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,u=Math.round(n/2),f=this._initialWorldOffset,y=this._draggable._newPos.x,k=(y-u+f)%n+u-f,T=(y+u+f)%n-u-f,$=Math.abs(k+f)<Math.abs(T+f)?k:T;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=$},_onDragEnd:function(n){var u=this._map,f=u.options,y=!f.inertia||n.noInertia||this._times.length<2;if(u.fire("dragend",n),y)u.fire("moveend");else{this._prunePositions(+new Date);var k=this._lastPos.subtract(this._positions[0]),T=(this._lastTime-this._times[0])/1e3,$=f.easeLinearity,rt=k.multiplyBy($/T),ut=rt.distanceTo([0,0]),mt=Math.min(f.inertiaMaxSpeed,ut),wt=rt.multiplyBy(mt/ut),Tt=mt/(f.inertiaDeceleration*$),Ht=wt.multiplyBy(-Tt/2).round();!Ht.x&&!Ht.y?u.fire("moveend"):(Ht=u._limitOffset(Ht,u.options.maxBounds),B(function(){u.panBy(Ht,{duration:Tt,easeLinearity:$,noMoveStart:!0,animate:!0})}))}}});Dt.addInitHook("addHandler","dragging",fa),Dt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ga=Je.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),Rt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),$t(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,u=document.documentElement,f=n.scrollTop||u.scrollTop,y=n.scrollLeft||u.scrollLeft;this._map._container.focus(),window.scrollTo(y,f)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var u=this._panKeys={},f=this.keyCodes,y,k;for(y=0,k=f.left.length;y<k;y++)u[f.left[y]]=[-1*n,0];for(y=0,k=f.right.length;y<k;y++)u[f.right[y]]=[n,0];for(y=0,k=f.down.length;y<k;y++)u[f.down[y]]=[0,n];for(y=0,k=f.up.length;y<k;y++)u[f.up[y]]=[0,-1*n]},_setZoomDelta:function(n){var u=this._zoomKeys={},f=this.keyCodes,y,k;for(y=0,k=f.zoomIn.length;y<k;y++)u[f.zoomIn[y]]=n;for(y=0,k=f.zoomOut.length;y<k;y++)u[f.zoomOut[y]]=-n},_addHooks:function(){Rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){$t(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var u=n.keyCode,f=this._map,y;if(u in this._panKeys){if(!f._panAnim||!f._panAnim._inProgress)if(y=this._panKeys[u],n.shiftKey&&(y=J(y).multiplyBy(3)),f.options.maxBounds&&(y=f._limitOffset(J(y),f.options.maxBounds)),f.options.worldCopyJump){var k=f.wrapLatLng(f.unproject(f.project(f.getCenter()).add(y)));f.panTo(k)}else f.panBy(y)}else if(u in this._zoomKeys)f.setZoom(f.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[u]);else if(u===27&&f._popup&&f._popup.options.closeOnEscapeKey)f.closePopup();else return;yn(n)}}});Dt.addInitHook("addHandler","keyboard",ga),Dt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var da=Je.extend({addHooks:function(){Rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){$t(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var u=Nr(n),f=this._map.options.wheelDebounceTime;this._delta+=u,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var y=Math.max(f-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(m(this._performZoom,this),y),yn(n)},_performZoom:function(){var n=this._map,u=n.getZoom(),f=this._map.options.zoomSnap||0;n._stop();var y=this._delta/(this._map.options.wheelPxPerZoomLevel*4),k=4*Math.log(2/(1+Math.exp(-Math.abs(y))))/Math.LN2,T=f?Math.ceil(k/f)*f:k,$=n._limitZoom(u+(this._delta>0?T:-T))-u;this._delta=0,this._startTime=null,$&&(n.options.scrollWheelZoom==="center"?n.setZoom(u+$):n.setZoomAround(this._lastMousePos,u+$))}});Dt.addInitHook("addHandler","scrollWheelZoom",da);var yl=600;Dt.mergeOptions({tapHold:Pt.touchNative&&Pt.safari&&Pt.mobile,tapTolerance:15});var ma=Je.extend({addHooks:function(){Rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){$t(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var u=n.touches[0];this._startPos=this._newPos=new X(u.clientX,u.clientY),this._holdTimeout=setTimeout(m(function(){this._cancel(),this._isTapValid()&&(Rt(document,"touchend",ne),Rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",u))},this),yl),Rt(document,"touchend touchcancel contextmenu",this._cancel,this),Rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){$t(document,"touchend",ne),$t(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),$t(document,"touchend touchcancel contextmenu",this._cancel,this),$t(document,"touchmove",this._onMove,this)},_onMove:function(n){var u=n.touches[0];this._newPos=new X(u.clientX,u.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,u){var f=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:u.screenX,screenY:u.screenY,clientX:u.clientX,clientY:u.clientY});f._simulated=!0,u.target.dispatchEvent(f)}});Dt.addInitHook("addHandler","tapHold",ma),Dt.mergeOptions({touchZoom:Pt.touch,bounceAtZoomLimits:!0});var pa=Je.extend({addHooks:function(){Ot(this._map._container,"leaflet-touch-zoom"),Rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Kt(this._map._container,"leaflet-touch-zoom"),$t(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var u=this._map;if(!(!n.touches||n.touches.length!==2||u._animatingZoom||this._zooming)){var f=u.mouseEventToContainerPoint(n.touches[0]),y=u.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=u.getSize()._divideBy(2),this._startLatLng=u.containerPointToLatLng(this._centerPoint),u.options.touchZoom!=="center"&&(this._pinchStartLatLng=u.containerPointToLatLng(f.add(y)._divideBy(2))),this._startDist=f.distanceTo(y),this._startZoom=u.getZoom(),this._moved=!1,this._zooming=!0,u._stop(),Rt(document,"touchmove",this._onTouchMove,this),Rt(document,"touchend touchcancel",this._onTouchEnd,this),ne(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var u=this._map,f=u.mouseEventToContainerPoint(n.touches[0]),y=u.mouseEventToContainerPoint(n.touches[1]),k=f.distanceTo(y)/this._startDist;if(this._zoom=u.getScaleZoom(k,this._startZoom),!u.options.bounceAtZoomLimits&&(this._zoom<u.getMinZoom()&&k<1||this._zoom>u.getMaxZoom()&&k>1)&&(this._zoom=u._limitZoom(this._zoom)),u.options.touchZoom==="center"){if(this._center=this._startLatLng,k===1)return}else{var T=f._add(y)._divideBy(2)._subtract(this._centerPoint);if(k===1&&T.x===0&&T.y===0)return;this._center=u.unproject(u.project(this._pinchStartLatLng,this._zoom).subtract(T),this._zoom)}this._moved||(u._moveStart(!0,!1),this._moved=!0),D(this._animRequest);var $=m(u._move,u,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=B($,this,!0),ne(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,D(this._animRequest),$t(document,"touchmove",this._onTouchMove,this),$t(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Dt.addInitHook("addHandler","touchZoom",pa),Dt.BoxZoom=ha,Dt.DoubleClickZoom=ca,Dt.Drag=fa,Dt.Keyboard=ga,Dt.ScrollWheelZoom=da,Dt.TapHold=ma,Dt.TouchZoom=pa,r.Bounds=ot,r.Browser=Pt,r.CRS=kt,r.Canvas=Ur,r.Circle=Ki,r.CircleMarker=wi,r.Class=Z,r.Control=Ge,r.DivIcon=Mt,r.DivOverlay=tt,r.DomEvent=_o,r.DomUtil=qi,r.Draggable=_n,r.Evented=Q,r.FeatureGroup=hn,r.GeoJSON=je,r.GridLayer=zt,r.Handler=Je,r.Icon=ti,r.ImageOverlay=c,r.LatLng=ft,r.LatLngBounds=pt,r.Layer=He,r.LayerGroup=Qn,r.LineUtil=Gr,r.Map=Dt,r.Marker=Wi,r.Mixin=Eo,r.Path=xn,r.Point=X,r.PolyUtil=Te,r.Polygon=ei,r.Polyline=$e,r.Popup=it,r.PosAnimation=Or,r.Projection=Mo,r.Rectangle=la,r.Renderer=Qe,r.SVG=Dn,r.SVGOverlay=C,r.TileLayer=ee,r.Tooltip=xt,r.Transformation=vt,r.Util=V,r.VideoOverlay=_,r.bind=m,r.bounds=ct,r.canvas=Yr,r.circle=bo,r.circleMarker=Ls,r.control=pe,r.divIcon=Ut,r.extend=l,r.featureGroup=Ms,r.geoJSON=e,r.geoJson=s,r.gridLayer=jt,r.icon=So,r.imageOverlay=p,r.latLng=gt,r.latLngBounds=ht,r.layerGroup=Ps,r.map=Yi,r.marker=Co,r.point=J,r.polygon=Ss,r.polyline=Zr,r.popup=dt,r.rectangle=pl,r.setOptions=W,r.stamp=x,r.svg=Qi,r.svgOverlay=z,r.tileLayer=fe,r.tooltip=Et,r.transformation=Y,r.version=a,r.videoOverlay=w;var vl=window.L;r.noConflict=function(){return window.L=vl,this},window.L=r})}($r,$r.exports)),$r.exports}var lt=Sl(),Cl=Object.defineProperty,bl=(h,i,r)=>i in h?Cl(h,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[i]=r,at=(h,i,r)=>bl(h,typeof i!="symbol"?i+"":i,r),ka,wa;const Tl=!0,Nl=!1,Ol={draw:!0,subtract:!0,deleteAll:!0,p2p:!0,attachElbow:!0,dragElbow:!0,dragPolygons:!0,edgeDeletion:!0},Al={opacity:.7,dragCursor:"move",hoverCursor:"grab",markerBehavior:"hide",markerAnimationDuration:200,modifierSubtract:{keys:{windows:"ctrlKey",mac:"metaKey",linux:"ctrlKey"},hideMarkersOnDrag:!0}},Rl={keys:{windows:"ctrlKey",mac:"metaKey",linux:"ctrlKey"},minVertices:3},Dl={deleteMarker:!0,infoMarker:!0,menuMarker:!0,coordsTitle:!0,zIndexOffset:0,markerIcon:{styleClasses:["polygon-marker"],zIndexOffset:null},holeIcon:{styleClasses:["polygon-marker","hole"],zIndexOffset:null},markerInfoIcon:{position:3,showArea:!0,showPerimeter:!0,useMetrics:!0,usePerimeterMinValue:!1,areaLabel:"Area",perimeterLabel:"Perimeter",values:{min:{metric:"50",imperial:"100"},unknown:{metric:"-",imperial:"-"}},units:{unknownUnit:"",metric:{onlyMetrics:!0,perimeter:{m:"m",km:"km"},area:{m2:"m²",km2:"km²",daa:"daa",ha:"ha"}},imperial:{perimeter:{feet:"ft",yards:"yd",miles:"mi"},area:{feet2:"ft²",yards2:"yd²",acres:"ac",miles2:"mi²"}}},styleClasses:["polygon-marker","info"],zIndexOffset:1e4},markerMenuIcon:{position:7,styleClasses:["polygon-marker","menu"],zIndexOffset:1e4},markerDeleteIcon:{position:5,styleClasses:["polygon-marker","delete"],zIndexOffset:1e4},holeMarkers:{menuMarker:!1,deleteMarker:!0,infoMarker:!1},visualOptimization:{sharpAngleThreshold:30,thresholdBoundingBox:.05,thresholdDistance:.05,useDistance:!0,useBoundingBox:!1,useAngles:!1}},Fl={opacity:1,smoothFactor:0,noClip:!0,clickable:!1,weight:2},Bl={opacity:1,smoothFactor:0,noClip:!0,clickable:!1,weight:2},zl={smoothFactor:.3,noClip:!0},Gl={weight:2,opacity:1,fillOpacity:.5},Hl={method:"concaveman",simplification:{mode:"simple",tolerance:1e-5,highQuality:!1}},ql={simplifyTolerance:{tolerance:1e-4,highQuality:!1,mutate:!1},dynamicMode:{fractionGuard:.9,multiplier:2}},Zl={simplify:{processHoles:!0},doubleElbows:{processHoles:!0},bbox:{processHoles:!0}},Ul={addMidPointMarkers:!0},Yl={resolution:1e4,sharpness:.75},Xl={dragPolygons:{subtract:"#D9460F"},p2p:{closingMarker:"#4CAF50"},edgeHover:"#7a9441",edgeDeletion:{hover:"#D9460F"},polyline:"#50622b",subtractLine:"#D9460F",polygon:{border:"#50622b",fill:"#b4cd8a"},hole:{border:"#aa0000",fill:"#ffcccc"},styles:{controlButton:{backgroundColor:"#fff",color:"#000"},controlButtonHover:{backgroundColor:"#f4f4f4"},controlButtonActive:{backgroundColor:"rgb(128, 218, 255)",color:"#fff"},indicatorActive:{backgroundColor:"#ffcc00"},p2pMarker:{backgroundColor:"#fff",borderColor:"#50622b"}}},Li={mergePolygons:Tl,kinks:Nl,modes:Ol,dragPolygons:Al,edgeDeletion:Rl,markers:Dl,polyLineOptions:Fl,subtractLineOptions:Bl,polygonOptions:zl,holeOptions:Gl,polygonCreation:Hl,simplification:ql,menuOperations:Zl,boundingBox:Ul,bezier:Yl,colors:Xl};var Ft=(h=>(h[h.Off=0]="Off",h[h.Add=1]="Add",h[h.Edit=2]="Edit",h[h.Subtract=4]="Subtract",h[h.AppendMarker=8]="AppendMarker",h[h.LoadPredefined=16]="LoadPredefined",h[h.PointToPoint=32]="PointToPoint",h))(Ft||{}),nn=(h=>(h[h.SouthWest=0]="SouthWest",h[h.South=1]="South",h[h.SouthEast=2]="SouthEast",h[h.East=3]="East",h[h.NorthEast=4]="NorthEast",h[h.North=5]="North",h[h.NorthWest=6]="NorthWest",h[h.West=7]="West",h[h.Hole=8]="Hole",h))(nn||{});const Vs={MEAN_METERS:6371e3,MEAN_KILOMETERS:6371,MEAN_MILES:3959},ar={DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI};function Me(h,i={}){return{type:"Feature",geometry:{type:"Point",coordinates:h},properties:i}}function No(h,i={}){return{type:"Feature",geometry:{type:"LineString",coordinates:h},properties:i}}function fn(h,i={}){return{type:"Feature",geometry:{type:"Polygon",coordinates:h},properties:i}}function er(h,i={}){return{type:"Feature",geometry:{type:"MultiPolygon",coordinates:h},properties:i}}function nr(h){return{type:"FeatureCollection",features:h}}function Ii(h){if(h.geometry.type==="Polygon")return[h.geometry.coordinates];if(h.geometry.type==="MultiPolygon")return h.geometry.coordinates;throw new Error("Feature must be a Polygon or MultiPolygon")}function Vl(h){let i=1/0,r=1/0,a=-1/0,l=-1/0;const g=m=>{if(Array.isArray(m[0]))m.forEach(g);else{const[d,x]=m;i=Math.min(i,d),r=Math.min(r,x),a=Math.max(a,d),l=Math.max(l,x)}};return g(h.geometry.coordinates),[i,r,a,l]}function Wl(h){const[i,r,a,l]=h;return fn([[[i,r],[a,r],[a,l],[i,l],[i,r]]])}function Ea(h,i,r="kilometers"){const a=Array.isArray(h)?h:h.geometry.coordinates,l=Array.isArray(i)?i:i.geometry.coordinates,[g,m]=a,[d,x]=l,v=r==="miles"?Vs.MEAN_MILES:r==="meters"?Vs.MEAN_METERS:Vs.MEAN_KILOMETERS,P=Ns(x-m),I=Ns(d-g),b=Math.sin(P/2)*Math.sin(P/2)+Math.cos(Ns(m))*Math.cos(Ns(x))*Math.sin(I/2)*Math.sin(I/2),O=2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b));return v*O}function Pa(h,i){const r=Array.isArray(h)?h:h.geometry.coordinates,a=Array.isArray(i)?i:i.geometry.coordinates,[l,g]=r,[m,d]=a,x=(l+m)/2,v=(g+d)/2;return Me([x,v])}function Oo(h){const i=Ii(h);let r=0;for(const a of i)for(let l=0;l<a.length;l++){const g=a[l],m=Jl(g);r+=l===0?Math.abs(m):-Math.abs(m)}return Math.abs(r)}function Kl(h){const i=Ii(h);let r=0,a=0,l=0;for(const g of i)for(const m of g)for(const d of m)r+=d[0],a+=d[1],l++;return Me([r/l,a/l])}function Ns(h){return h*ar.DEG_TO_RAD}function Jl(h){let i=0;const r=h.length;for(let a=0;a<r-1;a++){const[l,g]=h[a],[m,d]=h[a+1];i+=l*d-m*g}return Math.abs(i)*.5*Math.pow(Vs.MEAN_METERS*ar.DEG_TO_RAD,2)}var Se=63710088e-1,Iu={centimeters:Se*100,centimetres:Se*100,degrees:360/(2*Math.PI),feet:Se*3.28084,inches:Se*39.37,kilometers:Se/1e3,kilometres:Se/1e3,meters:Se,metres:Se,miles:Se/1609.344,millimeters:Se*1e3,millimetres:Se*1e3,nauticalmiles:Se/1852,radians:1,yards:Se*1.0936};function gn(h,i,r={}){const a={type:"Feature"};return(r.id===0||r.id)&&(a.id=r.id),r.bbox&&(a.bbox=r.bbox),a.properties=i||{},a.geometry=h,a}function zn(h,i,r={}){if(!h)throw new Error("coordinates is required");if(!Array.isArray(h))throw new Error("coordinates must be an Array");if(h.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ma(h[0])||!Ma(h[1]))throw new Error("coordinates must contain numbers");return gn({type:"Point",coordinates:h},i,r)}function Zn(h,i,r={}){for(const l of h){if(l.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(l[l.length-1].length!==l[0].length)throw new Error("First and last Position are not equivalent.");for(let g=0;g<l[l.length-1].length;g++)if(l[l.length-1][g]!==l[0][g])throw new Error("First and last Position are not equivalent.")}return gn({type:"Polygon",coordinates:h},i,r)}function co(h,i,r={}){if(h.length<2)throw new Error("coordinates must be an array of two or more positions");return gn({type:"LineString",coordinates:h},i,r)}function In(h,i={}){const r={type:"FeatureCollection"};return i.id&&(r.id=i.id),i.bbox&&(r.bbox=i.bbox),r.features=h,r}function $l(h,i,r={}){return gn({type:"MultiLineString",coordinates:h},i,r)}function fo(h,i,r={}){return gn({type:"MultiPolygon",coordinates:h},i,r)}function Lu(h,i="kilometers"){const r=Iu[i];if(!r)throw new Error(i+" units is invalid");return h*r}function jl(h,i="kilometers"){const r=Iu[i];if(!r)throw new Error(i+" units is invalid");return h/r}function Os(h){return h%360*Math.PI/180}function Ma(h){return!isNaN(h)&&h!==null&&!Array.isArray(h)}function Ql(h){return h!==null&&typeof h=="object"&&!Array.isArray(h)}function Gn(h,i,r){if(h!==null)for(var a,l,g,m,d,x,v,P=0,I=0,b,O=h.type,R=O==="FeatureCollection",W=O==="Feature",j=R?h.features.length:1,st=0;st<j;st++){v=R?h.features[st].geometry:W?h.geometry:h,b=v?v.type==="GeometryCollection":!1,d=b?v.geometries.length:1;for(var M=0;M<d;M++){var q=0,A=0;if(m=b?v.geometries[M]:v,m!==null){x=m.coordinates;var F=m.type;switch(P=r&&(F==="Polygon"||F==="MultiPolygon")?1:0,F){case null:break;case"Point":if(i(x,I,st,q,A)===!1)return!1;I++,q++;break;case"LineString":case"MultiPoint":for(a=0;a<x.length;a++){if(i(x[a],I,st,q,A)===!1)return!1;I++,F==="MultiPoint"&&q++}F==="LineString"&&q++;break;case"Polygon":case"MultiLineString":for(a=0;a<x.length;a++){for(l=0;l<x[a].length-P;l++){if(i(x[a][l],I,st,q,A)===!1)return!1;I++}F==="MultiLineString"&&q++,F==="Polygon"&&A++}F==="Polygon"&&q++;break;case"MultiPolygon":for(a=0;a<x.length;a++){for(A=0,l=0;l<x[a].length;l++){for(g=0;g<x[a][l].length-P;g++){if(i(x[a][l][g],I,st,q,A)===!1)return!1;I++}A++}q++}break;case"GeometryCollection":for(a=0;a<m.geometries.length;a++)if(Gn(m.geometries[a],i,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function si(h,i){if(h.type==="Feature")i(h,0);else if(h.type==="FeatureCollection")for(var r=0;r<h.features.length&&i(h.features[r],r)!==!1;r++);}function oi(h,i){var r,a,l,g,m,d,x,v,P,I,b=0,O=h.type==="FeatureCollection",R=h.type==="Feature",W=O?h.features.length:1;for(r=0;r<W;r++){for(d=O?h.features[r].geometry:R?h.geometry:h,v=O?h.features[r].properties:R?h.properties:{},P=O?h.features[r].bbox:R?h.bbox:void 0,I=O?h.features[r].id:R?h.id:void 0,x=d?d.type==="GeometryCollection":!1,m=x?d.geometries.length:1,l=0;l<m;l++){if(g=x?d.geometries[l]:d,g===null){if(i(null,b,v,P,I)===!1)return!1;continue}switch(g.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(i(g,b,v,P,I)===!1)return!1;break}case"GeometryCollection":{for(a=0;a<g.geometries.length;a++)if(i(g.geometries[a],b,v,P,I)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}b++}}function th(h,i,r){var a=r;return oi(h,function(l,g,m,d,x){a=i(a,l,g,m,d,x)}),a}function Su(h,i){oi(h,function(r,a,l,g,m){var d=r===null?null:r.type;switch(d){case null:case"Point":case"LineString":case"Polygon":return i(gn(r,l,{bbox:g,id:m}),a,0)===!1?!1:void 0}var x;switch(d){case"MultiPoint":x="Point";break;case"MultiLineString":x="LineString";break;case"MultiPolygon":x="Polygon";break}for(var v=0;v<r.coordinates.length;v++){var P=r.coordinates[v],I={type:x,coordinates:P};if(i(gn(I,l),a,v)===!1)return!1}})}function eh(h,i){Su(h,function(r,a,l){var g=0;if(r.geometry){var m=r.geometry.type;if(!(m==="Point"||m==="MultiPoint")){var d,x=0,v=0,P=0;if(Gn(r,function(I,b,O,R,W){if(d===void 0||a>x||R>v||W>P){d=I,x=a,v=R,P=W,g=0;return}var j=co([d,I],r.properties);if(i(j,a,l,W,g)===!1)return!1;g++,d=I})===!1)return!1}}})}function nh(h,i,r){var a=r,l=!1;return eh(h,function(g,m,d,x,v){l===!1&&r===void 0?a=g:a=i(a,g,m,d,x,v),l=!0}),a}function Cu(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}function ih(h){if(Object.prototype.hasOwnProperty.call(h,"__esModule"))return h;var i=h.default;if(typeof i=="function"){var r=function a(){return this instanceof a?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};r.prototype=i.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(h).forEach(function(a){var l=Object.getOwnPropertyDescriptor(h,a);Object.defineProperty(r,a,l.get?l:{enumerable:!0,get:function(){return h[a]}})}),r}var As={exports:{}},Ws={exports:{}},rh=Ws.exports,Ia;function sh(){return Ia||(Ia=1,function(h,i){(function(r,a){h.exports=a()})(rh,function(){function r(M,q,A,F,H){(function K(E,S,N,B,D){for(;B>N;){if(B-N>600){var V=B-N+1,Z=S-N+1,U=Math.log(V),G=.5*Math.exp(2*U/3),Q=.5*Math.sqrt(U*G*(V-G)/V)*(Z-V/2<0?-1:1),X=Math.max(N,Math.floor(S-Z*G/V+Q)),nt=Math.min(B,Math.floor(S+(V-Z)*G/V+Q));K(E,S,X,nt,D)}var J=E[S],ot=N,ct=B;for(a(E,N,S),D(E[B],J)>0&&a(E,N,B);ot<ct;){for(a(E,ot,ct),ot++,ct--;D(E[ot],J)<0;)ot++;for(;D(E[ct],J)>0;)ct--}D(E[N],J)===0?a(E,N,ct):a(E,++ct,B),ct<=S&&(N=ct+1),S<=ct&&(B=ct-1)}})(M,q,A||0,F||M.length-1,H||l)}function a(M,q,A){var F=M[q];M[q]=M[A],M[A]=F}function l(M,q){return M<q?-1:M>q?1:0}var g=function(M){M===void 0&&(M=9),this._maxEntries=Math.max(4,M),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function m(M,q,A){if(!A)return q.indexOf(M);for(var F=0;F<q.length;F++)if(A(M,q[F]))return F;return-1}function d(M,q){x(M,0,M.children.length,q,M)}function x(M,q,A,F,H){H||(H=j(null)),H.minX=1/0,H.minY=1/0,H.maxX=-1/0,H.maxY=-1/0;for(var K=q;K<A;K++){var E=M.children[K];v(H,M.leaf?F(E):E)}return H}function v(M,q){return M.minX=Math.min(M.minX,q.minX),M.minY=Math.min(M.minY,q.minY),M.maxX=Math.max(M.maxX,q.maxX),M.maxY=Math.max(M.maxY,q.maxY),M}function P(M,q){return M.minX-q.minX}function I(M,q){return M.minY-q.minY}function b(M){return(M.maxX-M.minX)*(M.maxY-M.minY)}function O(M){return M.maxX-M.minX+(M.maxY-M.minY)}function R(M,q){return M.minX<=q.minX&&M.minY<=q.minY&&q.maxX<=M.maxX&&q.maxY<=M.maxY}function W(M,q){return q.minX<=M.maxX&&q.minY<=M.maxY&&q.maxX>=M.minX&&q.maxY>=M.minY}function j(M){return{children:M,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function st(M,q,A,F,H){for(var K=[q,A];K.length;)if(!((A=K.pop())-(q=K.pop())<=F)){var E=q+Math.ceil((A-q)/F/2)*F;r(M,E,q,A,H),K.push(q,E,E,A)}}return g.prototype.all=function(){return this._all(this.data,[])},g.prototype.search=function(M){var q=this.data,A=[];if(!W(M,q))return A;for(var F=this.toBBox,H=[];q;){for(var K=0;K<q.children.length;K++){var E=q.children[K],S=q.leaf?F(E):E;W(M,S)&&(q.leaf?A.push(E):R(M,S)?this._all(E,A):H.push(E))}q=H.pop()}return A},g.prototype.collides=function(M){var q=this.data;if(!W(M,q))return!1;for(var A=[];q;){for(var F=0;F<q.children.length;F++){var H=q.children[F],K=q.leaf?this.toBBox(H):H;if(W(M,K)){if(q.leaf||R(M,K))return!0;A.push(H)}}q=A.pop()}return!1},g.prototype.load=function(M){if(!M||!M.length)return this;if(M.length<this._minEntries){for(var q=0;q<M.length;q++)this.insert(M[q]);return this}var A=this._build(M.slice(),0,M.length-1,0);if(this.data.children.length)if(this.data.height===A.height)this._splitRoot(this.data,A);else{if(this.data.height<A.height){var F=this.data;this.data=A,A=F}this._insert(A,this.data.height-A.height-1,!0)}else this.data=A;return this},g.prototype.insert=function(M){return M&&this._insert(M,this.data.height-1),this},g.prototype.clear=function(){return this.data=j([]),this},g.prototype.remove=function(M,q){if(!M)return this;for(var A,F,H,K=this.data,E=this.toBBox(M),S=[],N=[];K||S.length;){if(K||(K=S.pop(),F=S[S.length-1],A=N.pop(),H=!0),K.leaf){var B=m(M,K.children,q);if(B!==-1)return K.children.splice(B,1),S.push(K),this._condense(S),this}H||K.leaf||!R(K,E)?F?(A++,K=F.children[A],H=!1):K=null:(S.push(K),N.push(A),A=0,F=K,K=K.children[0])}return this},g.prototype.toBBox=function(M){return M},g.prototype.compareMinX=function(M,q){return M.minX-q.minX},g.prototype.compareMinY=function(M,q){return M.minY-q.minY},g.prototype.toJSON=function(){return this.data},g.prototype.fromJSON=function(M){return this.data=M,this},g.prototype._all=function(M,q){for(var A=[];M;)M.leaf?q.push.apply(q,M.children):A.push.apply(A,M.children),M=A.pop();return q},g.prototype._build=function(M,q,A,F){var H,K=A-q+1,E=this._maxEntries;if(K<=E)return d(H=j(M.slice(q,A+1)),this.toBBox),H;F||(F=Math.ceil(Math.log(K)/Math.log(E)),E=Math.ceil(K/Math.pow(E,F-1))),(H=j([])).leaf=!1,H.height=F;var S=Math.ceil(K/E),N=S*Math.ceil(Math.sqrt(E));st(M,q,A,N,this.compareMinX);for(var B=q;B<=A;B+=N){var D=Math.min(B+N-1,A);st(M,B,D,S,this.compareMinY);for(var V=B;V<=D;V+=S){var Z=Math.min(V+S-1,D);H.children.push(this._build(M,V,Z,F-1))}}return d(H,this.toBBox),H},g.prototype._chooseSubtree=function(M,q,A,F){for(;F.push(q),!q.leaf&&F.length-1!==A;){for(var H=1/0,K=1/0,E=void 0,S=0;S<q.children.length;S++){var N=q.children[S],B=b(N),D=(V=M,Z=N,(Math.max(Z.maxX,V.maxX)-Math.min(Z.minX,V.minX))*(Math.max(Z.maxY,V.maxY)-Math.min(Z.minY,V.minY))-B);D<K?(K=D,H=B<H?B:H,E=N):D===K&&B<H&&(H=B,E=N)}q=E||q.children[0]}var V,Z;return q},g.prototype._insert=function(M,q,A){var F=A?M:this.toBBox(M),H=[],K=this._chooseSubtree(F,this.data,q,H);for(K.children.push(M),v(K,F);q>=0&&H[q].children.length>this._maxEntries;)this._split(H,q),q--;this._adjustParentBBoxes(F,H,q)},g.prototype._split=function(M,q){var A=M[q],F=A.children.length,H=this._minEntries;this._chooseSplitAxis(A,H,F);var K=this._chooseSplitIndex(A,H,F),E=j(A.children.splice(K,A.children.length-K));E.height=A.height,E.leaf=A.leaf,d(A,this.toBBox),d(E,this.toBBox),q?M[q-1].children.push(E):this._splitRoot(A,E)},g.prototype._splitRoot=function(M,q){this.data=j([M,q]),this.data.height=M.height+1,this.data.leaf=!1,d(this.data,this.toBBox)},g.prototype._chooseSplitIndex=function(M,q,A){for(var F,H,K,E,S,N,B,D=1/0,V=1/0,Z=q;Z<=A-q;Z++){var U=x(M,0,Z,this.toBBox),G=x(M,Z,A,this.toBBox),Q=(H=U,K=G,E=void 0,S=void 0,N=void 0,B=void 0,E=Math.max(H.minX,K.minX),S=Math.max(H.minY,K.minY),N=Math.min(H.maxX,K.maxX),B=Math.min(H.maxY,K.maxY),Math.max(0,N-E)*Math.max(0,B-S)),X=b(U)+b(G);Q<D?(D=Q,F=Z,V=X<V?X:V):Q===D&&X<V&&(V=X,F=Z)}return F||A-q},g.prototype._chooseSplitAxis=function(M,q,A){var F=M.leaf?this.compareMinX:P,H=M.leaf?this.compareMinY:I;this._allDistMargin(M,q,A,F)<this._allDistMargin(M,q,A,H)&&M.children.sort(F)},g.prototype._allDistMargin=function(M,q,A,F){M.children.sort(F);for(var H=this.toBBox,K=x(M,0,q,H),E=x(M,A-q,A,H),S=O(K)+O(E),N=q;N<A-q;N++){var B=M.children[N];v(K,M.leaf?H(B):B),S+=O(K)}for(var D=A-q-1;D>=q;D--){var V=M.children[D];v(E,M.leaf?H(V):V),S+=O(E)}return S},g.prototype._adjustParentBBoxes=function(M,q,A){for(var F=A;F>=0;F--)v(q[F],M)},g.prototype._condense=function(M){for(var q=M.length-1,A=void 0;q>=0;q--)M[q].children.length===0?q>0?(A=M[q-1].children).splice(A.indexOf(M[q]),1):this.clear():d(M[q],this.toBBox)},g})}(Ws)),Ws.exports}let oh=class{constructor(i=[],r=ah){if(this.data=i,this.length=this.data.length,this.compare=r,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:r,compare:a}=this,l=r[i];for(;i>0;){const g=i-1>>1,m=r[g];if(a(l,m)>=0)break;r[i]=m,i=g}r[i]=l}_down(i){const{data:r,compare:a}=this,l=this.length>>1,g=r[i];for(;i<l;){let m=(i<<1)+1,d=r[m];const x=m+1;if(x<this.length&&a(r[x],d)<0&&(m=x,d=r[x]),a(d,g)>=0)break;r[i]=d,i=m}r[i]=g}};function ah(h,i){return h<i?-1:h>i?1:0}const uh=Object.freeze(Object.defineProperty({__proto__:null,default:oh},Symbol.toStringTag,{value:"Module"})),lh=ih(uh);var Xr={exports:{}},Ao,La;function hh(){return La||(La=1,Ao=function(i,r,a,l){var g=i[0],m=i[1],d=!1;a===void 0&&(a=0),l===void 0&&(l=r.length);for(var x=(l-a)/2,v=0,P=x-1;v<x;P=v++){var I=r[a+v*2+0],b=r[a+v*2+1],O=r[a+P*2+0],R=r[a+P*2+1],W=b>m!=R>m&&g<(O-I)*(m-b)/(R-b)+I;W&&(d=!d)}return d}),Ao}var Ro,Sa;function ch(){return Sa||(Sa=1,Ro=function(i,r,a,l){var g=i[0],m=i[1],d=!1;a===void 0&&(a=0),l===void 0&&(l=r.length);for(var x=l-a,v=0,P=x-1;v<x;P=v++){var I=r[v+a][0],b=r[v+a][1],O=r[P+a][0],R=r[P+a][1],W=b>m!=R>m&&g<(O-I)*(m-b)/(R-b)+I;W&&(d=!d)}return d}),Ro}var Ca;function fh(){if(Ca)return Xr.exports;Ca=1;var h=hh(),i=ch();return Xr.exports=function(a,l,g,m){return l.length>0&&Array.isArray(l[0])?i(a,l,g,m):h(a,l,g,m)},Xr.exports.nested=i,Xr.exports.flat=h,Xr.exports}var jr={exports:{}},gh=jr.exports,ba;function dh(){return ba||(ba=1,function(h,i){(function(r,a){a(i)})(gh,function(r){const l=33306690738754706e-32;function g(W,j,st,M,q){let A,F,H,K,E=j[0],S=M[0],N=0,B=0;S>E==S>-E?(A=E,E=j[++N]):(A=S,S=M[++B]);let D=0;if(N<W&&B<st)for(S>E==S>-E?(H=A-((F=E+A)-E),E=j[++N]):(H=A-((F=S+A)-S),S=M[++B]),A=F,H!==0&&(q[D++]=H);N<W&&B<st;)S>E==S>-E?(H=A-((F=A+E)-(K=F-A))+(E-K),E=j[++N]):(H=A-((F=A+S)-(K=F-A))+(S-K),S=M[++B]),A=F,H!==0&&(q[D++]=H);for(;N<W;)H=A-((F=A+E)-(K=F-A))+(E-K),E=j[++N],A=F,H!==0&&(q[D++]=H);for(;B<st;)H=A-((F=A+S)-(K=F-A))+(S-K),S=M[++B],A=F,H!==0&&(q[D++]=H);return A===0&&D!==0||(q[D++]=A),D}function m(W){return new Float64Array(W)}const d=33306690738754716e-32,x=22204460492503146e-32,v=11093356479670487e-47,P=m(4),I=m(8),b=m(12),O=m(16),R=m(4);r.orient2d=function(W,j,st,M,q,A){const F=(j-A)*(st-q),H=(W-q)*(M-A),K=F-H;if(F===0||H===0||F>0!=H>0)return K;const E=Math.abs(F+H);return Math.abs(K)>=d*E?K:-function(S,N,B,D,V,Z,U){let G,Q,X,nt,J,ot,ct,pt,ht,ft,gt,kt,et,Vt,Ct,vt,Y,At;const Gt=S-V,Lt=B-V,xe=N-Z,he=D-Z;J=(Ct=(pt=Gt-(ct=(ot=134217729*Gt)-(ot-Gt)))*(ft=he-(ht=(ot=134217729*he)-(ot-he)))-((Vt=Gt*he)-ct*ht-pt*ht-ct*ft))-(gt=Ct-(Y=(pt=xe-(ct=(ot=134217729*xe)-(ot-xe)))*(ft=Lt-(ht=(ot=134217729*Lt)-(ot-Lt)))-((vt=xe*Lt)-ct*ht-pt*ht-ct*ft))),P[0]=Ct-(gt+J)+(J-Y),J=(et=Vt-((kt=Vt+gt)-(J=kt-Vt))+(gt-J))-(gt=et-vt),P[1]=et-(gt+J)+(J-vt),J=(At=kt+gt)-kt,P[2]=kt-(At-J)+(gt-J),P[3]=At;let Ce=function(bi,Nt){let dn=Nt[0];for(let Ze=1;Ze<bi;Ze++)dn+=Nt[Ze];return dn}(4,P),yt=x*U;if(Ce>=yt||-Ce>=yt||(G=S-(Gt+(J=S-Gt))+(J-V),X=B-(Lt+(J=B-Lt))+(J-V),Q=N-(xe+(J=N-xe))+(J-Z),nt=D-(he+(J=D-he))+(J-Z),G===0&&Q===0&&X===0&&nt===0)||(yt=v*U+l*Math.abs(Ce),(Ce+=Gt*nt+he*G-(xe*X+Lt*Q))>=yt||-Ce>=yt))return Ce;J=(Ct=(pt=G-(ct=(ot=134217729*G)-(ot-G)))*(ft=he-(ht=(ot=134217729*he)-(ot-he)))-((Vt=G*he)-ct*ht-pt*ht-ct*ft))-(gt=Ct-(Y=(pt=Q-(ct=(ot=134217729*Q)-(ot-Q)))*(ft=Lt-(ht=(ot=134217729*Lt)-(ot-Lt)))-((vt=Q*Lt)-ct*ht-pt*ht-ct*ft))),R[0]=Ct-(gt+J)+(J-Y),J=(et=Vt-((kt=Vt+gt)-(J=kt-Vt))+(gt-J))-(gt=et-vt),R[1]=et-(gt+J)+(J-vt),J=(At=kt+gt)-kt,R[2]=kt-(At-J)+(gt-J),R[3]=At;const ui=g(4,P,4,R,I);J=(Ct=(pt=Gt-(ct=(ot=134217729*Gt)-(ot-Gt)))*(ft=nt-(ht=(ot=134217729*nt)-(ot-nt)))-((Vt=Gt*nt)-ct*ht-pt*ht-ct*ft))-(gt=Ct-(Y=(pt=xe-(ct=(ot=134217729*xe)-(ot-xe)))*(ft=X-(ht=(ot=134217729*X)-(ot-X)))-((vt=xe*X)-ct*ht-pt*ht-ct*ft))),R[0]=Ct-(gt+J)+(J-Y),J=(et=Vt-((kt=Vt+gt)-(J=kt-Vt))+(gt-J))-(gt=et-vt),R[1]=et-(gt+J)+(J-vt),J=(At=kt+gt)-kt,R[2]=kt-(At-J)+(gt-J),R[3]=At;const Yn=g(ui,I,4,R,b);J=(Ct=(pt=G-(ct=(ot=134217729*G)-(ot-G)))*(ft=nt-(ht=(ot=134217729*nt)-(ot-nt)))-((Vt=G*nt)-ct*ht-pt*ht-ct*ft))-(gt=Ct-(Y=(pt=Q-(ct=(ot=134217729*Q)-(ot-Q)))*(ft=X-(ht=(ot=134217729*X)-(ot-X)))-((vt=Q*X)-ct*ht-pt*ht-ct*ft))),R[0]=Ct-(gt+J)+(J-Y),J=(et=Vt-((kt=Vt+gt)-(J=kt-Vt))+(gt-J))-(gt=et-vt),R[1]=et-(gt+J)+(J-vt),J=(At=kt+gt)-kt,R[2]=kt-(At-J)+(gt-J),R[3]=At;const qe=g(Yn,b,4,R,O);return O[qe-1]}(W,j,st,M,q,A,E)},r.orient2dfast=function(W,j,st,M,q,A){return(j-A)*(st-q)-(W-q)*(M-A)},Object.defineProperty(r,"__esModule",{value:!0})})}(jr,jr.exports)),jr.exports}var Ta;function mh(){if(Ta)return As.exports;Ta=1;var h=sh(),i=lh,r=fh(),a=dh().orient2d;i.default&&(i=i.default),As.exports=l,As.exports.default=l;function l(A,F,H){F=Math.max(0,F===void 0?2:F),H=H||0;var K=O(A),E=new h(16);E.toBBox=function(ct){return{minX:ct[0],minY:ct[1],maxX:ct[0],maxY:ct[1]}},E.compareMinX=function(ct,pt){return ct[0]-pt[0]},E.compareMinY=function(ct,pt){return ct[1]-pt[1]},E.load(A);for(var S=[],N=0,B;N<K.length;N++){var D=K[N];E.remove(D),B=R(D,B),S.push(B)}var V=new h(16);for(N=0;N<S.length;N++)V.insert(b(S[N]));for(var Z=F*F,U=H*H;S.length;){var G=S.shift(),Q=G.p,X=G.next.p,nt=W(Q,X);if(!(nt<U)){var J=nt/Z;D=g(E,G.prev.p,Q,X,G.next.next.p,J,V),D&&Math.min(W(D,Q),W(D,X))<=J&&(S.push(G),S.push(R(D,G)),E.remove(D),V.remove(G),V.insert(b(G)),V.insert(b(G.next)))}}G=B;var ot=[];do ot.push(G.p),G=G.next;while(G!==B);return ot.push(G.p),ot}function g(A,F,H,K,E,S,N){for(var B=new i([],m),D=A.data;D;){for(var V=0;V<D.children.length;V++){var Z=D.children[V],U=D.leaf?j(Z,H,K):d(H,K,Z);U>S||B.push({node:Z,dist:U})}for(;B.length&&!B.peek().node.children;){var G=B.pop(),Q=G.node,X=j(Q,F,H),nt=j(Q,K,E);if(G.dist<X&&G.dist<nt&&v(H,Q,N)&&v(K,Q,N))return Q}D=B.pop(),D&&(D=D.node)}return null}function m(A,F){return A.dist-F.dist}function d(A,F,H){if(x(A,H)||x(F,H))return 0;var K=st(A[0],A[1],F[0],F[1],H.minX,H.minY,H.maxX,H.minY);if(K===0)return 0;var E=st(A[0],A[1],F[0],F[1],H.minX,H.minY,H.minX,H.maxY);if(E===0)return 0;var S=st(A[0],A[1],F[0],F[1],H.maxX,H.minY,H.maxX,H.maxY);if(S===0)return 0;var N=st(A[0],A[1],F[0],F[1],H.minX,H.maxY,H.maxX,H.maxY);return N===0?0:Math.min(K,E,S,N)}function x(A,F){return A[0]>=F.minX&&A[0]<=F.maxX&&A[1]>=F.minY&&A[1]<=F.maxY}function v(A,F,H){for(var K=Math.min(A[0],F[0]),E=Math.min(A[1],F[1]),S=Math.max(A[0],F[0]),N=Math.max(A[1],F[1]),B=H.search({minX:K,minY:E,maxX:S,maxY:N}),D=0;D<B.length;D++)if(I(B[D].p,B[D].next.p,A,F))return!1;return!0}function P(A,F,H){return a(A[0],A[1],F[0],F[1],H[0],H[1])}function I(A,F,H,K){return A!==K&&F!==H&&P(A,F,H)>0!=P(A,F,K)>0&&P(H,K,A)>0!=P(H,K,F)>0}function b(A){var F=A.p,H=A.next.p;return A.minX=Math.min(F[0],H[0]),A.minY=Math.min(F[1],H[1]),A.maxX=Math.max(F[0],H[0]),A.maxY=Math.max(F[1],H[1]),A}function O(A){for(var F=A[0],H=A[0],K=A[0],E=A[0],S=0;S<A.length;S++){var N=A[S];N[0]<F[0]&&(F=N),N[0]>K[0]&&(K=N),N[1]<H[1]&&(H=N),N[1]>E[1]&&(E=N)}var B=[F,H,K,E],D=B.slice();for(S=0;S<A.length;S++)r(A[S],B)||D.push(A[S]);return q(D)}function R(A,F){var H={p:A,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return F?(H.next=F.next,H.prev=F,F.next.prev=H,F.next=H):(H.prev=H,H.next=H),H}function W(A,F){var H=A[0]-F[0],K=A[1]-F[1];return H*H+K*K}function j(A,F,H){var K=F[0],E=F[1],S=H[0]-K,N=H[1]-E;if(S!==0||N!==0){var B=((A[0]-K)*S+(A[1]-E)*N)/(S*S+N*N);B>1?(K=H[0],E=H[1]):B>0&&(K+=S*B,E+=N*B)}return S=A[0]-K,N=A[1]-E,S*S+N*N}function st(A,F,H,K,E,S,N,B){var D=H-A,V=K-F,Z=N-E,U=B-S,G=A-E,Q=F-S,X=D*D+V*V,nt=D*Z+V*U,J=Z*Z+U*U,ot=D*G+V*Q,ct=Z*G+U*Q,pt=X*J-nt*nt,ht,ft,gt,kt,et=pt,Vt=pt;pt===0?(ft=0,et=1,kt=ct,Vt=J):(ft=nt*ct-J*ot,kt=X*ct-nt*ot,ft<0?(ft=0,kt=ct,Vt=J):ft>et&&(ft=et,kt=ct+nt,Vt=J)),kt<0?(kt=0,-ot<0?ft=0:-ot>X?ft=et:(ft=-ot,et=X)):kt>Vt&&(kt=Vt,-ot+nt<0?ft=0:-ot+nt>X?ft=et:(ft=-ot+nt,et=X)),ht=ft===0?0:ft/et,gt=kt===0?0:kt/Vt;var Ct=(1-ht)*A+ht*H,vt=(1-ht)*F+ht*K,Y=(1-gt)*E+gt*N,At=(1-gt)*S+gt*B,Gt=Y-Ct,Lt=At-vt;return Gt*Gt+Lt*Lt}function M(A,F){return A[0]===F[0]?A[1]-F[1]:A[0]-F[0]}function q(A){A.sort(M);for(var F=[],H=0;H<A.length;H++){for(;F.length>=2&&P(F[F.length-2],F[F.length-1],A[H])<=0;)F.pop();F.push(A[H])}for(var K=[],E=A.length-1;E>=0;E--){for(;K.length>=2&&P(K[K.length-2],K[K.length-1],A[E])<=0;)K.pop();K.push(A[E])}return K.pop(),F.pop(),F.concat(K)}return As.exports}var ph=mh();const bu=Cu(ph);function Tu(h,i={}){i.concavity=i.concavity||1/0;const r=[];if(Gn(h,l=>{r.push([l[0],l[1]])}),!r.length)return null;const a=bu(r,i.concavity);return a.length>3?Zn([a]):null}var Na=Tu;function Oa(h,i={}){let r=0,a=0,l=0;return Gn(h,function(g){r+=g[0],a+=g[1],l++},!0),zn([r/l,a/l],i.properties)}function us(h){if(!h)throw new Error("coord is required");if(!Array.isArray(h)){if(h.type==="Feature"&&h.geometry!==null&&h.geometry.type==="Point")return[...h.geometry.coordinates];if(h.type==="Point")return[...h.coordinates]}if(Array.isArray(h)&&h.length>=2&&!Array.isArray(h[0])&&!Array.isArray(h[1]))return[...h];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function lr(h){if(Array.isArray(h))return h;if(h.type==="Feature"){if(h.geometry!==null)return h.geometry.coordinates}else if(h.coordinates)return h.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Ln(h){return h.type==="Feature"?h.geometry:h}function Nu(h,i){return h.type==="FeatureCollection"?"FeatureCollection":h.type==="GeometryCollection"?"GeometryCollection":h.type==="Feature"&&h.geometry!==null?h.geometry.type:h.type}function Ou(h,i={}){switch(Nu(h)){case"Point":return zn(us(h),i.properties);case"Polygon":var r=[];Gn(h,function(A){r.push(A)});var a=Oa(h,{properties:i.properties}),l=a.geometry.coordinates,g=0,m=0,d=0,x,v,P,I,b,O,R,W,j=r.map(function(A){return[A[0]-l[0],A[1]-l[1]]});for(x=0;x<r.length-1;x++)v=j[x],I=v[0],O=v[1],P=j[x+1],b=P[0],R=P[1],W=I*R-b*O,d+=W,g+=(I+b)*W,m+=(O+R)*W;if(d===0)return a;var st=d*.5,M=1/(6*st);return zn([l[0]+M*g,l[1]+M*m],i.properties);default:var q=Tu(h);return q?Ou(q,{properties:i.properties}):Oa(h,{properties:i.properties})}}var yh=Ou;class Au{constructor(i=[],r=vh){if(this.data=i,this.length=this.data.length,this.compare=r,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:r,compare:a}=this,l=r[i];for(;i>0;){const g=i-1>>1,m=r[g];if(a(l,m)>=0)break;r[i]=m,i=g}r[i]=l}_down(i){const{data:r,compare:a}=this,l=this.length>>1,g=r[i];for(;i<l;){let m=(i<<1)+1,d=r[m];const x=m+1;if(x<this.length&&a(r[x],d)<0&&(m=x,d=r[x]),a(d,g)>=0)break;r[i]=d,i=m}r[i]=g}}function vh(h,i){return h<i?-1:h>i?1:0}function Ru(h,i){return h.p.x>i.p.x?1:h.p.x<i.p.x?-1:h.p.y!==i.p.y?h.p.y>i.p.y?1:-1:1}function _h(h,i){return h.rightSweepEvent.p.x>i.rightSweepEvent.p.x?1:h.rightSweepEvent.p.x<i.rightSweepEvent.p.x?-1:h.rightSweepEvent.p.y!==i.rightSweepEvent.p.y?h.rightSweepEvent.p.y<i.rightSweepEvent.p.y?1:-1:1}class Aa{constructor(i,r,a,l){this.p={x:i[0],y:i[1]},this.featureId=r,this.ringId=a,this.eventId=l,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(i){return this.p.x===i.p.x&&this.p.y===i.p.y}}function xh(h,i){if(h.type==="FeatureCollection"){const r=h.features;for(let a=0;a<r.length;a++)Ra(r[a],i)}else Ra(h,i)}let Rs=0,Ds=0,Fs=0;function Ra(h,i){const r=h.type==="Feature"?h.geometry:h;let a=r.coordinates;(r.type==="Polygon"||r.type==="MultiLineString")&&(a=[a]),r.type==="LineString"&&(a=[[a]]);for(let l=0;l<a.length;l++)for(let g=0;g<a[l].length;g++){let m=a[l][g][0],d=null;Ds=Ds+1;for(let x=0;x<a[l][g].length-1;x++){d=a[l][g][x+1];const v=new Aa(m,Rs,Ds,Fs),P=new Aa(d,Rs,Ds,Fs+1);v.otherEvent=P,P.otherEvent=v,Ru(v,P)>0?(P.isLeftEndpoint=!0,v.isLeftEndpoint=!1):(v.isLeftEndpoint=!0,P.isLeftEndpoint=!1),i.push(v),i.push(P),m=d,Fs=Fs+1}}Rs=Rs+1}let kh=class{constructor(i){this.leftSweepEvent=i,this.rightSweepEvent=i.otherEvent}};function wh(h,i){if(h===null||i===null||h.leftSweepEvent.ringId===i.leftSweepEvent.ringId&&(h.rightSweepEvent.isSamePoint(i.leftSweepEvent)||h.rightSweepEvent.isSamePoint(i.leftSweepEvent)||h.rightSweepEvent.isSamePoint(i.rightSweepEvent)||h.leftSweepEvent.isSamePoint(i.leftSweepEvent)||h.leftSweepEvent.isSamePoint(i.rightSweepEvent)))return!1;const r=h.leftSweepEvent.p.x,a=h.leftSweepEvent.p.y,l=h.rightSweepEvent.p.x,g=h.rightSweepEvent.p.y,m=i.leftSweepEvent.p.x,d=i.leftSweepEvent.p.y,x=i.rightSweepEvent.p.x,v=i.rightSweepEvent.p.y,P=(v-d)*(l-r)-(x-m)*(g-a),I=(x-m)*(a-d)-(v-d)*(r-m),b=(l-r)*(a-d)-(g-a)*(r-m);if(P===0)return!1;const O=I/P,R=b/P;if(O>=0&&O<=1&&R>=0&&R<=1){const W=r+O*(l-r),j=a+O*(g-a);return[W,j]}return!1}function Eh(h,i){i=i||!1;const r=[],a=new Au([],_h);for(;h.length;){const l=h.pop();if(l.isLeftEndpoint){const g=new kh(l);for(let m=0;m<a.data.length;m++){const d=a.data[m];if(i&&d.leftSweepEvent.featureId===l.featureId)continue;const x=wh(g,d);x!==!1&&r.push(x)}a.push(g)}else l.isLeftEndpoint===!1&&a.pop()}return r}function Ph(h,i){const r=new Au([],Ru);return xh(h,r),Eh(r,i)}var Mh=Ph;function Ih(h,i,r={}){const{removeDuplicates:a=!0,ignoreSelfIntersections:l=!0}=r;let g=[];h.type==="FeatureCollection"?g=g.concat(h.features):h.type==="Feature"?g.push(h):(h.type==="LineString"||h.type==="Polygon"||h.type==="MultiLineString"||h.type==="MultiPolygon")&&g.push(gn(h)),i.type==="FeatureCollection"?g=g.concat(i.features):i.type==="Feature"?g.push(i):(i.type==="LineString"||i.type==="Polygon"||i.type==="MultiLineString"||i.type==="MultiPolygon")&&g.push(gn(i));const m=Mh(In(g),l);let d=[];if(a){const x={};m.forEach(v=>{const P=v.join(",");x[P]||(x[P]=!0,d.push(v))})}else d=m;return In(d.map(x=>zn(x)))}var Lh=Ih,Sh=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Do=Math.ceil,rn=Math.floor,Be="[BigNumber Error] ",Da=Be+"Number primitive has more than 15 significant digits: ",cn=1e14,Bt=14,Fo=9007199254740991,Bo=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],ii=1e7,ve=1e9;function Du(h){var i,r,a,l=M.prototype={constructor:M,toString:null,valueOf:null},g=new M(1),m=20,d=4,x=-7,v=21,P=-1e7,I=1e7,b=!1,O=1,R=0,W={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},j="0123456789abcdefghijklmnopqrstuvwxyz",st=!0;function M(E,S){var N,B,D,V,Z,U,G,Q,X=this;if(!(X instanceof M))return new M(E,S);if(S==null){if(E&&E._isBigNumber===!0){X.s=E.s,!E.c||E.e>I?X.c=X.e=null:E.e<P?X.c=[X.e=0]:(X.e=E.e,X.c=E.c.slice());return}if((U=typeof E=="number")&&E*0==0){if(X.s=1/E<0?(E=-E,-1):1,E===~~E){for(V=0,Z=E;Z>=10;Z/=10,V++);V>I?X.c=X.e=null:(X.e=V,X.c=[E]);return}Q=String(E)}else{if(!Sh.test(Q=String(E)))return a(X,Q,U);X.s=Q.charCodeAt(0)==45?(Q=Q.slice(1),-1):1}(V=Q.indexOf("."))>-1&&(Q=Q.replace(".","")),(Z=Q.search(/e/i))>0?(V<0&&(V=Z),V+=+Q.slice(Z+1),Q=Q.substring(0,Z)):V<0&&(V=Q.length)}else{if(ie(S,2,j.length,"Base"),S==10&&st)return X=new M(E),H(X,m+X.e+1,d);if(Q=String(E),U=typeof E=="number"){if(E*0!=0)return a(X,Q,U,S);if(X.s=1/E<0?(Q=Q.slice(1),-1):1,M.DEBUG&&Q.replace(/^0\.0*|\./,"").length>15)throw Error(Da+E)}else X.s=Q.charCodeAt(0)===45?(Q=Q.slice(1),-1):1;for(N=j.slice(0,S),V=Z=0,G=Q.length;Z<G;Z++)if(N.indexOf(B=Q.charAt(Z))<0){if(B=="."){if(Z>V){V=G;continue}}else if(!D&&(Q==Q.toUpperCase()&&(Q=Q.toLowerCase())||Q==Q.toLowerCase()&&(Q=Q.toUpperCase()))){D=!0,Z=-1,V=0;continue}return a(X,String(E),U,S)}U=!1,Q=r(Q,S,10,X.s),(V=Q.indexOf("."))>-1?Q=Q.replace(".",""):V=Q.length}for(Z=0;Q.charCodeAt(Z)===48;Z++);for(G=Q.length;Q.charCodeAt(--G)===48;);if(Q=Q.slice(Z,++G)){if(G-=Z,U&&M.DEBUG&&G>15&&(E>Fo||E!==rn(E)))throw Error(Da+X.s*E);if((V=V-Z-1)>I)X.c=X.e=null;else if(V<P)X.c=[X.e=0];else{if(X.e=V,X.c=[],Z=(V+1)%Bt,V<0&&(Z+=Bt),Z<G){for(Z&&X.c.push(+Q.slice(0,Z)),G-=Bt;Z<G;)X.c.push(+Q.slice(Z,Z+=Bt));Z=Bt-(Q=Q.slice(Z)).length}else Z-=G;for(;Z--;Q+="0");X.c.push(+Q)}}else X.c=[X.e=0]}M.clone=Du,M.ROUND_UP=0,M.ROUND_DOWN=1,M.ROUND_CEIL=2,M.ROUND_FLOOR=3,M.ROUND_HALF_UP=4,M.ROUND_HALF_DOWN=5,M.ROUND_HALF_EVEN=6,M.ROUND_HALF_CEIL=7,M.ROUND_HALF_FLOOR=8,M.EUCLID=9,M.config=M.set=function(E){var S,N;if(E!=null)if(typeof E=="object"){if(E.hasOwnProperty(S="DECIMAL_PLACES")&&(N=E[S],ie(N,0,ve,S),m=N),E.hasOwnProperty(S="ROUNDING_MODE")&&(N=E[S],ie(N,0,8,S),d=N),E.hasOwnProperty(S="EXPONENTIAL_AT")&&(N=E[S],N&&N.pop?(ie(N[0],-ve,0,S),ie(N[1],0,ve,S),x=N[0],v=N[1]):(ie(N,-ve,ve,S),x=-(v=N<0?-N:N))),E.hasOwnProperty(S="RANGE"))if(N=E[S],N&&N.pop)ie(N[0],-ve,-1,S),ie(N[1],1,ve,S),P=N[0],I=N[1];else if(ie(N,-ve,ve,S),N)P=-(I=N<0?-N:N);else throw Error(Be+S+" cannot be zero: "+N);if(E.hasOwnProperty(S="CRYPTO"))if(N=E[S],N===!!N)if(N)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))b=N;else throw b=!N,Error(Be+"crypto unavailable");else b=N;else throw Error(Be+S+" not true or false: "+N);if(E.hasOwnProperty(S="MODULO_MODE")&&(N=E[S],ie(N,0,9,S),O=N),E.hasOwnProperty(S="POW_PRECISION")&&(N=E[S],ie(N,0,ve,S),R=N),E.hasOwnProperty(S="FORMAT"))if(N=E[S],typeof N=="object")W=N;else throw Error(Be+S+" not an object: "+N);if(E.hasOwnProperty(S="ALPHABET"))if(N=E[S],typeof N=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(N))st=N.slice(0,10)=="0123456789",j=N;else throw Error(Be+S+" invalid: "+N)}else throw Error(Be+"Object expected: "+E);return{DECIMAL_PLACES:m,ROUNDING_MODE:d,EXPONENTIAL_AT:[x,v],RANGE:[P,I],CRYPTO:b,MODULO_MODE:O,POW_PRECISION:R,FORMAT:W,ALPHABET:j}},M.isBigNumber=function(E){if(!E||E._isBigNumber!==!0)return!1;if(!M.DEBUG)return!0;var S,N,B=E.c,D=E.e,V=E.s;t:if({}.toString.call(B)=="[object Array]"){if((V===1||V===-1)&&D>=-ve&&D<=ve&&D===rn(D)){if(B[0]===0){if(D===0&&B.length===1)return!0;break t}if(S=(D+1)%Bt,S<1&&(S+=Bt),String(B[0]).length==S){for(S=0;S<B.length;S++)if(N=B[S],N<0||N>=cn||N!==rn(N))break t;if(N!==0)return!0}}}else if(B===null&&D===null&&(V===null||V===1||V===-1))return!0;throw Error(Be+"Invalid BigNumber: "+E)},M.maximum=M.max=function(){return A(arguments,-1)},M.minimum=M.min=function(){return A(arguments,1)},M.random=function(){var E=9007199254740992,S=Math.random()*E&2097151?function(){return rn(Math.random()*E)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(N){var B,D,V,Z,U,G=0,Q=[],X=new M(g);if(N==null?N=m:ie(N,0,ve),Z=Do(N/Bt),b)if(crypto.getRandomValues){for(B=crypto.getRandomValues(new Uint32Array(Z*=2));G<Z;)U=B[G]*131072+(B[G+1]>>>11),U>=9e15?(D=crypto.getRandomValues(new Uint32Array(2)),B[G]=D[0],B[G+1]=D[1]):(Q.push(U%1e14),G+=2);G=Z/2}else if(crypto.randomBytes){for(B=crypto.randomBytes(Z*=7);G<Z;)U=(B[G]&31)*281474976710656+B[G+1]*1099511627776+B[G+2]*4294967296+B[G+3]*16777216+(B[G+4]<<16)+(B[G+5]<<8)+B[G+6],U>=9e15?crypto.randomBytes(7).copy(B,G):(Q.push(U%1e14),G+=7);G=Z/7}else throw b=!1,Error(Be+"crypto unavailable");if(!b)for(;G<Z;)U=S(),U<9e15&&(Q[G++]=U%1e14);for(Z=Q[--G],N%=Bt,Z&&N&&(U=Bo[Bt-N],Q[G]=rn(Z/U)*U);Q[G]===0;Q.pop(),G--);if(G<0)Q=[V=0];else{for(V=-1;Q[0]===0;Q.splice(0,1),V-=Bt);for(G=1,U=Q[0];U>=10;U/=10,G++);G<Bt&&(V-=Bt-G)}return X.e=V,X.c=Q,X}}(),M.sum=function(){for(var E=1,S=arguments,N=new M(S[0]);E<S.length;)N=N.plus(S[E++]);return N},r=function(){var E="0123456789";function S(N,B,D,V){for(var Z,U=[0],G,Q=0,X=N.length;Q<X;){for(G=U.length;G--;U[G]*=B);for(U[0]+=V.indexOf(N.charAt(Q++)),Z=0;Z<U.length;Z++)U[Z]>D-1&&(U[Z+1]==null&&(U[Z+1]=0),U[Z+1]+=U[Z]/D|0,U[Z]%=D)}return U.reverse()}return function(N,B,D,V,Z){var U,G,Q,X,nt,J,ot,ct,pt=N.indexOf("."),ht=m,ft=d;for(pt>=0&&(X=R,R=0,N=N.replace(".",""),ct=new M(B),J=ct.pow(N.length-pt),R=X,ct.c=S(Fn(en(J.c),J.e,"0"),10,D,E),ct.e=ct.c.length),ot=S(N,B,D,Z?(U=j,E):(U=E,j)),Q=X=ot.length;ot[--X]==0;ot.pop());if(!ot[0])return U.charAt(0);if(pt<0?--Q:(J.c=ot,J.e=Q,J.s=V,J=i(J,ct,ht,ft,D),ot=J.c,nt=J.r,Q=J.e),G=Q+ht+1,pt=ot[G],X=D/2,nt=nt||G<0||ot[G+1]!=null,nt=ft<4?(pt!=null||nt)&&(ft==0||ft==(J.s<0?3:2)):pt>X||pt==X&&(ft==4||nt||ft==6&&ot[G-1]&1||ft==(J.s<0?8:7)),G<1||!ot[0])N=nt?Fn(U.charAt(1),-ht,U.charAt(0)):U.charAt(0);else{if(ot.length=G,nt)for(--D;++ot[--G]>D;)ot[G]=0,G||(++Q,ot=[1].concat(ot));for(X=ot.length;!ot[--X];);for(pt=0,N="";pt<=X;N+=U.charAt(ot[pt++]));N=Fn(N,Q,U.charAt(0))}return N}}(),i=function(){function E(B,D,V){var Z,U,G,Q,X=0,nt=B.length,J=D%ii,ot=D/ii|0;for(B=B.slice();nt--;)G=B[nt]%ii,Q=B[nt]/ii|0,Z=ot*G+Q*J,U=J*G+Z%ii*ii+X,X=(U/V|0)+(Z/ii|0)+ot*Q,B[nt]=U%V;return X&&(B=[X].concat(B)),B}function S(B,D,V,Z){var U,G;if(V!=Z)G=V>Z?1:-1;else for(U=G=0;U<V;U++)if(B[U]!=D[U]){G=B[U]>D[U]?1:-1;break}return G}function N(B,D,V,Z){for(var U=0;V--;)B[V]-=U,U=B[V]<D[V]?1:0,B[V]=U*Z+B[V]-D[V];for(;!B[0]&&B.length>1;B.splice(0,1));}return function(B,D,V,Z,U){var G,Q,X,nt,J,ot,ct,pt,ht,ft,gt,kt,et,Vt,Ct,vt,Y,At=B.s==D.s?1:-1,Gt=B.c,Lt=D.c;if(!Gt||!Gt[0]||!Lt||!Lt[0])return new M(!B.s||!D.s||(Gt?Lt&&Gt[0]==Lt[0]:!Lt)?NaN:Gt&&Gt[0]==0||!Lt?At*0:At/0);for(pt=new M(At),ht=pt.c=[],Q=B.e-D.e,At=V+Q+1,U||(U=cn,Q=sn(B.e/Bt)-sn(D.e/Bt),At=At/Bt|0),X=0;Lt[X]==(Gt[X]||0);X++);if(Lt[X]>(Gt[X]||0)&&Q--,At<0)ht.push(1),nt=!0;else{for(Vt=Gt.length,vt=Lt.length,X=0,At+=2,J=rn(U/(Lt[0]+1)),J>1&&(Lt=E(Lt,J,U),Gt=E(Gt,J,U),vt=Lt.length,Vt=Gt.length),et=vt,ft=Gt.slice(0,vt),gt=ft.length;gt<vt;ft[gt++]=0);Y=Lt.slice(),Y=[0].concat(Y),Ct=Lt[0],Lt[1]>=U/2&&Ct++;do{if(J=0,G=S(Lt,ft,vt,gt),G<0){if(kt=ft[0],vt!=gt&&(kt=kt*U+(ft[1]||0)),J=rn(kt/Ct),J>1)for(J>=U&&(J=U-1),ot=E(Lt,J,U),ct=ot.length,gt=ft.length;S(ot,ft,ct,gt)==1;)J--,N(ot,vt<ct?Y:Lt,ct,U),ct=ot.length,G=1;else J==0&&(G=J=1),ot=Lt.slice(),ct=ot.length;if(ct<gt&&(ot=[0].concat(ot)),N(ft,ot,gt,U),gt=ft.length,G==-1)for(;S(Lt,ft,vt,gt)<1;)J++,N(ft,vt<gt?Y:Lt,gt,U),gt=ft.length}else G===0&&(J++,ft=[0]);ht[X++]=J,ft[0]?ft[gt++]=Gt[et]||0:(ft=[Gt[et]],gt=1)}while((et++<Vt||ft[0]!=null)&&At--);nt=ft[0]!=null,ht[0]||ht.splice(0,1)}if(U==cn){for(X=1,At=ht[0];At>=10;At/=10,X++);H(pt,V+(pt.e=X+Q*Bt-1)+1,Z,nt)}else pt.e=Q,pt.r=+nt;return pt}}();function q(E,S,N,B){var D,V,Z,U,G;if(N==null?N=d:ie(N,0,8),!E.c)return E.toString();if(D=E.c[0],Z=E.e,S==null)G=en(E.c),G=B==1||B==2&&(Z<=x||Z>=v)?zs(G,Z):Fn(G,Z,"0");else if(E=H(new M(E),S,N),V=E.e,G=en(E.c),U=G.length,B==1||B==2&&(S<=V||V<=x)){for(;U<S;G+="0",U++);G=zs(G,V)}else if(S-=Z+(B===2&&V>Z),G=Fn(G,V,"0"),V+1>U){if(--S>0)for(G+=".";S--;G+="0");}else if(S+=V-U,S>0)for(V+1==U&&(G+=".");S--;G+="0");return E.s<0&&D?"-"+G:G}function A(E,S){for(var N,B,D=1,V=new M(E[0]);D<E.length;D++)B=new M(E[D]),(!B.s||(N=Mi(V,B))===S||N===0&&V.s===S)&&(V=B);return V}function F(E,S,N){for(var B=1,D=S.length;!S[--D];S.pop());for(D=S[0];D>=10;D/=10,B++);return(N=B+N*Bt-1)>I?E.c=E.e=null:N<P?E.c=[E.e=0]:(E.e=N,E.c=S),E}a=function(){var E=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,N=/^\.([^.]+)$/,B=/^-?(Infinity|NaN)$/,D=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(V,Z,U,G){var Q,X=U?Z:Z.replace(D,"");if(B.test(X))V.s=isNaN(X)?null:X<0?-1:1;else{if(!U&&(X=X.replace(E,function(nt,J,ot){return Q=(ot=ot.toLowerCase())=="x"?16:ot=="b"?2:8,!G||G==Q?J:nt}),G&&(Q=G,X=X.replace(S,"$1").replace(N,"0.$1")),Z!=X))return new M(X,Q);if(M.DEBUG)throw Error(Be+"Not a"+(G?" base "+G:"")+" number: "+Z);V.s=null}V.c=V.e=null}}();function H(E,S,N,B){var D,V,Z,U,G,Q,X,nt=E.c,J=Bo;if(nt){t:{for(D=1,U=nt[0];U>=10;U/=10,D++);if(V=S-D,V<0)V+=Bt,Z=S,G=nt[Q=0],X=rn(G/J[D-Z-1]%10);else if(Q=Do((V+1)/Bt),Q>=nt.length)if(B){for(;nt.length<=Q;nt.push(0));G=X=0,D=1,V%=Bt,Z=V-Bt+1}else break t;else{for(G=U=nt[Q],D=1;U>=10;U/=10,D++);V%=Bt,Z=V-Bt+D,X=Z<0?0:rn(G/J[D-Z-1]%10)}if(B=B||S<0||nt[Q+1]!=null||(Z<0?G:G%J[D-Z-1]),B=N<4?(X||B)&&(N==0||N==(E.s<0?3:2)):X>5||X==5&&(N==4||B||N==6&&(V>0?Z>0?G/J[D-Z]:0:nt[Q-1])%10&1||N==(E.s<0?8:7)),S<1||!nt[0])return nt.length=0,B?(S-=E.e+1,nt[0]=J[(Bt-S%Bt)%Bt],E.e=-S||0):nt[0]=E.e=0,E;if(V==0?(nt.length=Q,U=1,Q--):(nt.length=Q+1,U=J[Bt-V],nt[Q]=Z>0?rn(G/J[D-Z]%J[Z])*U:0),B)for(;;)if(Q==0){for(V=1,Z=nt[0];Z>=10;Z/=10,V++);for(Z=nt[0]+=U,U=1;Z>=10;Z/=10,U++);V!=U&&(E.e++,nt[0]==cn&&(nt[0]=1));break}else{if(nt[Q]+=U,nt[Q]!=cn)break;nt[Q--]=0,U=1}for(V=nt.length;nt[--V]===0;nt.pop());}E.e>I?E.c=E.e=null:E.e<P&&(E.c=[E.e=0])}return E}function K(E){var S,N=E.e;return N===null?E.toString():(S=en(E.c),S=N<=x||N>=v?zs(S,N):Fn(S,N,"0"),E.s<0?"-"+S:S)}return l.absoluteValue=l.abs=function(){var E=new M(this);return E.s<0&&(E.s=1),E},l.comparedTo=function(E,S){return Mi(this,new M(E,S))},l.decimalPlaces=l.dp=function(E,S){var N,B,D,V=this;if(E!=null)return ie(E,0,ve),S==null?S=d:ie(S,0,8),H(new M(V),E+V.e+1,S);if(!(N=V.c))return null;if(B=((D=N.length-1)-sn(this.e/Bt))*Bt,D=N[D])for(;D%10==0;D/=10,B--);return B<0&&(B=0),B},l.dividedBy=l.div=function(E,S){return i(this,new M(E,S),m,d)},l.dividedToIntegerBy=l.idiv=function(E,S){return i(this,new M(E,S),0,1)},l.exponentiatedBy=l.pow=function(E,S){var N,B,D,V,Z,U,G,Q,X,nt=this;if(E=new M(E),E.c&&!E.isInteger())throw Error(Be+"Exponent not an integer: "+K(E));if(S!=null&&(S=new M(S)),U=E.e>14,!nt.c||!nt.c[0]||nt.c[0]==1&&!nt.e&&nt.c.length==1||!E.c||!E.c[0])return X=new M(Math.pow(+K(nt),U?E.s*(2-Bs(E)):+K(E))),S?X.mod(S):X;if(G=E.s<0,S){if(S.c?!S.c[0]:!S.s)return new M(NaN);B=!G&&nt.isInteger()&&S.isInteger(),B&&(nt=nt.mod(S))}else{if(E.e>9&&(nt.e>0||nt.e<-1||(nt.e==0?nt.c[0]>1||U&&nt.c[1]>=24e7:nt.c[0]<8e13||U&&nt.c[0]<=9999975e7)))return V=nt.s<0&&Bs(E)?-0:0,nt.e>-1&&(V=1/V),new M(G?1/V:V);R&&(V=Do(R/Bt+2))}for(U?(N=new M(.5),G&&(E.s=1),Q=Bs(E)):(D=Math.abs(+K(E)),Q=D%2),X=new M(g);;){if(Q){if(X=X.times(nt),!X.c)break;V?X.c.length>V&&(X.c.length=V):B&&(X=X.mod(S))}if(D){if(D=rn(D/2),D===0)break;Q=D%2}else if(E=E.times(N),H(E,E.e+1,1),E.e>14)Q=Bs(E);else{if(D=+K(E),D===0)break;Q=D%2}nt=nt.times(nt),V?nt.c&&nt.c.length>V&&(nt.c.length=V):B&&(nt=nt.mod(S))}return B?X:(G&&(X=g.div(X)),S?X.mod(S):V?H(X,R,d,Z):X)},l.integerValue=function(E){var S=new M(this);return E==null?E=d:ie(E,0,8),H(S,S.e+1,E)},l.isEqualTo=l.eq=function(E,S){return Mi(this,new M(E,S))===0},l.isFinite=function(){return!!this.c},l.isGreaterThan=l.gt=function(E,S){return Mi(this,new M(E,S))>0},l.isGreaterThanOrEqualTo=l.gte=function(E,S){return(S=Mi(this,new M(E,S)))===1||S===0},l.isInteger=function(){return!!this.c&&sn(this.e/Bt)>this.c.length-2},l.isLessThan=l.lt=function(E,S){return Mi(this,new M(E,S))<0},l.isLessThanOrEqualTo=l.lte=function(E,S){return(S=Mi(this,new M(E,S)))===-1||S===0},l.isNaN=function(){return!this.s},l.isNegative=function(){return this.s<0},l.isPositive=function(){return this.s>0},l.isZero=function(){return!!this.c&&this.c[0]==0},l.minus=function(E,S){var N,B,D,V,Z=this,U=Z.s;if(E=new M(E,S),S=E.s,!U||!S)return new M(NaN);if(U!=S)return E.s=-S,Z.plus(E);var G=Z.e/Bt,Q=E.e/Bt,X=Z.c,nt=E.c;if(!G||!Q){if(!X||!nt)return X?(E.s=-S,E):new M(nt?Z:NaN);if(!X[0]||!nt[0])return nt[0]?(E.s=-S,E):new M(X[0]?Z:d==3?-0:0)}if(G=sn(G),Q=sn(Q),X=X.slice(),U=G-Q){for((V=U<0)?(U=-U,D=X):(Q=G,D=nt),D.reverse(),S=U;S--;D.push(0));D.reverse()}else for(B=(V=(U=X.length)<(S=nt.length))?U:S,U=S=0;S<B;S++)if(X[S]!=nt[S]){V=X[S]<nt[S];break}if(V&&(D=X,X=nt,nt=D,E.s=-E.s),S=(B=nt.length)-(N=X.length),S>0)for(;S--;X[N++]=0);for(S=cn-1;B>U;){if(X[--B]<nt[B]){for(N=B;N&&!X[--N];X[N]=S);--X[N],X[B]+=cn}X[B]-=nt[B]}for(;X[0]==0;X.splice(0,1),--Q);return X[0]?F(E,X,Q):(E.s=d==3?-1:1,E.c=[E.e=0],E)},l.modulo=l.mod=function(E,S){var N,B,D=this;return E=new M(E,S),!D.c||!E.s||E.c&&!E.c[0]?new M(NaN):!E.c||D.c&&!D.c[0]?new M(D):(O==9?(B=E.s,E.s=1,N=i(D,E,0,3),E.s=B,N.s*=B):N=i(D,E,0,O),E=D.minus(N.times(E)),!E.c[0]&&O==1&&(E.s=D.s),E)},l.multipliedBy=l.times=function(E,S){var N,B,D,V,Z,U,G,Q,X,nt,J,ot,ct,pt,ht,ft=this,gt=ft.c,kt=(E=new M(E,S)).c;if(!gt||!kt||!gt[0]||!kt[0])return!ft.s||!E.s||gt&&!gt[0]&&!kt||kt&&!kt[0]&&!gt?E.c=E.e=E.s=null:(E.s*=ft.s,!gt||!kt?E.c=E.e=null:(E.c=[0],E.e=0)),E;for(B=sn(ft.e/Bt)+sn(E.e/Bt),E.s*=ft.s,G=gt.length,nt=kt.length,G<nt&&(ct=gt,gt=kt,kt=ct,D=G,G=nt,nt=D),D=G+nt,ct=[];D--;ct.push(0));for(pt=cn,ht=ii,D=nt;--D>=0;){for(N=0,J=kt[D]%ht,ot=kt[D]/ht|0,Z=G,V=D+Z;V>D;)Q=gt[--Z]%ht,X=gt[Z]/ht|0,U=ot*Q+X*J,Q=J*Q+U%ht*ht+ct[V]+N,N=(Q/pt|0)+(U/ht|0)+ot*X,ct[V--]=Q%pt;ct[V]=N}return N?++B:ct.splice(0,1),F(E,ct,B)},l.negated=function(){var E=new M(this);return E.s=-E.s||null,E},l.plus=function(E,S){var N,B=this,D=B.s;if(E=new M(E,S),S=E.s,!D||!S)return new M(NaN);if(D!=S)return E.s=-S,B.minus(E);var V=B.e/Bt,Z=E.e/Bt,U=B.c,G=E.c;if(!V||!Z){if(!U||!G)return new M(D/0);if(!U[0]||!G[0])return G[0]?E:new M(U[0]?B:D*0)}if(V=sn(V),Z=sn(Z),U=U.slice(),D=V-Z){for(D>0?(Z=V,N=G):(D=-D,N=U),N.reverse();D--;N.push(0));N.reverse()}for(D=U.length,S=G.length,D-S<0&&(N=G,G=U,U=N,S=D),D=0;S;)D=(U[--S]=U[S]+G[S]+D)/cn|0,U[S]=cn===U[S]?0:U[S]%cn;return D&&(U=[D].concat(U),++Z),F(E,U,Z)},l.precision=l.sd=function(E,S){var N,B,D,V=this;if(E!=null&&E!==!!E)return ie(E,1,ve),S==null?S=d:ie(S,0,8),H(new M(V),E,S);if(!(N=V.c))return null;if(D=N.length-1,B=D*Bt+1,D=N[D]){for(;D%10==0;D/=10,B--);for(D=N[0];D>=10;D/=10,B++);}return E&&V.e+1>B&&(B=V.e+1),B},l.shiftedBy=function(E){return ie(E,-Fo,Fo),this.times("1e"+E)},l.squareRoot=l.sqrt=function(){var E,S,N,B,D,V=this,Z=V.c,U=V.s,G=V.e,Q=m+4,X=new M("0.5");if(U!==1||!Z||!Z[0])return new M(!U||U<0&&(!Z||Z[0])?NaN:Z?V:1/0);if(U=Math.sqrt(+K(V)),U==0||U==1/0?(S=en(Z),(S.length+G)%2==0&&(S+="0"),U=Math.sqrt(+S),G=sn((G+1)/2)-(G<0||G%2),U==1/0?S="5e"+G:(S=U.toExponential(),S=S.slice(0,S.indexOf("e")+1)+G),N=new M(S)):N=new M(U+""),N.c[0]){for(G=N.e,U=G+Q,U<3&&(U=0);;)if(D=N,N=X.times(D.plus(i(V,D,Q,1))),en(D.c).slice(0,U)===(S=en(N.c)).slice(0,U))if(N.e<G&&--U,S=S.slice(U-3,U+1),S=="9999"||!B&&S=="4999"){if(!B&&(H(D,D.e+m+2,0),D.times(D).eq(V))){N=D;break}Q+=4,U+=4,B=1}else{(!+S||!+S.slice(1)&&S.charAt(0)=="5")&&(H(N,N.e+m+2,1),E=!N.times(N).eq(V));break}}return H(N,N.e+m+1,d,E)},l.toExponential=function(E,S){return E!=null&&(ie(E,0,ve),E++),q(this,E,S,1)},l.toFixed=function(E,S){return E!=null&&(ie(E,0,ve),E=E+this.e+1),q(this,E,S)},l.toFormat=function(E,S,N){var B,D=this;if(N==null)E!=null&&S&&typeof S=="object"?(N=S,S=null):E&&typeof E=="object"?(N=E,E=S=null):N=W;else if(typeof N!="object")throw Error(Be+"Argument not an object: "+N);if(B=D.toFixed(E,S),D.c){var V,Z=B.split("."),U=+N.groupSize,G=+N.secondaryGroupSize,Q=N.groupSeparator||"",X=Z[0],nt=Z[1],J=D.s<0,ot=J?X.slice(1):X,ct=ot.length;if(G&&(V=U,U=G,G=V,ct-=V),U>0&&ct>0){for(V=ct%U||U,X=ot.substr(0,V);V<ct;V+=U)X+=Q+ot.substr(V,U);G>0&&(X+=Q+ot.slice(V)),J&&(X="-"+X)}B=nt?X+(N.decimalSeparator||"")+((G=+N.fractionGroupSize)?nt.replace(new RegExp("\\d{"+G+"}\\B","g"),"$&"+(N.fractionGroupSeparator||"")):nt):X}return(N.prefix||"")+B+(N.suffix||"")},l.toFraction=function(E){var S,N,B,D,V,Z,U,G,Q,X,nt,J,ot=this,ct=ot.c;if(E!=null&&(U=new M(E),!U.isInteger()&&(U.c||U.s!==1)||U.lt(g)))throw Error(Be+"Argument "+(U.isInteger()?"out of range: ":"not an integer: ")+K(U));if(!ct)return new M(ot);for(S=new M(g),Q=N=new M(g),B=G=new M(g),J=en(ct),V=S.e=J.length-ot.e-1,S.c[0]=Bo[(Z=V%Bt)<0?Bt+Z:Z],E=!E||U.comparedTo(S)>0?V>0?S:Q:U,Z=I,I=1/0,U=new M(J),G.c[0]=0;X=i(U,S,0,1),D=N.plus(X.times(B)),D.comparedTo(E)!=1;)N=B,B=D,Q=G.plus(X.times(D=Q)),G=D,S=U.minus(X.times(D=S)),U=D;return D=i(E.minus(N),B,0,1),G=G.plus(D.times(Q)),N=N.plus(D.times(B)),G.s=Q.s=ot.s,V=V*2,nt=i(Q,B,V,d).minus(ot).abs().comparedTo(i(G,N,V,d).minus(ot).abs())<1?[Q,B]:[G,N],I=Z,nt},l.toNumber=function(){return+K(this)},l.toPrecision=function(E,S){return E!=null&&ie(E,1,ve),q(this,E,S,2)},l.toString=function(E){var S,N=this,B=N.s,D=N.e;return D===null?B?(S="Infinity",B<0&&(S="-"+S)):S="NaN":(E==null?S=D<=x||D>=v?zs(en(N.c),D):Fn(en(N.c),D,"0"):E===10&&st?(N=H(new M(N),m+D+1,d),S=Fn(en(N.c),N.e,"0")):(ie(E,2,j.length,"Base"),S=r(Fn(en(N.c),D,"0"),10,E,B,!0)),B<0&&N.c[0]&&(S="-"+S)),S},l.valueOf=l.toJSON=function(){return K(this)},l._isBigNumber=!0,l[Symbol.toStringTag]="BigNumber",l[Symbol.for("nodejs.util.inspect.custom")]=l.valueOf,h!=null&&M.set(h),M}function sn(h){var i=h|0;return h>0||h===i?i:i-1}function en(h){for(var i,r,a=1,l=h.length,g=h[0]+"";a<l;){for(i=h[a++]+"",r=Bt-i.length;r--;i="0"+i);g+=i}for(l=g.length;g.charCodeAt(--l)===48;);return g.slice(0,l+1||1)}function Mi(h,i){var r,a,l=h.c,g=i.c,m=h.s,d=i.s,x=h.e,v=i.e;if(!m||!d)return null;if(r=l&&!l[0],a=g&&!g[0],r||a)return r?a?0:-d:m;if(m!=d)return m;if(r=m<0,a=x==v,!l||!g)return a?0:!l^r?1:-1;if(!a)return x>v^r?1:-1;for(d=(x=l.length)<(v=g.length)?x:v,m=0;m<d;m++)if(l[m]!=g[m])return l[m]>g[m]^r?1:-1;return x==v?0:x>v^r?1:-1}function ie(h,i,r,a){if(h<i||h>r||h!==rn(h))throw Error(Be+(a||"Argument")+(typeof h=="number"?h<i||h>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(h))}function Bs(h){var i=h.c.length-1;return sn(h.e/Bt)==i&&h.c[i]%2!=0}function zs(h,i){return(h.length>1?h.charAt(0)+"."+h.slice(1):h)+(i<0?"e":"e+")+i}function Fn(h,i,r){var a,l;if(i<0){for(l=r+".";++i;l+=r);h=l+h}else if(a=h.length,++i>a){for(l=r,i-=a;--i;l+=r);h+=l}else i<a&&(h=h.slice(0,i)+"."+h.slice(i));return h}var Pn=Du(),Ch=class{constructor(h){at(this,"key"),at(this,"left",null),at(this,"right",null),this.key=h}},Vr=class extends Ch{constructor(h){super(h)}},bh=class{constructor(){at(this,"size",0),at(this,"modificationCount",0),at(this,"splayCount",0)}splay(h){const i=this.root;if(i==null)return this.compare(h,h),-1;let r=null,a=null,l=null,g=null,m=i;const d=this.compare;let x;for(;;)if(x=d(m.key,h),x>0){let v=m.left;if(v==null||(x=d(v.key,h),x>0&&(m.left=v.right,v.right=m,m=v,v=m.left,v==null)))break;r==null?a=m:r.left=m,r=m,m=v}else if(x<0){let v=m.right;if(v==null||(x=d(v.key,h),x<0&&(m.right=v.left,v.left=m,m=v,v=m.right,v==null)))break;l==null?g=m:l.right=m,l=m,m=v}else break;return l!=null&&(l.right=m.left,m.left=g),r!=null&&(r.left=m.right,m.right=a),this.root!==m&&(this.root=m,this.splayCount++),x}splayMin(h){let i=h,r=i.left;for(;r!=null;){const a=r;i.left=a.right,a.right=i,i=a,r=i.left}return i}splayMax(h){let i=h,r=i.right;for(;r!=null;){const a=r;i.right=a.left,a.left=i,i=a,r=i.right}return i}_delete(h){if(this.root==null||this.splay(h)!=0)return null;let r=this.root;const a=r,l=r.left;if(this.size--,l==null)this.root=r.right;else{const g=r.right;r=this.splayMax(l),r.right=g,this.root=r}return this.modificationCount++,a}addNewRoot(h,i){this.size++,this.modificationCount++;const r=this.root;if(r==null){this.root=h;return}i<0?(h.left=r,h.right=r.right,r.right=null):(h.right=r,h.left=r.left,r.left=null),this.root=h}_first(){const h=this.root;return h==null?null:(this.root=this.splayMin(h),this.root)}_last(){const h=this.root;return h==null?null:(this.root=this.splayMax(h),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(h){return this.validKey(h)&&this.splay(h)==0}defaultCompare(){return(h,i)=>h<i?-1:h>i?1:0}wrap(){return{getRoot:()=>this.root,setRoot:h=>{this.root=h},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:h=>{this.splayCount=h},splay:h=>this.splay(h),has:h=>this.has(h)}}},eo=class Qr extends bh{constructor(i,r){super(),at(this,"root",null),at(this,"compare"),at(this,"validKey"),at(this,ka,"[object Set]"),this.compare=i??this.defaultCompare(),this.validKey=r??(a=>a!=null&&a!=null)}delete(i){return this.validKey(i)?this._delete(i)!=null:!1}deleteAll(i){for(const r of i)this.delete(r)}forEach(i){const r=this[Symbol.iterator]();let a;for(;a=r.next(),!a.done;)i(a.value,a.value,this)}add(i){const r=this.splay(i);return r!=0&&this.addNewRoot(new Vr(i),r),this}addAndReturn(i){const r=this.splay(i);return r!=0&&this.addNewRoot(new Vr(i),r),this.root.key}addAll(i){for(const r of i)this.add(r)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(i){if(i==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(i)<0)return this.root.key;let a=this.root.left;if(a==null)return null;let l=a.right;for(;l!=null;)a=l,l=a.right;return a.key}firstAfter(i){if(i==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(i)>0)return this.root.key;let a=this.root.right;if(a==null)return null;let l=a.left;for(;l!=null;)a=l,l=a.left;return a.key}retainAll(i){const r=new Qr(this.compare,this.validKey),a=this.modificationCount;for(const l of i){if(a!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(l)&&this.splay(l)==0&&r.add(this.root.key)}r.size!=this.size&&(this.root=r.root,this.size=r.size,this.modificationCount++)}lookup(i){return!this.validKey(i)||this.splay(i)!=0?null:this.root.key}intersection(i){const r=new Qr(this.compare,this.validKey);for(const a of this)i.has(a)&&r.add(a);return r}difference(i){const r=new Qr(this.compare,this.validKey);for(const a of this)i.has(a)||r.add(a);return r}union(i){const r=this.clone();return r.addAll(i),r}clone(){const i=new Qr(this.compare,this.validKey);return i.size=this.size,i.root=this.copyNode(this.root),i}copyNode(i){if(i==null)return null;function r(l,g){let m,d;do{if(m=l.left,d=l.right,m!=null){const x=new Vr(m.key);g.left=x,r(m,x)}if(d!=null){const x=new Vr(d.key);g.right=x,l=d,g=x}}while(d!=null)}const a=new Vr(i.key);return r(i,a),a}toSet(){return this.clone()}entries(){return new Nh(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(wa=Symbol.iterator,ka=Symbol.toStringTag,wa)](){return new Th(this.wrap())}},Fu=class{constructor(h){at(this,"tree"),at(this,"path",new Array),at(this,"modificationCount",null),at(this,"splayCount"),this.tree=h,this.splayCount=h.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const h=this.path[this.path.length-1];return this.getValue(h)}rebuildPath(h){this.path.splice(0,this.path.length),this.tree.splay(h),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(h){for(;h!=null;)this.path.push(h),h=h.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let r=this.tree.getRoot();for(;r!=null;)this.path.push(r),r=r.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let h=this.path[this.path.length-1],i=h.right;if(i!=null){for(;i!=null;)this.path.push(i),i=i.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===h;)h=this.path.pop();return this.path.length>0}},Th=class extends Fu{getValue(h){return h.key}},Nh=class extends Fu{getValue(h){return[h.key,h.key]}},Bu=h=>()=>h,Vo=h=>{const i=h?(r,a)=>a.minus(r).abs().isLessThanOrEqualTo(h):Bu(!1);return(r,a)=>i(r,a)?0:r.comparedTo(a)};function Oh(h){const i=h?(r,a,l,g,m)=>r.exponentiatedBy(2).isLessThanOrEqualTo(g.minus(a).exponentiatedBy(2).plus(m.minus(l).exponentiatedBy(2)).times(h)):Bu(!1);return(r,a,l)=>{const g=r.x,m=r.y,d=l.x,x=l.y,v=m.minus(x).times(a.x.minus(d)).minus(g.minus(d).times(a.y.minus(x)));return i(v,g,m,d,x)?0:v.comparedTo(0)}}var Ah=h=>h,Rh=h=>{if(h){const i=new eo(Vo(h)),r=new eo(Vo(h)),a=(g,m)=>m.addAndReturn(g),l=g=>({x:a(g.x,i),y:a(g.y,r)});return l({x:new Pn(0),y:new Pn(0)}),l}return Ah},Wo=h=>({set:i=>{Un=Wo(i)},reset:()=>Wo(h),compare:Vo(h),snap:Rh(h),orient:Oh(h)}),Un=Wo(),Wr=(h,i)=>h.ll.x.isLessThanOrEqualTo(i.x)&&i.x.isLessThanOrEqualTo(h.ur.x)&&h.ll.y.isLessThanOrEqualTo(i.y)&&i.y.isLessThanOrEqualTo(h.ur.y),Ko=(h,i)=>{if(i.ur.x.isLessThan(h.ll.x)||h.ur.x.isLessThan(i.ll.x)||i.ur.y.isLessThan(h.ll.y)||h.ur.y.isLessThan(i.ll.y))return null;const r=h.ll.x.isLessThan(i.ll.x)?i.ll.x:h.ll.x,a=h.ur.x.isLessThan(i.ur.x)?h.ur.x:i.ur.x,l=h.ll.y.isLessThan(i.ll.y)?i.ll.y:h.ll.y,g=h.ur.y.isLessThan(i.ur.y)?h.ur.y:i.ur.y;return{ll:{x:r,y:l},ur:{x:a,y:g}}},Ks=(h,i)=>h.x.times(i.y).minus(h.y.times(i.x)),zu=(h,i)=>h.x.times(i.x).plus(h.y.times(i.y)),no=h=>zu(h,h).sqrt(),Dh=(h,i,r)=>{const a={x:i.x.minus(h.x),y:i.y.minus(h.y)},l={x:r.x.minus(h.x),y:r.y.minus(h.y)};return Ks(l,a).div(no(l)).div(no(a))},Fh=(h,i,r)=>{const a={x:i.x.minus(h.x),y:i.y.minus(h.y)},l={x:r.x.minus(h.x),y:r.y.minus(h.y)};return zu(l,a).div(no(l)).div(no(a))},Fa=(h,i,r)=>i.y.isZero()?null:{x:h.x.plus(i.x.div(i.y).times(r.minus(h.y))),y:r},Ba=(h,i,r)=>i.x.isZero()?null:{x:r,y:h.y.plus(i.y.div(i.x).times(r.minus(h.x)))},Bh=(h,i,r,a)=>{if(i.x.isZero())return Ba(r,a,h.x);if(a.x.isZero())return Ba(h,i,r.x);if(i.y.isZero())return Fa(r,a,h.y);if(a.y.isZero())return Fa(h,i,r.y);const l=Ks(i,a);if(l.isZero())return null;const g={x:r.x.minus(h.x),y:r.y.minus(h.y)},m=Ks(g,i).div(l),d=Ks(g,a).div(l),x=h.x.plus(d.times(i.x)),v=r.x.plus(m.times(a.x)),P=h.y.plus(d.times(i.y)),I=r.y.plus(m.times(a.y)),b=x.plus(v).div(2),O=P.plus(I).div(2);return{x:b,y:O}},En=class Gu{constructor(i,r){at(this,"point"),at(this,"isLeft"),at(this,"segment"),at(this,"otherSE"),at(this,"consumedBy"),i.events===void 0?i.events=[this]:i.events.push(this),this.point=i,this.isLeft=r}static compare(i,r){const a=Gu.comparePoints(i.point,r.point);return a!==0?a:(i.point!==r.point&&i.link(r),i.isLeft!==r.isLeft?i.isLeft?1:-1:io.compare(i.segment,r.segment))}static comparePoints(i,r){return i.x.isLessThan(r.x)?-1:i.x.isGreaterThan(r.x)?1:i.y.isLessThan(r.y)?-1:i.y.isGreaterThan(r.y)?1:0}link(i){if(i.point===this.point)throw new Error("Tried to link already linked events");const r=i.point.events;for(let a=0,l=r.length;a<l;a++){const g=r[a];this.point.events.push(g),g.point=this.point}this.checkForConsuming()}checkForConsuming(){const i=this.point.events.length;for(let r=0;r<i;r++){const a=this.point.events[r];if(a.segment.consumedBy===void 0)for(let l=r+1;l<i;l++){const g=this.point.events[l];g.consumedBy===void 0&&a.otherSE.point.events===g.otherSE.point.events&&a.segment.consume(g.segment)}}}getAvailableLinkedEvents(){const i=[];for(let r=0,a=this.point.events.length;r<a;r++){const l=this.point.events[r];l!==this&&!l.segment.ringOut&&l.segment.isInResult()&&i.push(l)}return i}getLeftmostComparator(i){const r=new Map,a=l=>{const g=l.otherSE;r.set(l,{sine:Dh(this.point,i.point,g.point),cosine:Fh(this.point,i.point,g.point)})};return(l,g)=>{r.has(l)||a(l),r.has(g)||a(g);const{sine:m,cosine:d}=r.get(l),{sine:x,cosine:v}=r.get(g);return m.isGreaterThanOrEqualTo(0)&&x.isGreaterThanOrEqualTo(0)?d.isLessThan(v)?1:d.isGreaterThan(v)?-1:0:m.isLessThan(0)&&x.isLessThan(0)?d.isLessThan(v)?-1:d.isGreaterThan(v)?1:0:x.isLessThan(m)?-1:x.isGreaterThan(m)?1:0}}},zh=class Jo{constructor(i){at(this,"events"),at(this,"poly"),at(this,"_isExteriorRing"),at(this,"_enclosingRing"),this.events=i;for(let r=0,a=i.length;r<a;r++)i[r].segment.ringOut=this;this.poly=null}static factory(i){const r=[];for(let a=0,l=i.length;a<l;a++){const g=i[a];if(!g.isInResult()||g.ringOut)continue;let m=null,d=g.leftSE,x=g.rightSE;const v=[d],P=d.point,I=[];for(;m=d,d=x,v.push(d),d.point!==P;)for(;;){const b=d.getAvailableLinkedEvents();if(b.length===0){const W=v[0].point,j=v[v.length-1].point;throw new Error(`Unable to complete output ring starting at [${W.x}, ${W.y}]. Last matching segment found ends at [${j.x}, ${j.y}].`)}if(b.length===1){x=b[0].otherSE;break}let O=null;for(let W=0,j=I.length;W<j;W++)if(I[W].point===d.point){O=W;break}if(O!==null){const W=I.splice(O)[0],j=v.splice(W.index);j.unshift(j[0].otherSE),r.push(new Jo(j.reverse()));continue}I.push({index:v.length,point:d.point});const R=d.getLeftmostComparator(m);x=b.sort(R)[0].otherSE;break}r.push(new Jo(v))}return r}getGeom(){let i=this.events[0].point;const r=[i];for(let v=1,P=this.events.length-1;v<P;v++){const I=this.events[v].point,b=this.events[v+1].point;Un.orient(I,i,b)!==0&&(r.push(I),i=I)}if(r.length===1)return null;const a=r[0],l=r[1];Un.orient(a,i,l)===0&&r.shift(),r.push(r[0]);const g=this.isExteriorRing()?1:-1,m=this.isExteriorRing()?0:r.length-1,d=this.isExteriorRing()?r.length:-1,x=[];for(let v=m;v!=d;v+=g)x.push([r[v].x.toNumber(),r[v].y.toNumber()]);return x}isExteriorRing(){if(this._isExteriorRing===void 0){const i=this.enclosingRing();this._isExteriorRing=i?!i.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var i,r;let a=this.events[0];for(let m=1,d=this.events.length;m<d;m++){const x=this.events[m];En.compare(a,x)>0&&(a=x)}let l=a.segment.prevInResult(),g=l?l.prevInResult():null;for(;;){if(!l)return null;if(!g)return l.ringOut;if(g.ringOut!==l.ringOut)return((i=g.ringOut)==null?void 0:i.enclosingRing())!==l.ringOut?l.ringOut:(r=l.ringOut)==null?void 0:r.enclosingRing();l=g.prevInResult(),g=l?l.prevInResult():null}}},za=class{constructor(h){at(this,"exteriorRing"),at(this,"interiorRings"),this.exteriorRing=h,h.poly=this,this.interiorRings=[]}addInterior(h){this.interiorRings.push(h),h.poly=this}getGeom(){const h=this.exteriorRing.getGeom();if(h===null)return null;const i=[h];for(let r=0,a=this.interiorRings.length;r<a;r++){const l=this.interiorRings[r].getGeom();l!==null&&i.push(l)}return i}},Gh=class{constructor(h){at(this,"rings"),at(this,"polys"),this.rings=h,this.polys=this._composePolys(h)}getGeom(){const h=[];for(let i=0,r=this.polys.length;i<r;i++){const a=this.polys[i].getGeom();a!==null&&h.push(a)}return h}_composePolys(h){var i;const r=[];for(let a=0,l=h.length;a<l;a++){const g=h[a];if(!g.poly)if(g.isExteriorRing())r.push(new za(g));else{const m=g.enclosingRing();m!=null&&m.poly||r.push(new za(m)),(i=m==null?void 0:m.poly)==null||i.addInterior(g)}}return r}},Hh=class{constructor(h,i=io.compare){at(this,"queue"),at(this,"tree"),at(this,"segments"),this.queue=h,this.tree=new eo(i),this.segments=[]}process(h){const i=h.segment,r=[];if(h.consumedBy)return h.isLeft?this.queue.delete(h.otherSE):this.tree.delete(i),r;h.isLeft&&this.tree.add(i);let a=i,l=i;do a=this.tree.lastBefore(a);while(a!=null&&a.consumedBy!=null);do l=this.tree.firstAfter(l);while(l!=null&&l.consumedBy!=null);if(h.isLeft){let g=null;if(a){const d=a.getIntersection(i);if(d!==null&&(i.isAnEndpoint(d)||(g=d),!a.isAnEndpoint(d))){const x=this._splitSafely(a,d);for(let v=0,P=x.length;v<P;v++)r.push(x[v])}}let m=null;if(l){const d=l.getIntersection(i);if(d!==null&&(i.isAnEndpoint(d)||(m=d),!l.isAnEndpoint(d))){const x=this._splitSafely(l,d);for(let v=0,P=x.length;v<P;v++)r.push(x[v])}}if(g!==null||m!==null){let d=null;g===null?d=m:m===null?d=g:d=En.comparePoints(g,m)<=0?g:m,this.queue.delete(i.rightSE),r.push(i.rightSE);const x=i.split(d);for(let v=0,P=x.length;v<P;v++)r.push(x[v])}r.length>0?(this.tree.delete(i),r.push(h)):(this.segments.push(i),i.prev=a)}else{if(a&&l){const g=a.getIntersection(l);if(g!==null){if(!a.isAnEndpoint(g)){const m=this._splitSafely(a,g);for(let d=0,x=m.length;d<x;d++)r.push(m[d])}if(!l.isAnEndpoint(g)){const m=this._splitSafely(l,g);for(let d=0,x=m.length;d<x;d++)r.push(m[d])}}}this.tree.delete(i)}return r}_splitSafely(h,i){this.tree.delete(h);const r=h.rightSE;this.queue.delete(r);const a=h.split(i);return a.push(r),h.consumedBy===void 0&&this.tree.add(h),a}},qh=class{constructor(){at(this,"type"),at(this,"numMultiPolys")}run(h,i,r){ts.type=h;const a=[new Ha(i,!0)];for(let v=0,P=r.length;v<P;v++)a.push(new Ha(r[v],!1));if(ts.numMultiPolys=a.length,ts.type==="difference"){const v=a[0];let P=1;for(;P<a.length;)Ko(a[P].bbox,v.bbox)!==null?P++:a.splice(P,1)}if(ts.type==="intersection")for(let v=0,P=a.length;v<P;v++){const I=a[v];for(let b=v+1,O=a.length;b<O;b++)if(Ko(I.bbox,a[b].bbox)===null)return[]}const l=new eo(En.compare);for(let v=0,P=a.length;v<P;v++){const I=a[v].getSweepEvents();for(let b=0,O=I.length;b<O;b++)l.add(I[b])}const g=new Hh(l);let m=null;for(l.size!=0&&(m=l.first(),l.delete(m));m;){const v=g.process(m);for(let P=0,I=v.length;P<I;P++){const b=v[P];b.consumedBy===void 0&&l.add(b)}l.size!=0?(m=l.first(),l.delete(m)):m=null}Un.reset();const d=zh.factory(g.segments);return new Gh(d).getGeom()}},ts=new qh,ls=ts,Zh=0,io=class Js{constructor(i,r,a,l){at(this,"id"),at(this,"leftSE"),at(this,"rightSE"),at(this,"rings"),at(this,"windings"),at(this,"ringOut"),at(this,"consumedBy"),at(this,"prev"),at(this,"_prevInResult"),at(this,"_beforeState"),at(this,"_afterState"),at(this,"_isInResult"),this.id=++Zh,this.leftSE=i,i.segment=this,i.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=i,this.rings=a,this.windings=l}static compare(i,r){const a=i.leftSE.point.x,l=r.leftSE.point.x,g=i.rightSE.point.x,m=r.rightSE.point.x;if(m.isLessThan(a))return 1;if(g.isLessThan(l))return-1;const d=i.leftSE.point.y,x=r.leftSE.point.y,v=i.rightSE.point.y,P=r.rightSE.point.y;if(a.isLessThan(l)){if(x.isLessThan(d)&&x.isLessThan(v))return 1;if(x.isGreaterThan(d)&&x.isGreaterThan(v))return-1;const I=i.comparePoint(r.leftSE.point);if(I<0)return 1;if(I>0)return-1;const b=r.comparePoint(i.rightSE.point);return b!==0?b:-1}if(a.isGreaterThan(l)){if(d.isLessThan(x)&&d.isLessThan(P))return-1;if(d.isGreaterThan(x)&&d.isGreaterThan(P))return 1;const I=r.comparePoint(i.leftSE.point);if(I!==0)return I;const b=i.comparePoint(r.rightSE.point);return b<0?1:b>0?-1:1}if(d.isLessThan(x))return-1;if(d.isGreaterThan(x))return 1;if(g.isLessThan(m)){const I=r.comparePoint(i.rightSE.point);if(I!==0)return I}if(g.isGreaterThan(m)){const I=i.comparePoint(r.rightSE.point);if(I<0)return 1;if(I>0)return-1}if(!g.eq(m)){const I=v.minus(d),b=g.minus(a),O=P.minus(x),R=m.minus(l);if(I.isGreaterThan(b)&&O.isLessThan(R))return 1;if(I.isLessThan(b)&&O.isGreaterThan(R))return-1}return g.isGreaterThan(m)?1:g.isLessThan(m)||v.isLessThan(P)?-1:v.isGreaterThan(P)?1:i.id<r.id?-1:i.id>r.id?1:0}static fromRing(i,r,a){let l,g,m;const d=En.comparePoints(i,r);if(d<0)l=i,g=r,m=1;else if(d>0)l=r,g=i,m=-1;else throw new Error(`Tried to create degenerate segment at [${i.x}, ${i.y}]`);const x=new En(l,!0),v=new En(g,!1);return new Js(x,v,[a],[m])}replaceRightSE(i){this.rightSE=i,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const i=this.leftSE.point.y,r=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:i.isLessThan(r)?i:r},ur:{x:this.rightSE.point.x,y:i.isGreaterThan(r)?i:r}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(i){return i.x.eq(this.leftSE.point.x)&&i.y.eq(this.leftSE.point.y)||i.x.eq(this.rightSE.point.x)&&i.y.eq(this.rightSE.point.y)}comparePoint(i){return Un.orient(this.leftSE.point,i,this.rightSE.point)}getIntersection(i){const r=this.bbox(),a=i.bbox(),l=Ko(r,a);if(l===null)return null;const g=this.leftSE.point,m=this.rightSE.point,d=i.leftSE.point,x=i.rightSE.point,v=Wr(r,d)&&this.comparePoint(d)===0,P=Wr(a,g)&&i.comparePoint(g)===0,I=Wr(r,x)&&this.comparePoint(x)===0,b=Wr(a,m)&&i.comparePoint(m)===0;if(P&&v)return b&&!I?m:!b&&I?x:null;if(P)return I&&g.x.eq(x.x)&&g.y.eq(x.y)?null:g;if(v)return b&&m.x.eq(d.x)&&m.y.eq(d.y)?null:d;if(b&&I)return null;if(b)return m;if(I)return x;const O=Bh(g,this.vector(),d,i.vector());return O===null||!Wr(l,O)?null:Un.snap(O)}split(i){const r=[],a=i.events!==void 0,l=new En(i,!0),g=new En(i,!1),m=this.rightSE;this.replaceRightSE(g),r.push(g),r.push(l);const d=new Js(l,m,this.rings.slice(),this.windings.slice());return En.comparePoints(d.leftSE.point,d.rightSE.point)>0&&d.swapEvents(),En.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),a&&(l.checkForConsuming(),g.checkForConsuming()),r}swapEvents(){const i=this.rightSE;this.rightSE=this.leftSE,this.leftSE=i,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let r=0,a=this.windings.length;r<a;r++)this.windings[r]*=-1}consume(i){let r=this,a=i;for(;r.consumedBy;)r=r.consumedBy;for(;a.consumedBy;)a=a.consumedBy;const l=Js.compare(r,a);if(l!==0){if(l>0){const g=r;r=a,a=g}if(r.prev===a){const g=r;r=a,a=g}for(let g=0,m=a.rings.length;g<m;g++){const d=a.rings[g],x=a.windings[g],v=r.rings.indexOf(d);v===-1?(r.rings.push(d),r.windings.push(x)):r.windings[v]+=x}a.rings=null,a.windings=null,a.consumedBy=r,a.leftSE.consumedBy=r.leftSE,a.rightSE.consumedBy=r.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const i=this.prev.consumedBy||this.prev;this._beforeState=i.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const i=this.beforeState();this._afterState={rings:i.rings.slice(0),windings:i.windings.slice(0),multiPolys:[]};const r=this._afterState.rings,a=this._afterState.windings,l=this._afterState.multiPolys;for(let d=0,x=this.rings.length;d<x;d++){const v=this.rings[d],P=this.windings[d],I=r.indexOf(v);I===-1?(r.push(v),a.push(P)):a[I]+=P}const g=[],m=[];for(let d=0,x=r.length;d<x;d++){if(a[d]===0)continue;const v=r[d],P=v.poly;if(m.indexOf(P)===-1)if(v.isExterior)g.push(P);else{m.indexOf(P)===-1&&m.push(P);const I=g.indexOf(v.poly);I!==-1&&g.splice(I,1)}}for(let d=0,x=g.length;d<x;d++){const v=g[d].multiPoly;l.indexOf(v)===-1&&l.push(v)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const i=this.beforeState().multiPolys,r=this.afterState().multiPolys;switch(ls.type){case"union":{const a=i.length===0,l=r.length===0;this._isInResult=a!==l;break}case"intersection":{let a,l;i.length<r.length?(a=i.length,l=r.length):(a=r.length,l=i.length),this._isInResult=l===ls.numMultiPolys&&a<l;break}case"xor":{const a=Math.abs(i.length-r.length);this._isInResult=a%2===1;break}case"difference":{const a=l=>l.length===1&&l[0].isSubject;this._isInResult=a(i)!==a(r);break}}return this._isInResult}},Ga=class{constructor(h,i,r){if(at(this,"poly"),at(this,"isExterior"),at(this,"segments"),at(this,"bbox"),!Array.isArray(h)||h.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=i,this.isExterior=r,this.segments=[],typeof h[0][0]!="number"||typeof h[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const a=Un.snap({x:new Pn(h[0][0]),y:new Pn(h[0][1])});this.bbox={ll:{x:a.x,y:a.y},ur:{x:a.x,y:a.y}};let l=a;for(let g=1,m=h.length;g<m;g++){if(typeof h[g][0]!="number"||typeof h[g][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const d=Un.snap({x:new Pn(h[g][0]),y:new Pn(h[g][1])});d.x.eq(l.x)&&d.y.eq(l.y)||(this.segments.push(io.fromRing(l,d,this)),d.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=d.x),d.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=d.y),d.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=d.x),d.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=d.y),l=d)}(!a.x.eq(l.x)||!a.y.eq(l.y))&&this.segments.push(io.fromRing(l,a,this))}getSweepEvents(){const h=[];for(let i=0,r=this.segments.length;i<r;i++){const a=this.segments[i];h.push(a.leftSE),h.push(a.rightSE)}return h}},Uh=class{constructor(h,i){if(at(this,"multiPoly"),at(this,"exteriorRing"),at(this,"interiorRings"),at(this,"bbox"),!Array.isArray(h))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ga(h[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let r=1,a=h.length;r<a;r++){const l=new Ga(h[r],this,!1);l.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=l.bbox.ll.x),l.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=l.bbox.ll.y),l.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=l.bbox.ur.x),l.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=l.bbox.ur.y),this.interiorRings.push(l)}this.multiPoly=i}getSweepEvents(){const h=this.exteriorRing.getSweepEvents();for(let i=0,r=this.interiorRings.length;i<r;i++){const a=this.interiorRings[i].getSweepEvents();for(let l=0,g=a.length;l<g;l++)h.push(a[l])}return h}},Ha=class{constructor(h,i){if(at(this,"isSubject"),at(this,"polys"),at(this,"bbox"),!Array.isArray(h))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof h[0][0][0]=="number"&&(h=[h])}catch{}this.polys=[],this.bbox={ll:{x:new Pn(Number.POSITIVE_INFINITY),y:new Pn(Number.POSITIVE_INFINITY)},ur:{x:new Pn(Number.NEGATIVE_INFINITY),y:new Pn(Number.NEGATIVE_INFINITY)}};for(let r=0,a=h.length;r<a;r++){const l=new Uh(h[r],this);l.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=l.bbox.ll.x),l.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=l.bbox.ll.y),l.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=l.bbox.ur.x),l.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=l.bbox.ur.y),this.polys.push(l)}this.isSubject=i}getSweepEvents(){const h=[];for(let i=0,r=this.polys.length;i<r;i++){const a=this.polys[i].getSweepEvents();for(let l=0,g=a.length;l<g;l++)h.push(a[l])}return h}},Yh=(h,...i)=>ls.run("union",h,i),Xh=(h,...i)=>ls.run("intersection",h,i),Vh=(h,...i)=>ls.run("difference",h,i);Un.set;function Wh(h,i={}){const r=[];if(oi(h,l=>{r.push(l.coordinates)}),r.length<2)throw new Error("Must have at least 2 geometries");const a=Yh(r[0],...r.slice(1));return a.length===0?null:a.length===1?Zn(a[0],i.properties):fo(a,i.properties)}var Kh=Wh;function Jh(h,i={}){const r=[];if(oi(h,l=>{r.push(l.coordinates)}),r.length<2)throw new Error("Must specify at least 2 geometries");const a=Xh(r[0],...r.slice(1));return a.length===0?null:a.length===1?Zn(a[0],i.properties):fo(a,i.properties)}var qa=Jh;function $h(h){const i=[];if(oi(h,l=>{i.push(l.coordinates)}),i.length<2)throw new Error("Must have at least two features");const r=h.features[0].properties||{},a=Vh(i[0],...i.slice(1));return a.length===0?null:a.length===1?Zn(a[0],r):fo(a,r)}var jh=$h;function Qh(h){const i=[];return h.type==="FeatureCollection"?si(h,function(r){Gn(r,function(a){i.push(zn(a,r.properties))})}):h.type==="Feature"?Gn(h,function(r){i.push(zn(r,h.properties))}):Gn(h,function(r){i.push(zn(r))}),In(i)}var ir=Qh;function hr(h,i={}){if(h.bbox!=null&&i.recompute!==!0)return h.bbox;const r=[1/0,1/0,-1/0,-1/0];return Gn(h,a=>{r[0]>a[0]&&(r[0]=a[0]),r[1]>a[1]&&(r[1]=a[1]),r[2]<a[0]&&(r[2]=a[0]),r[3]<a[1]&&(r[3]=a[1])}),r}function tc(h,i={}){const r=hr(h),a=(r[0]+r[2])/2,l=(r[1]+r[3])/2;return zn([a,l],i.properties,i)}var $s={exports:{}},ec=$s.exports,Za;function nc(){return Za||(Za=1,function(h,i){(function(r,a){h.exports=a()})(ec,function(){function r(o,t){(t==null||t>o.length)&&(t=o.length);for(var e=0,s=Array(t);e<t;e++)s[e]=o[e];return s}function a(o,t,e){return t=P(t),function(s,c){if(c&&(typeof c=="object"||typeof c=="function"))return c;if(c!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}(s)}(o,b()?Reflect.construct(t,e||[],P(o).constructor):t.apply(o,e))}function l(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}function g(o,t,e){if(b())return Reflect.construct.apply(null,arguments);var s=[null];s.push.apply(s,t);var c=new(o.bind.apply(o,s));return e&&O(c,e.prototype),c}function m(o,t){for(var e=0;e<t.length;e++){var s=t[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(o,j(s.key),s)}}function d(o,t,e){return t&&m(o.prototype,t),e&&m(o,e),Object.defineProperty(o,"prototype",{writable:!1}),o}function x(o,t){var e=typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(!e){if(Array.isArray(o)||(e=st(o))||t){e&&(o=e);var s=0,c=function(){};return{s:c,n:function(){return s>=o.length?{done:!0}:{done:!1,value:o[s++]}},e:function(C){throw C},f:c}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p,_=!0,w=!1;return{s:function(){e=e.call(o)},n:function(){var C=e.next();return _=C.done,C},e:function(C){w=!0,p=C},f:function(){try{_||e.return==null||e.return()}finally{if(w)throw p}}}}function v(){return v=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(o,t,e){var s=function(p,_){for(;!{}.hasOwnProperty.call(p,_)&&(p=P(p))!==null;);return p}(o,t);if(s){var c=Object.getOwnPropertyDescriptor(s,t);return c.get?c.get.call(arguments.length<3?o:e):c.value}},v.apply(null,arguments)}function P(o){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},P(o)}function I(o,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(t&&t.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),t&&O(o,t)}function b(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(b=function(){return!!o})()}function O(o,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,s){return e.__proto__=s,e},O(o,t)}function R(o,t,e,s){var c=v(P(1&s?o.prototype:o),t,e);return 2&s&&typeof c=="function"?function(p){return c.apply(e,p)}:c}function W(o){return function(t){if(Array.isArray(t))return r(t)}(o)||function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(o)||st(o)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function j(o){var t=function(e,s){if(typeof e!="object"||!e)return e;var c=e[Symbol.toPrimitive];if(c!==void 0){var p=c.call(e,s);if(typeof p!="object")return p;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o,"string");return typeof t=="symbol"?t:t+""}function st(o,t){if(o){if(typeof o=="string")return r(o,t);var e={}.toString.call(o).slice(8,-1);return e==="Object"&&o.constructor&&(e=o.constructor.name),e==="Map"||e==="Set"?Array.from(o):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(o,t):void 0}}function M(o){var t=typeof Map=="function"?new Map:void 0;return M=function(e){if(e===null||!function(c){try{return Function.toString.call(c).indexOf("[native code]")!==-1}catch{return typeof c=="function"}}(e))return e;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(e))return t.get(e);t.set(e,s)}function s(){return g(e,arguments,P(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),O(s,e)},M(o)}var q=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(t){this._quadrantSegments=t,this._quadrantSegments===0&&(this._joinStyle=o.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=o.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==o.JOIN_ROUND&&(this._quadrantSegments=o.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(t){this._joinStyle=t}},{key:"setSimplifyFactor",value:function(t){this._simplifyFactor=t<0?0:t}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(t){this._endCapStyle=t}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(t){this._mitreLimit=t}},{key:"setSingleSided",value:function(t){this._isSingleSided=t}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=o.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=o.CAP_ROUND,this._joinStyle=o.JOIN_ROUND,this._mitreLimit=o.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=o.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setQuadrantSegments(t)}else if(arguments.length===2){var e=arguments[0],s=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(s)}else if(arguments.length===4){var c=arguments[0],p=arguments[1],_=arguments[2],w=arguments[3];this.setQuadrantSegments(c),this.setEndCapStyle(p),this.setJoinStyle(_),this.setMitreLimit(w)}}}},{key:"bufferDistanceError",value:function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)}}])}();q.CAP_ROUND=1,q.CAP_FLAT=2,q.CAP_SQUARE=3,q.JOIN_ROUND=1,q.JOIN_MITRE=2,q.JOIN_BEVEL=3,q.DEFAULT_QUADRANT_SEGMENTS=8,q.DEFAULT_MITRE_LIMIT=5,q.DEFAULT_SIMPLIFY_FACTOR=.01;var A=function(o){function t(e){var s;return l(this,t),(s=a(this,t,[e])).name=Object.keys({Exception:t})[0],s}return I(t,o),d(t,[{key:"toString",value:function(){return this.message}}])}(M(Error)),F=function(o){function t(e){var s;return l(this,t),(s=a(this,t,[e])).name=Object.keys({IllegalArgumentException:t})[0],s}return I(t,o),d(t)}(A),H=function(){return d(function o(){l(this,o)},[{key:"filter",value:function(o){}}])}();function K(){}function E(){}function S(){}var N,B,D,V,Z,U,G,Q,X=function(){return d(function o(){l(this,o)},null,[{key:"equalsWithTolerance",value:function(o,t,e){return Math.abs(o-t)<=e}}])}(),nt=function(){return d(function o(t,e){l(this,o),this.low=e||0,this.high=t||0},null,[{key:"toBinaryString",value:function(o){var t,e="";for(t=2147483648;t>0;t>>>=1)e+=(o.high&t)===t?"1":"0";for(t=2147483648;t>0;t>>>=1)e+=(o.low&t)===t?"1":"0";return e}}])}();function J(){}function ot(){}J.NaN=NaN,J.isNaN=function(o){return Number.isNaN(o)},J.isInfinite=function(o){return!Number.isFinite(o)},J.MAX_VALUE=Number.MAX_VALUE,J.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,J.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(U=2146435072,G=new Float64Array(1),Q=new Int32Array(G.buffer),J.doubleToLongBits=function(o){G[0]=o;var t=0|Q[0],e=0|Q[1];return(e&U)===U&&1048575&e&&t!==0&&(t=0,e=2146959360),new nt(e,t)},J.longBitsToDouble=function(o){return Q[0]=o.low,Q[1]=o.high,G[0]}):(N=1023,B=Math.log2,D=Math.floor,V=Math.pow,Z=function(){for(var o=53;o>0;o--){var t=V(2,o)-1;if(D(B(t))+1===o)return t}return 0}(),J.doubleToLongBits=function(o){var t,e,s,c,p,_,w,C,z;if(o<0||1/o===Number.NEGATIVE_INFINITY?(_=1<<31,o=-o):_=0,o===0)return new nt(C=_,z=0);if(o===1/0)return new nt(C=2146435072|_,z=0);if(o!=o)return new nt(C=2146959360,z=0);if(c=0,z=0,(t=D(o))>1)if(t<=Z)(c=D(B(t)))<=20?(z=0,C=t<<20-c&1048575):(z=t%(e=V(2,s=c-20))<<32-s,C=t/e&1048575);else for(s=t,z=0;(s=D(e=s/2))!==0;)c++,z>>>=1,z|=(1&C)<<31,C>>>=1,e!==s&&(C|=524288);if(w=c+N,p=t===0,t=o-t,c<52&&t!==0)for(s=0;;){if((e=2*t)>=1?(t=e-1,p?(w--,p=!1):(s<<=1,s|=1,c++)):(t=e,p?--w==0&&(c++,p=!1):(s<<=1,c++)),c===20)C|=s,s=0;else if(c===52){z|=s;break}if(e===1){c<20?C|=s<<20-c:c<52&&(z|=s<<52-c);break}}return C|=w<<20,new nt(C|=_,z)},J.longBitsToDouble=function(o){var t,e,s,c,p=o.high,_=o.low,w=p&1<<31?-1:1;for(s=((2146435072&p)>>20)-N,c=0,e=1<<19,t=1;t<=20;t++)p&e&&(c+=V(2,-t)),e>>>=1;for(e=1<<31,t=21;t<=52;t++)_&e&&(c+=V(2,-t)),e>>>=1;if(s===-1023){if(c===0)return 0*w;s=-1022}else{if(s===1024)return c===0?w/0:NaN;c+=1}return w*c*V(2,s)});var ct=function(o){function t(e){var s;return l(this,t),(s=a(this,t,[e])).name=Object.keys({RuntimeException:t})[0],s}return I(t,o),d(t)}(A),pt=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,null,[{key:"constructor_",value:function(){if(arguments.length===0)ct.constructor_.call(this);else if(arguments.length===1){var e=arguments[0];ct.constructor_.call(this,e)}}}])}(ct),ht=function(){function o(){l(this,o)}return d(o,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)o.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new pt("Should never reach here"+(t!==null?": "+t:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var t=arguments[0];o.isTrue(t,null)}else if(arguments.length===2){var e=arguments[1];if(!arguments[0])throw e===null?new pt:new pt(e)}}},{key:"equals",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];o.equals(t,e,null)}else if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2];if(!c.equals(s))throw new pt("Expected "+s+" but encountered "+c+(p!==null?": "+p:""))}}}])}(),ft=new ArrayBuffer(8),gt=new Float64Array(ft),kt=new Int32Array(ft),et=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"getM",value:function(){return J.NaN}},{key:"setOrdinate",value:function(t,e){switch(t){case o.X:this.x=e;break;case o.Y:this.y=e;break;case o.Z:this.setZ(e);break;default:throw new F("Invalid ordinate index: "+t)}}},{key:"equals2D",value:function(){if(arguments.length===1){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(arguments.length===2){var e=arguments[0],s=arguments[1];return!!X.equalsWithTolerance(this.x,e.x,s)&&!!X.equalsWithTolerance(this.y,e.y,s)}}},{key:"setM",value:function(t){throw new F("Invalid ordinate index: "+o.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(t){switch(t){case o.X:return this.x;case o.Y:return this.y;case o.Z:return this.getZ()}throw new F("Invalid ordinate index: "+t)}},{key:"equals3D",value:function(t){return this.x===t.x&&this.y===t.y&&(this.getZ()===t.getZ()||J.isNaN(this.getZ())&&J.isNaN(t.getZ()))}},{key:"equals",value:function(t){return t instanceof o&&this.equals2D(t)}},{key:"equalInZ",value:function(t,e){return X.equalsWithTolerance(this.getZ(),t.getZ(),e)}},{key:"setX",value:function(t){this.x=t}},{key:"compareTo",value:function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(t){this.z=t}},{key:"clone",value:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return ht.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}},{key:"copy",value:function(){return new o(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(t){var e=this.x-t.x,s=this.y-t.y,c=this.getZ()-t.getZ();return Math.sqrt(e*e+s*s+c*c)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(t){this.y=t}},{key:"distance",value:function(t){var e=this.x-t.x,s=this.y-t.y;return Math.sqrt(e*e+s*s)}},{key:"hashCode",value:function(){var t=17;return t=37*(t=37*t+o.hashCode(this.x))+o.hashCode(this.y)}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}},{key:"interfaces_",get:function(){return[K,E,S]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)o.constructor_.call(this,0,0);else if(arguments.length===1){var t=arguments[0];o.constructor_.call(this,t.x,t.y,t.getZ())}else if(arguments.length===2){var e=arguments[0],s=arguments[1];o.constructor_.call(this,e,s,o.NULL_ORDINATE)}else if(arguments.length===3){var c=arguments[0],p=arguments[1],_=arguments[2];this.x=c,this.y=p,this.z=_}}},{key:"hashCode",value:function(t){return gt[0]=t,kt[0]^kt[1]}}])}(),Vt=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"compare",value:function(t,e){var s=o.compare(t.x,e.x);if(s!==0)return s;var c=o.compare(t.y,e.y);return c!==0?c:this._dimensionsToTest<=2?0:o.compare(t.getZ(),e.getZ())}},{key:"interfaces_",get:function(){return[ot]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)o.constructor_.call(this,2);else if(arguments.length===1){var t=arguments[0];if(t!==2&&t!==3)throw new F("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}},{key:"compare",value:function(t,e){return t<e?-1:t>e?1:J.isNaN(t)?J.isNaN(e)?0:-1:J.isNaN(e)?1:0}}])}();et.DimensionalComparator=Vt,et.NULL_ORDINATE=J.NaN,et.X=0,et.Y=1,et.Z=2,et.M=3;var Ct=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(t){if(!(t instanceof o))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()}},{key:"intersection",value:function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new o;var e=this._minx>t._minx?this._minx:t._minx,s=this._miny>t._miny?this._miny:t._miny;return new o(e,this._maxx<t._maxx?this._maxx:t._maxx,s,this._maxy<t._maxy?this._maxy:t._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof et){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof o){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];return!this.isNull()&&s>=this._minx&&s<=this._maxx&&c>=this._miny&&c<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof o){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof et){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(arguments.length===2){if(arguments[0]instanceof et&&arguments[1]instanceof et){var s=arguments[0],c=arguments[1];return!this.isNull()&&!((s.x<c.x?s.x:c.x)>this._maxx)&&!((s.x>c.x?s.x:c.x)<this._minx)&&!((s.y<c.y?s.y:c.y)>this._maxy)&&!((s.y>c.y?s.y:c.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var p=arguments[0],_=arguments[1];return!this.isNull()&&!(p>this._maxx||p<this._minx||_>this._maxy||_<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return Math.sqrt(t*t+e*e)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof et){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof o){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.isNull()?(this._minx=s,this._maxx=s,this._miny=c,this._maxy=c):(s<this._minx&&(this._minx=s),s>this._maxx&&(this._maxx=s),c<this._miny&&(this._miny=c),c>this._maxy&&(this._maxy=c))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}},{key:"translate",value:function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}},{key:"copy",value:function(){return new o(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(t){return!(!this.isNull()&&!t.isNull())||t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e}},{key:"expandBy",value:function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var e=arguments[0],s=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=s,this._maxy+=s,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof o){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof et){var e=arguments[0];return this.covers(e)}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];return this.covers(s,c)}}},{key:"centre",value:function(){return this.isNull()?null:new et((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof et){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof o){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.init(s.x,c.x,s.y,c.y)}else if(arguments.length===4){var p=arguments[0],_=arguments[1],w=arguments[2],C=arguments[3];p<_?(this._minx=p,this._maxx=_):(this._minx=_,this._maxx=p),w<C?(this._miny=w,this._maxy=C):(this._miny=C,this._maxy=w)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var s=0;return this._maxy<t._miny?s=t._miny-this._maxy:this._miny>t._maxy&&(s=this._miny-t._maxy),e===0?s:s===0?e:Math.sqrt(e*e+s*s)}},{key:"hashCode",value:function(){var t=17;return t=37*(t=37*(t=37*(t=37*t+et.hashCode(this._minx))+et.hashCode(this._maxx))+et.hashCode(this._miny))+et.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[K,S]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof et){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof o){var e=arguments[0];this.init(e)}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.init(s.x,c.x,s.y,c.y)}else if(arguments.length===4){var p=arguments[0],_=arguments[1],w=arguments[2],C=arguments[3];this.init(p,_,w,C)}}},{key:"intersects",value:function(){if(arguments.length===3){var t=arguments[0],e=arguments[1],s=arguments[2];return s.x>=(t.x<e.x?t.x:e.x)&&s.x<=(t.x>e.x?t.x:e.x)&&s.y>=(t.y<e.y?t.y:e.y)&&s.y<=(t.y>e.y?t.y:e.y)}if(arguments.length===4){var c=arguments[0],p=arguments[1],_=arguments[2],w=arguments[3],C=Math.min(_.x,w.x),z=Math.max(_.x,w.x),tt=Math.min(c.x,p.x),it=Math.max(c.x,p.x);return!(tt>z)&&!(it<C)&&(C=Math.min(_.y,w.y),z=Math.max(_.y,w.y),tt=Math.min(c.y,p.y),it=Math.max(c.y,p.y),!(tt>z)&&!(it<C))}}}])}(),vt=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===o.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(t){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(t){return this===t||this.equalsExact(t,0)}},{key:"geometryChanged",value:function(){this.apply(o.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(t){return t!==null&&this.norm().equalsExact(t.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var t;if(arguments.length===1){var e=arguments[0];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(arguments.length===2){var s=arguments[0],c=arguments[1];return t=s,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(s,c)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(t){if(t.getTypeCode()===o.TYPECODE_GEOMETRYCOLLECTION)throw new F("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(t,e,s){return s===0?t.equals(e):t.distance(e)<=s}},{key:"norm",value:function(){var t=this.copy();return t.normalize(),t}},{key:"reverse",value:function(){var t=this.reverseInternal();return this.envelope!=null&&(t.envelope=this.envelope.copy()),t.setSRID(this.getSRID()),t}},{key:"copy",value:function(){var t=this.copyInternal();return t.envelope=this._envelope==null?null:this._envelope.copy(),t._SRID=this._SRID,t._userData=this._userData,t}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Ct(this._envelope)}},{key:"setSRID",value:function(t){this._SRID=t}},{key:"setUserData",value:function(t){this._userData=t}},{key:"compare",value:function(t,e){for(var s=t.iterator(),c=e.iterator();s.hasNext()&&c.hasNext();){var p=s.next(),_=c.next(),w=p.compareTo(_);if(w!==0)return w}return s.hasNext()?1:c.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(t){return this.getClass()===t.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===o.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===o.TYPECODE_MULTIPOINT||this.getTypeCode()===o.TYPECODE_MULTILINESTRING||this.getTypeCode()===o.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[E,K,S]}},{key:"getClass",value:function(){return o}}],[{key:"hasNonEmptyElements",value:function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(t){for(var e=0;e<t.length;e++)if(t[e]===null)return!0;return!1}}])}();vt.constructor_=function(o){o&&(this._envelope=null,this._userData=null,this._factory=o,this._SRID=o.getSRID())},vt.TYPECODE_POINT=0,vt.TYPECODE_MULTIPOINT=1,vt.TYPECODE_LINESTRING=2,vt.TYPECODE_LINEARRING=3,vt.TYPECODE_MULTILINESTRING=4,vt.TYPECODE_POLYGON=5,vt.TYPECODE_MULTIPOLYGON=6,vt.TYPECODE_GEOMETRYCOLLECTION=7,vt.TYPENAME_POINT="Point",vt.TYPENAME_MULTIPOINT="MultiPoint",vt.TYPENAME_LINESTRING="LineString",vt.TYPENAME_LINEARRING="LinearRing",vt.TYPENAME_MULTILINESTRING="MultiLineString",vt.TYPENAME_POLYGON="Polygon",vt.TYPENAME_MULTIPOLYGON="MultiPolygon",vt.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",vt.geometryChangedFilter={get interfaces_(){return[H]},filter:function(o){o.geometryChangedAction()}};var Y=function(){function o(){l(this,o)}return d(o,null,[{key:"toLocationSymbol",value:function(t){switch(t){case o.EXTERIOR:return"e";case o.BOUNDARY:return"b";case o.INTERIOR:return"i";case o.NONE:return"-"}throw new F("Unknown location value: "+t)}}])}();Y.INTERIOR=0,Y.BOUNDARY=1,Y.EXTERIOR=2,Y.NONE=-1;var At=function(){return d(function o(){l(this,o)},[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}])}(),Gt=function(o){function t(e){var s;return l(this,t),(s=a(this,t,[e])).name=Object.keys({NoSuchElementException:t})[0],s}return I(t,o),d(t)}(A),Lt=function(o){function t(e){var s;return l(this,t),(s=a(this,t,[e])).name=Object.keys({UnsupportedOperationException:t})[0],s}return I(t,o),d(t)}(A),xe=function(o){function t(){return l(this,t),a(this,t,arguments)}return I(t,o),d(t,[{key:"contains",value:function(){}}])}(At),he=function(o){function t(e){var s;return l(this,t),(s=a(this,t)).map=new Map,e instanceof At&&s.addAll(e),s}return I(t,o),d(t,[{key:"contains",value:function(e){var s=e.hashCode?e.hashCode():e;return!!this.map.has(s)}},{key:"add",value:function(e){var s=e.hashCode?e.hashCode():e;return!this.map.has(s)&&!!this.map.set(s,e)}},{key:"addAll",value:function(e){var s,c=x(e);try{for(c.s();!(s=c.n()).done;){var p=s.value;this.add(p)}}catch(_){c.e(_)}finally{c.f()}return!0}},{key:"remove",value:function(){throw new Lt}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new Ce(this.map)}},{key:Symbol.iterator,value:function(){return this.map}}])}(xe),Ce=function(){return d(function o(t){l(this,o),this.iterator=t.values();var e=this.iterator.next(),s=e.done,c=e.value;this.done=s,this.value=c},[{key:"next",value:function(){if(this.done)throw new Gt;var o=this.value,t=this.iterator.next(),e=t.done,s=t.value;return this.done=e,this.value=s,o}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new Lt}}])}(),yt=function(){function o(){l(this,o)}return d(o,null,[{key:"opposite",value:function(t){return t===o.LEFT?o.RIGHT:t===o.RIGHT?o.LEFT:t}}])}();yt.ON=0,yt.LEFT=1,yt.RIGHT=2;var ui=function(o){function t(e){var s;return l(this,t),(s=a(this,t,[e])).name=Object.keys({EmptyStackException:t})[0],s}return I(t,o),d(t)}(A),Yn=function(o){function t(e){var s;return l(this,t),(s=a(this,t,[e])).name=Object.keys({IndexOutOfBoundsException:t})[0],s}return I(t,o),d(t)}(A),qe=function(o){function t(){return l(this,t),a(this,t,arguments)}return I(t,o),d(t,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}])}(At),bi=function(o){function t(){var e;return l(this,t),(e=a(this,t)).array=[],e}return I(t,o),d(t,[{key:"add",value:function(e){return this.array.push(e),!0}},{key:"get",value:function(e){if(e<0||e>=this.size())throw new Yn;return this.array[e]}},{key:"push",value:function(e){return this.array.push(e),e}},{key:"pop",value:function(){if(this.array.length===0)throw new ui;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new ui;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(e){return this.array.indexOf(e)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}])}(qe);function Nt(o,t){return o.interfaces_&&o.interfaces_.indexOf(t)>-1}var dn=function(){return d(function o(t){l(this,o),this.str=t},[{key:"append",value:function(o){this.str+=o}},{key:"setCharAt",value:function(o,t){this.str=this.str.substr(0,o)+t+this.str.substr(o+1)}},{key:"toString",value:function(){return this.str}}])}(),Ze=function(){function o(t){l(this,o),this.value=t}return d(o,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(t){return this.value<t?-1:this.value>t?1:0}}],[{key:"compare",value:function(t,e){return t<e?-1:t>e?1:0}},{key:"isNan",value:function(t){return Number.isNaN(t)}},{key:"valueOf",value:function(t){return new o(t)}}])}(),Ti=function(){return d(function o(){l(this,o)},null,[{key:"isWhitespace",value:function(o){return o<=32&&o>=0||o===127}},{key:"toUpperCase",value:function(o){return o.toUpperCase()}}])}(),St=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"le",value:function(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}},{key:"extractSignificantDigits",value:function(t,e){var s=this.abs(),c=o.magnitude(s._hi),p=o.TEN.pow(c);(s=s.divide(p)).gt(o.TEN)?(s=s.divide(o.TEN),c+=1):s.lt(o.ONE)&&(s=s.multiply(o.TEN),c-=1);for(var _=c+1,w=new dn,C=o.MAX_PRINT_DIGITS-1,z=0;z<=C;z++){t&&z===_&&w.append(".");var tt=Math.trunc(s._hi);if(tt<0)break;var it=!1,dt=0;tt>9?(it=!0,dt="9"):dt="0"+tt,w.append(dt),s=s.subtract(o.valueOf(tt)).multiply(o.TEN),it&&s.selfAdd(o.TEN);var xt=!0,Et=o.magnitude(s._hi);if(Et<0&&Math.abs(Et)>=C-z&&(xt=!1),!xt)break}return e[0]=c,w.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof o){var t=arguments[0];return this.add(t.negate())}if(typeof arguments[0]=="number"){var e=arguments[0];return this.add(-e)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof o){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof o){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(t){return this.le(t)?this:t}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof o){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfDivide(e,0)}}else if(arguments.length===2){var s,c,p,_,w=arguments[0],C=arguments[1],z=null,tt=null,it=null,dt=null;return p=this._hi/w,dt=(z=(it=o.SPLIT*p)-(z=it-p))*(tt=(dt=o.SPLIT*w)-(tt=dt-w))-(_=p*w)+z*(c=w-tt)+(s=p-z)*tt+s*c,dt=p+(it=(this._hi-_-dt+this._lo-p*C)/w),this._hi=dt,this._lo=p-dt+it,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof o){var t,e,s,c,p=arguments[0],_=null,w=null,C=null,z=null;return t=(s=this._hi/p._hi)-(_=(C=o.SPLIT*s)-(_=C-s)),z=_*(w=(z=o.SPLIT*p._hi)-(w=z-p._hi))-(c=s*p._hi)+_*(e=p._hi-w)+t*w+t*e,new o(z=s+(C=(this._hi-c-z+this._lo-s*p._lo)/p._hi),s-z+C)}if(typeof arguments[0]=="number"){var tt=arguments[0];return J.isNaN(tt)?o.createNaN():o.copy(this).selfDivide(tt,0)}}},{key:"ge",value:function(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}},{key:"pow",value:function(t){if(t===0)return o.valueOf(1);var e=new o(this),s=o.valueOf(1),c=Math.abs(t);if(c>1)for(;c>0;)c%2==1&&s.selfMultiply(e),(c/=2)>0&&(e=e.sqr());else s=e;return t<0?s.reciprocal():s}},{key:"ceil",value:function(){if(this.isNaN())return o.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new o(t,e)}},{key:"compareTo",value:function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof o){var t=arguments[0];return this.init(t),this}if(typeof arguments[0]=="number"){var e=arguments[0];return this.init(e),this}}},{key:"max",value:function(t){return this.ge(t)?this:t}},{key:"sqrt",value:function(){if(this.isZero())return o.valueOf(0);if(this.isNegative())return o.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,s=o.valueOf(e),c=this.subtract(s.sqr())._hi*(.5*t);return s.add(c)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof o){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if(typeof arguments[0]=="number"){var e,s,c,p,_,w=arguments[0],C=null;return C=(c=this._hi+w)-(p=c-this._hi),s=(_=(C=w-p+(this._hi-C))+this._lo)+(c-(e=c+_)),this._hi=e+s,this._lo=s+(e-this._hi),this}}else if(arguments.length===2){var z,tt,it,dt,xt=arguments[0],Et=arguments[1],Mt=null,Ut=null,zt=null;it=this._hi+xt,tt=this._lo+Et,Ut=it-(zt=it-this._hi),Mt=tt-(dt=tt-this._lo);var jt=(z=it+(zt=(Ut=xt-zt+(this._hi-Ut))+tt))+(zt=(Mt=Et-dt+(this._lo-Mt))+(zt+(it-z))),ee=zt+(z-jt);return this._hi=jt,this._lo=ee,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof o){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfMultiply(e,0)}}else if(arguments.length===2){var s,c,p=arguments[0],_=arguments[1],w=null,C=null,z=null,tt=null;w=(z=o.SPLIT*this._hi)-this._hi,tt=o.SPLIT*p,w=z-w,s=this._hi-w,C=tt-p;var it=(z=this._hi*p)+(tt=w*(C=tt-C)-z+w*(c=p-C)+s*C+s*c+(this._hi*_+this._lo*p)),dt=tt+(w=z-it);return this._hi=it,this._lo=dt,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return o.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new o(t,e)}},{key:"negate",value:function(){return this.isNaN()?this:new o(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}},{key:"multiply",value:function(){if(arguments[0]instanceof o){var t=arguments[0];return t.isNaN()?o.createNaN():o.copy(this).selfMultiply(t)}if(typeof arguments[0]=="number"){var e=arguments[0];return J.isNaN(e)?o.createNaN():o.copy(this).selfMultiply(e,0)}}},{key:"isNaN",value:function(){return J.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var t=o.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),s=this.extractSignificantDigits(!0,e),c=e[0]+1,p=s;if(s.charAt(0)===".")p="0"+s;else if(c<0)p="0."+o.stringOfChar("0",-c)+s;else if(s.indexOf(".")===-1){var _=c-s.length;p=s+o.stringOfChar("0",_)+".0"}return this.isNegative()?"-"+p:p}},{key:"reciprocal",value:function(){var t,e,s,c,p=null,_=null,w=null,C=null;t=(s=1/this._hi)-(p=(w=o.SPLIT*s)-(p=w-s)),_=(C=o.SPLIT*this._hi)-this._hi;var z=s+(w=(1-(c=s*this._hi)-(C=p*(_=C-_)-c+p*(e=this._hi-_)+t*_+t*e)-s*this._lo)/this._hi);return new o(z,s-z+w)}},{key:"toSciNotation",value:function(){if(this.isZero())return o.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),s=this.extractSignificantDigits(!1,e),c=o.SCI_NOT_EXPONENT_CHAR+e[0];if(s.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+s);var p="";s.length>1&&(p=s.substring(1));var _=s.charAt(0)+"."+p;return this.isNegative()?"-"+_+c:_+c}},{key:"abs",value:function(){return this.isNaN()?o.NaN:this.isNegative()?this.negate():new o(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}},{key:"add",value:function(){if(arguments[0]instanceof o){var t=arguments[0];return o.copy(this).selfAdd(t)}if(typeof arguments[0]=="number"){var e=arguments[0];return o.copy(this).selfAdd(e)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof o){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this._hi=s,this._lo=c}}},{key:"gt",value:function(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?o.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[S,K,E]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof o){var e=arguments[0];this.init(e)}else if(typeof arguments[0]=="string"){var s=arguments[0];o.constructor_.call(this,o.parse(s))}}else if(arguments.length===2){var c=arguments[0],p=arguments[1];this.init(c,p)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1],s=arguments[2],c=arguments[3];return o.determinant(o.valueOf(t),o.valueOf(e),o.valueOf(s),o.valueOf(c))}if(arguments[3]instanceof o&&arguments[2]instanceof o&&arguments[0]instanceof o&&arguments[1]instanceof o){var p=arguments[1],_=arguments[2],w=arguments[3];return arguments[0].multiply(w).selfSubtract(p.multiply(_))}}},{key:"sqr",value:function(t){return o.valueOf(t).selfMultiply(t)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var t=arguments[0];return o.parse(t)}if(typeof arguments[0]=="number")return new o(arguments[0])}},{key:"sqrt",value:function(t){return o.valueOf(t).sqrt()}},{key:"parse",value:function(t){for(var e=0,s=t.length;Ti.isWhitespace(t.charAt(e));)e++;var c=!1;if(e<s){var p=t.charAt(e);p!=="-"&&p!=="+"||(e++,p==="-"&&(c=!0))}for(var _=new o,w=0,C=0,z=0,tt=!1;!(e>=s);){var it=t.charAt(e);if(e++,Ti.isDigit(it)){var dt=it-"0";_.selfMultiply(o.TEN),_.selfAdd(dt),w++}else{if(it!=="."){if(it==="e"||it==="E"){var xt=t.substring(e);try{z=Ze.parseInt(xt)}catch(jt){throw jt instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+xt+" in string "+t):jt}break}throw new NumberFormatException("Unexpected character '"+it+"' at position "+e+" in string "+t)}C=w,tt=!0}}var Et=_;tt||(C=w);var Mt=w-C-z;if(Mt===0)Et=_;else if(Mt>0){var Ut=o.TEN.pow(Mt);Et=_.divide(Ut)}else if(Mt<0){var zt=o.TEN.pow(-Mt);Et=_.multiply(zt)}return c?Et.negate():Et}},{key:"createNaN",value:function(){return new o(J.NaN,J.NaN)}},{key:"copy",value:function(t){return new o(t)}},{key:"magnitude",value:function(t){var e=Math.abs(t),s=Math.log(e)/Math.log(10),c=Math.trunc(Math.floor(s));return 10*Math.pow(10,c)<=e&&(c+=1),c}},{key:"stringOfChar",value:function(t,e){for(var s=new dn,c=0;c<e;c++)s.append(t);return s.toString()}}])}();St.PI=new St(3.141592653589793,12246467991473532e-32),St.TWO_PI=new St(6.283185307179586,24492935982947064e-32),St.PI_2=new St(1.5707963267948966,6123233995736766e-32),St.E=new St(2.718281828459045,14456468917292502e-32),St.NaN=new St(J.NaN,J.NaN),St.EPS=123259516440783e-46,St.SPLIT=134217729,St.MAX_PRINT_DIGITS=32,St.TEN=St.valueOf(10),St.ONE=St.valueOf(1),St.SCI_NOT_EXPONENT_CHAR="E",St.SCI_NOT_ZERO="0.0E0";var pr=function(){function o(){l(this,o)}return d(o,null,[{key:"orientationIndex",value:function(t,e,s){var c=o.orientationIndexFilter(t,e,s);if(c<=1)return c;var p=St.valueOf(e.x).selfAdd(-t.x),_=St.valueOf(e.y).selfAdd(-t.y),w=St.valueOf(s.x).selfAdd(-e.x),C=St.valueOf(s.y).selfAdd(-e.y);return p.selfMultiply(C).selfSubtract(_.selfMultiply(w)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof St&&arguments[2]instanceof St&&arguments[0]instanceof St&&arguments[1]instanceof St){var t=arguments[1],e=arguments[2],s=arguments[3];return arguments[0].multiply(s).selfSubtract(t.multiply(e)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var c=arguments[0],p=arguments[1],_=arguments[2],w=arguments[3],C=St.valueOf(c),z=St.valueOf(p),tt=St.valueOf(_),it=St.valueOf(w);return C.multiply(it).selfSubtract(z.multiply(tt)).signum()}}},{key:"intersection",value:function(t,e,s,c){var p=new St(t.y).selfSubtract(e.y),_=new St(e.x).selfSubtract(t.x),w=new St(t.x).selfMultiply(e.y).selfSubtract(new St(e.x).selfMultiply(t.y)),C=new St(s.y).selfSubtract(c.y),z=new St(c.x).selfSubtract(s.x),tt=new St(s.x).selfMultiply(c.y).selfSubtract(new St(c.x).selfMultiply(s.y)),it=_.multiply(tt).selfSubtract(z.multiply(w)),dt=C.multiply(w).selfSubtract(p.multiply(tt)),xt=p.multiply(z).selfSubtract(C.multiply(_)),Et=it.selfDivide(xt).doubleValue(),Mt=dt.selfDivide(xt).doubleValue();return J.isNaN(Et)||J.isInfinite(Et)||J.isNaN(Mt)||J.isInfinite(Mt)?null:new et(Et,Mt)}},{key:"orientationIndexFilter",value:function(t,e,s){var c=null,p=(t.x-s.x)*(e.y-s.y),_=(t.y-s.y)*(e.x-s.x),w=p-_;if(p>0){if(_<=0)return o.signum(w);c=p+_}else{if(!(p<0)||_>=0)return o.signum(w);c=-p-_}var C=o.DP_SAFE_EPSILON*c;return w>=C||-w>=C?o.signum(w):2}},{key:"signum",value:function(t){return t>0?1:t<0?-1:0}}])}();pr.DP_SAFE_EPSILON=1e-15;var qt=function(){return d(function o(){l(this,o)},[{key:"getM",value:function(o){if(this.hasM()){var t=this.getDimension()-this.getMeasures();return this.getOrdinate(o,t)}return J.NaN}},{key:"setOrdinate",value:function(o,t,e){}},{key:"getZ",value:function(o){return this.hasZ()?this.getOrdinate(o,2):J.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(o,t){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(o){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(o){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(o){}},{key:"copy",value:function(){}},{key:"getY",value:function(o){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[E]}}])}();qt.X=0,qt.Y=1,qt.Z=2,qt.M=3;var bt=function(){function o(){l(this,o)}return d(o,null,[{key:"index",value:function(t,e,s){return pr.orientationIndex(t,e,s)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var t=arguments[0],e=t.length-1;if(e<3)throw new F("Ring has fewer than 4 points, so orientation cannot be determined");for(var s=t[0],c=0,p=1;p<=e;p++){var _=t[p];_.y>s.y&&(s=_,c=p)}var w=c;do(w-=1)<0&&(w=e);while(t[w].equals2D(s)&&w!==c);var C=c;do C=(C+1)%e;while(t[C].equals2D(s)&&C!==c);var z=t[w],tt=t[C];if(z.equals2D(s)||tt.equals2D(s)||z.equals2D(tt))return!1;var it=o.index(z,s,tt);return it===0?z.x>tt.x:it>0}if(Nt(arguments[0],qt)){var dt=arguments[0],xt=dt.size()-1;if(xt<3)throw new F("Ring has fewer than 4 points, so orientation cannot be determined");for(var Et=dt.getCoordinate(0),Mt=0,Ut=1;Ut<=xt;Ut++){var zt=dt.getCoordinate(Ut);zt.y>Et.y&&(Et=zt,Mt=Ut)}var jt=null,ee=Mt;do(ee-=1)<0&&(ee=xt),jt=dt.getCoordinate(ee);while(jt.equals2D(Et)&&ee!==Mt);var fe=null,wn=Mt;do wn=(wn+1)%xt,fe=dt.getCoordinate(wn);while(fe.equals2D(Et)&&wn!==Mt);if(jt.equals2D(Et)||fe.equals2D(Et)||jt.equals2D(fe))return!1;var Ei=o.index(jt,Et,fe);return Ei===0?jt.x>fe.x:Ei>0}}}])}();bt.CLOCKWISE=-1,bt.RIGHT=bt.CLOCKWISE,bt.COUNTERCLOCKWISE=1,bt.LEFT=bt.COUNTERCLOCKWISE,bt.COLLINEAR=0,bt.STRAIGHT=bt.COLLINEAR;var go=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(o,t){var e=this.getRightmostSideOfSegment(o,t);return e<0&&(e=this.getRightmostSideOfSegment(o,t-1)),e<0&&(this._minCoord=null,this.checkForRightmostCoordinate(o)),e}},{key:"findRightmostEdgeAtVertex",value:function(){var o=this._minDe.getEdge().getCoordinates();ht.isTrue(this._minIndex>0&&this._minIndex<o.length,"rightmost point expected to be interior vertex of edge");var t=o[this._minIndex-1],e=o[this._minIndex+1],s=bt.index(this._minCoord,e,t),c=!1;(t.y<this._minCoord.y&&e.y<this._minCoord.y&&s===bt.COUNTERCLOCKWISE||t.y>this._minCoord.y&&e.y>this._minCoord.y&&s===bt.CLOCKWISE)&&(c=!0),c&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(o,t){var e=o.getEdge().getCoordinates();if(t<0||t+1>=e.length||e[t].y===e[t+1].y)return-1;var s=yt.LEFT;return e[t].y<e[t+1].y&&(s=yt.RIGHT),s}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(o){for(var t=o.getEdge().getCoordinates(),e=0;e<t.length-1;e++)(this._minCoord===null||t[e].x>this._minCoord.x)&&(this._minDe=o,this._minIndex=e,this._minCoord=t[e])}},{key:"findRightmostEdgeAtNode",value:function(){var o=this._minDe.getNode().getEdges();this._minDe=o.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(o){for(var t=o.iterator();t.hasNext();){var e=t.next();e.isForward()&&this.checkForRightmostCoordinate(e)}ht.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===yt.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}])}(),Ue=function(o){function t(e,s){var c;return l(this,t),(c=a(this,t,[s?e+" [ "+s+" ]":e])).pt=s?new et(s):void 0,c.name=Object.keys({TopologyException:t})[0],c}return I(t,o),d(t,[{key:"getCoordinate",value:function(){return this.pt}}])}(ct),yr=function(){return d(function o(){l(this,o),this.array=[]},[{key:"addLast",value:function(o){this.array.push(o)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}])}(),It=function(o){function t(e){var s;return l(this,t),(s=a(this,t)).array=[],e instanceof At&&s.addAll(e),s}return I(t,o),d(t,[{key:"interfaces_",get:function(){return[qe,At]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(e){return arguments.length===1?this.array.push(e):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(e){var s,c=x(e);try{for(c.s();!(s=c.n()).done;){var p=s.value;this.array.push(p)}}catch(_){c.e(_)}finally{c.f()}}},{key:"set",value:function(e,s){var c=this.array[e];return this.array[e]=s,c}},{key:"iterator",value:function(){return new mo(this)}},{key:"get",value:function(e){if(e<0||e>=this.size())throw new Yn;return this.array[e]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(e){e?this.array.sort(function(s,c){return e.compare(s,c)}):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(e){for(var s=0,c=this.array.length;s<c;s++)if(this.array[s]===e)return!!this.array.splice(s,1);return!1}},{key:Symbol.iterator,value:function(){return this.array.values()}}])}(qe),mo=function(){return d(function o(t){l(this,o),this.arrayList=t,this.position=0},[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new Gt;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(o){return this.arrayList.set(this.position-1,o)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}])}(),li=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"clearVisitedEdges",value:function(){for(var o=this._dirEdgeList.iterator();o.hasNext();)o.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(o){for(var t=null,e=o.getEdges().iterator();e.hasNext();){var s=e.next();if(s.isVisited()||s.getSym().isVisited()){t=s;break}}if(t===null)throw new Ue("unable to find edge to compute depths at "+o.getCoordinate());o.getEdges().computeDepths(t);for(var c=o.getEdges().iterator();c.hasNext();){var p=c.next();p.setVisited(!0),this.copySymDepths(p)}}},{key:"computeDepth",value:function(o){this.clearVisitedEdges();var t=this._finder.getEdge();t.getNode(),t.getLabel(),t.setEdgeDepths(yt.RIGHT,o),this.copySymDepths(t),this.computeDepths(t)}},{key:"create",value:function(o){this.addReachable(o),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var o=this._dirEdgeList.iterator();o.hasNext();){var t=o.next();t.getDepth(yt.RIGHT)>=1&&t.getDepth(yt.LEFT)<=0&&!t.isInteriorAreaEdge()&&t.setInResult(!0)}}},{key:"computeDepths",value:function(o){var t=new he,e=new yr,s=o.getNode();for(e.addLast(s),t.add(s),o.setVisited(!0);!e.isEmpty();){var c=e.removeFirst();t.add(c),this.computeNodeDepth(c);for(var p=c.getEdges().iterator();p.hasNext();){var _=p.next().getSym();if(!_.isVisited()){var w=_.getNode();t.contains(w)||(e.addLast(w),t.add(w))}}}}},{key:"compareTo",value:function(o){var t=o;return this._rightMostCoord.x<t._rightMostCoord.x?-1:this._rightMostCoord.x>t._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var o=new Ct,t=this._dirEdgeList.iterator();t.hasNext();)for(var e=t.next().getEdge().getCoordinates(),s=0;s<e.length-1;s++)o.expandToInclude(e[s]);this._env=o}return this._env}},{key:"addReachable",value:function(o){var t=new bi;for(t.add(o);!t.empty();){var e=t.pop();this.add(e,t)}}},{key:"copySymDepths",value:function(o){var t=o.getSym();t.setDepth(yt.LEFT,o.getDepth(yt.RIGHT)),t.setDepth(yt.RIGHT,o.getDepth(yt.LEFT))}},{key:"add",value:function(o,t){o.setVisited(!0),this._nodes.add(o);for(var e=o.getEdges().iterator();e.hasNext();){var s=e.next();this._dirEdgeList.add(s);var c=s.getSym().getNode();c.isVisited()||t.push(c)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[K]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new It,this._nodes=new It,this._rightMostCoord=null,this._env=null,this._finder=new go}}])}(),vr=function(){return d(function o(){l(this,o)},null,[{key:"intersection",value:function(o,t,e,s){var c=o.x<t.x?o.x:t.x,p=o.y<t.y?o.y:t.y,_=o.x>t.x?o.x:t.x,w=o.y>t.y?o.y:t.y,C=e.x<s.x?e.x:s.x,z=e.y<s.y?e.y:s.y,tt=e.x>s.x?e.x:s.x,it=e.y>s.y?e.y:s.y,dt=((c>C?c:C)+(_<tt?_:tt))/2,xt=((p>z?p:z)+(w<it?w:it))/2,Et=o.x-dt,Mt=o.y-xt,Ut=t.x-dt,zt=t.y-xt,jt=e.x-dt,ee=e.y-xt,fe=s.x-dt,wn=s.y-xt,Ei=Mt-zt,Qe=Ut-Et,Ur=Et*zt-Ut*Mt,Yr=ee-wn,ni=fe-jt,bs=jt*wn-fe*ee,Pi=Ei*ni-Yr*Qe,Dn=(Qe*bs-ni*Ur)/Pi,Qi=(Yr*Ur-Ei*bs)/Pi;return J.isNaN(Dn)||J.isInfinite(Dn)||J.isNaN(Qi)||J.isInfinite(Qi)?null:new et(Dn+dt,Qi+xt)}}])}(),Re=function(){return d(function o(){l(this,o)},null,[{key:"arraycopy",value:function(o,t,e,s,c){for(var p=0,_=t;_<t+c;_++)e[s+p]=o[_],p++}},{key:"getProperty",value:function(o){return{"line.separator":`
`}[o]}}])}(),Xn=function(){function o(){l(this,o)}return d(o,null,[{key:"log10",value:function(t){var e=Math.log(t);return J.isInfinite(e)||J.isNaN(e)?e:e/o.LOG_10}},{key:"min",value:function(t,e,s,c){var p=t;return e<p&&(p=e),s<p&&(p=s),c<p&&(p=c),p}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1],s=arguments[2];return t<e?e:t>s?s:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var c=arguments[0],p=arguments[1],_=arguments[2];return c<p?p:c>_?_:c}}},{key:"wrap",value:function(t,e){return t<0?e- -t%e:t%e}},{key:"max",value:function(){if(arguments.length===3){var t=arguments[1],e=arguments[2],s=arguments[0];return t>s&&(s=t),e>s&&(s=e),s}if(arguments.length===4){var c=arguments[1],p=arguments[2],_=arguments[3],w=arguments[0];return c>w&&(w=c),p>w&&(w=p),_>w&&(w=_),w}}},{key:"average",value:function(t,e){return(t+e)/2}}])}();Xn.LOG_10=Math.log(10);var ze=function(){function o(){l(this,o)}return d(o,null,[{key:"segmentToSegment",value:function(t,e,s,c){if(t.equals(e))return o.pointToSegment(t,s,c);if(s.equals(c))return o.pointToSegment(c,t,e);var p=!1;if(Ct.intersects(t,e,s,c)){var _=(e.x-t.x)*(c.y-s.y)-(e.y-t.y)*(c.x-s.x);if(_===0)p=!0;else{var w=(t.y-s.y)*(c.x-s.x)-(t.x-s.x)*(c.y-s.y),C=((t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y))/_,z=w/_;(z<0||z>1||C<0||C>1)&&(p=!0)}}else p=!0;return p?Xn.min(o.pointToSegment(t,s,c),o.pointToSegment(e,s,c),o.pointToSegment(s,t,e),o.pointToSegment(c,t,e)):0}},{key:"pointToSegment",value:function(t,e,s){if(e.x===s.x&&e.y===s.y)return t.distance(e);var c=(s.x-e.x)*(s.x-e.x)+(s.y-e.y)*(s.y-e.y),p=((t.x-e.x)*(s.x-e.x)+(t.y-e.y)*(s.y-e.y))/c;if(p<=0)return t.distance(e);if(p>=1)return t.distance(s);var _=((e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y))/c;return Math.abs(_)*Math.sqrt(c)}},{key:"pointToLinePerpendicular",value:function(t,e,s){var c=(s.x-e.x)*(s.x-e.x)+(s.y-e.y)*(s.y-e.y),p=((e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y))/c;return Math.abs(p)*Math.sqrt(c)}},{key:"pointToSegmentString",value:function(t,e){if(e.length===0)throw new F("Line array must contain at least one vertex");for(var s=t.distance(e[0]),c=0;c<e.length-1;c++){var p=o.pointToSegment(t,e[c],e[c+1]);p<s&&(s=p)}return s}}])}(),_r=function(){return d(function o(){l(this,o)},[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||Nt(arguments[0],qt);else if(arguments.length!==2){if(arguments.length===3){var o=arguments[0],t=arguments[1];return this.create(o,t)}}}}])}(),Ni=function(){return d(function o(){l(this,o)},[{key:"filter",value:function(o){}}])}(),po=function(){return d(function o(){l(this,o)},null,[{key:"ofLine",value:function(o){var t=o.size();if(t<=1)return 0;var e=0,s=new et;o.getCoordinate(0,s);for(var c=s.x,p=s.y,_=1;_<t;_++){o.getCoordinate(_,s);var w=s.x,C=s.y,z=w-c,tt=C-p;e+=Math.sqrt(z*z+tt*tt),c=w,p=C}return e}}])}(),fs=d(function o(){l(this,o)}),Cn=function(){function o(){l(this,o)}return d(o,null,[{key:"copyCoord",value:function(t,e,s,c){for(var p=Math.min(t.getDimension(),s.getDimension()),_=0;_<p;_++)s.setOrdinate(c,_,t.getOrdinate(e,_))}},{key:"isRing",value:function(t){var e=t.size();return e===0||!(e<=3)&&t.getOrdinate(0,qt.X)===t.getOrdinate(e-1,qt.X)&&t.getOrdinate(0,qt.Y)===t.getOrdinate(e-1,qt.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(Nt(arguments[0],qt)&&Number.isInteger(arguments[1])){var t=arguments[0],e=arguments[1];o.scroll(t,e,o.isRing(t))}else if(Nt(arguments[0],qt)&&arguments[1]instanceof et){var s=arguments[0],c=arguments[1],p=o.indexOf(c,s);if(p<=0)return null;o.scroll(s,p)}}else if(arguments.length===3){var _=arguments[0],w=arguments[1],C=arguments[2];if(w<=0)return null;for(var z=_.copy(),tt=C?_.size()-1:_.size(),it=0;it<tt;it++)for(var dt=0;dt<_.getDimension();dt++)_.setOrdinate(it,dt,z.getOrdinate((w+it)%tt,dt));if(C)for(var xt=0;xt<_.getDimension();xt++)_.setOrdinate(tt,xt,_.getOrdinate(0,xt))}}},{key:"isEqual",value:function(t,e){var s=t.size();if(s!==e.size())return!1;for(var c=Math.min(t.getDimension(),e.getDimension()),p=0;p<s;p++)for(var _=0;_<c;_++){var w=t.getOrdinate(p,_),C=e.getOrdinate(p,_);if(t.getOrdinate(p,_)!==e.getOrdinate(p,_)&&(!J.isNaN(w)||!J.isNaN(C)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var t=arguments[0];return o.minCoordinateIndex(t,0,t.size()-1)}if(arguments.length===3){for(var e=arguments[0],s=arguments[2],c=-1,p=null,_=arguments[1];_<=s;_++){var w=e.getCoordinate(_);(p===null||p.compareTo(w)>0)&&(p=w,c=_)}return c}}},{key:"extend",value:function(t,e,s){var c=t.create(s,e.getDimension()),p=e.size();if(o.copy(e,0,c,0,p),p>0)for(var _=p;_<s;_++)o.copy(e,p-1,c,_,1);return c}},{key:"reverse",value:function(t){for(var e=t.size()-1,s=Math.trunc(e/2),c=0;c<=s;c++)o.swap(t,c,e-c)}},{key:"swap",value:function(t,e,s){if(e===s)return null;for(var c=0;c<t.getDimension();c++){var p=t.getOrdinate(e,c);t.setOrdinate(e,c,t.getOrdinate(s,c)),t.setOrdinate(s,c,p)}}},{key:"copy",value:function(t,e,s,c,p){for(var _=0;_<p;_++)o.copyCoord(t,e+_,s,c+_)}},{key:"ensureValidRing",value:function(t,e){var s=e.size();return s===0?e:s<=3?o.createClosedRing(t,e,4):e.getOrdinate(0,qt.X)===e.getOrdinate(s-1,qt.X)&&e.getOrdinate(0,qt.Y)===e.getOrdinate(s-1,qt.Y)?e:o.createClosedRing(t,e,s+1)}},{key:"indexOf",value:function(t,e){for(var s=0;s<e.size();s++)if(t.x===e.getOrdinate(s,qt.X)&&t.y===e.getOrdinate(s,qt.Y))return s;return-1}},{key:"createClosedRing",value:function(t,e,s){var c=t.create(s,e.getDimension()),p=e.size();o.copy(e,0,c,0,p);for(var _=p;_<s;_++)o.copy(e,0,c,_,1);return c}},{key:"minCoordinate",value:function(t){for(var e=null,s=0;s<t.size();s++){var c=t.getCoordinate(s);(e===null||e.compareTo(c)>0)&&(e=c)}return e}}])}(),_t=function(){function o(){l(this,o)}return d(o,null,[{key:"toDimensionSymbol",value:function(t){switch(t){case o.FALSE:return o.SYM_FALSE;case o.TRUE:return o.SYM_TRUE;case o.DONTCARE:return o.SYM_DONTCARE;case o.P:return o.SYM_P;case o.L:return o.SYM_L;case o.A:return o.SYM_A}throw new F("Unknown dimension value: "+t)}},{key:"toDimensionValue",value:function(t){switch(Ti.toUpperCase(t)){case o.SYM_FALSE:return o.FALSE;case o.SYM_TRUE:return o.TRUE;case o.SYM_DONTCARE:return o.DONTCARE;case o.SYM_P:return o.P;case o.SYM_L:return o.L;case o.SYM_A:return o.A}throw new F("Unknown dimension symbol: "+t)}}])}();_t.P=0,_t.L=1,_t.A=2,_t.FALSE=-1,_t.TRUE=-2,_t.DONTCARE=-3,_t.SYM_FALSE="F",_t.SYM_TRUE="T",_t.SYM_DONTCARE="*",_t.SYM_P="0",_t.SYM_L="1",_t.SYM_A="2";var Oi=function(){return d(function o(){l(this,o)},[{key:"filter",value:function(o){}}])}(),Vn=function(){return d(function o(){l(this,o)},[{key:"filter",value:function(o,t){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}])}(),hi=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new Ct:this._points.expandEnvelope(new Ct)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new t(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];if(!this.isEquivalentClass(e))return!1;var c=e;if(this._points.size()!==c._points.size())return!1;for(var p=0;p<this._points.size();p++)if(!this.equal(this._points.getCoordinate(p),c._points.getCoordinate(p),s))return!1;return!0}return R(t,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var e=0;e<Math.trunc(this._points.size()/2);e++){var s=this._points.size()-1-e;if(!this._points.getCoordinate(e).equals(this._points.getCoordinate(s))){if(this._points.getCoordinate(e).compareTo(this._points.getCoordinate(s))>0){var c=this._points.copy();Cn.reverse(c),this._points=c}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?_t.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var e=this._points.copy();return Cn.reverse(e),this.getFactory().createLineString(e)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return vt.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return po.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var e=arguments[0],s=0,c=0;s<this._points.size()&&c<e._points.size();){var p=this._points.getCoordinate(s).compareTo(e._points.getCoordinate(c));if(p!==0)return p;s++,c++}return s<this._points.size()?1:c<e._points.size()?-1:0}if(arguments.length===2){var _=arguments[0];return arguments[1].compare(this._points,_._points)}}},{key:"apply",value:function(){if(Nt(arguments[0],Ni))for(var e=arguments[0],s=0;s<this._points.size();s++)e.filter(this._points.getCoordinate(s));else if(Nt(arguments[0],Vn)){var c=arguments[0];if(this._points.size()===0)return null;for(var p=0;p<this._points.size()&&(c.filter(this._points,p),!c.isDone());p++);c.isGeometryChanged()&&this.geometryChanged()}else Nt(arguments[0],Oi)?arguments[0].filter(this):Nt(arguments[0],H)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new Lt}},{key:"isEquivalentClass",value:function(e){return e instanceof t}},{key:"getCoordinateN",value:function(e){return this._points.getCoordinate(e)}},{key:"getGeometryType",value:function(){return vt.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(e){if(e===null&&(e=this.getFactory().getCoordinateSequenceFactory().create([])),e.size()===1)throw new F("Invalid number of points in LineString (found "+e.size()+" - must be 0 or >= 2)");this._points=e}},{key:"isCoordinate",value:function(e){for(var s=0;s<this._points.size();s++)if(this._points.getCoordinate(s).equals(e))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(e){return this.getFactory().createPoint(this._points.getCoordinate(e))}},{key:"interfaces_",get:function(){return[fs]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var e=arguments[0],s=arguments[1];vt.constructor_.call(this,s),this.init(e)}}}}])}(vt),gs=d(function o(){l(this,o)}),xr=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new Ct;var e=new Ct;return e.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),e}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new t(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),s))}return R(t,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return _t.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return vt.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var e=arguments[0];return this.getCoordinate().compareTo(e.getCoordinate())}if(arguments.length===2){var s=arguments[0];return arguments[1].compare(this._coordinates,s._coordinates)}}},{key:"apply",value:function(){if(Nt(arguments[0],Ni)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this.getCoordinate())}else if(Nt(arguments[0],Vn)){var s=arguments[0];if(this.isEmpty())return null;s.filter(this._coordinates,0),s.isGeometryChanged()&&this.geometryChanged()}else Nt(arguments[0],Oi)?arguments[0].filter(this):Nt(arguments[0],H)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return vt.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(e){e===null&&(e=this.getFactory().getCoordinateSequenceFactory().create([])),ht.isTrue(e.size()<=1),this._coordinates=e}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[gs]}}],[{key:"constructor_",value:function(){this._coordinates=null;var e=arguments[0],s=arguments[1];vt.constructor_.call(this,s),this.init(e)}}])}(vt),ds=function(){function o(){l(this,o)}return d(o,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var t=arguments[0];return Math.abs(o.ofRingSigned(t))}if(Nt(arguments[0],qt)){var e=arguments[0];return Math.abs(o.ofRingSigned(e))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,s=t[0].x,c=1;c<t.length-1;c++){var p=t[c].x-s,_=t[c+1].y;e+=p*(t[c-1].y-_)}return e/2}if(Nt(arguments[0],qt)){var w=arguments[0],C=w.size();if(C<3)return 0;var z=new et,tt=new et,it=new et;w.getCoordinate(0,tt),w.getCoordinate(1,it);var dt=tt.x;it.x-=dt;for(var xt=0,Et=1;Et<C-1;Et++)z.y=tt.y,tt.x=it.x,tt.y=it.y,w.getCoordinate(Et+1,it),it.x-=dt,xt+=tt.x*(z.y-it.y);return xt/2}}}])}(),ge=function(){return d(function o(){l(this,o)},null,[{key:"sort",value:function(){var o=arguments,t=arguments[0];if(arguments.length===1)t.sort(function(dt,xt){return dt.compareTo(xt)});else if(arguments.length===2)t.sort(function(dt,xt){return o[1].compare(dt,xt)});else if(arguments.length===3){var e=t.slice(arguments[1],arguments[2]);e.sort();var s=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);var c,p=x(s);try{for(p.s();!(c=p.n()).done;){var _=c.value;t.push(_)}}catch(dt){p.e(dt)}finally{p.f()}}else if(arguments.length===4){var w=t.slice(arguments[1],arguments[2]);w.sort(function(dt,xt){return o[3].compare(dt,xt)});var C=t.slice(0,arguments[1]).concat(w,t.slice(arguments[2],t.length));t.splice(0,t.length);var z,tt=x(C);try{for(tt.s();!(z=tt.n()).done;){var it=z.value;t.push(it)}}catch(dt){tt.e(dt)}finally{tt.f()}}}},{key:"asList",value:function(o){var t,e=new It,s=x(o);try{for(s.s();!(t=s.n()).done;){var c=t.value;e.add(c)}}catch(p){s.e(p)}finally{s.f()}return e}},{key:"copyOf",value:function(o,t){return o.slice(0,t)}}])}(),Pt=d(function o(){l(this,o)}),ci=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var e=new Array(this.getNumPoints()).fill(null),s=-1,c=this._shell.getCoordinates(),p=0;p<c.length;p++)e[++s]=c[p];for(var _=0;_<this._holes.length;_++)for(var w=this._holes[_].getCoordinates(),C=0;C<w.length;C++)e[++s]=w[C];return e}},{key:"getArea",value:function(){var e=0;e+=ds.ofRing(this._shell.getCoordinateSequence());for(var s=0;s<this._holes.length;s++)e-=ds.ofRing(this._holes[s].getCoordinateSequence());return e}},{key:"copyInternal",value:function(){for(var e=this._shell.copy(),s=new Array(this._holes.length).fill(null),c=0;c<this._holes.length;c++)s[c]=this._holes[c].copy();return new t(e,s,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var e=this._shell.getCoordinateSequence(),s=this.getEnvelopeInternal(),c=0;c<5;c++){var p=e.getX(c);if(p!==s.getMinX()&&p!==s.getMaxX())return!1;var _=e.getY(c);if(_!==s.getMinY()&&_!==s.getMaxY())return!1}for(var w=e.getX(0),C=e.getY(0),z=1;z<=4;z++){var tt=e.getX(z),it=e.getY(z);if(tt!==w==(it!==C))return!1;w=tt,C=it}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];if(!this.isEquivalentClass(e))return!1;var c=e,p=this._shell,_=c._shell;if(!p.equalsExact(_,s)||this._holes.length!==c._holes.length)return!1;for(var w=0;w<this._holes.length;w++)if(!this._holes[w].equalsExact(c._holes[w],s))return!1;return!0}return R(t,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var e=0;e<this._holes.length;e++)this._holes[e]=this.normalized(this._holes[e],!1);ge.sort(this._holes)}else if(arguments.length===2){var s=arguments[0],c=arguments[1];if(s.isEmpty())return null;var p=s.getCoordinateSequence(),_=Cn.minCoordinateIndex(p,0,p.size()-2);Cn.scroll(p,_,!0),bt.isCCW(p)===c&&Cn.reverse(p)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var e=this.getExteriorRing().reverse(),s=new Array(this.getNumInteriorRing()).fill(null),c=0;c<s.length;c++)s[c]=this.getInteriorRingN(c).reverse();return this.getFactory().createPolygon(e,s)}},{key:"getTypeCode",value:function(){return vt.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var e=0;e+=this._shell.getLength();for(var s=0;s<this._holes.length;s++)e+=this._holes[s].getLength();return e}},{key:"getNumPoints",value:function(){for(var e=this._shell.getNumPoints(),s=0;s<this._holes.length;s++)e+=this._holes[s].getNumPoints();return e}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(e,s){var c=e.copy();return this.normalize(c,s),c}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var e=arguments[0],s=this._shell,c=e._shell;return s.compareToSameClass(c)}if(arguments.length===2){var p=arguments[1],_=arguments[0],w=this._shell,C=_._shell,z=w.compareToSameClass(C,p);if(z!==0)return z;for(var tt=this.getNumInteriorRing(),it=_.getNumInteriorRing(),dt=0;dt<tt&&dt<it;){var xt=this.getInteriorRingN(dt),Et=_.getInteriorRingN(dt),Mt=xt.compareToSameClass(Et,p);if(Mt!==0)return Mt;dt++}return dt<tt?1:dt<it?-1:0}}},{key:"apply",value:function(){if(Nt(arguments[0],Ni)){var e=arguments[0];this._shell.apply(e);for(var s=0;s<this._holes.length;s++)this._holes[s].apply(e)}else if(Nt(arguments[0],Vn)){var c=arguments[0];if(this._shell.apply(c),!c.isDone())for(var p=0;p<this._holes.length&&(this._holes[p].apply(c),!c.isDone());p++);c.isGeometryChanged()&&this.geometryChanged()}else if(Nt(arguments[0],Oi))arguments[0].filter(this);else if(Nt(arguments[0],H)){var _=arguments[0];_.filter(this),this._shell.apply(_);for(var w=0;w<this._holes.length;w++)this._holes[w].apply(_)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var e=new Array(this._holes.length+1).fill(null);e[0]=this._shell;for(var s=0;s<this._holes.length;s++)e[s+1]=this._holes[s];return e.length<=1?this.getFactory().createLinearRing(e[0].getCoordinateSequence()):this.getFactory().createMultiLineString(e)}},{key:"getGeometryType",value:function(){return vt.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(e){return this._holes[e]}},{key:"interfaces_",get:function(){return[Pt]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var e=arguments[0],s=arguments[1],c=arguments[2];if(vt.constructor_.call(this,c),e===null&&(e=this.getFactory().createLinearRing()),s===null&&(s=[]),vt.hasNullElements(s))throw new F("holes must not contain null elements");if(e.isEmpty()&&vt.hasNonEmptyElements(s))throw new F("shell is empty but holes are not");this._shell=e,this._holes=s}}])}(vt),ms=function(o){function t(){return l(this,t),a(this,t,arguments)}return I(t,o),d(t)}(xe),kr=function(o){function t(e){var s;return l(this,t),(s=a(this,t)).array=[],e instanceof At&&s.addAll(e),s}return I(t,o),d(t,[{key:"contains",value:function(e){var s,c=x(this.array);try{for(c.s();!(s=c.n()).done;)if(s.value.compareTo(e)===0)return!0}catch(p){c.e(p)}finally{c.f()}return!1}},{key:"add",value:function(e){if(this.contains(e))return!1;for(var s=0,c=this.array.length;s<c;s++)if(this.array[s].compareTo(e)===1)return!!this.array.splice(s,0,e);return this.array.push(e),!0}},{key:"addAll",value:function(e){var s,c=x(e);try{for(c.s();!(s=c.n()).done;){var p=s.value;this.add(p)}}catch(_){c.e(_)}finally{c.f()}return!0}},{key:"remove",value:function(){throw new Lt}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new ps(this.array)}}])}(ms),ps=function(){return d(function o(t){l(this,o),this.array=t,this.position=0},[{key:"next",value:function(){if(this.position===this.array.length)throw new Gt;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new Lt}}])}(),ke=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"computeEnvelopeInternal",value:function(){for(var e=new Ct,s=0;s<this._geometries.length;s++)e.expandToInclude(this._geometries[s].getEnvelopeInternal());return e}},{key:"getGeometryN",value:function(e){return this._geometries[e]}},{key:"getCoordinates",value:function(){for(var e=new Array(this.getNumPoints()).fill(null),s=-1,c=0;c<this._geometries.length;c++)for(var p=this._geometries[c].getCoordinates(),_=0;_<p.length;_++)e[++s]=p[_];return e}},{key:"getArea",value:function(){for(var e=0,s=0;s<this._geometries.length;s++)e+=this._geometries[s].getArea();return e}},{key:"copyInternal",value:function(){for(var e=new Array(this._geometries.length).fill(null),s=0;s<e.length;s++)e[s]=this._geometries[s].copy();return new t(e,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];if(!this.isEquivalentClass(e))return!1;var c=e;if(this._geometries.length!==c._geometries.length)return!1;for(var p=0;p<this._geometries.length;p++)if(!this._geometries[p].equalsExact(c._geometries[p],s))return!1;return!0}return R(t,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var e=0;e<this._geometries.length;e++)this._geometries[e].normalize();ge.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var e=_t.FALSE,s=0;s<this._geometries.length;s++)e=Math.max(e,this._geometries[s].getBoundaryDimension());return e}},{key:"reverseInternal",value:function(){for(var e=this._geometries.length,s=new It(e),c=0;c<e;c++)s.add(this._geometries[c].reverse());return this.getFactory().buildGeometry(s)}},{key:"getTypeCode",value:function(){return vt.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var e=_t.FALSE,s=0;s<this._geometries.length;s++)e=Math.max(e,this._geometries[s].getDimension());return e}},{key:"getLength",value:function(){for(var e=0,s=0;s<this._geometries.length;s++)e+=this._geometries[s].getLength();return e}},{key:"getNumPoints",value:function(){for(var e=0,s=0;s<this._geometries.length;s++)e+=this._geometries[s].getNumPoints();return e}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var e=arguments[0],s=new kr(ge.asList(this._geometries)),c=new kr(ge.asList(e._geometries));return this.compare(s,c)}if(arguments.length===2){for(var p=arguments[1],_=arguments[0],w=this.getNumGeometries(),C=_.getNumGeometries(),z=0;z<w&&z<C;){var tt=this.getGeometryN(z),it=_.getGeometryN(z),dt=tt.compareToSameClass(it,p);if(dt!==0)return dt;z++}return z<w?1:z<C?-1:0}}},{key:"apply",value:function(){if(Nt(arguments[0],Ni))for(var e=arguments[0],s=0;s<this._geometries.length;s++)this._geometries[s].apply(e);else if(Nt(arguments[0],Vn)){var c=arguments[0];if(this._geometries.length===0)return null;for(var p=0;p<this._geometries.length&&(this._geometries[p].apply(c),!c.isDone());p++);c.isGeometryChanged()&&this.geometryChanged()}else if(Nt(arguments[0],Oi)){var _=arguments[0];_.filter(this);for(var w=0;w<this._geometries.length;w++)this._geometries[w].apply(_)}else if(Nt(arguments[0],H)){var C=arguments[0];C.filter(this);for(var z=0;z<this._geometries.length;z++)this._geometries[z].apply(C)}}},{key:"getBoundary",value:function(){return vt.checkNotGeometryCollection(this),ht.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return vt.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var e=arguments[0],s=arguments[1];if(vt.constructor_.call(this,s),e===null&&(e=[]),vt.hasNullElements(e))throw new F("geometries must not contain null elements");this._geometries=e}}}}])}(vt),Ai=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"copyInternal",value:function(){for(var e=new Array(this._geometries.length).fill(null),s=0;s<e.length;s++)e[s]=this._geometries[s].copy();return new t(e,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];return!!this.isEquivalentClass(e)&&R(t,"equalsExact",this,1).call(this,e,s)}return R(t,"equalsExact",this,1).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var e=arguments[0];return this._geometries[e].getCoordinate()}return R(t,"getCoordinate",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return _t.FALSE}},{key:"getTypeCode",value:function(){return vt.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return vt.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[gs]}}],[{key:"constructor_",value:function(){var e=arguments[0],s=arguments[1];ke.constructor_.call(this,e,s)}}])}(ke),Ye=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"copyInternal",value:function(){return new t(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return _t.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||R(t,"isClosed",this,1).call(this)}},{key:"reverseInternal",value:function(){var e=this._points.copy();return Cn.reverse(e),this.getFactory().createLinearRing(e)}},{key:"getTypeCode",value:function(){return vt.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!R(t,"isClosed",this,1).call(this))throw new F("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new F("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return vt.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var e=arguments[0],s=arguments[1];hi.constructor_.call(this,e,s),this.validateConstruction()}}])}(hi);Ye.MINIMUM_VALID_SIZE=4;var mn=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"setOrdinate",value:function(e,s){switch(e){case t.X:this.x=s;break;case t.Y:this.y=s;break;default:throw new F("Invalid ordinate index: "+e)}}},{key:"getZ",value:function(){return et.NULL_ORDINATE}},{key:"getOrdinate",value:function(e){switch(e){case t.X:return this.x;case t.Y:return this.y}throw new F("Invalid ordinate index: "+e)}},{key:"setZ",value:function(e){throw new F("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new t(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)et.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof t){var e=arguments[0];et.constructor_.call(this,e.x,e.y)}else if(arguments[0]instanceof et){var s=arguments[0];et.constructor_.call(this,s.x,s.y)}}else if(arguments.length===2){var c=arguments[0],p=arguments[1];et.constructor_.call(this,c,p,et.NULL_ORDINATE)}}}])}(et);mn.X=0,mn.Y=1,mn.Z=-1,mn.M=-1;var bn=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(e,s){switch(e){case t.X:this.x=s;break;case t.Y:this.y=s;break;case t.M:this._m=s;break;default:throw new F("Invalid ordinate index: "+e)}}},{key:"setM",value:function(e){this._m=e}},{key:"getZ",value:function(){return et.NULL_ORDINATE}},{key:"getOrdinate",value:function(e){switch(e){case t.X:return this.x;case t.Y:return this.y;case t.M:return this._m}throw new F("Invalid ordinate index: "+e)}},{key:"setZ",value:function(e){throw new F("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new t(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ(),this._m=e.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)et.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof t){var e=arguments[0];et.constructor_.call(this,e.x,e.y),this._m=e._m}else if(arguments[0]instanceof et){var s=arguments[0];et.constructor_.call(this,s.x,s.y),this._m=this.getM()}}else if(arguments.length===3){var c=arguments[0],p=arguments[1],_=arguments[2];et.constructor_.call(this,c,p,et.NULL_ORDINATE),this._m=_}}}])}(et);bn.X=0,bn.Y=1,bn.Z=-1,bn.M=2;var wr=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(e,s){switch(e){case et.X:this.x=s;break;case et.Y:this.y=s;break;case et.Z:this.z=s;break;case et.M:this._m=s;break;default:throw new F("Invalid ordinate index: "+e)}}},{key:"setM",value:function(e){this._m=e}},{key:"getOrdinate",value:function(e){switch(e){case et.X:return this.x;case et.Y:return this.y;case et.Z:return this.getZ();case et.M:return this.getM()}throw new F("Invalid ordinate index: "+e)}},{key:"copy",value:function(){return new t(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ(),this._m=e.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)et.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof t){var e=arguments[0];et.constructor_.call(this,e),this._m=e._m}else if(arguments[0]instanceof et){var s=arguments[0];et.constructor_.call(this,s),this._m=this.getM()}}else if(arguments.length===4){var c=arguments[0],p=arguments[1],_=arguments[2],w=arguments[3];et.constructor_.call(this,c,p,_),this._m=w}}}])}(et),Ri=function(){function o(){l(this,o)}return d(o,null,[{key:"measures",value:function(t){return t instanceof mn?0:t instanceof bn||t instanceof wr?1:0}},{key:"dimension",value:function(t){return t instanceof mn?2:t instanceof bn?3:t instanceof wr?4:3}},{key:"create",value:function(){if(arguments.length===1){var t=arguments[0];return o.create(t,0)}if(arguments.length===2){var e=arguments[0],s=arguments[1];return e===2?new mn:e===3&&s===0?new et:e===3&&s===1?new bn:e===4&&s===1?new wr:new et}}}])}(),fi=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"getCoordinate",value:function(e){return this.get(e)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&Nt(arguments[0],At)){for(var e=arguments[1],s=!1,c=arguments[0].iterator();c.hasNext();)this.add(c.next(),e),s=!0;return s}return R(t,"addAll",this,1).apply(this,arguments)}},{key:"clone",value:function(){for(var e=R(t,"clone",this,1).call(this),s=0;s<this.size();s++)e.add(s,this.get(s).clone());return e}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(t.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(t.coordArrayType);for(var e=this.size(),s=new Array(e).fill(null),c=0;c<e;c++)s[c]=this.get(e-c-1);return s}}},{key:"add",value:function(){if(arguments.length===1){var e=arguments[0];return R(t,"add",this,1).call(this,e)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var s=arguments[0],c=arguments[1];return this.add(s,c,!0),!0}if(arguments[0]instanceof et&&typeof arguments[1]=="boolean"){var p=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(p))return null;R(t,"add",this,1).call(this,p)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var _=arguments[0],w=arguments[1];return this.add(_,w),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var C=arguments[0],z=arguments[1];if(arguments[2])for(var tt=0;tt<C.length;tt++)this.add(C[tt],z);else for(var it=C.length-1;it>=0;it--)this.add(C[it],z);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof et){var dt=arguments[0],xt=arguments[1];if(!arguments[2]){var Et=this.size();if(Et>0&&(dt>0&&this.get(dt-1).equals2D(xt)||dt<Et&&this.get(dt).equals2D(xt)))return null}R(t,"add",this,1).call(this,dt,xt)}}else if(arguments.length===4){var Mt=arguments[0],Ut=arguments[1],zt=arguments[2],jt=arguments[3],ee=1;zt>jt&&(ee=-1);for(var fe=zt;fe!==jt;fe+=ee)this.add(Mt[fe],Ut);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var e=this.get(0).copy();this.add(e,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.ensureCapacity(s.length),this.add(s,c)}}}}])}(It);fi.coordArrayType=new Array(0).fill(null);var oe=function(){function o(){l(this,o)}return d(o,null,[{key:"isRing",value:function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])}},{key:"ptNotInList",value:function(t,e){for(var s=0;s<t.length;s++){var c=t[s];if(o.indexOf(c,e)<0)return c}return null}},{key:"scroll",value:function(t,e){var s=o.indexOf(e,t);if(s<0)return null;var c=new Array(t.length).fill(null);Re.arraycopy(t,s,c,0,t.length-s),Re.arraycopy(t,0,c,t.length-s,s),Re.arraycopy(c,0,t,0,t.length)}},{key:"equals",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(t===null||e===null||t.length!==e.length)return!1;for(var s=0;s<t.length;s++)if(!t[s].equals(e[s]))return!1;return!0}if(arguments.length===3){var c=arguments[0],p=arguments[1],_=arguments[2];if(c===p)return!0;if(c===null||p===null||c.length!==p.length)return!1;for(var w=0;w<c.length;w++)if(_.compare(c[w],p[w])!==0)return!1;return!0}}},{key:"intersection",value:function(t,e){for(var s=new fi,c=0;c<t.length;c++)e.intersects(t[c])&&s.add(t[c],!0);return s.toCoordinateArray()}},{key:"measures",value:function(t){if(t===null||t.length===0)return 0;var e,s=0,c=x(t);try{for(c.s();!(e=c.n()).done;){var p=e.value;s=Math.max(s,Ri.measures(p))}}catch(_){c.e(_)}finally{c.f()}return s}},{key:"hasRepeatedPoints",value:function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(t){return o.hasRepeatedPoints(t)?new fi(t,!1).toCoordinateArray():t}},{key:"reverse",value:function(t){for(var e=t.length-1,s=Math.trunc(e/2),c=0;c<=s;c++){var p=t[c];t[c]=t[e-c],t[e-c]=p}}},{key:"removeNull",value:function(t){for(var e=0,s=0;s<t.length;s++)t[s]!==null&&e++;var c=new Array(e).fill(null);if(e===0)return c;for(var p=0,_=0;_<t.length;_++)t[_]!==null&&(c[p++]=t[_]);return c}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var t=arguments[0],e=new Array(t.length).fill(null),s=0;s<t.length;s++)e[s]=t[s].copy();return e}if(arguments.length===5)for(var c=arguments[0],p=arguments[1],_=arguments[2],w=arguments[3],C=arguments[4],z=0;z<C;z++)_[w+z]=c[p+z].copy()}},{key:"isEqualReversed",value:function(t,e){for(var s=0;s<t.length;s++){var c=t[s],p=e[t.length-s-1];if(c.compareTo(p)!==0)return!1}return!0}},{key:"envelope",value:function(t){for(var e=new Ct,s=0;s<t.length;s++)e.expandToInclude(t[s]);return e}},{key:"toCoordinateArray",value:function(t){return t.toArray(o.coordArrayType)}},{key:"dimension",value:function(t){if(t===null||t.length===0)return 3;var e,s=0,c=x(t);try{for(c.s();!(e=c.n()).done;){var p=e.value;s=Math.max(s,Ri.dimension(p))}}catch(_){c.e(_)}finally{c.f()}return s}},{key:"atLeastNCoordinatesOrNothing",value:function(t,e){return e.length>=t?e:[]}},{key:"indexOf",value:function(t,e){for(var s=0;s<e.length;s++)if(t.equals(e[s]))return s;return-1}},{key:"increasingDirection",value:function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var s=t.length-1-e,c=t[e].compareTo(t[s]);if(c!==0)return c}return 1}},{key:"compare",value:function(t,e){for(var s=0;s<t.length&&s<e.length;){var c=t[s].compareTo(e[s]);if(c!==0)return c;s++}return s<e.length?-1:s<t.length?1:0}},{key:"minCoordinate",value:function(t){for(var e=null,s=0;s<t.length;s++)(e===null||e.compareTo(t[s])>0)&&(e=t[s]);return e}},{key:"extract",value:function(t,e,s){e=Xn.clamp(e,0,t.length);var c=(s=Xn.clamp(s,-1,t.length))-e+1;s<0&&(c=0),e>=t.length&&(c=0),s<e&&(c=0);var p=new Array(c).fill(null);if(c===0)return p;for(var _=0,w=e;w<=s;w++)p[_++]=t[w];return p}}])}(),yo=function(){return d(function o(){l(this,o)},[{key:"compare",value:function(o,t){var e=o,s=t;return oe.compare(e,s)}},{key:"interfaces_",get:function(){return[ot]}}])}(),Di=function(){return d(function o(){l(this,o)},[{key:"compare",value:function(o,t){var e=o,s=t;if(e.length<s.length)return-1;if(e.length>s.length)return 1;if(e.length===0)return 0;var c=oe.compare(e,s);return oe.isEqualReversed(e,s)?0:c}},{key:"OLDcompare",value:function(o,t){var e=o,s=t;if(e.length<s.length)return-1;if(e.length>s.length)return 1;if(e.length===0)return 0;for(var c=oe.increasingDirection(e),p=oe.increasingDirection(s),_=c>0?0:e.length-1,w=p>0?0:e.length-1,C=0;C<e.length;C++){var z=e[_].compareTo(s[w]);if(z!==0)return z;_+=c,w+=p}return 0}},{key:"interfaces_",get:function(){return[ot]}}])}();oe.ForwardComparator=yo,oe.BidirectionalComparator=Di,oe.coordArrayType=new Array(0).fill(null);var Fi=function(){return d(function o(t){l(this,o),this.str=t},[{key:"append",value:function(o){this.str+=o}},{key:"setCharAt",value:function(o,t){this.str=this.str.substr(0,o)+t+this.str.substr(o+1)}},{key:"toString",value:function(){return this.str}}])}(),gi=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"getM",value:function(t){return this.hasM()?this._coordinates[t].getM():J.NaN}},{key:"setOrdinate",value:function(t,e,s){switch(e){case qt.X:this._coordinates[t].x=s;break;case qt.Y:this._coordinates[t].y=s;break;default:this._coordinates[t].setOrdinate(e,s)}}},{key:"getZ",value:function(t){return this.hasZ()?this._coordinates[t].getZ():J.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(t,e){switch(e){case qt.X:return this._coordinates[t].x;case qt.Y:return this._coordinates[t].y;default:return this._coordinates[t].getOrdinate(e)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var t=arguments[0];return this._coordinates[t]}if(arguments.length===2){var e=arguments[0];arguments[1].setCoordinate(this._coordinates[e])}}},{key:"getCoordinateCopy",value:function(t){var e=this.createCoordinate();return e.setCoordinate(this._coordinates[t]),e}},{key:"createCoordinate",value:function(){return Ri.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(t){return this._coordinates[t].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}},{key:"copy",value:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++){var s=this.createCoordinate();s.setCoordinate(this._coordinates[e]),t[e]=s}return new o(t,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var t=new Fi(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}},{key:"getY",value:function(t){return this._coordinates[t].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[qt,S]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];o.constructor_.call(this,t,oe.dimension(t),oe.measures(t))}else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var s=0;s<e;s++)this._coordinates[s]=new et}else if(Nt(arguments[0],qt)){var c=arguments[0];if(c===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=c.getDimension(),this._measures=c.getMeasures(),this._coordinates=new Array(c.size()).fill(null);for(var p=0;p<this._coordinates.length;p++)this._coordinates[p]=c.getCoordinateCopy(p)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var _=arguments[0],w=arguments[1];o.constructor_.call(this,_,w,oe.measures(_))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var C=arguments[0],z=arguments[1];this._coordinates=new Array(C).fill(null),this._dimension=z;for(var tt=0;tt<C;tt++)this._coordinates[tt]=Ri.create(z)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var it=arguments[0],dt=arguments[1],xt=arguments[2];this._dimension=dt,this._measures=xt,this._coordinates=it===null?new Array(0).fill(null):it}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var Et=arguments[0],Mt=arguments[1],Ut=arguments[2];this._coordinates=new Array(Et).fill(null),this._dimension=Mt,this._measures=Ut;for(var zt=0;zt<Et;zt++)this._coordinates[zt]=this.createCoordinate()}}}}])}(),Er=function(){function o(){l(this,o)}return d(o,[{key:"readResolve",value:function(){return o.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array)return new gi(arguments[0]);if(Nt(arguments[0],qt))return new gi(arguments[0])}else{if(arguments.length===2){var t=arguments[1];return t>3&&(t=3),t<2&&(t=2),new gi(arguments[0],t)}if(arguments.length===3){var e=arguments[2],s=arguments[1]-e;return e>1&&(e=1),s>3&&(s=3),s<2&&(s=2),new gi(arguments[0],s+e,e)}}}},{key:"interfaces_",get:function(){return[_r,S]}}],[{key:"instance",value:function(){return o.instanceObject}}])}();Er.instanceObject=new Er;var Pr=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"copyInternal",value:function(){for(var e=new Array(this._geometries.length).fill(null),s=0;s<e.length;s++)e[s]=this._geometries[s].copy();return new t(e,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];return!!this.isEquivalentClass(e)&&R(t,"equalsExact",this,1).call(this,e,s)}return R(t,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return vt.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var e=new It,s=0;s<this._geometries.length;s++)for(var c=this._geometries[s].getBoundary(),p=0;p<c.getNumGeometries();p++)e.add(c.getGeometryN(p));var _=new Array(e.size()).fill(null);return this.getFactory().createMultiLineString(e.toArray(_))}},{key:"getGeometryType",value:function(){return vt.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Pt]}}],[{key:"constructor_",value:function(){var e=arguments[0],s=arguments[1];ke.constructor_.call(this,e,s)}}])}(ke),ys=function(){return d(function o(){l(this,o)},[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}])}(),Mr=function(o){function t(){var e;return l(this,t),(e=a(this,t)).map=new Map,e}return I(t,o),d(t,[{key:"get",value:function(e){return this.map.get(e)||null}},{key:"put",value:function(e,s){return this.map.set(e,s),s}},{key:"values",value:function(){for(var e=new It,s=this.map.values(),c=s.next();!c.done;)e.add(c.value),c=s.next();return e}},{key:"entrySet",value:function(){var e=new he;return this.map.entries().forEach(function(s){return e.add(s)}),e}},{key:"size",value:function(){return this.map.size()}}])}(ys),we=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"equals",value:function(t){if(!(t instanceof o))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale}},{key:"compareTo",value:function(t){var e=t,s=this.getMaximumSignificantDigits(),c=e.getMaximumSignificantDigits();return Ze.compare(s,c)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===o.FLOATING||this._modelType===o.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var t="UNKNOWN";return this._modelType===o.FLOATING?t="Floating":this._modelType===o.FLOATING_SINGLE?t="Floating-Single":this._modelType===o.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var t=arguments[0];return J.isNaN(t)||this._modelType===o.FLOATING_SINGLE?t:this._modelType===o.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof et){var e=arguments[0];if(this._modelType===o.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}}},{key:"getMaximumSignificantDigits",value:function(){var t=16;return this._modelType===o.FLOATING?t=16:this._modelType===o.FLOATING_SINGLE?t=6:this._modelType===o.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}},{key:"setScale",value:function(t){this._scale=Math.abs(t)}},{key:"interfaces_",get:function(){return[S,K]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=o.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Tn){var t=arguments[0];this._modelType=t,t===o.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var e=arguments[0];this._modelType=o.FIXED,this.setScale(e)}else if(arguments[0]instanceof o){var s=arguments[0];this._modelType=s._modelType,this._scale=s._scale}}}},{key:"mostPrecise",value:function(t,e){return t.compareTo(e)>=0?t:e}}])}(),Tn=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"readResolve",value:function(){return o.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[S]}}],[{key:"constructor_",value:function(){this._name=null;var t=arguments[0];this._name=t,o.nameToTypeMap.put(t,this)}}])}();Tn.nameToTypeMap=new Mr,we.Type=Tn,we.FIXED=new Tn("FIXED"),we.FLOATING=new Tn("FLOATING"),we.FLOATING_SINGLE=new Tn("FLOATING SINGLE"),we.maximumPreciseValue=9007199254740992;var Bi=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"copyInternal",value:function(){for(var e=new Array(this._geometries.length).fill(null),s=0;s<e.length;s++)e[s]=this._geometries[s].copy();return new t(e,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];return!!this.isEquivalentClass(e)&&R(t,"equalsExact",this,1).call(this,e,s)}return R(t,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?_t.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return vt.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new Lt}},{key:"getGeometryType",value:function(){return vt.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[fs]}}],[{key:"constructor_",value:function(){var e=arguments[0],s=arguments[1];ke.constructor_.call(this,e,s)}}])}(ke),Xe=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"createEmpty",value:function(t){switch(t){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new F("Invalid dimension: "+t)}}},{key:"toGeometry",value:function(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new et(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new et(t.getMinX(),t.getMinY()),new et(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new et(t.getMinX(),t.getMinY()),new et(t.getMinX(),t.getMaxY()),new et(t.getMaxX(),t.getMaxY()),new et(t.getMaxX(),t.getMinY()),new et(t.getMinX(),t.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLineString(t!==null?this.getCoordinateSequenceFactory().create(t):null)}if(Nt(arguments[0],qt))return new hi(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return arguments.length===0?new Bi(null,this):arguments.length===1?new Bi(arguments[0],this):void 0}},{key:"buildGeometry",value:function(t){for(var e=null,s=!1,c=!1,p=t.iterator();p.hasNext();){var _=p.next(),w=_.getTypeCode();e===null&&(e=w),w!==e&&(s=!0),_ instanceof ke&&(c=!0)}if(e===null)return this.createGeometryCollection();if(s||c)return this.createGeometryCollection(o.toGeometryArray(t));var C=t.iterator().next();if(t.size()>1){if(C instanceof ci)return this.createMultiPolygon(o.toPolygonArray(t));if(C instanceof hi)return this.createMultiLineString(o.toLineStringArray(t));if(C instanceof xr)return this.createMultiPoint(o.toPointArray(t));ht.shouldNeverReachHere("Unhandled geometry type: "+C.getGeometryType())}return C}},{key:"createMultiPointFromCoords",value:function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof et){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}if(Nt(arguments[0],qt))return new xr(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(Nt(arguments[0],qt)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Ye){var s=arguments[0];return this.createPolygon(s,null)}}else if(arguments.length===2)return new ci(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return arguments.length===0?new ke(null,this):arguments.length===1?new ke(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}if(Nt(arguments[0],qt))return new Ye(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return arguments.length===0?new Pr(null,this):arguments.length===1?new Pr(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Ai(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new Ai(arguments[0],this);if(Nt(arguments[0],qt)){var t=arguments[0];if(t===null)return this.createMultiPoint(new Array(0).fill(null));for(var e=new Array(t.size()).fill(null),s=0;s<t.size();s++){var c=this.getCoordinateSequenceFactory().create(1,t.getDimension(),t.getMeasures());Cn.copy(t,s,c,0,1),e[s]=this.createPoint(c)}return this.createMultiPoint(e)}}}},{key:"interfaces_",get:function(){return[S]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)o.constructor_.call(this,new we,0);else if(arguments.length===1){if(Nt(arguments[0],_r)){var t=arguments[0];o.constructor_.call(this,new we,0,t)}else if(arguments[0]instanceof we){var e=arguments[0];o.constructor_.call(this,e,0,o.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];o.constructor_.call(this,s,c,o.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var p=arguments[0],_=arguments[1],w=arguments[2];this._precisionModel=p,this._coordinateSequenceFactory=w,this._SRID=_}}},{key:"toMultiPolygonArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toGeometryArray",value:function(t){if(t===null)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return Er.instance()}},{key:"toMultiLineStringArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toLineStringArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toMultiPointArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toLinearRingArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toPointArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toPolygonArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"createPointFromInternalCoord",value:function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}}])}(),Zt="XY",te="XYZ",zi="XYM",Wn="XYZM",Nn={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Gi="EMPTY",Ot=1,Kt=2,Ve=3,di=4,ce=5,vo=6;for(var Hi in Nn)Nn[Hi].toUpperCase();var On=function(){return d(function o(t){l(this,o),this.wkt=t,this.index_=-1},[{key:"isAlpha_",value:function(o){return o>="a"&&o<="z"||o>="A"&&o<="Z"}},{key:"isNumeric_",value:function(o,t){return o>="0"&&o<="9"||o=="."&&!(t!==void 0&&t)}},{key:"isWhiteSpace_",value:function(o){return o==" "||o=="	"||o=="\r"||o==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var o,t=this.nextChar_(),e=this.index_,s=t;if(t=="(")o=Kt;else if(t==",")o=ce;else if(t==")")o=Ve;else if(this.isNumeric_(t)||t=="-")o=di,s=this.readNumber_();else if(this.isAlpha_(t))o=Ot,s=this.readText_();else{if(this.isWhiteSpace_(t))return this.nextToken();if(t!=="")throw new Error("Unexpected character: "+t);o=vo}return{position:e,value:s,type:o}}},{key:"readNumber_",value:function(){var o,t=this.index_,e=!1,s=!1;do o=="."?e=!0:o!="e"&&o!="E"||(s=!0),o=this.nextChar_();while(this.isNumeric_(o,e)||!s&&(o=="e"||o=="E")||s&&(o=="-"||o=="+"));return parseFloat(this.wkt.substring(t,this.index_--))}},{key:"readText_",value:function(){var o,t=this.index_;do o=this.nextChar_();while(this.isAlpha_(o));return this.wkt.substring(t,this.index_--).toUpperCase()}}])}(),ae=function(){return d(function o(t,e){l(this,o),this.lexer_=t,this.token_,this.layout_=Zt,this.factory=e},[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(o){return this.token_.type==o}},{key:"match",value:function(o){var t=this.isTokenType(o);return t&&this.consume_(),t}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var o=Zt,t=this.token_;if(this.isTokenType(Ot)){var e=t.value;e==="Z"?o=te:e==="M"?o=zi:e==="ZM"&&(o=Wn),o!==Zt&&this.consume_()}return o}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(Kt)){var o=[];do o.push(this.parseGeometry_());while(this.match(ce));if(this.match(Ve))return o}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(Kt)){var o=this.parsePoint_();if(this.match(Ve))return o}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(Kt)){var o=this.parsePointList_();if(this.match(Ve))return o}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(Kt)){var o=this.parseLineStringTextList_();if(this.match(Ve))return o}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var o;if(this.match(Kt)){if(o=this.token_.type==Kt?this.parsePointTextList_():this.parsePointList_(),this.match(Ve))return o}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(Kt)){var o=this.parseLineStringTextList_();if(this.match(Ve))return o}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(Kt)){var o=this.parsePolygonTextList_();if(this.match(Ve))return o}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var o=[],t=this.layout_.length,e=0;e<t;++e){var s=this.token_;if(!this.match(di))break;o.push(s.value)}if(o.length==t)return o;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var o=[this.parsePoint_()];this.match(ce);)o.push(this.parsePoint_());return o}},{key:"parsePointTextList_",value:function(){for(var o=[this.parsePointText_()];this.match(ce);)o.push(this.parsePointText_());return o}},{key:"parseLineStringTextList_",value:function(){for(var o=[this.parseLineStringText_()];this.match(ce);)o.push(this.parseLineStringText_());return o}},{key:"parsePolygonTextList_",value:function(){for(var o=[this.parsePolygonText_()];this.match(ce);)o.push(this.parsePolygonText_());return o}},{key:"isEmptyGeometry_",value:function(){var o=this.isTokenType(Ot)&&this.token_.value==Gi;return o&&this.consume_(),o}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var o=this.factory,t=function(Mt){return g(et,W(Mt))},e=function(Mt){var Ut=Mt.map(function(zt){return o.createLinearRing(zt.map(t))});return Ut.length>1?o.createPolygon(Ut[0],Ut.slice(1)):o.createPolygon(Ut[0])},s=this.token_;if(this.match(Ot)){var c=s.value;if(this.layout_=this.parseGeometryLayout_(),c=="GEOMETRYCOLLECTION"){var p=this.parseGeometryCollectionText_();return o.createGeometryCollection(p)}switch(c){case"POINT":var _=this.parsePointText_();return _?o.createPoint(g(et,W(_))):o.createPoint();case"LINESTRING":var w=this.parseLineStringText_().map(t);return o.createLineString(w);case"LINEARRING":var C=this.parseLineStringText_().map(t);return o.createLinearRing(C);case"POLYGON":var z=this.parsePolygonText_();return z&&z.length!==0?e(z):o.createPolygon();case"MULTIPOINT":var tt=this.parseMultiPointText_();if(!tt||tt.length===0)return o.createMultiPoint();var it=tt.map(t).map(function(Mt){return o.createPoint(Mt)});return o.createMultiPoint(it);case"MULTILINESTRING":var dt=this.parseMultiLineStringText_().map(function(Mt){return o.createLineString(Mt.map(t))});return o.createMultiLineString(dt);case"MULTIPOLYGON":var xt=this.parseMultiPolygonText_();if(!xt||xt.length===0)return o.createMultiPolygon();var Et=xt.map(e);return o.createMultiPolygon(Et);default:throw new Error("Invalid geometry type: "+c)}}throw new Error(this.formatErrorMessage_())}}])}();function pn(o){if(o.isEmpty())return"";var t=o.getCoordinate(),e=[t.x,t.y];return t.z===void 0||Number.isNaN(t.z)||e.push(t.z),t.m===void 0||Number.isNaN(t.m)||e.push(t.m),e.join(" ")}function an(o){for(var t=o.getCoordinates().map(function(p){var _=[p.x,p.y];return p.z===void 0||Number.isNaN(p.z)||_.push(p.z),p.m===void 0||Number.isNaN(p.m)||_.push(p.m),_}),e=[],s=0,c=t.length;s<c;++s)e.push(t[s].join(" "));return e.join(", ")}function Kn(o){var t=[];t.push("("+an(o.getExteriorRing())+")");for(var e=0,s=o.getNumInteriorRing();e<s;++e)t.push("("+an(o.getInteriorRingN(e))+")");return t.join(", ")}var Ir={Point:pn,LineString:an,LinearRing:an,Polygon:Kn,MultiPoint:function(o){for(var t=[],e=0,s=o.getNumGeometries();e<s;++e)t.push("("+pn(o.getGeometryN(e))+")");return t.join(", ")},MultiLineString:function(o){for(var t=[],e=0,s=o.getNumGeometries();e<s;++e)t.push("("+an(o.getGeometryN(e))+")");return t.join(", ")},MultiPolygon:function(o){for(var t=[],e=0,s=o.getNumGeometries();e<s;++e)t.push("("+Kn(o.getGeometryN(e))+")");return t.join(", ")},GeometryCollection:function(o){for(var t=[],e=0,s=o.getNumGeometries();e<s;++e)t.push(Jn(o.getGeometryN(e)));return t.join(", ")}};function Jn(o){var t=o.getGeometryType(),e=Ir[t];t=t.toUpperCase();var s=function(c){var p="";if(c.isEmpty())return p;var _=c.getCoordinate();return _.z===void 0||Number.isNaN(_.z)||(p+="Z"),_.m===void 0||Number.isNaN(_.m)||(p+="M"),p}(o);return s.length>0&&(t+=" "+s),o.isEmpty()?t+" "+Gi:t+" ("+e(o)+")"}var Lr=function(){return d(function o(t){l(this,o),this.geometryFactory=t||new Xe,this.precisionModel=this.geometryFactory.getPrecisionModel()},[{key:"read",value:function(o){var t=new On(o);return new ae(t,this.geometryFactory).parse()}},{key:"write",value:function(o){return Jn(o)}}])}(),mi=function(){return d(function o(t){l(this,o),this.parser=new Lr(t)},[{key:"write",value:function(o){return this.parser.write(o)}}],[{key:"toLineString",value:function(o,t){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+o.x+" "+o.y+", "+t.x+" "+t.y+" )"}}])}(),Jt=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"getIndexAlongSegment",value:function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}},{key:"getTopologySummary",value:function(){var t=new Fi;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}},{key:"computeIntersection",value:function(t,e,s,c){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=s,this._inputLines[1][1]=c,this._result=this.computeIntersect(t,e,s,c)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(t){this._precisionModel=t}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}}},{key:"getIntersection",value:function(t){return this._intPt[t]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==o.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(t,e){return o.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])}},{key:"isCollinear",value:function(){return this._result===o.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return mi.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+mi.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(t,e){return this._inputLines[t][e]}},{key:"isIntersection",value:function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new et,this._intPt[1]=new et,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(t,e,s){var c=Math.abs(s.x-e.x),p=Math.abs(s.y-e.y),_=-1;if(t.equals(e))_=0;else if(t.equals(s))_=c>p?c:p;else{var w=Math.abs(t.x-e.x),C=Math.abs(t.y-e.y);(_=c>p?w:C)!==0||t.equals(e)||(_=Math.max(w,C))}return ht.isTrue(!(_===0&&!t.equals(e)),"Bad distance calculation"),_}},{key:"nonRobustComputeEdgeDistance",value:function(t,e,s){var c=t.x-e.x,p=t.y-e.y,_=Math.sqrt(c*c+p*p);return ht.isTrue(!(_===0&&!t.equals(e)),"Invalid distance calculation"),_}}])}();Jt.DONT_INTERSECT=0,Jt.DO_INTERSECT=1,Jt.COLLINEAR=2,Jt.NO_INTERSECTION=0,Jt.POINT_INTERSECTION=1,Jt.COLLINEAR_INTERSECTION=2;var un=function(o){function t(){return l(this,t),a(this,t)}return I(t,o),d(t,[{key:"isInSegmentEnvelopes",value:function(e){var s=new Ct(this._inputLines[0][0],this._inputLines[0][1]),c=new Ct(this._inputLines[1][0],this._inputLines[1][1]);return s.contains(e)&&c.contains(e)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return R(t,"computeIntersection",this,1).apply(this,arguments);var e=arguments[0],s=arguments[1],c=arguments[2];if(this._isProper=!1,Ct.intersects(s,c,e)&&bt.index(s,c,e)===0&&bt.index(c,s,e)===0)return this._isProper=!0,(e.equals(s)||e.equals(c))&&(this._isProper=!1),this._result=Jt.POINT_INTERSECTION,null;this._result=Jt.NO_INTERSECTION}},{key:"intersection",value:function(e,s,c,p){var _=this.intersectionSafe(e,s,c,p);return this.isInSegmentEnvelopes(_)||(_=new et(t.nearestEndpoint(e,s,c,p))),this._precisionModel!==null&&this._precisionModel.makePrecise(_),_}},{key:"checkDD",value:function(e,s,c,p,_){var w=pr.intersection(e,s,c,p),C=this.isInSegmentEnvelopes(w);Re.out.println("DD in env = "+C+"  --------------------- "+w),_.distance(w)>1e-4&&Re.out.println("Distance = "+_.distance(w))}},{key:"intersectionSafe",value:function(e,s,c,p){var _=vr.intersection(e,s,c,p);return _===null&&(_=t.nearestEndpoint(e,s,c,p)),_}},{key:"computeCollinearIntersection",value:function(e,s,c,p){var _=Ct.intersects(e,s,c),w=Ct.intersects(e,s,p),C=Ct.intersects(c,p,e),z=Ct.intersects(c,p,s);return _&&w?(this._intPt[0]=c,this._intPt[1]=p,Jt.COLLINEAR_INTERSECTION):C&&z?(this._intPt[0]=e,this._intPt[1]=s,Jt.COLLINEAR_INTERSECTION):_&&C?(this._intPt[0]=c,this._intPt[1]=e,!c.equals(e)||w||z?Jt.COLLINEAR_INTERSECTION:Jt.POINT_INTERSECTION):_&&z?(this._intPt[0]=c,this._intPt[1]=s,!c.equals(s)||w||C?Jt.COLLINEAR_INTERSECTION:Jt.POINT_INTERSECTION):w&&C?(this._intPt[0]=p,this._intPt[1]=e,!p.equals(e)||_||z?Jt.COLLINEAR_INTERSECTION:Jt.POINT_INTERSECTION):w&&z?(this._intPt[0]=p,this._intPt[1]=s,!p.equals(s)||_||C?Jt.COLLINEAR_INTERSECTION:Jt.POINT_INTERSECTION):Jt.NO_INTERSECTION}},{key:"computeIntersect",value:function(e,s,c,p){if(this._isProper=!1,!Ct.intersects(e,s,c,p))return Jt.NO_INTERSECTION;var _=bt.index(e,s,c),w=bt.index(e,s,p);if(_>0&&w>0||_<0&&w<0)return Jt.NO_INTERSECTION;var C=bt.index(c,p,e),z=bt.index(c,p,s);return C>0&&z>0||C<0&&z<0?Jt.NO_INTERSECTION:_===0&&w===0&&C===0&&z===0?this.computeCollinearIntersection(e,s,c,p):(_===0||w===0||C===0||z===0?(this._isProper=!1,e.equals2D(c)||e.equals2D(p)?this._intPt[0]=e:s.equals2D(c)||s.equals2D(p)?this._intPt[0]=s:_===0?this._intPt[0]=new et(c):w===0?this._intPt[0]=new et(p):C===0?this._intPt[0]=new et(e):z===0&&(this._intPt[0]=new et(s))):(this._isProper=!0,this._intPt[0]=this.intersection(e,s,c,p)),Jt.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(e,s,c,p){var _=e,w=ze.pointToSegment(e,c,p),C=ze.pointToSegment(s,c,p);return C<w&&(w=C,_=s),(C=ze.pointToSegment(c,e,s))<w&&(w=C,_=c),(C=ze.pointToSegment(p,e,s))<w&&(w=C,_=p),_}}])}(Jt),Sr=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"countSegment",value:function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var s=t.x,c=e.x;return s>c&&(s=e.x,c=t.x),this._p.x>=s&&this._p.x<=c&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var p=bt.index(t,e,this._p);if(p===bt.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(p=-p),p===bt.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==Y.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?Y.BOUNDARY:this._crossingCount%2==1?Y.INTERIOR:Y.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof et&&Nt(arguments[1],qt)){for(var t=arguments[1],e=new o(arguments[0]),s=new et,c=new et,p=1;p<t.size();p++)if(t.getCoordinate(p,s),t.getCoordinate(p-1,c),e.countSegment(s,c),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof et&&arguments[1]instanceof Array){for(var _=arguments[1],w=new o(arguments[0]),C=1;C<_.length;C++){var z=_[C],tt=_[C-1];if(w.countSegment(z,tt),w.isOnSegment())return w.getLocation()}return w.getLocation()}}}])}(),$n=function(){function o(){l(this,o)}return d(o,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof et&&Nt(arguments[1],qt)){for(var t=arguments[0],e=arguments[1],s=new un,c=new et,p=new et,_=e.size(),w=1;w<_;w++)if(e.getCoordinate(w-1,c),e.getCoordinate(w,p),s.computeIntersection(t,c,p),s.hasIntersection())return!0;return!1}if(arguments[0]instanceof et&&arguments[1]instanceof Array){for(var C=arguments[0],z=arguments[1],tt=new un,it=1;it<z.length;it++){var dt=z[it-1],xt=z[it];if(tt.computeIntersection(C,dt,xt),tt.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(t,e){return Sr.locatePointInRing(t,e)}},{key:"isInRing",value:function(t,e){return o.locateInRing(t,e)!==Y.EXTERIOR}}])}(),be=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"setAllLocations",value:function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t}},{key:"isNull",value:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==Y.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(t){for(var e=0;e<this.location.length;e++)this.location[e]===Y.NONE&&(this.location[e]=t)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[yt.ON]=this.location[yt.ON],e[yt.LEFT]=Y.NONE,e[yt.RIGHT]=Y.NONE,this.location=e}for(var s=0;s<this.location.length;s++)this.location[s]===Y.NONE&&s<t.location.length&&(this.location[s]=t.location[s])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var t=this.location[yt.LEFT];this.location[yt.LEFT]=this.location[yt.RIGHT],this.location[yt.RIGHT]=t}},{key:"toString",value:function(){var t=new dn;return this.location.length>1&&t.append(Y.toLocationSymbol(this.location[yt.LEFT])),t.append(Y.toLocationSymbol(this.location[yt.ON])),this.location.length>1&&t.append(Y.toLocationSymbol(this.location[yt.RIGHT])),t.toString()}},{key:"setLocations",value:function(t,e,s){this.location[yt.ON]=t,this.location[yt.LEFT]=e,this.location[yt.RIGHT]=s}},{key:"get",value:function(t){return t<this.location.length?this.location[t]:Y.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===Y.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var t=arguments[0];this.setLocation(yt.ON,t)}else if(arguments.length===2){var e=arguments[0],s=arguments[1];this.location[e]=s}}},{key:"init",value:function(t){this.location=new Array(t).fill(null),this.setAllLocations(Y.NONE)}},{key:"isEqualOnSide",value:function(t,e){return this.location[e]===t.location[e]}},{key:"allPositionsEqual",value:function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.init(1),this.location[yt.ON]=e}else if(arguments[0]instanceof o){var s=arguments[0];if(this.init(s.location.length),s!==null)for(var c=0;c<this.location.length;c++)this.location[c]=s.location[c]}}else if(arguments.length===3){var p=arguments[0],_=arguments[1],w=arguments[2];this.init(3),this.location[yt.ON]=p,this.location[yt.LEFT]=_,this.location[yt.RIGHT]=w}}}])}(),Ie=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"getGeometryCount",value:function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}},{key:"setAllLocations",value:function(t,e){this.elt[t].setAllLocations(e)}},{key:"isNull",value:function(t){return this.elt[t].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var e=arguments[0],s=arguments[1];this.elt[e].setAllLocationsIfNull(s)}}},{key:"isLine",value:function(t){return this.elt[t].isLine()}},{key:"merge",value:function(t){for(var e=0;e<2;e++)this.elt[e]===null&&t.elt[e]!==null?this.elt[e]=new be(t.elt[e]):this.elt[e].merge(t.elt[e])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(yt.ON)}if(arguments.length===2){var e=arguments[0],s=arguments[1];return this.elt[e].get(s)}}},{key:"toString",value:function(){var t=new dn;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}}},{key:"isAnyNull",value:function(t){return this.elt[t].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(yt.ON,e)}else if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2];this.elt[s].setLocation(c,p)}}},{key:"isEqualOnSide",value:function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}},{key:"allPositionsEqual",value:function(t,e){return this.elt[t].allPositionsEqual(e)}},{key:"toLine",value:function(t){this.elt[t].isArea()&&(this.elt[t]=new be(this.elt[t].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new be(t),this.elt[1]=new be(t)}else if(arguments[0]instanceof o){var e=arguments[0];this.elt[0]=new be(e.elt[0]),this.elt[1]=new be(e.elt[1])}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.elt[0]=new be(Y.NONE),this.elt[1]=new be(Y.NONE),this.elt[s].setLocation(c)}else if(arguments.length===3){var p=arguments[0],_=arguments[1],w=arguments[2];this.elt[0]=new be(p,_,w),this.elt[1]=new be(p,_,w)}else if(arguments.length===4){var C=arguments[0],z=arguments[1],tt=arguments[2],it=arguments[3];this.elt[0]=new be(Y.NONE,Y.NONE,Y.NONE),this.elt[1]=new be(Y.NONE,Y.NONE,Y.NONE),this.elt[C].setLocations(z,tt,it)}}},{key:"toLineLabel",value:function(t){for(var e=new o(Y.NONE),s=0;s<2;s++)e.setLocation(s,t.getLocation(s));return e}}])}(),qi=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var o=new Array(this._pts.size()).fill(null),t=0;t<this._pts.size();t++)o[t]=this._pts.get(t);this._ring=this._geometryFactory.createLinearRing(o),this._isHole=bt.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(o){this._startDe=o;var t=o,e=!0;do{if(t===null)throw new Ue("Found null DirectedEdge");if(t.getEdgeRing()===this)throw new Ue("Directed Edge visited twice during ring-building at "+t.getCoordinate());this._edges.add(t);var s=t.getLabel();ht.isTrue(s.isArea()),this.mergeLabel(s),this.addPoints(t.getEdge(),t.isForward(),e),e=!1,this.setEdgeRing(t,this),t=this.getNext(t)}while(t!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(o){return this._pts.get(o)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var o=this._startDe;do{var t=o.getNode().getEdges().getOutgoingDegree(this);t>this._maxNodeDegree&&(this._maxNodeDegree=t),o=this.getNext(o)}while(o!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(o,t,e){var s=o.getCoordinates();if(t){var c=1;e&&(c=0);for(var p=c;p<s.length;p++)this._pts.add(s[p])}else{var _=s.length-2;e&&(_=s.length-1);for(var w=_;w>=0;w--)this._pts.add(s[w])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var o=this._startDe;do o.getEdge().setInResult(!0),o=o.getNext();while(o!==this._startDe)}},{key:"containsPoint",value:function(o){var t=this.getLinearRing();if(!t.getEnvelopeInternal().contains(o)||!$n.isInRing(o,t.getCoordinates()))return!1;for(var e=this._holes.iterator();e.hasNext();)if(e.next().containsPoint(o))return!1;return!0}},{key:"addHole",value:function(o){this._holes.add(o)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var o=arguments[0];this.mergeLabel(o,0),this.mergeLabel(o,1)}else if(arguments.length===2){var t=arguments[1],e=arguments[0].getLocation(t,yt.RIGHT);if(e===Y.NONE)return null;if(this._label.getLocation(t)===Y.NONE)return this._label.setLocation(t,e),null}}},{key:"setShell",value:function(o){this._shell=o,o!==null&&o.addHole(this)}},{key:"toPolygon",value:function(o){for(var t=new Array(this._holes.size()).fill(null),e=0;e<this._holes.size();e++)t[e]=this._holes.get(e).getLinearRing();return o.createPolygon(this.getLinearRing(),t)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new It,this._pts=new It,this._label=new Ie(Y.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new It,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var o=arguments[0],t=arguments[1];this._geometryFactory=t,this.computePoints(o),this.computeRing()}}}}])}(),Rt=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"setEdgeRing",value:function(e,s){e.setMinEdgeRing(s)}},{key:"getNext",value:function(e){return e.getNextMin()}}],[{key:"constructor_",value:function(){var e=arguments[0],s=arguments[1];qi.constructor_.call(this,e,s)}}])}(qi),We=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"buildMinimalRings",value:function(){var e=new It,s=this._startDe;do{if(s.getMinEdgeRing()===null){var c=new Rt(s,this._geometryFactory);e.add(c)}s=s.getNext()}while(s!==this._startDe);return e}},{key:"setEdgeRing",value:function(e,s){e.setEdgeRing(s)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var e=this._startDe;do e.getNode().getEdges().linkMinimalDirectedEdges(this),e=e.getNext();while(e!==this._startDe)}},{key:"getNext",value:function(e){return e.getNext()}}],[{key:"constructor_",value:function(){var e=arguments[0],s=arguments[1];qi.constructor_.call(this,e,s)}}])}(qi),$t=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"setVisited",value:function(o){this._isVisited=o}},{key:"setInResult",value:function(o){this._isInResult=o}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(o){this._label=o}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(o){this._isCovered=o,this._isCoveredSet=!0}},{key:"updateIM",value:function(o){ht.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(o)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this._label=o}}}}])}(),pi=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"isIncidentEdgeInResult",value:function(){for(var e=this.getEdges().getEdges().iterator();e.hasNext();)if(e.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(e){e.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(e){}},{key:"computeMergedLocation",value:function(e,s){var c=Y.NONE;if(c=this._label.getLocation(s),!e.isNull(s)){var p=e.getLocation(s);c!==Y.BOUNDARY&&(c=p)}return c}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return R(t,"setLabel",this,1).apply(this,arguments);var e=arguments[0],s=arguments[1];this._label===null?this._label=new Ie(e,s):this._label.setLocation(e,s)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof t){var e=arguments[0];this.mergeLabel(e._label)}else if(arguments[0]instanceof Ie)for(var s=arguments[0],c=0;c<2;c++){var p=this.computeMergedLocation(s,c);this._label.getLocation(c)===Y.NONE&&this._label.setLocation(c,p)}}},{key:"add",value:function(e){this._edges.insert(e),e.setNode(this)}},{key:"setLabelBoundary",value:function(e){if(this._label===null)return null;var s=Y.NONE;this._label!==null&&(s=this._label.getLocation(e));var c=null;switch(s){case Y.BOUNDARY:c=Y.INTERIOR;break;case Y.INTERIOR:default:c=Y.BOUNDARY}this._label.setLocation(e,c)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var e=arguments[0],s=arguments[1];this._coord=e,this._edges=s,this._label=new Ie(0,Y.NONE)}}])}($t),Cr=function(o){function t(){return l(this,t),a(this,t,arguments)}return I(t,o),d(t)}(ys);function Zi(o){return o==null?0:o.color}function Yt(o){return o==null?null:o.parent}function de(o,t){o!==null&&(o.color=t)}function yi(o){return o==null?null:o.left}function jn(o){return o==null?null:o.right}var ne=function(o){function t(){var e;return l(this,t),(e=a(this,t)).root_=null,e.size_=0,e}return I(t,o),d(t,[{key:"get",value:function(e){for(var s=this.root_;s!==null;){var c=e.compareTo(s.key);if(c<0)s=s.left;else{if(!(c>0))return s.value;s=s.right}}return null}},{key:"put",value:function(e,s){if(this.root_===null)return this.root_={key:e,value:s,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var c,p,_=this.root_;do if(c=_,(p=e.compareTo(_.key))<0)_=_.left;else{if(!(p>0)){var w=_.value;return _.value=s,w}_=_.right}while(_!==null);var C={key:e,left:null,right:null,value:s,parent:c,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return p<0?c.left=C:c.right=C,this.fixAfterInsertion(C),this.size_++,null}},{key:"fixAfterInsertion",value:function(e){var s;for(e.color=1;e!=null&&e!==this.root_&&e.parent.color===1;)Yt(e)===yi(Yt(Yt(e)))?Zi(s=jn(Yt(Yt(e))))===1?(de(Yt(e),0),de(s,0),de(Yt(Yt(e)),1),e=Yt(Yt(e))):(e===jn(Yt(e))&&(e=Yt(e),this.rotateLeft(e)),de(Yt(e),0),de(Yt(Yt(e)),1),this.rotateRight(Yt(Yt(e)))):Zi(s=yi(Yt(Yt(e))))===1?(de(Yt(e),0),de(s,0),de(Yt(Yt(e)),1),e=Yt(Yt(e))):(e===yi(Yt(e))&&(e=Yt(e),this.rotateRight(e)),de(Yt(e),0),de(Yt(Yt(e)),1),this.rotateLeft(Yt(Yt(e))));this.root_.color=0}},{key:"values",value:function(){var e=new It,s=this.getFirstEntry();if(s!==null)for(e.add(s.value);(s=t.successor(s))!==null;)e.add(s.value);return e}},{key:"entrySet",value:function(){var e=new he,s=this.getFirstEntry();if(s!==null)for(e.add(s);(s=t.successor(s))!==null;)e.add(s);return e}},{key:"rotateLeft",value:function(e){if(e!=null){var s=e.right;e.right=s.left,s.left!=null&&(s.left.parent=e),s.parent=e.parent,e.parent==null?this.root_=s:e.parent.left===e?e.parent.left=s:e.parent.right=s,s.left=e,e.parent=s}}},{key:"rotateRight",value:function(e){if(e!=null){var s=e.left;e.left=s.right,s.right!=null&&(s.right.parent=e),s.parent=e.parent,e.parent==null?this.root_=s:e.parent.right===e?e.parent.right=s:e.parent.left=s,s.right=e,e.parent=s}}},{key:"getFirstEntry",value:function(){var e=this.root_;if(e!=null)for(;e.left!=null;)e=e.left;return e}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(e){for(var s=this.root_;s!==null;){var c=e.compareTo(s.key);if(c<0)s=s.left;else{if(!(c>0))return!0;s=s.right}}return!1}}],[{key:"successor",value:function(e){var s;if(e===null)return null;if(e.right!==null){for(s=e.right;s.left!==null;)s=s.left;return s}s=e.parent;for(var c=e;s!==null&&c===s.right;)c=s,s=s.parent;return s}}])}(Cr),yn=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"find",value:function(o){return this.nodeMap.get(o)}},{key:"addNode",value:function(){if(arguments[0]instanceof et){var o=arguments[0],t=this.nodeMap.get(o);return t===null&&(t=this.nodeFact.createNode(o),this.nodeMap.put(o,t)),t}if(arguments[0]instanceof pi){var e=arguments[0],s=this.nodeMap.get(e.getCoordinate());return s===null?(this.nodeMap.put(e.getCoordinate(),e),e):(s.mergeLabel(e),s)}}},{key:"print",value:function(o){for(var t=this.iterator();t.hasNext();)t.next().print(o)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(o){for(var t=new It,e=this.iterator();e.hasNext();){var s=e.next();s.getLabel().getLocation(o)===Y.BOUNDARY&&t.add(s)}return t}},{key:"add",value:function(o){var t=o.getCoordinate();this.addNode(t).add(o)}}],[{key:"constructor_",value:function(){this.nodeMap=new ne,this.nodeFact=null;var o=arguments[0];this.nodeFact=o}}])}(),me=function(){function o(){l(this,o)}return d(o,null,[{key:"isNorthern",value:function(t){return t===o.NE||t===o.NW}},{key:"isOpposite",value:function(t,e){return t!==e&&(t-e+4)%4===2}},{key:"commonHalfPlane",value:function(t,e){if(t===e)return t;if((t-e+4)%4===2)return-1;var s=t<e?t:e;return s===0&&(t>e?t:e)===3?3:s}},{key:"isInHalfPlane",value:function(t,e){return e===o.SE?t===o.SE||t===o.SW:t===e||t===e+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new F("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?o.NE:o.SE:e>=0?o.NW:o.SW}if(arguments[0]instanceof et&&arguments[1]instanceof et){var s=arguments[0],c=arguments[1];if(c.x===s.x&&c.y===s.y)throw new F("Cannot compute the quadrant for two identical points "+s);return c.x>=s.x?c.y>=s.y?o.NE:o.SE:c.y>=s.y?o.NW:o.SW}}}])}();me.NE=0,me.NW=1,me.SW=2,me.SE=3;var br=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"compareDirection",value:function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:bt.index(t._p0,t._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(t){this._node=t}},{key:"print",value:function(t){var e=Math.atan2(this._dy,this._dx),s=this.getClass().getName(),c=s.lastIndexOf("."),p=s.substring(c+1);t.print("  "+p+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}},{key:"compareTo",value:function(t){var e=t;return this.compareDirection(e)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),s=e.lastIndexOf(".");return"  "+e.substring(s+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}},{key:"computeLabel",value:function(t){}},{key:"init",value:function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=me.quadrant(this._dx,this._dy),ht.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[K]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var t=arguments[0];this._edge=t}else if(arguments.length===3){var e=arguments[0],s=arguments[1],c=arguments[2];o.constructor_.call(this,e,s,c,null)}else if(arguments.length===4){var p=arguments[0],_=arguments[1],w=arguments[2],C=arguments[3];o.constructor_.call(this,p),this.init(_,w),this._label=C}}}])}(),Tr=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(e){return this._depth[e]}},{key:"setVisited",value:function(e){this._isVisited=e}},{key:"computeDirectedLabel",value:function(){this._label=new Ie(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(e,s){if(this._depth[e]!==-999&&this._depth[e]!==s)throw new Ue("assigned depths do not match",this.getCoordinate());this._depth[e]=s}},{key:"isInteriorAreaEdge",value:function(){for(var e=!0,s=0;s<2;s++)this._label.isArea(s)&&this._label.getLocation(s,yt.LEFT)===Y.INTERIOR&&this._label.getLocation(s,yt.RIGHT)===Y.INTERIOR||(e=!1);return e}},{key:"setNextMin",value:function(e){this._nextMin=e}},{key:"print",value:function(e){R(t,"print",this,1).call(this,e),e.print(" "+this._depth[yt.LEFT]+"/"+this._depth[yt.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")}},{key:"setMinEdgeRing",value:function(e){this._minEdgeRing=e}},{key:"isLineEdge",value:function(){var e=this._label.isLine(0)||this._label.isLine(1),s=!this._label.isArea(0)||this._label.allPositionsEqual(0,Y.EXTERIOR),c=!this._label.isArea(1)||this._label.allPositionsEqual(1,Y.EXTERIOR);return e&&s&&c}},{key:"setEdgeRing",value:function(e){this._edgeRing=e}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var e=this._edge.getDepthDelta();return this._isForward||(e=-e),e}},{key:"setInResult",value:function(e){this._isInResult=e}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(e){this.print(e),e.print(" "),this._isForward?this._edge.print(e):this._edge.printReverse(e)}},{key:"setSym",value:function(e){this._sym=e}},{key:"setVisitedEdge",value:function(e){this.setVisited(e),this._sym.setVisited(e)}},{key:"setEdgeDepths",value:function(e,s){var c=this.getEdge().getDepthDelta();this._isForward||(c=-c);var p=1;e===yt.LEFT&&(p=-1);var _=yt.opposite(e),w=s+c*p;this.setDepth(e,s),this.setDepth(_,w)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(e){this._next=e}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var e=arguments[0],s=arguments[1];if(br.constructor_.call(this,e),this._isForward=s,s)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var c=e.getNumPoints()-1;this.init(e.getCoordinate(c),e.getCoordinate(c-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(e,s){return e===Y.EXTERIOR&&s===Y.INTERIOR?1:e===Y.INTERIOR&&s===Y.EXTERIOR?-1:0}}])}(br),Nr=function(){return d(function o(){l(this,o)},[{key:"createNode",value:function(o){return new pi(o,null)}}])}(),Ui=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"printEdges",value:function(o){o.println("Edges:");for(var t=0;t<this._edges.size();t++){o.println("edge "+t+":");var e=this._edges.get(t);e.print(o),e.eiList.print(o)}}},{key:"find",value:function(o){return this._nodes.find(o)}},{key:"addNode",value:function(){if(arguments[0]instanceof pi){var o=arguments[0];return this._nodes.addNode(o)}if(arguments[0]instanceof et){var t=arguments[0];return this._nodes.addNode(t)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var o=this._nodes.iterator();o.hasNext();)o.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(o){Re.out.println(o)}},{key:"isBoundaryNode",value:function(o,t){var e=this._nodes.find(t);if(e===null)return!1;var s=e.getLabel();return s!==null&&s.getLocation(o)===Y.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var o=this._nodes.iterator();o.hasNext();)o.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(o,t,e,s){return!!o.equals(e)&&bt.index(o,t,s)===bt.COLLINEAR&&me.quadrant(o,t)===me.quadrant(e,s)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(o){Re.out.print(o)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(o,t){for(var e=0;e<this._edges.size();e++){var s=this._edges.get(e),c=s.getCoordinates();if(this.matchInSameDirection(o,t,c[0],c[1])||this.matchInSameDirection(o,t,c[c.length-1],c[c.length-2]))return s}return null}},{key:"insertEdge",value:function(o){this._edges.add(o)}},{key:"findEdgeEnd",value:function(o){for(var t=this.getEdgeEnds().iterator();t.hasNext();){var e=t.next();if(e.getEdge()===o)return e}return null}},{key:"addEdges",value:function(o){for(var t=o.iterator();t.hasNext();){var e=t.next();this._edges.add(e);var s=new Tr(e,!0),c=new Tr(e,!1);s.setSym(c),c.setSym(s),this.add(s),this.add(c)}}},{key:"add",value:function(o){this._nodes.add(o),this._edgeEndList.add(o)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(o,t){for(var e=0;e<this._edges.size();e++){var s=this._edges.get(e),c=s.getCoordinates();if(o.equals(c[0])&&t.equals(c[1]))return s}return null}}],[{key:"constructor_",value:function(){if(this._edges=new It,this._nodes=null,this._edgeEndList=new It,arguments.length===0)this._nodes=new yn(new Nr);else if(arguments.length===1){var o=arguments[0];this._nodes=new yn(o)}}},{key:"linkResultDirectedEdges",value:function(o){for(var t=o.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()}}])}(),_o=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"sortShellsAndHoles",value:function(t,e,s){for(var c=t.iterator();c.hasNext();){var p=c.next();p.isHole()?s.add(p):e.add(p)}}},{key:"computePolygons",value:function(t){for(var e=new It,s=t.iterator();s.hasNext();){var c=s.next().toPolygon(this._geometryFactory);e.add(c)}return e}},{key:"placeFreeHoles",value:function(t,e){for(var s=e.iterator();s.hasNext();){var c=s.next();if(c.getShell()===null){var p=o.findEdgeRingContaining(c,t);if(p===null)throw new Ue("unable to assign hole to a shell",c.getCoordinate(0));c.setShell(p)}}}},{key:"buildMinimalEdgeRings",value:function(t,e,s){for(var c=new It,p=t.iterator();p.hasNext();){var _=p.next();if(_.getMaxNodeDegree()>2){_.linkDirectedEdgesForMinimalEdgeRings();var w=_.buildMinimalRings(),C=this.findShell(w);C!==null?(this.placePolygonHoles(C,w),e.add(C)):s.addAll(w)}else c.add(_)}return c}},{key:"buildMaximalEdgeRings",value:function(t){for(var e=new It,s=t.iterator();s.hasNext();){var c=s.next();if(c.isInResult()&&c.getLabel().isArea()&&c.getEdgeRing()===null){var p=new We(c,this._geometryFactory);e.add(p),p.setInResult()}}return e}},{key:"placePolygonHoles",value:function(t,e){for(var s=e.iterator();s.hasNext();){var c=s.next();c.isHole()&&c.setShell(t)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(t){for(var e=0,s=null,c=t.iterator();c.hasNext();){var p=c.next();p.isHole()||(s=p,e++)}return ht.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),s}},{key:"add",value:function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var e=arguments[0],s=arguments[1];Ui.linkResultDirectedEdges(s);var c=this.buildMaximalEdgeRings(e),p=new It,_=this.buildMinimalEdgeRings(c,this._shellList,p);this.sortShellsAndHoles(_,this._shellList,p),this.placeFreeHoles(this._shellList,p)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new It;var t=arguments[0];this._geometryFactory=t}},{key:"findEdgeRingContaining",value:function(t,e){for(var s=t.getLinearRing(),c=s.getEnvelopeInternal(),p=s.getCoordinateN(0),_=null,w=null,C=e.iterator();C.hasNext();){var z=C.next(),tt=z.getLinearRing(),it=tt.getEnvelopeInternal();if(!it.equals(c)&&it.contains(c)){p=oe.ptNotInList(s.getCoordinates(),tt.getCoordinates());var dt=!1;$n.isInRing(p,tt.getCoordinates())&&(dt=!0),dt&&(_===null||w.contains(it))&&(w=(_=z).getLinearRing().getEnvelopeInternal())}}return _}}])}(),Or=function(){return d(function o(){l(this,o)},[{key:"getBounds",value:function(){}}])}(),Dt=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[Or,S]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var o=arguments[0],t=arguments[1];this._bounds=o,this._item=t}}])}(),Yi=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"poll",value:function(){if(this.isEmpty())return null;var o=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),o}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(o){for(var t=null,e=this._items.get(o);2*o<=this._size&&((t=2*o)!==this._size&&this._items.get(t+1).compareTo(this._items.get(t))<0&&t++,this._items.get(t).compareTo(e)<0);o=t)this._items.set(o,this._items.get(t));this._items.set(o,e)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(o){this._items.add(null),this._size+=1;var t=this._size;for(this._items.set(0,o);o.compareTo(this._items.get(Math.trunc(t/2)))<0;t/=2)this._items.set(t,this._items.get(Math.trunc(t/2)));this._items.set(t,o)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new It,this._items.add(null)}}])}(),Ge=function(){return d(function o(){l(this,o)},[{key:"insert",value:function(o,t){}},{key:"remove",value:function(o,t){}},{key:"query",value:function(){}}])}(),pe=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(o){ht.isTrue(this._bounds===null),this._childBoundables.add(o)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[Or,S]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new It,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this._level=o}}}}])}(),An={reverseOrder:function(){return{compare:function(o,t){return t.compareTo(o)}}},min:function(o){return An.sort(o),o.get(0)},sort:function(o,t){var e=o.toArray();t?ge.sort(e,t):ge.sort(e);for(var s=o.iterator(),c=0,p=e.length;c<p;c++)s.next(),s.set(e[c])},singletonList:function(o){var t=new It;return t.add(o),t}},xo=function(){function o(){l(this,o)}return d(o,null,[{key:"maxDistance",value:function(t,e,s,c,p,_,w,C){var z=o.distance(t,e,p,_);return z=Math.max(z,o.distance(t,e,w,C)),z=Math.max(z,o.distance(s,c,p,_)),z=Math.max(z,o.distance(s,c,w,C))}},{key:"distance",value:function(t,e,s,c){var p=s-t,_=c-e;return Math.sqrt(p*p+_*_)}},{key:"maximumDistance",value:function(t,e){var s=Math.min(t.getMinX(),e.getMinX()),c=Math.min(t.getMinY(),e.getMinY()),p=Math.max(t.getMaxX(),e.getMaxX()),_=Math.max(t.getMaxY(),e.getMaxY());return o.distance(s,c,p,_)}},{key:"minMaxDistance",value:function(t,e){var s=t.getMinX(),c=t.getMinY(),p=t.getMaxX(),_=t.getMaxY(),w=e.getMinX(),C=e.getMinY(),z=e.getMaxX(),tt=e.getMaxY(),it=o.maxDistance(s,c,s,_,w,C,w,tt);return it=Math.min(it,o.maxDistance(s,c,s,_,w,C,z,C)),it=Math.min(it,o.maxDistance(s,c,s,_,z,tt,w,tt)),it=Math.min(it,o.maxDistance(s,c,s,_,z,tt,z,C)),it=Math.min(it,o.maxDistance(s,c,p,c,w,C,w,tt)),it=Math.min(it,o.maxDistance(s,c,p,c,w,C,z,C)),it=Math.min(it,o.maxDistance(s,c,p,c,z,tt,w,tt)),it=Math.min(it,o.maxDistance(s,c,p,c,z,tt,z,C)),it=Math.min(it,o.maxDistance(p,_,s,_,w,C,w,tt)),it=Math.min(it,o.maxDistance(p,_,s,_,w,C,z,C)),it=Math.min(it,o.maxDistance(p,_,s,_,z,tt,w,tt)),it=Math.min(it,o.maxDistance(p,_,s,_,z,tt,z,C)),it=Math.min(it,o.maxDistance(p,_,p,c,w,C,w,tt)),it=Math.min(it,o.maxDistance(p,_,p,c,w,C,z,C)),it=Math.min(it,o.maxDistance(p,_,p,c,z,tt,w,tt)),it=Math.min(it,o.maxDistance(p,_,p,c,z,tt,z,C))}}])}(),vn=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"maximumDistance",value:function(){return xo.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(t,e){var s=o.isComposite(this._boundable1),c=o.isComposite(this._boundable2);if(s&&c)return o.area(this._boundable1)>o.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,t,e),null):(this.expand(this._boundable2,this._boundable1,!0,t,e),null);if(s)return this.expand(this._boundable1,this._boundable2,!1,t,e),null;if(c)return this.expand(this._boundable2,this._boundable1,!0,t,e),null;throw new F("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(o.isComposite(this._boundable1)||o.isComposite(this._boundable2))}},{key:"compareTo",value:function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0}},{key:"expand",value:function(t,e,s,c,p){for(var _=t.getChildBoundables().iterator();_.hasNext();){var w=_.next(),C=null;(C=s?new o(e,w,this._itemDistance):new o(w,e,this._itemDistance)).getDistance()<p&&c.add(C)}}},{key:"getBoundable",value:function(t){return t===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[K]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],s=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=s,this._distance=this.distance()}},{key:"area",value:function(t){return t.getBounds().getArea()}},{key:"isComposite",value:function(t){return t instanceof pe}}])}(),vs=function(){return d(function o(){l(this,o)},[{key:"visitItem",value:function(o){}}])}(),Rn=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"queryInternal",value:function(){if(Nt(arguments[2],vs)&&arguments[0]instanceof Object&&arguments[1]instanceof pe)for(var t=arguments[0],e=arguments[2],s=arguments[1].getChildBoundables(),c=0;c<s.size();c++){var p=s.get(c);this.getIntersectsOp().intersects(p.getBounds(),t)&&(p instanceof pe?this.queryInternal(t,p,e):p instanceof Dt?e.visitItem(p.getItem()):ht.shouldNeverReachHere())}else if(Nt(arguments[2],qe)&&arguments[0]instanceof Object&&arguments[1]instanceof pe)for(var _=arguments[0],w=arguments[2],C=arguments[1].getChildBoundables(),z=0;z<C.size();z++){var tt=C.get(z);this.getIntersectsOp().intersects(tt.getBounds(),_)&&(tt instanceof pe?this.queryInternal(_,tt,w):tt instanceof Dt?w.add(tt.getItem()):ht.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(t){return t.get(t.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var s=e.next();s instanceof pe?t+=this.size(s):s instanceof Dt&&(t+=1)}return t}}},{key:"removeItem",value:function(t,e){for(var s=null,c=t.getChildBoundables().iterator();c.hasNext();){var p=c.next();p instanceof Dt&&p.getItem()===e&&(s=p)}return s!==null&&(t.getChildBoundables().remove(s),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var t=this.itemsTree(this._root);return t===null?new It:t}if(arguments.length===1){for(var e=arguments[0],s=new It,c=e.getChildBoundables().iterator();c.hasNext();){var p=c.next();if(p instanceof pe){var _=this.itemsTree(p);_!==null&&s.add(_)}else p instanceof Dt?s.add(p.getItem()):ht.shouldNeverReachHere()}return s.size()<=0?null:s}}},{key:"insert",value:function(t,e){ht.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Dt(t,e))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var t=arguments[0],e=new It;return this.boundablesAtLevel(t,this._root,e),e}if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2];if(ht.isTrue(s>-2),c.getLevel()===s)return p.add(c),null;for(var _=c.getChildBoundables().iterator();_.hasNext();){var w=_.next();w instanceof pe?this.boundablesAtLevel(s,w,p):(ht.isTrue(w instanceof Dt),s===-1&&p.add(w))}return null}}},{key:"query",value:function(){if(arguments.length===1){var t=arguments[0];this.build();var e=new It;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e),e}if(arguments.length===2){var s=arguments[0],c=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),s)&&this.queryInternal(s,this._root,c)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2],_=this.removeItem(c,p);if(_)return!0;for(var w=null,C=c.getChildBoundables().iterator();C.hasNext();){var z=C.next();if(this.getIntersectsOp().intersects(z.getBounds(),s)&&z instanceof pe&&(_=this.remove(s,z,p))){w=z;break}}return w!==null&&w.getChildBoundables().isEmpty()&&c.getChildBoundables().remove(w),_}}},{key:"createHigherLevels",value:function(t,e){ht.isTrue(!t.isEmpty());var s=this.createParentBoundables(t,e+1);return s.size()===1?s.get(0):this.createHigherLevels(s,e+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var s=e.next();if(s instanceof pe){var c=this.depth(s);c>t&&(t=c)}}return t+1}}},{key:"createParentBoundables",value:function(t,e){ht.isTrue(!t.isEmpty());var s=new It;s.add(this.createNode(e));var c=new It(t);An.sort(c,this.getComparator());for(var p=c.iterator();p.hasNext();){var _=p.next();this.lastNode(s).getChildBoundables().size()===this.getNodeCapacity()&&s.add(this.createNode(e)),this.lastNode(s).addChildBoundable(_)}return s}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[S]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new It,this._nodeCapacity=null,arguments.length===0)o.constructor_.call(this,o.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var t=arguments[0];ht.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}}},{key:"compareDoubles",value:function(t,e){return t>e?1:t<e?-1:0}}])}();Rn.IntersectsOp=function(){},Rn.DEFAULT_NODE_CAPACITY=10;var ko=function(){return d(function o(){l(this,o)},[{key:"distance",value:function(o,t){}}])}(),Ke=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"createParentBoundablesFromVerticalSlices",value:function(e,s){ht.isTrue(e.length>0);for(var c=new It,p=0;p<e.length;p++)c.addAll(this.createParentBoundablesFromVerticalSlice(e[p],s));return c}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var e=arguments[0],s=arguments[1];return this.nearestNeighbourK(e,J.POSITIVE_INFINITY,s)}if(arguments.length===3){var c=arguments[0],p=arguments[2],_=arguments[1],w=new Yi;w.add(c);for(var C=new Yi;!w.isEmpty()&&_>=0;){var z=w.poll(),tt=z.getDistance();if(tt>=_)break;z.isLeaves()?C.size()<p?C.add(z):(C.peek().getDistance()>tt&&(C.poll(),C.add(z)),_=C.peek().getDistance()):z.expandToQueue(w,_)}return t.getItems(C)}}},{key:"createNode",value:function(e){return new Xi(e)}},{key:"size",value:function(){return arguments.length===0?R(t,"size",this,1).call(this):R(t,"size",this,1).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ct))return R(t,"insert",this,1).apply(this,arguments);var e=arguments[0],s=arguments[1];if(e.isNull())return null;R(t,"insert",this,1).call(this,e,s)}},{key:"getIntersectsOp",value:function(){return t.intersectsOp}},{key:"verticalSlices",value:function(e,s){for(var c=Math.trunc(Math.ceil(e.size()/s)),p=new Array(s).fill(null),_=e.iterator(),w=0;w<s;w++){p[w]=new It;for(var C=0;_.hasNext()&&C<c;){var z=_.next();p[w].add(z),C++}}return p}},{key:"query",value:function(){if(arguments.length===1){var e=arguments[0];return R(t,"query",this,1).call(this,e)}if(arguments.length===2){var s=arguments[0],c=arguments[1];R(t,"query",this,1).call(this,s,c)}}},{key:"getComparator",value:function(){return t.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(e,s){return R(t,"createParentBoundables",this,1).call(this,e,s)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof Ct){var e=arguments[0],s=arguments[1];return R(t,"remove",this,1).call(this,e,s)}return R(t,"remove",this,1).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?R(t,"depth",this,1).call(this):R(t,"depth",this,1).apply(this,arguments)}},{key:"createParentBoundables",value:function(e,s){ht.isTrue(!e.isEmpty());var c=Math.trunc(Math.ceil(e.size()/this.getNodeCapacity())),p=new It(e);An.sort(p,t.xComparator);var _=this.verticalSlices(p,Math.trunc(Math.ceil(Math.sqrt(c))));return this.createParentBoundablesFromVerticalSlices(_,s)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(Nt(arguments[0],ko)){var e=arguments[0];if(this.isEmpty())return null;var s=new vn(this.getRoot(),this.getRoot(),e);return this.nearestNeighbour(s)}if(arguments[0]instanceof vn){var c=arguments[0],p=J.POSITIVE_INFINITY,_=null,w=new Yi;for(w.add(c);!w.isEmpty()&&p>0;){var C=w.poll(),z=C.getDistance();if(z>=p)break;C.isLeaves()?(p=z,_=C):C.expandToQueue(w,p)}return _===null?null:[_.getBoundable(0).getItem(),_.getBoundable(1).getItem()]}}else{if(arguments.length===2){var tt=arguments[0],it=arguments[1];if(this.isEmpty()||tt.isEmpty())return null;var dt=new vn(this.getRoot(),tt.getRoot(),it);return this.nearestNeighbour(dt)}if(arguments.length===3){var xt=arguments[2],Et=new Dt(arguments[0],arguments[1]),Mt=new vn(this.getRoot(),Et,xt);return this.nearestNeighbour(Mt)[0]}if(arguments.length===4){var Ut=arguments[2],zt=arguments[3],jt=new Dt(arguments[0],arguments[1]),ee=new vn(this.getRoot(),jt,Ut);return this.nearestNeighbourK(ee,zt)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var e=arguments[0],s=arguments[1],c=J.POSITIVE_INFINITY,p=new Yi;for(p.add(e);!p.isEmpty();){var _=p.poll(),w=_.getDistance();if(w>s)return!1;if(_.maximumDistance()<=s)return!0;if(_.isLeaves()){if((c=w)<=s)return!0}else _.expandToQueue(p,c)}return!1}if(arguments.length===3){var C=arguments[0],z=arguments[1],tt=arguments[2],it=new vn(this.getRoot(),C.getRoot(),z);return this.isWithinDistance(it,tt)}}},{key:"interfaces_",get:function(){return[Ge,S]}}],[{key:"constructor_",value:function(){if(arguments.length===0)t.constructor_.call(this,t.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var e=arguments[0];Rn.constructor_.call(this,e)}}},{key:"centreX",value:function(e){return t.avg(e.getMinX(),e.getMaxX())}},{key:"avg",value:function(e,s){return(e+s)/2}},{key:"getItems",value:function(e){for(var s=new Array(e.size()).fill(null),c=0;!e.isEmpty();){var p=e.poll();s[c]=p.getBoundable(0).getItem(),c++}return s}},{key:"centreY",value:function(e){return t.avg(e.getMinY(),e.getMaxY())}}])}(Rn),Xi=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"computeBounds",value:function(){for(var e=null,s=this.getChildBoundables().iterator();s.hasNext();){var c=s.next();e===null?e=new Ct(c.getBounds()):e.expandToInclude(c.getBounds())}return e}}],[{key:"constructor_",value:function(){var e=arguments[0];pe.constructor_.call(this,e)}}])}(pe);Ke.STRtreeNode=Xi,Ke.xComparator=new(function(){return d(function o(){l(this,o)},[{key:"interfaces_",get:function(){return[ot]}},{key:"compare",value:function(o,t){return Rn.compareDoubles(Ke.centreX(o.getBounds()),Ke.centreX(t.getBounds()))}}])}()),Ke.yComparator=new(function(){return d(function o(){l(this,o)},[{key:"interfaces_",get:function(){return[ot]}},{key:"compare",value:function(o,t){return Rn.compareDoubles(Ke.centreY(o.getBounds()),Ke.centreY(t.getBounds()))}}])}()),Ke.intersectsOp=new(function(){return d(function o(){l(this,o)},[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(o,t){return o.intersects(t)}}])}()),Ke.DEFAULT_NODE_CAPACITY=10;var wo=function(){function o(){l(this,o)}return d(o,null,[{key:"relativeSign",value:function(t,e){return t<e?-1:t>e?1:0}},{key:"compare",value:function(t,e,s){if(e.equals2D(s))return 0;var c=o.relativeSign(e.x,s.x),p=o.relativeSign(e.y,s.y);switch(t){case 0:return o.compareValue(c,p);case 1:return o.compareValue(p,c);case 2:return o.compareValue(p,-c);case 3:return o.compareValue(-c,p);case 4:return o.compareValue(-c,-p);case 5:return o.compareValue(-p,-c);case 6:return o.compareValue(-p,c);case 7:return o.compareValue(c,-p)}return ht.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0}}])}(),Je=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(o){o.print(this.coord),o.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(o){var t=o;return this.segmentIndex<t.segmentIndex?-1:this.segmentIndex>t.segmentIndex?1:this.coord.equals2D(t.coord)?0:this._isInterior?t._isInterior?wo.compare(this._segmentOctant,this.coord,t.coord):1:-1}},{key:"isEndPoint",value:function(o){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===o}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[K]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var o=arguments[0],t=arguments[1],e=arguments[2],s=arguments[3];this._segString=o,this.coord=new et(t),this.segmentIndex=e,this._segmentOctant=s,this._isInterior=!t.equals2D(o.getCoordinate(e))}}])}(),Eo=function(){return d(function o(){l(this,o)},[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}])}(),_s=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"getSplitCoordinates",value:function(){var o=new fi;this.addEndpoints();for(var t=this.iterator(),e=t.next();t.hasNext();){var s=t.next();this.addEdgeCoordinates(e,s,o),e=s}return o.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var o=new It;this.findCollapsesFromInsertedNodes(o),this.findCollapsesFromExistingVertices(o);for(var t=o.iterator();t.hasNext();){var e=t.next().intValue();this.add(this._edge.getCoordinate(e),e)}}},{key:"createSplitEdgePts",value:function(o,t){var e=t.segmentIndex-o.segmentIndex+2;if(e===2)return[new et(o.coord),new et(t.coord)];var s=this._edge.getCoordinate(t.segmentIndex),c=t.isInterior()||!t.coord.equals2D(s);c||e--;var p=new Array(e).fill(null),_=0;p[_++]=new et(o.coord);for(var w=o.segmentIndex+1;w<=t.segmentIndex;w++)p[_++]=this._edge.getCoordinate(w);return c&&(p[_]=new et(t.coord)),p}},{key:"print",value:function(o){o.println("Intersections:");for(var t=this.iterator();t.hasNext();)t.next().print(o)}},{key:"findCollapsesFromExistingVertices",value:function(o){for(var t=0;t<this._edge.size()-2;t++){var e=this._edge.getCoordinate(t);this._edge.getCoordinate(t+1);var s=this._edge.getCoordinate(t+2);e.equals2D(s)&&o.add(Ze.valueOf(t+1))}}},{key:"addEdgeCoordinates",value:function(o,t,e){var s=this.createSplitEdgePts(o,t);e.add(s,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(o){this.addEndpoints(),this.addCollapsedNodes();for(var t=this.iterator(),e=t.next();t.hasNext();){var s=t.next(),c=this.createSplitEdge(e,s);o.add(c),e=s}}},{key:"findCollapseIndex",value:function(o,t,e){if(!o.coord.equals2D(t.coord))return!1;var s=t.segmentIndex-o.segmentIndex;return t.isInterior()||s--,s===1&&(e[0]=o.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(o){for(var t=new Array(1).fill(null),e=this.iterator(),s=e.next();e.hasNext();){var c=e.next();this.findCollapseIndex(s,c,t)&&o.add(Ze.valueOf(t[0])),s=c}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var o=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(o),o)}},{key:"createSplitEdge",value:function(o,t){var e=this.createSplitEdgePts(o,t);return new ln(e,this._edge.getData())}},{key:"add",value:function(o,t){var e=new Je(this._edge,o,t,this._edge.getSegmentOctant(t)),s=this._nodeMap.get(e);return s!==null?(ht.isTrue(s.coord.equals2D(o),"Found equal nodes with different coordinates"),s):(this._nodeMap.put(e,e),e)}},{key:"checkSplitEdgesCorrectness",value:function(o){var t=this._edge.getCoordinates(),e=o.get(0).getCoordinate(0);if(!e.equals2D(t[0]))throw new ct("bad split edge start point at "+e);var s=o.get(o.size()-1).getCoordinates(),c=s[s.length-1];if(!c.equals2D(t[t.length-1]))throw new ct("bad split edge end point at "+c)}}],[{key:"constructor_",value:function(){this._nodeMap=new ne,this._edge=null;var o=arguments[0];this._edge=o}}])}(),_n=function(){function o(){l(this,o)}return d(o,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new F("Cannot compute the octant for point ( "+t+", "+e+" )");var s=Math.abs(t),c=Math.abs(e);return t>=0?e>=0?s>=c?0:1:s>=c?7:6:e>=0?s>=c?3:2:s>=c?4:5}if(arguments[0]instanceof et&&arguments[1]instanceof et){var p=arguments[0],_=arguments[1],w=_.x-p.x,C=_.y-p.y;if(w===0&&C===0)throw new F("Cannot compute the octant for two identical points "+p);return o.octant(w,C)}}}])}(),xs=function(){return d(function o(){l(this,o)},[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(o){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(o){}},{key:"getData",value:function(){}}])}(),ks=function(){return d(function o(){l(this,o)},[{key:"addIntersection",value:function(o,t){}},{key:"interfaces_",get:function(){return[xs]}}])}(),ln=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(t){return this._pts[t]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))}},{key:"setData",value:function(t){this._data=t}},{key:"safeOctant",value:function(t,e){return t.equals2D(e)?0:_n.octant(t,e)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(arguments.length===4){var s=arguments[1],c=arguments[3],p=new et(arguments[0].getIntersection(c));this.addIntersection(p,s)}}},{key:"toString",value:function(){return mi.toLineString(new gi(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(t,e){var s=e,c=s+1;if(c<this._pts.length){var p=this._pts[c];t.equals2D(p)&&(s=c)}return this._nodeList.add(t,s)}},{key:"addIntersections",value:function(t,e,s){for(var c=0;c<t.getIntersectionNum();c++)this.addIntersection(t,e,s,c)}},{key:"interfaces_",get:function(){return[ks]}}],[{key:"constructor_",value:function(){this._nodeList=new _s(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var t=arguments[0],e=new It;return o.getNodedSubstrings(t,e),e}if(arguments.length===2)for(var s=arguments[1],c=arguments[0].iterator();c.hasNext();)c.next().getNodeList().addSplitEdges(s)}}])}(),Te=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof o){var t=arguments[0],e=bt.index(this.p0,this.p1,t.p0),s=bt.index(this.p0,this.p1,t.p1);return e>=0&&s>=0||e<=0&&s<=0?Math.max(e,s):0}if(arguments[0]instanceof et){var c=arguments[0];return bt.index(this.p0,this.p1,c)}}},{key:"toGeometry",value:function(t){return t.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(t){if(!(t instanceof o))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)}},{key:"intersection",value:function(t){var e=new un;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof et){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new et(t);var e=this.projectionFactor(t),s=new et;return s.x=this.p0.x+e*(this.p1.x-this.p0.x),s.y=this.p0.y+e*(this.p1.y-this.p0.y),s}if(arguments[0]instanceof o){var c=arguments[0],p=this.projectionFactor(c.p0),_=this.projectionFactor(c.p1);if(p>=1&&_>=1||p<=0&&_<=0)return null;var w=this.project(c.p0);p<0&&(w=this.p0),p>1&&(w=this.p1);var C=this.project(c.p1);return _<0&&(C=this.p0),_>1&&(C=this.p1),new o(w,C)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(t){return t===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(t){return ze.pointToLinePerpendicular(t,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return o.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,c=e*e+s*s;return c<=0?J.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*s)/c}},{key:"closestPoints",value:function(t){var e=this.intersection(t);if(e!==null)return[e,e];var s=new Array(2).fill(null),c=J.MAX_VALUE,p=null,_=this.closestPoint(t.p0);c=_.distance(t.p0),s[0]=_,s[1]=t.p0;var w=this.closestPoint(t.p1);(p=w.distance(t.p1))<c&&(c=p,s[0]=w,s[1]=t.p1);var C=t.closestPoint(this.p0);(p=C.distance(this.p0))<c&&(c=p,s[0]=this.p0,s[1]=C);var z=t.closestPoint(this.p1);return(p=z.distance(this.p1))<c&&(c=p,s[0]=this.p1,s[1]=z),s}},{key:"closestPoint",value:function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(t){var e=t,s=this.p0.compareTo(e.p0);return s!==0?s:this.p1.compareTo(e.p1)}},{key:"reverse",value:function(){var t=this.p0;this.p0=this.p1,this.p1=t}},{key:"equalsTopo",value:function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}},{key:"lineIntersection",value:function(t){return vr.intersection(this.p0,this.p1,t.p0,t.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(t,e){var s=this.p0.x+t*(this.p1.x-this.p0.x),c=this.p0.y+t*(this.p1.y-this.p0.y),p=this.p1.x-this.p0.x,_=this.p1.y-this.p0.y,w=Math.sqrt(p*p+_*_),C=0,z=0;if(e!==0){if(w<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");C=e*p/w,z=e*_/w}return new et(s-z,c+C)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var e=arguments[0],s=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=s.x,this.p1.y=s.y}}},{key:"segmentFraction",value:function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||J.isNaN(e))&&(e=1),e}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(t){var e=this.p1.getY()-this.p0.getY(),s=this.p0.getX()-this.p1.getX(),c=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),p=e*e+s*s,_=e*e-s*s,w=t.getX(),C=t.getY();return new et((-_*w-2*e*s*C-2*e*c)/p,(_*C-2*e*s*w-2*s*c)/p)}},{key:"distance",value:function(){if(arguments[0]instanceof o){var t=arguments[0];return ze.segmentToSegment(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof et){var e=arguments[0];return ze.pointToSegment(e,this.p0,this.p1)}}},{key:"pointAlong",value:function(t){var e=new et;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}},{key:"hashCode",value:function(){var t=J.doubleToLongBits(this.p0.x);t^=31*J.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),s=J.doubleToLongBits(this.p1.x);return s^=31*J.doubleToLongBits(this.p1.y),e^(Math.trunc(s)^Math.trunc(s>>32))}},{key:"interfaces_",get:function(){return[K,S]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)o.constructor_.call(this,new et,new et);else if(arguments.length===1){var t=arguments[0];o.constructor_.call(this,t.p0,t.p1)}else if(arguments.length===2){var e=arguments[0],s=arguments[1];this.p0=e,this.p1=s}else if(arguments.length===4){var c=arguments[0],p=arguments[1],_=arguments[2],w=arguments[3];o.constructor_.call(this,new et(c,p),new et(_,w))}}},{key:"midPoint",value:function(t,e){return new et((t.x+e.x)/2,(t.y+e.y)/2)}}])}(),ws=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var o=arguments[1],t=arguments[2],e=arguments[3];arguments[0].getLineSegment(o,this._overlapSeg1),t.getLineSegment(e,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new Te,this._overlapSeg2=new Te}}])}(),Ar=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"getLineSegment",value:function(o,t){t.p0=this._pts[o],t.p1=this._pts[o+1]}},{key:"computeSelect",value:function(o,t,e,s){var c=this._pts[t],p=this._pts[e];if(e-t==1)return s.select(this,t),null;if(!o.intersects(c,p))return null;var _=Math.trunc((t+e)/2);t<_&&this.computeSelect(o,t,_,s),_<e&&this.computeSelect(o,_,e,s)}},{key:"getCoordinates",value:function(){for(var o=new Array(this._end-this._start+1).fill(null),t=0,e=this._start;e<=this._end;e++)o[t++]=this._pts[e];return o}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var o=arguments[0],t=arguments[1];this.computeOverlaps(this._start,this._end,o,o._start,o._end,t)}else if(arguments.length===6){var e=arguments[0],s=arguments[1],c=arguments[2],p=arguments[3],_=arguments[4],w=arguments[5];if(s-e==1&&_-p==1)return w.overlap(this,e,c,p),null;if(!this.overlaps(e,s,c,p,_))return null;var C=Math.trunc((e+s)/2),z=Math.trunc((p+_)/2);e<C&&(p<z&&this.computeOverlaps(e,C,c,p,z,w),z<_&&this.computeOverlaps(e,C,c,z,_,w)),C<s&&(p<z&&this.computeOverlaps(C,s,c,p,z,w),z<_&&this.computeOverlaps(C,s,c,z,_,w))}}},{key:"setId",value:function(o){this._id=o}},{key:"select",value:function(o,t){this.computeSelect(o,this._start,this._end,t)}},{key:"getEnvelope",value:function(){if(this._env===null){var o=this._pts[this._start],t=this._pts[this._end];this._env=new Ct(o,t)}return this._env}},{key:"overlaps",value:function(o,t,e,s,c){return Ct.intersects(this._pts[o],this._pts[t],e._pts[s],e._pts[c])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var o=arguments[0],t=arguments[1],e=arguments[2],s=arguments[3];this._pts=o,this._start=t,this._end=e,this._context=s}}])}(),Po=function(){function o(){l(this,o)}return d(o,null,[{key:"findChainEnd",value:function(t,e){for(var s=e;s<t.length-1&&t[s].equals2D(t[s+1]);)s++;if(s>=t.length-1)return t.length-1;for(var c=me.quadrant(t[s],t[s+1]),p=e+1;p<t.length&&!(!t[p-1].equals2D(t[p])&&me.quadrant(t[p-1],t[p])!==c);)p++;return p-1}},{key:"getChains",value:function(){if(arguments.length===1){var t=arguments[0];return o.getChains(t,null)}if(arguments.length===2){var e=arguments[0],s=arguments[1],c=new It,p=0;do{var _=o.findChainEnd(e,p),w=new Ar(e,p,_,s);c.add(w),p=_}while(p<e.length-1);return c}}}])}(),Rr=function(){return d(function o(){l(this,o)},[{key:"computeNodes",value:function(o){}},{key:"getNodedSubstrings",value:function(){}}])}(),Vi=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"setSegmentIntersector",value:function(o){this._segInt=o}},{key:"interfaces_",get:function(){return[Rr]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this.setSegmentIntersector(o)}}}}])}(),Dr=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return ln.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(e){for(var s=Po.getChains(e.getCoordinates(),e).iterator();s.hasNext();){var c=s.next();c.setId(this._idCounter++),this._index.insert(c.getEnvelope(),c),this._monoChains.add(c)}}},{key:"computeNodes",value:function(e){this._nodedSegStrings=e;for(var s=e.iterator();s.hasNext();)this.add(s.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var e=new Fr(this._segInt),s=this._monoChains.iterator();s.hasNext();)for(var c=s.next(),p=this._index.query(c.getEnvelope()).iterator();p.hasNext();){var _=p.next();if(_.getId()>c.getId()&&(c.computeOverlaps(_,e),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new It,this._index=new Ke,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var e=arguments[0];Vi.constructor_.call(this,e)}}}}])}(Vi),Fr=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"overlap",value:function(){if(arguments.length!==4)return R(t,"overlap",this,1).apply(this,arguments);var e=arguments[1],s=arguments[2],c=arguments[3],p=arguments[0].getContext(),_=s.getContext();this._si.processIntersections(p,e,_,c)}}],[{key:"constructor_",value:function(){this._si=null;var e=arguments[0];this._si=e}}])}(ws);Dr.SegmentOverlapAction=Fr;var De=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"isDeletable",value:function(t,e,s,c){var p=this._inputLine[t],_=this._inputLine[e],w=this._inputLine[s];return!!this.isConcave(p,_,w)&&!!this.isShallow(p,_,w,c)&&this.isShallowSampled(p,_,t,s,c)}},{key:"deleteShallowConcavities",value:function(){for(var t=1,e=this.findNextNonDeletedIndex(t),s=this.findNextNonDeletedIndex(e),c=!1;s<this._inputLine.length;){var p=!1;this.isDeletable(t,e,s,this._distanceTol)&&(this._isDeleted[e]=o.DELETE,p=!0,c=!0),t=p?s:e,e=this.findNextNonDeletedIndex(t),s=this.findNextNonDeletedIndex(e)}return c}},{key:"isShallowConcavity",value:function(t,e,s,c){return bt.index(t,e,s)===this._angleOrientation&&ze.pointToSegment(e,t,s)<c}},{key:"isShallowSampled",value:function(t,e,s,c,p){var _=Math.trunc((c-s)/o.NUM_PTS_TO_CHECK);_<=0&&(_=1);for(var w=s;w<c;w+=_)if(!this.isShallow(t,e,this._inputLine[w],p))return!1;return!0}},{key:"isConcave",value:function(t,e,s){var c=bt.index(t,e,s)===this._angleOrientation;return c}},{key:"simplify",value:function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=bt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do e=this.deleteShallowConcavities();while(e);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===o.DELETE;)e++;return e}},{key:"isShallow",value:function(t,e,s,c){return ze.pointToSegment(e,t,s)<c}},{key:"collapseLine",value:function(){for(var t=new fi,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==o.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=bt.COUNTERCLOCKWISE;var t=arguments[0];this._inputLine=t}},{key:"simplify",value:function(t,e){return new o(t).simplify(e)}}])}();De.INIT=0,De.DELETE=1,De.KEEP=1,De.NUM_PTS_TO_CHECK=10;var vi=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"getCoordinates",value:function(){return this._ptList.toArray(o.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(t){this._precisionModel=t}},{key:"addPt",value:function(t){var e=new et(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(t,e){if(e)for(var s=0;s<t.length;s++)this.addPt(t[s]);else for(var c=t.length-1;c>=0;c--)this.addPt(t[c])}},{key:"isRedundant",value:function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Xe().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var t=new et(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)}},{key:"setMinimumVertexDistance",value:function(t){this._minimimVertexDistance=t}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new It}}])}();vi.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var ue=function(){function o(){l(this,o)}return d(o,null,[{key:"toDegrees",value:function(t){return 180*t/Math.PI}},{key:"normalize",value:function(t){for(;t>Math.PI;)t-=o.PI_TIMES_2;for(;t<=-Math.PI;)t+=o.PI_TIMES_2;return t}},{key:"angle",value:function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}if(arguments.length===2){var e=arguments[0],s=arguments[1],c=s.x-e.x,p=s.y-e.y;return Math.atan2(p,c)}}},{key:"isAcute",value:function(t,e,s){var c=t.x-e.x,p=t.y-e.y;return c*(s.x-e.x)+p*(s.y-e.y)>0}},{key:"isObtuse",value:function(t,e,s){var c=t.x-e.x,p=t.y-e.y;return c*(s.x-e.x)+p*(s.y-e.y)<0}},{key:"interiorAngle",value:function(t,e,s){var c=o.angle(e,t),p=o.angle(e,s);return Math.abs(p-c)}},{key:"normalizePositive",value:function(t){if(t<0){for(;t<0;)t+=o.PI_TIMES_2;t>=o.PI_TIMES_2&&(t=0)}else{for(;t>=o.PI_TIMES_2;)t-=o.PI_TIMES_2;t<0&&(t=0)}return t}},{key:"angleBetween",value:function(t,e,s){var c=o.angle(e,t),p=o.angle(e,s);return o.diff(c,p)}},{key:"diff",value:function(t,e){var s=null;return(s=t<e?e-t:t-e)>Math.PI&&(s=2*Math.PI-s),s}},{key:"toRadians",value:function(t){return t*Math.PI/180}},{key:"getTurn",value:function(t,e){var s=Math.sin(e-t);return s>0?o.COUNTERCLOCKWISE:s<0?o.CLOCKWISE:o.NONE}},{key:"angleBetweenOriented",value:function(t,e,s){var c=o.angle(e,t),p=o.angle(e,s)-c;return p<=-Math.PI?p+o.PI_TIMES_2:p>Math.PI?p-o.PI_TIMES_2:p}}])}();ue.PI_TIMES_2=2*Math.PI,ue.PI_OVER_2=Math.PI/2,ue.PI_OVER_4=Math.PI/4,ue.COUNTERCLOCKWISE=bt.COUNTERCLOCKWISE,ue.CLOCKWISE=bt.CLOCKWISE,ue.NONE=bt.COLLINEAR;var _i=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"addNextSegment",value:function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var s=bt.index(this._s0,this._s1,this._s2),c=s===bt.CLOCKWISE&&this._side===yt.LEFT||s===bt.COUNTERCLOCKWISE&&this._side===yt.RIGHT;s===0?this.addCollinear(e):c?this.addOutsideTurn(s,e):this.addInsideTurn(s,e)}},{key:"addLineEndCap",value:function(t,e){var s=new Te(t,e),c=new Te;this.computeOffsetSegment(s,yt.LEFT,this._distance,c);var p=new Te;this.computeOffsetSegment(s,yt.RIGHT,this._distance,p);var _=e.x-t.x,w=e.y-t.y,C=Math.atan2(w,_);switch(this._bufParams.getEndCapStyle()){case q.CAP_ROUND:this._segList.addPt(c.p1),this.addDirectedFillet(e,C+Math.PI/2,C-Math.PI/2,bt.CLOCKWISE,this._distance),this._segList.addPt(p.p1);break;case q.CAP_FLAT:this._segList.addPt(c.p1),this._segList.addPt(p.p1);break;case q.CAP_SQUARE:var z=new et;z.x=Math.abs(this._distance)*Math.cos(C),z.y=Math.abs(this._distance)*Math.sin(C);var tt=new et(c.p1.x+z.x,c.p1.y+z.y),it=new et(p.p1.x+z.x,p.p1.y+z.y);this._segList.addPt(tt),this._segList.addPt(it)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(t,e,s,c){var p=vr.intersection(e.p0,e.p1,s.p0,s.p1);if(p!==null&&(c<=0?1:p.distance(t)/Math.abs(c))<=this._bufParams.getMitreLimit())return this._segList.addPt(p),null;this.addLimitedMitreJoin(e,s,c,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*o.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===q.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===q.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(t){this._segList.addPt(new et(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new et(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new et(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new et(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(t,e){this._segList.addPts(t,e)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(t,e,s,c,p){var _=e.x-t.x,w=e.y-t.y,C=Math.atan2(w,_),z=s.x-t.x,tt=s.y-t.y,it=Math.atan2(tt,z);c===bt.CLOCKWISE?C<=it&&(C+=2*Math.PI):C>=it&&(C-=2*Math.PI),this._segList.addPt(e),this.addDirectedFillet(t,C,it,c,p),this._segList.addPt(s)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(t,e,s){this._s1=t,this._s2=e,this._side=s,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,s,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(t,e,s,c){var p=this._seg0.p1,_=ue.angle(p,this._seg0.p0),w=ue.angleBetweenOriented(this._seg0.p0,p,this._seg1.p1)/2,C=ue.normalize(_+w),z=ue.normalize(C+Math.PI),tt=c*s,it=s-tt*Math.abs(Math.sin(w)),dt=p.x+tt*Math.cos(z),xt=p.y+tt*Math.sin(z),Et=new et(dt,xt),Mt=new Te(p,Et),Ut=Mt.pointAlongOffset(1,it),zt=Mt.pointAlongOffset(1,-it);this._side===yt.LEFT?(this._segList.addPt(Ut),this._segList.addPt(zt)):(this._segList.addPt(zt),this._segList.addPt(Ut))}},{key:"addDirectedFillet",value:function(t,e,s,c,p){var _=c===bt.CLOCKWISE?-1:1,w=Math.abs(e-s),C=Math.trunc(w/this._filletAngleQuantum+.5);if(C<1)return null;for(var z=w/C,tt=new et,it=0;it<C;it++){var dt=e+_*it*z;tt.x=t.x+p*Math.cos(dt),tt.y=t.y+p*Math.sin(dt),this._segList.addPt(tt)}}},{key:"computeOffsetSegment",value:function(t,e,s,c){var p=e===yt.LEFT?1:-1,_=t.p1.x-t.p0.x,w=t.p1.y-t.p0.y,C=Math.sqrt(_*_+w*w),z=p*s*_/C,tt=p*s*w/C;c.p0.x=t.p0.x-tt,c.p0.y=t.p0.y+z,c.p1.x=t.p1.x-tt,c.p1.y=t.p1.y+z}},{key:"addInsideTurn",value:function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*o.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var s=new et((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(s);var c=new et((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(c)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(t){var e=new et(t.x+this._distance,t.y);this._segList.addPt(e),this.addDirectedFillet(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)}},{key:"init",value:function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new vi,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*o.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===q.JOIN_BEVEL||this._bufParams.getJoinStyle()===q.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,bt.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Te,this._seg1=new Te,this._offset0=new Te,this._offset1=new Te,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],s=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new un,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===q.JOIN_ROUND&&(this._closingSegLengthFactor=o.MAX_CLOSING_SEG_LEN_FACTOR),this.init(s)}}])}();_i.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,_i.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,_i.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,_i.MAX_CLOSING_SEG_LEN_FACTOR=80;var xi=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"getOffsetCurve",value:function(t,e){if(this._distance=e,e===0)return null;var s=e<0,c=Math.abs(e),p=this.getSegGen(c);t.length<=1?this.computePointCurve(t[0],p):this.computeOffsetCurve(t,s,p);var _=p.getCoordinates();return s&&oe.reverse(_),_}},{key:"computeSingleSidedBufferCurve",value:function(t,e,s){var c=this.simplifyTolerance(this._distance);if(e){s.addSegments(t,!0);var p=De.simplify(t,-c),_=p.length-1;s.initSideSegments(p[_],p[_-1],yt.LEFT),s.addFirstSegment();for(var w=_-2;w>=0;w--)s.addNextSegment(p[w],!0)}else{s.addSegments(t,!1);var C=De.simplify(t,c),z=C.length-1;s.initSideSegments(C[0],C[1],yt.LEFT),s.addFirstSegment();for(var tt=2;tt<=z;tt++)s.addNextSegment(C[tt],!0)}s.addLastSegment(),s.closeRing()}},{key:"computeRingBufferCurve",value:function(t,e,s){var c=this.simplifyTolerance(this._distance);e===yt.RIGHT&&(c=-c);var p=De.simplify(t,c),_=p.length-1;s.initSideSegments(p[_-1],p[0],e);for(var w=1;w<=_;w++){var C=w!==1;s.addNextSegment(p[w],C)}s.closeRing()}},{key:"computeLineBufferCurve",value:function(t,e){var s=this.simplifyTolerance(this._distance),c=De.simplify(t,s),p=c.length-1;e.initSideSegments(c[0],c[1],yt.LEFT);for(var _=2;_<=p;_++)e.addNextSegment(c[_],!0);e.addLastSegment(),e.addLineEndCap(c[p-1],c[p]);var w=De.simplify(t,-s),C=w.length-1;e.initSideSegments(w[C],w[C-1],yt.LEFT);for(var z=C-2;z>=0;z--)e.addNextSegment(w[z],!0);e.addLastSegment(),e.addLineEndCap(w[1],w[0]),e.closeRing()}},{key:"computePointCurve",value:function(t,e){switch(this._bufParams.getEndCapStyle()){case q.CAP_ROUND:e.createCircle(t);break;case q.CAP_SQUARE:e.createSquare(t)}}},{key:"getLineCurve",value:function(t,e){if(this._distance=e,this.isLineOffsetEmpty(e))return null;var s=Math.abs(e),c=this.getSegGen(s);if(t.length<=1)this.computePointCurve(t[0],c);else if(this._bufParams.isSingleSided()){var p=e<0;this.computeSingleSidedBufferCurve(t,p,c)}else this.computeLineBufferCurve(t,c);return c.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(t){return t*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(t,e,s){if(this._distance=s,t.length<=2)return this.getLineCurve(t,s);if(s===0)return o.copyCoordinates(t);var c=this.getSegGen(s);return this.computeRingBufferCurve(t,e,c),c.getCoordinates()}},{key:"computeOffsetCurve",value:function(t,e,s){var c=this.simplifyTolerance(this._distance);if(e){var p=De.simplify(t,-c),_=p.length-1;s.initSideSegments(p[_],p[_-1],yt.LEFT),s.addFirstSegment();for(var w=_-2;w>=0;w--)s.addNextSegment(p[w],!0)}else{var C=De.simplify(t,c),z=C.length-1;s.initSideSegments(C[0],C[1],yt.LEFT),s.addFirstSegment();for(var tt=2;tt<=z;tt++)s.addNextSegment(C[tt],!0)}s.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(t){return t===0||t<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(t){return new _i(this._precisionModel,this._bufParams,t)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e}},{key:"copyCoordinates",value:function(t){for(var e=new Array(t.length).fill(null),s=0;s<e.length;s++)e[s]=new et(t[s]);return e}}])}(),Ne=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var o=arguments[0],t=new It,e=this._subgraphs.iterator();e.hasNext();){var s=e.next(),c=s.getEnvelope();o.y<c.getMinY()||o.y>c.getMaxY()||this.findStabbedSegments(o,s.getDirectedEdges(),t)}return t}if(arguments.length===3){if(Nt(arguments[2],qe)&&arguments[0]instanceof et&&arguments[1]instanceof Tr){for(var p=arguments[0],_=arguments[1],w=arguments[2],C=_.getEdge().getCoordinates(),z=0;z<C.length-1;z++)if(this._seg.p0=C[z],this._seg.p1=C[z+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<p.x||this._seg.isHorizontal()||p.y<this._seg.p0.y||p.y>this._seg.p1.y||bt.index(this._seg.p0,this._seg.p1,p)===bt.RIGHT)){var tt=_.getDepth(yt.LEFT);this._seg.p0.equals(C[z])||(tt=_.getDepth(yt.RIGHT));var it=new Br(this._seg,tt);w.add(it)}}else if(Nt(arguments[2],qe)&&arguments[0]instanceof et&&Nt(arguments[1],qe))for(var dt=arguments[0],xt=arguments[2],Et=arguments[1].iterator();Et.hasNext();){var Mt=Et.next();Mt.isForward()&&this.findStabbedSegments(dt,Mt,xt)}}}},{key:"getDepth",value:function(o){var t=this.findStabbedSegments(o);return t.size()===0?0:An.min(t)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new Te;var o=arguments[0];this._subgraphs=o}}])}(),Br=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"compareTo",value:function(o){var t=o;if(this._upwardSeg.minX()>=t._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=t._upwardSeg.minX())return-1;var e=this._upwardSeg.orientationIndex(t._upwardSeg);return e!==0||(e=-1*t._upwardSeg.orientationIndex(this._upwardSeg))!==0?e:this._upwardSeg.compareTo(t._upwardSeg)}},{key:"compareX",value:function(o,t){var e=o.p0.compareTo(t.p0);return e!==0?e:o.p1.compareTo(t.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[K]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var o=arguments[0],t=arguments[1];this._upwardSeg=new Te(o),this._leftDepth=t}}])}();Ne.DepthSegment=Br;var zr=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,null,[{key:"constructor_",value:function(){A.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}])}(A),Gr=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"getY",value:function(){var t=this.y/this.w;if(J.isNaN(t)||J.isInfinite(t))throw new zr;return t}},{key:"getX",value:function(){var t=this.x/this.w;if(J.isNaN(t)||J.isInfinite(t))throw new zr;return t}},{key:"getCoordinate",value:function(){var t=new et;return t.x=this.getX(),t.y=this.getY(),t}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],s=arguments[1];this.x=e,this.y=s,this.w=1}else if(arguments[0]instanceof o&&arguments[1]instanceof o){var c=arguments[0],p=arguments[1];this.x=c.y*p.w-p.y*c.w,this.y=p.x*c.w-c.x*p.w,this.w=c.x*p.y-p.x*c.y}else if(arguments[0]instanceof et&&arguments[1]instanceof et){var _=arguments[0],w=arguments[1];this.x=_.y-w.y,this.y=w.x-_.x,this.w=_.x*w.y-w.x*_.y}}else if(arguments.length===3){var C=arguments[0],z=arguments[1],tt=arguments[2];this.x=C,this.y=z,this.w=tt}else if(arguments.length===4){var it=arguments[0],dt=arguments[1],xt=arguments[2],Et=arguments[3],Mt=it.y-dt.y,Ut=dt.x-it.x,zt=it.x*dt.y-dt.x*it.y,jt=xt.y-Et.y,ee=Et.x-xt.x,fe=xt.x*Et.y-Et.x*xt.y;this.x=Ut*fe-ee*zt,this.y=jt*zt-Mt*fe,this.w=Mt*ee-jt*Ut}}}])}(),Hr=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"area",value:function(){return o.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return o.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(t){if(t===null)throw new F("Supplied point is null.");return o.interpolateZ(t,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return o.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return o.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return o.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return o.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return o.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return o.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var t=arguments[0],e=arguments[1],s=arguments[2];this.p0=t,this.p1=e,this.p2=s}},{key:"area",value:function(t,e,s){return Math.abs(((s.x-t.x)*(e.y-t.y)-(e.x-t.x)*(s.y-t.y))/2)}},{key:"signedArea",value:function(t,e,s){return((s.x-t.x)*(e.y-t.y)-(e.x-t.x)*(s.y-t.y))/2}},{key:"det",value:function(t,e,s,c){return t*c-e*s}},{key:"interpolateZ",value:function(t,e,s,c){var p=e.x,_=e.y,w=s.x-p,C=c.x-p,z=s.y-_,tt=c.y-_,it=w*tt-C*z,dt=t.x-p,xt=t.y-_,Et=(tt*dt-C*xt)/it,Mt=(-z*dt+w*xt)/it;return e.getZ()+Et*(s.getZ()-e.getZ())+Mt*(c.getZ()-e.getZ())}},{key:"longestSideLength",value:function(t,e,s){var c=t.distance(e),p=e.distance(s),_=s.distance(t),w=c;return p>w&&(w=p),_>w&&(w=_),w}},{key:"circumcentreDD",value:function(t,e,s){var c=St.valueOf(t.x).subtract(s.x),p=St.valueOf(t.y).subtract(s.y),_=St.valueOf(e.x).subtract(s.x),w=St.valueOf(e.y).subtract(s.y),C=St.determinant(c,p,_,w).multiply(2),z=c.sqr().add(p.sqr()),tt=_.sqr().add(w.sqr()),it=St.determinant(p,z,w,tt),dt=St.determinant(c,z,_,tt),xt=St.valueOf(s.x).subtract(it.divide(C)).doubleValue(),Et=St.valueOf(s.y).add(dt.divide(C)).doubleValue();return new et(xt,Et)}},{key:"isAcute",value:function(t,e,s){return!!ue.isAcute(t,e,s)&&!!ue.isAcute(e,s,t)&&!!ue.isAcute(s,t,e)}},{key:"circumcentre",value:function(t,e,s){var c=s.x,p=s.y,_=t.x-c,w=t.y-p,C=e.x-c,z=e.y-p,tt=2*o.det(_,w,C,z),it=o.det(w,_*_+w*w,z,C*C+z*z),dt=o.det(_,_*_+w*w,C,C*C+z*z);return new et(c-it/tt,p+dt/tt)}},{key:"perpendicularBisector",value:function(t,e){var s=e.x-t.x,c=e.y-t.y,p=new Gr(t.x+s/2,t.y+c/2,1),_=new Gr(t.x-c+s/2,t.y+s+c/2,1);return new Gr(p,_)}},{key:"angleBisector",value:function(t,e,s){var c=e.distance(t),p=c/(c+e.distance(s)),_=s.x-t.x,w=s.y-t.y;return new et(t.x+p*_,t.y+p*w)}},{key:"area3D",value:function(t,e,s){var c=e.x-t.x,p=e.y-t.y,_=e.getZ()-t.getZ(),w=s.x-t.x,C=s.y-t.y,z=s.getZ()-t.getZ(),tt=p*z-_*C,it=_*w-c*z,dt=c*C-p*w,xt=tt*tt+it*it+dt*dt,Et=Math.sqrt(xt)/2;return Et}},{key:"centroid",value:function(t,e,s){var c=(t.x+e.x+s.x)/3,p=(t.y+e.y+s.y)/3;return new et(c,p)}},{key:"inCentre",value:function(t,e,s){var c=e.distance(s),p=t.distance(s),_=t.distance(e),w=c+p+_,C=(c*t.x+p*e.x+_*s.x)/w,z=(c*t.y+p*e.y+_*s.y)/w;return new et(C,z)}}])}(),qr=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"addRingSide",value:function(o,t,e,s,c){if(t===0&&o.length<Ye.MINIMUM_VALID_SIZE)return null;var p=s,_=c;o.length>=Ye.MINIMUM_VALID_SIZE&&bt.isCCW(o)&&(p=c,_=s,e=yt.opposite(e));var w=this._curveBuilder.getRingCurve(o,e,t);this.addCurve(w,p,_)}},{key:"addRingBothSides",value:function(o,t){this.addRingSide(o,t,yt.LEFT,Y.EXTERIOR,Y.INTERIOR),this.addRingSide(o,t,yt.RIGHT,Y.INTERIOR,Y.EXTERIOR)}},{key:"addPoint",value:function(o){if(this._distance<=0)return null;var t=o.getCoordinates(),e=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(e,Y.EXTERIOR,Y.INTERIOR)}},{key:"addPolygon",value:function(o){var t=this._distance,e=yt.LEFT;this._distance<0&&(t=-this._distance,e=yt.RIGHT);var s=o.getExteriorRing(),c=oe.removeRepeatedPoints(s.getCoordinates());if(this._distance<0&&this.isErodedCompletely(s,this._distance)||this._distance<=0&&c.length<3)return null;this.addRingSide(c,t,e,Y.EXTERIOR,Y.INTERIOR);for(var p=0;p<o.getNumInteriorRing();p++){var _=o.getInteriorRingN(p),w=oe.removeRepeatedPoints(_.getCoordinates());this._distance>0&&this.isErodedCompletely(_,-this._distance)||this.addRingSide(w,t,yt.opposite(e),Y.INTERIOR,Y.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(o,t){var e=new Hr(o[0],o[1],o[2]),s=e.inCentre();return ze.pointToSegment(s,e.p0,e.p1)<Math.abs(t)}},{key:"addLineString",value:function(o){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var t=oe.removeRepeatedPoints(o.getCoordinates());if(oe.isRing(t)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(t,this._distance);else{var e=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(e,Y.EXTERIOR,Y.INTERIOR)}}},{key:"addCurve",value:function(o,t,e){if(o===null||o.length<2)return null;var s=new ln(o,new Ie(0,Y.BOUNDARY,t,e));this._curveList.add(s)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(o){if(o.isEmpty())return null;if(o instanceof ci)this.addPolygon(o);else if(o instanceof hi)this.addLineString(o);else if(o instanceof xr)this.addPoint(o);else if(o instanceof Ai)this.addCollection(o);else if(o instanceof Bi)this.addCollection(o);else if(o instanceof Pr)this.addCollection(o);else{if(!(o instanceof ke))throw new Lt(o.getGeometryType());this.addCollection(o)}}},{key:"isErodedCompletely",value:function(o,t){var e=o.getCoordinates();if(e.length<4)return t<0;if(e.length===4)return this.isTriangleErodedCompletely(e,t);var s=o.getEnvelopeInternal(),c=Math.min(s.getHeight(),s.getWidth());return t<0&&2*Math.abs(t)>c}},{key:"addCollection",value:function(o){for(var t=0;t<o.getNumGeometries();t++){var e=o.getGeometryN(t);this.add(e)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new It;var o=arguments[0],t=arguments[1],e=arguments[2];this._inputGeom=o,this._distance=t,this._curveBuilder=e}}])}(),Mo=function(){return d(function o(){l(this,o)},[{key:"locate",value:function(o){}}])}(),Io=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,o.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Gt;var t=this._parent.getGeometryN(this._index++);return t instanceof ke?(this._subcollectionIterator=new o(t),this._subcollectionIterator.next()):t}},{key:"remove",value:function(){throw new Lt(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[Eo]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()}},{key:"isAtomic",value:function(t){return!(t instanceof ke)}}])}(),Es=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"locate",value:function(t){return o.locate(t,this._geom)}},{key:"interfaces_",get:function(){return[Mo]}}],[{key:"constructor_",value:function(){this._geom=null;var t=arguments[0];this._geom=t}},{key:"locatePointInPolygon",value:function(t,e){if(e.isEmpty())return Y.EXTERIOR;var s=e.getExteriorRing(),c=o.locatePointInRing(t,s);if(c!==Y.INTERIOR)return c;for(var p=0;p<e.getNumInteriorRing();p++){var _=e.getInteriorRingN(p),w=o.locatePointInRing(t,_);if(w===Y.BOUNDARY)return Y.BOUNDARY;if(w===Y.INTERIOR)return Y.EXTERIOR}return Y.INTERIOR}},{key:"locatePointInRing",value:function(t,e){return e.getEnvelopeInternal().intersects(t)?$n.locateInRing(t,e.getCoordinates()):Y.EXTERIOR}},{key:"containsPointInPolygon",value:function(t,e){return Y.EXTERIOR!==o.locatePointInPolygon(t,e)}},{key:"locateInGeometry",value:function(t,e){if(e instanceof ci)return o.locatePointInPolygon(t,e);if(e instanceof ke)for(var s=new Io(e);s.hasNext();){var c=s.next();if(c!==e){var p=o.locateInGeometry(t,c);if(p!==Y.EXTERIOR)return p}}return Y.EXTERIOR}},{key:"isContained",value:function(t,e){return Y.EXTERIOR!==o.locate(t,e)}},{key:"locate",value:function(t,e){return e.isEmpty()?Y.EXTERIOR:e.getEnvelopeInternal().intersects(t)?o.locateInGeometry(t,e):Y.EXTERIOR}}])}(),Lo=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"getNextCW",value:function(o){this.getEdges();var t=this._edgeList.indexOf(o),e=t-1;return t===0&&(e=this._edgeList.size()-1),this._edgeList.get(e)}},{key:"propagateSideLabels",value:function(o){for(var t=Y.NONE,e=this.iterator();e.hasNext();){var s=e.next().getLabel();s.isArea(o)&&s.getLocation(o,yt.LEFT)!==Y.NONE&&(t=s.getLocation(o,yt.LEFT))}if(t===Y.NONE)return null;for(var c=t,p=this.iterator();p.hasNext();){var _=p.next(),w=_.getLabel();if(w.getLocation(o,yt.ON)===Y.NONE&&w.setLocation(o,yt.ON,c),w.isArea(o)){var C=w.getLocation(o,yt.LEFT),z=w.getLocation(o,yt.RIGHT);if(z!==Y.NONE){if(z!==c)throw new Ue("side location conflict",_.getCoordinate());C===Y.NONE&&ht.shouldNeverReachHere("found single null side (at "+_.getCoordinate()+")"),c=C}else ht.isTrue(w.getLocation(o,yt.LEFT)===Y.NONE,"found single null side"),w.setLocation(o,yt.RIGHT,c),w.setLocation(o,yt.LEFT,c)}}}},{key:"getCoordinate",value:function(){var o=this.iterator();return o.hasNext()?o.next().getCoordinate():null}},{key:"print",value:function(o){Re.out.println("EdgeEndStar:   "+this.getCoordinate());for(var t=this.iterator();t.hasNext();)t.next().print(o)}},{key:"isAreaLabelsConsistent",value:function(o){return this.computeEdgeEndLabels(o.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(o){var t=this.getEdges();if(t.size()<=0)return!0;var e=t.size()-1,s=t.get(e).getLabel().getLocation(o,yt.LEFT);ht.isTrue(s!==Y.NONE,"Found unlabelled area edge");for(var c=s,p=this.iterator();p.hasNext();){var _=p.next().getLabel();ht.isTrue(_.isArea(o),"Found non-area edge");var w=_.getLocation(o,yt.LEFT),C=_.getLocation(o,yt.RIGHT);if(w===C||C!==c)return!1;c=w}return!0}},{key:"findIndex",value:function(o){this.iterator();for(var t=0;t<this._edgeList.size();t++)if(this._edgeList.get(t)===o)return t;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new It(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(o,t,e){return this._ptInAreaLocation[o]===Y.NONE&&(this._ptInAreaLocation[o]=Es.locate(t,e[o].getGeometry())),this._ptInAreaLocation[o]}},{key:"toString",value:function(){var o=new dn;o.append("EdgeEndStar:   "+this.getCoordinate()),o.append(`
`);for(var t=this.iterator();t.hasNext();){var e=t.next();o.append(e),o.append(`
`)}return o.toString()}},{key:"computeEdgeEndLabels",value:function(o){for(var t=this.iterator();t.hasNext();)t.next().computeLabel(o)}},{key:"computeLabelling",value:function(o){this.computeEdgeEndLabels(o[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var t=[!1,!1],e=this.iterator();e.hasNext();)for(var s=e.next().getLabel(),c=0;c<2;c++)s.isLine(c)&&s.getLocation(c)===Y.BOUNDARY&&(t[c]=!0);for(var p=this.iterator();p.hasNext();)for(var _=p.next(),w=_.getLabel(),C=0;C<2;C++)if(w.isAnyNull(C)){var z=Y.NONE;if(t[C])z=Y.EXTERIOR;else{var tt=_.getCoordinate();z=this.getLocation(C,tt,o)}w.setAllLocationsIfNull(C,z)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(o,t){this._edgeMap.put(o,t),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new ne,this._edgeList=null,this._ptInAreaLocation=[Y.NONE,Y.NONE]}}])}(),He=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var e=null,s=null,c=this._SCANNING_FOR_INCOMING,p=0;p<this._resultAreaEdgeList.size();p++){var _=this._resultAreaEdgeList.get(p),w=_.getSym();if(_.getLabel().isArea())switch(e===null&&_.isInResult()&&(e=_),c){case this._SCANNING_FOR_INCOMING:if(!w.isInResult())continue;s=w,c=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!_.isInResult())continue;s.setNext(_),c=this._SCANNING_FOR_INCOMING}}if(c===this._LINKING_TO_OUTGOING){if(e===null)throw new Ue("no outgoing dirEdge found",this.getCoordinate());ht.isTrue(e.isInResult(),"unable to link last incoming dirEdge"),s.setNext(e)}}},{key:"insert",value:function(e){var s=e;this.insertEdgeEnd(s,s)}},{key:"getRightmostEdge",value:function(){var e=this.getEdges(),s=e.size();if(s<1)return null;var c=e.get(0);if(s===1)return c;var p=e.get(s-1),_=c.getQuadrant(),w=p.getQuadrant();return me.isNorthern(_)&&me.isNorthern(w)?c:me.isNorthern(_)||me.isNorthern(w)?c.getDy()!==0?c:p.getDy()!==0?p:(ht.shouldNeverReachHere("found two horizontal edges incident on node"),null):p}},{key:"print",value:function(e){Re.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var s=this.iterator();s.hasNext();){var c=s.next();e.print("out "),c.print(e),e.println(),e.print("in "),c.getSym().print(e),e.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new It;for(var e=this.iterator();e.hasNext();){var s=e.next();(s.isInResult()||s.getSym().isInResult())&&this._resultAreaEdgeList.add(s)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(e){for(var s=this.iterator();s.hasNext();){var c=s.next().getLabel();c.setAllLocationsIfNull(0,e.getLocation(0)),c.setAllLocationsIfNull(1,e.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var e=null,s=null,c=this._edgeList.size()-1;c>=0;c--){var p=this._edgeList.get(c),_=p.getSym();s===null&&(s=_),e!==null&&_.setNext(e),e=p}s.setNext(e)}},{key:"computeDepths",value:function(){if(arguments.length===1){var e=arguments[0],s=this.findIndex(e),c=e.getDepth(yt.LEFT),p=e.getDepth(yt.RIGHT),_=this.computeDepths(s+1,this._edgeList.size(),c);if(this.computeDepths(0,s,_)!==p)throw new Ue("depth mismatch at "+e.getCoordinate())}else if(arguments.length===3){for(var w=arguments[1],C=arguments[2],z=arguments[0];z<w;z++){var tt=this._edgeList.get(z);tt.setEdgeDepths(yt.RIGHT,C),C=tt.getDepth(yt.LEFT)}return C}}},{key:"mergeSymLabels",value:function(){for(var e=this.iterator();e.hasNext();){var s=e.next();s.getLabel().merge(s.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(e){for(var s=null,c=null,p=this._SCANNING_FOR_INCOMING,_=this._resultAreaEdgeList.size()-1;_>=0;_--){var w=this._resultAreaEdgeList.get(_),C=w.getSym();switch(s===null&&w.getEdgeRing()===e&&(s=w),p){case this._SCANNING_FOR_INCOMING:if(C.getEdgeRing()!==e)continue;c=C,p=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(w.getEdgeRing()!==e)continue;c.setNextMin(w),p=this._SCANNING_FOR_INCOMING}}p===this._LINKING_TO_OUTGOING&&(ht.isTrue(s!==null,"found null for first outgoing dirEdge"),ht.isTrue(s.getEdgeRing()===e,"unable to link last incoming dirEdge"),c.setNextMin(s))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var e=0,s=this.iterator();s.hasNext();)s.next().isInResult()&&e++;return e}if(arguments.length===1){for(var c=arguments[0],p=0,_=this.iterator();_.hasNext();)_.next().getEdgeRing()===c&&p++;return p}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var e=Y.NONE,s=this.iterator();s.hasNext();){var c=s.next(),p=c.getSym();if(!c.isLineEdge()){if(c.isInResult()){e=Y.INTERIOR;break}if(p.isInResult()){e=Y.EXTERIOR;break}}}if(e===Y.NONE)return null;for(var _=e,w=this.iterator();w.hasNext();){var C=w.next(),z=C.getSym();C.isLineEdge()?C.getEdge().setCovered(_===Y.INTERIOR):(C.isInResult()&&(_=Y.EXTERIOR),z.isInResult()&&(_=Y.INTERIOR))}}},{key:"computeLabelling",value:function(e){R(t,"computeLabelling",this,1).call(this,e),this._label=new Ie(Y.NONE);for(var s=this.iterator();s.hasNext();)for(var c=s.next().getEdge().getLabel(),p=0;p<2;p++){var _=c.getLocation(p);_!==Y.INTERIOR&&_!==Y.BOUNDARY||this._label.setLocation(p,Y.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}])}(Lo),Qn=function(o){function t(){return l(this,t),a(this,t)}return I(t,o),d(t,[{key:"createNode",value:function(e){return new pi(e,new He)}}])}(Nr),Ps=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"compareTo",value:function(t){var e=t;return o.compareOriented(this._pts,this._orientation,e._pts,e._orientation)}},{key:"interfaces_",get:function(){return[K]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=o.orientation(t)}},{key:"orientation",value:function(t){return oe.increasingDirection(t)===1}},{key:"compareOriented",value:function(t,e,s,c){for(var p=e?1:-1,_=c?1:-1,w=e?t.length:-1,C=c?s.length:-1,z=e?0:t.length-1,tt=c?0:s.length-1;;){var it=t[z].compareTo(s[tt]);if(it!==0)return it;var dt=(z+=p)===w,xt=(tt+=_)===C;if(dt&&!xt)return-1;if(!dt&&xt)return 1;if(dt&&xt)return 0}}}])}(),hn=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"print",value:function(o){o.print("MULTILINESTRING ( ");for(var t=0;t<this._edges.size();t++){var e=this._edges.get(t);t>0&&o.print(","),o.print("(");for(var s=e.getCoordinates(),c=0;c<s.length;c++)c>0&&o.print(","),o.print(s[c].x+" "+s[c].y);o.println(")")}o.print(")  ")}},{key:"addAll",value:function(o){for(var t=o.iterator();t.hasNext();)this.add(t.next())}},{key:"findEdgeIndex",value:function(o){for(var t=0;t<this._edges.size();t++)if(this._edges.get(t).equals(o))return t;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(o){return this._edges.get(o)}},{key:"findEqualEdge",value:function(o){var t=new Ps(o.getCoordinates());return this._ocaMap.get(t)}},{key:"add",value:function(o){this._edges.add(o);var t=new Ps(o.getCoordinates());this._ocaMap.put(t,o)}}],[{key:"constructor_",value:function(){this._edges=new It,this._ocaMap=new ne}}])}(),Ms=function(){return d(function o(){l(this,o)},[{key:"processIntersections",value:function(o,t,e,s){}},{key:"isDone",value:function(){}}])}(),ti=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"isTrivialIntersection",value:function(t,e,s,c){if(t===s&&this._li.getIntersectionNum()===1){if(o.isAdjacentSegments(e,c))return!0;if(t.isClosed()){var p=t.size()-1;if(e===0&&c===p||c===0&&e===p)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(t,e,s,c){if(t===s&&e===c)return null;this.numTests++;var p=t.getCoordinates()[e],_=t.getCoordinates()[e+1],w=s.getCoordinates()[c],C=s.getCoordinates()[c+1];this._li.computeIntersection(p,_,w,C),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,s,c)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),s.addIntersections(this._li,c,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[Ms]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t}},{key:"isAdjacentSegments",value:function(t,e){return Math.abs(t-e)===1}}])}(),So=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(o){o.print(this.coord),o.print(" seg # = "+this.segmentIndex),o.println(" dist = "+this.dist)}},{key:"compareTo",value:function(o){var t=o;return this.compare(t.segmentIndex,t.dist)}},{key:"isEndPoint",value:function(o){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===o}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(o,t){return this.segmentIndex<o?-1:this.segmentIndex>o?1:this.dist<t?-1:this.dist>t?1:0}},{key:"interfaces_",get:function(){return[K]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var o=arguments[0],t=arguments[1],e=arguments[2];this.coord=new et(o),this.segmentIndex=t,this.dist=e}}])}(),ki=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"print",value:function(o){o.println("Intersections:");for(var t=this.iterator();t.hasNext();)t.next().print(o)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(o){this.addEndpoints();for(var t=this.iterator(),e=t.next();t.hasNext();){var s=t.next(),c=this.createSplitEdge(e,s);o.add(c),e=s}}},{key:"addEndpoints",value:function(){var o=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[o],o,0)}},{key:"createSplitEdge",value:function(o,t){var e=t.segmentIndex-o.segmentIndex+2,s=this.edge.pts[t.segmentIndex],c=t.dist>0||!t.coord.equals2D(s);c||e--;var p=new Array(e).fill(null),_=0;p[_++]=new et(o.coord);for(var w=o.segmentIndex+1;w<=t.segmentIndex;w++)p[_++]=this.edge.pts[w];return c&&(p[_]=t.coord),new Ls(p,new Ie(this.edge._label))}},{key:"add",value:function(o,t,e){var s=new So(o,t,e),c=this._nodeMap.get(s);return c!==null?c:(this._nodeMap.put(s,s),s)}},{key:"isIntersection",value:function(o){for(var t=this.iterator();t.hasNext();)if(t.next().coord.equals(o))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new ne,this.edge=null;var o=arguments[0];this.edge=o}}])}(),Is=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(o.isTrue(this._matrix[Y.INTERIOR][Y.INTERIOR])||o.isTrue(this._matrix[Y.INTERIOR][Y.BOUNDARY])||o.isTrue(this._matrix[Y.BOUNDARY][Y.INTERIOR])||o.isTrue(this._matrix[Y.BOUNDARY][Y.BOUNDARY]))&&this._matrix[Y.EXTERIOR][Y.INTERIOR]===_t.FALSE&&this._matrix[Y.EXTERIOR][Y.BOUNDARY]===_t.FALSE}},{key:"isCoveredBy",value:function(){return(o.isTrue(this._matrix[Y.INTERIOR][Y.INTERIOR])||o.isTrue(this._matrix[Y.INTERIOR][Y.BOUNDARY])||o.isTrue(this._matrix[Y.BOUNDARY][Y.INTERIOR])||o.isTrue(this._matrix[Y.BOUNDARY][Y.BOUNDARY]))&&this._matrix[Y.INTERIOR][Y.EXTERIOR]===_t.FALSE&&this._matrix[Y.BOUNDARY][Y.EXTERIOR]===_t.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var t=arguments[0],e=0;e<t.length;e++){var s=Math.trunc(e/3),c=e%3;this._matrix[s][c]=_t.toDimensionValue(t.charAt(e))}else if(arguments.length===3){var p=arguments[0],_=arguments[1],w=arguments[2];this._matrix[p][_]=w}}},{key:"isContains",value:function(){return o.isTrue(this._matrix[Y.INTERIOR][Y.INTERIOR])&&this._matrix[Y.EXTERIOR][Y.INTERIOR]===_t.FALSE&&this._matrix[Y.EXTERIOR][Y.BOUNDARY]===_t.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var t=arguments[0],e=0;e<t.length;e++){var s=Math.trunc(e/3),c=e%3;this.setAtLeast(s,c,_t.toDimensionValue(t.charAt(e)))}else if(arguments.length===3){var p=arguments[0],_=arguments[1],w=arguments[2];this._matrix[p][_]<w&&(this._matrix[p][_]=w)}}},{key:"setAtLeastIfValid",value:function(t,e,s){t>=0&&e>=0&&this.setAtLeast(t,e,s)}},{key:"isWithin",value:function(){return o.isTrue(this._matrix[Y.INTERIOR][Y.INTERIOR])&&this._matrix[Y.INTERIOR][Y.EXTERIOR]===_t.FALSE&&this._matrix[Y.BOUNDARY][Y.EXTERIOR]===_t.FALSE}},{key:"isTouches",value:function(t,e){return t>e?this.isTouches(e,t):(t===_t.A&&e===_t.A||t===_t.L&&e===_t.L||t===_t.L&&e===_t.A||t===_t.P&&e===_t.A||t===_t.P&&e===_t.L)&&this._matrix[Y.INTERIOR][Y.INTERIOR]===_t.FALSE&&(o.isTrue(this._matrix[Y.INTERIOR][Y.BOUNDARY])||o.isTrue(this._matrix[Y.BOUNDARY][Y.INTERIOR])||o.isTrue(this._matrix[Y.BOUNDARY][Y.BOUNDARY]))}},{key:"isOverlaps",value:function(t,e){return t===_t.P&&e===_t.P||t===_t.A&&e===_t.A?o.isTrue(this._matrix[Y.INTERIOR][Y.INTERIOR])&&o.isTrue(this._matrix[Y.INTERIOR][Y.EXTERIOR])&&o.isTrue(this._matrix[Y.EXTERIOR][Y.INTERIOR]):t===_t.L&&e===_t.L&&this._matrix[Y.INTERIOR][Y.INTERIOR]===1&&o.isTrue(this._matrix[Y.INTERIOR][Y.EXTERIOR])&&o.isTrue(this._matrix[Y.EXTERIOR][Y.INTERIOR])}},{key:"isEquals",value:function(t,e){return t===e&&o.isTrue(this._matrix[Y.INTERIOR][Y.INTERIOR])&&this._matrix[Y.INTERIOR][Y.EXTERIOR]===_t.FALSE&&this._matrix[Y.BOUNDARY][Y.EXTERIOR]===_t.FALSE&&this._matrix[Y.EXTERIOR][Y.INTERIOR]===_t.FALSE&&this._matrix[Y.EXTERIOR][Y.BOUNDARY]===_t.FALSE}},{key:"toString",value:function(){for(var t=new Fi("123456789"),e=0;e<3;e++)for(var s=0;s<3;s++)t.setCharAt(3*e+s,_t.toDimensionSymbol(this._matrix[e][s]));return t.toString()}},{key:"setAll",value:function(t){for(var e=0;e<3;e++)for(var s=0;s<3;s++)this._matrix[e][s]=t}},{key:"get",value:function(t,e){return this._matrix[t][e]}},{key:"transpose",value:function(){var t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}},{key:"matches",value:function(t){if(t.length!==9)throw new F("Should be length 9: "+t);for(var e=0;e<3;e++)for(var s=0;s<3;s++)if(!o.matches(this._matrix[e][s],t.charAt(3*e+s)))return!1;return!0}},{key:"add",value:function(t){for(var e=0;e<3;e++)for(var s=0;s<3;s++)this.setAtLeast(e,s,t.get(e,s))}},{key:"isDisjoint",value:function(){return this._matrix[Y.INTERIOR][Y.INTERIOR]===_t.FALSE&&this._matrix[Y.INTERIOR][Y.BOUNDARY]===_t.FALSE&&this._matrix[Y.BOUNDARY][Y.INTERIOR]===_t.FALSE&&this._matrix[Y.BOUNDARY][Y.BOUNDARY]===_t.FALSE}},{key:"isCrosses",value:function(t,e){return t===_t.P&&e===_t.L||t===_t.P&&e===_t.A||t===_t.L&&e===_t.A?o.isTrue(this._matrix[Y.INTERIOR][Y.INTERIOR])&&o.isTrue(this._matrix[Y.INTERIOR][Y.EXTERIOR]):t===_t.L&&e===_t.P||t===_t.A&&e===_t.P||t===_t.A&&e===_t.L?o.isTrue(this._matrix[Y.INTERIOR][Y.INTERIOR])&&o.isTrue(this._matrix[Y.EXTERIOR][Y.INTERIOR]):t===_t.L&&e===_t.L&&this._matrix[Y.INTERIOR][Y.INTERIOR]===0}},{key:"interfaces_",get:function(){return[E]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(_t.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var t=arguments[0];o.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof o){var e=arguments[0];o.constructor_.call(this),this._matrix[Y.INTERIOR][Y.INTERIOR]=e._matrix[Y.INTERIOR][Y.INTERIOR],this._matrix[Y.INTERIOR][Y.BOUNDARY]=e._matrix[Y.INTERIOR][Y.BOUNDARY],this._matrix[Y.INTERIOR][Y.EXTERIOR]=e._matrix[Y.INTERIOR][Y.EXTERIOR],this._matrix[Y.BOUNDARY][Y.INTERIOR]=e._matrix[Y.BOUNDARY][Y.INTERIOR],this._matrix[Y.BOUNDARY][Y.BOUNDARY]=e._matrix[Y.BOUNDARY][Y.BOUNDARY],this._matrix[Y.BOUNDARY][Y.EXTERIOR]=e._matrix[Y.BOUNDARY][Y.EXTERIOR],this._matrix[Y.EXTERIOR][Y.INTERIOR]=e._matrix[Y.EXTERIOR][Y.INTERIOR],this._matrix[Y.EXTERIOR][Y.BOUNDARY]=e._matrix[Y.EXTERIOR][Y.BOUNDARY],this._matrix[Y.EXTERIOR][Y.EXTERIOR]=e._matrix[Y.EXTERIOR][Y.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var t=arguments[0],e=arguments[1];return e===_t.SYM_DONTCARE||e===_t.SYM_TRUE&&(t>=0||t===_t.TRUE)||e===_t.SYM_FALSE&&t===_t.FALSE||e===_t.SYM_P&&t===_t.P||e===_t.SYM_L&&t===_t.L||e===_t.SYM_A&&t===_t.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var s=arguments[1];return new o(arguments[0]).matches(s)}}},{key:"isTrue",value:function(t){return t>=0||t===_t.TRUE}}])}(),Wi=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(t){return t===null||t.length===0?null:(this.ensureCapacity(this._size+t.length),Re.arraycopy(t,0,this._data,this._size,t.length),void(this._size+=t.length))}},{key:"ensureCapacity",value:function(t){if(t<=this._data.length)return null;var e=Math.max(t,2*this._data.length);this._data=ge.copyOf(this._data,e)}},{key:"toArray",value:function(){var t=new Array(this._size).fill(null);return Re.arraycopy(this._data,0,t,0,this._size),t}},{key:"add",value:function(t){this.ensureCapacity(this._size+1),this._data[this._size]=t,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)o.constructor_.call(this,10);else if(arguments.length===1){var t=arguments[0];this._data=new Array(t).fill(null)}}}])}(),Co=function(){function o(){l(this,o)}return d(o,[{key:"getChainStartIndices",value:function(t){var e=0,s=new Wi(Math.trunc(t.length/2));s.add(e);do{var c=this.findChainEnd(t,e);s.add(c),e=c}while(e<t.length-1);return s.toArray()}},{key:"findChainEnd",value:function(t,e){for(var s=me.quadrant(t[e],t[e+1]),c=e+1;c<t.length&&me.quadrant(t[c-1],t[c])===s;)c++;return c-1}},{key:"OLDgetChainStartIndices",value:function(t){var e=0,s=new It;s.add(e);do{var c=this.findChainEnd(t,e);s.add(c),e=c}while(e<t.length-1);return o.toIntArray(s)}}],[{key:"toIntArray",value:function(t){for(var e=new Array(t.size()).fill(null),s=0;s<e.length;s++)e[s]=t.get(s).intValue();return e}}])}(),xn=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(o){var t=this.pts[this.startIndex[o]].x,e=this.pts[this.startIndex[o+1]].x;return t>e?t:e}},{key:"getMinX",value:function(o){var t=this.pts[this.startIndex[o]].x,e=this.pts[this.startIndex[o+1]].x;return t<e?t:e}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var o=arguments[0],t=arguments[1],e=arguments[2],s=arguments[3];this.computeIntersectsForChain(this.startIndex[o],this.startIndex[o+1],t,t.startIndex[e],t.startIndex[e+1],s)}else if(arguments.length===6){var c=arguments[0],p=arguments[1],_=arguments[2],w=arguments[3],C=arguments[4],z=arguments[5];if(p-c==1&&C-w==1)return z.addIntersections(this.e,c,_.e,w),null;if(!this.overlaps(c,p,_,w,C))return null;var tt=Math.trunc((c+p)/2),it=Math.trunc((w+C)/2);c<tt&&(w<it&&this.computeIntersectsForChain(c,tt,_,w,it,z),it<C&&this.computeIntersectsForChain(c,tt,_,it,C,z)),tt<p&&(w<it&&this.computeIntersectsForChain(tt,p,_,w,it,z),it<C&&this.computeIntersectsForChain(tt,p,_,it,C,z))}}},{key:"overlaps",value:function(o,t,e,s,c){return Ct.intersects(this.pts[o],this.pts[t],e.pts[s],e.pts[c])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(o,t){for(var e=0;e<this.startIndex.length-1;e++)for(var s=0;s<o.startIndex.length-1;s++)this.computeIntersectsForChain(e,o,s,t)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var o=arguments[0];this.e=o,this.pts=o.getCoordinates();var t=new Co;this.startIndex=t.getChainStartIndices(this.pts)}}])}(),wi=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"getDepth",value:function(t,e){return this._depth[t][e]}},{key:"setDepth",value:function(t,e,s){this._depth[t][e]=s}},{key:"isNull",value:function(){if(arguments.length===0){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==o.NULL_VALUE)return!1;return!0}if(arguments.length===1){var s=arguments[0];return this._depth[s][1]===o.NULL_VALUE}if(arguments.length===2){var c=arguments[0],p=arguments[1];return this._depth[c][p]===o.NULL_VALUE}}},{key:"normalize",value:function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var s=1;s<3;s++){var c=0;this._depth[t][s]>e&&(c=1),this._depth[t][s]=c}}}},{key:"getDelta",value:function(t){return this._depth[t][yt.RIGHT]-this._depth[t][yt.LEFT]}},{key:"getLocation",value:function(t,e){return this._depth[t][e]<=0?Y.EXTERIOR:Y.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var t=arguments[0],e=0;e<2;e++)for(var s=1;s<3;s++){var c=t.getLocation(e,s);c!==Y.EXTERIOR&&c!==Y.INTERIOR||(this.isNull(e,s)?this._depth[e][s]=o.depthAtLocation(c):this._depth[e][s]+=o.depthAtLocation(c))}else if(arguments.length===3){var p=arguments[0],_=arguments[1];arguments[2]===Y.INTERIOR&&this._depth[p][_]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var e=0;e<3;e++)this._depth[t][e]=o.NULL_VALUE}},{key:"depthAtLocation",value:function(t){return t===Y.EXTERIOR?0:t===Y.INTERIOR?1:o.NULL_VALUE}}])}();wi.NULL_VALUE=-1;var Ls=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var e=new Array(2).fill(null);return e[0]=this.pts[0],e[1]=this.pts[1],new t(e,Ie.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(e){this._isIsolated=e}},{key:"setName",value:function(e){this._name=e}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var s=e;if(this.pts.length!==s.pts.length)return!1;for(var c=!0,p=!0,_=this.pts.length,w=0;w<this.pts.length;w++)if(this.pts[w].equals2D(s.pts[w])||(c=!1),this.pts[w].equals2D(s.pts[--_])||(p=!1),!c&&!p)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var e=arguments[0];return this.pts[e]}}},{key:"print",value:function(e){e.print("edge "+this._name+": "),e.print("LINESTRING (");for(var s=0;s<this.pts.length;s++)s>0&&e.print(","),e.print(this.pts[s].x+" "+this.pts[s].y);e.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(e){t.updateIM(this._label,e)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(e){e.print("edge "+this._name+": ");for(var s=this.pts.length-1;s>=0;s--)e.print(this.pts[s]+" ");e.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new xn(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new Ct;for(var e=0;e<this.pts.length;e++)this._env.expandToInclude(this.pts[e])}return this._env}},{key:"addIntersection",value:function(e,s,c,p){var _=new et(e.getIntersection(p)),w=s,C=e.getEdgeDistance(c,p),z=w+1;if(z<this.pts.length){var tt=this.pts[z];_.equals2D(tt)&&(w=z,C=0)}this.eiList.add(_,w,C)}},{key:"toString",value:function(){var e=new Fi;e.append("edge "+this._name+": "),e.append("LINESTRING (");for(var s=0;s<this.pts.length;s++)s>0&&e.append(","),e.append(this.pts[s].x+" "+this.pts[s].y);return e.append(")  "+this._label+" "+this._depthDelta),e.toString()}},{key:"isPointwiseEqual",value:function(e){if(this.pts.length!==e.pts.length)return!1;for(var s=0;s<this.pts.length;s++)if(!this.pts[s].equals2D(e.pts[s]))return!1;return!0}},{key:"setDepthDelta",value:function(e){this._depthDelta=e}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(e,s,c){for(var p=0;p<e.getIntersectionNum();p++)this.addIntersection(e,s,c,p)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new ki(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new wi,this._depthDelta=0,arguments.length===1){var e=arguments[0];t.constructor_.call(this,e,null)}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.pts=s,this._label=c}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Is&&arguments[0]instanceof Ie))return R(t,"updateIM",this).apply(this,arguments);var e=arguments[0],s=arguments[1];s.setAtLeastIfValid(e.getLocation(0,yt.ON),e.getLocation(1,yt.ON),1),e.isArea()&&(s.setAtLeastIfValid(e.getLocation(0,yt.LEFT),e.getLocation(1,yt.LEFT),2),s.setAtLeastIfValid(e.getLocation(0,yt.RIGHT),e.getLocation(1,yt.RIGHT),2))}}])}($t),Ki=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"setWorkingPrecisionModel",value:function(t){this._workingPrecisionModel=t}},{key:"insertUniqueEdge",value:function(t){var e=this._edgeList.findEqualEdge(t);if(e!==null){var s=e.getLabel(),c=t.getLabel();e.isPointwiseEqual(t)||(c=new Ie(t.getLabel())).flip(),s.merge(c);var p=o.depthDelta(c),_=e.getDepthDelta()+p;e.setDepthDelta(_)}else this._edgeList.add(t),t.setDepthDelta(o.depthDelta(t.getLabel()))}},{key:"buildSubgraphs",value:function(t,e){for(var s=new It,c=t.iterator();c.hasNext();){var p=c.next(),_=p.getRightmostCoordinate(),w=new Ne(s).getDepth(_);p.computeDepth(w),p.findResultEdges(),s.add(p),e.add(p.getDirectedEdges(),p.getNodes())}}},{key:"createSubgraphs",value:function(t){for(var e=new It,s=t.getNodes().iterator();s.hasNext();){var c=s.next();if(!c.isVisited()){var p=new li;p.create(c),e.add(p)}}return An.sort(e,An.reverseOrder()),e}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(t){if(this._workingNoder!==null)return this._workingNoder;var e=new Dr,s=new un;return s.setPrecisionModel(t),e.setSegmentIntersector(new ti(s)),e}},{key:"buffer",value:function(t,e){var s=this._workingPrecisionModel;s===null&&(s=t.getPrecisionModel()),this._geomFact=t.getFactory();var c=new xi(s,this._bufParams),p=new qr(t,e,c).getCurves();if(p.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(p,s),this._graph=new Ui(new Qn),this._graph.addEdges(this._edgeList.getEdges());var _=this.createSubgraphs(this._graph),w=new _o(this._geomFact);this.buildSubgraphs(_,w);var C=w.getPolygons();return C.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(C)}},{key:"computeNodedEdges",value:function(t,e){var s=this.getNoder(e);s.computeNodes(t);for(var c=s.getNodedSubstrings().iterator();c.hasNext();){var p=c.next(),_=p.getCoordinates();if(_.length!==2||!_[0].equals2D(_[1])){var w=p.getData(),C=new Ls(p.getCoordinates(),new Ie(w));this.insertUniqueEdge(C)}}}},{key:"setNoder",value:function(t){this._workingNoder=t}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new hn;var t=arguments[0];this._bufParams=t}},{key:"depthDelta",value:function(t){var e=t.getLocation(0,yt.LEFT),s=t.getLocation(0,yt.RIGHT);return e===Y.INTERIOR&&s===Y.EXTERIOR?1:e===Y.EXTERIOR&&s===Y.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(t){for(var e=new Xe,s=new It;t.hasNext();){var c=t.next(),p=e.createLineString(c.getCoordinates());s.add(p)}return e.buildGeometry(s)}}])}(),bo=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"rescale",value:function(){if(Nt(arguments[0],At))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var s=arguments[0],c=0;c<s.length;c++)s[c].x=s[c].x/this._scaleFactor+this._offsetX,s[c].y=s[c].y/this._scaleFactor+this._offsetY;s.length===2&&s[0].equals2D(s[1])&&Re.out.println(s)}}},{key:"scale",value:function(){if(Nt(arguments[0],At)){for(var t=arguments[0],e=new It(t.size()),s=t.iterator();s.hasNext();){var c=s.next();e.add(new ln(this.scale(c.getCoordinates()),c.getData()))}return e}if(arguments[0]instanceof Array){for(var p=arguments[0],_=new Array(p.length).fill(null),w=0;w<p.length;w++)_[w]=new et(Math.round((p[w].x-this._offsetX)*this._scaleFactor),Math.round((p[w].y-this._offsetY)*this._scaleFactor),p[w].getZ());return oe.removeRepeatedPoints(_)}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t}},{key:"computeNodes",value:function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)}},{key:"interfaces_",get:function(){return[Rr]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var t=arguments[0],e=arguments[1];o.constructor_.call(this,t,e,0,0)}else if(arguments.length===4){var s=arguments[0],c=arguments[1];this._noder=s,this._scaleFactor=c,this._isScaled=!this.isIntegerPrecision()}}}])}(),$e=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(arguments.length===2){for(var s=arguments[0],c=arguments[1].iterator();c.hasNext();)for(var p=c.next().getCoordinates(),_=1;_<p.length-1;_++)if(p[_].equals(s))throw new ct("found endpt/interior pt intersection at index "+_+" :pt "+s)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),s=this._segStrings.iterator();s.hasNext();){var c=s.next();this.checkInteriorIntersections(e,c)}else if(arguments.length===2)for(var p=arguments[0],_=arguments[1],w=p.getCoordinates(),C=_.getCoordinates(),z=0;z<w.length-1;z++)for(var tt=0;tt<C.length-1;tt++)this.checkInteriorIntersections(p,z,_,tt);else if(arguments.length===4){var it=arguments[0],dt=arguments[1],xt=arguments[2],Et=arguments[3];if(it===xt&&dt===Et)return null;var Mt=it.getCoordinates()[dt],Ut=it.getCoordinates()[dt+1],zt=xt.getCoordinates()[Et],jt=xt.getCoordinates()[Et+1];if(this._li.computeIntersection(Mt,Ut,zt,jt),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Mt,Ut)||this.hasInteriorIntersection(this._li,zt,jt)))throw new ct("found non-noded intersection at "+Mt+"-"+Ut+" and "+zt+"-"+jt)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(arguments.length===1)for(var s=arguments[0].getCoordinates(),c=0;c<s.length-2;c++)this.checkCollapse(s[c],s[c+1],s[c+2])}},{key:"hasInteriorIntersection",value:function(t,e,s){for(var c=0;c<t.getIntersectionNum();c++){var p=t.getIntersection(c);if(!p.equals(e)&&!p.equals(s))return!0}return!1}},{key:"checkCollapse",value:function(t,e,s){if(t.equals(s))throw new ct("found non-noded collapse at "+o.fact.createLineString([t,e,s]))}}],[{key:"constructor_",value:function(){this._li=new un,this._segStrings=null;var t=arguments[0];this._segStrings=t}}])}();$e.fact=new Xe;var Zr=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"intersectsScaled",value:function(t,e){var s=Math.min(t.x,e.x),c=Math.max(t.x,e.x),p=Math.min(t.y,e.y),_=Math.max(t.y,e.y),w=this._maxx<s||this._minx>c||this._maxy<p||this._miny>_;if(w)return!1;var C=this.intersectsToleranceSquare(t,e);return ht.isTrue(!(w&&C),"Found bad envelope test"),C}},{key:"initCorners",value:function(t){var e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new et(this._maxx,this._maxy),this._corner[1]=new et(this._minx,this._maxy),this._corner[2]=new et(this._minx,this._miny),this._corner[3]=new et(this._maxx,this._miny)}},{key:"intersects",value:function(t,e){return this._scaleFactor===1?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(t){return Math.round(t*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var t=o.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ct(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(t,e){var s=!1,c=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(s=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(c=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!s||!c)||!!t.equals(this._pt)||!!e.equals(this._pt))))}},{key:"addSnappedNode",value:function(t,e){var s=t.getCoordinate(e),c=t.getCoordinate(e+1);return!!this.intersects(s,c)&&(t.addIntersection(this.getCoordinate(),e),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],s=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=s,e<=0)throw new F("Scale factor must be non-zero");e!==1&&(this._pt=new et(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new et,this._p1Scaled=new et),this.initCorners(this._pt)}}])}();Zr.SAFE_ENV_EXPANSION_FACTOR=.75;var ei=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var o=arguments[1];arguments[0].getLineSegment(o,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new Te}}])}(),Ss=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"snap",value:function(){if(arguments.length===1){var o=arguments[0];return this.snap(o,null,-1)}if(arguments.length===3){var t=arguments[0],e=arguments[1],s=arguments[2],c=t.getSafeEnvelope(),p=new je(t,e,s);return this._index.query(c,new(function(){return d(function _(){l(this,_)},[{key:"interfaces_",get:function(){return[vs]}},{key:"visitItem",value:function(_){_.select(c,p)}}])}())),p.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var o=arguments[0];this._index=o}}])}(),je=function(o){function t(){var e;return l(this,t),e=a(this,t),t.constructor_.apply(e,arguments),e}return I(t,o),d(t,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof Ar))return R(t,"select",this,1).apply(this,arguments);var e=arguments[1],s=arguments[0].getContext();if(this._parentEdge===s&&(e===this._hotPixelVertexIndex||e+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(s,e)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],s=arguments[1],c=arguments[2];this._hotPixel=e,this._parentEdge=s,this._hotPixelVertexIndex=c}}])}(ei);Ss.HotPixelSnapAction=je;var Ji=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"processIntersections",value:function(o,t,e,s){if(o===e&&t===s)return null;var c=o.getCoordinates()[t],p=o.getCoordinates()[t+1],_=e.getCoordinates()[s],w=e.getCoordinates()[s+1];if(this._li.computeIntersection(c,p,_,w),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var C=0;C<this._li.getIntersectionNum();C++)this._interiorIntersections.add(this._li.getIntersection(C));o.addIntersections(this._li,t,0),e.addIntersections(this._li,s,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[Ms]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var o=arguments[0];this._li=o,this._interiorIntersections=new It}}])}(),Cs=function(){return d(function o(){l(this,o),o.constructor_.apply(this,arguments)},[{key:"checkCorrectness",value:function(o){var t=ln.getNodedSubstrings(o),e=new $e(t);try{e.checkValid()}catch(s){if(!(s instanceof A))throw s;s.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return ln.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(o,t){var e=this.findInteriorIntersections(o,t);this.computeIntersectionSnaps(e),this.computeVertexSnaps(o)}},{key:"findInteriorIntersections",value:function(o,t){var e=new Ji(t);return this._noder.setSegmentIntersector(e),this._noder.computeNodes(o),e.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(Nt(arguments[0],At))for(var o=arguments[0].iterator();o.hasNext();){var t=o.next();this.computeVertexSnaps(t)}else if(arguments[0]instanceof ln)for(var e=arguments[0],s=e.getCoordinates(),c=0;c<s.length;c++){var p=new Zr(s[c],this._scaleFactor,this._li);this._pointSnapper.snap(p,e,c)&&e.addIntersection(s[c],c)}}},{key:"computeNodes",value:function(o){this._nodedSegStrings=o,this._noder=new Dr,this._pointSnapper=new Ss(this._noder.getIndex()),this.snapRound(o,this._li)}},{key:"computeIntersectionSnaps",value:function(o){for(var t=o.iterator();t.hasNext();){var e=t.next(),s=new Zr(e,this._scaleFactor,this._li);this._pointSnapper.snap(s)}}},{key:"interfaces_",get:function(){return[Rr]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var o=arguments[0];this._pm=o,this._li=new un,this._li.setPrecisionModel(o),this._scaleFactor=o.getScale()}}])}(),kn=function(){function o(){l(this,o),o.constructor_.apply(this,arguments)}return d(o,[{key:"bufferFixedPrecision",value:function(t){var e=new bo(new Cs(new we(1)),t.getScale()),s=new Ki(this._bufParams);s.setWorkingPrecisionModel(t),s.setNoder(e),this._resultGeometry=s.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var t=o.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(p){if(!(p instanceof Ue))throw p;this._saveException=p}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var e=arguments[0],s=o.precisionScaleFactor(this._argGeom,this._distance,e),c=new we(s);this.bufferFixedPrecision(c)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===we.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(t){this._bufParams.setQuadrantSegments(t)}},{key:"bufferOriginalPrecision",value:function(){try{var t=new Ki(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(e){if(!(e instanceof ct))throw e;this._saveException=e}}},{key:"getResultGeometry",value:function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(t){this._bufParams.setEndCapStyle(t)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new q,this._resultGeometry=null,this._saveException=null,arguments.length===1){var t=arguments[0];this._argGeom=t}else if(arguments.length===2){var e=arguments[0],s=arguments[1];this._argGeom=e,this._bufParams=s}}},{key:"bufferOp",value:function(){if(arguments.length===2){var t=arguments[1];return new o(arguments[0]).getResultGeometry(t)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof vt&&typeof arguments[1]=="number"){var e=arguments[1],s=arguments[2],c=new o(arguments[0]);return c.setQuadrantSegments(s),c.getResultGeometry(e)}if(arguments[2]instanceof q&&arguments[0]instanceof vt&&typeof arguments[1]=="number"){var p=arguments[1];return new o(arguments[0],arguments[2]).getResultGeometry(p)}}else if(arguments.length===4){var _=arguments[1],w=arguments[2],C=arguments[3],z=new o(arguments[0]);return z.setQuadrantSegments(w),z.setEndCapStyle(C),z.getResultGeometry(_)}}},{key:"precisionScaleFactor",value:function(t,e,s){var c=t.getEnvelopeInternal(),p=Xn.max(Math.abs(c.getMaxX()),Math.abs(c.getMaxY()),Math.abs(c.getMinX()),Math.abs(c.getMinY()))+2*(e>0?e:0),_=s-Math.trunc(Math.log(p)/Math.log(10)+1);return Math.pow(10,_)}}])}();kn.CAP_ROUND=q.CAP_ROUND,kn.CAP_BUTT=q.CAP_FLAT,kn.CAP_FLAT=q.CAP_FLAT,kn.CAP_SQUARE=q.CAP_SQUARE,kn.MAX_PRECISION_DIGITS=12;var $i=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],ji=function(){return d(function o(t){l(this,o),this.geometryFactory=t||new Xe},[{key:"read",value:function(o){var t,e=(t=typeof o=="string"?JSON.parse(o):o).type;if(!Ee[e])throw new Error("Unknown GeoJSON type: "+t.type);return $i.indexOf(e)!==-1?Ee[e].call(this,t.coordinates):e==="GeometryCollection"?Ee[e].call(this,t.geometries):Ee[e].call(this,t)}},{key:"write",value:function(o){var t=o.getGeometryType();if(!Pe[t])throw new Error("Geometry is not supported");return Pe[t].call(this,o)}}])}(),Ee={Feature:function(o){var t={};for(var e in o)t[e]=o[e];if(o.geometry){var s=o.geometry.type;if(!Ee[s])throw new Error("Unknown GeoJSON type: "+o.type);t.geometry=this.read(o.geometry)}return o.bbox&&(t.bbox=Ee.bbox.call(this,o.bbox)),t},FeatureCollection:function(o){var t={};if(o.features){t.features=[];for(var e=0;e<o.features.length;++e)t.features.push(this.read(o.features[e]))}return o.bbox&&(t.bbox=this.parse.bbox.call(this,o.bbox)),t},coordinates:function(o){for(var t=[],e=0;e<o.length;++e){var s=o[e];t.push(g(et,W(s)))}return t},bbox:function(o){return this.geometryFactory.createLinearRing([new et(o[0],o[1]),new et(o[2],o[1]),new et(o[2],o[3]),new et(o[0],o[3]),new et(o[0],o[1])])},Point:function(o){var t=g(et,W(o));return this.geometryFactory.createPoint(t)},MultiPoint:function(o){for(var t=[],e=0;e<o.length;++e)t.push(Ee.Point.call(this,o[e]));return this.geometryFactory.createMultiPoint(t)},LineString:function(o){var t=Ee.coordinates.call(this,o);return this.geometryFactory.createLineString(t)},MultiLineString:function(o){for(var t=[],e=0;e<o.length;++e)t.push(Ee.LineString.call(this,o[e]));return this.geometryFactory.createMultiLineString(t)},Polygon:function(o){for(var t=Ee.coordinates.call(this,o[0]),e=this.geometryFactory.createLinearRing(t),s=[],c=1;c<o.length;++c){var p=o[c],_=Ee.coordinates.call(this,p),w=this.geometryFactory.createLinearRing(_);s.push(w)}return this.geometryFactory.createPolygon(e,s)},MultiPolygon:function(o){for(var t=[],e=0;e<o.length;++e){var s=o[e];t.push(Ee.Polygon.call(this,s))}return this.geometryFactory.createMultiPolygon(t)},GeometryCollection:function(o){for(var t=[],e=0;e<o.length;++e){var s=o[e];t.push(this.read(s))}return this.geometryFactory.createGeometryCollection(t)}},Pe={coordinate:function(o){var t=[o.x,o.y];return o.z&&t.push(o.z),o.m&&t.push(o.m),t},Point:function(o){return{type:"Point",coordinates:Pe.coordinate.call(this,o.getCoordinate())}},MultiPoint:function(o){for(var t=[],e=0;e<o._geometries.length;++e){var s=o._geometries[e],c=Pe.Point.call(this,s);t.push(c.coordinates)}return{type:"MultiPoint",coordinates:t}},LineString:function(o){for(var t=[],e=o.getCoordinates(),s=0;s<e.length;++s){var c=e[s];t.push(Pe.coordinate.call(this,c))}return{type:"LineString",coordinates:t}},MultiLineString:function(o){for(var t=[],e=0;e<o._geometries.length;++e){var s=o._geometries[e],c=Pe.LineString.call(this,s);t.push(c.coordinates)}return{type:"MultiLineString",coordinates:t}},Polygon:function(o){var t=[],e=Pe.LineString.call(this,o._shell);t.push(e.coordinates);for(var s=0;s<o._holes.length;++s){var c=o._holes[s],p=Pe.LineString.call(this,c);t.push(p.coordinates)}return{type:"Polygon",coordinates:t}},MultiPolygon:function(o){for(var t=[],e=0;e<o._geometries.length;++e){var s=o._geometries[e],c=Pe.Polygon.call(this,s);t.push(c.coordinates)}return{type:"MultiPolygon",coordinates:t}},GeometryCollection:function(o){for(var t=[],e=0;e<o._geometries.length;++e){var s=o._geometries[e],c=s.getGeometryType();t.push(Pe[c].call(this,s))}return{type:"GeometryCollection",geometries:t}}};return{BufferOp:kn,GeoJSONReader:function(){return d(function o(t){l(this,o),this.parser=new ji(t||new Xe)},[{key:"read",value:function(o){return this.parser.read(o)}}])}(),GeoJSONWriter:function(){return d(function o(){l(this,o),this.parser=new ji(this.geometryFactory)},[{key:"write",value:function(o){return this.parser.write(o)}}])}()}})}($s)),$s.exports}var ic=nc();const rc=Cu(ic);function ai(){return new ro}function ro(){this.reset()}ro.prototype={constructor:ro,reset:function(){this.s=this.t=0},add:function(h){Ua(Gs,h,this.t),Ua(this,Gs.s,this.s),this.s?this.t+=Gs.t:this.s=Gs.t},valueOf:function(){return this.s}};var Gs=new ro;function Ua(h,i,r){var a=h.s=i+r,l=a-i,g=a-l;h.t=i-g+(r-l)}var Qt=1e-6,Wt=Math.PI,Mn=Wt/2,Ya=Wt/4,Sn=Wt*2,ri=180/Wt,on=Wt/180,_e=Math.abs,sc=Math.atan,cr=Math.atan2,re=Math.cos,se=Math.sin,dr=Math.sqrt;function Hu(h){return h>1?0:h<-1?Wt:Math.acos(h)}function Ci(h){return h>1?Mn:h<-1?-Mn:Math.asin(h)}function es(){}function so(h,i){h&&Va.hasOwnProperty(h.type)&&Va[h.type](h,i)}var Xa={Feature:function(h,i){so(h.geometry,i)},FeatureCollection:function(h,i){for(var r=h.features,a=-1,l=r.length;++a<l;)so(r[a].geometry,i)}},Va={Sphere:function(h,i){i.sphere()},Point:function(h,i){h=h.coordinates,i.point(h[0],h[1],h[2])},MultiPoint:function(h,i){for(var r=h.coordinates,a=-1,l=r.length;++a<l;)h=r[a],i.point(h[0],h[1],h[2])},LineString:function(h,i){$o(h.coordinates,i,0)},MultiLineString:function(h,i){for(var r=h.coordinates,a=-1,l=r.length;++a<l;)$o(r[a],i,0)},Polygon:function(h,i){Wa(h.coordinates,i)},MultiPolygon:function(h,i){for(var r=h.coordinates,a=-1,l=r.length;++a<l;)Wa(r[a],i)},GeometryCollection:function(h,i){for(var r=h.geometries,a=-1,l=r.length;++a<l;)so(r[a],i)}};function $o(h,i,r){var a=-1,l=h.length-r,g;for(i.lineStart();++a<l;)g=h[a],i.point(g[0],g[1],g[2]);i.lineEnd()}function Wa(h,i){var r=-1,a=h.length;for(i.polygonStart();++r<a;)$o(h[r],i,1);i.polygonEnd()}function oc(h,i){h&&Xa.hasOwnProperty(h.type)?Xa[h.type](h,i):so(h,i)}ai();ai();function jo(h){return[cr(h[1],h[0]),Ci(h[2])]}function fr(h){var i=h[0],r=h[1],a=re(r);return[a*re(i),a*se(i),se(r)]}function Hs(h,i){return h[0]*i[0]+h[1]*i[1]+h[2]*i[2]}function oo(h,i){return[h[1]*i[2]-h[2]*i[1],h[2]*i[0]-h[0]*i[2],h[0]*i[1]-h[1]*i[0]]}function zo(h,i){h[0]+=i[0],h[1]+=i[1],h[2]+=i[2]}function qs(h,i){return[h[0]*i,h[1]*i,h[2]*i]}function Qo(h){var i=dr(h[0]*h[0]+h[1]*h[1]+h[2]*h[2]);h[0]/=i,h[1]/=i,h[2]/=i}ai();function qu(h,i){function r(a,l){return a=h(a,l),i(a[0],a[1])}return h.invert&&i.invert&&(r.invert=function(a,l){return a=i.invert(a,l),a&&h.invert(a[0],a[1])}),r}function ta(h,i){return[h>Wt?h-Sn:h<-Wt?h+Sn:h,i]}ta.invert=ta;function ac(h,i,r){return(h%=Sn)?i||r?qu(Ja(h),$a(i,r)):Ja(h):i||r?$a(i,r):ta}function Ka(h){return function(i,r){return i+=h,[i>Wt?i-Sn:i<-Wt?i+Sn:i,r]}}function Ja(h){var i=Ka(h);return i.invert=Ka(-h),i}function $a(h,i){var r=re(h),a=se(h),l=re(i),g=se(i);function m(d,x){var v=re(x),P=re(d)*v,I=se(d)*v,b=se(x),O=b*r+P*a;return[cr(I*l-O*g,P*r-b*a),Ci(O*l+I*g)]}return m.invert=function(d,x){var v=re(x),P=re(d)*v,I=se(d)*v,b=se(x),O=b*l-I*g;return[cr(I*l+b*g,P*r+O*a),Ci(O*r-P*a)]},m}function uc(h,i,r,a,l,g){if(r){var m=re(i),d=se(i),x=a*r;l==null?(l=i+a*Sn,g=i-x/2):(l=ja(m,l),g=ja(m,g),(a>0?l<g:l>g)&&(l+=a*Sn));for(var v,P=l;a>0?P>g:P<g;P-=x)v=jo([m,-d*re(P),-d*se(P)]),h.point(v[0],v[1])}}function ja(h,i){i=fr(i),i[0]-=h,Qo(i);var r=Hu(-i[1]);return((-i[2]<0?-r:r)+Sn-Qt)%Sn}function Zu(){var h=[],i;return{point:function(r,a){i.push([r,a])},lineStart:function(){h.push(i=[])},lineEnd:es,rejoin:function(){h.length>1&&h.push(h.pop().concat(h.shift()))},result:function(){var r=h;return h=[],i=null,r}}}function lc(h,i,r,a,l,g){var m=h[0],d=h[1],x=i[0],v=i[1],P=0,I=1,b=x-m,O=v-d,R;if(R=r-m,!(!b&&R>0)){if(R/=b,b<0){if(R<P)return;R<I&&(I=R)}else if(b>0){if(R>I)return;R>P&&(P=R)}if(R=l-m,!(!b&&R<0)){if(R/=b,b<0){if(R>I)return;R>P&&(P=R)}else if(b>0){if(R<P)return;R<I&&(I=R)}if(R=a-d,!(!O&&R>0)){if(R/=O,O<0){if(R<P)return;R<I&&(I=R)}else if(O>0){if(R>I)return;R>P&&(P=R)}if(R=g-d,!(!O&&R<0)){if(R/=O,O<0){if(R>I)return;R>P&&(P=R)}else if(O>0){if(R<P)return;R<I&&(I=R)}return P>0&&(h[0]=m+P*b,h[1]=d+P*O),I<1&&(i[0]=m+I*b,i[1]=d+I*O),!0}}}}}function js(h,i){return _e(h[0]-i[0])<Qt&&_e(h[1]-i[1])<Qt}function Zs(h,i,r,a){this.x=h,this.z=i,this.o=r,this.e=a,this.v=!1,this.n=this.p=null}function Uu(h,i,r,a,l){var g=[],m=[],d,x;if(h.forEach(function(R){if(!((W=R.length-1)<=0)){var W,j=R[0],st=R[W],M;if(js(j,st)){for(l.lineStart(),d=0;d<W;++d)l.point((j=R[d])[0],j[1]);l.lineEnd();return}g.push(M=new Zs(j,R,null,!0)),m.push(M.o=new Zs(j,null,M,!1)),g.push(M=new Zs(st,R,null,!1)),m.push(M.o=new Zs(st,null,M,!0))}}),!!g.length){for(m.sort(i),Qa(g),Qa(m),d=0,x=m.length;d<x;++d)m[d].e=r=!r;for(var v=g[0],P,I;;){for(var b=v,O=!0;b.v;)if((b=b.n)===v)return;P=b.z,l.lineStart();do{if(b.v=b.o.v=!0,b.e){if(O)for(d=0,x=P.length;d<x;++d)l.point((I=P[d])[0],I[1]);else a(b.x,b.n.x,1,l);b=b.n}else{if(O)for(P=b.p.z,d=P.length-1;d>=0;--d)l.point((I=P[d])[0],I[1]);else a(b.x,b.p.x,-1,l);b=b.p}b=b.o,P=b.z,O=!O}while(!b.v);l.lineEnd()}}}function Qa(h){if(i=h.length){for(var i,r=0,a=h[0],l;++r<i;)a.n=l=h[r],l.p=a,a=l;a.n=l=h[0],l.p=a}}function Yu(h,i){return h<i?-1:h>i?1:h>=i?0:NaN}function hc(h){return h.length===1&&(h=cc(h)),{left:function(i,r,a,l){for(a==null&&(a=0),l==null&&(l=i.length);a<l;){var g=a+l>>>1;h(i[g],r)<0?a=g+1:l=g}return a},right:function(i,r,a,l){for(a==null&&(a=0),l==null&&(l=i.length);a<l;){var g=a+l>>>1;h(i[g],r)>0?l=g:a=g+1}return a}}}function cc(h){return function(i,r){return Yu(h(i),r)}}hc(Yu);function Xu(h){for(var i=h.length,r,a=-1,l=0,g,m;++a<i;)l+=h[a].length;for(g=new Array(l);--i>=0;)for(m=h[i],r=m.length;--r>=0;)g[--l]=m[r];return g}var ns=1e9,Us=-ns;function fc(h,i,r,a){function l(v,P){return h<=v&&v<=r&&i<=P&&P<=a}function g(v,P,I,b){var O=0,R=0;if(v==null||(O=m(v,I))!==(R=m(P,I))||x(v,P)<0^I>0)do b.point(O===0||O===3?h:r,O>1?a:i);while((O=(O+I+4)%4)!==R);else b.point(P[0],P[1])}function m(v,P){return _e(v[0]-h)<Qt?P>0?0:3:_e(v[0]-r)<Qt?P>0?2:1:_e(v[1]-i)<Qt?P>0?1:0:P>0?3:2}function d(v,P){return x(v.x,P.x)}function x(v,P){var I=m(v,1),b=m(P,1);return I!==b?I-b:I===0?P[1]-v[1]:I===1?v[0]-P[0]:I===2?v[1]-P[1]:P[0]-v[0]}return function(v){var P=v,I=Zu(),b,O,R,W,j,st,M,q,A,F,H,K={point:E,lineStart:D,lineEnd:V,polygonStart:N,polygonEnd:B};function E(U,G){l(U,G)&&P.point(U,G)}function S(){for(var U=0,G=0,Q=O.length;G<Q;++G)for(var X=O[G],nt=1,J=X.length,ot=X[0],ct,pt,ht=ot[0],ft=ot[1];nt<J;++nt)ct=ht,pt=ft,ot=X[nt],ht=ot[0],ft=ot[1],pt<=a?ft>a&&(ht-ct)*(a-pt)>(ft-pt)*(h-ct)&&++U:ft<=a&&(ht-ct)*(a-pt)<(ft-pt)*(h-ct)&&--U;return U}function N(){P=I,b=[],O=[],H=!0}function B(){var U=S(),G=H&&U,Q=(b=Xu(b)).length;(G||Q)&&(v.polygonStart(),G&&(v.lineStart(),g(null,null,1,v),v.lineEnd()),Q&&Uu(b,d,U,g,v),v.polygonEnd()),P=v,b=O=R=null}function D(){K.point=Z,O&&O.push(R=[]),F=!0,A=!1,M=q=NaN}function V(){b&&(Z(W,j),st&&A&&I.rejoin(),b.push(I.result())),K.point=E,A&&P.lineEnd()}function Z(U,G){var Q=l(U,G);if(O&&R.push([U,G]),F)W=U,j=G,st=Q,F=!1,Q&&(P.lineStart(),P.point(U,G));else if(Q&&A)P.point(U,G);else{var X=[M=Math.max(Us,Math.min(ns,M)),q=Math.max(Us,Math.min(ns,q))],nt=[U=Math.max(Us,Math.min(ns,U)),G=Math.max(Us,Math.min(ns,G))];lc(X,nt,h,i,r,a)?(A||(P.lineStart(),P.point(X[0],X[1])),P.point(nt[0],nt[1]),Q||P.lineEnd(),H=!1):Q&&(P.lineStart(),P.point(U,G),H=!1)}M=U,q=G,A=Q}return K}}var Go=ai();function gc(h,i){var r=i[0],a=i[1],l=[se(r),-re(r),0],g=0,m=0;Go.reset();for(var d=0,x=h.length;d<x;++d)if(P=(v=h[d]).length)for(var v,P,I=v[P-1],b=I[0],O=I[1]/2+Ya,R=se(O),W=re(O),j=0;j<P;++j,b=M,R=A,W=F,I=st){var st=v[j],M=st[0],q=st[1]/2+Ya,A=se(q),F=re(q),H=M-b,K=H>=0?1:-1,E=K*H,S=E>Wt,N=R*A;if(Go.add(cr(N*K*se(E),W*F+N*re(E))),g+=S?H+K*Sn:H,S^b>=r^M>=r){var B=oo(fr(I),fr(st));Qo(B);var D=oo(l,B);Qo(D);var V=(S^H>=0?-1:1)*Ci(D[2]);(a>V||a===V&&(B[0]||B[1]))&&(m+=S^H>=0?1:-1)}}return(g<-Qt||g<Qt&&Go<-Qt)^m&1}ai();function tu(h){return h}ai();ai();var gr=1/0,ao=gr,hs=-gr,uo=hs,eu={point:dc,lineStart:es,lineEnd:es,polygonStart:es,polygonEnd:es,result:function(){var h=[[gr,ao],[hs,uo]];return hs=uo=-(ao=gr=1/0),h}};function dc(h,i){h<gr&&(gr=h),h>hs&&(hs=h),i<ao&&(ao=i),i>uo&&(uo=i)}ai();function Vu(h,i,r,a){return function(l,g){var m=i(g),d=l.invert(a[0],a[1]),x=Zu(),v=i(x),P=!1,I,b,O,R={point:W,lineStart:st,lineEnd:M,polygonStart:function(){R.point=q,R.lineStart=A,R.lineEnd=F,b=[],I=[]},polygonEnd:function(){R.point=W,R.lineStart=st,R.lineEnd=M,b=Xu(b);var H=gc(I,d);b.length?(P||(g.polygonStart(),P=!0),Uu(b,pc,H,r,g)):H&&(P||(g.polygonStart(),P=!0),g.lineStart(),r(null,null,1,g),g.lineEnd()),P&&(g.polygonEnd(),P=!1),b=I=null},sphere:function(){g.polygonStart(),g.lineStart(),r(null,null,1,g),g.lineEnd(),g.polygonEnd()}};function W(H,K){var E=l(H,K);h(H=E[0],K=E[1])&&g.point(H,K)}function j(H,K){var E=l(H,K);m.point(E[0],E[1])}function st(){R.point=j,m.lineStart()}function M(){R.point=W,m.lineEnd()}function q(H,K){O.push([H,K]);var E=l(H,K);v.point(E[0],E[1])}function A(){v.lineStart(),O=[]}function F(){q(O[0][0],O[0][1]),v.lineEnd();var H=v.clean(),K=x.result(),E,S=K.length,N,B,D;if(O.pop(),I.push(O),O=null,!!S){if(H&1){if(B=K[0],(N=B.length-1)>0){for(P||(g.polygonStart(),P=!0),g.lineStart(),E=0;E<N;++E)g.point((D=B[E])[0],D[1]);g.lineEnd()}return}S>1&&H&2&&K.push(K.pop().concat(K.shift())),b.push(K.filter(mc))}}return R}}function mc(h){return h.length>1}function pc(h,i){return((h=h.x)[0]<0?h[1]-Mn-Qt:Mn-h[1])-((i=i.x)[0]<0?i[1]-Mn-Qt:Mn-i[1])}const nu=Vu(function(){return!0},yc,_c,[-Wt,-Mn]);function yc(h){var i=NaN,r=NaN,a=NaN,l;return{lineStart:function(){h.lineStart(),l=1},point:function(g,m){var d=g>0?Wt:-Wt,x=_e(g-i);_e(x-Wt)<Qt?(h.point(i,r=(r+m)/2>0?Mn:-Mn),h.point(a,r),h.lineEnd(),h.lineStart(),h.point(d,r),h.point(g,r),l=0):a!==d&&x>=Wt&&(_e(i-a)<Qt&&(i-=a*Qt),_e(g-d)<Qt&&(g-=d*Qt),r=vc(i,r,g,m),h.point(a,r),h.lineEnd(),h.lineStart(),h.point(d,r),l=0),h.point(i=g,r=m),a=d},lineEnd:function(){h.lineEnd(),i=r=NaN},clean:function(){return 2-l}}}function vc(h,i,r,a){var l,g,m=se(h-r);return _e(m)>Qt?sc((se(i)*(g=re(a))*se(r)-se(a)*(l=re(i))*se(h))/(l*g*m)):(i+a)/2}function _c(h,i,r,a){var l;if(h==null)l=r*Mn,a.point(-Wt,l),a.point(0,l),a.point(Wt,l),a.point(Wt,0),a.point(Wt,-l),a.point(0,-l),a.point(-Wt,-l),a.point(-Wt,0),a.point(-Wt,l);else if(_e(h[0]-i[0])>Qt){var g=h[0]<i[0]?Wt:-Wt;l=r*g/2,a.point(-g,l),a.point(0,l),a.point(g,l)}else a.point(i[0],i[1])}function xc(h,i){var r=re(h),a=r>0,l=_e(r)>Qt;function g(P,I,b,O){uc(O,h,i,b,P,I)}function m(P,I){return re(P)*re(I)>r}function d(P){var I,b,O,R,W;return{lineStart:function(){R=O=!1,W=1},point:function(j,st){var M=[j,st],q,A=m(j,st),F=a?A?0:v(j,st):A?v(j+(j<0?Wt:-Wt),st):0;if(!I&&(R=O=A)&&P.lineStart(),A!==O&&(q=x(I,M),(!q||js(I,q)||js(M,q))&&(M[0]+=Qt,M[1]+=Qt,A=m(M[0],M[1]))),A!==O)W=0,A?(P.lineStart(),q=x(M,I),P.point(q[0],q[1])):(q=x(I,M),P.point(q[0],q[1]),P.lineEnd()),I=q;else if(l&&I&&a^A){var H;!(F&b)&&(H=x(M,I,!0))&&(W=0,a?(P.lineStart(),P.point(H[0][0],H[0][1]),P.point(H[1][0],H[1][1]),P.lineEnd()):(P.point(H[1][0],H[1][1]),P.lineEnd(),P.lineStart(),P.point(H[0][0],H[0][1])))}A&&(!I||!js(I,M))&&P.point(M[0],M[1]),I=M,O=A,b=F},lineEnd:function(){O&&P.lineEnd(),I=null},clean:function(){return W|(R&&O)<<1}}}function x(P,I,b){var O=fr(P),R=fr(I),W=[1,0,0],j=oo(O,R),st=Hs(j,j),M=j[0],q=st-M*M;if(!q)return!b&&P;var A=r*st/q,F=-r*M/q,H=oo(W,j),K=qs(W,A),E=qs(j,F);zo(K,E);var S=H,N=Hs(K,S),B=Hs(S,S),D=N*N-B*(Hs(K,K)-1);if(!(D<0)){var V=dr(D),Z=qs(S,(-N-V)/B);if(zo(Z,K),Z=jo(Z),!b)return Z;var U=P[0],G=I[0],Q=P[1],X=I[1],nt;G<U&&(nt=U,U=G,G=nt);var J=G-U,ot=_e(J-Wt)<Qt,ct=ot||J<Qt;if(!ot&&X<Q&&(nt=Q,Q=X,X=nt),ct?ot?Q+X>0^Z[1]<(_e(Z[0]-U)<Qt?Q:X):Q<=Z[1]&&Z[1]<=X:J>Wt^(U<=Z[0]&&Z[0]<=G)){var pt=qs(S,(-N+V)/B);return zo(pt,K),[Z,jo(pt)]}}}function v(P,I){var b=a?h:Wt-h,O=0;return P<-b?O|=1:P>b&&(O|=2),I<-b?O|=4:I>b&&(O|=8),O}return Vu(m,d,g,a?[0,-h]:[-Wt,h-Wt])}function Wu(h){return function(i){var r=new ea;for(var a in h)r[a]=h[a];return r.stream=i,r}}function ea(){}ea.prototype={constructor:ea,point:function(h,i){this.stream.point(h,i)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Ku(h,i,r){var a=i[1][0]-i[0][0],l=i[1][1]-i[0][1],g=h.clipExtent&&h.clipExtent();h.scale(150).translate([0,0]),g!=null&&h.clipExtent(null),oc(r,h.stream(eu));var m=eu.result(),d=Math.min(a/(m[1][0]-m[0][0]),l/(m[1][1]-m[0][1])),x=+i[0][0]+(a-d*(m[1][0]+m[0][0]))/2,v=+i[0][1]+(l-d*(m[1][1]+m[0][1]))/2;return g!=null&&h.clipExtent(g),h.scale(d*150).translate([x,v])}function kc(h,i,r){return Ku(h,[[0,0],i],r)}var iu=16,wc=re(30*on);function ru(h,i){return+i?Pc(h,i):Ec(h)}function Ec(h){return Wu({point:function(i,r){i=h(i,r),this.stream.point(i[0],i[1])}})}function Pc(h,i){function r(a,l,g,m,d,x,v,P,I,b,O,R,W,j){var st=v-a,M=P-l,q=st*st+M*M;if(q>4*i&&W--){var A=m+b,F=d+O,H=x+R,K=dr(A*A+F*F+H*H),E=Ci(H/=K),S=_e(_e(H)-1)<Qt||_e(g-I)<Qt?(g+I)/2:cr(F,A),N=h(S,E),B=N[0],D=N[1],V=B-a,Z=D-l,U=M*V-st*Z;(U*U/q>i||_e((st*V+M*Z)/q-.5)>.3||m*b+d*O+x*R<wc)&&(r(a,l,g,m,d,x,B,D,S,A/=K,F/=K,H,W,j),j.point(B,D),r(B,D,S,A,F,H,v,P,I,b,O,R,W,j))}}return function(a){var l,g,m,d,x,v,P,I,b,O,R,W,j={point:st,lineStart:M,lineEnd:A,polygonStart:function(){a.polygonStart(),j.lineStart=F},polygonEnd:function(){a.polygonEnd(),j.lineStart=M}};function st(E,S){E=h(E,S),a.point(E[0],E[1])}function M(){I=NaN,j.point=q,a.lineStart()}function q(E,S){var N=fr([E,S]),B=h(E,S);r(I,b,P,O,R,W,I=B[0],b=B[1],P=E,O=N[0],R=N[1],W=N[2],iu,a),a.point(I,b)}function A(){j.point=st,a.lineEnd()}function F(){M(),j.point=H,j.lineEnd=K}function H(E,S){q(l=E,S),g=I,m=b,d=O,x=R,v=W,j.point=q}function K(){r(I,b,P,O,R,W,g,m,l,d,x,v,iu,a),j.lineEnd=A,A()}return j}}var Mc=Wu({point:function(h,i){this.stream.point(h*on,i*on)}});function Ic(h){return Lc(function(){return h})()}function Lc(h){var i,r=150,a=480,l=250,g,m,d=0,x=0,v=0,P=0,I=0,b,O,R=null,W=nu,j=null,st,M,q,A=tu,F=.5,H=ru(B,F),K,E;function S(Z){return Z=O(Z[0]*on,Z[1]*on),[Z[0]*r+g,m-Z[1]*r]}function N(Z){return Z=O.invert((Z[0]-g)/r,(m-Z[1])/r),Z&&[Z[0]*ri,Z[1]*ri]}function B(Z,U){return Z=i(Z,U),[Z[0]*r+g,m-Z[1]*r]}S.stream=function(Z){return K&&E===Z?K:K=Mc(W(b,H(A(E=Z))))},S.clipAngle=function(Z){return arguments.length?(W=+Z?xc(R=Z*on,6*on):(R=null,nu),V()):R*ri},S.clipExtent=function(Z){return arguments.length?(A=Z==null?(j=st=M=q=null,tu):fc(j=+Z[0][0],st=+Z[0][1],M=+Z[1][0],q=+Z[1][1]),V()):j==null?null:[[j,st],[M,q]]},S.scale=function(Z){return arguments.length?(r=+Z,D()):r},S.translate=function(Z){return arguments.length?(a=+Z[0],l=+Z[1],D()):[a,l]},S.center=function(Z){return arguments.length?(d=Z[0]%360*on,x=Z[1]%360*on,D()):[d*ri,x*ri]},S.rotate=function(Z){return arguments.length?(v=Z[0]%360*on,P=Z[1]%360*on,I=Z.length>2?Z[2]%360*on:0,D()):[v*ri,P*ri,I*ri]},S.precision=function(Z){return arguments.length?(H=ru(B,F=Z*Z),V()):dr(F)},S.fitExtent=function(Z,U){return Ku(S,Z,U)},S.fitSize=function(Z,U){return kc(S,Z,U)};function D(){O=qu(b=ac(v,P,I),i);var Z=i(d,x);return g=a-Z[0]*r,m=l+Z[1]*r,V()}function V(){return K=E=null,S}return function(){return i=h.apply(this,arguments),S.invert=i.invert&&N,D()}}function Ju(h){return function(i,r){var a=re(i),l=re(r),g=h(a*l);return[g*l*se(i),g*se(r)]}}function $u(h){return function(i,r){var a=dr(i*i+r*r),l=h(a),g=se(l),m=re(l);return[cr(i*g,a*m),Ci(a&&r*g/a)]}}var Sc=Ju(function(h){return dr(2/(1+h))});Sc.invert=$u(function(h){return 2*Ci(h/2)});var ju=Ju(function(h){return(h=Hu(h))&&h/se(h)});ju.invert=$u(function(h){return h});function Cc(){return Ic(ju).scale(79.4188).clipAngle(180-.001)}function su(h,i){return[h,i]}su.invert=su;var{BufferOp:bc,GeoJSONReader:Tc,GeoJSONWriter:Nc}=rc;function Oc(h,i,r){r=r||{};var a=r.units||"kilometers",l=r.steps||8;if(!h)throw new Error("geojson is required");if(typeof r!="object")throw new Error("options must be an object");if(typeof l!="number")throw new Error("steps must be an number");if(i===void 0)throw new Error("radius is required");if(l<=0)throw new Error("steps must be greater than 0");var g=[];switch(h.type){case"GeometryCollection":return oi(h,function(m){var d=Qs(m,i,a,l);d&&g.push(d)}),In(g);case"FeatureCollection":return si(h,function(m){var d=Qs(m,i,a,l);d&&si(d,function(x){x&&g.push(x)})}),In(g)}return Qs(h,i,a,l)}function Qs(h,i,r,a){var l=h.properties||{},g=h.type==="Feature"?h.geometry:h;if(g.type==="GeometryCollection"){var m=[];return oi(h,function(W){var j=Qs(W,i,r,a);j&&m.push(j)}),In(m)}var d=Ac(g),x={type:g.type,coordinates:tl(g.coordinates,d)},v=new Tc,P=v.read(x),I=Lu(jl(i,r),"meters"),b=bc.bufferOp(P,I,a),O=new Nc;if(b=O.write(b),!Qu(b.coordinates)){var R={type:b.type,coordinates:el(b.coordinates,d)};return gn(R,l)}}function Qu(h){return Array.isArray(h[0])?Qu(h[0]):isNaN(h[0])}function tl(h,i){return typeof h[0]!="object"?i(h):h.map(function(r){return tl(r,i)})}function el(h,i){return typeof h[0]!="object"?i.invert(h):h.map(function(r){return el(r,i)})}function Ac(h){var i=tc(h).geometry.coordinates,r=[-i[0],-i[1]];return Cc().rotate(r).scale(Se)}var Rc=Oc;function na(h,i={}){var r=typeof i=="object"?i.mutate:i;if(!h)throw new Error("geojson is required");var a=Nu(h),l=[];switch(a){case"LineString":l=Ho(h,a);break;case"MultiLineString":case"Polygon":lr(h).forEach(function(m){l.push(Ho(m,a))});break;case"MultiPolygon":lr(h).forEach(function(m){var d=[];m.forEach(function(x){d.push(Ho(x,a))}),l.push(d)});break;case"Point":return h;case"MultiPoint":var g={};lr(h).forEach(function(m){var d=m.join("-");Object.prototype.hasOwnProperty.call(g,d)||(l.push(m),g[d]=!0)});break;default:throw new Error(a+" geometry not supported")}return h.coordinates?r===!0?(h.coordinates=l,h):{type:a,coordinates:l}:r===!0?(h.geometry.coordinates=l,h):gn({type:a,coordinates:l},h.properties,{bbox:h.bbox,id:h.id})}function Ho(h,i){var r=lr(h);if(r.length===2&&!ou(r[0],r[1]))return r;var a=[],l=r.length-1,g=a.length;a.push(r[0]);for(var m=1;m<l;m++){var d=a[a.length-1];r[m][0]===d[0]&&r[m][1]===d[1]||(a.push(r[m]),g=a.length,g>2&&au(a[g-3],a[g-1],a[g-2])&&a.splice(a.length-2,1))}if(a.push(r[r.length-1]),g=a.length,(i==="Polygon"||i==="MultiPolygon")&&ou(r[0],r[r.length-1])&&g<4)throw new Error("invalid polygon");return i==="LineString"&&g<3||au(a[g-3],a[g-1],a[g-2])&&a.splice(a.length-2,1),a}function ou(h,i){return h[0]===i[0]&&h[1]===i[1]}function au(h,i,r){var a=r[0],l=r[1],g=h[0],m=h[1],d=i[0],x=i[1],v=a-g,P=l-m,I=d-g,b=x-m,O=v*b-P*I;return O!==0?!1:Math.abs(I)>=Math.abs(b)?I>0?g<=a&&a<=d:d<=a&&a<=g:b>0?m<=l&&l<=x:x<=l&&l<=m}function oa(h){if(!h)throw new Error("geojson is required");switch(h.type){case"Feature":return nl(h);case"FeatureCollection":return Dc(h);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return aa(h);default:throw new Error("unknown GeoJSON type")}}function nl(h){const i={type:"Feature"};return Object.keys(h).forEach(r=>{switch(r){case"type":case"properties":case"geometry":return;default:i[r]=h[r]}}),i.properties=il(h.properties),h.geometry==null?i.geometry=null:i.geometry=aa(h.geometry),i}function il(h){const i={};return h&&Object.keys(h).forEach(r=>{const a=h[r];typeof a=="object"?a===null?i[r]=null:Array.isArray(a)?i[r]=a.map(l=>l):i[r]=il(a):i[r]=a}),i}function Dc(h){const i={type:"FeatureCollection"};return Object.keys(h).forEach(r=>{switch(r){case"type":case"features":return;default:i[r]=h[r]}}),i.features=h.features.map(r=>nl(r)),i}function aa(h){const i={type:h.type};return h.bbox&&(i.bbox=h.bbox),h.type==="GeometryCollection"?(i.geometries=h.geometries.map(r=>aa(r)),i):(i.coordinates=rl(h.coordinates),i)}function rl(h){const i=h;return typeof i[0]!="object"?i.slice():i.map(r=>rl(r))}function Fc(h,i){var r=h[0]-i[0],a=h[1]-i[1];return r*r+a*a}function Bc(h,i,r){var a=i[0],l=i[1],g=r[0]-a,m=r[1]-l;if(g!==0||m!==0){var d=((h[0]-a)*g+(h[1]-l)*m)/(g*g+m*m);d>1?(a=r[0],l=r[1]):d>0&&(a+=g*d,l+=m*d)}return g=h[0]-a,m=h[1]-l,g*g+m*m}function zc(h,i){for(var r=h[0],a=[r],l,g=1,m=h.length;g<m;g++)l=h[g],Fc(l,r)>i&&(a.push(l),r=l);return r!==l&&a.push(l),a}function ia(h,i,r,a,l){for(var g=a,m,d=i+1;d<r;d++){var x=Bc(h[d],h[i],h[r]);x>g&&(m=d,g=x)}g>a&&(m-i>1&&ia(h,i,m,a,l),l.push(h[m]),r-m>1&&ia(h,m,r,a,l))}function Gc(h,i){var r=h.length-1,a=[h[0]];return ia(h,0,r,i,a),a.push(h[r]),a}function lo(h,i,r){if(h.length<=2)return h;var a=i!==void 0?i*i:1;return h=r?h:zc(h,a),h=Gc(h,a),h}function Hc(h,i={}){var r,a,l;if(i=i??{},!Ql(i))throw new Error("options is invalid");const g=(r=i.tolerance)!=null?r:1,m=(a=i.highQuality)!=null?a:!1,d=(l=i.mutate)!=null?l:!1;if(!h)throw new Error("geojson is required");if(g&&g<0)throw new Error("invalid tolerance");return d!==!0&&(h=oa(h)),oi(h,function(x){qc(x,g,m)}),h}function qc(h,i,r){const a=h.type;if(a==="Point"||a==="MultiPoint")return h;if(na(h,{mutate:!0}),a!=="GeometryCollection")switch(a){case"LineString":h.coordinates=lo(h.coordinates,i,r);break;case"MultiLineString":h.coordinates=h.coordinates.map(l=>lo(l,i,r));break;case"Polygon":h.coordinates=uu(h.coordinates,i,r);break;case"MultiPolygon":h.coordinates=h.coordinates.map(l=>uu(l,i,r))}return h}function uu(h,i,r){return h.map(function(a){if(a.length<4)throw new Error("invalid polygon");let l=i,g=lo(a,l,r);for(;!Zc(g);)l-=l*.01,g=lo(a,l,r);return(g[g.length-1][0]!==g[0][0]||g[g.length-1][1]!==g[0][1])&&g.push(g[0]),g})}function Zc(h){return h.length<3?!1:!(h.length===3&&h[2][0]===h[0][0]&&h[2][1]===h[0][1])}var Kr=Hc;function Uc(h){let i,r;const a={type:"FeatureCollection",features:[]};if(h.type==="Feature"?r=h.geometry:r=h,r.type==="LineString")i=[r.coordinates];else if(r.type==="MultiLineString")i=r.coordinates;else if(r.type==="MultiPolygon")i=[].concat(...r.coordinates);else if(r.type==="Polygon")i=r.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return i.forEach(l=>{i.forEach(g=>{for(let m=0;m<l.length-1;m++)for(let d=m;d<g.length-1;d++){if(l===g&&(Math.abs(m-d)===1||m===0&&d===l.length-2&&l[m][0]===l[l.length-1][0]&&l[m][1]===l[l.length-1][1]))continue;const x=Yc(l[m][0],l[m][1],l[m+1][0],l[m+1][1],g[d][0],g[d][1],g[d+1][0],g[d+1][1]);x&&a.features.push(zn([x[0],x[1]]))}})}),a}function Yc(h,i,r,a,l,g,m,d){let x,v,P,I,b;const O={x:null,y:null,onLine1:!1,onLine2:!1};return x=(d-g)*(r-h)-(m-l)*(a-i),x===0?O.x!==null&&O.y!==null?O:!1:(v=i-g,P=h-l,I=(m-l)*v-(d-g)*P,b=(r-h)*v-(a-i)*P,v=I/x,P=b/x,O.x=h+v*(r-h),O.y=i+v*(a-i),v>=0&&v<=1&&(O.onLine1=!0),P>=0&&P<=1&&(O.onLine2=!0),O.onLine1&&O.onLine2?[O.x,O.y]:!1)}var lu=Uc;function Xc(h,i,r,a,l){sl(h,i,r||0,a||h.length-1,l||Vc)}function sl(h,i,r,a,l){for(;a>r;){if(a-r>600){var g=a-r+1,m=i-r+1,d=Math.log(g),x=.5*Math.exp(2*d/3),v=.5*Math.sqrt(d*x*(g-x)/g)*(m-g/2<0?-1:1),P=Math.max(r,Math.floor(i-m*x/g+v)),I=Math.min(a,Math.floor(i+(g-m)*x/g+v));sl(h,i,P,I,l)}var b=h[i],O=r,R=a;for(Jr(h,r,i),l(h[a],b)>0&&Jr(h,r,a);O<R;){for(Jr(h,O,R),O++,R--;l(h[O],b)<0;)O++;for(;l(h[R],b)>0;)R--}l(h[r],b)===0?Jr(h,r,R):(R++,Jr(h,R,a)),R<=i&&(r=R+1),i<=R&&(a=R-1)}}function Jr(h,i,r){var a=h[i];h[i]=h[r],h[r]=a}function Vc(h,i){return h<i?-1:h>i?1:0}class ol{constructor(i=9){this._maxEntries=Math.max(4,i),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(i){let r=this.data;const a=[];if(!Xs(i,r))return a;const l=this.toBBox,g=[];for(;r;){for(let m=0;m<r.children.length;m++){const d=r.children[m],x=r.leaf?l(d):d;Xs(i,x)&&(r.leaf?a.push(d):Zo(i,x)?this._all(d,a):g.push(d))}r=g.pop()}return a}collides(i){let r=this.data;if(!Xs(i,r))return!1;const a=[];for(;r;){for(let l=0;l<r.children.length;l++){const g=r.children[l],m=r.leaf?this.toBBox(g):g;if(Xs(i,m)){if(r.leaf||Zo(i,m))return!0;a.push(g)}}r=a.pop()}return!1}load(i){if(!(i&&i.length))return this;if(i.length<this._minEntries){for(let a=0;a<i.length;a++)this.insert(i[a]);return this}let r=this._build(i.slice(),0,i.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){const a=this.data;this.data=r,r=a}this._insert(r,this.data.height-r.height-1,!0)}return this}insert(i){return i&&this._insert(i,this.data.height-1),this}clear(){return this.data=or([]),this}remove(i,r){if(!i)return this;let a=this.data;const l=this.toBBox(i),g=[],m=[];let d,x,v;for(;a||g.length;){if(a||(a=g.pop(),x=g[g.length-1],d=m.pop(),v=!0),a.leaf){const P=Wc(i,a.children,r);if(P!==-1)return a.children.splice(P,1),g.push(a),this._condense(g),this}!v&&!a.leaf&&Zo(a,l)?(g.push(a),m.push(d),d=0,x=a,a=a.children[0]):x?(d++,a=x.children[d],v=!1):a=null}return this}toBBox(i){return i}compareMinX(i,r){return i.minX-r.minX}compareMinY(i,r){return i.minY-r.minY}toJSON(){return this.data}fromJSON(i){return this.data=i,this}_all(i,r){const a=[];for(;i;)i.leaf?r.push(...i.children):a.push(...i.children),i=a.pop();return r}_build(i,r,a,l){const g=a-r+1;let m=this._maxEntries,d;if(g<=m)return d=or(i.slice(r,a+1)),rr(d,this.toBBox),d;l||(l=Math.ceil(Math.log(g)/Math.log(m)),m=Math.ceil(g/Math.pow(m,l-1))),d=or([]),d.leaf=!1,d.height=l;const x=Math.ceil(g/m),v=x*Math.ceil(Math.sqrt(m));hu(i,r,a,v,this.compareMinX);for(let P=r;P<=a;P+=v){const I=Math.min(P+v-1,a);hu(i,P,I,x,this.compareMinY);for(let b=P;b<=I;b+=x){const O=Math.min(b+x-1,I);d.children.push(this._build(i,b,O,l-1))}}return rr(d,this.toBBox),d}_chooseSubtree(i,r,a,l){for(;l.push(r),!(r.leaf||l.length-1===a);){let g=1/0,m=1/0,d;for(let x=0;x<r.children.length;x++){const v=r.children[x],P=qo(v),I=$c(i,v)-P;I<m?(m=I,g=P<g?P:g,d=v):I===m&&P<g&&(g=P,d=v)}r=d||r.children[0]}return r}_insert(i,r,a){const l=a?i:this.toBBox(i),g=[],m=this._chooseSubtree(l,this.data,r,g);for(m.children.push(i),rs(m,l);r>=0&&g[r].children.length>this._maxEntries;)this._split(g,r),r--;this._adjustParentBBoxes(l,g,r)}_split(i,r){const a=i[r],l=a.children.length,g=this._minEntries;this._chooseSplitAxis(a,g,l);const m=this._chooseSplitIndex(a,g,l),d=or(a.children.splice(m,a.children.length-m));d.height=a.height,d.leaf=a.leaf,rr(a,this.toBBox),rr(d,this.toBBox),r?i[r-1].children.push(d):this._splitRoot(a,d)}_splitRoot(i,r){this.data=or([i,r]),this.data.height=i.height+1,this.data.leaf=!1,rr(this.data,this.toBBox)}_chooseSplitIndex(i,r,a){let l,g=1/0,m=1/0;for(let d=r;d<=a-r;d++){const x=is(i,0,d,this.toBBox),v=is(i,d,a,this.toBBox),P=jc(x,v),I=qo(x)+qo(v);P<g?(g=P,l=d,m=I<m?I:m):P===g&&I<m&&(m=I,l=d)}return l||a-r}_chooseSplitAxis(i,r,a){const l=i.leaf?this.compareMinX:Kc,g=i.leaf?this.compareMinY:Jc,m=this._allDistMargin(i,r,a,l),d=this._allDistMargin(i,r,a,g);m<d&&i.children.sort(l)}_allDistMargin(i,r,a,l){i.children.sort(l);const g=this.toBBox,m=is(i,0,r,g),d=is(i,a-r,a,g);let x=Ys(m)+Ys(d);for(let v=r;v<a-r;v++){const P=i.children[v];rs(m,i.leaf?g(P):P),x+=Ys(m)}for(let v=a-r-1;v>=r;v--){const P=i.children[v];rs(d,i.leaf?g(P):P),x+=Ys(d)}return x}_adjustParentBBoxes(i,r,a){for(let l=a;l>=0;l--)rs(r[l],i)}_condense(i){for(let r=i.length-1,a;r>=0;r--)i[r].children.length===0?r>0?(a=i[r-1].children,a.splice(a.indexOf(i[r]),1)):this.clear():rr(i[r],this.toBBox)}}function Wc(h,i,r){if(!r)return i.indexOf(h);for(let a=0;a<i.length;a++)if(r(h,i[a]))return a;return-1}function rr(h,i){is(h,0,h.children.length,i,h)}function is(h,i,r,a,l){l||(l=or(null)),l.minX=1/0,l.minY=1/0,l.maxX=-1/0,l.maxY=-1/0;for(let g=i;g<r;g++){const m=h.children[g];rs(l,h.leaf?a(m):m)}return l}function rs(h,i){return h.minX=Math.min(h.minX,i.minX),h.minY=Math.min(h.minY,i.minY),h.maxX=Math.max(h.maxX,i.maxX),h.maxY=Math.max(h.maxY,i.maxY),h}function Kc(h,i){return h.minX-i.minX}function Jc(h,i){return h.minY-i.minY}function qo(h){return(h.maxX-h.minX)*(h.maxY-h.minY)}function Ys(h){return h.maxX-h.minX+(h.maxY-h.minY)}function $c(h,i){return(Math.max(i.maxX,h.maxX)-Math.min(i.minX,h.minX))*(Math.max(i.maxY,h.maxY)-Math.min(i.minY,h.minY))}function jc(h,i){const r=Math.max(h.minX,i.minX),a=Math.max(h.minY,i.minY),l=Math.min(h.maxX,i.maxX),g=Math.min(h.maxY,i.maxY);return Math.max(0,l-r)*Math.max(0,g-a)}function Zo(h,i){return h.minX<=i.minX&&h.minY<=i.minY&&i.maxX<=h.maxX&&i.maxY<=h.maxY}function Xs(h,i){return i.minX<=h.maxX&&i.minY<=h.maxY&&i.maxX>=h.minX&&i.maxY>=h.minY}function or(h){return{children:h,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function hu(h,i,r,a,l){const g=[i,r];for(;g.length;){if(r=g.pop(),i=g.pop(),r-i<=a)continue;const m=i+Math.ceil((r-i)/a/2)*a;Xc(h,m,i,r,l),g.push(i,m,m,r)}}function Qc(h){return th(h,(i,r)=>i+tf(r),0)}function tf(h){let i=0,r;switch(h.type){case"Polygon":return cu(h.coordinates);case"MultiPolygon":for(r=0;r<h.coordinates.length;r++)i+=cu(h.coordinates[r]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function cu(h){let i=0;if(h&&h.length>0){i+=Math.abs(fu(h[0]));for(let r=1;r<h.length;r++)i-=Math.abs(fu(h[r]))}return i}var ef=Se*Se/2,Uo=Math.PI/180;function fu(h){const i=h.length-1;if(i<=2)return 0;let r=0,a=0;for(;a<i;){const l=h[a],g=h[a+1===i?0:a+1],m=h[a+2>=i?(a+2)%i:a+2],d=l[0]*Uo,x=g[1]*Uo,v=m[0]*Uo;r+=(v-d)*Math.sin(x),a++}return r*ef}const Hn=11102230246251565e-32,Le=134217729,nf=(3+8*Hn)*Hn;function Yo(h,i,r,a,l){let g,m,d,x,v=i[0],P=a[0],I=0,b=0;P>v==P>-v?(g=v,v=i[++I]):(g=P,P=a[++b]);let O=0;if(I<h&&b<r)for(P>v==P>-v?(m=v+g,d=g-(m-v),v=i[++I]):(m=P+g,d=g-(m-P),P=a[++b]),g=m,d!==0&&(l[O++]=d);I<h&&b<r;)P>v==P>-v?(m=g+v,x=m-g,d=g-(m-x)+(v-x),v=i[++I]):(m=g+P,x=m-g,d=g-(m-x)+(P-x),P=a[++b]),g=m,d!==0&&(l[O++]=d);for(;I<h;)m=g+v,x=m-g,d=g-(m-x)+(v-x),v=i[++I],g=m,d!==0&&(l[O++]=d);for(;b<r;)m=g+P,x=m-g,d=g-(m-x)+(P-x),P=a[++b],g=m,d!==0&&(l[O++]=d);return(g!==0||O===0)&&(l[O++]=g),O}function rf(h,i){let r=i[0];for(let a=1;a<h;a++)r+=i[a];return r}function cs(h){return new Float64Array(h)}const sf=(3+16*Hn)*Hn,of=(2+12*Hn)*Hn,af=(9+64*Hn)*Hn*Hn,sr=cs(4),gu=cs(8),du=cs(12),mu=cs(16),Ae=cs(4);function uf(h,i,r,a,l,g,m){let d,x,v,P,I,b,O,R,W,j,st,M,q,A,F,H,K,E;const S=h-l,N=r-l,B=i-g,D=a-g;A=S*D,b=Le*S,O=b-(b-S),R=S-O,b=Le*D,W=b-(b-D),j=D-W,F=R*j-(A-O*W-R*W-O*j),H=B*N,b=Le*B,O=b-(b-B),R=B-O,b=Le*N,W=b-(b-N),j=N-W,K=R*j-(H-O*W-R*W-O*j),st=F-K,I=F-st,sr[0]=F-(st+I)+(I-K),M=A+st,I=M-A,q=A-(M-I)+(st-I),st=q-H,I=q-st,sr[1]=q-(st+I)+(I-H),E=M+st,I=E-M,sr[2]=M-(E-I)+(st-I),sr[3]=E;let V=rf(4,sr),Z=of*m;if(V>=Z||-V>=Z||(I=h-S,d=h-(S+I)+(I-l),I=r-N,v=r-(N+I)+(I-l),I=i-B,x=i-(B+I)+(I-g),I=a-D,P=a-(D+I)+(I-g),d===0&&x===0&&v===0&&P===0)||(Z=af*m+nf*Math.abs(V),V+=S*P+D*d-(B*v+N*x),V>=Z||-V>=Z))return V;A=d*D,b=Le*d,O=b-(b-d),R=d-O,b=Le*D,W=b-(b-D),j=D-W,F=R*j-(A-O*W-R*W-O*j),H=x*N,b=Le*x,O=b-(b-x),R=x-O,b=Le*N,W=b-(b-N),j=N-W,K=R*j-(H-O*W-R*W-O*j),st=F-K,I=F-st,Ae[0]=F-(st+I)+(I-K),M=A+st,I=M-A,q=A-(M-I)+(st-I),st=q-H,I=q-st,Ae[1]=q-(st+I)+(I-H),E=M+st,I=E-M,Ae[2]=M-(E-I)+(st-I),Ae[3]=E;const U=Yo(4,sr,4,Ae,gu);A=S*P,b=Le*S,O=b-(b-S),R=S-O,b=Le*P,W=b-(b-P),j=P-W,F=R*j-(A-O*W-R*W-O*j),H=B*v,b=Le*B,O=b-(b-B),R=B-O,b=Le*v,W=b-(b-v),j=v-W,K=R*j-(H-O*W-R*W-O*j),st=F-K,I=F-st,Ae[0]=F-(st+I)+(I-K),M=A+st,I=M-A,q=A-(M-I)+(st-I),st=q-H,I=q-st,Ae[1]=q-(st+I)+(I-H),E=M+st,I=E-M,Ae[2]=M-(E-I)+(st-I),Ae[3]=E;const G=Yo(U,gu,4,Ae,du);A=d*P,b=Le*d,O=b-(b-d),R=d-O,b=Le*P,W=b-(b-P),j=P-W,F=R*j-(A-O*W-R*W-O*j),H=x*v,b=Le*x,O=b-(b-x),R=x-O,b=Le*v,W=b-(b-v),j=v-W,K=R*j-(H-O*W-R*W-O*j),st=F-K,I=F-st,Ae[0]=F-(st+I)+(I-K),M=A+st,I=M-A,q=A-(M-I)+(st-I),st=q-H,I=q-st,Ae[1]=q-(st+I)+(I-H),E=M+st,I=E-M,Ae[2]=M-(E-I)+(st-I),Ae[3]=E;const Q=Yo(G,du,4,Ae,mu);return mu[Q-1]}function lf(h,i,r,a,l,g){const m=(i-g)*(r-l),d=(h-l)*(a-g),x=m-d,v=Math.abs(m+d);return Math.abs(x)>=sf*v?x:-uf(h,i,r,a,l,g,v)}function hf(h,i){var r,a,l=0,g,m,d,x,v,P,I,b=h[0],O=h[1],R=i.length;for(r=0;r<R;r++){a=0;var W=i[r],j=W.length-1;if(P=W[0],P[0]!==W[j][0]&&P[1]!==W[j][1])throw new Error("First and last coordinates in a ring must be the same");for(m=P[0]-b,d=P[1]-O,a;a<j;a++){if(I=W[a+1],x=I[0]-b,v=I[1]-O,d===0&&v===0){if(x<=0&&m>=0||m<=0&&x>=0)return 0}else if(v>=0&&d<=0||v<=0&&d>=0){if(g=lf(m,x,d,v,0,0),g===0)return 0;(g>0&&v>0&&d<=0||g<0&&v<=0&&d>0)&&l++}P=I,d=v,m=x}}return l%2!==0}function qn(h,i,r={}){if(!h)throw new Error("point is required");if(!i)throw new Error("polygon is required");const a=us(h),l=Ln(i),g=l.type,m=i.bbox;let d=l.coordinates;if(m&&cf(a,m)===!1)return!1;g==="Polygon"&&(d=[d]);let x=!1;for(var v=0;v<d.length;++v){const P=hf(a,d[v]);if(P===0)return!r.ignoreBoundary;P&&(x=!0)}return x}function cf(h,i){return i[0]<=h[0]&&i[1]<=h[1]&&i[2]>=h[0]&&i[3]>=h[1]}var Bn=qn;function ff(h,i,r){if(h.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");r===void 0&&(r=1);var a=h.geometry.coordinates,l=[],g={};if(r){for(var m=[],d=0;d<a.length;d++)for(var x=0;x<a[d].length-1;x++)m.push(j(d,x));var v=new ol;v.load(m)}for(var P=0;P<a.length;P++)for(var I=0;I<a[P].length-1;I++)if(r){var b=v.search(j(P,I));b.forEach(function(st){var M=st.ring,q=st.edge;W(P,I,M,q)})}else for(var O=0;O<a.length;O++)for(var R=0;R<a[O].length-1;R++)W(P,I,O,R);return i||(l={type:"Feature",geometry:{type:"MultiPoint",coordinates:l}}),l;function W(st,M,q,A){var F=a[st][M],H=a[st][M+1],K=a[q][A],E=a[q][A+1],S=gf(F,H,K,E);if(S!==null){var N,B;if(H[0]!==F[0]?N=(S[0]-F[0])/(H[0]-F[0]):N=(S[1]-F[1])/(H[1]-F[1]),E[0]!==K[0]?B=(S[0]-K[0])/(E[0]-K[0]):B=(S[1]-K[1])/(E[1]-K[1]),!(N>=1||N<=0||B>=1||B<=0)){var D=S,V=!g[D];V&&(g[D]=!0),i?l.push(i(S,st,M,F,H,N,q,A,K,E,B,V)):l.push(S)}}}function j(st,M){var q=a[st][M],A=a[st][M+1],F,H,K,E;return q[0]<A[0]?(F=q[0],H=A[0]):(F=A[0],H=q[0]),q[1]<A[1]?(K=q[1],E=A[1]):(K=A[1],E=q[1]),{minX:F,minY:K,maxX:H,maxY:E,ring:st,edge:M}}}function gf(h,i,r,a){if(ss(h,r)||ss(h,a)||ss(i,r)||ss(a,r))return null;var l=h[0],g=h[1],m=i[0],d=i[1],x=r[0],v=r[1],P=a[0],I=a[1],b=(l-m)*(v-I)-(g-d)*(x-P);if(b===0)return null;var O=((l*d-g*m)*(x-P)-(l-m)*(x*I-v*P))/b,R=((l*d-g*m)*(v-I)-(g-d)*(x*I-v*P))/b;return[O,R]}function ss(h,i){if(!h||!i||h.length!==i.length)return!1;for(var r=0,a=h.length;r<a;r++)if(h[r]instanceof Array&&i[r]instanceof Array){if(!ss(h[r],i[r]))return!1}else if(h[r]!==i[r])return!1;return!0}function df(h){if(h.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(h.geometry===void 0||h.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(h.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var i=h.geometry.coordinates.length,r=[],M=0;M<i;M++){var a=h.geometry.coordinates[M];os(a[0],a[a.length-1])||a.push(a[0]);for(var l=0;l<a.length-1;l++)r.push(a[l])}if(!pf(r))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var g=r.length,m=ff(h,function(ht,ft,gt,kt,et,Vt,Ct,vt,Y,At,Gt,Lt){return[ht,ft,gt,kt,et,Vt,Ct,vt,Y,At,Gt,Lt]}),d=m.length;if(d==0){for(var K=[],M=0;M<i;M++)K.push(Zn([h.geometry.coordinates[M]],{parent:-1,winding:mf(h.geometry.coordinates[M])}));var nt=In(K);return J(),ot(),nt}for(var x=[],v=[],M=0;M<i;M++){x.push([]);for(var l=0;l<h.geometry.coordinates[M].length-1;l++)x[M].push([new pu(h.geometry.coordinates[M][ur(l+1,h.geometry.coordinates[M].length-1)],1,[M,l],[M,ur(l+1,h.geometry.coordinates[M].length-1)],void 0)]),v.push(new yu(h.geometry.coordinates[M][l],[M,ur(l-1,h.geometry.coordinates[M].length-1)],[M,l],void 0,void 0,!1,!0))}for(var M=0;M<d;M++)x[m[M][1]][m[M][2]].push(new pu(m[M][0],m[M][5],[m[M][1],m[M][2]],[m[M][6],m[M][7]],void 0)),m[M][11]&&v.push(new yu(m[M][0],[m[M][1],m[M][2]],[m[M][6],m[M][7]],void 0,void 0,!0,!0));for(var P=v.length,M=0;M<x.length;M++)for(var l=0;l<x[M].length;l++)x[M][l].sort(function(ft,gt){return ft.param<gt.param?-1:1});for(var I=[],M=0;M<P;M++)I.push({minX:v[M].coord[0],minY:v[M].coord[1],maxX:v[M].coord[0],maxY:v[M].coord[1],index:M});var b=new ol;b.load(I);for(var M=0;M<x.length;M++)for(var l=0;l<x[M].length;l++)for(var O=0;O<x[M][l].length;O++){var R;O==x[M][l].length-1?R=x[M][ur(l+1,h.geometry.coordinates[M].length-1)][0].coord:R=x[M][l][O+1].coord;var W=b.search({minX:R[0],minY:R[1],maxX:R[0],maxY:R[1]})[0];x[M][l][O].nxtIsectAlongEdgeIn=W.index}for(var M=0;M<x.length;M++)for(var l=0;l<x[M].length;l++)for(var O=0;O<x[M][l].length;O++){var R=x[M][l][O].coord,W=b.search({minX:R[0],minY:R[1],maxX:R[0],maxY:R[1]})[0],j=W.index;j<g?v[j].nxtIsectAlongRingAndEdge2=x[M][l][O].nxtIsectAlongEdgeIn:os(v[j].ringAndEdge1,x[M][l][O].ringAndEdgeIn)?v[j].nxtIsectAlongRingAndEdge1=x[M][l][O].nxtIsectAlongEdgeIn:v[j].nxtIsectAlongRingAndEdge2=x[M][l][O].nxtIsectAlongEdgeIn}for(var st=[],M=0,l=0;l<i;l++){for(var q=M,O=0;O<h.geometry.coordinates[l].length-1;O++)v[M].coord[0]<v[q].coord[0]&&(q=M),M++;for(var A=v[q].nxtIsectAlongRingAndEdge2,O=0;O<v.length;O++)if(v[O].nxtIsectAlongRingAndEdge1==q||v[O].nxtIsectAlongRingAndEdge2==q){var F=O;break}var H=to([v[F].coord,v[q].coord,v[A].coord],!0)?1:-1;st.push({isect:q,parent:-1,winding:H})}st.sort(function(pt,ht){return v[pt.isect].coord>v[ht.isect].coord?-1:1});for(var K=[];st.length>0;){var E=st.pop(),S=E.isect,N=E.parent,B=E.winding,D=K.length,V=[v[S].coord],Z=S;if(v[S].ringAndEdge1Walkable)var U=v[S].ringAndEdge1,G=v[S].nxtIsectAlongRingAndEdge1;else var U=v[S].ringAndEdge2,G=v[S].nxtIsectAlongRingAndEdge2;for(;!os(v[S].coord,v[G].coord);){V.push(v[G].coord);for(var Q=void 0,M=0;M<st.length;M++)if(st[M].isect==G){Q=M;break}if(Q!=null&&st.splice(Q,1),os(U,v[G].ringAndEdge1)){if(U=v[G].ringAndEdge2,v[G].ringAndEdge2Walkable=!1,v[G].ringAndEdge1Walkable){var X={isect:G};to([v[Z].coord,v[G].coord,v[v[G].nxtIsectAlongRingAndEdge2].coord],B==1)?(X.parent=N,X.winding=-B):(X.parent=D,X.winding=B),st.push(X)}Z=G,G=v[G].nxtIsectAlongRingAndEdge2}else{if(U=v[G].ringAndEdge1,v[G].ringAndEdge1Walkable=!1,v[G].ringAndEdge2Walkable){var X={isect:G};to([v[Z].coord,v[G].coord,v[v[G].nxtIsectAlongRingAndEdge1].coord],B==1)?(X.parent=N,X.winding=-B):(X.parent=D,X.winding=B),st.push(X)}Z=G,G=v[G].nxtIsectAlongRingAndEdge1}}V.push(v[G].coord),K.push(Zn([V],{index:D,parent:N,winding:B,netWinding:void 0}))}var nt=In(K);J(),ot();function J(){for(var pt=[],ht=0;ht<nt.features.length;ht++)nt.features[ht].properties.parent==-1&&pt.push(ht);if(pt.length>1)for(var ht=0;ht<pt.length;ht++){for(var ft=-1,gt=1/0,kt=0;kt<nt.features.length;kt++)pt[ht]!=kt&&qn(nt.features[pt[ht]].geometry.coordinates[0][0],nt.features[kt],{ignoreBoundary:!0})&&Qc(nt.features[kt])<gt&&(ft=kt);nt.features[pt[ht]].properties.parent=ft}}function ot(){for(var pt=0;pt<nt.features.length;pt++)if(nt.features[pt].properties.parent==-1){var ht=nt.features[pt].properties.winding;nt.features[pt].properties.netWinding=ht,ct(pt,ht)}}function ct(pt,ht){for(var ft=0;ft<nt.features.length;ft++)if(nt.features[ft].properties.parent==pt){var gt=ht+nt.features[ft].properties.winding;nt.features[ft].properties.netWinding=gt,ct(ft,gt)}}return nt}var pu=function(h,i,r,a,l){this.coord=h,this.param=i,this.ringAndEdgeIn=r,this.ringAndEdgeOut=a,this.nxtIsectAlongEdgeIn=l},yu=function(h,i,r,a,l,g,m){this.coord=h,this.ringAndEdge1=i,this.ringAndEdge2=r,this.nxtIsectAlongRingAndEdge1=a,this.nxtIsectAlongRingAndEdge2=l,this.ringAndEdge1Walkable=g,this.ringAndEdge2Walkable=m};function to(h,i){if(typeof i>"u"&&(i=!0),h.length!=3)throw new Error("This function requires an array of three points [x,y]");var r=(h[1][0]-h[0][0])*(h[2][1]-h[0][1])-(h[1][1]-h[0][1])*(h[2][0]-h[0][0]);return r>=0==i}function mf(h){for(var i=0,r=0;r<h.length-1;r++)h[r][0]<h[i][0]&&(i=r);if(to([h[ur(i-1,h.length-1)],h[i],h[ur(i+1,h.length-1)]],!0))var a=1;else var a=-1;return a}function os(h,i){if(!h||!i||h.length!=i.length)return!1;for(var r=0,a=h.length;r<a;r++)if(h[r]instanceof Array&&i[r]instanceof Array){if(!os(h[r],i[r]))return!1}else if(h[r]!=i[r])return!1;return!0}function ur(h,i){return(h%i+i)%i}function pf(h){for(var i={},r=1,a=0,l=h.length;a<l;++a){if(Object.prototype.hasOwnProperty.call(i,h[a])){r=0;break}i[h[a]]=1}return r}function yf(h){var i=[];return Su(h,function(r){r.geometry.type==="Polygon"&&si(df(r),function(a){i.push(Zn(a.geometry.coordinates,r.properties))})}),In(i)}var Xo=yf;function ho(h,i,r={}){const a=us(h),l=lr(i);for(let g=0;g<l.length-1;g++){let m=!1;if(r.ignoreEndVertices&&(g===0&&(m="start"),g===l.length-2&&(m="end"),g===0&&g+1===l.length-1&&(m="both")),vf(l[g],l[g+1],a,m,typeof r.epsilon>"u"?null:r.epsilon))return!0}return!1}function vf(h,i,r,a,l){const g=r[0],m=r[1],d=h[0],x=h[1],v=i[0],P=i[1],I=r[0]-d,b=r[1]-x,O=v-d,R=P-x,W=I*R-b*O;if(l!==null){if(Math.abs(W)>l)return!1}else if(W!==0)return!1;if(Math.abs(O)===Math.abs(R)&&Math.abs(O)===0)return a?!1:r[0]===h[0]&&r[1]===h[1];if(a){if(a==="start")return Math.abs(O)>=Math.abs(R)?O>0?d<g&&g<=v:v<=g&&g<d:R>0?x<m&&m<=P:P<=m&&m<x;if(a==="end")return Math.abs(O)>=Math.abs(R)?O>0?d<=g&&g<v:v<g&&g<=d:R>0?x<=m&&m<P:P<m&&m<=x;if(a==="both")return Math.abs(O)>=Math.abs(R)?O>0?d<g&&g<v:v<g&&g<d:R>0?x<m&&m<P:P<m&&m<x}else return Math.abs(O)>=Math.abs(R)?O>0?d<=g&&g<=v:v<=g&&g<=d:R>0?x<=m&&m<=P:P<=m&&m<=x;return!1}function _f(h,i){var r=Ln(h),a=Ln(i),l=r.type,g=a.type;switch(l){case"Point":switch(g){case"MultiPoint":return xf(r,a);case"LineString":return ho(r,a,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return qn(r,a,{ignoreBoundary:!0});default:throw new Error("feature2 "+g+" geometry not supported")}case"MultiPoint":switch(g){case"MultiPoint":return kf(r,a);case"LineString":return wf(r,a);case"Polygon":case"MultiPolygon":return Ef(r,a);default:throw new Error("feature2 "+g+" geometry not supported")}case"LineString":switch(g){case"LineString":return Pf(r,a);case"Polygon":case"MultiPolygon":return Mf(r,a);default:throw new Error("feature2 "+g+" geometry not supported")}case"Polygon":switch(g){case"Polygon":case"MultiPolygon":return If(r,a);default:throw new Error("feature2 "+g+" geometry not supported")}default:throw new Error("feature1 "+l+" geometry not supported")}}function xf(h,i){var r,a=!1;for(r=0;r<i.coordinates.length;r++)if(ul(i.coordinates[r],h.coordinates)){a=!0;break}return a}function kf(h,i){for(var r=0;r<h.coordinates.length;r++){for(var a=!1,l=0;l<i.coordinates.length;l++)ul(h.coordinates[r],i.coordinates[l])&&(a=!0);if(!a)return!1}return!0}function wf(h,i){for(var r=!1,a=0;a<h.coordinates.length;a++){if(!ho(h.coordinates[a],i))return!1;r||(r=ho(h.coordinates[a],i,{ignoreEndVertices:!0}))}return r}function Ef(h,i){for(var r=!0,a=!1,l=0;l<h.coordinates.length;l++){if(a=qn(h.coordinates[l],i),!a){r=!1;break}a=qn(h.coordinates[l],i,{ignoreBoundary:!0})}return r&&a}function Pf(h,i){for(var r=0;r<h.coordinates.length;r++)if(!ho(h.coordinates[r],i))return!1;return!0}function Mf(h,i){var r=hr(i),a=hr(h);if(!al(r,a))return!1;for(var l=!1,g=0;g<h.coordinates.length;g++){if(!qn(h.coordinates[g],i))return!1;if(l||(l=qn(h.coordinates[g],i,{ignoreBoundary:!0})),!l&&g<h.coordinates.length-1){var m=Lf(h.coordinates[g],h.coordinates[g+1]);l=qn(m,i,{ignoreBoundary:!0})}}return l}function If(h,i){var r=hr(h),a=hr(i);if(!al(a,r))return!1;for(var l=0;l<h.coordinates[0].length;l++)if(!qn(h.coordinates[0][l],i))return!1;return!0}function al(h,i){return!(h[0]>i[0]||h[2]<i[2]||h[1]>i[1]||h[3]<i[3])}function ul(h,i){return h[0]===i[0]&&h[1]===i[1]}function Lf(h,i){return[(h[0]+i[0])/2,(h[1]+i[1])/2]}var vu=_f,Sf=Object.defineProperty,mr=(h,i)=>Sf(h,"name",{value:i,configurable:!0}),ll=class{constructor(i){this.direction=!1,this.compareProperties=!0;var r,a,l;this.precision=10**-((r=i==null?void 0:i.precision)!=null?r:17),this.direction=(a=i==null?void 0:i.direction)!=null?a:!1,this.compareProperties=(l=i==null?void 0:i.compareProperties)!=null?l:!0}compare(i,r){if(i.type!==r.type||!as(i,r))return!1;switch(i.type){case"Point":return this.compareCoord(i.coordinates,r.coordinates);case"LineString":return this.compareLine(i.coordinates,r.coordinates);case"Polygon":return this.comparePolygon(i,r);case"GeometryCollection":return this.compareGeometryCollection(i,r);case"Feature":return this.compareFeature(i,r);case"FeatureCollection":return this.compareFeatureCollection(i,r);default:if(i.type.startsWith("Multi")){const a=ra(i),l=ra(r);return a.every(g=>l.some(m=>this.compare(g,m)))}}return!1}compareCoord(i,r){return i.length===r.length&&i.every((a,l)=>Math.abs(a-r[l])<this.precision)}compareLine(i,r,a=0,l=!1){if(!as(i,r))return!1;const g=i;let m=r;if(l&&!this.compareCoord(g[0],m[0])){const x=this.fixStartIndex(m,g);if(x)m=x;else return!1}const d=this.compareCoord(g[a],m[a]);return this.direction||d?this.comparePath(g,m):this.compareCoord(g[a],m[m.length-(1+a)])?this.comparePath(g.slice().reverse(),m):!1}fixStartIndex(i,r){let a,l=-1;for(let g=0;g<i.length;g++)if(this.compareCoord(i[g],r[0])){l=g;break}return l>=0&&(a=[].concat(i.slice(l,i.length),i.slice(1,l+1))),a}comparePath(i,r){return i.every((a,l)=>this.compareCoord(a,r[l]))}comparePolygon(i,r){if(this.compareLine(i.coordinates[0],r.coordinates[0],1,!0)){const a=i.coordinates.slice(1,i.coordinates.length),l=r.coordinates.slice(1,r.coordinates.length);return a.every(g=>l.some(m=>this.compareLine(g,m,1,!0)))}return!1}compareGeometryCollection(i,r){return as(i.geometries,r.geometries)&&this.compareBBox(i,r)&&i.geometries.every((a,l)=>this.compare(a,r.geometries[l]))}compareFeature(i,r){return i.id===r.id&&(this.compareProperties?ua(i.properties,r.properties):!0)&&this.compareBBox(i,r)&&this.compare(i.geometry,r.geometry)}compareFeatureCollection(i,r){return as(i.features,r.features)&&this.compareBBox(i,r)&&i.features.every((a,l)=>this.compare(a,r.features[l]))}compareBBox(i,r){return!i.bbox&&!r.bbox||(i.bbox&&r.bbox?this.compareCoord(i.bbox,r.bbox):!1)}};mr(ll,"GeojsonEquality");var Cf=ll;function as(h,i){return h.coordinates?h.coordinates.length===i.coordinates.length:h.length===i.length}mr(as,"sameLength");function ra(h){return h.coordinates.map(i=>({type:h.type.replace("Multi",""),coordinates:i}))}mr(ra,"explode");function hl(h,i,r){return new Cf(r).compare(h,i)}mr(hl,"geojsonEquality");function ua(h,i){if(h===null&&i===null)return!0;if(h===null||i===null)return!1;const r=Object.keys(h),a=Object.keys(i);if(r.length!==a.length)return!1;for(var l of r){const g=h[l],m=i[l],d=_u(g)&&_u(m);if(d&&!ua(g,m)||!d&&g!==m)return!1}return!0}mr(ua,"equal");var _u=mr(h=>h!=null&&typeof h=="object","isObject");function bf(h,i,r={}){let a=r.precision;if(a=a==null||isNaN(a)?6:a,typeof a!="number"||!(a>=0))throw new Error("precision must be a positive number");const l=Ln(h).type,g=Ln(i).type;return l!==g?!1:hl(na(h),na(i),{precision:a})}var Tf=bf;function cl(h,i,r={}){var a=us(h),l=us(i),g=Os(l[1]-a[1]),m=Os(l[0]-a[0]),d=Os(a[1]),x=Os(l[1]),v=Math.pow(Math.sin(g/2),2)+Math.pow(Math.sin(m/2),2)*Math.cos(d)*Math.cos(x);return Lu(2*Math.atan2(Math.sqrt(v),Math.sqrt(1-v)),r.units)}var Nf=Object.defineProperty,Of=Object.defineProperties,Af=Object.getOwnPropertyDescriptors,xu=Object.getOwnPropertySymbols,Rf=Object.prototype.hasOwnProperty,Df=Object.prototype.propertyIsEnumerable,ku=(h,i,r)=>i in h?Nf(h,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[i]=r,wu=(h,i)=>{for(var r in i||(i={}))Rf.call(i,r)&&ku(h,r,i[r]);if(xu)for(var r of xu(i))Df.call(i,r)&&ku(h,r,i[r]);return h},Eu=(h,i)=>Of(h,Af(i));function Ff(h,i,r={}){if(!h)throw new Error("targetPoint is required");if(!i)throw new Error("points is required");let a=1/0,l=0;si(i,(m,d)=>{const x=cl(h,m,r);x<a&&(l=d,a=x)});const g=oa(i.features[l]);return Eu(wu({},g),{properties:Eu(wu({},g.properties),{featureIndex:l,distanceToPoint:a})})}var Bf=Ff;function zf(h,i={}){const r=Ln(h);switch(!i.properties&&h.type==="Feature"&&(i.properties=h.properties),r.type){case"Polygon":return Gf(r,i);case"MultiPolygon":return Hf(r,i);default:throw new Error("invalid poly")}}function Gf(h,i={}){const a=Ln(h).coordinates,l=i.properties?i.properties:h.type==="Feature"?h.properties:{};return fl(a,l)}function Hf(h,i={}){const a=Ln(h).coordinates,l=i.properties?i.properties:h.type==="Feature"?h.properties:{},g=[];return a.forEach(m=>{g.push(fl(m,l))}),In(g)}function fl(h,i){return h.length>1?$l(h,i):co(h[0],i)}var qf=zf;function Zf(h,i={}){var r,a,l,g=i.properties,m=(r=i.autoComplete)!=null?r:!0,d=(a=i.orderCoords)!=null?a:!0,x=(l=i.mutate)!=null?l:!1;switch(x||(h=oa(h)),h.type){case"FeatureCollection":var v=[];return h.features.forEach(function(P){v.push(lr(Pu(P,{},m,d)))}),fo(v,g);default:return Pu(h,g,m,d)}}function Pu(h,i,r,a){i=i||(h.type==="Feature"?h.properties:{});var l=Ln(h),g=l.coordinates,m=l.type;if(!g.length)throw new Error("line must contain coordinates");switch(m){case"LineString":return r&&(g=Mu(g)),Zn([g],i);case"MultiLineString":var d=[],x=0;return g.forEach(function(v){if(r&&(v=Mu(v)),a){var P=Uf(hr(co(v)));P>x?(d.unshift(v),x=P):d.push(v)}else d.push(v)}),Zn(d,i);default:throw new Error("geometry type "+m+" is not supported")}}function Mu(h){var i=h[0],r=i[0],a=i[1],l=h[h.length-1],g=l[0],m=l[1];return(r!==g||a!==m)&&h.push(i),h}function Uf(h){var i=h[0],r=h[1],a=h[2],l=h[3];return Math.abs(i-a)*Math.abs(r-l)}var Yf=Zf,Xf=class{constructor(h){this.points=h.points||[],this.duration=h.duration||1e4,this.sharpness=h.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=h.stepLength||60,this.length=this.points.length,this.delay=0;for(let i=0;i<this.length;i++)this.points[i].z=this.points[i].z||0;for(let i=0;i<this.length-1;i++){const r=this.points[i],a=this.points[i+1];this.centers.push({x:(r.x+a.x)/2,y:(r.y+a.y)/2,z:(r.z+a.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(let i=0;i<this.centers.length-1;i++){const r=this.points[i+1].x-(this.centers[i].x+this.centers[i+1].x)/2,a=this.points[i+1].y-(this.centers[i].y+this.centers[i+1].y)/2,l=this.points[i+1].z-(this.centers[i].y+this.centers[i+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[i+1].x+this.sharpness*(this.centers[i].x+r),y:(1-this.sharpness)*this.points[i+1].y+this.sharpness*(this.centers[i].y+a),z:(1-this.sharpness)*this.points[i+1].z+this.sharpness*(this.centers[i].z+l)},{x:(1-this.sharpness)*this.points[i+1].x+this.sharpness*(this.centers[i+1].x+r),y:(1-this.sharpness)*this.points[i+1].y+this.sharpness*(this.centers[i+1].y+a),z:(1-this.sharpness)*this.points[i+1].z+this.sharpness*(this.centers[i+1].z+l)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}cacheSteps(h){const i=[];let r=this.pos(0);i.push(0);for(let a=0;a<this.duration;a+=10){const l=this.pos(a);Math.sqrt((l.x-r.x)*(l.x-r.x)+(l.y-r.y)*(l.y-r.y)+(l.z-r.z)*(l.z-r.z))>h&&(i.push(a),r=l)}return i}vector(h){const i=this.pos(h+10),r=this.pos(h-10);return{angle:180*Math.atan2(i.y-r.y,i.x-r.x)/3.14,speed:Math.sqrt((r.x-i.x)*(r.x-i.x)+(r.y-i.y)*(r.y-i.y)+(r.z-i.z)*(r.z-i.z))}}pos(h){let i=h-this.delay;i<0&&(i=0),i>this.duration&&(i=this.duration-1);const r=i/this.duration;if(r>=1)return this.points[this.length-1];const a=Math.floor((this.points.length-1)*r),l=(this.length-1)*r-a;return Vf(l,this.points[a],this.controls[a][1],this.controls[a+1][0],this.points[a+1])}};function Vf(h,i,r,a,l){const g=Wf(h);return{x:l.x*g[0]+a.x*g[1]+r.x*g[2]+i.x*g[3],y:l.y*g[0]+a.y*g[1]+r.y*g[2]+i.y*g[3],z:l.z*g[0]+a.z*g[1]+r.z*g[2]+i.z*g[3]}}function Wf(h){const i=h*h;return[i*h,3*i*(1-h),3*h*(1-h)*(1-h),(1-h)*(1-h)*(1-h)]}function Kf(h,i={}){const r=i.resolution||1e4,a=i.sharpness||.85,l=[],g=Ln(h).coordinates.map(v=>({x:v[0],y:v[1]})),m=new Xf({duration:r,points:g,sharpness:a}),d=v=>{var P=m.pos(v);Math.floor(v/100)%2===0&&l.push([P.x,P.y])};for(var x=0;x<m.duration;x+=10)d(x);return d(m.duration),co(l,i.properties)}var Jf=Kf;function $f(h,i={}){return nh(h,(r,a)=>{const l=a.geometry.coordinates;return r+cl(l[0],l[1],i)},0)}var jf=$f;const sa=()=>"ontouchstart"in window||navigator.maxTouchPoints>0;function Xt(){return typeof vitest<"u"}class Qf{static getBounds(i,r=0){const a=[];i.forEach(m=>{isNaN(m.lat)||isNaN(m.lng),a.push(m)});const g=new lt.Polyline(a).getBounds();return r!==0?g.pad(r):g}}class tg{constructor(i=0,r=0,a=0,l=0){at(this,"direction",{East:new lt.LatLng(0,0),North:new lt.LatLng(0,0),NorthEast:new lt.LatLng(0,0),NorthWest:new lt.LatLng(0,0),South:new lt.LatLng(0,0),SouthEast:new lt.LatLng(0,0),SouthWest:new lt.LatLng(0,0),West:new lt.LatLng(0,0)}),this.direction.North=new lt.LatLng(a,(r+l)/2),this.direction.NorthEast=new lt.LatLng(a,l),this.direction.East=new lt.LatLng((i+a)/2,l),this.direction.SouthEast=new lt.LatLng(i,l),this.direction.South=new lt.LatLng(i,(r+l)/2),this.direction.SouthWest=new lt.LatLng(i,r),this.direction.West=new lt.LatLng((i+a)/2,r),this.direction.NorthWest=new lt.LatLng(a,r)}getDirection(i){switch(i){case nn.SouthWest:return this.direction.SouthWest;case nn.West:return this.direction.West;case nn.NorthWest:return this.direction.NorthWest;case nn.North:return this.direction.North;case nn.NorthEast:return this.direction.NorthEast;case nn.East:return this.direction.East;case nn.SouthEast:return this.direction.SouthEast;case nn.South:return this.direction.South;default:throw new Error}}getPositions(i=nn.SouthWest,r=!1,a=!0){const l=[],g=this.getPositionAsArray(i,r);return g.forEach(m=>{l.push([m.lng,m.lat])}),a&&l.push([g[0].lng,g[0].lat]),l}getPositionAsArray(i=nn.NorthEast,r=!1){const a=[];return r?(a.push(this.direction.SouthWest),a.push(this.direction.West),a.push(this.direction.NorthWest),a.push(this.direction.North),a.push(this.direction.NorthEast),a.push(this.direction.East),a.push(this.direction.SouthEast),a.push(this.direction.South)):(a.push(this.direction.SouthWest),a.push(this.direction.South),a.push(this.direction.SouthEast),a.push(this.direction.East),a.push(this.direction.NorthEast),a.push(this.direction.North),a.push(this.direction.NorthWest),a.push(this.direction.West)),i!==nn.SouthWest&&a.splice(0,i).forEach((g,m)=>{a.splice(i+m,0,g)}),a}}class eg{constructor(i,r){if(at(this,"metricLength",""),at(this,"metricUnit",""),at(this,"imperialLength",""),at(this,"imperialUnit",""),i!==null||i!==void 0){i===0?r.markers.markerInfoIcon.usePerimeterMinValue?(this.metricLength=r.markers.markerInfoIcon.values.min.metric,this.metricUnit=r.markers.markerInfoIcon.units.metric.perimeter.m,this.imperialLength=r.markers.markerInfoIcon.values.min.imperial,this.imperialUnit=r.markers.markerInfoIcon.units.imperial.perimeter.feet):(this.metricLength=r.markers.markerInfoIcon.values.unknown.metric,this.metricUnit=r.markers.markerInfoIcon.units.unknownUnit,this.imperialLength=r.markers.markerInfoIcon.values.unknown.imperial,this.imperialUnit=r.markers.markerInfoIcon.units.unknownUnit):i<100?(this.metricLength=(Math.ceil(i/10)*10).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.perimeter.m):i<500?(this.metricLength=(Math.ceil(i/50)*50).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.perimeter.m):i<1e3?(this.metricLength=(Math.ceil(i/100)*100).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.perimeter.m):i<1e4?(this.metricLength=(Math.ceil(i/100)*100/1e3).toFixed(1),this.metricUnit=r.markers.markerInfoIcon.units.metric.perimeter.km):(this.metricLength=(Math.ceil(i/1e3)*1e3/1e3).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.perimeter.km);const l=i/.0254/12,g=l/3,m=g/1760;i<1e3/2.54?(this.imperialLength=(Math.ceil(l/10)*10).toString(),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.perimeter.feet):i<1e3/2.54*3?(this.imperialLength=(Math.ceil(g/10)*10).toString(),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.perimeter.yards):i<1609?(this.imperialLength=m.toFixed(2),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.perimeter.miles):i<16093?(this.imperialLength=m.toFixed(1),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.perimeter.miles):(this.imperialLength=m.toFixed(0),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.perimeter.miles)}}}class ng{constructor(i,r){at(this,"metricArea",""),at(this,"metricUnit",""),at(this,"imperialArea",""),at(this,"imperialUnit","");const a=i,l=r.markers.markerInfoIcon.units.metric.onlyMetrics;if(a!==null||a!==void 0){a===0?(this.metricArea="-",this.metricUnit=r.markers.markerInfoIcon.units.unknownUnit,this.imperialArea="-",this.imperialUnit=r.markers.markerInfoIcon.units.unknownUnit):a<1e4?(this.metricArea=Math.round(a).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.m2):a<1e5?l?(this.metricArea=(a/1e6).toFixed(2),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.km2):(this.metricArea=(a/1e3).toFixed(1),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.daa):a<1e7?l?(this.metricArea=(a/1e6).toFixed(2),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.km2):(this.metricArea=Math.round(a/1e3).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.daa):a<1e8?l?(this.metricArea=(a/1e6).toFixed(1),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.km2):(this.metricArea=Math.round(a/1e4).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.ha):(this.metricArea=Math.round(a/1e6).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.km2);const m=a*1550*.0069444,d=m*.11111,x=d*20661e-8,v=d*32283e-11;a<92.9?(this.imperialArea=Math.round(m).toString(),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.feet2):a<836.14?(this.imperialArea=d.toFixed(0),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.yards2):a<40469.6?(this.imperialArea=x.toFixed(2),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.acres):a<404696?(this.imperialArea=x.toFixed(1),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.acres):a<4046960?(this.imperialArea=x.toFixed(0),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.acres):a<25900404?(this.imperialArea=v.toFixed(2),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.miles2):a<259004040?(this.imperialArea=v.toFixed(1),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.miles2):(this.imperialArea=v.toFixed(0),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.miles2)}}}class gl{constructor(i){at(this,"config",Li),this.config={...Li,...i}}union(i,r){try{const a=nr([i,r]),l=Kh(a);return l?this.getTurfPolygon(l):null}catch(a){return Xt()||console.warn("Error in union:",a instanceof Error?a.message:String(a)),null}}createPolygonFromTrace(i){var r;const a=((r=this.config.polygonCreation)==null?void 0:r.method)||"concaveman";switch(a){case"concaveman":return this.turfConcaveman(i);case"convex":return this.createConvexPolygon(i);case"direct":return this.createDirectPolygon(i);case"buffer":return this.createBufferedPolygon(i);default:return Xt()||console.warn(`Unknown polygon creation method: ${a}, falling back to concaveman`),this.turfConcaveman(i)}}turfConcaveman(i){const a=ir(i).features.map(l=>l.geometry.coordinates);return er([[bu(a)]])}createConvexPolygon(i){const r=ir(i),a=Na(r);return a?this.getTurfPolygon(a):this.createDirectPolygon(i)}createDirectPolygon(i){let r;if(i.geometry.type==="LineString"?r=i.geometry.coordinates:i.geometry.type==="Polygon"?r=i.geometry.coordinates[0]:r=ir(i).features.map(l=>l.geometry.coordinates),r.length>0){const a=r[0],l=r[r.length-1];(a[0]!==l[0]||a[1]!==l[1])&&r.push([a[0],a[1]])}return r.length<4?(Xt()||console.warn("Not enough points for direct polygon, falling back to concaveman"),this.turfConcaveman(i)):er([[r]])}createBufferedPolygon(i){try{let r;if(i.geometry.type==="LineString")r=i;else{const g=ir(i).features.map(m=>m.geometry.coordinates);r=No(g)}const a=Rc(r,.001,{units:"kilometers"});return a?this.getTurfPolygon(a):this.createDirectPolygon(i)}catch(r){return Xt()||console.warn("Buffer polygon creation failed:",r instanceof Error?r.message:String(r)),this.createDirectPolygon(i)}}getSimplified(i,r=!1){var a,l,g,m,d,x;const v=((l=(a=this.config.polygonCreation)==null?void 0:a.simplification)==null?void 0:l.mode)||"simple";if(v==="simple"){const P={tolerance:((m=(g=this.config.polygonCreation)==null?void 0:g.simplification)==null?void 0:m.tolerance)||1e-4,highQuality:((x=(d=this.config.polygonCreation)==null?void 0:d.simplification)==null?void 0:x.highQuality)||!1,mutate:!1};return Kr(i,P)}else if(v==="dynamic"){const P=i.geometry.coordinates[0][0].length,I=this.config.simplification.simplifyTolerance;if(r){let b=Kr(i,I);const O=this.config.simplification.dynamicMode.fractionGuard,R=this.config.simplification.dynamicMode.multiplier;for(;b.geometry.coordinates[0][0].length>4&&b.geometry.coordinates[0][0].length/(P+2)>O;)I.tolerance=I.tolerance*R,b=Kr(i,I);return b}else return Kr(i,I)}else return v==="none"?i:(Xt()||console.warn(`Unknown simplification mode: ${v}, falling back to simple`),Kr(i,{tolerance:1e-4,highQuality:!1,mutate:!1}))}getTurfPolygon(i){let r;return i.geometry.type==="Polygon"?r=er([i.geometry.coordinates]):r=er(i.geometry.coordinates),r}getMultiPolygon(i){return er(i)}getKinks(i){try{if(!i||!i.geometry||!i.geometry.coordinates)return[i];const r=this.removeDuplicateVertices(i);if(!r||!r.geometry||!r.geometry.coordinates)return Xt()||console.warn("Feature became invalid after cleaning in getKinks"),[i];if(this.polygonHasHoles(r))return this.getKinksWithHolePreservation(r);{const l=Xo(r),g=[];return si(l,m=>{g.push(m)}),g}}catch(r){return Xt()||console.warn("Error processing kinks:",r instanceof Error?r.message:String(r)),[i]}}getCoords(i){return Ii(i)}hasKinks(i){return lu(i).features.length>0}getConvexHull(i){try{const r=nr([i]);return Na(r)}catch(r){return Xt()||console.warn("Error in getConvexHull:",r instanceof Error?r.message:String(r)),null}}getMidpoint(i,r){const a=Me([i.lng,i.lat]),l=Me([r.lng,r.lat]),g=Pa(a,l);return{lat:g.geometry.coordinates[1],lng:g.geometry.coordinates[0]}}polygonIntersect(i,r){try{if(!i||!i.geometry||!i.geometry.coordinates||!r||!r.geometry||!r.geometry.coordinates)return Xt()||console.warn("Invalid features passed to polygonIntersect"),!1;const a=l=>{if(!Array.isArray(l))return!1;for(const g of l){if(!Array.isArray(g))return!1;for(const m of g)if(!Array.isArray(m)||m.length<2||m.some(d=>d==null||!isFinite(d)))return!1}return!0};if(!a(i.geometry.coordinates)||!a(r.geometry.coordinates))return!1;try{const l=nr([i,r]),g=qa(l);if(g&&g.geometry&&(g.geometry.type==="Polygon"||g.geometry.type==="MultiPolygon")&&Oo(g)>1e-6)return!0}catch{}try{const l=ir(i),g=ir(r);for(const m of g.features)if(Bn(m,i))return!0;for(const m of l.features)if(Bn(m,r))return!0}catch{}try{const l=Ii(i),g=Ii(r);for(const m of l){const d=m[0];if(!(!d||d.length<2))for(let x=0;x<d.length-1;x++){const v=d[x],P=d[x+1];if(!v||!P||!Array.isArray(v)||!Array.isArray(P)||v.length<2||P.length<2||v.some(b=>b==null||!isFinite(b))||P.some(b=>b==null||!isFinite(b)))continue;const I=No([v,P]);for(const b of g){const O=b[0];if(!(!O||O.length<2))for(let R=0;R<O.length-1;R++){const W=O[R],j=O[R+1];if(!W||!j||!Array.isArray(W)||!Array.isArray(j)||W.length<2||j.length<2||W.some(M=>M==null||!isFinite(M))||j.some(M=>M==null||!isFinite(M)))continue;const st=No([W,j]);try{const M=Lh(I,st);if(M&&M.features&&M.features.length>0)return!0}catch{}}}}}}catch{}return!1}catch(a){return Xt()||console.warn("Error in polygonIntersect:",a instanceof Error?a.message:String(a)),!1}}getIntersection(i,r){try{const a=nr([i,r]),l=qa(a);return l&&l.geometry&&(l.geometry.type==="Polygon"||l.geometry.type==="MultiPolygon")?l:null}catch(a){return Xt()||console.warn("Error in getIntersection:",a instanceof Error?a.message:String(a)),null}}getDistance(i,r){return Ea(i,r)}isWithin(i,r){return vu(fn([i]),fn([r]))}isPolygonCompletelyWithin(i,r){try{return vu(i,r)}catch{const l=Ii(i),g=Ii(r);for(const m of l)for(const d of m)for(const x of d){const v=Me(x);let P=!1;for(const I of g){for(const b of I){const O=fn([b]);if(Bn(v,O)){P=!0;break}}if(P)break}if(!P)return!1}return!0}}toPointFeature(i){var r,a;if((i==null?void 0:i.type)==="Feature"&&((r=i.geometry)==null?void 0:r.type)==="Point")return i;if(Array.isArray(i)&&i.length>=2&&typeof i[0]=="number"&&typeof i[1]=="number")return Me(i);if(typeof(i==null?void 0:i.lat)=="number"&&typeof(i==null?void 0:i.lng)=="number"){const l=i;return Me([l.lng,l.lat])}if((a=i==null?void 0:i.geometry)!=null&&a.coordinates&&Array.isArray(i.geometry.coordinates))return Me(i.geometry.coordinates);throw new Error("Unsupported point format provided to toPointFeature")}isPointInsidePolygon(i,r){try{const a=this.toPointFeature(i);return Bn(a,r)}catch{return!1}}equalPolygons(i,r){return Tf(i,r)}convertToBoundingBoxPolygon(i){const r=Vl(i);return Wl(r)}polygonToMultiPolygon(i){return er([i.geometry.coordinates])}injectPointToPolygon(i,r,a){const l=JSON.parse(JSON.stringify(i));let g;if(l.geometry.type==="MultiPolygon")g=l.geometry.coordinates[0][a];else if(l.geometry.type==="Polygon")g=l.geometry.coordinates[a];else return l;if(!g)return l;let m=1/0,d=0;for(let x=0;x<g.length-1;x++){const v=g[x],P=g[x+1],I=this.distanceToLineSegment(r,v,P);I<m&&(m=I,d=x+1)}return g.splice(d,0,r),l}distanceToLineSegment(i,r,a){const l=i[0]-r[0],g=i[1]-r[1],m=a[0]-r[0],d=a[1]-r[1],x=l*m+g*d,v=m*m+d*d;if(v===0)return Math.sqrt(l*l+g*g);const P=x/v;let I,b;P<0?(I=r[0],b=r[1]):P>1?(I=a[0],b=a[1]):(I=r[0]+P*m,b=r[1]+P*d);const O=i[0]-I,R=i[1]-b;return Math.sqrt(O*O+R*R)}polygonDifference(i,r){try{const a=nr([i,r]),l=jh(a);return l?this.getTurfPolygon(l):null}catch(a){return Xt()||console.warn("Error in polygonDifference:",a instanceof Error?a.message:String(a)),null}}getBoundingBoxCompassPosition(i,r,a,l){return null}getNearestPointIndex(i,r){return Bf(i,r).properties.featureIndex}getCoord(i){return[i.lng,i.lat]}createPolygon(i){return fn(i)}getFeaturePointCollection(i){const r=[];return i.forEach(l=>{const g=Me([l.lng,l.lat],{});r.push(g)}),nr(r)}getPolygonArea(i){return Oo(i)}getPolygonPerimeter(i){return jf(i,{units:"kilometers"})}getCenterOfMass(i){return yh(i)}getDoubleElbowLatLngs(i){const r=[],a=i.length,l=i[0].lat===i[a-1].lat&&i[0].lng===i[a-1].lng?a-1:a;for(let g=0;g<l;g++){const m=i[g],d=i[(g+1)%l];r.push(new lt.LatLng(m.lat,m.lng));const x=Pa(Me([m.lng,m.lat]),Me([d.lng,d.lat]));r.push(new lt.LatLng(x.geometry.coordinates[1],x.geometry.coordinates[0]))}return r}getBezierMultiPolygon(i){const r=qf(this.getMultiPolygon(i));r.features[0].geometry.coordinates.push(r.features[0].geometry.coordinates[0]);const a=Jf(r.features[0],{resolution:this.config.bezier.resolution,sharpness:this.config.bezier.sharpness});return Yf(a)}polygonHasHoles(i){try{return i.geometry.type==="Polygon"?i.geometry.coordinates.length>1:i.geometry.type==="MultiPolygon"?i.geometry.coordinates.some(r=>r.length>1):!1}catch(r){return Xt()||console.warn("Error checking for holes:",r instanceof Error?r.message:String(r)),!1}}getKinksWithHolePreservation(i){try{if(i.geometry.type==="Polygon"){const r=i.geometry.coordinates,a=r[0],l=r.slice(1),g={type:"Feature",geometry:{type:"Polygon",coordinates:[a]},properties:i.properties||{}},m=this.hasKinks(g),d=this.checkOuterRingHoleIntersection(a,l);if(m||d){if(this.checkIfDragCompletelyThroughHole(a,l))return this.handleCompleteHoleTraversal(g,l);const v=Xo(g),P=[];return si(v,I=>{const b=this.subtractIntersectingHoles(I,l);P.push(b)}),P}else return[i]}else if(i.geometry.type==="MultiPolygon"){const r=[];for(const a of i.geometry.coordinates){const l={type:"Feature",geometry:{type:"Polygon",coordinates:a},properties:i.properties||{}},g=this.getKinksWithHolePreservation(l);r.push(...g)}return r}return[i]}catch(r){return Xt()||console.warn("Error in getKinksWithHolePreservation:",r instanceof Error?r.message:String(r)),[i]}}checkIfDragCompletelyThroughHole(i,r){try{if(this.findDuplicatePoints(i).length>0)return!0;const l=this.findSelfIntersectionLine(i);if(l&&r.length>0){for(const g of r)if(this.lineCompletelyTraversesHole(l,g))return!0}if(this.hasKinks({type:"Feature",geometry:{type:"Polygon",coordinates:[i]},properties:{}})){for(const g of r)if(this.holeIsCutByKinks(i,g))return!0}return!1}catch(a){return Xt()||console.warn("Error checking complete hole traversal:",a instanceof Error?a.message:String(a)),!1}}findSelfIntersectionLine(i){try{const r=new Map;for(let a=0;a<i.length-1;a++){const l=i[a],g=`${l[0]},${l[1]}`;r.has(g)?r.get(g).indices.push(a):r.set(g,{point:l,indices:[a]})}for(const[,a]of r)if(a.indices.length>=2){const l=a.indices[0],g=a.indices[1],m=[];for(let d=l;d<=g;d++)m.push(i[d]);return m}return null}catch(r){return Xt()||console.warn("Error finding self-intersection line:",r instanceof Error?r.message:String(r)),null}}lineCompletelyTraversesHole(i,r){try{if(i.length<2)return!1;const a=i[0],l=i[i.length-1],g=fn([r]),m=Bn(Me(a),g),d=Bn(Me(l),g);return m!==d}catch(a){return Xt()||console.warn("Error checking line hole traversal:",a instanceof Error?a.message:String(a)),!1}}holeIsCutByKinks(i,r){try{const a=fn([i]),l=fn([r]),g=lu(a);if(g.features.length===0)return!1;for(const m of g.features){const d=m.geometry.coordinates;try{if(Ea(Me(d),Kl(l))<.01||Bn(Me(d),l))return!0}catch{if(Bn(Me(d),l))return!0}}return!1}catch(a){return Xt()||console.warn("Error checking hole cut by kinks:",a.message),!1}}findDuplicatePoints(i){const r=[],a=new Set;for(let l=0;l<i.length-1;l++){const g=i[l],m=`${g[0]},${g[1]}`;a.has(m)?r.push(g):a.add(m)}return r}checkOuterRingHoleIntersection(i,r){try{if(r.length===0)return!1;const a=fn([i]);for(const l of r){const g=fn([l]);if(this.getIntersection(a,g))return!0;for(let d=0;d<i.length-1;d++){const x=i[d];if(Bn(Me(x),g))return!0}}return!1}catch{return!1}}handleCompleteHoleTraversal(i,r){try{const a={type:"Feature",geometry:{type:"Polygon",coordinates:[i.geometry.coordinates[0]]},properties:i.properties||{}},l=Xo(a),g=[];return si(l,m=>{m._polydrawHoleTraversalOccurred=!0,g.push(m)}),g}catch(a){Xt()||console.warn("Error handling complete hole traversal:",a instanceof Error?a.message:String(a));try{const l={...i,geometry:{...i.geometry,coordinates:[i.geometry.coordinates[0]]}};return l._polydrawHoleTraversalOccurred=!0,[l]}catch{return[i]}}}subtractIntersectingHoles(i,r){try{let a=i;for(const l of r){const g=fn([l]);if(this.getIntersection(g,a)){const d=this.polygonDifference(a,g);if(d){if(d.geometry.type==="Polygon")a=d;else if(d.geometry.type==="MultiPolygon"){const x=d;let v=0,P=null;for(const I of x.geometry.coordinates){const b={type:"Feature",geometry:{type:"Polygon",coordinates:I},properties:{}},O=Oo(b);O>v&&(v=O,P=b)}P&&(a=P)}}}}return a}catch(a){return Xt()||console.warn("Error subtracting intersecting holes:",a instanceof Error?a.message:String(a)),i}}removeDuplicateVertices(i){if(!i||!i.geometry||!i.geometry.coordinates)return Xt()||console.warn("Invalid feature passed to removeDuplicateVertices"),i;const r=a=>{if(!a||a.length<3)return Xt()||console.warn("Invalid coordinates array - need at least 3 points for a polygon"),a||[];const l=[],g=1e-6;for(let m=0;m<a.length;m++){const d=a[m],x=a[(m+1)%a.length];if(!d||!Array.isArray(d)||d.length<2||!x||!Array.isArray(x)||x.length<2)continue;const v=Math.abs(d[1]-x[1]),P=Math.abs(d[0]-x[0]);(v>g||P>g)&&l.push(d)}if(l.length<3)return Xt()||console.warn("After cleaning, polygon has less than 3 points"),a;if(l.length>0){const m=l[0],d=l[l.length-1],x=Math.abs(m[1]-d[1]),v=Math.abs(m[0]-d[0]);(x>g||v>g)&&l.push([m[0],m[1]])}return l};try{if(i.geometry.type==="Polygon"){const a=i.geometry.coordinates.map(l=>r(l));return a.some(l=>l.length<4)?(Xt()||console.warn("Cleaned polygon has invalid ring with less than 4 coordinates"),i):{...i,geometry:{...i.geometry,coordinates:a}}}else if(i.geometry.type==="MultiPolygon"){const a=i.geometry.coordinates.map(l=>l.map(g=>r(g)));return a.some(l=>l.some(g=>g.length<4))?(Xt()||console.warn("Cleaned multipolygon has invalid ring with less than 4 coordinates"),i):{...i,geometry:{...i.geometry,coordinates:a}}}}catch(a){return Xt()||console.warn("Error in removeDuplicateVertices:",a instanceof Error?a.message:String(a)),i}return i}}function ig(h,i,r,a,l,g,m,d){const x=lt.DomUtil.create("a","icon-activate",h);if(x.href="#",x.title="Activate",x.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M5 17V7M5 17C3.89543 17 3 17.8954 3 19C3 20.1046 3.89543 21 5 21C6.10457 21 7 20.1046 7 19M5 17C6.10457 17 7 17.8954 7 19M5 7C6.10457 7 7 6.10457 7 5M5 7C3.89543 7 3 6.10457 3 5C3 3.89543 3.89543 3 5 3C6.10457 3 7 3.89543 7 5M7 5H17M17 5C17 6.10457 17.8954 7 19 7C20.1046 7 21 6.10457 21 5C21 3.89543 20.1046 3 19 3C17.8954 3 17 3.89543 17 5ZM7 19H17M17 19C17 20.1046 17.8954 21 19 21C20.1046 21 21 20.1046 21 19C21 17.8954 20.1046 17 19 17C17.8954 17 17 17.8954 17 19ZM17.9247 6.6737L15.1955 10.3776M15.1955 13.6223L17.9222 17.3223M16 12C16 13.1046 15.1046 14 14 14C12.8954 14 12 13.1046 12 12C12 10.8954 12.8954 10 14 10C15.1046 10 16 10.8954 16 12Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>',lt.DomEvent.on(x,"mousedown",lt.DomEvent.stopPropagation),lt.DomEvent.on(x,"touchstart",lt.DomEvent.stopPropagation),lt.DomEvent.on(x,"click",lt.DomEvent.stop).on(x,"click",a),r.modes.draw){const v=lt.DomUtil.create("a","icon-draw",i);v.href="#",v.title="Draw",v.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M15 7.49996L17.5 9.99996M7.5 20L19.25 8.24996C19.9404 7.5596 19.9404 6.44032 19.25 5.74996V5.74996C18.5596 5.0596 17.4404 5.05961 16.75 5.74996L5 17.5V20H7.5ZM7.5 20H15.8787C17.0503 20 18 19.0502 18 17.8786V17.8786C18 17.316 17.7765 16.7765 17.3787 16.3786L17 16M4.5 4.99996C6.5 2.99996 10 3.99996 10 5.99996C10 8.5 4 8.5 4 11C4 11.8759 4.53314 12.5256 5.22583 13" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>',lt.DomEvent.on(v,"mousedown",lt.DomEvent.stopPropagation),lt.DomEvent.on(v,"touchstart",lt.DomEvent.stopPropagation),lt.DomEvent.on(v,"click",lt.DomEvent.stop).on(v,"click",l)}if(r.modes.subtract){const v=lt.DomUtil.create("a","icon-subtract",i);v.href="#",v.title="Subtract",v.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M15.0722 3.9967L20.7508 9.83395L17.0544 13.5304L13.0758 17.5H21.0041V19H7.93503L4.00195 15.0669L15.0722 3.9967ZM10.952 17.5L15.4628 12.9994L11.8268 9.3634L6.12327 15.0669L8.55635 17.5H10.952Z" fill="#1F2328"></path> </g></svg>',lt.DomEvent.on(v,"mousedown",lt.DomEvent.stopPropagation),lt.DomEvent.on(v,"touchstart",lt.DomEvent.stopPropagation),lt.DomEvent.on(v,"click",lt.DomEvent.stop).on(v,"click",g)}if(r.modes.p2p&&!sa()){const v=lt.DomUtil.create("a","icon-p2p",i);v.href="#",v.title="Point to Point",v.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M5 17V7M5 17C3.89543 17 3 17.8954 3 19C3 20.1046 3.89543 21 5 21C6.10457 21 7 20.1046 7 19M5 17C6.10457 17 7 17.8954 7 19M5 7C6.10457 7 7 6.10457 7 5M5 7C3.89543 7 3 6.10457 3 5C3 3.89543 3.89543 3 5 3C6.10457 3 7 3.89543 7 5M7 5H17M17 5C17 6.10457 17.8954 7 19 7C20.1046 7 21 6.10457 21 5C21 3.89543 20.1046 3 19 3C17.8954 3 17 3.89543 17 5ZM7 19H17M17 19C17 20.1046 17.8954 21 19 21C20.1046 21 21 20.1046 21 19C21 17.8954 20.1046 17 19 17C17.8954 17 17 17.8954 17 19ZM17.9247 6.6737L15.1955 10.3776M15.1955 13.6223L17.9222 17.3223M16 12C16 13.1046 15.1046 14 14 14C12.8954 14 12 13.1046 12 12C12 10.8954 12.8954 10 14 10C15.1046 10 16 10.8954 16 12Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>',lt.DomEvent.on(v,"mousedown",lt.DomEvent.stopPropagation),lt.DomEvent.on(v,"touchstart",lt.DomEvent.stopPropagation),lt.DomEvent.on(v,"click",lt.DomEvent.stop).on(v,"click",d)}if(r.modes.deleteAll){const v=lt.DomUtil.create("a","icon-erase",i);v.href="#",v.title="Erase All",v.innerHTML=`<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 21.0.2, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 48 48" style="enable-background:new 0 0 48 48;" xml:space="preserve">
<style type="text/css">
	.st0{fill:#000000}
	.st1{fill:#333333;fill-opacity:0;}
</style>
<title>trash</title>
<rect class="st1" width="48" height="48"/>
<polygon class="st0" points="26.6,10 26.6,7.8 21.4,7.8 21.4,10 12.6,10 12.6,12.8 35.4,12.8 35.4,10 "/>
<path class="st0" d="M35.4,15.4H12.6v4.3h1.8V37c0,1.1,0.9,2,2,2h15.2c1.1,0,2-0.9,2-2V19.7h1.8V15.4z M19.7,34.2c0,0.5-0.4,1-1,1
	c-0.5,0-1-0.4-1-1V22.6c0-0.5,0.4-1,1-1c0.5,0,1,0.4,1,1V34.2z M25.3,33.8c0,0.7-0.6,1.3-1.3,1.3c-0.7,0-1.3-0.6-1.3-1.3V23
	c0-0.7,0.6-1.3,1.3-1.3c0.7,0,1.3,0.6,1.3,1.3V33.8z M30.3,34.2c0,0.5-0.4,1-1,1c-0.5,0-1-0.4-1-1V22.6c0-0.5,0.4-1,1-1
	c0.5,0,1,0.4,1,1V34.2z"/>
</svg>`,lt.DomEvent.on(v,"mousedown",lt.DomEvent.stopPropagation),lt.DomEvent.on(v,"touchstart",lt.DomEvent.stopPropagation),lt.DomEvent.on(v,"click",lt.DomEvent.stop).on(v,"click",m)}}class Si{static getCenter(i){let r=0,a=0,l=0;i.forEach(v=>{let P=v.lat,I=v.lng;P=P*ar.DEG_TO_RAD,I=I*ar.DEG_TO_RAD,r+=Math.cos(P)*Math.cos(I),a+=Math.cos(P)*Math.sin(I),l+=Math.sin(P)});let g=Math.atan2(a,r);const m=Math.sqrt(r*r+a*a);let d=Math.atan2(l,m);return d=d*ar.RAD_TO_DEG,g=g*ar.RAD_TO_DEG,{lat:d,lng:g}}static getSouthWest(i){return this.getBounds(i).getSouthWest()}static getNorthEast(i){return this.getBounds(i).getNorthEast()}static getNorthWest(i){return this.getBounds(i).getNorthWest()}static getSouthEast(i){return this.getBounds(i).getSouthEast()}static getNorth(i){return this.getBounds(i).getNorth()}static getSouth(i){return this.getBounds(i).getSouth()}static getWest(i){return this.getBounds(i).getWest()}static getEast(i){return this.getBounds(i).getEast()}static getSqmArea(i){const a=new lt.Polygon(i).toGeoJSON();return this.turfHelper.getPolygonArea(a)}static getPerimeter(i){const a=new lt.Polygon(i).toGeoJSON();return this.turfHelper.getPolygonPerimeter(a)*1e3}static getPolygonChecksum(i){const r=i.filter((a,l,g)=>{const m=g.find(d=>d.lat===a.lat&&d.lng===a.lng);return m?g.indexOf(m)===l:!1});return r.reduce((a,l)=>+a+ +l.lat,0)*r.reduce((a,l)=>+a+ +l.lng,0)}static getMidPoint(i,r){const a=this.turfHelper.getMidpoint(i,r);return{lat:a.lat,lng:a.lng}}static getBounds(i){const r=[];return i.forEach(g=>{isNaN(g.lat)||isNaN(g.lng),r.push(g)}),new lt.Polyline(r).getBounds()}static getCenterOfMass(i){const r=this.turfHelper.getCenterOfMass(i);return{lat:r.geometry.coordinates[1],lng:r.geometry.coordinates[0]}}}at(Si,"turfHelper",new gl(Li));class rg{constructor(i){if(at(this,"polygon",[]),at(this,"trashcanPoint",[]),at(this,"sqmArea",[]),at(this,"perimeter",[]),!Array.isArray(i))return;if(i.length>0&&Array.isArray(i[0])&&i[0].length>0&&typeof i[0][0]=="object"&&"lat"in i[0][0]){const a=i[0];this.trashcanPoint[0]=this.getTrashcanPoint(a),this.sqmArea[0]=this.calculatePolygonArea(a),this.perimeter[0]=this.calculatePolygonPerimeter(a),this.polygon[0]=[a];return}if(i.length>0&&i[0]&&typeof i[0]=="object"&&"lat"in i[0]){const a=i,l=[[a]];this.trashcanPoint[0]=this.getTrashcanPoint(a),this.sqmArea[0]=this.calculatePolygonArea(a),this.perimeter[0]=this.calculatePolygonPerimeter(a),this.polygon[0]=l[0];return}i.forEach((a,l)=>{!a||!Array.isArray(a)||!a[0]||!Array.isArray(a[0])||(this.trashcanPoint[l]=this.getTrashcanPoint(a[0]),this.sqmArea[l]=this.calculatePolygonArea(a[0]),this.perimeter[l]=this.calculatePolygonPerimeter(a[0]),this.polygon[l]=a)})}setSqmArea(i){this.sqmArea[0]=i}getTrashcanPoint(i){if(!Array.isArray(i)||i.length===0)return console.warn("getTrashcanPoint: Invalid polygon array:",i),{lat:0,lng:0};const r=i.filter(v=>v&&typeof v=="object"&&typeof v.lat=="number"&&typeof v.lng=="number"&&!isNaN(v.lat)&&!isNaN(v.lng));if(r.length===0)return console.warn("getTrashcanPoint: No valid coordinates found:",i),{lat:0,lng:0};const a=Math.max(...r.map(v=>v.lat)),l=r.findIndex(v=>v.lat===a);if(l===-1)return console.warn("getTrashcanPoint: Could not find max lat coordinate"),{lat:0,lng:0};let g,m;if(l>0?(g=r[l-1],l<r.length-1?m=r[l+1]:m=r[0]):(g=r[r.length-1],m=r[l+1]),!g||!m)return console.warn("getTrashcanPoint: Could not determine previous/next points"),r[l]||{lat:0,lng:0};const d=g.lng<m.lng?g:m;return Si.getMidPoint(r[l],d)}calculatePolygonArea(i){return Si.getSqmArea(i)}calculatePolygonPerimeter(i){return Si.getPerimeter(i)}}class sg{constructor(i){at(this,"polygonInfoListeners",[]),at(this,"polygonDrawStateListeners",[]),at(this,"polygonInformationStorage",[]),this.mapStateService=i}onPolygonInfoUpdated(i){this.polygonInfoListeners.push(i)}emitPolygonInfoUpdated(){for(const i of this.polygonInfoListeners)i(this.polygonInformationStorage)}onPolygonDrawStateUpdated(i){this.polygonDrawStateListeners.push(i)}updatePolygons(){const i=[];this.polygonInformationStorage.length>0&&this.polygonInformationStorage.forEach(r=>{const a=[];r.polygon.forEach(l=>{l.forEach(g=>{const m=[...g];g.length>0&&g[0].toString()!==g[g.length-1].toString()&&m.push(g[0]),a.push(m)})}),i.push(a)}),this.mapStateService.updatePolygons(i),this.saveCurrentState()}saveCurrentState(){this.emitPolygonInfoUpdated()}deleteTrashcan(i){const r=this.polygonInformationStorage.findIndex(a=>a.polygon[0]===i);r!==-1&&(this.polygonInformationStorage.splice(r,1),this.updatePolygons())}deleteTrashCanOnMulti(i){let r=0;this.polygonInformationStorage.forEach((a,l)=>{const g=a.polygon.findIndex(m=>m.toString()===i.toString());g>=0&&(r=l,a.trashcanPoint.splice(g,1),a.sqmArea.splice(g,1),a.perimeter.splice(g,1),a.polygon.splice(g,1))}),this.updatePolygons(),this.polygonInformationStorage.length>1&&this.polygonInformationStorage.splice(r,1)}deletePolygonInformationStorage(){this.polygonInformationStorage=[]}createPolygonInformationStorage(i){i.length>0&&(i.forEach(r=>{var a;const l=(a=r.getLayers)==null?void 0:a.call(r);if(l!=null&&l[0]){const g=l[0].getLatLngs(),m=new rg(g);this.polygonInformationStorage.push(m)}}),this.updatePolygons())}}class og{constructor(){at(this,"map",null),at(this,"mapListeners",[])}onMapUpdated(i){this.map&&i(this.map),this.mapListeners.push(i)}emitMapUpdated(){if(this.map)for(const i of this.mapListeners)i(this.map)}updateMapState(i){this.map=i,this.emitMapUpdated()}updatePolygons(i){}}class ag{constructor(){at(this,"eventListeners",new Map)}on(i,r){this.eventListeners.has(i)||this.eventListeners.set(i,[]),this.eventListeners.get(i).push(r)}off(i,r){const a=this.eventListeners.get(i);if(a){const l=a.indexOf(r);l>-1&&a.splice(l,1)}}emit(i,r){var a;this.eventListeners.has(i)&&((a=this.eventListeners.get(i))==null||a.forEach(l=>{l(r)}))}}class ug{constructor(i,r){at(this,"state"),at(this,"config"),at(this,"eventManager"),this.config=i,this.eventManager=r,this.state=this.createInitialState()}createInitialState(){return{polygonDragging:this.config.modes.dragPolygons??!1,markerDragging:this.config.modes.dragElbow??!1,edgeClicking:!0,polygonClicking:!0,canStartDrawing:!0,canCompletePolygon:!1,mapDragging:!0,mapZooming:!0,mapDoubleClickZoom:!0,currentMode:Ft.Off,isDrawingActive:!1,isModifierKeyHeld:!1,showCrosshairCursor:!1,showDragCursor:!1}}updateStateForMode(i){switch(this.state.currentMode=i,i){case Ft.Off:this.setOffModeState();break;case Ft.Add:this.setDrawingModeState();break;case Ft.Subtract:this.setDrawingModeState();break;case Ft.PointToPoint:this.setPointToPointModeState();break}this.state.isDrawingActive=i!==Ft.Off,this.eventManager.emit("polydraw:mode:change",{mode:i})}setOffModeState(){this.state.polygonDragging=this.config.modes.dragPolygons??!1,this.state.markerDragging=this.config.modes.dragElbow??!1,this.state.edgeClicking=!0,this.state.polygonClicking=!0,this.state.canStartDrawing=!0,this.state.canCompletePolygon=!1,this.state.mapDragging=!0,this.state.mapZooming=!0,this.state.mapDoubleClickZoom=!0,this.state.showCrosshairCursor=!1,this.state.showDragCursor=!1}setDrawingModeState(){this.state.polygonDragging=!1,this.state.markerDragging=!1,this.state.edgeClicking=!1,this.state.polygonClicking=!1,this.state.canStartDrawing=!0,this.state.canCompletePolygon=!0,this.state.mapDragging=!1,this.state.mapZooming=!1,this.state.mapDoubleClickZoom=!1,this.state.showCrosshairCursor=!0,this.state.showDragCursor=!1}setPointToPointModeState(){this.state.polygonDragging=!1,this.state.markerDragging=!1,this.state.edgeClicking=!1,this.state.polygonClicking=!1,this.state.canStartDrawing=!0,this.state.canCompletePolygon=!0,this.state.mapDragging=!1,this.state.mapZooming=!1,this.state.mapDoubleClickZoom=!1,this.state.showCrosshairCursor=!0,this.state.showDragCursor=!1}setModifierKeyState(i){this.state.isModifierKeyHeld=i,this.state.currentMode,Ft.Off}canPerformAction(i){switch(i){case"polygonDrag":return this.state.polygonDragging;case"markerDrag":return this.state.markerDragging;case"edgeClick":return this.state.edgeClicking;case"polygonClick":return this.state.polygonClicking;case"startDrawing":return this.state.canStartDrawing;case"completePolygon":return this.state.canCompletePolygon;case"mapDrag":return this.state.mapDragging;case"mapZoom":return this.state.mapZooming;case"mapDoubleClickZoom":return this.state.mapDoubleClickZoom;default:return!1}}isInDrawingMode(){return this.state.isDrawingActive}isInOffMode(){return this.state.currentMode===Ft.Off}getCurrentMode(){return this.state.currentMode}getState(){return{...this.state}}shouldShowCrosshairCursor(){return this.state.showCrosshairCursor}shouldShowDragCursor(){return this.state.showDragCursor}updateConfig(i){this.config=i,this.updateStateForMode(this.state.currentMode)}}class lg{constructor(i){at(this,"turfHelper"),at(this,"map"),at(this,"config"),at(this,"modeManager"),at(this,"eventManager"),at(this,"tracer"),at(this,"p2pMarkers",[]),at(this,"isModifierKeyHeld",!1),at(this,"markerModifierHandlers",new WeakMap),this.turfHelper=i.turfHelper,this.map=i.map,this.config=i.config,this.modeManager=i.modeManager,this.eventManager=i.eventManager,this.tracer=i.tracer}mouseMove(i){if("latlng"in i&&i.latlng)this.tracer.addLatLng(i.latlng);else if("touches"in i&&i.touches&&i.touches.length>0){const r=this.map.getContainer().getBoundingClientRect(),a=this.map.containerPointToLatLng([i.touches[0].clientX-r.x,i.touches[0].clientY-r.y]);this.tracer.addLatLng(a)}}async mouseUpLeave(i){const r=this.tracer.toGeoJSON();if(!r||!r.geometry||!r.geometry.coordinates||r.geometry.coordinates.length<3)return{success:!1,error:"Not enough points to form a valid polygon. Event: "+JSON.stringify(i)};let a;try{a=this.turfHelper.createPolygonFromTrace(r)}catch(l){return{success:!1,error:(l instanceof Error?l.message:"Failed to create polygon from trace")+". Event: "+JSON.stringify(i)}}return!a||!a.geometry||!a.geometry.coordinates||a.geometry.coordinates.length===0?{success:!1,error:"Invalid polygon created from trace. Event: "+JSON.stringify(i)}:(this.eventManager.emit("polydraw:polygon:created",{polygon:a,mode:this.modeManager.getCurrentMode()}),{success:!0,polygon:a})}setModifierKey(i){this.isModifierKeyHeld=i}handlePointToPointClick(i){if(i){if(this.p2pMarkers.length>=3){const r=this.p2pMarkers[0].getLatLng();if(this.isClickingFirstPoint(i,r)){this.completePointToPointPolygon();return}}try{const r=this.p2pMarkers.length===0,a=r?"leaflet-polydraw-p2p-marker leaflet-polydraw-p2p-first-marker":"leaflet-polydraw-p2p-marker",l=new lt.Marker(i,{icon:lt.divIcon({className:a,iconSize:r?[20,20]:[16,16]}),draggable:this.config.modes.dragElbow}).addTo(this.map);l.on("mousedown",g=>{lt.DomEvent.stopPropagation(g)}),l.on("drag",()=>{this.updateP2PTracer()}),l.on("click",g=>{this.isModifierKeyHeld&&this.config.modes.edgeDeletion&&(this.deleteP2PMarker(l),lt.DomEvent.stopPropagation(g))}),l.on("mouseover",()=>this.onMarkerHoverForEdgeDeletion(l,!0)),l.on("mouseout",()=>this.onMarkerHoverForEdgeDeletion(l,!1)),r&&(l.on("mouseover",()=>{if(this.p2pMarkers.length>=3){const g=l.getElement();g&&(g.style.backgroundColor=this.config.colors.p2p.closingMarker,g.style.borderColor=this.config.colors.p2p.closingMarker,g.style.cursor="pointer",g.title="Click to close polygon")}}),l.on("mouseout",()=>{const g=l.getElement();g&&(g.style.backgroundColor="",g.style.borderColor="",g.style.cursor="",g.title="")}),l.on("click",g=>{if(this.isModifierKeyHeld&&this.config.modes.edgeDeletion){this.deleteP2PMarker(l),lt.DomEvent.stopPropagation(g);return}this.p2pMarkers.length>=3&&(lt.DomEvent.stopPropagation(g),this.completePointToPointPolygon())})),this.p2pMarkers.push(l),this.updateP2PTracer()}catch{}}}handleDoubleClick(i){this.modeManager.getCurrentMode()===Ft.PointToPoint&&this.p2pMarkers.length>=3&&this.completePointToPointPolygon()}completePointToPointPolygon(){const i=this.p2pMarkers.map(g=>g.getLatLng());if(i.length<3)return;const r=[...i],a=i[0],l=i[i.length-1];(a.lat!==l.lat||a.lng!==l.lng)&&r.push(a);try{const g=r.map(d=>[d.lng,d.lat]),m=this.turfHelper.getMultiPolygon([[g]]);this.clearP2pMarkers(),this.resetTracer(),this.eventManager.emit("polydraw:polygon:created",{polygon:m,mode:Ft.PointToPoint,isPointToPoint:!0})}catch(g){Xt()||console.warn("Error completing point-to-point polygon:",g),this.clearP2pMarkers(),this.resetTracer()}}cancelPointToPointDrawing(){this.clearP2pMarkers(),this.resetTracer(),this.eventManager.emit("polydraw:draw:cancel",{mode:Ft.PointToPoint})}clearP2pMarkers(){this.p2pMarkers.forEach(i=>this.map.removeLayer(i)),this.p2pMarkers=[]}resetTracer(){this.tracer.setLatLngs([]);try{this.tracer.setStyle({dashArray:void 0})}catch{}}isClickingFirstPoint(i,r){if(!r)return!1;const a=this.map.getZoom(),g=5e-4/Math.pow(2,Math.max(0,a-10)),m=Math.abs(i.lat-r.lat),d=Math.abs(i.lng-r.lng);return m<g&&d<g}updateP2PTracer(){const i=this.p2pMarkers.map(r=>r.getLatLng());if(this.tracer.setLatLngs(i),this.p2pMarkers.length>=2)try{this.tracer.setStyle({color:this.config.colors.polyline,dashArray:"5, 5"})}catch{}else try{this.tracer.setStyle({dashArray:void 0})}catch{}}deleteP2PMarker(i){const r=this.p2pMarkers.findIndex(a=>a===i);r>-1&&(this.p2pMarkers.splice(r,1),this.map.removeLayer(i),this.updateP2PTracer(),r===0&&this.p2pMarkers.length>0&&this.setupFirstMarker())}getP2pMarkers(){return[...this.p2pMarkers]}isInPointToPointMode(){return this.modeManager.getCurrentMode()===Ft.PointToPoint}getTracerPointsCount(){return this.tracer.getLatLngs().length}setupFirstMarker(){if(this.p2pMarkers.length===0)return;const i=this.p2pMarkers[0],r=i.getElement();r&&(r.classList.add("leaflet-polydraw-p2p-first-marker"),i.setIcon(lt.divIcon({className:"leaflet-polydraw-p2p-marker leaflet-polydraw-p2p-first-marker",iconSize:[20,20]}))),i.off("mouseover"),i.off("mouseout"),i.off("click"),i.on("mouseover",()=>{if(this.p2pMarkers.length>=3){const a=i.getElement();a&&(a.style.backgroundColor=this.config.colors.p2p.closingMarker,a.style.borderColor=this.config.colors.p2p.closingMarker,a.style.cursor="pointer",a.title="Click to close polygon")}}),i.on("mouseout",()=>{const a=i.getElement();a&&(a.style.backgroundColor="",a.style.borderColor="",a.style.cursor="",a.title="")}),i.on("click",a=>{if(this.isModifierKeyHeld&&this.config.modes.edgeDeletion){this.deleteP2PMarker(i),lt.DomEvent.stopPropagation(a);return}this.p2pMarkers.length>=3&&(lt.DomEvent.stopPropagation(a),this.completePointToPointPolygon())})}onMarkerHoverForEdgeDeletion(i,r){const a=i.getElement();if(a)if(r){const l=g=>{if(this.isModifierKeyHeld&&this.config.modes.edgeDeletion){a.classList.add("edge-deletion-hover");try{const m=this.map.getContainer();m.style.cursor="pointer"}catch{}}else{a.classList.remove("edge-deletion-hover");try{const m=this.map.getContainer();m.style.cursor=""}catch{}}};this.markerModifierHandlers.set(i,l),document.addEventListener("keydown",l),document.addEventListener("keyup",l),a.addEventListener("mousemove",l)}else{a.classList.remove("edge-deletion-hover");try{const g=this.map.getContainer();g.style.cursor=""}catch{}const l=this.markerModifierHandlers.get(i);l&&(document.removeEventListener("keydown",l),document.removeEventListener("keyup",l),a.removeEventListener("mousemove",l),this.markerModifierHandlers.delete(i))}}}class hg{constructor(i){at(this,"turfHelper"),at(this,"config"),this.turfHelper=i.turfHelper,this.config=i.config}checkPolygonIntersection(i,r){try{const a=this.turfHelper.isPolygonCompletelyWithin(i,r),l=this.turfHelper.isPolygonCompletelyWithin(r,i);if(a||l)return!0}catch{}try{if(this.turfHelper.polygonIntersect(i,r))return!0}catch{}try{const a=this.turfHelper.getIntersection(i,r);if(a&&a.geometry&&(a.geometry.type==="Polygon"||a.geometry.type==="MultiPolygon")&&this.turfHelper.getPolygonArea(a)>1e-6)return!0}catch{}try{const a=this.turfHelper.getCoords(i),l=this.turfHelper.getCoords(r);for(const g of l)for(const m of g[0]){const d={type:"Feature",geometry:{type:"Point",coordinates:m},properties:{}};if(this.turfHelper.isPointInsidePolygon(d,i))return!0}for(const g of a)for(const m of g[0]){const d={type:"Feature",geometry:{type:"Point",coordinates:m},properties:{}};if(this.turfHelper.isPointInsidePolygon(d,r))return!0}}catch{}return!1}unionPolygons(i,r){try{let a=r;for(const l of i){const g=this.turfHelper.union(a,l);g&&(a=g)}return{success:!0,result:a}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error in unionPolygons"}}}subtractPolygon(i,r){try{const a=this.turfHelper.polygonDifference(i,r);if(a){const l=this.turfHelper.getCoords(a),g=[];for(const m of l)g.push(this.turfHelper.getMultiPolygon([m]));return{success:!0,results:g}}else return{success:!0,results:[]}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error in subtractPolygon"}}}simplifyPolygon(i){var r,a;try{const l=this.turfHelper.getCoords(i);if(!l||l.length===0)return{success:!1,error:"Invalid polygon coordinates"};const g=((a=(r=this.config.menuOperations)==null?void 0:r.simplify)==null?void 0:a.processHoles)??!0,m=l.map(x=>{const v=[];for(let P=0;P<x.length;P++){const I=x[P];if(P===0||g){if(I.length<=4){v.push(I);continue}const O=[];for(let j=0;j<I.length;j+=2)O.push(I[j]);const R=O[0],W=O[O.length-1];(R[0]!==W[0]||R[1]!==W[1])&&O.push(R),O.length<4?v.push(I):v.push(O)}else v.push(I)}return v}),d=this.turfHelper.getMultiPolygon(m);return{success:!0,result:this.turfHelper.getTurfPolygon(d)}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Unknown error in simplifyPolygon"}}}convertToBoundingBox(i){var r,a;try{const l=this.turfHelper.getCoords(i);if(!l||l.length===0)return{success:!1,error:"Invalid polygon coordinates"};if(!(((a=(r=this.config.menuOperations)==null?void 0:r.bbox)==null?void 0:a.processHoles)??!0)){const x=this.turfHelper.convertToBoundingBoxPolygon(i);return{success:!0,result:this.turfHelper.getTurfPolygon(x)}}const m=l.map(x=>{const v=[];for(let P=0;P<x.length;P++){const I=x[P];let b=1/0,O=-1/0,R=1/0,W=-1/0;for(const j of I)if(Array.isArray(j)&&j.length>=2){const st=j[0],M=j[1];typeof st=="number"&&typeof M=="number"&&!isNaN(st)&&!isNaN(M)&&(R=Math.min(R,st),W=Math.max(W,st),b=Math.min(b,M),O=Math.max(O,M))}if(b!==1/0&&O!==-1/0&&R!==1/0&&W!==-1/0){const j=[[R,b],[R,O],[W,O],[W,b],[R,b]];v.push(j)}else v.push(I)}return v}),d=this.turfHelper.getMultiPolygon(m);return{success:!0,result:this.turfHelper.getTurfPolygon(d)}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Unknown error in convertToBoundingBox"}}}bezierifyPolygon(i){try{const r=this.turfHelper.getCoords(i),a=this.turfHelper.getBezierMultiPolygon(r);return{success:!0,result:this.turfHelper.getTurfPolygon(a)}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown error in bezierifyPolygon"}}}doubleElbowsPolygon(i){var r,a;try{const l=this.turfHelper.getCoords(i);if(!l||l.length===0)return{success:!1,error:"Invalid polygon coordinates"};const g=((a=(r=this.config.menuOperations)==null?void 0:r.doubleElbows)==null?void 0:a.processHoles)??!0,m=l.map(x=>{const v=[];for(let P=0;P<x.length;P++){const I=x[P];if(P===0||g){const O=I.map(j=>({lat:j[1],lng:j[0]})),W=this.turfHelper.getDoubleElbowLatLngs(O).map(j=>[j.lng,j.lat]);v.push(W)}else v.push(I)}return v}),d=this.turfHelper.getMultiPolygon(m);return{success:!0,result:this.turfHelper.getTurfPolygon(d)}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Unknown error in doubleElbowsPolygon"}}}}class cg{static createDivIcon(i){const r=i.join(" ");return lt.divIcon({className:r})}}class fg{constructor(i,r){at(this,"markerFeatureGroupMap",new WeakMap),at(this,"markerModifierHandlers",new WeakMap),at(this,"_activeMarker",null),at(this,"isDraggingMarker",!1),at(this,"turfHelper"),at(this,"polygonInformation"),at(this,"map"),at(this,"config"),at(this,"modeManager"),at(this,"eventManager"),at(this,"currentDragPolygon",null),at(this,"currentModifierDragMode",!1),at(this,"isModifierKeyHeld",!1),at(this,"_openMenuPopup",null),at(this,"getFeatureGroups"),at(this,"removeFeatureGroup"),at(this,"onPolygonMouseMove",a=>{if(!this.currentDragPolygon||!this.currentDragPolygon._polydrawDragData||!this.currentDragPolygon._polydrawDragData.isDragging)return;const l=this.currentDragPolygon,g=l._polydrawDragData,m=a.originalEvent&&"metaKey"in a.originalEvent?a.originalEvent:a;this.detectDragSubtractModifierKey(m)!==this.currentModifierDragMode&&this.handleModifierToggleDuringDrag(m);const x=g.startPosition,v=a.latlng,P=v.lat-x.lat,I=v.lng-x.lng,b=this.offsetPolygonCoordinates(g.startLatLngs,P,I);l.setLatLngs(b),this.updateMarkersAndHoleLinesDuringDrag(l,P,I)}),at(this,"onPolygonMouseUp",a=>{if(!this.currentDragPolygon||!this.currentDragPolygon._polydrawDragData||!this.currentDragPolygon._polydrawDragData.isDragging)return;const l=this.currentDragPolygon,g=l._polydrawDragData;g.isDragging=!1,this.map.off("mousemove",this.onPolygonMouseMove,this),this.map.off("mouseup",this.onPolygonMouseUp,this),this.map.dragging&&this.map.dragging.enable(),l._polydrawDragData&&l._polydrawDragData.originalOpacity!=null&&l.setStyle({fillOpacity:l._polydrawDragData.originalOpacity}),this.setMarkerVisibility(l,!0);try{const m=this.map.getContainer();m.style.cursor=""}catch{}this.updatePolygonAfterDrag(l),l._polydrawOriginalMarkerPositions&&(l._polydrawOriginalMarkerPositions.clear(),delete l._polydrawOriginalMarkerPositions),l._polydrawOriginalHoleLinePositions&&(l._polydrawOriginalHoleLinePositions.clear(),delete l._polydrawOriginalHoleLinePositions),l._polydrawCurrentDragSession&&delete l._polydrawCurrentDragSession,this.currentDragPolygon=null}),at(this,"onMarkerHoverForEdgeDeletionEvent",a=>{if(!this.isModifierKeyHeld)return;const l=a.target;l&&(l.style.backgroundColor=this.config.colors.edgeDeletion.hover,l.style.borderColor=this.config.colors.edgeDeletion.hover,l.classList.add("edge-deletion-hover"))}),at(this,"onMarkerLeaveForEdgeDeletionEvent",a=>{const l=a.target;l&&(l.style.backgroundColor="",l.style.borderColor="",l.classList.remove("edge-deletion-hover"))}),this.turfHelper=i.turfHelper,this.polygonInformation=i.polygonInformation,this.map=i.map,this.config=i.config,this.modeManager=i.modeManager,this.eventManager=i.eventManager,this.getFeatureGroups=r.getFeatureGroups,this.removeFeatureGroup=r.removeFeatureGroup}addMarkers(i,r){let a=this.getMarkerIndex(i,this.config.markers.markerMenuIcon.position),l=this.getMarkerIndex(i,this.config.markers.markerDeleteIcon.position),g=this.getMarkerIndex(i,this.config.markers.markerInfoIcon.position);const m=this.ensureMarkerSeparation(i.length,{menu:{index:a,enabled:this.config.markers.menuMarker},delete:{index:l,enabled:this.config.markers.deleteMarker},info:{index:g,enabled:this.config.markers.infoMarker}});a=m.menu,l=m.delete,g=m.info,i.forEach((x,v)=>{let P=this.config.markers.markerIcon.styleClasses;v===a&&this.config.markers.menuMarker&&(P=this.config.markers.markerMenuIcon.styleClasses),v===l&&this.config.markers.deleteMarker&&(P=this.config.markers.markerDeleteIcon.styleClasses),v===g&&this.config.markers.infoMarker&&(P=this.config.markers.markerInfoIcon.styleClasses);const I=Array.isArray(P)?P:[P],b=v===a&&this.config.markers.menuMarker||v===l&&this.config.markers.deleteMarker||v===g&&this.config.markers.infoMarker,O=new lt.Marker(x,{icon:this.createDivIcon(I),draggable:this.config.modes.dragElbow,title:this.config.markers.coordsTitle?this.getLatLngInfoString(x):"",zIndexOffset:this.config.markers.markerIcon.zIndexOffset??this.config.markers.zIndexOffset});r.addLayer(O).addTo(this.map),this.markerFeatureGroupMap.set(O,r),O.on("add",()=>{const W=O.getElement();W&&(W.style.pointerEvents="auto")}),O.on("click",W=>{var j,st;this.isDraggingMarker&&((st=(j=W.originalEvent)==null?void 0:j.stopPropagation)==null||st.call(j),lt.DomEvent.stopPropagation(W))}),O.on("dragstart",()=>{this.isDraggingMarker=!0,this._activeMarker=O}),O.on("dragend",W=>{const j=this.markerFeatureGroupMap.get(O);this.modeManager.canPerformAction("markerDrag")&&j&&this.markerDragEnd(j),this._activeMarker=null,lt.DomEvent.stopPropagation(W),setTimeout(()=>{this.isDraggingMarker=!1},10)});const R=O.getElement();if(R&&(R.addEventListener("touchstart",W=>{W.stopPropagation()},{passive:!0}),R.addEventListener("touchend",W=>{if(W.preventDefault(),W.stopPropagation(),O.fire("click"),this.isDraggingMarker&&!b){const j=this.markerFeatureGroupMap.get(O);this.modeManager.canPerformAction("markerDrag")&&j&&this.markerDragEnd(j)}this._activeMarker=null})),v===a||v===l||v===g){const W=O.getElement();W&&(W.style.zIndex="10000")}if(this.config.modes.dragElbow){const W=j=>()=>{this.modeManager.canPerformAction("markerDrag")&&this.markerDrag(j)};O.on("drag",W(r))}if(v===a&&this.config.markers.menuMarker&&(O.options.zIndexOffset=this.config.markers.markerMenuIcon.zIndexOffset??this.config.markers.zIndexOffset,O.on("click",()=>{const W=this.getPolygonGeoJSONFromFeatureGroup(r),j=Si.getCenterOfMass(W);this.generateMenuMarkerPopup(i,r).setLatLng(j).openOn(this.map)}),O.on("popupopen",W=>{const st=W.popup.getElement();if(!st)return;setTimeout(()=>{const A=this.map.getContainer().getBoundingClientRect(),F=st.getBoundingClientRect();F.left<A.left?st.style.transform=`translateX(${A.left-F.left}px)`:F.right>A.right&&(st.style.transform=`translateX(${A.right-F.right}px)`)},0);const M=this.map.getContainer();M&&(M.style.touchAction="manipulation")}),O.on("popupclose",()=>{const W=this.map.getContainer();W&&(W.style.touchAction="")})),v===g&&this.config.markers.infoMarker){const W=this.getPolygonGeoJSONFromFeatureGroup(r),j=this.turfHelper.getPolygonArea(W),st=this.getTotalPolygonPerimeter(W);O.options.zIndexOffset=this.config.markers.markerInfoIcon.zIndexOffset??this.config.markers.zIndexOffset,O.on("click",()=>{const M=this.generateInfoMarkerPopup(j,st),q=Si.getCenterOfMass(W);M.setLatLng(q).openOn(this.map)}),O.on("popupopen",M=>{const A=M.popup.getElement();if(!A)return;setTimeout(()=>{const K=this.map.getContainer().getBoundingClientRect(),E=A.getBoundingClientRect();E.left<K.left?A.style.transform=`translateX(${K.left-E.left}px)`:E.right>K.right&&(A.style.transform=`translateX(${K.right-E.right}px)`)},0);const F=this.map.getContainer();F&&(F.style.touchAction="manipulation")}),O.on("popupclose",()=>{const M=this.map.getContainer();M&&(M.style.touchAction="")})}O.on("mousedown",W=>{this.modeManager.isInOffMode()||(lt.DomEvent.stopPropagation(W),this.map.fire("mousedown",W)),this._activeMarker=O}),O.on("click",W=>{if(this.modeManager.isInOffMode())if(this.isEdgeDeletionModifierKeyPressed(W.originalEvent)){const j=r.getLayers().find(st=>st instanceof lt.Polygon);j&&this.elbowClicked(W,j,O.getLatLng())}else v===l&&this.config.markers.deleteMarker&&(this.map.closePopup(),this.removeFeatureGroup(r),this.polygonInformation.createPolygonInformationStorage(this.getFeatureGroups()),this.eventManager.emit("polydraw:polygon:deleted",void 0))}),O.on("mouseover",()=>this.onMarkerHoverForEdgeDeletion(O,!0)),O.on("mouseout",()=>this.onMarkerHoverForEdgeDeletion(O,!1))});const d=this.map.getContainer();d&&(d.style.touchAction="manipulation")}addHoleMarkers(i,r){var a,l,g;const m=((a=this.config.markers.holeMarkers)==null?void 0:a.menuMarker)??!1,d=((l=this.config.markers.holeMarkers)==null?void 0:l.deleteMarker)??!1,x=((g=this.config.markers.holeMarkers)==null?void 0:g.infoMarker)??!1;let v=this.getMarkerIndex(i,this.config.markers.markerMenuIcon.position),P=this.getMarkerIndex(i,this.config.markers.markerDeleteIcon.position),I=this.getMarkerIndex(i,this.config.markers.markerInfoIcon.position);const b=this.ensureMarkerSeparation(i.length,{menu:{index:v,enabled:m},delete:{index:P,enabled:d},info:{index:I,enabled:x}});v=b.menu,P=b.delete,I=b.info,i.forEach((O,R)=>{let W=this.config.markers.holeIcon.styleClasses;R===v&&m&&(W=this.config.markers.markerMenuIcon.styleClasses),R===P&&d&&(W=this.config.markers.markerDeleteIcon.styleClasses),R===I&&x&&(W=this.config.markers.markerInfoIcon.styleClasses);const j=Array.isArray(W)?W:[W],st=R===v&&m||R===P&&d||R===I&&x,M=new lt.Marker(O,{icon:this.createDivIcon(j),draggable:this.config.modes.dragElbow,title:this.config.markers.coordsTitle?this.getLatLngInfoString(O):"",zIndexOffset:this.config.markers.holeIcon.zIndexOffset??this.config.markers.zIndexOffset});r.addLayer(M).addTo(this.map),this.markerFeatureGroupMap.set(M,r),M.on("add",()=>{const A=M.getElement();A&&(A.style.pointerEvents="auto")}),M.on("click",A=>{var F,H;this.isDraggingMarker&&((H=(F=A.originalEvent)==null?void 0:F.stopPropagation)==null||H.call(F),lt.DomEvent.stopPropagation(A))}),M.on("dragstart",()=>{this.isDraggingMarker=!0,this._activeMarker=M}),M.on("dragend",A=>{const F=this.markerFeatureGroupMap.get(M);this.modeManager.canPerformAction("markerDrag")&&F&&this.markerDragEnd(F),this._activeMarker=null,lt.DomEvent.stopPropagation(A),setTimeout(()=>{this.isDraggingMarker=!1},10)});const q=M.getElement();if(q&&(q.addEventListener("touchstart",A=>{A.stopPropagation()},{passive:!0}),q.addEventListener("touchend",A=>{if(A.preventDefault(),A.stopPropagation(),M.fire("click"),this.isDraggingMarker&&!st){const F=this.markerFeatureGroupMap.get(M);this.modeManager.canPerformAction("markerDrag")&&F&&this.markerDragEnd(F)}this._activeMarker=null})),R===v||R===P||R===I){const A=M.getElement();A&&(A.style.zIndex="10000")}if(this.config.modes.dragElbow){const A=F=>()=>{this.modeManager.canPerformAction("markerDrag")&&this.markerDrag(F)};M.on("drag",A(r))}if(R===v&&m&&(M.options.zIndexOffset=this.config.markers.markerMenuIcon.zIndexOffset??this.config.markers.zIndexOffset,M.on("click",()=>{const A=i.map(E=>[E.lng,E.lat]);A.push(A[0]);const F={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[A]}},H=Si.getCenterOfMass(F);this.generateMenuMarkerPopup(i,r).setLatLng(H).openOn(this.map)}),M.on("popupopen",A=>{const H=A.popup.getElement();if(!H)return;setTimeout(()=>{const S=this.map.getContainer().getBoundingClientRect(),N=H.getBoundingClientRect();N.left<S.left?H.style.transform=`translateX(${S.left-N.left}px)`:N.right>S.right&&(H.style.transform=`translateX(${S.right-N.right}px)`)},0);const K=this.map.getContainer();K&&(K.style.touchAction="manipulation")}),M.on("popupclose",()=>{const A=this.map.getContainer();A&&(A.style.touchAction="")})),R===I&&x){const A=i.map(E=>[E.lng,E.lat]);A.push(A[0]);const F={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[A]}},H=this.turfHelper.getPolygonArea(F),K=this.turfHelper.getPolygonPerimeter(F)*1e3;M.options.zIndexOffset=this.config.markers.markerInfoIcon.zIndexOffset??this.config.markers.zIndexOffset,M.on("click",()=>{this.generateInfoMarkerPopup(H,K).setLatLng(O).openOn(this.map)})}M.on("mousedown",A=>{this.modeManager.isInOffMode()||(lt.DomEvent.stopPropagation(A),this.map.fire("mousedown",A)),this._activeMarker=M}),M.on("click",A=>{if(this.modeManager.isInOffMode()){if(this.isEdgeDeletionModifierKeyPressed(A.originalEvent)){const F=r.getLayers().find(H=>H instanceof lt.Polygon);F&&this.elbowClicked(A,F,M.getLatLng())}else if(R===P&&d){this.map.closePopup();const F=r.getLayers().find(H=>H instanceof lt.Polygon);if(F){const H=F.getLatLngs();let K=[];if(Array.isArray(H)&&H.length>0)if(Array.isArray(H[0])){const N=H[0];Array.isArray(N)&&Array.isArray(N[0])?K=H[0]:K=H}else K=[H];const E=M.getLatLng();let S=-1;for(let N=1;N<K.length;N++)if(K[N].some(B=>B.lat===E.lat&&B.lng===E.lng)){S=N;break}if(S>0){const B=K.filter((V,Z)=>Z!==S).map(V=>{const Z=V.map(U=>[U.lng,U.lat]);if(Z.length>0){const U=Z[0],G=Z[Z.length-1];(U[0]!==G[0]||U[1]!==G[1])&&Z.push([U[0],U[1]])}return Z}),D=this.turfHelper.getMultiPolygon([B]);this.removeFeatureGroup(r),this.eventManager.emit("polydraw:polygon:updated",{operation:"removeHole",polygon:D})}}}}}),M.on("mouseover",()=>this.onMarkerHoverForEdgeDeletion(M,!0)),M.on("mouseout",()=>this.onMarkerHoverForEdgeDeletion(M,!1))})}addEdgeClickListeners(i,r){const a=i.getLatLngs();let l;if(Array.isArray(a)&&a.length>0)if(Array.isArray(a[0]))if(Array.isArray(a[0][0])&&a[0][0].length>0){const g=a[0][0][0];g&&typeof g=="object"&&"lat"in g,l=a[0]}else a[0][0]&&typeof a[0][0]=="object"&&"lat"in a[0][0]?l=a:l=a[0];else a[0]&&typeof a[0]=="object"&&"lat"in a[0]?l=[a]:l=[a];else return;l.forEach((g,m)=>{for(let d=0;d<g.length;d++){const x=g[d],v=g[(d+1)%g.length];if(x.lat===v.lat&&x.lng===v.lng)continue;const P=lt.polyline([x,v],{color:"transparent",weight:10,opacity:0,interactive:!0});P._polydrawEdgeInfo={ringIndex:m,edgeIndex:d,startPoint:x,endPoint:v,parentPolygon:i,parentFeatureGroup:r},P.on("click",I=>{this.onEdgeClick(I,P)}),P.on("mouseover",()=>{this.highlightEdgeOnHover(P,!0)}),P.on("mouseout",()=>{this.highlightEdgeOnHover(P,!1)}),r.addLayer(P)}})}enablePolygonDragging(i,r){this.config.modes.dragPolygons&&(i._polydrawOriginalLatLngs=r,i._polydrawDragData={isDragging:!1,startPosition:null,startLatLngs:null,originalOpacity:i.options.fillOpacity},i.on("mousedown",a=>{if(!this.modeManager.isInOffMode()){lt.DomEvent.stopPropagation(a),this.map.fire("mousedown",a);return}if(!this.modeManager.canPerformAction("polygonDrag"))return;lt.DomEvent.stopPropagation(a.originalEvent),lt.DomEvent.preventDefault(a.originalEvent);const l=this.detectDragSubtractModifierKey(a.originalEvent);this.currentModifierDragMode=l,this.isModifierKeyHeld=l,i._polydrawDragData.isDragging=!0,i._polydrawDragData.startPosition=a.latlng,i._polydrawDragData.startLatLngs=i.getLatLngs(),i.setStyle({fillOpacity:this.config.dragPolygons.opacity}),this.map.dragging&&this.map.dragging.disable(),this.setSubtractVisualMode(i,l),this.setMarkerVisibility(i,!1);try{const g=this.map.getContainer();g.style.cursor=this.config.dragPolygons.dragCursor||"move"}catch{}this.map.on("mousemove",this.onPolygonMouseMove,this),this.map.on("mouseup",this.onPolygonMouseUp,this),this.currentDragPolygon=i}),i.on("mouseover",()=>{if(!i._polydrawDragData||!i._polydrawDragData.isDragging)try{const a=this.map.getContainer();a.style.cursor=this.config.dragPolygons.hoverCursor||"grab"}catch{}}),i.on("mouseout",()=>{if(!i._polydrawDragData||!i._polydrawDragData.isDragging)try{const a=this.map.getContainer();a.style.cursor=""}catch{}}))}updateMarkerDraggableState(){const i=this.modeManager.canPerformAction("markerDrag");this.getFeatureGroups().forEach(r=>{r.eachLayer(a=>{if(a instanceof lt.Marker){const l=a;try{l.options.draggable=i,l.dragging&&(i?l.dragging.enable():l.dragging.disable())}catch{}}})})}updateAllMarkersForEdgeDeletion(i){this.getFeatureGroups().forEach(r=>{r.eachLayer(a=>{a instanceof lt.Marker&&this.updateMarkerForEdgeDeletion(a,i)})})}updateMarkerForEdgeDeletion(i,r){const a=i.getElement();a&&(r?(a.addEventListener("mouseenter",this.onMarkerHoverForEdgeDeletionEvent),a.addEventListener("mouseleave",this.onMarkerLeaveForEdgeDeletionEvent)):(a.removeEventListener("mouseenter",this.onMarkerHoverForEdgeDeletionEvent),a.removeEventListener("mouseleave",this.onMarkerLeaveForEdgeDeletionEvent),a.style.backgroundColor="",a.style.borderColor=""))}setModifierKeyHeld(i){this.isModifierKeyHeld=i}onEdgeClick(i,r){if(!this.config.modes.attachElbow||!this.modeManager.isInOffMode())return;const a=r._polydrawEdgeInfo;if(!a)return;const l=i.latlng,g=a.parentPolygon,m=a.parentFeatureGroup;if(g&&m)try{if(typeof g.toGeoJSON!="function")return;const d=g.toGeoJSON();if(d.geometry.type==="MultiPolygon"||d.geometry.type==="Polygon"){const x=this.turfHelper.injectPointToPolygon(d,[l.lng,l.lat],a.ringIndex);if(x){const P=g._polydrawOptimizationLevel||0;this.removeFeatureGroup(m),this.eventManager.emit("polydraw:polygon:updated",{operation:"addVertex",polygon:x,optimizationLevel:P})}}}catch{}lt.DomEvent.stopPropagation(i)}highlightEdgeOnHover(i,r){r?i.setStyle({color:this.config.colors.edgeHover,weight:4,opacity:1}):i.setStyle({color:"transparent",weight:10,opacity:0})}elbowClicked(i,r,a){if(!this.config.modes.edgeDeletion||!this.isEdgeDeletionModifierKeyPressed(i.originalEvent))return;const l=a??i.latlng,g=r.getLatLngs();let m=[];if(Array.isArray(g)&&g.length>0)if(Array.isArray(g[0])){const R=g[0];Array.isArray(R)&&Array.isArray(R[0])?m=g[0]:m=g}else m=[g];else return;let d=-1,x=-1;for(let R=0;R<m.length;R++){const W=m[R];for(let j=0;j<W.length;j++){const st=W[j];if(st.lat===l.lat&&st.lng===l.lng){d=R,x=j;break}}if(d!==-1)break}if(d===-1||x===-1||m[d].length<=this.config.edgeDeletion.minVertices)return;const I=m.map((R,W)=>{if(W!==d)return R.slice();const j=R.slice();return j.splice(x,1),j}).map(R=>{const W=R.map(j=>[j.lng,j.lat]);if(W.length>0){const j=W[0],st=W[W.length-1];(j[0]!==st[0]||j[1]!==st[1])&&W.push([j[0],j[1]])}return W});let b=null;for(const R of this.getFeatureGroups()){let W=!1;if(R.eachLayer(j=>{j===r&&(W=!0)}),W){b=R;break}}b&&this.removeFeatureGroup(b);const O=this.turfHelper.getMultiPolygon([I]);this.eventManager.emit("polydraw:polygon:updated",{operation:"removeVertex",polygon:O})}markerDrag(i){if(!this._activeMarker){Xt()||console.warn("No active marker set for dragging.");return}const r=[];let a=[],l=[];const g=i.getLayers(),m=g.find(P=>P instanceof lt.Polygon);if(!m){Xt()||console.warn("No polygon found in feature group for marker drag.");return}const d=m.getLatLngs();let x=0;const v=g.filter(P=>P instanceof lt.Marker);if(d.length>1)for(let P=0;P<d.length;P++)if(a=[],l=[],P===0){if(d[0].length>1)for(let I=0;I<d[0].length;I++){for(let b=0;b<d[0][I].length;b++)v[b]&&a.push(v[b].getLatLng());l.push(a)}else{for(let I=0;I<d[0][0].length;I++)v[I]&&a.push(v[I].getLatLng());l.push(a)}r.push(l)}else{x+=d[P-1].length;for(let I=x;I<d[P][0].length+x;I++)v[I]&&a.push(v[I].getLatLng());l.push(a),r.push(l)}else{l=[];let P=0;for(let I=0;I<d[0].length;I++){if(a=[],I===0)if(d[0][I].length>1)for(let b=0;b<d[0][I].length;b++)v[b]&&a.push(v[b].getLatLng());else for(let b=0;b<d[0][0].length;b++)v[b]&&a.push(v[b].getLatLng());else{P+=d[0][I-1].length;for(let b=P;b<d[0][I].length+P;b++)v[b]&&a.push(v[b].getLatLng())}l.push(a)}r.push(l)}m.setLatLngs(r)}async markerDragEnd(i){this.polygonInformation.deletePolygonInformationStorage();const r=i.toGeoJSON();if(!(!r.features||r.features.length===0)){if(this.removeFeatureGroup(i),r.features[0].geometry.type==="MultiPolygon")for(const a of r.features[0].geometry.coordinates){const l=this.turfHelper.getMultiPolygon([a]);if(this.turfHelper.hasKinks(l)){const g=this.turfHelper.getKinks(l);for(const m of g)this.eventManager.emit("polydraw:polygon:updated",{operation:"markerDrag",polygon:this.turfHelper.getTurfPolygon(m),allowMerge:!0,intelligentMerge:!0})}else this.eventManager.emit("polydraw:polygon:updated",{operation:"markerDrag",polygon:l,allowMerge:!0,intelligentMerge:!0})}else{const a=this.turfHelper.getMultiPolygon([r.features[0].geometry.coordinates]);if(this.turfHelper.hasKinks(a)){const l=this.turfHelper.getKinks(a);for(const g of l)this.eventManager.emit("polydraw:polygon:updated",{operation:"markerDrag",polygon:this.turfHelper.getTurfPolygon(g),allowMerge:!1})}else this.eventManager.emit("polydraw:polygon:updated",{operation:"markerDrag",polygon:a,allowMerge:!1})}this.polygonInformation.createPolygonInformationStorage(this.getFeatureGroups())}}offsetPolygonCoordinates(i,r,a){return i&&(Array.isArray(i[0])?i.map(l=>this.offsetPolygonCoordinates(l,r,a)):i.map(l=>lt.latLng(l.lat+r,l.lng+a)))}updateMarkersAndHoleLinesDuringDrag(i,r,a){try{let l=null;for(const m of this.getFeatureGroups()){let d=!1;if(m.eachLayer(x=>{x===i&&(d=!0)}),d){l=m;break}}if(!l)return;const g="_polydrawDragSession_"+Date.now()+"_"+lt.Util.stamp(i);i._polydrawCurrentDragSession||(i._polydrawCurrentDragSession=g,i._polydrawOriginalMarkerPositions=new Map,i._polydrawOriginalHoleLinePositions=new Map,l.eachLayer(m=>{if(m instanceof lt.Marker)i._polydrawOriginalMarkerPositions.set(m,m.getLatLng());else if(m instanceof lt.Polyline&&!(m instanceof lt.Polygon)){const d=m.getLatLngs();i._polydrawOriginalHoleLinePositions.set(m,d)}})),l.eachLayer(m=>{if(m instanceof lt.Marker){const d=i._polydrawOriginalMarkerPositions.get(m);if(d){const x={lat:d.lat+r,lng:d.lng+a};m.setLatLng(x)}}else if(m instanceof lt.Polyline&&!(m instanceof lt.Polygon)){const d=i._polydrawOriginalHoleLinePositions.get(m);if(d){let x;Array.isArray(d[0])?x=d.map(v=>v.map(P=>lt.latLng(P.lat+r,P.lng+a))):x=d.map(v=>lt.latLng(v.lat+r,v.lng+a)),m.setLatLngs(x)}}})}catch(l){console.warn("Error updating markers during drag:",l)}}async updatePolygonAfterDrag(i){try{let r=null;for(const g of this.getFeatureGroups())if(g.eachLayer(m=>{m===i&&(r=g)}),r)break;if(!r)return;const a=i.toGeoJSON();if(this.isModifierDragActive()){this.performModifierSubtract(a,r),this.currentModifierDragMode=!1,this.isModifierKeyHeld=!1;return}this.removeFeatureGroup(r);const l=this.turfHelper.getTurfPolygon(a);this.eventManager.emit("polydraw:polygon:updated",{operation:"polygonDrag",polygon:l,allowMerge:!0}),this.polygonInformation.createPolygonInformationStorage(this.getFeatureGroups())}catch{}}getDragSubtractModifierKey(){const{keys:i}=this.config.dragPolygons.modifierSubtract,r=navigator.userAgent.toLowerCase(),a=r.includes("mac"),l=r.includes("windows");return a&&i.mac?i.mac:l&&i.windows?i.windows:i.linux?i.linux:a?"metaKey":"ctrlKey"}detectDragSubtractModifierKey(i){if(sa())return!1;const r=this.getDragSubtractModifierKey();return i[r]||!1}setSubtractVisualMode(i,r){if(!(!i||!i.setStyle))try{r?i.setStyle({color:this.config.colors.dragPolygons.subtract}):i.setStyle({color:this.config.colors.polygon.border}),this.updateMarkerColorsForSubtractMode(i,r)}catch{}}updateMarkerColorsForSubtractMode(i,r){try{let a=null;for(const m of this.getFeatureGroups())if(m.eachLayer(d=>{d===i&&(a=m)}),a)break;if(!a)return;const l=a,g=this.config.dragPolygons.modifierSubtract.hideMarkersOnDrag;l.eachLayer(m=>{if(m instanceof lt.Marker){const x=m.getElement();x&&(r?g?(x.style.display="none",x.classList.add("subtract-mode-hidden")):(x.style.backgroundColor=this.config.colors.dragPolygons.subtract,x.style.borderColor=this.config.colors.dragPolygons.subtract,x.classList.add("subtract-mode")):g?(x.style.display="",x.classList.remove("subtract-mode-hidden")):(x.style.backgroundColor="",x.style.borderColor="",x.classList.remove("subtract-mode")))}})}catch{}}handleModifierToggleDuringDrag(i){const r=this.detectDragSubtractModifierKey(i);this.currentModifierDragMode=r,this.isModifierKeyHeld=r,this.currentDragPolygon&&this.setSubtractVisualMode(this.currentDragPolygon,r)}isModifierDragActive(){return this.currentModifierDragMode}performModifierSubtract(i,r){try{const a=this.turfHelper.getTurfPolygon(i),l=[];this.getFeatureGroups().forEach(g=>{if(g!==r)try{const m=g.toGeoJSON();if(!m||!m.features||!m.features[0])return;const d=m.features[0];if(!d.geometry||!d.geometry.coordinates)return;const x=this.turfHelper.getTurfPolygon(d);try{const v=this.turfHelper.getIntersection(x,a);v&&v.geometry&&"coordinates"in v.geometry&&v.geometry.coordinates.length>0&&l.push(g)}catch{try{this.turfHelper.polygonIntersect(x,a)&&l.push(g)}catch{}}}catch{}}),this.removeFeatureGroup(r),l.forEach(g=>{try{const m=g.toGeoJSON(),d=this.turfHelper.getTurfPolygon(m.features[0]);this.removeFeatureGroup(g);try{const x=this.turfHelper.polygonDifference(d,a);if(x&&x.geometry){const v=this.turfHelper.getCoords(x);for(const P of v){const I=this.turfHelper.getMultiPolygon([P]);this.eventManager.emit("polydraw:polygon:updated",{operation:"modifierSubtract",polygon:this.turfHelper.getTurfPolygon(I),allowMerge:!1})}}}catch(x){Xt()||console.warn("Failed to perform difference operation:",x),this.eventManager.emit("polydraw:polygon:updated",{operation:"modifierSubtractFallback",polygon:d,allowMerge:!1})}}catch(m){Xt()||console.warn("Error in modifier subtract operation:",m)}}),this.polygonInformation.createPolygonInformationStorage(this.getFeatureGroups())}catch(a){Xt()||console.warn("Error in performModifierSubtract:",a)}}getEdgeDeletionModifierKey(){const{keys:i}=this.config.edgeDeletion,r=navigator.userAgent.toLowerCase(),a=r.includes("mac"),l=r.includes("windows");return a&&i.mac?i.mac:l&&i.windows?i.windows:i.linux?i.linux:a?"metaKey":"ctrlKey"}isEdgeDeletionModifierKeyPressed(i){if(sa())return!1;const r=this.getEdgeDeletionModifierKey();return!!i[r]}onMarkerHoverForEdgeDeletion(i,r){const a=i.getElement();if(a)if(r){const l=m=>{if(this.isEdgeDeletionModifierKeyPressed(m)){a.style.backgroundColor=this.config.colors.edgeDeletion.hover,a.style.borderColor=this.config.colors.edgeDeletion.hover,a.classList.add("edge-deletion-hover");try{const x=this.map.getContainer();x.style.cursor="pointer"}catch{}}else{a.style.backgroundColor="",a.style.borderColor="",a.classList.remove("edge-deletion-hover");try{const x=this.map.getContainer();x.style.cursor=""}catch{}}},g=new MouseEvent("mouseover");l(g),this.markerModifierHandlers.set(i,l),document.addEventListener("keydown",l),document.addEventListener("keyup",l),a.addEventListener("mousemove",l)}else{a.style.backgroundColor="",a.style.borderColor="",a.classList.remove("edge-deletion-hover");try{const g=this.map.getContainer();g.style.cursor=""}catch{}const l=this.markerModifierHandlers.get(i);l&&(document.removeEventListener("keydown",l),document.removeEventListener("keyup",l),a.removeEventListener("mousemove",l),this.markerModifierHandlers.delete(i))}}getMarkerIndex(i,r){const a=Qf.getBounds(i,Math.sqrt(2)/2),g=new tg(a.getSouth(),a.getWest(),a.getNorth(),a.getEast()).getDirection(r),m={lat:g.lat,lng:g.lng},d=this.turfHelper.getCoord(m),x=this.turfHelper.getFeaturePointCollection(i);return this.turfHelper.getNearestPointIndex(d,x)}ensureMarkerSeparation(i,r){const a=[];if(r.menu.enabled&&a.push({type:"menu",index:r.menu.index}),r.delete.enabled&&a.push({type:"delete",index:r.delete.index}),r.info.enabled&&a.push({type:"info",index:r.info.index}),a.length<2)return{menu:r.menu.index,delete:r.delete.index,info:r.info.index};const l={...r},g=new Set,m=["info","delete","menu"];for(const d of m){const x=l[d];if(x.enabled)if(g.has(x.index)){const v=this.findAlternativeMarkerPosition(i,x.index,g);l[d].index=v,g.add(v)}else g.add(x.index)}return{menu:l.menu.index,delete:l.delete.index,info:l.info.index}}findAlternativeMarkerPosition(i,r,a){const l=i,g=Math.max(1,Math.floor(i/8));for(let m=1;m<l;m++){const d=[(r+m*g)%i,(r-m*g+i)%i];for(const x of d)if(!a.has(x))return x}for(let m=0;m<i;m++)if(!a.has(m))return m;return r}createDivIcon(i){return cg.createDivIcon(i)}getLatLngInfoString(i){return"Latitude: "+i.lat+" Longitude: "+i.lng}setMarkerVisibility(i,r){const a=this.getFeatureGroups().find(l=>l.hasLayer(i));a&&a.eachLayer(l=>{if(l instanceof lt.Marker){const m=l.getElement();if(m){const d=this.config.dragPolygons.markerBehavior,x=this.config.dragPolygons.markerAnimationDuration;d==="hide"?m.style.display=r?"":"none":d==="fade"&&(m.style.transition=`opacity ${x}ms ease`,m.style.opacity=r?"1":"0")}}})}generateMenuMarkerPopup(i,r){const a=document.createElement("div");a.classList.add("alter-marker-outer-wrapper");const l=document.createElement("div");l.classList.add("alter-marker-wrapper");const g=document.createElement("div");g.classList.add("content");const m=document.createElement("div");m.classList.add("marker-menu-content");const d=document.createElement("div");d.classList.add("marker-menu-button","simplify"),d.title="Simplify";const x=document.createElement("div");x.classList.add("marker-menu-button","double-elbows"),x.title="DoubleElbows";const v=document.createElement("div");v.classList.add("marker-menu-button","bbox"),v.title="Bounding box";const P=document.createElement("div");P.classList.add("marker-menu-button","bezier"),P.title="Curve";const I=document.createElement("span");I.classList.add("alpha-banner"),I.textContent="ALPHA",P.appendChild(I);const b=document.createElement("div");b.classList.add("separator"),a.appendChild(l),l.appendChild(g),g.appendChild(m),m.appendChild(d),m.appendChild(b.cloneNode()),m.appendChild(x),m.appendChild(b.cloneNode()),m.appendChild(v),m.appendChild(b.cloneNode()),m.appendChild(P);const O=()=>{this._openMenuPopup&&(this.map.closePopup(this._openMenuPopup),this._openMenuPopup=null)};d.addEventListener("touchend",j=>{j.preventDefault(),j.stopPropagation(),this.eventManager.emit("polydraw:menu:action",{action:"simplify",latLngs:i,featureGroup:r}),O()}),d.onclick=()=>{this.eventManager.emit("polydraw:menu:action",{action:"simplify",latLngs:i,featureGroup:r}),O()},v.addEventListener("touchend",j=>{j.preventDefault(),j.stopPropagation(),this.eventManager.emit("polydraw:menu:action",{action:"bbox",latLngs:i,featureGroup:r}),O()}),v.onclick=()=>{this.eventManager.emit("polydraw:menu:action",{action:"bbox",latLngs:i,featureGroup:r}),O()},x.addEventListener("touchend",j=>{j.preventDefault(),j.stopPropagation(),this.eventManager.emit("polydraw:menu:action",{action:"doubleElbows",latLngs:i,featureGroup:r}),O()}),x.onclick=()=>{this.eventManager.emit("polydraw:menu:action",{action:"doubleElbows",latLngs:i,featureGroup:r}),O()},P.addEventListener("touchend",j=>{j.preventDefault(),j.stopPropagation(),this.eventManager.emit("polydraw:menu:action",{action:"bezier",latLngs:i,featureGroup:r}),O()}),P.onclick=()=>{this.eventManager.emit("polydraw:menu:action",{action:"bezier",latLngs:i,featureGroup:r}),O()},lt.DomEvent.disableClickPropagation(a),a.style.pointerEvents="auto",a.querySelectorAll(".marker-menu-button").forEach(j=>{j.style.pointerEvents="auto",j.addEventListener("click",st=>st.stopPropagation())});const R=window.innerWidth<=600,W=lt.popup({closeButton:!0,autoClose:!0,className:`menu-popup${R?" mobile-popup":""}`}).setContent(a);return this._openMenuPopup=W,W}getPolygonGeoJSONFromFeatureGroup(i){try{const r=i.getLayers().find(a=>a instanceof lt.Polygon);if(!r)throw new Error("No polygon found in feature group");return r.toGeoJSON()}catch(r){return Xt()||(r instanceof Error?console.warn("Error getting polygon GeoJSON from feature group:",r.message):console.warn("Error getting polygon GeoJSON from feature group:",r)),{type:"Feature",geometry:{type:"Polygon",coordinates:[[[0,0],[0,1],[1,1],[1,0],[0,0]]]},properties:{}}}}getTotalPolygonPerimeter(i){try{if(!i||!i.geometry)return 0;let r=0;if(i.geometry.type==="Polygon"){const a=i.geometry.coordinates;for(const l of a){const g={type:"Feature",geometry:{type:"Polygon",coordinates:[l]},properties:{}},m=this.turfHelper.getPolygonPerimeter(g);r+=m}}else if(i.geometry.type==="MultiPolygon"){const a=i.geometry.coordinates;for(const l of a)for(const g of l){const m={type:"Feature",geometry:{type:"Polygon",coordinates:[g]},properties:{}},d=this.turfHelper.getPolygonPerimeter(m);r+=d}}return r*1e3}catch(r){return Xt()||(r instanceof Error?console.warn("Error calculating total polygon perimeter:",r.message):console.warn("Error calculating total polygon perimeter:",r)),this.turfHelper.getPolygonPerimeter(i)*1e3}}generateInfoMarkerPopup(i,r){const a=new eg(r,this.config),l=new ng(i,this.config),g=document.createElement("div");g.classList.add("info-marker-outer-wrapper");const m=document.createElement("div");m.classList.add("info-marker-wrapper");const d=document.createElement("div");d.classList.add("content");const x=document.createElement("div");x.classList.add("info-marker-content");const v=document.createElement("div");v.classList.add("info-item","area"),v.innerHTML=`<strong>Area:</strong> ${l.metricArea} ${l.metricUnit}`;const P=document.createElement("div");P.classList.add("info-item","perimeter"),P.innerHTML=`<strong>Perimeter:</strong> ${a.metricLength} ${a.metricUnit}`,x.appendChild(v),x.appendChild(P),d.appendChild(x),g.appendChild(m),m.appendChild(d),lt.DomEvent.disableClickPropagation(g),g.style.pointerEvents="auto",g.querySelectorAll("button").forEach(O=>{O.style.pointerEvents="auto",O.addEventListener("click",R=>R.stopPropagation())});const I=window.innerWidth<=600;return lt.popup({closeButton:!0,autoClose:!0,className:`info-popup${I?" mobile-popup":""}`}).setContent(g)}}class gg{constructor(i){at(this,"turfHelper"),at(this,"map"),at(this,"config"),at(this,"eventManager"),at(this,"getFeatureGroups"),at(this,"geometryManager"),at(this,"interactionManager"),this.turfHelper=i.turfHelper,this.map=i.map,this.config=i.config,this.eventManager=i.eventManager,this.getFeatureGroups=i.getFeatureGroups,this.initializeSpecializedManagers(i)}initializeSpecializedManagers(i){this.geometryManager=new hg({turfHelper:i.turfHelper,config:i.config}),this.interactionManager=new fg({turfHelper:i.turfHelper,polygonInformation:i.polygonInformation,map:i.map,config:i.config,modeManager:i.modeManager,eventManager:this.eventManager},{getFeatureGroups:this.getFeatureGroups,addFeatureGroup:r=>this.addFeatureGroupInternal(r),removeFeatureGroup:r=>this.removeFeatureGroupInternal(r)}),this.setupEventForwarding()}setupEventForwarding(){this.eventManager.on("polydraw:draw:cancel",i=>{this.emit("drawCancelled",i)}),this.eventManager.on("polydraw:polygon:updated",i=>{this.handlePolygonModified(i)}),this.eventManager.on("polydraw:menu:action",i=>{this.handleMenuAction(i)}),this.eventManager.on("polydraw:check:intersection",i=>{const r=this.geometryManager.checkPolygonIntersection(i.polygon1,i.polygon2);i.callback(r)}),this.eventManager.on("polydraw:subtract",i=>{this.subtractPolygon(i.subtractPolygon)}),this.eventManager.on("polydraw:polygon:deleted",()=>{this.emit("polygonDeleted",void 0)})}async handlePolygonModified(i){const r=i.operation!=="addVertex"&&i.operation!=="markerDrag"&&i.operation!=="polygonDrag";let a=i.allowMerge;i.intelligentMerge&&i.operation==="markerDrag"&&(a=this.shouldAllowIntelligentMerge(i.polygon));const l={simplify:r,noMerge:!a,visualOptimizationLevel:i.optimizationLevel||0};await this.addPolygon(i.polygon,l)}async handleMenuAction(i){const r=this.getCompletePolygonFromFeatureGroup(i.featureGroup);this.removeFeatureGroupInternal(i.featureGroup);let a;switch(i.action){case"simplify":{a=this.geometryManager.simplifyPolygon(r);break}case"bbox":{a=this.geometryManager.convertToBoundingBox(r);break}case"doubleElbows":{a=this.geometryManager.doubleElbowsPolygon(r);break}case"bezier":{a=this.geometryManager.bezierifyPolygon(r);break}default:return}a.success&&a.result&&await this.addPolygon(a.result,{simplify:!1})}get polygonInteractionManager(){return this.interactionManager}on(i,r){this.eventManager.on(i,r)}emit(i,r){this.eventManager.emit(i,r)}async addPolygon(i,r={}){const{noMerge:a=!1}=r;try{return this.isPolygonInsideExistingHole(i)?await this.addPolygonLayer(i,r):this.config.mergePolygons&&!a&&this.getFeatureGroups().length>0&&!this.config.kinks?await this.mergePolygon(i,r):await this.addPolygonLayer(i,r)}catch(l){return{success:!1,error:l instanceof Error?l.message:"Unknown error in addPolygon"}}}async subtractPolygon(i){try{const r=[];this.getFeatureGroups().forEach(l=>{try{const g=l.toGeoJSON();if(!g||!g.features||!g.features[0])return;const m=g.features[0];if(!m.geometry||!m.geometry.coordinates)return;const d=this.turfHelper.getTurfPolygon(m);this.geometryManager.checkPolygonIntersection(d,i)&&r.push(l)}catch{}});const a=[];for(const l of r)try{const g=l.toGeoJSON(),m=this.turfHelper.getTurfPolygon(g.features[0]),d=this.geometryManager.subtractPolygon(m,i);if(this.removeFeatureGroupInternal(l),d.success&&d.results)for(const x of d.results){const v=await this.addPolygonLayer(x,{simplify:!0});v.success&&v.featureGroups&&a.push(...v.featureGroups)}}catch{}return this.emit("polygonSubtracted",{subtractedPolygon:i,affectedFeatureGroups:r,resultFeatureGroups:a}),this.emit("polygonOperationComplete",{operation:"subtract",polygon:i,resultFeatureGroups:a}),{success:!0,featureGroups:a}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown error in subtractPolygon"}}}async addPolygonLayer(i,r={}){const{simplify:a=!0,dynamicTolerance:l=!1,visualOptimizationLevel:g=0}=r;try{if(!i||!i.geometry||!i.geometry.coordinates)return{success:!1,error:"Invalid polygon data"};const m=new lt.FeatureGroup,d=a?this.turfHelper.getSimplified(i,l):i;let x;try{if(x=this.getPolygon(d),!x)return{success:!1,error:"Failed to create polygon"};x._polydrawOptimizationLevel=g,m.addLayer(x)}catch{return{success:!1,error:"Failed to create polygon layer"}}let v;try{const P=x.getLatLngs();v=this.normalizePolygonCoordinates(P)}catch{v=[]}try{v.forEach((P,I)=>{if(!P||!Array.isArray(P))return;const b=[];if(P.forEach(O=>{Array.isArray(O)&&O.length>=2?b.push({lat:O[1],lng:O[0]}):typeof O=="object"&&O!==null&&"lat"in O&&"lng"in O&&b.push(O)}),b.length!==0)try{if(I===0)this.interactionManager.addMarkers(b,m);else{const O=lt.polyline(b,{color:this.config.colors.hole.border,weight:this.config.holeOptions.weight||2,opacity:this.config.holeOptions.opacity||1,fillColor:this.config.colors.hole.fill,fillOpacity:this.config.holeOptions.fillOpacity||.5});m.addLayer(O),this.interactionManager.addHoleMarkers(b,m)}}catch{}})}catch{}try{this.interactionManager.addEdgeClickListeners(x,m)}catch{}this.getFeatureGroups().push(m);try{m.addTo(this.map)}catch{}return this.emit("polygonAdded",{polygon:d,featureGroup:m}),this.emit("polygonOperationComplete",{operation:"add",polygon:d,featureGroup:m}),{success:!0,featureGroups:[m]}}catch(m){return{success:!1,error:m instanceof Error?m.message:"Unknown error in addPolygonLayer"}}}async mergePolygon(i,r={}){try{const a=[],l=[];let g=!1;return this.getFeatureGroups().forEach(m=>{try{const d=m.toGeoJSON();if(!d||!d.features||!d.features[0])return;const x=d.features[0];if(!x.geometry||!x.geometry.coordinates)return;if(this.isPositionArrayofArrays(x.geometry.coordinates))x.geometry.coordinates.forEach(v=>{try{const P=this.turfHelper.getMultiPolygon([v]);g=this.geometryManager.checkPolygonIntersection(P,i),g&&(l.push(m),a.push(P))}catch{}});else try{const v=this.turfHelper.getTurfPolygon(x);g=this.geometryManager.checkPolygonIntersection(v,i),g&&(l.push(m),a.push(v))}catch{}}catch{}}),l.length>0?await this.unionPolygons(l,i,a,r):await this.addPolygonLayer(i,r)}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error in mergePolygon"}}}async unionPolygons(i,r,a,l={}){try{i.forEach(m=>{this.removeFeatureGroupInternal(m)});const g=this.geometryManager.unionPolygons(a,r);if(g.success&&g.result){const m=await this.addPolygonLayer(g.result,l);return this.emit("polygonsUnioned",{originalPolygons:a,resultPolygon:g.result,featureGroups:m.featureGroups}),m}else return{success:!1,error:g.error||"Failed to union polygons"}}catch(g){return{success:!1,error:g instanceof Error?g.message:"Unknown error in unionPolygons"}}}shouldAllowIntelligentMerge(i){try{for(const r of this.getFeatureGroups())try{const a=r.toGeoJSON();if(!a||!a.features||!a.features[0])continue;const l=a.features[0];if(!l.geometry||!l.geometry.coordinates)continue;const g=this.turfHelper.getTurfPolygon(l);if(this.geometryManager.checkPolygonIntersection(g,i))return!0}catch{continue}return!1}catch{return!1}}isPolygonInsideExistingHole(i){try{for(const r of this.getFeatureGroups())try{const a=r.toGeoJSON();if(!a||!a.features||!a.features[0])continue;const l=a.features[0];if(!l.geometry||!l.geometry.coordinates)continue;let g=!1,m=[];if(l.geometry.type==="Polygon")g=l.geometry.coordinates.length>1,g&&(m=l.geometry.coordinates.slice(1));else if(l.geometry.type==="MultiPolygon")for(const d of l.geometry.coordinates)d.length>1&&(g=!0,m.push(...d.slice(1)));if(g&&m.length>0)for(const d of m)try{const x=this.turfHelper.createPolygon([d]);if(this.turfHelper.isPolygonCompletelyWithin(i,x))return!0}catch{continue}}catch{continue}return!1}catch{return!1}}normalizePolygonCoordinates(i){if(!Array.isArray(i)||i.length===0)return[];const r=l=>l!==null&&typeof l=="object"&&"lat"in l&&"lng"in l&&typeof l.lat=="number"&&typeof l.lng=="number",a=l=>{if(!Array.isArray(l))return[];if(l.length>0&&r(l[0]))return[l];const g=[];for(const m of l)if(Array.isArray(m))if(m.length>0&&r(m[0]))g.push(m);else{const d=a(m);g.push(...d)}return g};try{return a(i)}catch{return[]}}isPositionArrayofArrays(i){if(!Array.isArray(i)||i.length===0)return!1;const r=i[0];if(!Array.isArray(r)||r.length===0)return!1;const a=r[0];if(!Array.isArray(a)||a.length===0)return!1;const l=a[0];return this.isPosition(l)}isPosition(i){return Array.isArray(i)&&i.length>=2&&i.every(r=>typeof r=="number")}getPolygon(i){const r=lt.GeoJSON.geometryToLayer(i),a={...this.config.polygonOptions,color:this.config.colors.polygon.border,fillColor:this.config.colors.polygon.fill,weight:this.config.polygonOptions.weight||2,opacity:this.config.polygonOptions.opacity||1,fillOpacity:this.config.polygonOptions.fillOpacity||.2};return r.setStyle(a),r._polydrawUniqueId=lt.Util.stamp(r)+"_"+Date.now(),delete r._polydrawDragData,delete r._polydrawOriginalLatLngs,delete r._polydrawCurrentDragSession,delete r._polydrawOriginalMarkerPositions,delete r._polydrawOriginalHoleLinePositions,this.config.modes.dragPolygons&&this.interactionManager.enablePolygonDragging(r,i),r}addFeatureGroupInternal(i){this.getFeatureGroups().push(i)}removeFeatureGroupInternal(i){i.clearLayers();const r=this.getFeatureGroups(),a=r.indexOf(i);a>-1&&r.splice(a,1),this.map.removeLayer(i)}getCompletePolygonFromFeatureGroup(i){try{let r=null;if(i.eachLayer(a=>{a instanceof lt.Polygon&&(r=a)}),!r)throw new Error("No polygon found in feature group");return r.toGeoJSON()}catch(r){return Xt()||r instanceof Error&&console.warn("Error getting complete polygon GeoJSON from feature group:",r.message),{type:"Feature",geometry:{type:"Polygon",coordinates:[[[0,0],[0,1],[1,1],[1,0],[0,0]]]},properties:{}}}}updateMarkerDraggableState(){this.interactionManager.updateMarkerDraggableState()}updateAllMarkersForEdgeDeletion(i){this.interactionManager.updateAllMarkersForEdgeDeletion(i)}setModifierKeyHeld(i){this.interactionManager.setModifierKeyHeld(i)}checkPolygonIntersection(i,r){return this.geometryManager.checkPolygonIntersection(i,r)}getPolygonCenter(i){try{if(!i||!i.geometry||!i.geometry.coordinates)return null;let r;if(i.geometry.type==="Polygon")r=i.geometry.coordinates[0];else if(i.geometry.type==="MultiPolygon")r=i.geometry.coordinates[0][0];else return null;if(!Array.isArray(r)||r.length===0)return null;let a=0,l=0,g=0;for(const m of r)if(Array.isArray(m)&&m.length>=2){const d=m[0],x=m[1];typeof d=="number"&&typeof x=="number"&&!isNaN(d)&&!isNaN(x)&&(l+=d,a+=x,g++)}return g===0?null:{lat:a/g,lng:l/g}}catch{return null}}getBoundingBox(i){try{if(!i||!i.geometry||!i.geometry.coordinates)return null;let r;if(i.geometry.type==="Polygon")r=i.geometry.coordinates[0];else if(i.geometry.type==="MultiPolygon")r=i.geometry.coordinates[0][0];else return null;if(!Array.isArray(r)||r.length===0)return null;let a=1/0,l=-1/0,g=1/0,m=-1/0;for(const d of r)if(Array.isArray(d)&&d.length>=2){const x=d[0],v=d[1];typeof x=="number"&&typeof v=="number"&&!isNaN(x)&&!isNaN(v)&&(g=Math.min(g,x),m=Math.max(m,x),a=Math.min(a,v),l=Math.max(l,v))}return a===1/0||l===-1/0||g===1/0||m===-1/0?null:{minLat:a,maxLat:l,minLng:g,maxLng:m}}catch{return null}}addMarker(i,r){this.interactionManager.addMarkers(i,r)}addHoleMarker(i,r){this.interactionManager.addHoleMarkers(i,r)}addEdgeClickListeners(i,r){this.interactionManager.addEdgeClickListeners(i,r)}enablePolygonDragging(i,r){this.interactionManager.enablePolygonDragging(i,r)}getMarkerIndex(i,r){return 0}ensureMarkerSeparation(i,r){var a,l,g;return{menu:((a=r.menu)==null?void 0:a.index)??0,delete:((l=r.delete)==null?void 0:l.index)??1,info:((g=r.info)==null?void 0:g.index)??2}}findAlternativeMarkerPosition(i,r,a){return(r+1)%i}createDivIcon(i){return lt.divIcon({className:i.join(" ")})}getLatLngInfoString(i){return"Latitude: "+i.lat+" Longitude: "+i.lng}generateMenuMarkerPopup(i,r){const a=document.createElement("div");return a.innerHTML="Menu",a}getPolygonGeoJSONFromFeatureGroup(i){return{type:"Feature",geometry:{type:"Polygon",coordinates:[[[0,0],[0,1],[1,1],[1,0],[0,0]]]},properties:{}}}getTotalPolygonPerimeter(i){return 1e3}generateInfoMarkerPopup(i,r){const a=document.createElement("div");return a.innerHTML=`Area: ${i}, Perimeter: ${r}`,a}onMarkerHoverForEdgeDeletion(i,r){}highlightEdgeOnHover(i,r){}onEdgeClick(i,r){}removeFeatureGroup(i){this.removeFeatureGroupInternal(i)}onPolygonMouseMove(i){}onPolygonMouseUp(i){}updatePolygonAfterDrag(i){}setSubtractVisualMode(i,r){}performModifierSubtract(i,r){try{const a=this.turfHelper.getTurfPolygon(i),l=[];this.getFeatureGroups().forEach(g=>{if(g!==r)try{const m=g.toGeoJSON();if(!m||!m.features||!m.features[0])return;const d=m.features[0];if(!d.geometry||!d.geometry.coordinates)return;const x=this.turfHelper.getTurfPolygon(d);this.geometryManager.checkPolygonIntersection(x,a)&&l.push(g)}catch{}}),this.removeFeatureGroupInternal(r),l.forEach(g=>{try{const m=g.toGeoJSON(),d=this.turfHelper.getTurfPolygon(m.features[0]);this.removeFeatureGroupInternal(g);const x=this.geometryManager.subtractPolygon(d,a);if(x.success&&x.results)for(const v of x.results)this.addPolygonLayer(v,{simplify:!0})}catch{}})}catch{}}}function dg(h){const i=document.createElement("style");i.innerHTML=`
    .leaflet-control a { background-color: ${h.colors.styles.controlButton.backgroundColor}; color: ${h.colors.styles.controlButton.color}; display: flex; align-items: center; justify-content: center; }
    .leaflet-control a:hover { background-color: ${h.colors.styles.controlButtonHover.backgroundColor}; }
    .leaflet-control a.active { background-color: ${h.colors.styles.controlButtonActive.backgroundColor}; color: ${h.colors.styles.controlButtonActive.color}; }
    .polydraw-indicator-active { background-color: ${h.colors.styles.indicatorActive.backgroundColor} !important; }
    .crosshair-cursor-enabled { cursor: crosshair !important; }
    .crosshair-cursor-enabled * { cursor: crosshair !important; }
    .leaflet-polydraw-p2p-marker { background-color: ${h.colors.styles.p2pMarker.backgroundColor}; border: 2px solid ${h.colors.styles.p2pMarker.borderColor}; border-radius: 50%; box-sizing: border-box; }
    .leaflet-polydraw-p2p-first-marker { position: relative; }
    .leaflet-polydraw-p2p-first-marker:hover { transform: scale(1.5); transition: all 0.2s ease; }
  `,document.head.appendChild(i)}class dl extends lt.Control{constructor(i){super(i),at(this,"map"),at(this,"tracer"),at(this,"turfHelper"),at(this,"subContainer"),at(this,"config"),at(this,"mapStateService"),at(this,"eventManager"),at(this,"polygonInformation"),at(this,"modeManager"),at(this,"polygonDrawManager"),at(this,"polygonMutationManager"),at(this,"arrayOfFeatureGroups",[]),at(this,"drawMode",Ft.Off),at(this,"drawModeListeners",[]),at(this,"_boundKeyDownHandler"),at(this,"_boundKeyUpHandler"),at(this,"isModifierKeyHeld",!1),at(this,"_boundTouchMove"),at(this,"_boundTouchEnd"),at(this,"_boundTouchStart"),at(this,"_handleActivateToggle",()=>{const r=this.getContainer();if(!r)return;const a=r.querySelector(".icon-activate");lt.DomUtil.hasClass(a,"active")?(lt.DomUtil.removeClass(a,"active"),this.subContainer&&(this.subContainer.style.maxHeight="0px")):(lt.DomUtil.addClass(a,"active"),this.subContainer&&(this.subContainer.style.maxHeight="250px")),this.updateActivateButtonIndicator()}),at(this,"_handleDrawClick",r=>{if(r&&(r.preventDefault(),r.stopPropagation()),this.modeManager.getCurrentMode()===Ft.Add){this.setDrawMode(Ft.Off);return}this.setDrawMode(Ft.Add),this.polygonInformation.saveCurrentState()}),at(this,"_handleSubtractClick",r=>{if(r&&(r.preventDefault(),r.stopPropagation()),this.modeManager.getCurrentMode()===Ft.Subtract){this.setDrawMode(Ft.Off);return}this.setDrawMode(Ft.Subtract),this.polygonInformation.saveCurrentState()}),at(this,"_handleEraseClick",r=>{this.map.closePopup(),r&&(r.preventDefault(),r.stopPropagation()),this.arrayOfFeatureGroups.length!==0&&this.removeAllFeatureGroups()}),at(this,"_handlePointToPointClick",r=>{if(r&&(r.preventDefault(),r.stopPropagation()),this.modeManager.getCurrentMode()===Ft.PointToPoint){this.setDrawMode(Ft.Off);return}this.setDrawMode(Ft.PointToPoint),this.polygonInformation.saveCurrentState()}),at(this,"onMarkerHoverForEdgeDeletionEvent",r=>{if(!this.isModifierKeyHeld)return;const a=r.target;a&&(a.style.backgroundColor=this.config.colors.edgeDeletion.hover,a.style.borderColor=this.config.colors.edgeDeletion.hover,a.classList.add("edge-deletion-hover"))}),at(this,"onMarkerLeaveForEdgeDeletionEvent",r=>{const a=r.target;a&&(a.style.backgroundColor="",a.style.borderColor="",a.classList.remove("edge-deletion-hover"))}),this.config=Li,i!=null&&i.configPath?this.loadExternalConfig(i.configPath,i==null?void 0:i.config):(this.config={...Li,...(i==null?void 0:i.config)||{}},this.initializeComponents())}onAdd(i){const r=i,a=lt.Browser;r._onResize=()=>{},a.touch&&a.mobile&&(r.tap=!1),this.map=i,this.setupKeyboardHandlers();const l=lt.DomUtil.create("div","leaflet-control leaflet-bar");return this.initializeUI(l),this.createTracer(),this.initializeManagers(),this.setupEventListeners(),l}onRemove(i){this.removeKeyboardHandlers(),this.tracer&&this.map.removeLayer(this.tracer),this.removeAllFeatureGroups()}addTo(i){return super.addTo(i),this}getFeatureGroups(){return this.arrayOfFeatureGroups}async addPredefinedPolygon(i,r){if(!i||i.length===0)throw new Error("Cannot add empty polygon array");if(!this.map)throw new Error("Map not initialized");if(!this.polygonMutationManager)throw new Error("PolygonMutationManager not initialized");const a=(r==null?void 0:r.visualOptimizationLevel)??0;for(const[l,g]of i.entries()){if(!g||!g[0]||g[0].length<4)throw new Error(`Invalid polygon data at index ${l}: A polygon must have at least 3 unique vertices.`);try{const m=g.map(v=>v.map(P=>[P.lng,P.lat])),d=this.turfHelper.getMultiPolygon([m]),x=await this.polygonMutationManager.addPolygon(d,{simplify:!1,noMerge:!1,visualOptimizationLevel:a});if(!x.success)throw console.error("Error adding polygon via manager:",x.error),new Error(x.error||"Failed to add polygon");this.polygonInformation.createPolygonInformationStorage(this.arrayOfFeatureGroups)}catch(m){throw console.error("Error adding auto polygon:",m),m}}}setDrawMode(i){const r=this.drawMode;this._updateDrawModeState(i),r===Ft.PointToPoint&&i!==Ft.PointToPoint?(this.polygonDrawManager.clearP2pMarkers(),this.stopDraw()):i===Ft.Off?this.stopDraw():i!==Ft.PointToPoint&&this.stopDraw(),this.map&&(this._updateUIAfterDrawModeChange(i),this._updateMapInteractions())}getDrawMode(){return this.modeManager.getCurrentMode()}on(i,r){this.eventManager.on(i,r)}off(i,r){this.eventManager.off(i,r)}removeAllFeatureGroups(){this.arrayOfFeatureGroups.forEach(i=>{try{this.map.removeLayer(i)}catch{}}),this.arrayOfFeatureGroups.length=0,this.polygonInformation.deletePolygonInformationStorage(),this.polygonInformation.updatePolygons(),this.updateActivateButtonIndicator()}initializeUI(i){dg(this.config),lt.DomEvent.disableClickPropagation(i),lt.DomEvent.on(i,"mousedown",lt.DomEvent.stopPropagation),lt.DomEvent.on(i,"touchstart",lt.DomEvent.stopPropagation),lt.DomEvent.on(i,"click",lt.DomEvent.stopPropagation),i.style.display="flex",i.style.flexDirection="column-reverse",i.style.pointerEvents="auto",i.style.position="relative",i.style.zIndex="1000",this.subContainer=lt.DomUtil.create("div","sub-buttons",i),this.subContainer.style.maxHeight="0px",this.subContainer.style.overflow="hidden",this.subContainer.style.transition="max-height 0.3s ease",this.subContainer.style.pointerEvents="auto",this.subContainer.style.position="relative",ig(i,this.subContainer,this.config,this._handleActivateToggle,this._handleDrawClick,this._handleSubtractClick,this._handleEraseClick,this._handlePointToPointClick),this.ensureButtonTouchResponsiveness(i);const r=a=>{const l=i.querySelector(".icon-draw"),g=i.querySelector(".icon-subtract");l&&l.classList.toggle("active",a===Ft.Add),g&&g.classList.toggle("active",a===Ft.Subtract)};this.drawModeListeners.push(r)}setupEventListeners(){this.polygonMutationManager.on("polygonOperationComplete",()=>{this.updateActivateButtonIndicator(),this.modeManager.updateStateForMode(Ft.Off),this.drawMode=Ft.Off,this.emitDrawModeChanged(),this.updateMarkerDraggableState();const i=this.modeManager.shouldShowCrosshairCursor(),r=this.modeManager.canPerformAction("mapDrag"),a=this.modeManager.canPerformAction("mapZoom"),l=this.modeManager.canPerformAction("mapDoubleClickZoom");i?lt.DomUtil.addClass(this.map.getContainer(),"crosshair-cursor-enabled"):lt.DomUtil.removeClass(this.map.getContainer(),"crosshair-cursor-enabled"),this.events(!1),this.setLeafletMapEvents(r,l,a);try{this.tracer.setStyle({color:""})}catch{}}),this.polygonMutationManager.on("polygonDeleted",()=>{this.updateActivateButtonIndicator()}),this.eventManager.on("polydraw:polygon:created",async i=>{this.stopDraw(),i.isPointToPoint?await this.polygonMutationManager.addPolygon(i.polygon,{simplify:!1,noMerge:!1}):await this.handleFreehandDrawCompletion(i.polygon),this.polygonInformation.createPolygonInformationStorage(this.arrayOfFeatureGroups)}),this.eventManager.on("polydraw:draw:cancel",()=>{this.stopDraw(),this.setDrawMode(Ft.Off)})}createTracer(){this.tracer=lt.polyline([],{...this.config.polyLineOptions,color:this.config.colors.polyline});try{this.tracer.addTo(this.map)}catch{}}initializeManagers(){this.polygonDrawManager=new lg({turfHelper:this.turfHelper,map:this.map,config:this.config,modeManager:this.modeManager,eventManager:this.eventManager,tracer:this.tracer}),this.polygonMutationManager=new gg({turfHelper:this.turfHelper,polygonInformation:this.polygonInformation,map:this.map,config:this.config,modeManager:this.modeManager,eventManager:this.eventManager,getFeatureGroups:()=>this.arrayOfFeatureGroups})}async loadExternalConfig(i,r){try{const a=await fetch(i);if(!a.ok)throw new Error(`Failed to load config from ${i}: ${a.status} ${a.statusText}`);const l=await a.json();this.config={...Li,...l,...r||{}},this.initializeComponents()}catch(a){console.warn("Failed to load external config, falling back to default + inline config:",a),this.config={...Li,...r||{}},this.initializeComponents()}}_updateDrawModeState(i){this.drawMode=i,this.modeManager.updateStateForMode(i),this.emitDrawModeChanged(),this.updateMarkerDraggableState()}_updateUIAfterDrawModeChange(i){this.modeManager.shouldShowCrosshairCursor()?lt.DomUtil.addClass(this.map.getContainer(),"crosshair-cursor-enabled"):lt.DomUtil.removeClass(this.map.getContainer(),"crosshair-cursor-enabled");try{switch(i){case Ft.Off:this.tracer.setStyle({color:""});break;case Ft.Add:this.tracer.setStyle({color:this.config.colors.polyline,dashArray:void 0});break;case Ft.Subtract:this.tracer.setStyle({color:this.config.colors.subtractLine,dashArray:void 0});break;case Ft.PointToPoint:this.tracer.setStyle({color:this.config.colors.polyline,dashArray:"5, 5"});break}}catch{}}_updateMapInteractions(){const i=this.modeManager.canPerformAction("mapDrag"),r=this.modeManager.canPerformAction("mapZoom"),a=this.modeManager.canPerformAction("mapDoubleClickZoom");this.events(this.drawMode!==Ft.Off),this.setLeafletMapEvents(i,a,r)}initializeComponents(){this.turfHelper=new gl(this.config),this.mapStateService=new og,this.eventManager=new ag,this.polygonInformation=new sg(this.mapStateService),this.modeManager=new ug(this.config,this.eventManager),this.polygonInformation.onPolygonInfoUpdated(i=>{this.updateActivateButtonIndicator()}),this._boundKeyDownHandler=this.handleKeyDown.bind(this)}emitDrawModeChanged(){this.eventManager.emit("polydraw:mode:change",{mode:this.modeManager.getCurrentMode()});for(const i of this.drawModeListeners)i(this.modeManager.getCurrentMode())}updateMarkerDraggableState(){const i=this.modeManager.canPerformAction("markerDrag");this.arrayOfFeatureGroups.forEach(r=>{r.eachLayer(a=>{if(a instanceof lt.Marker){const l=a;try{l.options.draggable=i,l.dragging&&(i?l.dragging.enable():l.dragging.disable())}catch{}}})})}stopDraw(){this.resetTracker(),this.drawStartedEvents(!1)}setLeafletMapEvents(i,r,a){i?this.map.dragging.enable():this.map.dragging.disable(),r?this.map.doubleClickZoom.enable():this.map.doubleClickZoom.disable(),a?this.map.scrollWheelZoom.enable():this.map.scrollWheelZoom.disable()}resetTracker(){this.tracer.setLatLngs([])}drawStartedEvents(i){const r=i?"on":"off";this.map[r]("mousemove",this.mouseMove,this),this.map[r]("mouseup",this.mouseUpLeave,this),i?(this._boundTouchMove=a=>this.mouseMove(a),this._boundTouchEnd=a=>this.mouseUpLeave(a),this.map.getContainer().addEventListener("touchmove",this._boundTouchMove,{passive:!1}),this.map.getContainer().addEventListener("touchend",this._boundTouchEnd,{passive:!1})):(this._boundTouchMove&&this.map.getContainer().removeEventListener("touchmove",this._boundTouchMove),this._boundTouchEnd&&this.map.getContainer().removeEventListener("touchend",this._boundTouchEnd))}events(i){const r=i?"on":"off";this.map[r]("mousedown",this.mouseDown,this),this.map[r]("dblclick",this.handleDoubleClick,this),i?(this._boundTouchStart=a=>this.mouseDown(a),this.map.getContainer().addEventListener("touchstart",this._boundTouchStart,{passive:!1})):this._boundTouchStart&&this.map.getContainer().removeEventListener("touchstart",this._boundTouchStart)}mouseDown(i){if("cancelable"in i&&i.cancelable&&i.preventDefault(),this.modeManager.isInOffMode())return;let r;if("latlng"in i&&i.latlng)r=i.latlng;else if("touches"in i&&i.touches&&i.touches.length>0){const a=this.map.getContainer().getBoundingClientRect();r=this.map.containerPointToLatLng([i.touches[0].clientX-a.x,i.touches[0].clientY-a.y])}if(r){if(this.modeManager.getCurrentMode()===Ft.PointToPoint){this.polygonDrawManager.handlePointToPointClick(r);return}this.tracer.setLatLngs([r]),this.startDraw()}}mouseMove(i){if("cancelable"in i&&i.cancelable&&i.preventDefault(),"latlng"in i&&i.latlng)this.tracer.addLatLng(i.latlng);else if("touches"in i&&i.touches&&i.touches.length>0){const r=this.map.getContainer().getBoundingClientRect(),a=this.map.containerPointToLatLng([i.touches[0].clientX-r.x,i.touches[0].clientY-r.y]);this.tracer.addLatLng(a)}}async mouseUpLeave(i){"cancelable"in i&&i.cancelable&&i.preventDefault(),this.polygonInformation.deletePolygonInformationStorage();const r=this.tracer.toGeoJSON();if(!r||!r.geometry||!r.geometry.coordinates||r.geometry.coordinates.length<3){this.stopDraw();return}let a;try{a=this.turfHelper.createPolygonFromTrace(r)}catch{this.stopDraw();return}if(!a||!a.geometry||!a.geometry.coordinates||a.geometry.coordinates.length===0){this.stopDraw();return}this.stopDraw();try{switch(this.modeManager.getCurrentMode()){case Ft.Add:{const l=await this.polygonMutationManager.addPolygon(a,{simplify:!0,noMerge:!1});l.success||console.error("Error adding polygon via manager:",l.error);break}case Ft.Subtract:{const l=await this.polygonMutationManager.subtractPolygon(a);l.success||console.error("Error subtracting polygon via manager:",l.error);break}default:break}}catch(l){console.error("Error in mouseUpLeave polygon operation:",l)}this.polygonInformation.createPolygonInformationStorage(this.arrayOfFeatureGroups)}async handleFreehandDrawCompletion(i){try{switch(this.modeManager.getCurrentMode()){case Ft.Add:{const r=await this.polygonMutationManager.addPolygon(i,{simplify:!0,noMerge:!1});r.success||console.error("Error adding polygon via manager:",r.error);break}case Ft.Subtract:{const r=await this.polygonMutationManager.subtractPolygon(i);r.success||console.error("Error subtracting polygon via manager:",r.error);break}default:break}}catch(r){console.error("Error in mouseUpLeave polygon operation:",r)}}startDraw(){this.drawStartedEvents(!0)}setupKeyboardHandlers(){this._boundKeyUpHandler=this.handleKeyUp.bind(this),document.addEventListener("keydown",this._boundKeyDownHandler),document.addEventListener("keyup",this._boundKeyUpHandler)}removeKeyboardHandlers(){document.removeEventListener("keydown",this._boundKeyDownHandler),document.removeEventListener("keyup",this._boundKeyUpHandler)}handleKeyDown(i){i.key==="Escape"&&this.modeManager.getCurrentMode()===Ft.PointToPoint&&this.polygonDrawManager.cancelPointToPointDrawing(),this.isModifierKeyPressed(i)&&!this.isModifierKeyHeld&&(this.isModifierKeyHeld=!0,this.polygonDrawManager.setModifierKey(!0),this.updateAllMarkersForEdgeDeletion(!0))}handleKeyUp(i){!this.isModifierKeyPressed(i)&&this.isModifierKeyHeld&&(this.isModifierKeyHeld=!1,this.polygonDrawManager.setModifierKey(!1),this.updateAllMarkersForEdgeDeletion(!1))}updateAllMarkersForEdgeDeletion(i){this.arrayOfFeatureGroups.forEach(r=>{r.eachLayer(a=>{a instanceof lt.Marker&&this.updateMarkerForEdgeDeletion(a,i)})})}updateMarkerForEdgeDeletion(i,r){const a=i.getElement();a&&(r?(a.addEventListener("mouseenter",this.onMarkerHoverForEdgeDeletionEvent),a.addEventListener("mouseleave",this.onMarkerLeaveForEdgeDeletionEvent)):(a.removeEventListener("mouseenter",this.onMarkerHoverForEdgeDeletionEvent),a.removeEventListener("mouseleave",this.onMarkerLeaveForEdgeDeletionEvent),a.style.backgroundColor="",a.style.borderColor=""))}handleDoubleClick(i){this.modeManager.getCurrentMode()===Ft.PointToPoint&&this.polygonDrawManager.handleDoubleClick(i)}isModifierKeyPressed(i){return navigator.userAgent.toLowerCase().includes("mac")?i.metaKey:i.ctrlKey}ensureButtonTouchResponsiveness(i){i.querySelectorAll("a").forEach(a=>{a.style.pointerEvents="auto",a.style.touchAction="manipulation",a.style.position="relative",a.style.zIndex="1";const l=g=>{g.stopPropagation(),g.target.style.pointerEvents="auto"};a.addEventListener("touchstart",l,{passive:!0}),a.addEventListener("touchend",l,{passive:!0})})}updateActivateButtonIndicator(){if(typeof this.getContainer!="function")return;const i=this.getContainer();if(!i)return;const r=i.querySelector(".icon-activate");if(!r)return;const a=this.arrayOfFeatureGroups.length>0,l=!lt.DomUtil.hasClass(r,"active");a&&l?lt.DomUtil.addClass(r,"polydraw-indicator-active"):lt.DomUtil.removeClass(r,"polydraw-indicator-active")}}lt.control.polydraw=function(h){return new dl(h)};const ml=lt.map("map").setView([58.4108,15.6214],13);lt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'<span>&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors</span>'}).addTo(ml);const mg=new dl;mg.addTo(ml);
