function Al(h,n){for(var r=0;r<n.length;r++){const o=n[r];if(typeof o!="string"&&!Array.isArray(o)){for(const u in o)if(u!=="default"&&!(u in h)){const f=Object.getOwnPropertyDescriptor(o,u);f&&Object.defineProperty(h,u,f.get?f:{enumerable:!0,get:()=>o[u]})}}}return Object.freeze(Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))o(u);new MutationObserver(u=>{for(const f of u)if(f.type==="childList")for(const m of f.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function r(u){const f={};return u.integrity&&(f.integrity=u.integrity),u.referrerPolicy&&(f.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?f.credentials="include":u.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function o(u){if(u.ep)return;u.ep=!0;const f=r(u);fetch(u.href,f)}})();function Dl(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var ns={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var Rl=ns.exports,Sa;function Fl(){return Sa||(Sa=1,function(h,n){(function(r,o){o(n)})(Rl,function(r){var o="1.9.4";function u(i){var l,g,y,k;for(g=1,y=arguments.length;g<y;g++){k=arguments[g];for(l in k)i[l]=k[l]}return i}var f=Object.create||function(){function i(){}return function(l){return i.prototype=l,new i}}();function m(i,l){var g=Array.prototype.slice;if(i.bind)return i.bind.apply(i,g.call(arguments,1));var y=g.call(arguments,2);return function(){return i.apply(l,y.length?y.concat(g.call(arguments)):arguments)}}var d=0;function x(i){return"_leaflet_id"in i||(i._leaflet_id=++d),i._leaflet_id}function v(i,l,g){var y,k,A,j;return j=function(){y=!1,k&&(A.apply(g,k),k=!1)},A=function(){y?k=arguments:(i.apply(g,arguments),setTimeout(j,l),y=!0)},A}function w(i,l,g){var y=l[1],k=l[0],A=y-k;return i===y&&g?i:((i-k)%A+A)%A+k}function I(){return!1}function T(i,l){if(l===!1)return i;var g=Math.pow(10,l===void 0?6:l);return Math.round(i*g)/g}function b(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}function D(i){return b(i).split(/\s+/)}function Z(i,l){Object.prototype.hasOwnProperty.call(i,"options")||(i.options=i.options?f(i.options):{});for(var g in l)i.options[g]=l[g];return i.options}function Y(i,l,g){var y=[];for(var k in i)y.push(encodeURIComponent(g?k.toUpperCase():k)+"="+encodeURIComponent(i[k]));return(!l||l.indexOf("?")===-1?"?":"&")+y.join("&")}var tt=/\{ *([\w_ -]+) *\}/g;function E(i,l){return i.replace(tt,function(g,y){var k=l[y];if(k===void 0)throw new Error("No value provided for variable "+g);return typeof k=="function"&&(k=k(l)),k})}var G=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"};function N(i,l){for(var g=0;g<i.length;g++)if(i[g]===l)return g;return-1}var B="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function z(i){return window["webkit"+i]||window["moz"+i]||window["ms"+i]}var $=0;function P(i){var l=+new Date,g=Math.max(0,16-(l-$));return $=l+g,window.setTimeout(i,g)}var S=window.requestAnimationFrame||z("RequestAnimationFrame")||P,C=window.cancelAnimationFrame||z("CancelAnimationFrame")||z("CancelRequestAnimationFrame")||function(i){window.clearTimeout(i)};function R(i,l,g){if(g&&S===P)i.call(l);else return S.call(window,m(i,l))}function F(i){i&&C.call(window,i)}var V={__proto__:null,extend:u,create:f,bind:m,get lastId(){return d},stamp:x,throttle:v,wrapNum:w,falseFn:I,formatNum:T,trim:b,splitWords:D,setOptions:Z,getParamString:Y,template:E,isArray:G,indexOf:N,emptyImageUrl:B,requestFn:S,cancelFn:C,requestAnimFrame:R,cancelAnimFrame:F};function H(){}H.extend=function(i){var l=function(){Z(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},g=l.__super__=this.prototype,y=f(g);y.constructor=l,l.prototype=y;for(var k in this)Object.prototype.hasOwnProperty.call(this,k)&&k!=="prototype"&&k!=="__super__"&&(l[k]=this[k]);return i.statics&&u(l,i.statics),i.includes&&(X(i.includes),u.apply(null,[y].concat(i.includes))),u(y,i),delete y.statics,delete y.includes,y.options&&(y.options=g.options?f(g.options):{},u(y.options,i.options)),y._initHooks=[],y.callInitHooks=function(){if(!this._initHooksCalled){g.callInitHooks&&g.callInitHooks.call(this),this._initHooksCalled=!0;for(var A=0,j=y._initHooks.length;A<j;A++)y._initHooks[A].call(this)}},l},H.include=function(i){var l=this.prototype.options;return u(this.prototype,i),i.options&&(this.prototype.options=l,this.mergeOptions(i.options)),this},H.mergeOptions=function(i){return u(this.prototype.options,i),this},H.addInitHook=function(i){var l=Array.prototype.slice.call(arguments,1),g=typeof i=="function"?i:function(){this[i].apply(this,l)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(g),this};function X(i){if(!(typeof L>"u"||!L||!L.Mixin)){i=G(i)?i:[i];for(var l=0;l<i.length;l++)i[l]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var q={on:function(i,l,g){if(typeof i=="object")for(var y in i)this._on(y,i[y],l);else{i=D(i);for(var k=0,A=i.length;k<A;k++)this._on(i[k],l,g)}return this},off:function(i,l,g){if(!arguments.length)delete this._events;else if(typeof i=="object")for(var y in i)this._off(y,i[y],l);else{i=D(i);for(var k=arguments.length===1,A=0,j=i.length;A<j;A++)k?this._off(i[A]):this._off(i[A],l,g)}return this},_on:function(i,l,g,y){if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}if(this._listens(i,l,g)===!1){g===this&&(g=void 0);var k={fn:l,ctx:g};y&&(k.once=!0),this._events=this._events||{},this._events[i]=this._events[i]||[],this._events[i].push(k)}},_off:function(i,l,g){var y,k,A;if(this._events&&(y=this._events[i],!!y)){if(arguments.length===1){if(this._firingCount)for(k=0,A=y.length;k<A;k++)y[k].fn=I;delete this._events[i];return}if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}var j=this._listens(i,l,g);if(j!==!1){var st=y[j];this._firingCount&&(st.fn=I,this._events[i]=y=y.slice()),y.splice(j,1)}}},fire:function(i,l,g){if(!this.listens(i,g))return this;var y=u({},l,{type:i,target:this,sourceTarget:l&&l.sourceTarget||this});if(this._events){var k=this._events[i];if(k){this._firingCount=this._firingCount+1||1;for(var A=0,j=k.length;A<j;A++){var st=k[A],lt=st.fn;st.once&&this.off(i,lt,st.ctx),lt.call(st.ctx||this,y)}this._firingCount--}}return g&&this._propagateEvent(y),this},listens:function(i,l,g,y){typeof i!="string"&&console.warn('"string" type argument expected');var k=l;typeof l!="function"&&(y=!!l,k=void 0,g=void 0);var A=this._events&&this._events[i];if(A&&A.length&&this._listens(i,k,g)!==!1)return!0;if(y){for(var j in this._eventParents)if(this._eventParents[j].listens(i,l,g,y))return!0}return!1},_listens:function(i,l,g){if(!this._events)return!1;var y=this._events[i]||[];if(!l)return!!y.length;g===this&&(g=void 0);for(var k=0,A=y.length;k<A;k++)if(y[k].fn===l&&y[k].ctx===g)return k;return!1},once:function(i,l,g){if(typeof i=="object")for(var y in i)this._on(y,i[y],l,!0);else{i=D(i);for(var k=0,A=i.length;k<A;k++)this._on(i[k],l,g,!0)}return this},addEventParent:function(i){return this._eventParents=this._eventParents||{},this._eventParents[x(i)]=i,this},removeEventParent:function(i){return this._eventParents&&delete this._eventParents[x(i)],this},_propagateEvent:function(i){for(var l in this._eventParents)this._eventParents[l].fire(i.type,u({layer:i.target,propagatedFrom:i.target},i),!0)}};q.addEventListener=q.on,q.removeEventListener=q.clearAllEventListeners=q.off,q.addOneTimeEventListener=q.once,q.fireEvent=q.fire,q.hasEventListeners=q.listens;var Q=H.extend(q);function W(i,l,g){this.x=g?Math.round(i):i,this.y=g?Math.round(l):l}var it=Math.trunc||function(i){return i>0?Math.floor(i):Math.ceil(i)};W.prototype={clone:function(){return new W(this.x,this.y)},add:function(i){return this.clone()._add(J(i))},_add:function(i){return this.x+=i.x,this.y+=i.y,this},subtract:function(i){return this.clone()._subtract(J(i))},_subtract:function(i){return this.x-=i.x,this.y-=i.y,this},divideBy:function(i){return this.clone()._divideBy(i)},_divideBy:function(i){return this.x/=i,this.y/=i,this},multiplyBy:function(i){return this.clone()._multiplyBy(i)},_multiplyBy:function(i){return this.x*=i,this.y*=i,this},scaleBy:function(i){return new W(this.x*i.x,this.y*i.y)},unscaleBy:function(i){return new W(this.x/i.x,this.y/i.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=it(this.x),this.y=it(this.y),this},distanceTo:function(i){i=J(i);var l=i.x-this.x,g=i.y-this.y;return Math.sqrt(l*l+g*g)},equals:function(i){return i=J(i),i.x===this.x&&i.y===this.y},contains:function(i){return i=J(i),Math.abs(i.x)<=Math.abs(this.x)&&Math.abs(i.y)<=Math.abs(this.y)},toString:function(){return"Point("+T(this.x)+", "+T(this.y)+")"}};function J(i,l,g){return i instanceof W?i:G(i)?new W(i[0],i[1]):i==null?i:typeof i=="object"&&"x"in i&&"y"in i?new W(i.x,i.y):new W(i,l,g)}function ut(i,l){if(i)for(var g=l?[i,l]:i,y=0,k=g.length;y<k;y++)this.extend(g[y])}ut.prototype={extend:function(i){var l,g;if(!i)return this;if(i instanceof W||typeof i[0]=="number"||"x"in i)l=g=J(i);else if(i=ct(i),l=i.min,g=i.max,!l||!g)return this;return!this.min&&!this.max?(this.min=l.clone(),this.max=g.clone()):(this.min.x=Math.min(l.x,this.min.x),this.max.x=Math.max(g.x,this.max.x),this.min.y=Math.min(l.y,this.min.y),this.max.y=Math.max(g.y,this.max.y)),this},getCenter:function(i){return J((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,i)},getBottomLeft:function(){return J(this.min.x,this.max.y)},getTopRight:function(){return J(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(i){var l,g;return typeof i[0]=="number"||i instanceof W?i=J(i):i=ct(i),i instanceof ut?(l=i.min,g=i.max):l=g=i,l.x>=this.min.x&&g.x<=this.max.x&&l.y>=this.min.y&&g.y<=this.max.y},intersects:function(i){i=ct(i);var l=this.min,g=this.max,y=i.min,k=i.max,A=k.x>=l.x&&y.x<=g.x,j=k.y>=l.y&&y.y<=g.y;return A&&j},overlaps:function(i){i=ct(i);var l=this.min,g=this.max,y=i.min,k=i.max,A=k.x>l.x&&y.x<g.x,j=k.y>l.y&&y.y<g.y;return A&&j},isValid:function(){return!!(this.min&&this.max)},pad:function(i){var l=this.min,g=this.max,y=Math.abs(l.x-g.x)*i,k=Math.abs(l.y-g.y)*i;return ct(J(l.x-y,l.y-k),J(g.x+y,g.y+k))},equals:function(i){return i?(i=ct(i),this.min.equals(i.getTopLeft())&&this.max.equals(i.getBottomRight())):!1}};function ct(i,l){return!i||i instanceof ut?i:new ut(i,l)}function pt(i,l){if(i)for(var g=l?[i,l]:i,y=0,k=g.length;y<k;y++)this.extend(g[y])}pt.prototype={extend:function(i){var l=this._southWest,g=this._northEast,y,k;if(i instanceof ft)y=i,k=i;else if(i instanceof pt){if(y=i._southWest,k=i._northEast,!y||!k)return this}else return i?this.extend(gt(i)||ht(i)):this;return!l&&!g?(this._southWest=new ft(y.lat,y.lng),this._northEast=new ft(k.lat,k.lng)):(l.lat=Math.min(y.lat,l.lat),l.lng=Math.min(y.lng,l.lng),g.lat=Math.max(k.lat,g.lat),g.lng=Math.max(k.lng,g.lng)),this},pad:function(i){var l=this._southWest,g=this._northEast,y=Math.abs(l.lat-g.lat)*i,k=Math.abs(l.lng-g.lng)*i;return new pt(new ft(l.lat-y,l.lng-k),new ft(g.lat+y,g.lng+k))},getCenter:function(){return new ft((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ft(this.getNorth(),this.getWest())},getSouthEast:function(){return new ft(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(i){typeof i[0]=="number"||i instanceof ft||"lat"in i?i=gt(i):i=ht(i);var l=this._southWest,g=this._northEast,y,k;return i instanceof pt?(y=i.getSouthWest(),k=i.getNorthEast()):y=k=i,y.lat>=l.lat&&k.lat<=g.lat&&y.lng>=l.lng&&k.lng<=g.lng},intersects:function(i){i=ht(i);var l=this._southWest,g=this._northEast,y=i.getSouthWest(),k=i.getNorthEast(),A=k.lat>=l.lat&&y.lat<=g.lat,j=k.lng>=l.lng&&y.lng<=g.lng;return A&&j},overlaps:function(i){i=ht(i);var l=this._southWest,g=this._northEast,y=i.getSouthWest(),k=i.getNorthEast(),A=k.lat>l.lat&&y.lat<g.lat,j=k.lng>l.lng&&y.lng<g.lng;return A&&j},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(i,l){return i?(i=ht(i),this._southWest.equals(i.getSouthWest(),l)&&this._northEast.equals(i.getNorthEast(),l)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ht(i,l){return i instanceof pt?i:new pt(i,l)}function ft(i,l,g){if(isNaN(i)||isNaN(l))throw new Error("Invalid LatLng object: ("+i+", "+l+")");this.lat=+i,this.lng=+l,g!==void 0&&(this.alt=+g)}ft.prototype={equals:function(i,l){if(!i)return!1;i=gt(i);var g=Math.max(Math.abs(this.lat-i.lat),Math.abs(this.lng-i.lng));return g<=(l===void 0?1e-9:l)},toString:function(i){return"LatLng("+T(this.lat,i)+", "+T(this.lng,i)+")"},distanceTo:function(i){return nt.distance(this,gt(i))},wrap:function(){return nt.wrapLatLng(this)},toBounds:function(i){var l=180*i/40075017,g=l/Math.cos(Math.PI/180*this.lat);return ht([this.lat-l,this.lng-g],[this.lat+l,this.lng+g])},clone:function(){return new ft(this.lat,this.lng,this.alt)}};function gt(i,l,g){return i instanceof ft?i:G(i)&&typeof i[0]!="object"?i.length===3?new ft(i[0],i[1],i[2]):i.length===2?new ft(i[0],i[1]):null:i==null?i:typeof i=="object"&&"lat"in i?new ft(i.lat,"lng"in i?i.lng:i.lon,i.alt):l===void 0?null:new ft(i,l,g)}var kt={latLngToPoint:function(i,l){var g=this.projection.project(i),y=this.scale(l);return this.transformation._transform(g,y)},pointToLatLng:function(i,l){var g=this.scale(l),y=this.transformation.untransform(i,g);return this.projection.unproject(y)},project:function(i){return this.projection.project(i)},unproject:function(i){return this.projection.unproject(i)},scale:function(i){return 256*Math.pow(2,i)},zoom:function(i){return Math.log(i/256)/Math.LN2},getProjectedBounds:function(i){if(this.infinite)return null;var l=this.projection.bounds,g=this.scale(i),y=this.transformation.transform(l.min,g),k=this.transformation.transform(l.max,g);return new ut(y,k)},infinite:!1,wrapLatLng:function(i){var l=this.wrapLng?w(i.lng,this.wrapLng,!0):i.lng,g=this.wrapLat?w(i.lat,this.wrapLat,!0):i.lat,y=i.alt;return new ft(g,l,y)},wrapLatLngBounds:function(i){var l=i.getCenter(),g=this.wrapLatLng(l),y=l.lat-g.lat,k=l.lng-g.lng;if(y===0&&k===0)return i;var A=i.getSouthWest(),j=i.getNorthEast(),st=new ft(A.lat-y,A.lng-k),lt=new ft(j.lat-y,j.lng-k);return new pt(st,lt)}},nt=u({},kt,{wrapLng:[-180,180],R:6371e3,distance:function(i,l){var g=Math.PI/180,y=i.lat*g,k=l.lat*g,A=Math.sin((l.lat-i.lat)*g/2),j=Math.sin((l.lng-i.lng)*g/2),st=A*A+Math.cos(y)*Math.cos(k)*j*j,lt=2*Math.atan2(Math.sqrt(st),Math.sqrt(1-st));return this.R*lt}}),Kt=6378137,bt={R:Kt,MAX_LATITUDE:85.0511287798,project:function(i){var l=Math.PI/180,g=this.MAX_LATITUDE,y=Math.max(Math.min(g,i.lat),-g),k=Math.sin(y*l);return new W(this.R*i.lng*l,this.R*Math.log((1+k)/(1-k))/2)},unproject:function(i){var l=180/Math.PI;return new ft((2*Math.atan(Math.exp(i.y/this.R))-Math.PI/2)*l,i.x*l/this.R)},bounds:function(){var i=Kt*Math.PI;return new ut([-i,-i],[i,i])}()};function vt(i,l,g,y){if(G(i)){this._a=i[0],this._b=i[1],this._c=i[2],this._d=i[3];return}this._a=i,this._b=l,this._c=g,this._d=y}vt.prototype={transform:function(i,l){return this._transform(i.clone(),l)},_transform:function(i,l){return l=l||1,i.x=l*(this._a*i.x+this._b),i.y=l*(this._c*i.y+this._d),i},untransform:function(i,l){return l=l||1,new W((i.x/l-this._b)/this._a,(i.y/l-this._d)/this._c)}};function K(i,l,g,y){return new vt(i,l,g,y)}var Rt=u({},nt,{code:"EPSG:3857",projection:bt,transformation:function(){var i=.5/(Math.PI*bt.R);return K(i,.5,-i,.5)}()}),qt=u({},Rt,{code:"EPSG:900913"});function St(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function we(i,l){var g="",y,k,A,j,st,lt;for(y=0,A=i.length;y<A;y++){for(st=i[y],k=0,j=st.length;k<j;k++)lt=st[k],g+=(k?"L":"M")+lt.x+" "+lt.y;g+=l?Lt.svg?"z":"x":""}return g||"M0 0"}var fe=document.documentElement.style,Te="ActiveXObject"in window,yt=Te&&!document.addEventListener,gi="msLaunchUri"in navigator&&!("documentMode"in document),Xn=me("webkit"),Ze=me("android"),Ai=me("android 2")||me("android 3"),Ot=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),pn=Ze&&me("Google")&&Ot<537&&!("AudioNode"in window),Ye=!!window.opera,Di=!gi&&me("chrome"),Ct=me("gecko")&&!Xn&&!Ye&&!Te,kr=!Di&&me("safari"),Zt=me("phantom"),Tt="OTransition"in fe,wo=navigator.platform.indexOf("Win")===0,Ve=Te&&"transition"in fe,wr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ai,It="MozPerspective"in fe,Eo=!window.L_DISABLE_3D&&(Ve||wr||It)&&!Tt&&!Zt,di=typeof orientation<"u"||me("mobile"),Er=di&&Xn,Fe=di&&wr,Wn=!window.PointerEvent&&window.MSPointerEvent,He=!!(window.PointerEvent||Wn),Pr="ontouchstart"in window||!!window.TouchEvent,Ri=!window.L_NO_TOUCH&&(Pr||He),Po=di&&Ye,_s=di&&Ct,Tn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,_t=function(){var i=!1;try{var l=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("testPassiveEventSupport",I,l),window.removeEventListener("testPassiveEventSupport",I,l)}catch{}return i}(),Fi=function(){return!!document.createElement("canvas").getContext}(),Kn=!!(document.createElementNS&&St("svg").createSVGRect),mi=!!Kn&&function(){var i=document.createElement("div");return i.innerHTML="<svg/>",(i.firstChild&&i.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),xs=!Kn&&function(){try{var i=document.createElement("div");i.innerHTML='<v:shape adj="1"/>';var l=i.firstChild;return l.style.behavior="url(#default#VML)",l&&typeof l.adj=="object"}catch{return!1}}(),Lr=navigator.platform.indexOf("Mac")===0,ks=navigator.platform.indexOf("Linux")===0;function me(i){return navigator.userAgent.toLowerCase().indexOf(i)>=0}var Lt={ie:Te,ielt9:yt,edge:gi,webkit:Xn,android:Ze,android23:Ai,androidStock:pn,opera:Ye,chrome:Di,gecko:Ct,safari:kr,phantom:Zt,opera12:Tt,win:wo,ie3d:Ve,webkit3d:wr,gecko3d:It,any3d:Eo,mobile:di,mobileWebkit:Er,mobileWebkit3d:Fe,msPointer:Wn,pointer:He,touch:Ri,touchNative:Pr,mobileOpera:Po,mobileGecko:_s,retina:Tn,passiveEvents:_t,canvas:Fi,svg:Kn,vml:xs,inlineSvg:mi,mac:Lr,linux:ks},pi=Lt.msPointer?"MSPointerDown":"pointerdown",ws=Lt.msPointer?"MSPointerMove":"pointermove",Mr=Lt.msPointer?"MSPointerUp":"pointerup",Es=Lt.msPointer?"MSPointerCancel":"pointercancel",Ee={touchstart:pi,touchmove:ws,touchend:Mr,touchcancel:Es},Bi={touchstart:Hi,touchmove:Gi,touchend:Gi,touchcancel:Gi},Xe={},yn=!1;function Nn(i,l,g){return l==="touchstart"&&Lo(),Bi[l]?(g=Bi[l].bind(this,g),i.addEventListener(Ee[l],g,!1),g):(console.warn("wrong event specified:",l),I)}function Ir(i,l,g){if(!Ee[l]){console.warn("wrong event specified:",l);return}i.removeEventListener(Ee[l],g,!1)}function zi(i){Xe[i.pointerId]=i}function yi(i){Xe[i.pointerId]&&(Xe[i.pointerId]=i)}function ue(i){delete Xe[i.pointerId]}function Lo(){yn||(document.addEventListener(pi,zi,!0),document.addEventListener(ws,yi,!0),document.addEventListener(Mr,ue,!0),document.addEventListener(Es,ue,!0),yn=!0)}function Gi(i,l){if(l.pointerType!==(l.MSPOINTER_TYPE_MOUSE||"mouse")){l.touches=[];for(var g in Xe)l.touches.push(Xe[g]);l.changedTouches=[l],i(l)}}function Hi(i,l){l.MSPOINTER_TYPE_TOUCH&&l.pointerType===l.MSPOINTER_TYPE_TOUCH&&re(l),Gi(i,l)}function vi(i){var l={},g,y;for(y in i)g=i[y],l[y]=g&&g.bind?g.bind(i):g;return i=l,l.type="dblclick",l.detail=2,l.isTrusted=!1,l._simulated=!0,l}var Sr=200;function Cr(i,l){i.addEventListener("dblclick",l);var g=0,y;function k(A){if(A.detail!==1){y=A.detail;return}if(!(A.pointerType==="mouse"||A.sourceCapabilities&&!A.sourceCapabilities.firesTouchEvents)){var j=ye(A);if(!(j.some(function(lt){return lt instanceof HTMLLabelElement&&lt.attributes.for})&&!j.some(function(lt){return lt instanceof HTMLInputElement||lt instanceof HTMLSelectElement}))){var st=Date.now();st-g<=Sr?(y++,y===2&&l(vi(A))):y=1,g=st}}}return i.addEventListener("click",k),{dblclick:l,simDblclick:k}}function Ps(i,l){i.removeEventListener("dblclick",l.dblclick),i.removeEventListener("click",l.simDblclick)}var br=Yi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Pe=Yi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),On=Pe==="webkitTransition"||Pe==="OTransition"?Pe+"End":"transitionend";function qi(i){return typeof i=="string"?document.getElementById(i):i}function We(i,l){var g=i.style[l]||i.currentStyle&&i.currentStyle[l];if((!g||g==="auto")&&document.defaultView){var y=document.defaultView.getComputedStyle(i,null);g=y?y[l]:null}return g==="auto"?null:g}function Yt(i,l,g){var y=document.createElement(i);return y.className=l||"",g&&g.appendChild(y),y}function ne(i){var l=i.parentNode;l&&l.removeChild(i)}function Ui(i){for(;i.firstChild;)i.removeChild(i.firstChild)}function $n(i){var l=i.parentNode;l&&l.lastChild!==i&&l.appendChild(i)}function An(i){var l=i.parentNode;l&&l.firstChild!==i&&l.insertBefore(i,l.firstChild)}function Zi(i,l){if(i.classList!==void 0)return i.classList.contains(l);var g=_i(i);return g.length>0&&new RegExp("(^|\\s)"+l+"(\\s|$)").test(g)}function Dt(i,l){if(i.classList!==void 0)for(var g=D(l),y=0,k=g.length;y<k;y++)i.classList.add(g[y]);else if(!Zi(i,l)){var A=_i(i);Ke(i,(A?A+" ":"")+l)}}function Jt(i,l){i.classList!==void 0?i.classList.remove(l):Ke(i,b((" "+_i(i)+" ").replace(" "+l+" "," ")))}function Ke(i,l){i.className.baseVal===void 0?i.className=l:i.className.baseVal=l}function _i(i){return i.correspondingElement&&(i=i.correspondingElement),i.className.baseVal===void 0?i.className:i.className.baseVal}function ge(i,l){"opacity"in i.style?i.style.opacity=l:"filter"in i.style&&Mo(i,l)}function Mo(i,l){var g=!1,y="DXImageTransform.Microsoft.Alpha";try{g=i.filters.item(y)}catch{if(l===1)return}l=Math.round(l*100),g?(g.Enabled=l!==100,g.Opacity=l):i.style.filter+=" progid:"+y+"(opacity="+l+")"}function Yi(i){for(var l=document.documentElement.style,g=0;g<i.length;g++)if(i[g]in l)return i[g];return!1}function Dn(i,l,g){var y=l||new W(0,0);i.style[br]=(Lt.ie3d?"translate("+y.x+"px,"+y.y+"px)":"translate3d("+y.x+"px,"+y.y+"px,0)")+(g?" scale("+g+")":"")}function le(i,l){i._leaflet_pos=l,Lt.any3d?Dn(i,l):(i.style.left=l.x+"px",i.style.top=l.y+"px")}function vn(i){return i._leaflet_pos||new W(0,0)}var ln,Jn,Tr;if("onselectstart"in document)ln=function(){Ft(window,"selectstart",re)},Jn=function(){Qt(window,"selectstart",re)};else{var jn=Yi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ln=function(){if(jn){var i=document.documentElement.style;Tr=i[jn],i[jn]="none"}},Jn=function(){jn&&(document.documentElement.style[jn]=Tr,Tr=void 0)}}function Nr(){Ft(window,"dragstart",re)}function xi(){Qt(window,"dragstart",re)}var jt,hn;function Or(i){for(;i.tabIndex===-1;)i=i.parentNode;i.style&&(Qn(),jt=i,hn=i.style.outlineStyle,i.style.outlineStyle="none",Ft(window,"keydown",Qn))}function Qn(){jt&&(jt.style.outlineStyle=hn,jt=void 0,hn=void 0,Qt(window,"keydown",Qn))}function Ne(i){do i=i.parentNode;while((!i.offsetWidth||!i.offsetHeight)&&i!==document.body);return i}function Se(i){var l=i.getBoundingClientRect();return{x:l.width/i.offsetWidth||1,y:l.height/i.offsetHeight||1,boundingClientRect:l}}var Vi={__proto__:null,TRANSFORM:br,TRANSITION:Pe,TRANSITION_END:On,get:qi,getStyle:We,create:Yt,remove:ne,empty:Ui,toFront:$n,toBack:An,hasClass:Zi,addClass:Dt,removeClass:Jt,setClass:Ke,getClass:_i,setOpacity:ge,testProp:Yi,setTransform:Dn,setPosition:le,getPosition:vn,get disableTextSelection(){return ln},get enableTextSelection(){return Jn},disableImageDrag:Nr,enableImageDrag:xi,preventOutline:Or,restoreOutline:Qn,getSizedParentNode:Ne,getScale:Se};function Ft(i,l,g,y){if(l&&typeof l=="object")for(var k in l)Xi(i,k,l[k],g);else{l=D(l);for(var A=0,j=l.length;A<j;A++)Xi(i,l[A],g,y)}return this}var $e="_leaflet_events";function Qt(i,l,g,y){if(arguments.length===1)ki(i),delete i[$e];else if(l&&typeof l=="object")for(var k in l)Xt(i,k,l[k],g);else if(l=D(l),arguments.length===2)ki(i,function(st){return N(l,st)!==-1});else for(var A=0,j=l.length;A<j;A++)Xt(i,l[A],g,y);return this}function ki(i,l){for(var g in i[$e]){var y=g.split(/\d/)[0];(!l||l(y))&&Xt(i,y,null,null,g)}}var Ar={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Xi(i,l,g,y){var k=l+x(g)+(y?"_"+x(y):"");if(i[$e]&&i[$e][k])return this;var A=function(st){return g.call(y||i,st||window.event)},j=A;!Lt.touchNative&&Lt.pointer&&l.indexOf("touch")===0?A=Nn(i,l,A):Lt.touch&&l==="dblclick"?A=Cr(i,A):"addEventListener"in i?l==="touchstart"||l==="touchmove"||l==="wheel"||l==="mousewheel"?i.addEventListener(Ar[l]||l,A,Lt.passiveEvents?{passive:!1}:!1):l==="mouseenter"||l==="mouseleave"?(A=function(st){st=st||window.event,Wi(i,st)&&j(st)},i.addEventListener(Ar[l],A,!1)):i.addEventListener(l,j,!1):i.attachEvent("on"+l,A),i[$e]=i[$e]||{},i[$e][k]=A}function Xt(i,l,g,y,k){k=k||l+x(g)+(y?"_"+x(y):"");var A=i[$e]&&i[$e][k];if(!A)return this;!Lt.touchNative&&Lt.pointer&&l.indexOf("touch")===0?Ir(i,l,A):Lt.touch&&l==="dblclick"?Ps(i,A):"removeEventListener"in i?i.removeEventListener(Ar[l]||l,A,!1):i.detachEvent("on"+l,A),i[$e][k]=null}function pe(i){return i.stopPropagation?i.stopPropagation():i.originalEvent?i.originalEvent._stopped=!0:i.cancelBubble=!0,this}function wi(i){return Xi(i,"wheel",pe),this}function ti(i){return Ft(i,"mousedown touchstart dblclick contextmenu",pe),i._leaflet_disable_click=!0,this}function re(i){return i.preventDefault?i.preventDefault():i.returnValue=!1,this}function _n(i){return re(i),pe(i),this}function ye(i){if(i.composedPath)return i.composedPath();for(var l=[],g=i.target;g;)l.push(g),g=g.parentNode;return l}function Dr(i,l){if(!l)return new W(i.clientX,i.clientY);var g=Se(l),y=g.boundingClientRect;return new W((i.clientX-y.left)/g.x-l.clientLeft,(i.clientY-y.top)/g.y-l.clientTop)}var Rr=Lt.linux&&Lt.chrome?window.devicePixelRatio:Lt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Fr(i){return Lt.edge?i.wheelDeltaY/2:i.deltaY&&i.deltaMode===0?-i.deltaY/Rr:i.deltaY&&i.deltaMode===1?-i.deltaY*20:i.deltaY&&i.deltaMode===2?-i.deltaY*60:i.deltaX||i.deltaZ?0:i.wheelDelta?(i.wheelDeltaY||i.wheelDelta)/2:i.detail&&Math.abs(i.detail)<32765?-i.detail*20:i.detail?i.detail/-32765*60:0}function Wi(i,l){var g=l.relatedTarget;if(!g)return!0;try{for(;g&&g!==i;)g=g.parentNode}catch{return!1}return g!==i}var Io={__proto__:null,on:Ft,off:Qt,stopPropagation:pe,disableScrollPropagation:wi,disableClickPropagation:ti,preventDefault:re,stop:_n,getPropagationPath:ye,getMousePosition:Dr,getWheelDelta:Fr,isExternalTarget:Wi,addListener:Ft,removeListener:Qt},Br=Q.extend({run:function(i,l,g,y){this.stop(),this._el=i,this._inProgress=!0,this._duration=g||.25,this._easeOutPower=1/Math.max(y||.5,.2),this._startPos=vn(i),this._offset=l.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=R(this._animate,this),this._step()},_step:function(i){var l=+new Date-this._startTime,g=this._duration*1e3;l<g?this._runFrame(this._easeOut(l/g),i):(this._runFrame(1),this._complete())},_runFrame:function(i,l){var g=this._startPos.add(this._offset.multiplyBy(i));l&&g._round(),le(this._el,g),this.fire("step")},_complete:function(){F(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(i){return 1-Math.pow(1-i,this._easeOutPower)}}),Bt=Q.extend({options:{crs:Rt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(i,l){l=Z(this,l),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(i),this._initLayout(),this._onResize=m(this._onResize,this),this._initEvents(),l.maxBounds&&this.setMaxBounds(l.maxBounds),l.zoom!==void 0&&(this._zoom=this._limitZoom(l.zoom)),l.center&&l.zoom!==void 0&&this.setView(gt(l.center),l.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Pe&&Lt.any3d&&!Lt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ft(this._proxy,On,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(i,l,g){if(l=l===void 0?this._zoom:this._limitZoom(l),i=this._limitCenter(gt(i),l,this.options.maxBounds),g=g||{},this._stop(),this._loaded&&!g.reset&&g!==!0){g.animate!==void 0&&(g.zoom=u({animate:g.animate},g.zoom),g.pan=u({animate:g.animate,duration:g.duration},g.pan));var y=this._zoom!==l?this._tryAnimatedZoom&&this._tryAnimatedZoom(i,l,g.zoom):this._tryAnimatedPan(i,g.pan);if(y)return clearTimeout(this._sizeTimer),this}return this._resetView(i,l,g.pan&&g.pan.noMoveStart),this},setZoom:function(i,l){return this._loaded?this.setView(this.getCenter(),i,{zoom:l}):(this._zoom=i,this)},zoomIn:function(i,l){return i=i||(Lt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+i,l)},zoomOut:function(i,l){return i=i||(Lt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-i,l)},setZoomAround:function(i,l,g){var y=this.getZoomScale(l),k=this.getSize().divideBy(2),A=i instanceof W?i:this.latLngToContainerPoint(i),j=A.subtract(k).multiplyBy(1-1/y),st=this.containerPointToLatLng(k.add(j));return this.setView(st,l,{zoom:g})},_getBoundsCenterZoom:function(i,l){l=l||{},i=i.getBounds?i.getBounds():ht(i);var g=J(l.paddingTopLeft||l.padding||[0,0]),y=J(l.paddingBottomRight||l.padding||[0,0]),k=this.getBoundsZoom(i,!1,g.add(y));if(k=typeof l.maxZoom=="number"?Math.min(l.maxZoom,k):k,k===1/0)return{center:i.getCenter(),zoom:k};var A=y.subtract(g).divideBy(2),j=this.project(i.getSouthWest(),k),st=this.project(i.getNorthEast(),k),lt=this.unproject(j.add(st).divideBy(2).add(A),k);return{center:lt,zoom:k}},fitBounds:function(i,l){if(i=ht(i),!i.isValid())throw new Error("Bounds are not valid.");var g=this._getBoundsCenterZoom(i,l);return this.setView(g.center,g.zoom,l)},fitWorld:function(i){return this.fitBounds([[-90,-180],[90,180]],i)},panTo:function(i,l){return this.setView(i,this._zoom,{pan:l})},panBy:function(i,l){if(i=J(i).round(),l=l||{},!i.x&&!i.y)return this.fire("moveend");if(l.animate!==!0&&!this.getSize().contains(i))return this._resetView(this.unproject(this.project(this.getCenter()).add(i)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Br,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),l.noMoveStart||this.fire("movestart"),l.animate!==!1){Dt(this._mapPane,"leaflet-pan-anim");var g=this._getMapPanePos().subtract(i).round();this._panAnim.run(this._mapPane,g,l.duration||.25,l.easeLinearity)}else this._rawPanBy(i),this.fire("move").fire("moveend");return this},flyTo:function(i,l,g){if(g=g||{},g.animate===!1||!Lt.any3d)return this.setView(i,l,g);this._stop();var y=this.project(this.getCenter()),k=this.project(i),A=this.getSize(),j=this._zoom;i=gt(i),l=l===void 0?j:l;var st=Math.max(A.x,A.y),lt=st*this.getZoomScale(j,l),mt=k.distanceTo(y)||1,wt=1.42,Nt=wt*wt;function Ut(ce){var Bs=ce?-1:1,bl=ce?lt:st,Tl=lt*lt-st*st+Bs*Nt*Nt*mt*mt,Nl=2*bl*Nt*mt,zo=Tl/Nl,Ia=Math.sqrt(zo*zo+1)-zo,Ol=Ia<1e-9?-18:Math.log(Ia);return Ol}function De(ce){return(Math.exp(ce)-Math.exp(-ce))/2}function _e(ce){return(Math.exp(ce)+Math.exp(-ce))/2}function nn(ce){return De(ce)/_e(ce)}var ze=Ut(0);function rr(ce){return st*(_e(ze)/_e(ze+wt*ce))}function Ml(ce){return st*(_e(ze)*nn(ze+wt*ce)-De(ze))/Nt}function Il(ce){return 1-Math.pow(1-ce,1.5)}var Sl=Date.now(),La=(Ut(1)-ze)/wt,Cl=g.duration?1e3*g.duration:1e3*La*.8;function Ma(){var ce=(Date.now()-Sl)/Cl,Bs=Il(ce)*La;ce<=1?(this._flyToFrame=R(Ma,this),this._move(this.unproject(y.add(k.subtract(y).multiplyBy(Ml(Bs)/mt)),j),this.getScaleZoom(st/rr(Bs),j),{flyTo:!0})):this._move(i,l)._moveEnd(!0)}return this._moveStart(!0,g.noMoveStart),Ma.call(this),this},flyToBounds:function(i,l){var g=this._getBoundsCenterZoom(i,l);return this.flyTo(g.center,g.zoom,l)},setMaxBounds:function(i){return i=ht(i),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),i.isValid()?(this.options.maxBounds=i,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(i){var l=this.options.minZoom;return this.options.minZoom=i,this._loaded&&l!==i&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(i):this},setMaxZoom:function(i){var l=this.options.maxZoom;return this.options.maxZoom=i,this._loaded&&l!==i&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(i):this},panInsideBounds:function(i,l){this._enforcingBounds=!0;var g=this.getCenter(),y=this._limitCenter(g,this._zoom,ht(i));return g.equals(y)||this.panTo(y,l),this._enforcingBounds=!1,this},panInside:function(i,l){l=l||{};var g=J(l.paddingTopLeft||l.padding||[0,0]),y=J(l.paddingBottomRight||l.padding||[0,0]),k=this.project(this.getCenter()),A=this.project(i),j=this.getPixelBounds(),st=ct([j.min.add(g),j.max.subtract(y)]),lt=st.getSize();if(!st.contains(A)){this._enforcingBounds=!0;var mt=A.subtract(st.getCenter()),wt=st.extend(A).getSize().subtract(lt);k.x+=mt.x<0?-wt.x:wt.x,k.y+=mt.y<0?-wt.y:wt.y,this.panTo(this.unproject(k),l),this._enforcingBounds=!1}return this},invalidateSize:function(i){if(!this._loaded)return this;i=u({animate:!1,pan:!0},i===!0?{animate:!0}:i);var l=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var g=this.getSize(),y=l.divideBy(2).round(),k=g.divideBy(2).round(),A=y.subtract(k);return!A.x&&!A.y?this:(i.animate&&i.pan?this.panBy(A):(i.pan&&this._rawPanBy(A),this.fire("move"),i.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(m(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:l,newSize:g}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(i){if(i=this._locateOptions=u({timeout:1e4,watch:!1},i),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var l=m(this._handleGeolocationResponse,this),g=m(this._handleGeolocationError,this);return i.watch?this._locationWatchId=navigator.geolocation.watchPosition(l,g,i):navigator.geolocation.getCurrentPosition(l,g,i),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(i){if(this._container._leaflet_id){var l=i.code,g=i.message||(l===1?"permission denied":l===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:l,message:"Geolocation error: "+g+"."})}},_handleGeolocationResponse:function(i){if(this._container._leaflet_id){var l=i.coords.latitude,g=i.coords.longitude,y=new ft(l,g),k=y.toBounds(i.coords.accuracy*2),A=this._locateOptions;if(A.setView){var j=this.getBoundsZoom(k);this.setView(y,A.maxZoom?Math.min(j,A.maxZoom):j)}var st={latlng:y,bounds:k,timestamp:i.timestamp};for(var lt in i.coords)typeof i.coords[lt]=="number"&&(st[lt]=i.coords[lt]);this.fire("locationfound",st)}},addHandler:function(i,l){if(!l)return this;var g=this[i]=new l(this);return this._handlers.push(g),this.options[i]&&g.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ne(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(F(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var i;for(i in this._layers)this._layers[i].remove();for(i in this._panes)ne(this._panes[i]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(i,l){var g="leaflet-pane"+(i?" leaflet-"+i.replace("Pane","")+"-pane":""),y=Yt("div",g,l||this._mapPane);return i&&(this._panes[i]=y),y},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var i=this.getPixelBounds(),l=this.unproject(i.getBottomLeft()),g=this.unproject(i.getTopRight());return new pt(l,g)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(i,l,g){i=ht(i),g=J(g||[0,0]);var y=this.getZoom()||0,k=this.getMinZoom(),A=this.getMaxZoom(),j=i.getNorthWest(),st=i.getSouthEast(),lt=this.getSize().subtract(g),mt=ct(this.project(st,y),this.project(j,y)).getSize(),wt=Lt.any3d?this.options.zoomSnap:1,Nt=lt.x/mt.x,Ut=lt.y/mt.y,De=l?Math.max(Nt,Ut):Math.min(Nt,Ut);return y=this.getScaleZoom(De,y),wt&&(y=Math.round(y/(wt/100))*(wt/100),y=l?Math.ceil(y/wt)*wt:Math.floor(y/wt)*wt),Math.max(k,Math.min(A,y))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new W(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(i,l){var g=this._getTopLeftPoint(i,l);return new ut(g,g.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(i){return this.options.crs.getProjectedBounds(i===void 0?this.getZoom():i)},getPane:function(i){return typeof i=="string"?this._panes[i]:i},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(i,l){var g=this.options.crs;return l=l===void 0?this._zoom:l,g.scale(i)/g.scale(l)},getScaleZoom:function(i,l){var g=this.options.crs;l=l===void 0?this._zoom:l;var y=g.zoom(i*g.scale(l));return isNaN(y)?1/0:y},project:function(i,l){return l=l===void 0?this._zoom:l,this.options.crs.latLngToPoint(gt(i),l)},unproject:function(i,l){return l=l===void 0?this._zoom:l,this.options.crs.pointToLatLng(J(i),l)},layerPointToLatLng:function(i){var l=J(i).add(this.getPixelOrigin());return this.unproject(l)},latLngToLayerPoint:function(i){var l=this.project(gt(i))._round();return l._subtract(this.getPixelOrigin())},wrapLatLng:function(i){return this.options.crs.wrapLatLng(gt(i))},wrapLatLngBounds:function(i){return this.options.crs.wrapLatLngBounds(ht(i))},distance:function(i,l){return this.options.crs.distance(gt(i),gt(l))},containerPointToLayerPoint:function(i){return J(i).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(i){return J(i).add(this._getMapPanePos())},containerPointToLatLng:function(i){var l=this.containerPointToLayerPoint(J(i));return this.layerPointToLatLng(l)},latLngToContainerPoint:function(i){return this.layerPointToContainerPoint(this.latLngToLayerPoint(gt(i)))},mouseEventToContainerPoint:function(i){return Dr(i,this._container)},mouseEventToLayerPoint:function(i){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(i))},mouseEventToLatLng:function(i){return this.layerPointToLatLng(this.mouseEventToLayerPoint(i))},_initContainer:function(i){var l=this._container=qi(i);if(l){if(l._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ft(l,"scroll",this._onScroll,this),this._containerId=x(l)},_initLayout:function(){var i=this._container;this._fadeAnimated=this.options.fadeAnimation&&Lt.any3d,Dt(i,"leaflet-container"+(Lt.touch?" leaflet-touch":"")+(Lt.retina?" leaflet-retina":"")+(Lt.ielt9?" leaflet-oldie":"")+(Lt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var l=We(i,"position");l!=="absolute"&&l!=="relative"&&l!=="fixed"&&l!=="sticky"&&(i.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var i=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),le(this._mapPane,new W(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Dt(i.markerPane,"leaflet-zoom-hide"),Dt(i.shadowPane,"leaflet-zoom-hide"))},_resetView:function(i,l,g){le(this._mapPane,new W(0,0));var y=!this._loaded;this._loaded=!0,l=this._limitZoom(l),this.fire("viewprereset");var k=this._zoom!==l;this._moveStart(k,g)._move(i,l)._moveEnd(k),this.fire("viewreset"),y&&this.fire("load")},_moveStart:function(i,l){return i&&this.fire("zoomstart"),l||this.fire("movestart"),this},_move:function(i,l,g,y){l===void 0&&(l=this._zoom);var k=this._zoom!==l;return this._zoom=l,this._lastCenter=i,this._pixelOrigin=this._getNewPixelOrigin(i),y?g&&g.pinch&&this.fire("zoom",g):((k||g&&g.pinch)&&this.fire("zoom",g),this.fire("move",g)),this},_moveEnd:function(i){return i&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return F(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(i){le(this._mapPane,this._getMapPanePos().subtract(i))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(i){this._targets={},this._targets[x(this._container)]=this;var l=i?Qt:Ft;l(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&l(window,"resize",this._onResize,this),Lt.any3d&&this.options.transform3DLimit&&(i?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){F(this._resizeRequest),this._resizeRequest=R(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var i=this._getMapPanePos();Math.max(Math.abs(i.x),Math.abs(i.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(i,l){for(var g=[],y,k=l==="mouseout"||l==="mouseover",A=i.target||i.srcElement,j=!1;A;){if(y=this._targets[x(A)],y&&(l==="click"||l==="preclick")&&this._draggableMoved(y)){j=!0;break}if(y&&y.listens(l,!0)&&(k&&!Wi(A,i)||(g.push(y),k))||A===this._container)break;A=A.parentNode}return!g.length&&!j&&!k&&this.listens(l,!0)&&(g=[this]),g},_isClickDisabled:function(i){for(;i&&i!==this._container;){if(i._leaflet_disable_click)return!0;i=i.parentNode}},_handleDOMEvent:function(i){var l=i.target||i.srcElement;if(!(!this._loaded||l._leaflet_disable_events||i.type==="click"&&this._isClickDisabled(l))){var g=i.type;g==="mousedown"&&Or(l),this._fireDOMEvent(i,g)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(i,l,g){if(i.type==="click"){var y=u({},i);y.type="preclick",this._fireDOMEvent(y,y.type,g)}var k=this._findEventTargets(i,l);if(g){for(var A=[],j=0;j<g.length;j++)g[j].listens(l,!0)&&A.push(g[j]);k=A.concat(k)}if(k.length){l==="contextmenu"&&re(i);var st=k[0],lt={originalEvent:i};if(i.type!=="keypress"&&i.type!=="keydown"&&i.type!=="keyup"){var mt=st.getLatLng&&(!st._radius||st._radius<=10);lt.containerPoint=mt?this.latLngToContainerPoint(st.getLatLng()):this.mouseEventToContainerPoint(i),lt.layerPoint=this.containerPointToLayerPoint(lt.containerPoint),lt.latlng=mt?st.getLatLng():this.layerPointToLatLng(lt.layerPoint)}for(j=0;j<k.length;j++)if(k[j].fire(l,lt,!0),lt.originalEvent._stopped||k[j].options.bubblingMouseEvents===!1&&N(this._mouseEvents,l)!==-1)return}},_draggableMoved:function(i){return i=i.dragging&&i.dragging.enabled()?i:this,i.dragging&&i.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var i=0,l=this._handlers.length;i<l;i++)this._handlers[i].disable()},whenReady:function(i,l){return this._loaded?i.call(l||this,{target:this}):this.on("load",i,l),this},_getMapPanePos:function(){return vn(this._mapPane)||new W(0,0)},_moved:function(){var i=this._getMapPanePos();return i&&!i.equals([0,0])},_getTopLeftPoint:function(i,l){var g=i&&l!==void 0?this._getNewPixelOrigin(i,l):this.getPixelOrigin();return g.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(i,l){var g=this.getSize()._divideBy(2);return this.project(i,l)._subtract(g)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(i,l,g){var y=this._getNewPixelOrigin(g,l);return this.project(i,l)._subtract(y)},_latLngBoundsToNewLayerBounds:function(i,l,g){var y=this._getNewPixelOrigin(g,l);return ct([this.project(i.getSouthWest(),l)._subtract(y),this.project(i.getNorthWest(),l)._subtract(y),this.project(i.getSouthEast(),l)._subtract(y),this.project(i.getNorthEast(),l)._subtract(y)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(i){return this.latLngToLayerPoint(i).subtract(this._getCenterLayerPoint())},_limitCenter:function(i,l,g){if(!g)return i;var y=this.project(i,l),k=this.getSize().divideBy(2),A=new ut(y.subtract(k),y.add(k)),j=this._getBoundsOffset(A,g,l);return Math.abs(j.x)<=1&&Math.abs(j.y)<=1?i:this.unproject(y.add(j),l)},_limitOffset:function(i,l){if(!l)return i;var g=this.getPixelBounds(),y=new ut(g.min.add(i),g.max.add(i));return i.add(this._getBoundsOffset(y,l))},_getBoundsOffset:function(i,l,g){var y=ct(this.project(l.getNorthEast(),g),this.project(l.getSouthWest(),g)),k=y.min.subtract(i.min),A=y.max.subtract(i.max),j=this._rebound(k.x,-A.x),st=this._rebound(k.y,-A.y);return new W(j,st)},_rebound:function(i,l){return i+l>0?Math.round(i-l)/2:Math.max(0,Math.ceil(i))-Math.max(0,Math.floor(l))},_limitZoom:function(i){var l=this.getMinZoom(),g=this.getMaxZoom(),y=Lt.any3d?this.options.zoomSnap:1;return y&&(i=Math.round(i/y)*y),Math.max(l,Math.min(g,i))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Jt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(i,l){var g=this._getCenterOffset(i)._trunc();return(l&&l.animate)!==!0&&!this.getSize().contains(g)?!1:(this.panBy(g,l),!0)},_createAnimProxy:function(){var i=this._proxy=Yt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(i),this.on("zoomanim",function(l){var g=br,y=this._proxy.style[g];Dn(this._proxy,this.project(l.center,l.zoom),this.getZoomScale(l.zoom,1)),y===this._proxy.style[g]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ne(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var i=this.getCenter(),l=this.getZoom();Dn(this._proxy,this.project(i,l),this.getZoomScale(l,1))},_catchTransitionEnd:function(i){this._animatingZoom&&i.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(i,l,g){if(this._animatingZoom)return!0;if(g=g||{},!this._zoomAnimated||g.animate===!1||this._nothingToAnimate()||Math.abs(l-this._zoom)>this.options.zoomAnimationThreshold)return!1;var y=this.getZoomScale(l),k=this._getCenterOffset(i)._divideBy(1-1/y);return g.animate!==!0&&!this.getSize().contains(k)?!1:(R(function(){this._moveStart(!0,g.noMoveStart||!1)._animateZoom(i,l,!0)},this),!0)},_animateZoom:function(i,l,g,y){this._mapPane&&(g&&(this._animatingZoom=!0,this._animateToCenter=i,this._animateToZoom=l,Dt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:i,zoom:l,noUpdate:y}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(m(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Jt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ki(i,l){return new Bt(i,l)}var qe=H.extend({options:{position:"topright"},initialize:function(i){Z(this,i)},getPosition:function(){return this.options.position},setPosition:function(i){var l=this._map;return l&&l.removeControl(this),this.options.position=i,l&&l.addControl(this),this},getContainer:function(){return this._container},addTo:function(i){this.remove(),this._map=i;var l=this._container=this.onAdd(i),g=this.getPosition(),y=i._controlCorners[g];return Dt(l,"leaflet-control"),g.indexOf("bottom")!==-1?y.insertBefore(l,y.firstChild):y.appendChild(l),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ne(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(i){this._map&&i&&i.screenX>0&&i.screenY>0&&this._map.getContainer().focus()}}),ve=function(i){return new qe(i)};Bt.include({addControl:function(i){return i.addTo(this),this},removeControl:function(i){return i.remove(),this},_initControlPos:function(){var i=this._controlCorners={},l="leaflet-",g=this._controlContainer=Yt("div",l+"control-container",this._container);function y(k,A){var j=l+k+" "+l+A;i[k+A]=Yt("div",j,g)}y("top","left"),y("top","right"),y("bottom","left"),y("bottom","right")},_clearControlPos:function(){for(var i in this._controlCorners)ne(this._controlCorners[i]);ne(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Rn=qe.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(i,l,g,y){return g<y?-1:y<g?1:0}},initialize:function(i,l,g){Z(this,g),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var y in i)this._addLayer(i[y],y);for(y in l)this._addLayer(l[y],y,!0)},onAdd:function(i){this._initLayout(),this._update(),this._map=i,i.on("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(i){return qe.prototype.addTo.call(this,i),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(i,l){return this._addLayer(i,l),this._map?this._update():this},addOverlay:function(i,l){return this._addLayer(i,l,!0),this._map?this._update():this},removeLayer:function(i){i.off("add remove",this._onLayerChange,this);var l=this._getLayer(x(i));return l&&this._layers.splice(this._layers.indexOf(l),1),this._map?this._update():this},expand:function(){Dt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var i=this._map.getSize().y-(this._container.offsetTop+50);return i<this._section.clientHeight?(Dt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=i+"px"):Jt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Jt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var i="leaflet-control-layers",l=this._container=Yt("div",i),g=this.options.collapsed;l.setAttribute("aria-haspopup",!0),ti(l),wi(l);var y=this._section=Yt("section",i+"-list");g&&(this._map.on("click",this.collapse,this),Ft(l,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var k=this._layersLink=Yt("a",i+"-toggle",l);k.href="#",k.title="Layers",k.setAttribute("role","button"),Ft(k,{keydown:function(A){A.keyCode===13&&this._expandSafely()},click:function(A){re(A),this._expandSafely()}},this),g||this.expand(),this._baseLayersList=Yt("div",i+"-base",y),this._separator=Yt("div",i+"-separator",y),this._overlaysList=Yt("div",i+"-overlays",y),l.appendChild(y)},_getLayer:function(i){for(var l=0;l<this._layers.length;l++)if(this._layers[l]&&x(this._layers[l].layer)===i)return this._layers[l]},_addLayer:function(i,l,g){this._map&&i.on("add remove",this._onLayerChange,this),this._layers.push({layer:i,name:l,overlay:g}),this.options.sortLayers&&this._layers.sort(m(function(y,k){return this.options.sortFunction(y.layer,k.layer,y.name,k.name)},this)),this.options.autoZIndex&&i.setZIndex&&(this._lastZIndex++,i.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ui(this._baseLayersList),Ui(this._overlaysList),this._layerControlInputs=[];var i,l,g,y,k=0;for(g=0;g<this._layers.length;g++)y=this._layers[g],this._addItem(y),l=l||y.overlay,i=i||!y.overlay,k+=y.overlay?0:1;return this.options.hideSingleBase&&(i=i&&k>1,this._baseLayersList.style.display=i?"":"none"),this._separator.style.display=l&&i?"":"none",this},_onLayerChange:function(i){this._handlingClick||this._update();var l=this._getLayer(x(i.target)),g=l.overlay?i.type==="add"?"overlayadd":"overlayremove":i.type==="add"?"baselayerchange":null;g&&this._map.fire(g,l)},_createRadioElement:function(i,l){var g='<input type="radio" class="leaflet-control-layers-selector" name="'+i+'"'+(l?' checked="checked"':"")+"/>",y=document.createElement("div");return y.innerHTML=g,y.firstChild},_addItem:function(i){var l=document.createElement("label"),g=this._map.hasLayer(i.layer),y;i.overlay?(y=document.createElement("input"),y.type="checkbox",y.className="leaflet-control-layers-selector",y.defaultChecked=g):y=this._createRadioElement("leaflet-base-layers_"+x(this),g),this._layerControlInputs.push(y),y.layerId=x(i.layer),Ft(y,"click",this._onInputClick,this);var k=document.createElement("span");k.innerHTML=" "+i.name;var A=document.createElement("span");l.appendChild(A),A.appendChild(y),A.appendChild(k);var j=i.overlay?this._overlaysList:this._baseLayersList;return j.appendChild(l),this._checkDisabledLayers(),l},_onInputClick:function(){if(!this._preventClick){var i=this._layerControlInputs,l,g,y=[],k=[];this._handlingClick=!0;for(var A=i.length-1;A>=0;A--)l=i[A],g=this._getLayer(l.layerId).layer,l.checked?y.push(g):l.checked||k.push(g);for(A=0;A<k.length;A++)this._map.hasLayer(k[A])&&this._map.removeLayer(k[A]);for(A=0;A<y.length;A++)this._map.hasLayer(y[A])||this._map.addLayer(y[A]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var i=this._layerControlInputs,l,g,y=this._map.getZoom(),k=i.length-1;k>=0;k--)l=i[k],g=this._getLayer(l.layerId).layer,l.disabled=g.options.minZoom!==void 0&&y<g.options.minZoom||g.options.maxZoom!==void 0&&y>g.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var i=this._section;this._preventClick=!0,Ft(i,"click",re),this.expand();var l=this;setTimeout(function(){Qt(i,"click",re),l._preventClick=!1})}}),So=function(i,l,g){return new Rn(i,l,g)},xn=qe.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(i){var l="leaflet-control-zoom",g=Yt("div",l+" leaflet-bar"),y=this.options;return this._zoomInButton=this._createButton(y.zoomInText,y.zoomInTitle,l+"-in",g,this._zoomIn),this._zoomOutButton=this._createButton(y.zoomOutText,y.zoomOutTitle,l+"-out",g,this._zoomOut),this._updateDisabled(),i.on("zoomend zoomlevelschange",this._updateDisabled,this),g},onRemove:function(i){i.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(i){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(i.shiftKey?3:1))},_zoomOut:function(i){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(i.shiftKey?3:1))},_createButton:function(i,l,g,y,k){var A=Yt("a",g,y);return A.innerHTML=i,A.href="#",A.title=l,A.setAttribute("role","button"),A.setAttribute("aria-label",l),ti(A),Ft(A,"click",_n),Ft(A,"click",k,this),Ft(A,"click",this._refocusOnMap,this),A},_updateDisabled:function(){var i=this._map,l="leaflet-disabled";Jt(this._zoomInButton,l),Jt(this._zoomOutButton,l),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||i._zoom===i.getMinZoom())&&(Dt(this._zoomOutButton,l),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||i._zoom===i.getMaxZoom())&&(Dt(this._zoomInButton,l),this._zoomInButton.setAttribute("aria-disabled","true"))}});Bt.mergeOptions({zoomControl:!0}),Bt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new xn,this.addControl(this.zoomControl))});var Ls=function(i){return new xn(i)},Fn=qe.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(i){var l="leaflet-control-scale",g=Yt("div",l),y=this.options;return this._addScales(y,l+"-line",g),i.on(y.updateWhenIdle?"moveend":"move",this._update,this),i.whenReady(this._update,this),g},onRemove:function(i){i.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(i,l,g){i.metric&&(this._mScale=Yt("div",l,g)),i.imperial&&(this._iScale=Yt("div",l,g))},_update:function(){var i=this._map,l=i.getSize().y/2,g=i.distance(i.containerPointToLatLng([0,l]),i.containerPointToLatLng([this.options.maxWidth,l]));this._updateScales(g)},_updateScales:function(i){this.options.metric&&i&&this._updateMetric(i),this.options.imperial&&i&&this._updateImperial(i)},_updateMetric:function(i){var l=this._getRoundNum(i),g=l<1e3?l+" m":l/1e3+" km";this._updateScale(this._mScale,g,l/i)},_updateImperial:function(i){var l=i*3.2808399,g,y,k;l>5280?(g=l/5280,y=this._getRoundNum(g),this._updateScale(this._iScale,y+" mi",y/g)):(k=this._getRoundNum(l),this._updateScale(this._iScale,k+" ft",k/l))},_updateScale:function(i,l,g){i.style.width=Math.round(this.options.maxWidth*g)+"px",i.innerHTML=l},_getRoundNum:function(i){var l=Math.pow(10,(Math.floor(i)+"").length-1),g=i/l;return g=g>=10?10:g>=5?5:g>=3?3:g>=2?2:1,l*g}}),Co=function(i){return new Fn(i)},Je='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',$i=qe.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Lt.inlineSvg?Je+" ":"")+"Leaflet</a>"},initialize:function(i){Z(this,i),this._attributions={}},onAdd:function(i){i.attributionControl=this,this._container=Yt("div","leaflet-control-attribution"),ti(this._container);for(var l in i._layers)i._layers[l].getAttribution&&this.addAttribution(i._layers[l].getAttribution());return this._update(),i.on("layeradd",this._addAttribution,this),this._container},onRemove:function(i){i.off("layeradd",this._addAttribution,this)},_addAttribution:function(i){i.layer.getAttribution&&(this.addAttribution(i.layer.getAttribution()),i.layer.once("remove",function(){this.removeAttribution(i.layer.getAttribution())},this))},setPrefix:function(i){return this.options.prefix=i,this._update(),this},addAttribution:function(i){return i?(this._attributions[i]||(this._attributions[i]=0),this._attributions[i]++,this._update(),this):this},removeAttribution:function(i){return i?(this._attributions[i]&&(this._attributions[i]--,this._update()),this):this},_update:function(){if(this._map){var i=[];for(var l in this._attributions)this._attributions[l]&&i.push(l);var g=[];this.options.prefix&&g.push(this.options.prefix),i.length&&g.push(i.join(", ")),this._container.innerHTML=g.join(' <span aria-hidden="true">|</span> ')}}});Bt.mergeOptions({attributionControl:!0}),Bt.addInitHook(function(){this.options.attributionControl&&new $i().addTo(this)});var bo=function(i){return new $i(i)};qe.Layers=Rn,qe.Zoom=xn,qe.Scale=Fn,qe.Attribution=$i,ve.layers=So,ve.zoom=Ls,ve.scale=Co,ve.attribution=bo;var je=H.extend({initialize:function(i){this._map=i},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});je.addTo=function(i,l){return i.addHandler(l,this),this};var To={Events:q},Ms=Lt.touch?"touchstart mousedown":"mousedown",kn=Q.extend({options:{clickTolerance:3},initialize:function(i,l,g,y){Z(this,y),this._element=i,this._dragStartTarget=l||i,this._preventOutline=g},enable:function(){this._enabled||(Ft(this._dragStartTarget,Ms,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(kn._dragging===this&&this.finishDrag(!0),Qt(this._dragStartTarget,Ms,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(i){if(this._enabled&&(this._moved=!1,!Zi(this._element,"leaflet-zoom-anim"))){if(i.touches&&i.touches.length!==1){kn._dragging===this&&this.finishDrag();return}if(!(kn._dragging||i.shiftKey||i.which!==1&&i.button!==1&&!i.touches)&&(kn._dragging=this,this._preventOutline&&Or(this._element),Nr(),ln(),!this._moving)){this.fire("down");var l=i.touches?i.touches[0]:i,g=Ne(this._element);this._startPoint=new W(l.clientX,l.clientY),this._startPos=vn(this._element),this._parentScale=Se(g);var y=i.type==="mousedown";Ft(document,y?"mousemove":"touchmove",this._onMove,this),Ft(document,y?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(i){if(this._enabled){if(i.touches&&i.touches.length>1){this._moved=!0;return}var l=i.touches&&i.touches.length===1?i.touches[0]:i,g=new W(l.clientX,l.clientY)._subtract(this._startPoint);!g.x&&!g.y||Math.abs(g.x)+Math.abs(g.y)<this.options.clickTolerance||(g.x/=this._parentScale.x,g.y/=this._parentScale.y,re(i),this._moved||(this.fire("dragstart"),this._moved=!0,Dt(document.body,"leaflet-dragging"),this._lastTarget=i.target||i.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Dt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(g),this._moving=!0,this._lastEvent=i,this._updatePosition())}},_updatePosition:function(){var i={originalEvent:this._lastEvent};this.fire("predrag",i),le(this._element,this._newPos),this.fire("drag",i)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(i){Jt(document.body,"leaflet-dragging"),this._lastTarget&&(Jt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Qt(document,"mousemove touchmove",this._onMove,this),Qt(document,"mouseup touchend touchcancel",this._onUp,this),xi(),Jn();var l=this._moved&&this._moving;this._moving=!1,kn._dragging=!1,l&&this.fire("dragend",{noInertia:i,distance:this._newPos.distanceTo(this._startPos)})}});function Is(i,l,g){var y,k=[1,4,2,8],A,j,st,lt,mt,wt,Nt,Ut;for(A=0,wt=i.length;A<wt;A++)i[A]._code=he(i[A],l);for(st=0;st<4;st++){for(Nt=k[st],y=[],A=0,wt=i.length,j=wt-1;A<wt;j=A++)lt=i[A],mt=i[j],lt._code&Nt?mt._code&Nt||(Ut=Ei(mt,lt,Nt,l,g),Ut._code=he(Ut,l),y.push(Ut)):(mt._code&Nt&&(Ut=Ei(mt,lt,Nt,l,g),Ut._code=he(Ut,l),y.push(Ut)),y.push(lt));i=y}return i}function Ss(i,l){var g,y,k,A,j,st,lt,mt,wt;if(!i||i.length===0)throw new Error("latlngs not passed");Ae(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var Nt=gt([0,0]),Ut=ht(i),De=Ut.getNorthWest().distanceTo(Ut.getSouthWest())*Ut.getNorthEast().distanceTo(Ut.getNorthWest());De<1700&&(Nt=cn(i));var _e=i.length,nn=[];for(g=0;g<_e;g++){var ze=gt(i[g]);nn.push(l.project(gt([ze.lat-Nt.lat,ze.lng-Nt.lng])))}for(st=lt=mt=0,g=0,y=_e-1;g<_e;y=g++)k=nn[g],A=nn[y],j=k.y*A.x-A.y*k.x,lt+=(k.x+A.x)*j,mt+=(k.y+A.y)*j,st+=j*3;st===0?wt=nn[0]:wt=[lt/st,mt/st];var rr=l.unproject(J(wt));return gt([rr.lat+Nt.lat,rr.lng+Nt.lng])}function cn(i){for(var l=0,g=0,y=0,k=0;k<i.length;k++){var A=gt(i[k]);l+=A.lat,g+=A.lng,y++}return gt([l/y,g/y])}var Oe={__proto__:null,clipPolygon:Is,polygonCenter:Ss,centroid:cn};function Cs(i,l){if(!l||!i.length)return i.slice();var g=l*l;return i=Hr(i,g),i=Gr(i,g),i}function zr(i,l,g){return Math.sqrt(Li(i,l,g,!0))}function No(i,l,g){return Li(i,l,g)}function Gr(i,l){var g=i.length,y=typeof Uint8Array<"u"?Uint8Array:Array,k=new y(g);k[0]=k[g-1]=1,Ji(i,k,l,0,g-1);var A,j=[];for(A=0;A<g;A++)k[A]&&j.push(i[A]);return j}function Ji(i,l,g,y,k){var A=0,j,st,lt;for(st=y+1;st<=k-1;st++)lt=Li(i[st],i[y],i[k],!0),lt>A&&(j=st,A=lt);A>g&&(l[j]=1,Ji(i,l,g,y,j),Ji(i,l,g,j,k))}function Hr(i,l){for(var g=[i[0]],y=1,k=0,A=i.length;y<A;y++)Pi(i[y],i[k])>l&&(g.push(i[y]),k=y);return k<A-1&&g.push(i[A-1]),g}var qr;function Be(i,l,g,y,k){var A=y?qr:he(i,g),j=he(l,g),st,lt,mt;for(qr=j;;){if(!(A|j))return[i,l];if(A&j)return!1;st=A||j,lt=Ei(i,l,st,g,k),mt=he(lt,g),st===A?(i=lt,A=mt):(l=lt,j=mt)}}function Ei(i,l,g,y,k){var A=l.x-i.x,j=l.y-i.y,st=y.min,lt=y.max,mt,wt;return g&8?(mt=i.x+A*(lt.y-i.y)/j,wt=lt.y):g&4?(mt=i.x+A*(st.y-i.y)/j,wt=st.y):g&2?(mt=lt.x,wt=i.y+j*(lt.x-i.x)/A):g&1&&(mt=st.x,wt=i.y+j*(st.x-i.x)/A),new W(mt,wt,k)}function he(i,l){var g=0;return i.x<l.min.x?g|=1:i.x>l.max.x&&(g|=2),i.y<l.min.y?g|=4:i.y>l.max.y&&(g|=8),g}function Pi(i,l){var g=l.x-i.x,y=l.y-i.y;return g*g+y*y}function Li(i,l,g,y){var k=l.x,A=l.y,j=g.x-k,st=g.y-A,lt=j*j+st*st,mt;return lt>0&&(mt=((i.x-k)*j+(i.y-A)*st)/lt,mt>1?(k=g.x,A=g.y):mt>0&&(k+=j*mt,A+=st*mt)),j=i.x-k,st=i.y-A,y?j*j+st*st:new W(k,A)}function Ae(i){return!G(i[0])||typeof i[0][0]!="object"&&typeof i[0][0]<"u"}function Ur(i){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ae(i)}function Zr(i,l){var g,y,k,A,j,st,lt,mt;if(!i||i.length===0)throw new Error("latlngs not passed");Ae(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var wt=gt([0,0]),Nt=ht(i),Ut=Nt.getNorthWest().distanceTo(Nt.getSouthWest())*Nt.getNorthEast().distanceTo(Nt.getNorthWest());Ut<1700&&(wt=cn(i));var De=i.length,_e=[];for(g=0;g<De;g++){var nn=gt(i[g]);_e.push(l.project(gt([nn.lat-wt.lat,nn.lng-wt.lng])))}for(g=0,y=0;g<De-1;g++)y+=_e[g].distanceTo(_e[g+1])/2;if(y===0)mt=_e[0];else for(g=0,A=0;g<De-1;g++)if(j=_e[g],st=_e[g+1],k=j.distanceTo(st),A+=k,A>y){lt=(A-y)/k,mt=[st.x-lt*(st.x-j.x),st.y-lt*(st.y-j.y)];break}var ze=l.unproject(J(mt));return gt([ze.lat+wt.lat,ze.lng+wt.lng])}var Yr={__proto__:null,simplify:Cs,pointToSegmentDistance:zr,closestPointOnSegment:No,clipSegment:Be,_getEdgeIntersection:Ei,_getBitCode:he,_sqClosestPointOnSegment:Li,isFlat:Ae,_flat:Ur,polylineCenter:Zr},Vr={project:function(i){return new W(i.lng,i.lat)},unproject:function(i){return new ft(i.y,i.x)},bounds:new ut([-180,-90],[180,90])},Xr={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ut([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(i){var l=Math.PI/180,g=this.R,y=i.lat*l,k=this.R_MINOR/g,A=Math.sqrt(1-k*k),j=A*Math.sin(y),st=Math.tan(Math.PI/4-y/2)/Math.pow((1-j)/(1+j),A/2);return y=-g*Math.log(Math.max(st,1e-10)),new W(i.lng*l*g,y)},unproject:function(i){for(var l=180/Math.PI,g=this.R,y=this.R_MINOR/g,k=Math.sqrt(1-y*y),A=Math.exp(-i.y/g),j=Math.PI/2-2*Math.atan(A),st=0,lt=.1,mt;st<15&&Math.abs(lt)>1e-7;st++)mt=k*Math.sin(j),mt=Math.pow((1-mt)/(1+mt),k/2),lt=Math.PI/2-2*Math.atan(A*mt)-j,j+=lt;return new ft(j*l,i.x*l/g)}},Oo={__proto__:null,LonLat:Vr,Mercator:Xr,SphericalMercator:bt},Ao=u({},nt,{code:"EPSG:3395",projection:Xr,transformation:function(){var i=.5/(Math.PI*Xr.R);return K(i,.5,-i,.5)}()}),bs=u({},nt,{code:"EPSG:4326",projection:Vr,transformation:K(1/180,1,-1/180,.5)}),Do=u({},kt,{projection:Vr,transformation:K(1,0,-1,0),scale:function(i){return Math.pow(2,i)},zoom:function(i){return Math.log(i)/Math.LN2},distance:function(i,l){var g=l.lng-i.lng,y=l.lat-i.lat;return Math.sqrt(g*g+y*y)},infinite:!0});kt.Earth=nt,kt.EPSG3395=Ao,kt.EPSG3857=Rt,kt.EPSG900913=qt,kt.EPSG4326=bs,kt.Simple=Do;var Ue=Q.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(i){return i.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(i){return i&&i.removeLayer(this),this},getPane:function(i){return this._map.getPane(i?this.options[i]||i:this.options.pane)},addInteractiveTarget:function(i){return this._map._targets[x(i)]=this,this},removeInteractiveTarget:function(i){return delete this._map._targets[x(i)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(i){var l=i.target;if(l.hasLayer(this)){if(this._map=l,this._zoomAnimated=l._zoomAnimated,this.getEvents){var g=this.getEvents();l.on(g,this),this.once("remove",function(){l.off(g,this)},this)}this.onAdd(l),this.fire("add"),l.fire("layeradd",{layer:this})}}});Bt.include({addLayer:function(i){if(!i._layerAdd)throw new Error("The provided object is not a Layer.");var l=x(i);return this._layers[l]?this:(this._layers[l]=i,i._mapToAdd=this,i.beforeAdd&&i.beforeAdd(this),this.whenReady(i._layerAdd,i),this)},removeLayer:function(i){var l=x(i);return this._layers[l]?(this._loaded&&i.onRemove(this),delete this._layers[l],this._loaded&&(this.fire("layerremove",{layer:i}),i.fire("remove")),i._map=i._mapToAdd=null,this):this},hasLayer:function(i){return x(i)in this._layers},eachLayer:function(i,l){for(var g in this._layers)i.call(l,this._layers[g]);return this},_addLayers:function(i){i=i?G(i)?i:[i]:[];for(var l=0,g=i.length;l<g;l++)this.addLayer(i[l])},_addZoomLimit:function(i){(!isNaN(i.options.maxZoom)||!isNaN(i.options.minZoom))&&(this._zoomBoundLayers[x(i)]=i,this._updateZoomLevels())},_removeZoomLimit:function(i){var l=x(i);this._zoomBoundLayers[l]&&(delete this._zoomBoundLayers[l],this._updateZoomLevels())},_updateZoomLevels:function(){var i=1/0,l=-1/0,g=this._getZoomSpan();for(var y in this._zoomBoundLayers){var k=this._zoomBoundLayers[y].options;i=k.minZoom===void 0?i:Math.min(i,k.minZoom),l=k.maxZoom===void 0?l:Math.max(l,k.maxZoom)}this._layersMaxZoom=l===-1/0?void 0:l,this._layersMinZoom=i===1/0?void 0:i,g!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ei=Ue.extend({initialize:function(i,l){Z(this,l),this._layers={};var g,y;if(i)for(g=0,y=i.length;g<y;g++)this.addLayer(i[g])},addLayer:function(i){var l=this.getLayerId(i);return this._layers[l]=i,this._map&&this._map.addLayer(i),this},removeLayer:function(i){var l=i in this._layers?i:this.getLayerId(i);return this._map&&this._layers[l]&&this._map.removeLayer(this._layers[l]),delete this._layers[l],this},hasLayer:function(i){var l=typeof i=="number"?i:this.getLayerId(i);return l in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(i){var l=Array.prototype.slice.call(arguments,1),g,y;for(g in this._layers)y=this._layers[g],y[i]&&y[i].apply(y,l);return this},onAdd:function(i){this.eachLayer(i.addLayer,i)},onRemove:function(i){this.eachLayer(i.removeLayer,i)},eachLayer:function(i,l){for(var g in this._layers)i.call(l,this._layers[g]);return this},getLayer:function(i){return this._layers[i]},getLayers:function(){var i=[];return this.eachLayer(i.push,i),i},setZIndex:function(i){return this.invoke("setZIndex",i)},getLayerId:function(i){return x(i)}}),Ts=function(i,l){return new ei(i,l)},fn=ei.extend({addLayer:function(i){return this.hasLayer(i)?this:(i.addEventParent(this),ei.prototype.addLayer.call(this,i),this.fire("layeradd",{layer:i}))},removeLayer:function(i){return this.hasLayer(i)?(i in this._layers&&(i=this._layers[i]),i.removeEventParent(this),ei.prototype.removeLayer.call(this,i),this.fire("layerremove",{layer:i})):this},setStyle:function(i){return this.invoke("setStyle",i)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var i=new pt;for(var l in this._layers){var g=this._layers[l];i.extend(g.getBounds?g.getBounds():g.getLatLng())}return i}}),Ns=function(i,l){return new fn(i,l)},ni=H.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(i){Z(this,i)},createIcon:function(i){return this._createIcon("icon",i)},createShadow:function(i){return this._createIcon("shadow",i)},_createIcon:function(i,l){var g=this._getIconUrl(i);if(!g){if(i==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var y=this._createImg(g,l&&l.tagName==="IMG"?l:null);return this._setIconStyles(y,i),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),y},_setIconStyles:function(i,l){var g=this.options,y=g[l+"Size"];typeof y=="number"&&(y=[y,y]);var k=J(y),A=J(l==="shadow"&&g.shadowAnchor||g.iconAnchor||k&&k.divideBy(2,!0));i.className="leaflet-marker-"+l+" "+(g.className||""),A&&(i.style.marginLeft=-A.x+"px",i.style.marginTop=-A.y+"px"),k&&(i.style.width=k.x+"px",i.style.height=k.y+"px")},_createImg:function(i,l){return l=l||document.createElement("img"),l.src=i,l},_getIconUrl:function(i){return Lt.retina&&this.options[i+"RetinaUrl"]||this.options[i+"Url"]}});function Ro(i){return new ni(i)}var Mi=ni.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(i){return typeof Mi.imagePath!="string"&&(Mi.imagePath=this._detectIconPath()),(this.options.imagePath||Mi.imagePath)+ni.prototype._getIconUrl.call(this,i)},_stripUrl:function(i){var l=function(g,y,k){var A=y.exec(g);return A&&A[k]};return i=l(i,/^url\((['"])?(.+)\1\)$/,2),i&&l(i,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var i=Yt("div","leaflet-default-icon-path",document.body),l=We(i,"background-image")||We(i,"backgroundImage");if(document.body.removeChild(i),l=this._stripUrl(l),l)return l;var g=document.querySelector('link[href$="leaflet.css"]');return g?g.href.substring(0,g.href.length-11-1):""}}),Os=je.extend({initialize:function(i){this._marker=i},addHooks:function(){var i=this._marker._icon;this._draggable||(this._draggable=new kn(i,i,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Dt(i,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Jt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(i){var l=this._marker,g=l._map,y=this._marker.options.autoPanSpeed,k=this._marker.options.autoPanPadding,A=vn(l._icon),j=g.getPixelBounds(),st=g.getPixelOrigin(),lt=ct(j.min._subtract(st).add(k),j.max._subtract(st).subtract(k));if(!lt.contains(A)){var mt=J((Math.max(lt.max.x,A.x)-lt.max.x)/(j.max.x-lt.max.x)-(Math.min(lt.min.x,A.x)-lt.min.x)/(j.min.x-lt.min.x),(Math.max(lt.max.y,A.y)-lt.max.y)/(j.max.y-lt.max.y)-(Math.min(lt.min.y,A.y)-lt.min.y)/(j.min.y-lt.min.y)).multiplyBy(y);g.panBy(mt,{animate:!1}),this._draggable._newPos._add(mt),this._draggable._startPos._add(mt),le(l._icon,this._draggable._newPos),this._onDrag(i),this._panRequest=R(this._adjustPan.bind(this,i))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(i){this._marker.options.autoPan&&(F(this._panRequest),this._panRequest=R(this._adjustPan.bind(this,i)))},_onDrag:function(i){var l=this._marker,g=l._shadow,y=vn(l._icon),k=l._map.layerPointToLatLng(y);g&&le(g,y),l._latlng=k,i.latlng=k,i.oldLatLng=this._oldLatLng,l.fire("move",i).fire("drag",i)},_onDragEnd:function(i){F(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",i)}}),ji=Ue.extend({options:{icon:new Mi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(i,l){Z(this,l),this._latlng=gt(i)},onAdd:function(i){this._zoomAnimated=this._zoomAnimated&&i.options.markerZoomAnimation,this._zoomAnimated&&i.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(i){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&i.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(i){var l=this._latlng;return this._latlng=gt(i),this.update(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},setZIndexOffset:function(i){return this.options.zIndexOffset=i,this.update()},getIcon:function(){return this.options.icon},setIcon:function(i){return this.options.icon=i,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var i=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(i)}return this},_initIcon:function(){var i=this.options,l="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),g=i.icon.createIcon(this._icon),y=!1;g!==this._icon&&(this._icon&&this._removeIcon(),y=!0,i.title&&(g.title=i.title),g.tagName==="IMG"&&(g.alt=i.alt||"")),Dt(g,l),i.keyboard&&(g.tabIndex="0",g.setAttribute("role","button")),this._icon=g,i.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ft(g,"focus",this._panOnFocus,this);var k=i.icon.createShadow(this._shadow),A=!1;k!==this._shadow&&(this._removeShadow(),A=!0),k&&(Dt(k,l),k.alt=""),this._shadow=k,i.opacity<1&&this._updateOpacity(),y&&this.getPane().appendChild(this._icon),this._initInteraction(),k&&A&&this.getPane(i.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Qt(this._icon,"focus",this._panOnFocus,this),ne(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ne(this._shadow),this._shadow=null},_setPos:function(i){this._icon&&le(this._icon,i),this._shadow&&le(this._shadow,i),this._zIndex=i.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(i){this._icon&&(this._icon.style.zIndex=this._zIndex+i)},_animateZoom:function(i){var l=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center).round();this._setPos(l)},_initInteraction:function(){if(this.options.interactive&&(Dt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Os)){var i=this.options.draggable;this.dragging&&(i=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Os(this),i&&this.dragging.enable()}},setOpacity:function(i){return this.options.opacity=i,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var i=this.options.opacity;this._icon&&ge(this._icon,i),this._shadow&&ge(this._shadow,i)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var i=this._map;if(i){var l=this.options.icon.options,g=l.iconSize?J(l.iconSize):J(0,0),y=l.iconAnchor?J(l.iconAnchor):J(0,0);i.panInside(this._latlng,{paddingTopLeft:y,paddingBottomRight:g.subtract(y)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Fo(i,l){return new ji(i,l)}var wn=Ue.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(i){this._renderer=i.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(i){return Z(this,i),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&i&&Object.prototype.hasOwnProperty.call(i,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ii=wn.extend({options:{fill:!0,radius:10},initialize:function(i,l){Z(this,l),this._latlng=gt(i),this._radius=this.options.radius},setLatLng:function(i){var l=this._latlng;return this._latlng=gt(i),this.redraw(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(i){return this.options.radius=this._radius=i,this.redraw()},getRadius:function(){return this._radius},setStyle:function(i){var l=i&&i.radius||this._radius;return wn.prototype.setStyle.call(this,i),this.setRadius(l),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var i=this._radius,l=this._radiusY||i,g=this._clickTolerance(),y=[i+g,l+g];this._pxBounds=new ut(this._point.subtract(y),this._point.add(y))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(i){return i.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function As(i,l){return new Ii(i,l)}var Qi=Ii.extend({initialize:function(i,l,g){if(typeof l=="number"&&(l=u({},g,{radius:l})),Z(this,l),this._latlng=gt(i),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(i){return this._mRadius=i,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var i=[this._radius,this._radiusY||this._radius];return new pt(this._map.layerPointToLatLng(this._point.subtract(i)),this._map.layerPointToLatLng(this._point.add(i)))},setStyle:wn.prototype.setStyle,_project:function(){var i=this._latlng.lng,l=this._latlng.lat,g=this._map,y=g.options.crs;if(y.distance===nt.distance){var k=Math.PI/180,A=this._mRadius/nt.R/k,j=g.project([l+A,i]),st=g.project([l-A,i]),lt=j.add(st).divideBy(2),mt=g.unproject(lt).lat,wt=Math.acos((Math.cos(A*k)-Math.sin(l*k)*Math.sin(mt*k))/(Math.cos(l*k)*Math.cos(mt*k)))/k;(isNaN(wt)||wt===0)&&(wt=A/Math.cos(Math.PI/180*l)),this._point=lt.subtract(g.getPixelOrigin()),this._radius=isNaN(wt)?0:lt.x-g.project([mt,i-wt]).x,this._radiusY=lt.y-j.y}else{var Nt=y.unproject(y.project(this._latlng).subtract([this._mRadius,0]));this._point=g.latLngToLayerPoint(this._latlng),this._radius=this._point.x-g.latLngToLayerPoint(Nt).x}this._updateBounds()}});function Bo(i,l,g){return new Qi(i,l,g)}var Qe=wn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(i,l){Z(this,l),this._setLatLngs(i)},getLatLngs:function(){return this._latlngs},setLatLngs:function(i){return this._setLatLngs(i),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(i){for(var l=1/0,g=null,y=Li,k,A,j=0,st=this._parts.length;j<st;j++)for(var lt=this._parts[j],mt=1,wt=lt.length;mt<wt;mt++){k=lt[mt-1],A=lt[mt];var Nt=y(i,k,A,!0);Nt<l&&(l=Nt,g=y(i,k,A))}return g&&(g.distance=Math.sqrt(l)),g},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Zr(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(i,l){return l=l||this._defaultShape(),i=gt(i),l.push(i),this._bounds.extend(i),this.redraw()},_setLatLngs:function(i){this._bounds=new pt,this._latlngs=this._convertLatLngs(i)},_defaultShape:function(){return Ae(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(i){for(var l=[],g=Ae(i),y=0,k=i.length;y<k;y++)g?(l[y]=gt(i[y]),this._bounds.extend(l[y])):l[y]=this._convertLatLngs(i[y]);return l},_project:function(){var i=new ut;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,i),this._bounds.isValid()&&i.isValid()&&(this._rawPxBounds=i,this._updateBounds())},_updateBounds:function(){var i=this._clickTolerance(),l=new W(i,i);this._rawPxBounds&&(this._pxBounds=new ut([this._rawPxBounds.min.subtract(l),this._rawPxBounds.max.add(l)]))},_projectLatlngs:function(i,l,g){var y=i[0]instanceof ft,k=i.length,A,j;if(y){for(j=[],A=0;A<k;A++)j[A]=this._map.latLngToLayerPoint(i[A]),g.extend(j[A]);l.push(j)}else for(A=0;A<k;A++)this._projectLatlngs(i[A],l,g)},_clipPoints:function(){var i=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(i))){if(this.options.noClip){this._parts=this._rings;return}var l=this._parts,g,y,k,A,j,st,lt;for(g=0,k=0,A=this._rings.length;g<A;g++)for(lt=this._rings[g],y=0,j=lt.length;y<j-1;y++)st=Be(lt[y],lt[y+1],i,y,!0),st&&(l[k]=l[k]||[],l[k].push(st[0]),(st[1]!==lt[y+1]||y===j-2)&&(l[k].push(st[1]),k++))}},_simplifyPoints:function(){for(var i=this._parts,l=this.options.smoothFactor,g=0,y=i.length;g<y;g++)i[g]=Cs(i[g],l)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(i,l){var g,y,k,A,j,st,lt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(g=0,A=this._parts.length;g<A;g++)for(st=this._parts[g],y=0,j=st.length,k=j-1;y<j;k=y++)if(!(!l&&y===0)&&zr(i,st[k],st[y])<=lt)return!0;return!1}});function Wr(i,l){return new Qe(i,l)}Qe._flat=Ur;var ii=Qe.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ss(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(i){var l=Qe.prototype._convertLatLngs.call(this,i),g=l.length;return g>=2&&l[0]instanceof ft&&l[0].equals(l[g-1])&&l.pop(),l},_setLatLngs:function(i){Qe.prototype._setLatLngs.call(this,i),Ae(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ae(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var i=this._renderer._bounds,l=this.options.weight,g=new W(l,l);if(i=new ut(i.min.subtract(g),i.max.add(g)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(i))){if(this.options.noClip){this._parts=this._rings;return}for(var y=0,k=this._rings.length,A;y<k;y++)A=Is(this._rings[y],i,!0),A.length&&this._parts.push(A)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(i){var l=!1,g,y,k,A,j,st,lt,mt;if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(A=0,lt=this._parts.length;A<lt;A++)for(g=this._parts[A],j=0,mt=g.length,st=mt-1;j<mt;st=j++)y=g[j],k=g[st],y.y>i.y!=k.y>i.y&&i.x<(k.x-y.x)*(i.y-y.y)/(k.y-y.y)+y.x&&(l=!l);return l||Qe.prototype._containsPoint.call(this,i,!0)}});function Ds(i,l){return new ii(i,l)}var tn=fn.extend({initialize:function(i,l){Z(this,l),this._layers={},i&&this.addData(i)},addData:function(i){var l=G(i)?i:i.features,g,y,k;if(l){for(g=0,y=l.length;g<y;g++)k=l[g],(k.geometries||k.geometry||k.features||k.coordinates)&&this.addData(k);return this}var A=this.options;if(A.filter&&!A.filter(i))return this;var j=tr(i,A);return j?(j.feature=a(i),j.defaultOptions=j.options,this.resetStyle(j),A.onEachFeature&&A.onEachFeature(i,j),this.addLayer(j)):this},resetStyle:function(i){return i===void 0?this.eachLayer(this.resetStyle,this):(i.options=u({},i.defaultOptions),this._setLayerStyle(i,this.options.style),this)},setStyle:function(i){return this.eachLayer(function(l){this._setLayerStyle(l,i)},this)},_setLayerStyle:function(i,l){i.setStyle&&(typeof l=="function"&&(l=l(i.feature)),i.setStyle(l))}});function tr(i,l){var g=i.type==="Feature"?i.geometry:i,y=g?g.coordinates:null,k=[],A=l&&l.pointToLayer,j=l&&l.coordsToLatLng||En,st,lt,mt,wt;if(!y&&!g)return null;switch(g.type){case"Point":return st=j(y),Rs(A,i,st,l);case"MultiPoint":for(mt=0,wt=y.length;mt<wt;mt++)st=j(y[mt]),k.push(Rs(A,i,st,l));return new fn(k);case"LineString":case"MultiLineString":return lt=er(y,g.type==="LineString"?0:1,j),new Qe(lt,l);case"Polygon":case"MultiPolygon":return lt=er(y,g.type==="Polygon"?1:2,j),new ii(lt,l);case"GeometryCollection":for(mt=0,wt=g.geometries.length;mt<wt;mt++){var Nt=tr({geometry:g.geometries[mt],type:"Feature",properties:i.properties},l);Nt&&k.push(Nt)}return new fn(k);case"FeatureCollection":for(mt=0,wt=g.features.length;mt<wt;mt++){var Ut=tr(g.features[mt],l);Ut&&k.push(Ut)}return new fn(k);default:throw new Error("Invalid GeoJSON object.")}}function Rs(i,l,g,y){return i?i(l,g):new ji(g,y&&y.markersInheritOptions&&y)}function En(i){return new ft(i[1],i[0],i[2])}function er(i,l,g){for(var y=[],k=0,A=i.length,j;k<A;k++)j=l?er(i[k],l-1,g):(g||En)(i[k]),y.push(j);return y}function nr(i,l){return i=gt(i),i.alt!==void 0?[T(i.lng,l),T(i.lat,l),T(i.alt,l)]:[T(i.lng,l),T(i.lat,l)]}function Le(i,l,g,y){for(var k=[],A=0,j=i.length;A<j;A++)k.push(l?Le(i[A],Ae(i[A])?0:l-1,g,y):nr(i[A],y));return!l&&g&&k.length>0&&k.push(k[0].slice()),k}function Me(i,l){return i.feature?u({},i.feature,{geometry:l}):a(l)}function a(i){return i.type==="Feature"||i.type==="FeatureCollection"?i:{type:"Feature",properties:{},geometry:i}}var t={toGeoJSON:function(i){return Me(this,{type:"Point",coordinates:nr(this.getLatLng(),i)})}};ji.include(t),Qi.include(t),Ii.include(t),Qe.include({toGeoJSON:function(i){var l=!Ae(this._latlngs),g=Le(this._latlngs,l?1:0,!1,i);return Me(this,{type:(l?"Multi":"")+"LineString",coordinates:g})}}),ii.include({toGeoJSON:function(i){var l=!Ae(this._latlngs),g=l&&!Ae(this._latlngs[0]),y=Le(this._latlngs,g?2:l?1:0,!0,i);return l||(y=[y]),Me(this,{type:(g?"Multi":"")+"Polygon",coordinates:y})}}),ei.include({toMultiPoint:function(i){var l=[];return this.eachLayer(function(g){l.push(g.toGeoJSON(i).geometry.coordinates)}),Me(this,{type:"MultiPoint",coordinates:l})},toGeoJSON:function(i){var l=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(l==="MultiPoint")return this.toMultiPoint(i);var g=l==="GeometryCollection",y=[];return this.eachLayer(function(k){if(k.toGeoJSON){var A=k.toGeoJSON(i);if(g)y.push(A.geometry);else{var j=a(A);j.type==="FeatureCollection"?y.push.apply(y,j.features):y.push(j)}}}),g?Me(this,{geometries:y,type:"GeometryCollection"}):{type:"FeatureCollection",features:y}}});function e(i,l){return new tn(i,l)}var s=e,c=Ue.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(i,l,g){this._url=i,this._bounds=ht(l),Z(this,g)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Dt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ne(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(i){return this.options.opacity=i,this._image&&this._updateOpacity(),this},setStyle:function(i){return i.opacity&&this.setOpacity(i.opacity),this},bringToFront:function(){return this._map&&$n(this._image),this},bringToBack:function(){return this._map&&An(this._image),this},setUrl:function(i){return this._url=i,this._image&&(this._image.src=i),this},setBounds:function(i){return this._bounds=ht(i),this._map&&this._reset(),this},getEvents:function(){var i={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var i=this._url.tagName==="IMG",l=this._image=i?this._url:Yt("img");if(Dt(l,"leaflet-image-layer"),this._zoomAnimated&&Dt(l,"leaflet-zoom-animated"),this.options.className&&Dt(l,this.options.className),l.onselectstart=I,l.onmousemove=I,l.onload=m(this.fire,this,"load"),l.onerror=m(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(l.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),i){this._url=l.src;return}l.src=this._url,l.alt=this.options.alt},_animateZoom:function(i){var l=this._map.getZoomScale(i.zoom),g=this._map._latLngBoundsToNewLayerBounds(this._bounds,i.zoom,i.center).min;Dn(this._image,g,l)},_reset:function(){var i=this._image,l=new ut(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),g=l.getSize();le(i,l.min),i.style.width=g.x+"px",i.style.height=g.y+"px"},_updateOpacity:function(){ge(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var i=this.options.errorOverlayUrl;i&&this._url!==i&&(this._url=i,this._image.src=i)},getCenter:function(){return this._bounds.getCenter()}}),p=function(i,l,g){return new c(i,l,g)},_=c.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var i=this._url.tagName==="VIDEO",l=this._image=i?this._url:Yt("video");if(Dt(l,"leaflet-image-layer"),this._zoomAnimated&&Dt(l,"leaflet-zoom-animated"),this.options.className&&Dt(l,this.options.className),l.onselectstart=I,l.onmousemove=I,l.onloadeddata=m(this.fire,this,"load"),i){for(var g=l.getElementsByTagName("source"),y=[],k=0;k<g.length;k++)y.push(g[k].src);this._url=g.length>0?y:[l.src];return}G(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(l.style,"objectFit")&&(l.style.objectFit="fill"),l.autoplay=!!this.options.autoplay,l.loop=!!this.options.loop,l.muted=!!this.options.muted,l.playsInline=!!this.options.playsInline;for(var A=0;A<this._url.length;A++){var j=Yt("source");j.src=this._url[A],l.appendChild(j)}}});function M(i,l,g){return new _(i,l,g)}var O=c.extend({_initImage:function(){var i=this._image=this._url;Dt(i,"leaflet-image-layer"),this._zoomAnimated&&Dt(i,"leaflet-zoom-animated"),this.options.className&&Dt(i,this.options.className),i.onselectstart=I,i.onmousemove=I}});function U(i,l,g){return new O(i,l,g)}var et=Ue.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(i,l){i&&(i instanceof ft||G(i))?(this._latlng=gt(i),Z(this,l)):(Z(this,i),this._source=l),this.options.content&&(this._content=this.options.content)},openOn:function(i){return i=arguments.length?i:this._source._map,i.hasLayer(this)||i.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(i){return this._map?this.close():(arguments.length?this._source=i:i=this._source,this._prepareOpen(),this.openOn(i._map)),this},onAdd:function(i){this._zoomAnimated=i._zoomAnimated,this._container||this._initLayout(),i._fadeAnimated&&ge(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),i._fadeAnimated&&ge(this._container,1),this.bringToFront(),this.options.interactive&&(Dt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(i){i._fadeAnimated?(ge(this._container,0),this._removeTimeout=setTimeout(m(ne,void 0,this._container),200)):ne(this._container),this.options.interactive&&(Jt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(i){return this._latlng=gt(i),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(i){return this._content=i,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var i={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&$n(this._container),this},bringToBack:function(){return this._map&&An(this._container),this},_prepareOpen:function(i){var l=this._source;if(!l._map)return!1;if(l instanceof fn){l=null;var g=this._source._layers;for(var y in g)if(g[y]._map){l=g[y];break}if(!l)return!1;this._source=l}if(!i)if(l.getCenter)i=l.getCenter();else if(l.getLatLng)i=l.getLatLng();else if(l.getBounds)i=l.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(i),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var i=this._contentNode,l=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof l=="string")i.innerHTML=l;else{for(;i.hasChildNodes();)i.removeChild(i.firstChild);i.appendChild(l)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var i=this._map.latLngToLayerPoint(this._latlng),l=J(this.options.offset),g=this._getAnchor();this._zoomAnimated?le(this._container,i.add(g)):l=l.add(i).add(g);var y=this._containerBottom=-l.y,k=this._containerLeft=-Math.round(this._containerWidth/2)+l.x;this._container.style.bottom=y+"px",this._container.style.left=k+"px"}},_getAnchor:function(){return[0,0]}});Bt.include({_initOverlay:function(i,l,g,y){var k=l;return k instanceof i||(k=new i(y).setContent(l)),g&&k.setLatLng(g),k}}),Ue.include({_initOverlay:function(i,l,g,y){var k=g;return k instanceof i?(Z(k,y),k._source=this):(k=l&&!y?l:new i(y,this),k.setContent(g)),k}});var rt=et.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(i){return i=arguments.length?i:this._source._map,!i.hasLayer(this)&&i._popup&&i._popup.options.autoClose&&i.removeLayer(i._popup),i._popup=this,et.prototype.openOn.call(this,i)},onAdd:function(i){et.prototype.onAdd.call(this,i),i.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof wn||this._source.on("preclick",pe))},onRemove:function(i){et.prototype.onRemove.call(this,i),i.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof wn||this._source.off("preclick",pe))},getEvents:function(){var i=et.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(i.preclick=this.close),this.options.keepInView&&(i.moveend=this._adjustPan),i},_initLayout:function(){var i="leaflet-popup",l=this._container=Yt("div",i+" "+(this.options.className||"")+" leaflet-zoom-animated"),g=this._wrapper=Yt("div",i+"-content-wrapper",l);if(this._contentNode=Yt("div",i+"-content",g),ti(l),wi(this._contentNode),Ft(l,"contextmenu",pe),this._tipContainer=Yt("div",i+"-tip-container",l),this._tip=Yt("div",i+"-tip",this._tipContainer),this.options.closeButton){var y=this._closeButton=Yt("a",i+"-close-button",l);y.setAttribute("role","button"),y.setAttribute("aria-label","Close popup"),y.href="#close",y.innerHTML='<span aria-hidden="true">&#215;</span>',Ft(y,"click",function(k){re(k),this.close()},this)}},_updateLayout:function(){var i=this._contentNode,l=i.style;l.width="",l.whiteSpace="nowrap";var g=i.offsetWidth;g=Math.min(g,this.options.maxWidth),g=Math.max(g,this.options.minWidth),l.width=g+1+"px",l.whiteSpace="",l.height="";var y=i.offsetHeight,k=this.options.maxHeight,A="leaflet-popup-scrolled";k&&y>k?(l.height=k+"px",Dt(i,A)):Jt(i,A),this._containerWidth=this._container.offsetWidth},_animateZoom:function(i){var l=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center),g=this._getAnchor();le(this._container,l.add(g))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var i=this._map,l=parseInt(We(this._container,"marginBottom"),10)||0,g=this._container.offsetHeight+l,y=this._containerWidth,k=new W(this._containerLeft,-g-this._containerBottom);k._add(vn(this._container));var A=i.layerPointToContainerPoint(k),j=J(this.options.autoPanPadding),st=J(this.options.autoPanPaddingTopLeft||j),lt=J(this.options.autoPanPaddingBottomRight||j),mt=i.getSize(),wt=0,Nt=0;A.x+y+lt.x>mt.x&&(wt=A.x+y-mt.x+lt.x),A.x-wt-st.x<0&&(wt=A.x-st.x),A.y+g+lt.y>mt.y&&(Nt=A.y+g-mt.y+lt.y),A.y-Nt-st.y<0&&(Nt=A.y-st.y),(wt||Nt)&&(this.options.keepInView&&(this._autopanning=!0),i.fire("autopanstart").panBy([wt,Nt]))}},_getAnchor:function(){return J(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),dt=function(i,l){return new rt(i,l)};Bt.mergeOptions({closePopupOnClick:!0}),Bt.include({openPopup:function(i,l,g){return this._initOverlay(rt,i,l,g).openOn(this),this},closePopup:function(i){return i=arguments.length?i:this._popup,i&&i.close(),this}}),Ue.include({bindPopup:function(i,l){return this._popup=this._initOverlay(rt,this._popup,i,l),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(i){return this._popup&&(this instanceof fn||(this._popup._source=this),this._popup._prepareOpen(i||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(i){return this._popup&&this._popup.setContent(i),this},getPopup:function(){return this._popup},_openPopup:function(i){if(!(!this._popup||!this._map)){_n(i);var l=i.layer||i.target;if(this._popup._source===l&&!(l instanceof wn)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(i.latlng);return}this._popup._source=l,this.openPopup(i.latlng)}},_movePopup:function(i){this._popup.setLatLng(i.latlng)},_onKeyPress:function(i){i.originalEvent.keyCode===13&&this._openPopup(i)}});var xt=et.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(i){et.prototype.onAdd.call(this,i),this.setOpacity(this.options.opacity),i.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(i){et.prototype.onRemove.call(this,i),i.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var i=et.prototype.getEvents.call(this);return this.options.permanent||(i.preclick=this.close),i},_initLayout:function(){var i="leaflet-tooltip",l=i+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Yt("div",l),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+x(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(i){var l,g,y=this._map,k=this._container,A=y.latLngToContainerPoint(y.getCenter()),j=y.layerPointToContainerPoint(i),st=this.options.direction,lt=k.offsetWidth,mt=k.offsetHeight,wt=J(this.options.offset),Nt=this._getAnchor();st==="top"?(l=lt/2,g=mt):st==="bottom"?(l=lt/2,g=0):st==="center"?(l=lt/2,g=mt/2):st==="right"?(l=0,g=mt/2):st==="left"?(l=lt,g=mt/2):j.x<A.x?(st="right",l=0,g=mt/2):(st="left",l=lt+(wt.x+Nt.x)*2,g=mt/2),i=i.subtract(J(l,g,!0)).add(wt).add(Nt),Jt(k,"leaflet-tooltip-right"),Jt(k,"leaflet-tooltip-left"),Jt(k,"leaflet-tooltip-top"),Jt(k,"leaflet-tooltip-bottom"),Dt(k,"leaflet-tooltip-"+st),le(k,i)},_updatePosition:function(){var i=this._map.latLngToLayerPoint(this._latlng);this._setPosition(i)},setOpacity:function(i){this.options.opacity=i,this._container&&ge(this._container,i)},_animateZoom:function(i){var l=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center);this._setPosition(l)},_getAnchor:function(){return J(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Pt=function(i,l){return new xt(i,l)};Bt.include({openTooltip:function(i,l,g){return this._initOverlay(xt,i,l,g).openOn(this),this},closeTooltip:function(i){return i.close(),this}}),Ue.include({bindTooltip:function(i,l){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(xt,this._tooltip,i,l),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(i){if(!(!i&&this._tooltipHandlersAdded)){var l=i?"off":"on",g={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?g.add=this._openTooltip:(g.mouseover=this._openTooltip,g.mouseout=this.closeTooltip,g.click=this._openTooltip,this._map?this._addFocusListeners():g.add=this._addFocusListeners),this._tooltip.options.sticky&&(g.mousemove=this._moveTooltip),this[l](g),this._tooltipHandlersAdded=!i}},openTooltip:function(i){return this._tooltip&&(this instanceof fn||(this._tooltip._source=this),this._tooltip._prepareOpen(i)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(i){return this._tooltip&&this._tooltip.setContent(i),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(i){var l=typeof i.getElement=="function"&&i.getElement();l&&(Ft(l,"focus",function(){this._tooltip._source=i,this.openTooltip()},this),Ft(l,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(i){var l=typeof i.getElement=="function"&&i.getElement();l&&l.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(i){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var l=this;this._map.once("moveend",function(){l._openOnceFlag=!1,l._openTooltip(i)});return}this._tooltip._source=i.layer||i.target,this.openTooltip(this._tooltip.options.sticky?i.latlng:void 0)}},_moveTooltip:function(i){var l=i.latlng,g,y;this._tooltip.options.sticky&&i.originalEvent&&(g=this._map.mouseEventToContainerPoint(i.originalEvent),y=this._map.containerPointToLayerPoint(g),l=this._map.layerPointToLatLng(y)),this._tooltip.setLatLng(l)}});var Mt=ni.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(i){var l=i&&i.tagName==="DIV"?i:document.createElement("div"),g=this.options;if(g.html instanceof Element?(Ui(l),l.appendChild(g.html)):l.innerHTML=g.html!==!1?g.html:"",g.bgPos){var y=J(g.bgPos);l.style.backgroundPosition=-y.x+"px "+-y.y+"px"}return this._setIconStyles(l,"icon"),l},createShadow:function(){return null}});function Vt(i){return new Mt(i)}ni.Default=Mi;var Ht=Ue.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Lt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(i){Z(this,i)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(i){i._addZoomLimit(this)},onRemove:function(i){this._removeAllTiles(),ne(this._container),i._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&($n(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(An(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(i){return this.options.opacity=i,this._updateOpacity(),this},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var i=this._clampZoom(this._map.getZoom());i!==this._tileZoom&&(this._tileZoom=i,this._updateLevels()),this._update()}return this},getEvents:function(){var i={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=v(this._onMoveEnd,this.options.updateInterval,this)),i.move=this._onMove),this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},createTile:function(){return document.createElement("div")},getTileSize:function(){var i=this.options.tileSize;return i instanceof W?i:new W(i,i)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(i){for(var l=this.getPane().children,g=-i(-1/0,1/0),y=0,k=l.length,A;y<k;y++)A=l[y].style.zIndex,l[y]!==this._container&&A&&(g=i(g,+A));isFinite(g)&&(this.options.zIndex=g+i(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Lt.ielt9){ge(this._container,this.options.opacity);var i=+new Date,l=!1,g=!1;for(var y in this._tiles){var k=this._tiles[y];if(!(!k.current||!k.loaded)){var A=Math.min(1,(i-k.loaded)/200);ge(k.el,A),A<1?l=!0:(k.active?g=!0:this._onOpaqueTile(k),k.active=!0)}}g&&!this._noPrune&&this._pruneTiles(),l&&(F(this._fadeFrame),this._fadeFrame=R(this._updateOpacity,this))}},_onOpaqueTile:I,_initContainer:function(){this._container||(this._container=Yt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var i=this._tileZoom,l=this.options.maxZoom;if(i!==void 0){for(var g in this._levels)g=Number(g),this._levels[g].el.children.length||g===i?(this._levels[g].el.style.zIndex=l-Math.abs(i-g),this._onUpdateLevel(g)):(ne(this._levels[g].el),this._removeTilesAtZoom(g),this._onRemoveLevel(g),delete this._levels[g]);var y=this._levels[i],k=this._map;return y||(y=this._levels[i]={},y.el=Yt("div","leaflet-tile-container leaflet-zoom-animated",this._container),y.el.style.zIndex=l,y.origin=k.project(k.unproject(k.getPixelOrigin()),i).round(),y.zoom=i,this._setZoomTransform(y,k.getCenter(),k.getZoom()),I(y.el.offsetWidth),this._onCreateLevel(y)),this._level=y,y}},_onUpdateLevel:I,_onRemoveLevel:I,_onCreateLevel:I,_pruneTiles:function(){if(this._map){var i,l,g=this._map.getZoom();if(g>this.options.maxZoom||g<this.options.minZoom){this._removeAllTiles();return}for(i in this._tiles)l=this._tiles[i],l.retain=l.current;for(i in this._tiles)if(l=this._tiles[i],l.current&&!l.active){var y=l.coords;this._retainParent(y.x,y.y,y.z,y.z-5)||this._retainChildren(y.x,y.y,y.z,y.z+2)}for(i in this._tiles)this._tiles[i].retain||this._removeTile(i)}},_removeTilesAtZoom:function(i){for(var l in this._tiles)this._tiles[l].coords.z===i&&this._removeTile(l)},_removeAllTiles:function(){for(var i in this._tiles)this._removeTile(i)},_invalidateAll:function(){for(var i in this._levels)ne(this._levels[i].el),this._onRemoveLevel(Number(i)),delete this._levels[i];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(i,l,g,y){var k=Math.floor(i/2),A=Math.floor(l/2),j=g-1,st=new W(+k,+A);st.z=+j;var lt=this._tileCoordsToKey(st),mt=this._tiles[lt];return mt&&mt.active?(mt.retain=!0,!0):(mt&&mt.loaded&&(mt.retain=!0),j>y?this._retainParent(k,A,j,y):!1)},_retainChildren:function(i,l,g,y){for(var k=2*i;k<2*i+2;k++)for(var A=2*l;A<2*l+2;A++){var j=new W(k,A);j.z=g+1;var st=this._tileCoordsToKey(j),lt=this._tiles[st];if(lt&&lt.active){lt.retain=!0;continue}else lt&&lt.loaded&&(lt.retain=!0);g+1<y&&this._retainChildren(k,A,g+1,y)}},_resetView:function(i){var l=i&&(i.pinch||i.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),l,l)},_animateZoom:function(i){this._setView(i.center,i.zoom,!0,i.noUpdate)},_clampZoom:function(i){var l=this.options;return l.minNativeZoom!==void 0&&i<l.minNativeZoom?l.minNativeZoom:l.maxNativeZoom!==void 0&&l.maxNativeZoom<i?l.maxNativeZoom:i},_setView:function(i,l,g,y){var k=Math.round(l);this.options.maxZoom!==void 0&&k>this.options.maxZoom||this.options.minZoom!==void 0&&k<this.options.minZoom?k=void 0:k=this._clampZoom(k);var A=this.options.updateWhenZooming&&k!==this._tileZoom;(!y||A)&&(this._tileZoom=k,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),k!==void 0&&this._update(i),g||this._pruneTiles(),this._noPrune=!!g),this._setZoomTransforms(i,l)},_setZoomTransforms:function(i,l){for(var g in this._levels)this._setZoomTransform(this._levels[g],i,l)},_setZoomTransform:function(i,l,g){var y=this._map.getZoomScale(g,i.zoom),k=i.origin.multiplyBy(y).subtract(this._map._getNewPixelOrigin(l,g)).round();Lt.any3d?Dn(i.el,k,y):le(i.el,k)},_resetGrid:function(){var i=this._map,l=i.options.crs,g=this._tileSize=this.getTileSize(),y=this._tileZoom,k=this._map.getPixelWorldBounds(this._tileZoom);k&&(this._globalTileRange=this._pxBoundsToTileRange(k)),this._wrapX=l.wrapLng&&!this.options.noWrap&&[Math.floor(i.project([0,l.wrapLng[0]],y).x/g.x),Math.ceil(i.project([0,l.wrapLng[1]],y).x/g.y)],this._wrapY=l.wrapLat&&!this.options.noWrap&&[Math.floor(i.project([l.wrapLat[0],0],y).y/g.x),Math.ceil(i.project([l.wrapLat[1],0],y).y/g.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(i){var l=this._map,g=l._animatingZoom?Math.max(l._animateToZoom,l.getZoom()):l.getZoom(),y=l.getZoomScale(g,this._tileZoom),k=l.project(i,this._tileZoom).floor(),A=l.getSize().divideBy(y*2);return new ut(k.subtract(A),k.add(A))},_update:function(i){var l=this._map;if(l){var g=this._clampZoom(l.getZoom());if(i===void 0&&(i=l.getCenter()),this._tileZoom!==void 0){var y=this._getTiledPixelBounds(i),k=this._pxBoundsToTileRange(y),A=k.getCenter(),j=[],st=this.options.keepBuffer,lt=new ut(k.getBottomLeft().subtract([st,-st]),k.getTopRight().add([st,-st]));if(!(isFinite(k.min.x)&&isFinite(k.min.y)&&isFinite(k.max.x)&&isFinite(k.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var mt in this._tiles){var wt=this._tiles[mt].coords;(wt.z!==this._tileZoom||!lt.contains(new W(wt.x,wt.y)))&&(this._tiles[mt].current=!1)}if(Math.abs(g-this._tileZoom)>1){this._setView(i,g);return}for(var Nt=k.min.y;Nt<=k.max.y;Nt++)for(var Ut=k.min.x;Ut<=k.max.x;Ut++){var De=new W(Ut,Nt);if(De.z=this._tileZoom,!!this._isValidTile(De)){var _e=this._tiles[this._tileCoordsToKey(De)];_e?_e.current=!0:j.push(De)}}if(j.sort(function(ze,rr){return ze.distanceTo(A)-rr.distanceTo(A)}),j.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var nn=document.createDocumentFragment();for(Ut=0;Ut<j.length;Ut++)this._addTile(j[Ut],nn);this._level.el.appendChild(nn)}}}},_isValidTile:function(i){var l=this._map.options.crs;if(!l.infinite){var g=this._globalTileRange;if(!l.wrapLng&&(i.x<g.min.x||i.x>g.max.x)||!l.wrapLat&&(i.y<g.min.y||i.y>g.max.y))return!1}if(!this.options.bounds)return!0;var y=this._tileCoordsToBounds(i);return ht(this.options.bounds).overlaps(y)},_keyToBounds:function(i){return this._tileCoordsToBounds(this._keyToTileCoords(i))},_tileCoordsToNwSe:function(i){var l=this._map,g=this.getTileSize(),y=i.scaleBy(g),k=y.add(g),A=l.unproject(y,i.z),j=l.unproject(k,i.z);return[A,j]},_tileCoordsToBounds:function(i){var l=this._tileCoordsToNwSe(i),g=new pt(l[0],l[1]);return this.options.noWrap||(g=this._map.wrapLatLngBounds(g)),g},_tileCoordsToKey:function(i){return i.x+":"+i.y+":"+i.z},_keyToTileCoords:function(i){var l=i.split(":"),g=new W(+l[0],+l[1]);return g.z=+l[2],g},_removeTile:function(i){var l=this._tiles[i];l&&(ne(l.el),delete this._tiles[i],this.fire("tileunload",{tile:l.el,coords:this._keyToTileCoords(i)}))},_initTile:function(i){Dt(i,"leaflet-tile");var l=this.getTileSize();i.style.width=l.x+"px",i.style.height=l.y+"px",i.onselectstart=I,i.onmousemove=I,Lt.ielt9&&this.options.opacity<1&&ge(i,this.options.opacity)},_addTile:function(i,l){var g=this._getTilePos(i),y=this._tileCoordsToKey(i),k=this.createTile(this._wrapCoords(i),m(this._tileReady,this,i));this._initTile(k),this.createTile.length<2&&R(m(this._tileReady,this,i,null,k)),le(k,g),this._tiles[y]={el:k,coords:i,current:!0},l.appendChild(k),this.fire("tileloadstart",{tile:k,coords:i})},_tileReady:function(i,l,g){l&&this.fire("tileerror",{error:l,tile:g,coords:i});var y=this._tileCoordsToKey(i);g=this._tiles[y],g&&(g.loaded=+new Date,this._map._fadeAnimated?(ge(g.el,0),F(this._fadeFrame),this._fadeFrame=R(this._updateOpacity,this)):(g.active=!0,this._pruneTiles()),l||(Dt(g.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:g.el,coords:i})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Lt.ielt9||!this._map._fadeAnimated?R(this._pruneTiles,this):setTimeout(m(this._pruneTiles,this),250)))},_getTilePos:function(i){return i.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(i){var l=new W(this._wrapX?w(i.x,this._wrapX):i.x,this._wrapY?w(i.y,this._wrapY):i.y);return l.z=i.z,l},_pxBoundsToTileRange:function(i){var l=this.getTileSize();return new ut(i.min.unscaleBy(l).floor(),i.max.unscaleBy(l).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var i in this._tiles)if(!this._tiles[i].loaded)return!1;return!0}});function te(i){return new Ht(i)}var ie=Ht.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(i,l){this._url=i,l=Z(this,l),l.detectRetina&&Lt.retina&&l.maxZoom>0?(l.tileSize=Math.floor(l.tileSize/2),l.zoomReverse?(l.zoomOffset--,l.minZoom=Math.min(l.maxZoom,l.minZoom+1)):(l.zoomOffset++,l.maxZoom=Math.max(l.minZoom,l.maxZoom-1)),l.minZoom=Math.max(0,l.minZoom)):l.zoomReverse?l.minZoom=Math.min(l.maxZoom,l.minZoom):l.maxZoom=Math.max(l.minZoom,l.maxZoom),typeof l.subdomains=="string"&&(l.subdomains=l.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(i,l){return this._url===i&&l===void 0&&(l=!0),this._url=i,l||this.redraw(),this},createTile:function(i,l){var g=document.createElement("img");return Ft(g,"load",m(this._tileOnLoad,this,l,g)),Ft(g,"error",m(this._tileOnError,this,l,g)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(g.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(g.referrerPolicy=this.options.referrerPolicy),g.alt="",g.src=this.getTileUrl(i),g},getTileUrl:function(i){var l={r:Lt.retina?"@2x":"",s:this._getSubdomain(i),x:i.x,y:i.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var g=this._globalTileRange.max.y-i.y;this.options.tms&&(l.y=g),l["-y"]=g}return E(this._url,u(l,this.options))},_tileOnLoad:function(i,l){Lt.ielt9?setTimeout(m(i,this,null,l),0):i(null,l)},_tileOnError:function(i,l,g){var y=this.options.errorTileUrl;y&&l.getAttribute("src")!==y&&(l.src=y),i(g,l)},_onTileRemove:function(i){i.tile.onload=null},_getZoomForUrl:function(){var i=this._tileZoom,l=this.options.maxZoom,g=this.options.zoomReverse,y=this.options.zoomOffset;return g&&(i=l-i),i+y},_getSubdomain:function(i){var l=Math.abs(i.x+i.y)%this.options.subdomains.length;return this.options.subdomains[l]},_abortLoading:function(){var i,l;for(i in this._tiles)if(this._tiles[i].coords.z!==this._tileZoom&&(l=this._tiles[i].el,l.onload=I,l.onerror=I,!l.complete)){l.src=B;var g=this._tiles[i].coords;ne(l),delete this._tiles[i],this.fire("tileabort",{tile:l,coords:g})}},_removeTile:function(i){var l=this._tiles[i];if(l)return l.el.setAttribute("src",B),Ht.prototype._removeTile.call(this,i)},_tileReady:function(i,l,g){if(!(!this._map||g&&g.getAttribute("src")===B))return Ht.prototype._tileReady.call(this,i,l,g)}});function de(i,l){return new ie(i,l)}var Pn=ie.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(i,l){this._url=i;var g=u({},this.defaultWmsParams);for(var y in l)y in this.options||(g[y]=l[y]);l=Z(this,l);var k=l.detectRetina&&Lt.retina?2:1,A=this.getTileSize();g.width=A.x*k,g.height=A.y*k,this.wmsParams=g},onAdd:function(i){this._crs=this.options.crs||i.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var l=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[l]=this._crs.code,ie.prototype.onAdd.call(this,i)},getTileUrl:function(i){var l=this._tileCoordsToNwSe(i),g=this._crs,y=ct(g.project(l[0]),g.project(l[1])),k=y.min,A=y.max,j=(this._wmsVersion>=1.3&&this._crs===bs?[k.y,k.x,A.y,A.x]:[k.x,k.y,A.x,A.y]).join(","),st=ie.prototype.getTileUrl.call(this,i);return st+Y(this.wmsParams,st,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+j},setParams:function(i,l){return u(this.wmsParams,i),l||this.redraw(),this}});function Si(i,l){return new Pn(i,l)}ie.WMS=Pn,de.wms=Si;var en=Ue.extend({options:{padding:.1},initialize:function(i){Z(this,i),x(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Dt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var i={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(i.zoomanim=this._onAnimZoom),i},_onAnimZoom:function(i){this._updateTransform(i.center,i.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(i,l){var g=this._map.getZoomScale(l,this._zoom),y=this._map.getSize().multiplyBy(.5+this.options.padding),k=this._map.project(this._center,l),A=y.multiplyBy(-g).add(k).subtract(this._map._getNewPixelOrigin(i,l));Lt.any3d?Dn(this._container,A,g):le(this._container,A)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var i in this._layers)this._layers[i]._reset()},_onZoomEnd:function(){for(var i in this._layers)this._layers[i]._project()},_updatePaths:function(){for(var i in this._layers)this._layers[i]._update()},_update:function(){var i=this.options.padding,l=this._map.getSize(),g=this._map.containerPointToLayerPoint(l.multiplyBy(-i)).round();this._bounds=new ut(g,g.add(l.multiplyBy(1+i*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Kr=en.extend({options:{tolerance:0},getEvents:function(){var i=en.prototype.getEvents.call(this);return i.viewprereset=this._onViewPreReset,i},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){en.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var i=this._container=document.createElement("canvas");Ft(i,"mousemove",this._onMouseMove,this),Ft(i,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ft(i,"mouseout",this._handleMouseOut,this),i._leaflet_disable_events=!0,this._ctx=i.getContext("2d")},_destroyContainer:function(){F(this._redrawRequest),delete this._ctx,ne(this._container),Qt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var i;this._redrawBounds=null;for(var l in this._layers)i=this._layers[l],i._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){en.prototype._update.call(this);var i=this._bounds,l=this._container,g=i.getSize(),y=Lt.retina?2:1;le(l,i.min),l.width=y*g.x,l.height=y*g.y,l.style.width=g.x+"px",l.style.height=g.y+"px",Lt.retina&&this._ctx.scale(2,2),this._ctx.translate(-i.min.x,-i.min.y),this.fire("update")}},_reset:function(){en.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(i){this._updateDashArray(i),this._layers[x(i)]=i;var l=i._order={layer:i,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=l),this._drawLast=l,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(i){this._requestRedraw(i)},_removePath:function(i){var l=i._order,g=l.next,y=l.prev;g?g.prev=y:this._drawLast=y,y?y.next=g:this._drawFirst=g,delete i._order,delete this._layers[x(i)],this._requestRedraw(i)},_updatePath:function(i){this._extendRedrawBounds(i),i._project(),i._update(),this._requestRedraw(i)},_updateStyle:function(i){this._updateDashArray(i),this._requestRedraw(i)},_updateDashArray:function(i){if(typeof i.options.dashArray=="string"){var l=i.options.dashArray.split(/[, ]+/),g=[],y,k;for(k=0;k<l.length;k++){if(y=Number(l[k]),isNaN(y))return;g.push(y)}i.options._dashArray=g}else i.options._dashArray=i.options.dashArray},_requestRedraw:function(i){this._map&&(this._extendRedrawBounds(i),this._redrawRequest=this._redrawRequest||R(this._redraw,this))},_extendRedrawBounds:function(i){if(i._pxBounds){var l=(i.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ut,this._redrawBounds.extend(i._pxBounds.min.subtract([l,l])),this._redrawBounds.extend(i._pxBounds.max.add([l,l]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var i=this._redrawBounds;if(i){var l=i.getSize();this._ctx.clearRect(i.min.x,i.min.y,l.x,l.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var i,l=this._redrawBounds;if(this._ctx.save(),l){var g=l.getSize();this._ctx.beginPath(),this._ctx.rect(l.min.x,l.min.y,g.x,g.y),this._ctx.clip()}this._drawing=!0;for(var y=this._drawFirst;y;y=y.next)i=y.layer,(!l||i._pxBounds&&i._pxBounds.intersects(l))&&i._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(i,l){if(this._drawing){var g,y,k,A,j=i._parts,st=j.length,lt=this._ctx;if(st){for(lt.beginPath(),g=0;g<st;g++){for(y=0,k=j[g].length;y<k;y++)A=j[g][y],lt[y?"lineTo":"moveTo"](A.x,A.y);l&&lt.closePath()}this._fillStroke(lt,i)}}},_updateCircle:function(i){if(!(!this._drawing||i._empty())){var l=i._point,g=this._ctx,y=Math.max(Math.round(i._radius),1),k=(Math.max(Math.round(i._radiusY),1)||y)/y;k!==1&&(g.save(),g.scale(1,k)),g.beginPath(),g.arc(l.x,l.y/k,y,0,Math.PI*2,!1),k!==1&&g.restore(),this._fillStroke(g,i)}},_fillStroke:function(i,l){var g=l.options;g.fill&&(i.globalAlpha=g.fillOpacity,i.fillStyle=g.fillColor||g.color,i.fill(g.fillRule||"evenodd")),g.stroke&&g.weight!==0&&(i.setLineDash&&i.setLineDash(l.options&&l.options._dashArray||[]),i.globalAlpha=g.opacity,i.lineWidth=g.weight,i.strokeStyle=g.color,i.lineCap=g.lineCap,i.lineJoin=g.lineJoin,i.stroke())},_onClick:function(i){for(var l=this._map.mouseEventToLayerPoint(i),g,y,k=this._drawFirst;k;k=k.next)g=k.layer,g.options.interactive&&g._containsPoint(l)&&(!(i.type==="click"||i.type==="preclick")||!this._map._draggableMoved(g))&&(y=g);this._fireEvent(y?[y]:!1,i)},_onMouseMove:function(i){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var l=this._map.mouseEventToLayerPoint(i);this._handleMouseHover(i,l)}},_handleMouseOut:function(i){var l=this._hoveredLayer;l&&(Jt(this._container,"leaflet-interactive"),this._fireEvent([l],i,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(i,l){if(!this._mouseHoverThrottled){for(var g,y,k=this._drawFirst;k;k=k.next)g=k.layer,g.options.interactive&&g._containsPoint(l)&&(y=g);y!==this._hoveredLayer&&(this._handleMouseOut(i),y&&(Dt(this._container,"leaflet-interactive"),this._fireEvent([y],i,"mouseover"),this._hoveredLayer=y)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,i),this._mouseHoverThrottled=!0,setTimeout(m(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(i,l,g){this._map._fireDOMEvent(l,g||l.type,i)},_bringToFront:function(i){var l=i._order;if(l){var g=l.next,y=l.prev;if(g)g.prev=y;else return;y?y.next=g:g&&(this._drawFirst=g),l.prev=this._drawLast,this._drawLast.next=l,l.next=null,this._drawLast=l,this._requestRedraw(i)}},_bringToBack:function(i){var l=i._order;if(l){var g=l.next,y=l.prev;if(y)y.next=g;else return;g?g.prev=y:y&&(this._drawLast=y),l.prev=null,l.next=this._drawFirst,this._drawFirst.prev=l,this._drawFirst=l,this._requestRedraw(i)}}});function $r(i){return Lt.canvas?new Kr(i):null}var ri=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(i){return document.createElement("<lvml:"+i+' class="lvml">')}}catch{}return function(i){return document.createElement("<"+i+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Fs={_initContainer:function(){this._container=Yt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(en.prototype._update.call(this),this.fire("update"))},_initPath:function(i){var l=i._container=ri("shape");Dt(l,"leaflet-vml-shape "+(this.options.className||"")),l.coordsize="1 1",i._path=ri("path"),l.appendChild(i._path),this._updateStyle(i),this._layers[x(i)]=i},_addPath:function(i){var l=i._container;this._container.appendChild(l),i.options.interactive&&i.addInteractiveTarget(l)},_removePath:function(i){var l=i._container;ne(l),i.removeInteractiveTarget(l),delete this._layers[x(i)]},_updateStyle:function(i){var l=i._stroke,g=i._fill,y=i.options,k=i._container;k.stroked=!!y.stroke,k.filled=!!y.fill,y.stroke?(l||(l=i._stroke=ri("stroke")),k.appendChild(l),l.weight=y.weight+"px",l.color=y.color,l.opacity=y.opacity,y.dashArray?l.dashStyle=G(y.dashArray)?y.dashArray.join(" "):y.dashArray.replace(/( *, *)/g," "):l.dashStyle="",l.endcap=y.lineCap.replace("butt","flat"),l.joinstyle=y.lineJoin):l&&(k.removeChild(l),i._stroke=null),y.fill?(g||(g=i._fill=ri("fill")),k.appendChild(g),g.color=y.fillColor||y.color,g.opacity=y.fillOpacity):g&&(k.removeChild(g),i._fill=null)},_updateCircle:function(i){var l=i._point.round(),g=Math.round(i._radius),y=Math.round(i._radiusY||g);this._setPath(i,i._empty()?"M0 0":"AL "+l.x+","+l.y+" "+g+","+y+" 0,"+65535*360)},_setPath:function(i,l){i._path.v=l},_bringToFront:function(i){$n(i._container)},_bringToBack:function(i){An(i._container)}},Ci=Lt.vml?ri:St,Bn=en.extend({_initContainer:function(){this._container=Ci("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ci("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ne(this._container),Qt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){en.prototype._update.call(this);var i=this._bounds,l=i.getSize(),g=this._container;(!this._svgSize||!this._svgSize.equals(l))&&(this._svgSize=l,g.setAttribute("width",l.x),g.setAttribute("height",l.y)),le(g,i.min),g.setAttribute("viewBox",[i.min.x,i.min.y,l.x,l.y].join(" ")),this.fire("update")}},_initPath:function(i){var l=i._path=Ci("path");i.options.className&&Dt(l,i.options.className),i.options.interactive&&Dt(l,"leaflet-interactive"),this._updateStyle(i),this._layers[x(i)]=i},_addPath:function(i){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(i._path),i.addInteractiveTarget(i._path)},_removePath:function(i){ne(i._path),i.removeInteractiveTarget(i._path),delete this._layers[x(i)]},_updatePath:function(i){i._project(),i._update()},_updateStyle:function(i){var l=i._path,g=i.options;l&&(g.stroke?(l.setAttribute("stroke",g.color),l.setAttribute("stroke-opacity",g.opacity),l.setAttribute("stroke-width",g.weight),l.setAttribute("stroke-linecap",g.lineCap),l.setAttribute("stroke-linejoin",g.lineJoin),g.dashArray?l.setAttribute("stroke-dasharray",g.dashArray):l.removeAttribute("stroke-dasharray"),g.dashOffset?l.setAttribute("stroke-dashoffset",g.dashOffset):l.removeAttribute("stroke-dashoffset")):l.setAttribute("stroke","none"),g.fill?(l.setAttribute("fill",g.fillColor||g.color),l.setAttribute("fill-opacity",g.fillOpacity),l.setAttribute("fill-rule",g.fillRule||"evenodd")):l.setAttribute("fill","none"))},_updatePoly:function(i,l){this._setPath(i,we(i._parts,l))},_updateCircle:function(i){var l=i._point,g=Math.max(Math.round(i._radius),1),y=Math.max(Math.round(i._radiusY),1)||g,k="a"+g+","+y+" 0 1,0 ",A=i._empty()?"M0 0":"M"+(l.x-g)+","+l.y+k+g*2+",0 "+k+-g*2+",0 ";this._setPath(i,A)},_setPath:function(i,l){i._path.setAttribute("d",l)},_bringToFront:function(i){$n(i._path)},_bringToBack:function(i){An(i._path)}});Lt.vml&&Bn.include(Fs);function ir(i){return Lt.svg||Lt.vml?new Bn(i):null}Bt.include({getRenderer:function(i){var l=i.options.renderer||this._getPaneRenderer(i.options.pane)||this.options.renderer||this._renderer;return l||(l=this._renderer=this._createRenderer()),this.hasLayer(l)||this.addLayer(l),l},_getPaneRenderer:function(i){if(i==="overlayPane"||i===void 0)return!1;var l=this._paneRenderers[i];return l===void 0&&(l=this._createRenderer({pane:i}),this._paneRenderers[i]=l),l},_createRenderer:function(i){return this.options.preferCanvas&&$r(i)||ir(i)}});var ya=ii.extend({initialize:function(i,l){ii.prototype.initialize.call(this,this._boundsToLatLngs(i),l)},setBounds:function(i){return this.setLatLngs(this._boundsToLatLngs(i))},_boundsToLatLngs:function(i){return i=ht(i),[i.getSouthWest(),i.getNorthWest(),i.getNorthEast(),i.getSouthEast()]}});function El(i,l){return new ya(i,l)}Bn.create=Ci,Bn.pointsToPath=we,tn.geometryToLayer=tr,tn.coordsToLatLng=En,tn.coordsToLatLngs=er,tn.latLngToCoords=nr,tn.latLngsToCoords=Le,tn.getFeature=Me,tn.asFeature=a,Bt.mergeOptions({boxZoom:!0});var va=je.extend({initialize:function(i){this._map=i,this._container=i._container,this._pane=i._panes.overlayPane,this._resetStateTimeout=0,i.on("unload",this._destroy,this)},addHooks:function(){Ft(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Qt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ne(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(i){if(!i.shiftKey||i.which!==1&&i.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ln(),Nr(),this._startPoint=this._map.mouseEventToContainerPoint(i),Ft(document,{contextmenu:_n,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(i){this._moved||(this._moved=!0,this._box=Yt("div","leaflet-zoom-box",this._container),Dt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(i);var l=new ut(this._point,this._startPoint),g=l.getSize();le(this._box,l.min),this._box.style.width=g.x+"px",this._box.style.height=g.y+"px"},_finish:function(){this._moved&&(ne(this._box),Jt(this._container,"leaflet-crosshair")),Jn(),xi(),Qt(document,{contextmenu:_n,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(i){if(!(i.which!==1&&i.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(m(this._resetState,this),0);var l=new pt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(l).fire("boxzoomend",{boxZoomBounds:l})}},_onKeyDown:function(i){i.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Bt.addInitHook("addHandler","boxZoom",va),Bt.mergeOptions({doubleClickZoom:!0});var _a=je.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(i){var l=this._map,g=l.getZoom(),y=l.options.zoomDelta,k=i.originalEvent.shiftKey?g-y:g+y;l.options.doubleClickZoom==="center"?l.setZoom(k):l.setZoomAround(i.containerPoint,k)}});Bt.addInitHook("addHandler","doubleClickZoom",_a),Bt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var xa=je.extend({addHooks:function(){if(!this._draggable){var i=this._map;this._draggable=new kn(i._mapPane,i._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),i.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),i.on("zoomend",this._onZoomEnd,this),i.whenReady(this._onZoomEnd,this))}Dt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Jt(this._map._container,"leaflet-grab"),Jt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var i=this._map;if(i._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var l=ht(this._map.options.maxBounds);this._offsetLimit=ct(this._map.latLngToContainerPoint(l.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(l.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;i.fire("movestart").fire("dragstart"),i.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(i){if(this._map.options.inertia){var l=this._lastTime=+new Date,g=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(g),this._times.push(l),this._prunePositions(l)}this._map.fire("move",i).fire("drag",i)},_prunePositions:function(i){for(;this._positions.length>1&&i-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var i=this._map.getSize().divideBy(2),l=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=l.subtract(i).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(i,l){return i-(i-l)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var i=this._draggable._newPos.subtract(this._draggable._startPos),l=this._offsetLimit;i.x<l.min.x&&(i.x=this._viscousLimit(i.x,l.min.x)),i.y<l.min.y&&(i.y=this._viscousLimit(i.y,l.min.y)),i.x>l.max.x&&(i.x=this._viscousLimit(i.x,l.max.x)),i.y>l.max.y&&(i.y=this._viscousLimit(i.y,l.max.y)),this._draggable._newPos=this._draggable._startPos.add(i)}},_onPreDragWrap:function(){var i=this._worldWidth,l=Math.round(i/2),g=this._initialWorldOffset,y=this._draggable._newPos.x,k=(y-l+g)%i+l-g,A=(y+l+g)%i-l-g,j=Math.abs(k+g)<Math.abs(A+g)?k:A;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=j},_onDragEnd:function(i){var l=this._map,g=l.options,y=!g.inertia||i.noInertia||this._times.length<2;if(l.fire("dragend",i),y)l.fire("moveend");else{this._prunePositions(+new Date);var k=this._lastPos.subtract(this._positions[0]),A=(this._lastTime-this._times[0])/1e3,j=g.easeLinearity,st=k.multiplyBy(j/A),lt=st.distanceTo([0,0]),mt=Math.min(g.inertiaMaxSpeed,lt),wt=st.multiplyBy(mt/lt),Nt=mt/(g.inertiaDeceleration*j),Ut=wt.multiplyBy(-Nt/2).round();!Ut.x&&!Ut.y?l.fire("moveend"):(Ut=l._limitOffset(Ut,l.options.maxBounds),R(function(){l.panBy(Ut,{duration:Nt,easeLinearity:j,noMoveStart:!0,animate:!0})}))}}});Bt.addInitHook("addHandler","dragging",xa),Bt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ka=je.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(i){this._map=i,this._setPanDelta(i.options.keyboardPanDelta),this._setZoomDelta(i.options.zoomDelta)},addHooks:function(){var i=this._map._container;i.tabIndex<=0&&(i.tabIndex="0"),Ft(i,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Qt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var i=document.body,l=document.documentElement,g=i.scrollTop||l.scrollTop,y=i.scrollLeft||l.scrollLeft;this._map._container.focus(),window.scrollTo(y,g)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(i){var l=this._panKeys={},g=this.keyCodes,y,k;for(y=0,k=g.left.length;y<k;y++)l[g.left[y]]=[-1*i,0];for(y=0,k=g.right.length;y<k;y++)l[g.right[y]]=[i,0];for(y=0,k=g.down.length;y<k;y++)l[g.down[y]]=[0,i];for(y=0,k=g.up.length;y<k;y++)l[g.up[y]]=[0,-1*i]},_setZoomDelta:function(i){var l=this._zoomKeys={},g=this.keyCodes,y,k;for(y=0,k=g.zoomIn.length;y<k;y++)l[g.zoomIn[y]]=i;for(y=0,k=g.zoomOut.length;y<k;y++)l[g.zoomOut[y]]=-i},_addHooks:function(){Ft(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Qt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(i){if(!(i.altKey||i.ctrlKey||i.metaKey)){var l=i.keyCode,g=this._map,y;if(l in this._panKeys){if(!g._panAnim||!g._panAnim._inProgress)if(y=this._panKeys[l],i.shiftKey&&(y=J(y).multiplyBy(3)),g.options.maxBounds&&(y=g._limitOffset(J(y),g.options.maxBounds)),g.options.worldCopyJump){var k=g.wrapLatLng(g.unproject(g.project(g.getCenter()).add(y)));g.panTo(k)}else g.panBy(y)}else if(l in this._zoomKeys)g.setZoom(g.getZoom()+(i.shiftKey?3:1)*this._zoomKeys[l]);else if(l===27&&g._popup&&g._popup.options.closeOnEscapeKey)g.closePopup();else return;_n(i)}}});Bt.addInitHook("addHandler","keyboard",ka),Bt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var wa=je.extend({addHooks:function(){Ft(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Qt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(i){var l=Fr(i),g=this._map.options.wheelDebounceTime;this._delta+=l,this._lastMousePos=this._map.mouseEventToContainerPoint(i),this._startTime||(this._startTime=+new Date);var y=Math.max(g-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(m(this._performZoom,this),y),_n(i)},_performZoom:function(){var i=this._map,l=i.getZoom(),g=this._map.options.zoomSnap||0;i._stop();var y=this._delta/(this._map.options.wheelPxPerZoomLevel*4),k=4*Math.log(2/(1+Math.exp(-Math.abs(y))))/Math.LN2,A=g?Math.ceil(k/g)*g:k,j=i._limitZoom(l+(this._delta>0?A:-A))-l;this._delta=0,this._startTime=null,j&&(i.options.scrollWheelZoom==="center"?i.setZoom(l+j):i.setZoomAround(this._lastMousePos,l+j))}});Bt.addInitHook("addHandler","scrollWheelZoom",wa);var Pl=600;Bt.mergeOptions({tapHold:Lt.touchNative&&Lt.safari&&Lt.mobile,tapTolerance:15});var Ea=je.extend({addHooks:function(){Ft(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Qt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(i){if(clearTimeout(this._holdTimeout),i.touches.length===1){var l=i.touches[0];this._startPos=this._newPos=new W(l.clientX,l.clientY),this._holdTimeout=setTimeout(m(function(){this._cancel(),this._isTapValid()&&(Ft(document,"touchend",re),Ft(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",l))},this),Pl),Ft(document,"touchend touchcancel contextmenu",this._cancel,this),Ft(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function i(){Qt(document,"touchend",re),Qt(document,"touchend touchcancel",i)},_cancel:function(){clearTimeout(this._holdTimeout),Qt(document,"touchend touchcancel contextmenu",this._cancel,this),Qt(document,"touchmove",this._onMove,this)},_onMove:function(i){var l=i.touches[0];this._newPos=new W(l.clientX,l.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(i,l){var g=new MouseEvent(i,{bubbles:!0,cancelable:!0,view:window,screenX:l.screenX,screenY:l.screenY,clientX:l.clientX,clientY:l.clientY});g._simulated=!0,l.target.dispatchEvent(g)}});Bt.addInitHook("addHandler","tapHold",Ea),Bt.mergeOptions({touchZoom:Lt.touch,bounceAtZoomLimits:!0});var Pa=je.extend({addHooks:function(){Dt(this._map._container,"leaflet-touch-zoom"),Ft(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Jt(this._map._container,"leaflet-touch-zoom"),Qt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(i){var l=this._map;if(!(!i.touches||i.touches.length!==2||l._animatingZoom||this._zooming)){var g=l.mouseEventToContainerPoint(i.touches[0]),y=l.mouseEventToContainerPoint(i.touches[1]);this._centerPoint=l.getSize()._divideBy(2),this._startLatLng=l.containerPointToLatLng(this._centerPoint),l.options.touchZoom!=="center"&&(this._pinchStartLatLng=l.containerPointToLatLng(g.add(y)._divideBy(2))),this._startDist=g.distanceTo(y),this._startZoom=l.getZoom(),this._moved=!1,this._zooming=!0,l._stop(),Ft(document,"touchmove",this._onTouchMove,this),Ft(document,"touchend touchcancel",this._onTouchEnd,this),re(i)}},_onTouchMove:function(i){if(!(!i.touches||i.touches.length!==2||!this._zooming)){var l=this._map,g=l.mouseEventToContainerPoint(i.touches[0]),y=l.mouseEventToContainerPoint(i.touches[1]),k=g.distanceTo(y)/this._startDist;if(this._zoom=l.getScaleZoom(k,this._startZoom),!l.options.bounceAtZoomLimits&&(this._zoom<l.getMinZoom()&&k<1||this._zoom>l.getMaxZoom()&&k>1)&&(this._zoom=l._limitZoom(this._zoom)),l.options.touchZoom==="center"){if(this._center=this._startLatLng,k===1)return}else{var A=g._add(y)._divideBy(2)._subtract(this._centerPoint);if(k===1&&A.x===0&&A.y===0)return;this._center=l.unproject(l.project(this._pinchStartLatLng,this._zoom).subtract(A),this._zoom)}this._moved||(l._moveStart(!0,!1),this._moved=!0),F(this._animRequest);var j=m(l._move,l,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=R(j,this,!0),re(i)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,F(this._animRequest),Qt(document,"touchmove",this._onTouchMove,this),Qt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Bt.addInitHook("addHandler","touchZoom",Pa),Bt.BoxZoom=va,Bt.DoubleClickZoom=_a,Bt.Drag=xa,Bt.Keyboard=ka,Bt.ScrollWheelZoom=wa,Bt.TapHold=Ea,Bt.TouchZoom=Pa,r.Bounds=ut,r.Browser=Lt,r.CRS=kt,r.Canvas=Kr,r.Circle=Qi,r.CircleMarker=Ii,r.Class=H,r.Control=qe,r.DivIcon=Mt,r.DivOverlay=et,r.DomEvent=Io,r.DomUtil=Vi,r.Draggable=kn,r.Evented=Q,r.FeatureGroup=fn,r.GeoJSON=tn,r.GridLayer=Ht,r.Handler=je,r.Icon=ni,r.ImageOverlay=c,r.LatLng=ft,r.LatLngBounds=pt,r.Layer=Ue,r.LayerGroup=ei,r.LineUtil=Yr,r.Map=Bt,r.Marker=ji,r.Mixin=To,r.Path=wn,r.Point=W,r.PolyUtil=Oe,r.Polygon=ii,r.Polyline=Qe,r.Popup=rt,r.PosAnimation=Br,r.Projection=Oo,r.Rectangle=ya,r.Renderer=en,r.SVG=Bn,r.SVGOverlay=O,r.TileLayer=ie,r.Tooltip=xt,r.Transformation=vt,r.Util=V,r.VideoOverlay=_,r.bind=m,r.bounds=ct,r.canvas=$r,r.circle=Bo,r.circleMarker=As,r.control=ve,r.divIcon=Vt,r.extend=u,r.featureGroup=Ns,r.geoJSON=e,r.geoJson=s,r.gridLayer=te,r.icon=Ro,r.imageOverlay=p,r.latLng=gt,r.latLngBounds=ht,r.layerGroup=Ts,r.map=Ki,r.marker=Fo,r.point=J,r.polygon=Ds,r.polyline=Wr,r.popup=dt,r.rectangle=El,r.setOptions=Z,r.stamp=x,r.svg=ir,r.svgOverlay=U,r.tileLayer=de,r.tooltip=Pt,r.transformation=K,r.version=o,r.videoOverlay=M;var Ll=window.L;r.noConflict=function(){return window.L=Ll,this},window.L=r})}(ns,ns.exports)),ns.exports}var ot=Fl();const Bl=Dl(ot),zl=Al({__proto__:null,default:Bl},[ot]);var Gl=Object.defineProperty,Hl=(h,n,r)=>n in h?Gl(h,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[n]=r,at=(h,n,r)=>Hl(h,typeof n!="symbol"?n+"":n,r),Ca,ba;const ql=!0,Ul=!1,Zl={draw:!0,subtract:!0,deleteAll:!0,p2p:!0,attachElbow:!0,dragElbow:!0,dragPolygons:!0,edgeDeletion:!0},Yl={opacity:.7,dragCursor:"move",hoverCursor:"grab",markerBehavior:"hide",markerAnimationDuration:200,modifierSubtract:{keys:{windows:"ctrlKey",mac:"metaKey",linux:"ctrlKey"},hideMarkersOnDrag:!0}},Vl={keys:{windows:"ctrlKey",mac:"metaKey",linux:"ctrlKey"},minVertices:3},Xl={deleteMarker:!0,infoMarker:!0,menuMarker:!0,coordsTitle:!0,zIndexOffset:0,markerIcon:{styleClasses:["polygon-marker"],zIndexOffset:null},holeIcon:{styleClasses:["polygon-marker","hole"],zIndexOffset:null},markerInfoIcon:{position:3,showArea:!0,showPerimeter:!0,useMetrics:!0,usePerimeterMinValue:!1,areaLabel:"Area",perimeterLabel:"Perimeter",values:{min:{metric:"50",imperial:"100"},unknown:{metric:"-",imperial:"-"}},units:{unknownUnit:"",metric:{onlyMetrics:!0,perimeter:{m:"m",km:"km"},area:{m2:"m",km2:"km",daa:"daa",ha:"ha"}},imperial:{perimeter:{feet:"ft",yards:"yd",miles:"mi"},area:{feet2:"ft",yards2:"yd",acres:"ac",miles2:"mi"}}},styleClasses:["polygon-marker","info"],zIndexOffset:1e4},markerMenuIcon:{position:7,styleClasses:["polygon-marker","menu"],zIndexOffset:1e4},markerDeleteIcon:{position:5,styleClasses:["polygon-marker","delete"],zIndexOffset:1e4},holeMarkers:{menuMarker:!1,deleteMarker:!0,infoMarker:!1},visualOptimization:{sharpAngleThreshold:30,thresholdBoundingBox:.05,thresholdDistance:.05,useDistance:!0,useBoundingBox:!1,useAngles:!1}},Wl={opacity:1,smoothFactor:0,noClip:!0,clickable:!1,weight:2},Kl={opacity:1,smoothFactor:0,noClip:!0,clickable:!1,weight:2},$l={smoothFactor:.3,noClip:!0},Jl={weight:2,opacity:1,fillOpacity:.5},jl={method:"concaveman",simplification:{mode:"simple",tolerance:1e-5,highQuality:!1}},Ql={simplifyTolerance:{tolerance:1e-4,highQuality:!1,mutate:!1},dynamicMode:{fractionGuard:.9,multiplier:2}},th={simplify:{processHoles:!0},doubleElbows:{processHoles:!0},bbox:{processHoles:!0}},eh={addMidPointMarkers:!0},nh={resolution:1e4,sharpness:.75},ih={dragPolygons:{subtract:"#D9460F"},p2p:{closingMarker:"#4CAF50"},edgeHover:"#7a9441",edgeDeletion:{hover:"#D9460F"},polyline:"#50622b",subtractLine:"#D9460F",polygon:{border:"#50622b",fill:"#b4cd8a"},hole:{border:"#aa0000",fill:"#ffcccc"},styles:{controlButton:{backgroundColor:"#fff",color:"#000"},controlButtonHover:{backgroundColor:"#f4f4f4"},controlButtonActive:{backgroundColor:"rgb(128, 218, 255)",color:"#fff"},indicatorActive:{backgroundColor:"#ffcc00"},p2pMarker:{backgroundColor:"#fff",borderColor:"#50622b"}}},Ni={mergePolygons:ql,kinks:Ul,modes:Zl,dragPolygons:Yl,edgeDeletion:Vl,markers:Xl,polyLineOptions:Wl,subtractLineOptions:Kl,polygonOptions:$l,holeOptions:Jl,polygonCreation:jl,simplification:Ql,menuOperations:th,boundingBox:eh,bezier:nh,colors:ih};var Et=(h=>(h.V1="1.x",h.V2="2.x",h))(Et||{}),At=(h=>(h[h.Off=0]="Off",h[h.Add=1]="Add",h[h.Edit=2]="Edit",h[h.Subtract=4]="Subtract",h[h.AppendMarker=8]="AppendMarker",h[h.LoadPredefined=16]="LoadPredefined",h[h.PointToPoint=32]="PointToPoint",h))(At||{}),sn=(h=>(h[h.SouthWest=0]="SouthWest",h[h.South=1]="South",h[h.SouthEast=2]="SouthEast",h[h.East=3]="East",h[h.NorthEast=4]="NorthEast",h[h.North=5]="North",h[h.NorthWest=6]="NorthWest",h[h.West=7]="West",h[h.Hole=8]="Hole",h))(sn||{});const to={MEAN_METERS:6371e3,MEAN_KILOMETERS:6371,MEAN_MILES:3959},cr={DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI};function Ie(h,n={}){return{type:"Feature",geometry:{type:"Point",coordinates:h},properties:n}}function Go(h,n={}){return{type:"Feature",geometry:{type:"LineString",coordinates:h},properties:n}}function dn(h,n={}){return{type:"Feature",geometry:{type:"Polygon",coordinates:h},properties:n}}function sr(h,n={}){return{type:"Feature",geometry:{type:"MultiPolygon",coordinates:h},properties:n}}function or(h){return{type:"FeatureCollection",features:h}}function Ti(h){if(h.geometry.type==="Polygon")return[h.geometry.coordinates];if(h.geometry.type==="MultiPolygon")return h.geometry.coordinates;throw new Error("Feature must be a Polygon or MultiPolygon")}function rh(h){let n=1/0,r=1/0,o=-1/0,u=-1/0;const f=m=>{if(Array.isArray(m[0]))m.forEach(f);else{const[d,x]=m;n=Math.min(n,d),r=Math.min(r,x),o=Math.max(o,d),u=Math.max(u,x)}};return f(h.geometry.coordinates),[n,r,o,u]}function sh(h){const[n,r,o,u]=h;return dn([[[n,r],[o,r],[o,u],[n,u],[n,r]]])}function Ta(h,n,r="kilometers"){const o=Array.isArray(h)?h:h.geometry.coordinates,u=Array.isArray(n)?n:n.geometry.coordinates,[f,m]=o,[d,x]=u,v=r==="miles"?to.MEAN_MILES:r==="meters"?to.MEAN_METERS:to.MEAN_KILOMETERS,w=zs(x-m),I=zs(d-f),T=Math.sin(w/2)*Math.sin(w/2)+Math.cos(zs(m))*Math.cos(zs(x))*Math.sin(I/2)*Math.sin(I/2),b=2*Math.atan2(Math.sqrt(T),Math.sqrt(1-T));return v*b}function Na(h,n){const r=Array.isArray(h)?h:h.geometry.coordinates,o=Array.isArray(n)?n:n.geometry.coordinates,[u,f]=r,[m,d]=o,x=(u+m)/2,v=(f+d)/2;return Ie([x,v])}function Ho(h){const n=Ti(h);let r=0;for(const o of n)for(let u=0;u<o.length;u++){const f=o[u],m=ah(f);r+=u===0?Math.abs(m):-Math.abs(m)}return Math.abs(r)}function oh(h){const n=Ti(h);let r=0,o=0,u=0;for(const f of n)for(const m of f)for(const d of m)r+=d[0],o+=d[1],u++;return Ie([r/u,o/u])}function zs(h){return h*cr.DEG_TO_RAD}function ah(h){let n=0;const r=h.length;for(let o=0;o<r-1;o++){const[u,f]=h[o],[m,d]=h[o+1];n+=u*d-m*f}return Math.abs(n)*.5*Math.pow(to.MEAN_METERS*cr.DEG_TO_RAD,2)}var be=63710088e-1,Au={centimeters:be*100,centimetres:be*100,degrees:360/(2*Math.PI),feet:be*3.28084,inches:be*39.37,kilometers:be/1e3,kilometres:be/1e3,meters:be,metres:be,miles:be/1609.344,millimeters:be*1e3,millimetres:be*1e3,nauticalmiles:be/1852,radians:1,yards:be*1.0936};function mn(h,n,r={}){const o={type:"Feature"};return(r.id===0||r.id)&&(o.id=r.id),r.bbox&&(o.bbox=r.bbox),o.properties=n||{},o.geometry=h,o}function Hn(h,n,r={}){if(!h)throw new Error("coordinates is required");if(!Array.isArray(h))throw new Error("coordinates must be an Array");if(h.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Oa(h[0])||!Oa(h[1]))throw new Error("coordinates must contain numbers");return mn({type:"Point",coordinates:h},n,r)}function Yn(h,n,r={}){for(const u of h){if(u.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(u[u.length-1].length!==u[0].length)throw new Error("First and last Position are not equivalent.");for(let f=0;f<u[u.length-1].length;f++)if(u[u.length-1][f]!==u[0][f])throw new Error("First and last Position are not equivalent.")}return mn({type:"Polygon",coordinates:h},n,r)}function xo(h,n,r={}){if(h.length<2)throw new Error("coordinates must be an array of two or more positions");return mn({type:"LineString",coordinates:h},n,r)}function Sn(h,n={}){const r={type:"FeatureCollection"};return n.id&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.features=h,r}function uh(h,n,r={}){return mn({type:"MultiLineString",coordinates:h},n,r)}function ko(h,n,r={}){return mn({type:"MultiPolygon",coordinates:h},n,r)}function Du(h,n="kilometers"){const r=Au[n];if(!r)throw new Error(n+" units is invalid");return h*r}function lh(h,n="kilometers"){const r=Au[n];if(!r)throw new Error(n+" units is invalid");return h/r}function Gs(h){return h%360*Math.PI/180}function Oa(h){return!isNaN(h)&&h!==null&&!Array.isArray(h)}function hh(h){return h!==null&&typeof h=="object"&&!Array.isArray(h)}function qn(h,n,r){if(h!==null)for(var o,u,f,m,d,x,v,w=0,I=0,T,b=h.type,D=b==="FeatureCollection",Z=b==="Feature",Y=D?h.features.length:1,tt=0;tt<Y;tt++){v=D?h.features[tt].geometry:Z?h.geometry:h,T=v?v.type==="GeometryCollection":!1,d=T?v.geometries.length:1;for(var E=0;E<d;E++){var G=0,N=0;if(m=T?v.geometries[E]:v,m!==null){x=m.coordinates;var B=m.type;switch(w=r&&(B==="Polygon"||B==="MultiPolygon")?1:0,B){case null:break;case"Point":if(n(x,I,tt,G,N)===!1)return!1;I++,G++;break;case"LineString":case"MultiPoint":for(o=0;o<x.length;o++){if(n(x[o],I,tt,G,N)===!1)return!1;I++,B==="MultiPoint"&&G++}B==="LineString"&&G++;break;case"Polygon":case"MultiLineString":for(o=0;o<x.length;o++){for(u=0;u<x[o].length-w;u++){if(n(x[o][u],I,tt,G,N)===!1)return!1;I++}B==="MultiLineString"&&G++,B==="Polygon"&&N++}B==="Polygon"&&G++;break;case"MultiPolygon":for(o=0;o<x.length;o++){for(N=0,u=0;u<x[o].length;u++){for(f=0;f<x[o][u].length-w;f++){if(n(x[o][u][f],I,tt,G,N)===!1)return!1;I++}N++}G++}break;case"GeometryCollection":for(o=0;o<m.geometries.length;o++)if(qn(m.geometries[o],n,r)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function li(h,n){if(h.type==="Feature")n(h,0);else if(h.type==="FeatureCollection")for(var r=0;r<h.features.length&&n(h.features[r],r)!==!1;r++);}function ci(h,n){var r,o,u,f,m,d,x,v,w,I,T=0,b=h.type==="FeatureCollection",D=h.type==="Feature",Z=b?h.features.length:1;for(r=0;r<Z;r++){for(d=b?h.features[r].geometry:D?h.geometry:h,v=b?h.features[r].properties:D?h.properties:{},w=b?h.features[r].bbox:D?h.bbox:void 0,I=b?h.features[r].id:D?h.id:void 0,x=d?d.type==="GeometryCollection":!1,m=x?d.geometries.length:1,u=0;u<m;u++){if(f=x?d.geometries[u]:d,f===null){if(n(null,T,v,w,I)===!1)return!1;continue}switch(f.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(f,T,v,w,I)===!1)return!1;break}case"GeometryCollection":{for(o=0;o<f.geometries.length;o++)if(n(f.geometries[o],T,v,w,I)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}T++}}function ch(h,n,r){var o=r;return ci(h,function(u,f,m,d,x){o=n(o,u,f,m,d,x)}),o}function Ru(h,n){ci(h,function(r,o,u,f,m){var d=r===null?null:r.type;switch(d){case null:case"Point":case"LineString":case"Polygon":return n(mn(r,u,{bbox:f,id:m}),o,0)===!1?!1:void 0}var x;switch(d){case"MultiPoint":x="Point";break;case"MultiLineString":x="LineString";break;case"MultiPolygon":x="Polygon";break}for(var v=0;v<r.coordinates.length;v++){var w=r.coordinates[v],I={type:x,coordinates:w};if(n(mn(I,u),o,v)===!1)return!1}})}function fh(h,n){Ru(h,function(r,o,u){var f=0;if(r.geometry){var m=r.geometry.type;if(!(m==="Point"||m==="MultiPoint")){var d,x=0,v=0,w=0;if(qn(r,function(I,T,b,D,Z){if(d===void 0||o>x||D>v||Z>w){d=I,x=o,v=D,w=Z,f=0;return}var Y=xo([d,I],r.properties);if(n(Y,o,u,Z,f)===!1)return!1;f++,d=I})===!1)return!1}}})}function gh(h,n,r){var o=r,u=!1;return fh(h,function(f,m,d,x,v){u===!1&&r===void 0?o=f:o=n(o,f,m,d,x,v),u=!0}),o}function Fu(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}function dh(h){if(Object.prototype.hasOwnProperty.call(h,"__esModule"))return h;var n=h.default;if(typeof n=="function"){var r=function o(){return this instanceof o?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};r.prototype=n.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(h).forEach(function(o){var u=Object.getOwnPropertyDescriptor(h,o);Object.defineProperty(r,o,u.get?u:{enumerable:!0,get:function(){return h[o]}})}),r}var Hs={exports:{}},eo={exports:{}},mh=eo.exports,Aa;function ph(){return Aa||(Aa=1,function(h,n){(function(r,o){h.exports=o()})(mh,function(){function r(E,G,N,B,z){(function $(P,S,C,R,F){for(;R>C;){if(R-C>600){var V=R-C+1,H=S-C+1,X=Math.log(V),q=.5*Math.exp(2*X/3),Q=.5*Math.sqrt(X*q*(V-q)/V)*(H-V/2<0?-1:1),W=Math.max(C,Math.floor(S-H*q/V+Q)),it=Math.min(R,Math.floor(S+(V-H)*q/V+Q));$(P,S,W,it,F)}var J=P[S],ut=C,ct=R;for(o(P,C,S),F(P[R],J)>0&&o(P,C,R);ut<ct;){for(o(P,ut,ct),ut++,ct--;F(P[ut],J)<0;)ut++;for(;F(P[ct],J)>0;)ct--}F(P[C],J)===0?o(P,C,ct):o(P,++ct,R),ct<=S&&(C=ct+1),S<=ct&&(R=ct-1)}})(E,G,N||0,B||E.length-1,z||u)}function o(E,G,N){var B=E[G];E[G]=E[N],E[N]=B}function u(E,G){return E<G?-1:E>G?1:0}var f=function(E){E===void 0&&(E=9),this._maxEntries=Math.max(4,E),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function m(E,G,N){if(!N)return G.indexOf(E);for(var B=0;B<G.length;B++)if(N(E,G[B]))return B;return-1}function d(E,G){x(E,0,E.children.length,G,E)}function x(E,G,N,B,z){z||(z=Y(null)),z.minX=1/0,z.minY=1/0,z.maxX=-1/0,z.maxY=-1/0;for(var $=G;$<N;$++){var P=E.children[$];v(z,E.leaf?B(P):P)}return z}function v(E,G){return E.minX=Math.min(E.minX,G.minX),E.minY=Math.min(E.minY,G.minY),E.maxX=Math.max(E.maxX,G.maxX),E.maxY=Math.max(E.maxY,G.maxY),E}function w(E,G){return E.minX-G.minX}function I(E,G){return E.minY-G.minY}function T(E){return(E.maxX-E.minX)*(E.maxY-E.minY)}function b(E){return E.maxX-E.minX+(E.maxY-E.minY)}function D(E,G){return E.minX<=G.minX&&E.minY<=G.minY&&G.maxX<=E.maxX&&G.maxY<=E.maxY}function Z(E,G){return G.minX<=E.maxX&&G.minY<=E.maxY&&G.maxX>=E.minX&&G.maxY>=E.minY}function Y(E){return{children:E,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function tt(E,G,N,B,z){for(var $=[G,N];$.length;)if(!((N=$.pop())-(G=$.pop())<=B)){var P=G+Math.ceil((N-G)/B/2)*B;r(E,P,G,N,z),$.push(G,P,P,N)}}return f.prototype.all=function(){return this._all(this.data,[])},f.prototype.search=function(E){var G=this.data,N=[];if(!Z(E,G))return N;for(var B=this.toBBox,z=[];G;){for(var $=0;$<G.children.length;$++){var P=G.children[$],S=G.leaf?B(P):P;Z(E,S)&&(G.leaf?N.push(P):D(E,S)?this._all(P,N):z.push(P))}G=z.pop()}return N},f.prototype.collides=function(E){var G=this.data;if(!Z(E,G))return!1;for(var N=[];G;){for(var B=0;B<G.children.length;B++){var z=G.children[B],$=G.leaf?this.toBBox(z):z;if(Z(E,$)){if(G.leaf||D(E,$))return!0;N.push(z)}}G=N.pop()}return!1},f.prototype.load=function(E){if(!E||!E.length)return this;if(E.length<this._minEntries){for(var G=0;G<E.length;G++)this.insert(E[G]);return this}var N=this._build(E.slice(),0,E.length-1,0);if(this.data.children.length)if(this.data.height===N.height)this._splitRoot(this.data,N);else{if(this.data.height<N.height){var B=this.data;this.data=N,N=B}this._insert(N,this.data.height-N.height-1,!0)}else this.data=N;return this},f.prototype.insert=function(E){return E&&this._insert(E,this.data.height-1),this},f.prototype.clear=function(){return this.data=Y([]),this},f.prototype.remove=function(E,G){if(!E)return this;for(var N,B,z,$=this.data,P=this.toBBox(E),S=[],C=[];$||S.length;){if($||($=S.pop(),B=S[S.length-1],N=C.pop(),z=!0),$.leaf){var R=m(E,$.children,G);if(R!==-1)return $.children.splice(R,1),S.push($),this._condense(S),this}z||$.leaf||!D($,P)?B?(N++,$=B.children[N],z=!1):$=null:(S.push($),C.push(N),N=0,B=$,$=$.children[0])}return this},f.prototype.toBBox=function(E){return E},f.prototype.compareMinX=function(E,G){return E.minX-G.minX},f.prototype.compareMinY=function(E,G){return E.minY-G.minY},f.prototype.toJSON=function(){return this.data},f.prototype.fromJSON=function(E){return this.data=E,this},f.prototype._all=function(E,G){for(var N=[];E;)E.leaf?G.push.apply(G,E.children):N.push.apply(N,E.children),E=N.pop();return G},f.prototype._build=function(E,G,N,B){var z,$=N-G+1,P=this._maxEntries;if($<=P)return d(z=Y(E.slice(G,N+1)),this.toBBox),z;B||(B=Math.ceil(Math.log($)/Math.log(P)),P=Math.ceil($/Math.pow(P,B-1))),(z=Y([])).leaf=!1,z.height=B;var S=Math.ceil($/P),C=S*Math.ceil(Math.sqrt(P));tt(E,G,N,C,this.compareMinX);for(var R=G;R<=N;R+=C){var F=Math.min(R+C-1,N);tt(E,R,F,S,this.compareMinY);for(var V=R;V<=F;V+=S){var H=Math.min(V+S-1,F);z.children.push(this._build(E,V,H,B-1))}}return d(z,this.toBBox),z},f.prototype._chooseSubtree=function(E,G,N,B){for(;B.push(G),!G.leaf&&B.length-1!==N;){for(var z=1/0,$=1/0,P=void 0,S=0;S<G.children.length;S++){var C=G.children[S],R=T(C),F=(V=E,H=C,(Math.max(H.maxX,V.maxX)-Math.min(H.minX,V.minX))*(Math.max(H.maxY,V.maxY)-Math.min(H.minY,V.minY))-R);F<$?($=F,z=R<z?R:z,P=C):F===$&&R<z&&(z=R,P=C)}G=P||G.children[0]}var V,H;return G},f.prototype._insert=function(E,G,N){var B=N?E:this.toBBox(E),z=[],$=this._chooseSubtree(B,this.data,G,z);for($.children.push(E),v($,B);G>=0&&z[G].children.length>this._maxEntries;)this._split(z,G),G--;this._adjustParentBBoxes(B,z,G)},f.prototype._split=function(E,G){var N=E[G],B=N.children.length,z=this._minEntries;this._chooseSplitAxis(N,z,B);var $=this._chooseSplitIndex(N,z,B),P=Y(N.children.splice($,N.children.length-$));P.height=N.height,P.leaf=N.leaf,d(N,this.toBBox),d(P,this.toBBox),G?E[G-1].children.push(P):this._splitRoot(N,P)},f.prototype._splitRoot=function(E,G){this.data=Y([E,G]),this.data.height=E.height+1,this.data.leaf=!1,d(this.data,this.toBBox)},f.prototype._chooseSplitIndex=function(E,G,N){for(var B,z,$,P,S,C,R,F=1/0,V=1/0,H=G;H<=N-G;H++){var X=x(E,0,H,this.toBBox),q=x(E,H,N,this.toBBox),Q=(z=X,$=q,P=void 0,S=void 0,C=void 0,R=void 0,P=Math.max(z.minX,$.minX),S=Math.max(z.minY,$.minY),C=Math.min(z.maxX,$.maxX),R=Math.min(z.maxY,$.maxY),Math.max(0,C-P)*Math.max(0,R-S)),W=T(X)+T(q);Q<F?(F=Q,B=H,V=W<V?W:V):Q===F&&W<V&&(V=W,B=H)}return B||N-G},f.prototype._chooseSplitAxis=function(E,G,N){var B=E.leaf?this.compareMinX:w,z=E.leaf?this.compareMinY:I;this._allDistMargin(E,G,N,B)<this._allDistMargin(E,G,N,z)&&E.children.sort(B)},f.prototype._allDistMargin=function(E,G,N,B){E.children.sort(B);for(var z=this.toBBox,$=x(E,0,G,z),P=x(E,N-G,N,z),S=b($)+b(P),C=G;C<N-G;C++){var R=E.children[C];v($,E.leaf?z(R):R),S+=b($)}for(var F=N-G-1;F>=G;F--){var V=E.children[F];v(P,E.leaf?z(V):V),S+=b(P)}return S},f.prototype._adjustParentBBoxes=function(E,G,N){for(var B=N;B>=0;B--)v(G[B],E)},f.prototype._condense=function(E){for(var G=E.length-1,N=void 0;G>=0;G--)E[G].children.length===0?G>0?(N=E[G-1].children).splice(N.indexOf(E[G]),1):this.clear():d(E[G],this.toBBox)},f})}(eo)),eo.exports}let yh=class{constructor(n=[],r=vh){if(this.data=n,this.length=this.data.length,this.compare=r,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:r,compare:o}=this,u=r[n];for(;n>0;){const f=n-1>>1,m=r[f];if(o(u,m)>=0)break;r[n]=m,n=f}r[n]=u}_down(n){const{data:r,compare:o}=this,u=this.length>>1,f=r[n];for(;n<u;){let m=(n<<1)+1,d=r[m];const x=m+1;if(x<this.length&&o(r[x],d)<0&&(m=x,d=r[x]),o(d,f)>=0)break;r[n]=d,n=m}r[n]=f}};function vh(h,n){return h<n?-1:h>n?1:0}const _h=Object.freeze(Object.defineProperty({__proto__:null,default:yh},Symbol.toStringTag,{value:"Module"})),xh=dh(_h);var Jr={exports:{}},qo,Da;function kh(){return Da||(Da=1,qo=function(n,r,o,u){var f=n[0],m=n[1],d=!1;o===void 0&&(o=0),u===void 0&&(u=r.length);for(var x=(u-o)/2,v=0,w=x-1;v<x;w=v++){var I=r[o+v*2+0],T=r[o+v*2+1],b=r[o+w*2+0],D=r[o+w*2+1],Z=T>m!=D>m&&f<(b-I)*(m-T)/(D-T)+I;Z&&(d=!d)}return d}),qo}var Uo,Ra;function wh(){return Ra||(Ra=1,Uo=function(n,r,o,u){var f=n[0],m=n[1],d=!1;o===void 0&&(o=0),u===void 0&&(u=r.length);for(var x=u-o,v=0,w=x-1;v<x;w=v++){var I=r[v+o][0],T=r[v+o][1],b=r[w+o][0],D=r[w+o][1],Z=T>m!=D>m&&f<(b-I)*(m-T)/(D-T)+I;Z&&(d=!d)}return d}),Uo}var Fa;function Eh(){if(Fa)return Jr.exports;Fa=1;var h=kh(),n=wh();return Jr.exports=function(o,u,f,m){return u.length>0&&Array.isArray(u[0])?n(o,u,f,m):h(o,u,f,m)},Jr.exports.nested=n,Jr.exports.flat=h,Jr.exports}var is={exports:{}},Ph=is.exports,Ba;function Lh(){return Ba||(Ba=1,function(h,n){(function(r,o){o(n)})(Ph,function(r){const u=33306690738754706e-32;function f(Z,Y,tt,E,G){let N,B,z,$,P=Y[0],S=E[0],C=0,R=0;S>P==S>-P?(N=P,P=Y[++C]):(N=S,S=E[++R]);let F=0;if(C<Z&&R<tt)for(S>P==S>-P?(z=N-((B=P+N)-P),P=Y[++C]):(z=N-((B=S+N)-S),S=E[++R]),N=B,z!==0&&(G[F++]=z);C<Z&&R<tt;)S>P==S>-P?(z=N-((B=N+P)-($=B-N))+(P-$),P=Y[++C]):(z=N-((B=N+S)-($=B-N))+(S-$),S=E[++R]),N=B,z!==0&&(G[F++]=z);for(;C<Z;)z=N-((B=N+P)-($=B-N))+(P-$),P=Y[++C],N=B,z!==0&&(G[F++]=z);for(;R<tt;)z=N-((B=N+S)-($=B-N))+(S-$),S=E[++R],N=B,z!==0&&(G[F++]=z);return N===0&&F!==0||(G[F++]=N),F}function m(Z){return new Float64Array(Z)}const d=33306690738754716e-32,x=22204460492503146e-32,v=11093356479670487e-47,w=m(4),I=m(8),T=m(12),b=m(16),D=m(4);r.orient2d=function(Z,Y,tt,E,G,N){const B=(Y-N)*(tt-G),z=(Z-G)*(E-N),$=B-z;if(B===0||z===0||B>0!=z>0)return $;const P=Math.abs(B+z);return Math.abs($)>=d*P?$:-function(S,C,R,F,V,H,X){let q,Q,W,it,J,ut,ct,pt,ht,ft,gt,kt,nt,Kt,bt,vt,K,Rt;const qt=S-V,St=R-V,we=C-H,fe=F-H;J=(bt=(pt=qt-(ct=(ut=134217729*qt)-(ut-qt)))*(ft=fe-(ht=(ut=134217729*fe)-(ut-fe)))-((Kt=qt*fe)-ct*ht-pt*ht-ct*ft))-(gt=bt-(K=(pt=we-(ct=(ut=134217729*we)-(ut-we)))*(ft=St-(ht=(ut=134217729*St)-(ut-St)))-((vt=we*St)-ct*ht-pt*ht-ct*ft))),w[0]=bt-(gt+J)+(J-K),J=(nt=Kt-((kt=Kt+gt)-(J=kt-Kt))+(gt-J))-(gt=nt-vt),w[1]=nt-(gt+J)+(J-vt),J=(Rt=kt+gt)-kt,w[2]=kt-(Rt-J)+(gt-J),w[3]=Rt;let Te=function(Ai,Ot){let pn=Ot[0];for(let Ye=1;Ye<Ai;Ye++)pn+=Ot[Ye];return pn}(4,w),yt=x*X;if(Te>=yt||-Te>=yt||(q=S-(qt+(J=S-qt))+(J-V),W=R-(St+(J=R-St))+(J-V),Q=C-(we+(J=C-we))+(J-H),it=F-(fe+(J=F-fe))+(J-H),q===0&&Q===0&&W===0&&it===0)||(yt=v*X+u*Math.abs(Te),(Te+=qt*it+fe*q-(we*W+St*Q))>=yt||-Te>=yt))return Te;J=(bt=(pt=q-(ct=(ut=134217729*q)-(ut-q)))*(ft=fe-(ht=(ut=134217729*fe)-(ut-fe)))-((Kt=q*fe)-ct*ht-pt*ht-ct*ft))-(gt=bt-(K=(pt=Q-(ct=(ut=134217729*Q)-(ut-Q)))*(ft=St-(ht=(ut=134217729*St)-(ut-St)))-((vt=Q*St)-ct*ht-pt*ht-ct*ft))),D[0]=bt-(gt+J)+(J-K),J=(nt=Kt-((kt=Kt+gt)-(J=kt-Kt))+(gt-J))-(gt=nt-vt),D[1]=nt-(gt+J)+(J-vt),J=(Rt=kt+gt)-kt,D[2]=kt-(Rt-J)+(gt-J),D[3]=Rt;const gi=f(4,w,4,D,I);J=(bt=(pt=qt-(ct=(ut=134217729*qt)-(ut-qt)))*(ft=it-(ht=(ut=134217729*it)-(ut-it)))-((Kt=qt*it)-ct*ht-pt*ht-ct*ft))-(gt=bt-(K=(pt=we-(ct=(ut=134217729*we)-(ut-we)))*(ft=W-(ht=(ut=134217729*W)-(ut-W)))-((vt=we*W)-ct*ht-pt*ht-ct*ft))),D[0]=bt-(gt+J)+(J-K),J=(nt=Kt-((kt=Kt+gt)-(J=kt-Kt))+(gt-J))-(gt=nt-vt),D[1]=nt-(gt+J)+(J-vt),J=(Rt=kt+gt)-kt,D[2]=kt-(Rt-J)+(gt-J),D[3]=Rt;const Xn=f(gi,I,4,D,T);J=(bt=(pt=q-(ct=(ut=134217729*q)-(ut-q)))*(ft=it-(ht=(ut=134217729*it)-(ut-it)))-((Kt=q*it)-ct*ht-pt*ht-ct*ft))-(gt=bt-(K=(pt=Q-(ct=(ut=134217729*Q)-(ut-Q)))*(ft=W-(ht=(ut=134217729*W)-(ut-W)))-((vt=Q*W)-ct*ht-pt*ht-ct*ft))),D[0]=bt-(gt+J)+(J-K),J=(nt=Kt-((kt=Kt+gt)-(J=kt-Kt))+(gt-J))-(gt=nt-vt),D[1]=nt-(gt+J)+(J-vt),J=(Rt=kt+gt)-kt,D[2]=kt-(Rt-J)+(gt-J),D[3]=Rt;const Ze=f(Xn,T,4,D,b);return b[Ze-1]}(Z,Y,tt,E,G,N,P)},r.orient2dfast=function(Z,Y,tt,E,G,N){return(Y-N)*(tt-G)-(Z-G)*(E-N)},Object.defineProperty(r,"__esModule",{value:!0})})}(is,is.exports)),is.exports}var za;function Mh(){if(za)return Hs.exports;za=1;var h=ph(),n=xh,r=Eh(),o=Lh().orient2d;n.default&&(n=n.default),Hs.exports=u,Hs.exports.default=u;function u(N,B,z){B=Math.max(0,B===void 0?2:B),z=z||0;var $=b(N),P=new h(16);P.toBBox=function(ct){return{minX:ct[0],minY:ct[1],maxX:ct[0],maxY:ct[1]}},P.compareMinX=function(ct,pt){return ct[0]-pt[0]},P.compareMinY=function(ct,pt){return ct[1]-pt[1]},P.load(N);for(var S=[],C=0,R;C<$.length;C++){var F=$[C];P.remove(F),R=D(F,R),S.push(R)}var V=new h(16);for(C=0;C<S.length;C++)V.insert(T(S[C]));for(var H=B*B,X=z*z;S.length;){var q=S.shift(),Q=q.p,W=q.next.p,it=Z(Q,W);if(!(it<X)){var J=it/H;F=f(P,q.prev.p,Q,W,q.next.next.p,J,V),F&&Math.min(Z(F,Q),Z(F,W))<=J&&(S.push(q),S.push(D(F,q)),P.remove(F),V.remove(q),V.insert(T(q)),V.insert(T(q.next)))}}q=R;var ut=[];do ut.push(q.p),q=q.next;while(q!==R);return ut.push(q.p),ut}function f(N,B,z,$,P,S,C){for(var R=new n([],m),F=N.data;F;){for(var V=0;V<F.children.length;V++){var H=F.children[V],X=F.leaf?Y(H,z,$):d(z,$,H);X>S||R.push({node:H,dist:X})}for(;R.length&&!R.peek().node.children;){var q=R.pop(),Q=q.node,W=Y(Q,B,z),it=Y(Q,$,P);if(q.dist<W&&q.dist<it&&v(z,Q,C)&&v($,Q,C))return Q}F=R.pop(),F&&(F=F.node)}return null}function m(N,B){return N.dist-B.dist}function d(N,B,z){if(x(N,z)||x(B,z))return 0;var $=tt(N[0],N[1],B[0],B[1],z.minX,z.minY,z.maxX,z.minY);if($===0)return 0;var P=tt(N[0],N[1],B[0],B[1],z.minX,z.minY,z.minX,z.maxY);if(P===0)return 0;var S=tt(N[0],N[1],B[0],B[1],z.maxX,z.minY,z.maxX,z.maxY);if(S===0)return 0;var C=tt(N[0],N[1],B[0],B[1],z.minX,z.maxY,z.maxX,z.maxY);return C===0?0:Math.min($,P,S,C)}function x(N,B){return N[0]>=B.minX&&N[0]<=B.maxX&&N[1]>=B.minY&&N[1]<=B.maxY}function v(N,B,z){for(var $=Math.min(N[0],B[0]),P=Math.min(N[1],B[1]),S=Math.max(N[0],B[0]),C=Math.max(N[1],B[1]),R=z.search({minX:$,minY:P,maxX:S,maxY:C}),F=0;F<R.length;F++)if(I(R[F].p,R[F].next.p,N,B))return!1;return!0}function w(N,B,z){return o(N[0],N[1],B[0],B[1],z[0],z[1])}function I(N,B,z,$){return N!==$&&B!==z&&w(N,B,z)>0!=w(N,B,$)>0&&w(z,$,N)>0!=w(z,$,B)>0}function T(N){var B=N.p,z=N.next.p;return N.minX=Math.min(B[0],z[0]),N.minY=Math.min(B[1],z[1]),N.maxX=Math.max(B[0],z[0]),N.maxY=Math.max(B[1],z[1]),N}function b(N){for(var B=N[0],z=N[0],$=N[0],P=N[0],S=0;S<N.length;S++){var C=N[S];C[0]<B[0]&&(B=C),C[0]>$[0]&&($=C),C[1]<z[1]&&(z=C),C[1]>P[1]&&(P=C)}var R=[B,z,$,P],F=R.slice();for(S=0;S<N.length;S++)r(N[S],R)||F.push(N[S]);return G(F)}function D(N,B){var z={p:N,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return B?(z.next=B.next,z.prev=B,B.next.prev=z,B.next=z):(z.prev=z,z.next=z),z}function Z(N,B){var z=N[0]-B[0],$=N[1]-B[1];return z*z+$*$}function Y(N,B,z){var $=B[0],P=B[1],S=z[0]-$,C=z[1]-P;if(S!==0||C!==0){var R=((N[0]-$)*S+(N[1]-P)*C)/(S*S+C*C);R>1?($=z[0],P=z[1]):R>0&&($+=S*R,P+=C*R)}return S=N[0]-$,C=N[1]-P,S*S+C*C}function tt(N,B,z,$,P,S,C,R){var F=z-N,V=$-B,H=C-P,X=R-S,q=N-P,Q=B-S,W=F*F+V*V,it=F*H+V*X,J=H*H+X*X,ut=F*q+V*Q,ct=H*q+X*Q,pt=W*J-it*it,ht,ft,gt,kt,nt=pt,Kt=pt;pt===0?(ft=0,nt=1,kt=ct,Kt=J):(ft=it*ct-J*ut,kt=W*ct-it*ut,ft<0?(ft=0,kt=ct,Kt=J):ft>nt&&(ft=nt,kt=ct+it,Kt=J)),kt<0?(kt=0,-ut<0?ft=0:-ut>W?ft=nt:(ft=-ut,nt=W)):kt>Kt&&(kt=Kt,-ut+it<0?ft=0:-ut+it>W?ft=nt:(ft=-ut+it,nt=W)),ht=ft===0?0:ft/nt,gt=kt===0?0:kt/Kt;var bt=(1-ht)*N+ht*z,vt=(1-ht)*B+ht*$,K=(1-gt)*P+gt*C,Rt=(1-gt)*S+gt*R,qt=K-bt,St=Rt-vt;return qt*qt+St*St}function E(N,B){return N[0]===B[0]?N[1]-B[1]:N[0]-B[0]}function G(N){N.sort(E);for(var B=[],z=0;z<N.length;z++){for(;B.length>=2&&w(B[B.length-2],B[B.length-1],N[z])<=0;)B.pop();B.push(N[z])}for(var $=[],P=N.length-1;P>=0;P--){for(;$.length>=2&&w($[$.length-2],$[$.length-1],N[P])<=0;)$.pop();$.push(N[P])}return $.pop(),B.pop(),B.concat($)}return Hs.exports}var Ih=Mh();const Bu=Fu(Ih);function zu(h,n={}){n.concavity=n.concavity||1/0;const r=[];if(qn(h,u=>{r.push([u[0],u[1]])}),!r.length)return null;const o=Bu(r,n.concavity);return o.length>3?Yn([o]):null}var Ga=zu;function Ha(h,n={}){let r=0,o=0,u=0;return qn(h,function(f){r+=f[0],o+=f[1],u++},!0),Hn([r/u,o/u],n.properties)}function ds(h){if(!h)throw new Error("coord is required");if(!Array.isArray(h)){if(h.type==="Feature"&&h.geometry!==null&&h.geometry.type==="Point")return[...h.geometry.coordinates];if(h.type==="Point")return[...h.coordinates]}if(Array.isArray(h)&&h.length>=2&&!Array.isArray(h[0])&&!Array.isArray(h[1]))return[...h];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function gr(h){if(Array.isArray(h))return h;if(h.type==="Feature"){if(h.geometry!==null)return h.geometry.coordinates}else if(h.coordinates)return h.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Cn(h){return h.type==="Feature"?h.geometry:h}function Gu(h,n){return h.type==="FeatureCollection"?"FeatureCollection":h.type==="GeometryCollection"?"GeometryCollection":h.type==="Feature"&&h.geometry!==null?h.geometry.type:h.type}function Hu(h,n={}){switch(Gu(h)){case"Point":return Hn(ds(h),n.properties);case"Polygon":var r=[];qn(h,function(N){r.push(N)});var o=Ha(h,{properties:n.properties}),u=o.geometry.coordinates,f=0,m=0,d=0,x,v,w,I,T,b,D,Z,Y=r.map(function(N){return[N[0]-u[0],N[1]-u[1]]});for(x=0;x<r.length-1;x++)v=Y[x],I=v[0],b=v[1],w=Y[x+1],T=w[0],D=w[1],Z=I*D-T*b,d+=Z,f+=(I+T)*Z,m+=(b+D)*Z;if(d===0)return o;var tt=d*.5,E=1/(6*tt);return Hn([u[0]+E*f,u[1]+E*m],n.properties);default:var G=zu(h);return G?Hu(G,{properties:n.properties}):Ha(h,{properties:n.properties})}}var Sh=Hu;class qu{constructor(n=[],r=Ch){if(this.data=n,this.length=this.data.length,this.compare=r,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:r,compare:o}=this,u=r[n];for(;n>0;){const f=n-1>>1,m=r[f];if(o(u,m)>=0)break;r[n]=m,n=f}r[n]=u}_down(n){const{data:r,compare:o}=this,u=this.length>>1,f=r[n];for(;n<u;){let m=(n<<1)+1,d=r[m];const x=m+1;if(x<this.length&&o(r[x],d)<0&&(m=x,d=r[x]),o(d,f)>=0)break;r[n]=d,n=m}r[n]=f}}function Ch(h,n){return h<n?-1:h>n?1:0}function Uu(h,n){return h.p.x>n.p.x?1:h.p.x<n.p.x?-1:h.p.y!==n.p.y?h.p.y>n.p.y?1:-1:1}function bh(h,n){return h.rightSweepEvent.p.x>n.rightSweepEvent.p.x?1:h.rightSweepEvent.p.x<n.rightSweepEvent.p.x?-1:h.rightSweepEvent.p.y!==n.rightSweepEvent.p.y?h.rightSweepEvent.p.y<n.rightSweepEvent.p.y?1:-1:1}class qa{constructor(n,r,o,u){this.p={x:n[0],y:n[1]},this.featureId=r,this.ringId=o,this.eventId=u,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(n){return this.p.x===n.p.x&&this.p.y===n.p.y}}function Th(h,n){if(h.type==="FeatureCollection"){const r=h.features;for(let o=0;o<r.length;o++)Ua(r[o],n)}else Ua(h,n)}let qs=0,Us=0,Zs=0;function Ua(h,n){const r=h.type==="Feature"?h.geometry:h;let o=r.coordinates;(r.type==="Polygon"||r.type==="MultiLineString")&&(o=[o]),r.type==="LineString"&&(o=[[o]]);for(let u=0;u<o.length;u++)for(let f=0;f<o[u].length;f++){let m=o[u][f][0],d=null;Us=Us+1;for(let x=0;x<o[u][f].length-1;x++){d=o[u][f][x+1];const v=new qa(m,qs,Us,Zs),w=new qa(d,qs,Us,Zs+1);v.otherEvent=w,w.otherEvent=v,Uu(v,w)>0?(w.isLeftEndpoint=!0,v.isLeftEndpoint=!1):(v.isLeftEndpoint=!0,w.isLeftEndpoint=!1),n.push(v),n.push(w),m=d,Zs=Zs+1}}qs=qs+1}let Nh=class{constructor(n){this.leftSweepEvent=n,this.rightSweepEvent=n.otherEvent}};function Oh(h,n){if(h===null||n===null||h.leftSweepEvent.ringId===n.leftSweepEvent.ringId&&(h.rightSweepEvent.isSamePoint(n.leftSweepEvent)||h.rightSweepEvent.isSamePoint(n.leftSweepEvent)||h.rightSweepEvent.isSamePoint(n.rightSweepEvent)||h.leftSweepEvent.isSamePoint(n.leftSweepEvent)||h.leftSweepEvent.isSamePoint(n.rightSweepEvent)))return!1;const r=h.leftSweepEvent.p.x,o=h.leftSweepEvent.p.y,u=h.rightSweepEvent.p.x,f=h.rightSweepEvent.p.y,m=n.leftSweepEvent.p.x,d=n.leftSweepEvent.p.y,x=n.rightSweepEvent.p.x,v=n.rightSweepEvent.p.y,w=(v-d)*(u-r)-(x-m)*(f-o),I=(x-m)*(o-d)-(v-d)*(r-m),T=(u-r)*(o-d)-(f-o)*(r-m);if(w===0)return!1;const b=I/w,D=T/w;if(b>=0&&b<=1&&D>=0&&D<=1){const Z=r+b*(u-r),Y=o+b*(f-o);return[Z,Y]}return!1}function Ah(h,n){n=n||!1;const r=[],o=new qu([],bh);for(;h.length;){const u=h.pop();if(u.isLeftEndpoint){const f=new Nh(u);for(let m=0;m<o.data.length;m++){const d=o.data[m];if(n&&d.leftSweepEvent.featureId===u.featureId)continue;const x=Oh(f,d);x!==!1&&r.push(x)}o.push(f)}else u.isLeftEndpoint===!1&&o.pop()}return r}function Dh(h,n){const r=new qu([],Uu);return Th(h,r),Ah(r,n)}var Rh=Dh;function Fh(h,n,r={}){const{removeDuplicates:o=!0,ignoreSelfIntersections:u=!0}=r;let f=[];h.type==="FeatureCollection"?f=f.concat(h.features):h.type==="Feature"?f.push(h):(h.type==="LineString"||h.type==="Polygon"||h.type==="MultiLineString"||h.type==="MultiPolygon")&&f.push(mn(h)),n.type==="FeatureCollection"?f=f.concat(n.features):n.type==="Feature"?f.push(n):(n.type==="LineString"||n.type==="Polygon"||n.type==="MultiLineString"||n.type==="MultiPolygon")&&f.push(mn(n));const m=Rh(Sn(f),u);let d=[];if(o){const x={};m.forEach(v=>{const w=v.join(",");x[w]||(x[w]=!0,d.push(v))})}else d=m;return Sn(d.map(x=>Hn(x)))}var Bh=Fh,zh=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Zo=Math.ceil,on=Math.floor,Ge="[BigNumber Error] ",Za=Ge+"Number primitive has more than 15 significant digits: ",gn=1e14,zt=14,Yo=9007199254740991,Vo=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],si=1e7,xe=1e9;function Zu(h){var n,r,o,u=E.prototype={constructor:E,toString:null,valueOf:null},f=new E(1),m=20,d=4,x=-7,v=21,w=-1e7,I=1e7,T=!1,b=1,D=0,Z={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},Y="0123456789abcdefghijklmnopqrstuvwxyz",tt=!0;function E(P,S){var C,R,F,V,H,X,q,Q,W=this;if(!(W instanceof E))return new E(P,S);if(S==null){if(P&&P._isBigNumber===!0){W.s=P.s,!P.c||P.e>I?W.c=W.e=null:P.e<w?W.c=[W.e=0]:(W.e=P.e,W.c=P.c.slice());return}if((X=typeof P=="number")&&P*0==0){if(W.s=1/P<0?(P=-P,-1):1,P===~~P){for(V=0,H=P;H>=10;H/=10,V++);V>I?W.c=W.e=null:(W.e=V,W.c=[P]);return}Q=String(P)}else{if(!zh.test(Q=String(P)))return o(W,Q,X);W.s=Q.charCodeAt(0)==45?(Q=Q.slice(1),-1):1}(V=Q.indexOf("."))>-1&&(Q=Q.replace(".","")),(H=Q.search(/e/i))>0?(V<0&&(V=H),V+=+Q.slice(H+1),Q=Q.substring(0,H)):V<0&&(V=Q.length)}else{if(se(S,2,Y.length,"Base"),S==10&&tt)return W=new E(P),z(W,m+W.e+1,d);if(Q=String(P),X=typeof P=="number"){if(P*0!=0)return o(W,Q,X,S);if(W.s=1/P<0?(Q=Q.slice(1),-1):1,E.DEBUG&&Q.replace(/^0\.0*|\./,"").length>15)throw Error(Za+P)}else W.s=Q.charCodeAt(0)===45?(Q=Q.slice(1),-1):1;for(C=Y.slice(0,S),V=H=0,q=Q.length;H<q;H++)if(C.indexOf(R=Q.charAt(H))<0){if(R=="."){if(H>V){V=q;continue}}else if(!F&&(Q==Q.toUpperCase()&&(Q=Q.toLowerCase())||Q==Q.toLowerCase()&&(Q=Q.toUpperCase()))){F=!0,H=-1,V=0;continue}return o(W,String(P),X,S)}X=!1,Q=r(Q,S,10,W.s),(V=Q.indexOf("."))>-1?Q=Q.replace(".",""):V=Q.length}for(H=0;Q.charCodeAt(H)===48;H++);for(q=Q.length;Q.charCodeAt(--q)===48;);if(Q=Q.slice(H,++q)){if(q-=H,X&&E.DEBUG&&q>15&&(P>Yo||P!==on(P)))throw Error(Za+W.s*P);if((V=V-H-1)>I)W.c=W.e=null;else if(V<w)W.c=[W.e=0];else{if(W.e=V,W.c=[],H=(V+1)%zt,V<0&&(H+=zt),H<q){for(H&&W.c.push(+Q.slice(0,H)),q-=zt;H<q;)W.c.push(+Q.slice(H,H+=zt));H=zt-(Q=Q.slice(H)).length}else H-=q;for(;H--;Q+="0");W.c.push(+Q)}}else W.c=[W.e=0]}E.clone=Zu,E.ROUND_UP=0,E.ROUND_DOWN=1,E.ROUND_CEIL=2,E.ROUND_FLOOR=3,E.ROUND_HALF_UP=4,E.ROUND_HALF_DOWN=5,E.ROUND_HALF_EVEN=6,E.ROUND_HALF_CEIL=7,E.ROUND_HALF_FLOOR=8,E.EUCLID=9,E.config=E.set=function(P){var S,C;if(P!=null)if(typeof P=="object"){if(P.hasOwnProperty(S="DECIMAL_PLACES")&&(C=P[S],se(C,0,xe,S),m=C),P.hasOwnProperty(S="ROUNDING_MODE")&&(C=P[S],se(C,0,8,S),d=C),P.hasOwnProperty(S="EXPONENTIAL_AT")&&(C=P[S],C&&C.pop?(se(C[0],-xe,0,S),se(C[1],0,xe,S),x=C[0],v=C[1]):(se(C,-xe,xe,S),x=-(v=C<0?-C:C))),P.hasOwnProperty(S="RANGE"))if(C=P[S],C&&C.pop)se(C[0],-xe,-1,S),se(C[1],1,xe,S),w=C[0],I=C[1];else if(se(C,-xe,xe,S),C)w=-(I=C<0?-C:C);else throw Error(Ge+S+" cannot be zero: "+C);if(P.hasOwnProperty(S="CRYPTO"))if(C=P[S],C===!!C)if(C)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))T=C;else throw T=!C,Error(Ge+"crypto unavailable");else T=C;else throw Error(Ge+S+" not true or false: "+C);if(P.hasOwnProperty(S="MODULO_MODE")&&(C=P[S],se(C,0,9,S),b=C),P.hasOwnProperty(S="POW_PRECISION")&&(C=P[S],se(C,0,xe,S),D=C),P.hasOwnProperty(S="FORMAT"))if(C=P[S],typeof C=="object")Z=C;else throw Error(Ge+S+" not an object: "+C);if(P.hasOwnProperty(S="ALPHABET"))if(C=P[S],typeof C=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(C))tt=C.slice(0,10)=="0123456789",Y=C;else throw Error(Ge+S+" invalid: "+C)}else throw Error(Ge+"Object expected: "+P);return{DECIMAL_PLACES:m,ROUNDING_MODE:d,EXPONENTIAL_AT:[x,v],RANGE:[w,I],CRYPTO:T,MODULO_MODE:b,POW_PRECISION:D,FORMAT:Z,ALPHABET:Y}},E.isBigNumber=function(P){if(!P||P._isBigNumber!==!0)return!1;if(!E.DEBUG)return!0;var S,C,R=P.c,F=P.e,V=P.s;t:if({}.toString.call(R)=="[object Array]"){if((V===1||V===-1)&&F>=-xe&&F<=xe&&F===on(F)){if(R[0]===0){if(F===0&&R.length===1)return!0;break t}if(S=(F+1)%zt,S<1&&(S+=zt),String(R[0]).length==S){for(S=0;S<R.length;S++)if(C=R[S],C<0||C>=gn||C!==on(C))break t;if(C!==0)return!0}}}else if(R===null&&F===null&&(V===null||V===1||V===-1))return!0;throw Error(Ge+"Invalid BigNumber: "+P)},E.maximum=E.max=function(){return N(arguments,-1)},E.minimum=E.min=function(){return N(arguments,1)},E.random=function(){var P=9007199254740992,S=Math.random()*P&2097151?function(){return on(Math.random()*P)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(C){var R,F,V,H,X,q=0,Q=[],W=new E(f);if(C==null?C=m:se(C,0,xe),H=Zo(C/zt),T)if(crypto.getRandomValues){for(R=crypto.getRandomValues(new Uint32Array(H*=2));q<H;)X=R[q]*131072+(R[q+1]>>>11),X>=9e15?(F=crypto.getRandomValues(new Uint32Array(2)),R[q]=F[0],R[q+1]=F[1]):(Q.push(X%1e14),q+=2);q=H/2}else if(crypto.randomBytes){for(R=crypto.randomBytes(H*=7);q<H;)X=(R[q]&31)*281474976710656+R[q+1]*1099511627776+R[q+2]*4294967296+R[q+3]*16777216+(R[q+4]<<16)+(R[q+5]<<8)+R[q+6],X>=9e15?crypto.randomBytes(7).copy(R,q):(Q.push(X%1e14),q+=7);q=H/7}else throw T=!1,Error(Ge+"crypto unavailable");if(!T)for(;q<H;)X=S(),X<9e15&&(Q[q++]=X%1e14);for(H=Q[--q],C%=zt,H&&C&&(X=Vo[zt-C],Q[q]=on(H/X)*X);Q[q]===0;Q.pop(),q--);if(q<0)Q=[V=0];else{for(V=-1;Q[0]===0;Q.splice(0,1),V-=zt);for(q=1,X=Q[0];X>=10;X/=10,q++);q<zt&&(V-=zt-q)}return W.e=V,W.c=Q,W}}(),E.sum=function(){for(var P=1,S=arguments,C=new E(S[0]);P<S.length;)C=C.plus(S[P++]);return C},r=function(){var P="0123456789";function S(C,R,F,V){for(var H,X=[0],q,Q=0,W=C.length;Q<W;){for(q=X.length;q--;X[q]*=R);for(X[0]+=V.indexOf(C.charAt(Q++)),H=0;H<X.length;H++)X[H]>F-1&&(X[H+1]==null&&(X[H+1]=0),X[H+1]+=X[H]/F|0,X[H]%=F)}return X.reverse()}return function(C,R,F,V,H){var X,q,Q,W,it,J,ut,ct,pt=C.indexOf("."),ht=m,ft=d;for(pt>=0&&(W=D,D=0,C=C.replace(".",""),ct=new E(R),J=ct.pow(C.length-pt),D=W,ct.c=S(zn(rn(J.c),J.e,"0"),10,F,P),ct.e=ct.c.length),ut=S(C,R,F,H?(X=Y,P):(X=P,Y)),Q=W=ut.length;ut[--W]==0;ut.pop());if(!ut[0])return X.charAt(0);if(pt<0?--Q:(J.c=ut,J.e=Q,J.s=V,J=n(J,ct,ht,ft,F),ut=J.c,it=J.r,Q=J.e),q=Q+ht+1,pt=ut[q],W=F/2,it=it||q<0||ut[q+1]!=null,it=ft<4?(pt!=null||it)&&(ft==0||ft==(J.s<0?3:2)):pt>W||pt==W&&(ft==4||it||ft==6&&ut[q-1]&1||ft==(J.s<0?8:7)),q<1||!ut[0])C=it?zn(X.charAt(1),-ht,X.charAt(0)):X.charAt(0);else{if(ut.length=q,it)for(--F;++ut[--q]>F;)ut[q]=0,q||(++Q,ut=[1].concat(ut));for(W=ut.length;!ut[--W];);for(pt=0,C="";pt<=W;C+=X.charAt(ut[pt++]));C=zn(C,Q,X.charAt(0))}return C}}(),n=function(){function P(R,F,V){var H,X,q,Q,W=0,it=R.length,J=F%si,ut=F/si|0;for(R=R.slice();it--;)q=R[it]%si,Q=R[it]/si|0,H=ut*q+Q*J,X=J*q+H%si*si+W,W=(X/V|0)+(H/si|0)+ut*Q,R[it]=X%V;return W&&(R=[W].concat(R)),R}function S(R,F,V,H){var X,q;if(V!=H)q=V>H?1:-1;else for(X=q=0;X<V;X++)if(R[X]!=F[X]){q=R[X]>F[X]?1:-1;break}return q}function C(R,F,V,H){for(var X=0;V--;)R[V]-=X,X=R[V]<F[V]?1:0,R[V]=X*H+R[V]-F[V];for(;!R[0]&&R.length>1;R.splice(0,1));}return function(R,F,V,H,X){var q,Q,W,it,J,ut,ct,pt,ht,ft,gt,kt,nt,Kt,bt,vt,K,Rt=R.s==F.s?1:-1,qt=R.c,St=F.c;if(!qt||!qt[0]||!St||!St[0])return new E(!R.s||!F.s||(qt?St&&qt[0]==St[0]:!St)?NaN:qt&&qt[0]==0||!St?Rt*0:Rt/0);for(pt=new E(Rt),ht=pt.c=[],Q=R.e-F.e,Rt=V+Q+1,X||(X=gn,Q=an(R.e/zt)-an(F.e/zt),Rt=Rt/zt|0),W=0;St[W]==(qt[W]||0);W++);if(St[W]>(qt[W]||0)&&Q--,Rt<0)ht.push(1),it=!0;else{for(Kt=qt.length,vt=St.length,W=0,Rt+=2,J=on(X/(St[0]+1)),J>1&&(St=P(St,J,X),qt=P(qt,J,X),vt=St.length,Kt=qt.length),nt=vt,ft=qt.slice(0,vt),gt=ft.length;gt<vt;ft[gt++]=0);K=St.slice(),K=[0].concat(K),bt=St[0],St[1]>=X/2&&bt++;do{if(J=0,q=S(St,ft,vt,gt),q<0){if(kt=ft[0],vt!=gt&&(kt=kt*X+(ft[1]||0)),J=on(kt/bt),J>1)for(J>=X&&(J=X-1),ut=P(St,J,X),ct=ut.length,gt=ft.length;S(ut,ft,ct,gt)==1;)J--,C(ut,vt<ct?K:St,ct,X),ct=ut.length,q=1;else J==0&&(q=J=1),ut=St.slice(),ct=ut.length;if(ct<gt&&(ut=[0].concat(ut)),C(ft,ut,gt,X),gt=ft.length,q==-1)for(;S(St,ft,vt,gt)<1;)J++,C(ft,vt<gt?K:St,gt,X),gt=ft.length}else q===0&&(J++,ft=[0]);ht[W++]=J,ft[0]?ft[gt++]=qt[nt]||0:(ft=[qt[nt]],gt=1)}while((nt++<Kt||ft[0]!=null)&&Rt--);it=ft[0]!=null,ht[0]||ht.splice(0,1)}if(X==gn){for(W=1,Rt=ht[0];Rt>=10;Rt/=10,W++);z(pt,V+(pt.e=W+Q*zt-1)+1,H,it)}else pt.e=Q,pt.r=+it;return pt}}();function G(P,S,C,R){var F,V,H,X,q;if(C==null?C=d:se(C,0,8),!P.c)return P.toString();if(F=P.c[0],H=P.e,S==null)q=rn(P.c),q=R==1||R==2&&(H<=x||H>=v)?Vs(q,H):zn(q,H,"0");else if(P=z(new E(P),S,C),V=P.e,q=rn(P.c),X=q.length,R==1||R==2&&(S<=V||V<=x)){for(;X<S;q+="0",X++);q=Vs(q,V)}else if(S-=H+(R===2&&V>H),q=zn(q,V,"0"),V+1>X){if(--S>0)for(q+=".";S--;q+="0");}else if(S+=V-X,S>0)for(V+1==X&&(q+=".");S--;q+="0");return P.s<0&&F?"-"+q:q}function N(P,S){for(var C,R,F=1,V=new E(P[0]);F<P.length;F++)R=new E(P[F]),(!R.s||(C=bi(V,R))===S||C===0&&V.s===S)&&(V=R);return V}function B(P,S,C){for(var R=1,F=S.length;!S[--F];S.pop());for(F=S[0];F>=10;F/=10,R++);return(C=R+C*zt-1)>I?P.c=P.e=null:C<w?P.c=[P.e=0]:(P.e=C,P.c=S),P}o=function(){var P=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,C=/^\.([^.]+)$/,R=/^-?(Infinity|NaN)$/,F=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(V,H,X,q){var Q,W=X?H:H.replace(F,"");if(R.test(W))V.s=isNaN(W)?null:W<0?-1:1;else{if(!X&&(W=W.replace(P,function(it,J,ut){return Q=(ut=ut.toLowerCase())=="x"?16:ut=="b"?2:8,!q||q==Q?J:it}),q&&(Q=q,W=W.replace(S,"$1").replace(C,"0.$1")),H!=W))return new E(W,Q);if(E.DEBUG)throw Error(Ge+"Not a"+(q?" base "+q:"")+" number: "+H);V.s=null}V.c=V.e=null}}();function z(P,S,C,R){var F,V,H,X,q,Q,W,it=P.c,J=Vo;if(it){t:{for(F=1,X=it[0];X>=10;X/=10,F++);if(V=S-F,V<0)V+=zt,H=S,q=it[Q=0],W=on(q/J[F-H-1]%10);else if(Q=Zo((V+1)/zt),Q>=it.length)if(R){for(;it.length<=Q;it.push(0));q=W=0,F=1,V%=zt,H=V-zt+1}else break t;else{for(q=X=it[Q],F=1;X>=10;X/=10,F++);V%=zt,H=V-zt+F,W=H<0?0:on(q/J[F-H-1]%10)}if(R=R||S<0||it[Q+1]!=null||(H<0?q:q%J[F-H-1]),R=C<4?(W||R)&&(C==0||C==(P.s<0?3:2)):W>5||W==5&&(C==4||R||C==6&&(V>0?H>0?q/J[F-H]:0:it[Q-1])%10&1||C==(P.s<0?8:7)),S<1||!it[0])return it.length=0,R?(S-=P.e+1,it[0]=J[(zt-S%zt)%zt],P.e=-S||0):it[0]=P.e=0,P;if(V==0?(it.length=Q,X=1,Q--):(it.length=Q+1,X=J[zt-V],it[Q]=H>0?on(q/J[F-H]%J[H])*X:0),R)for(;;)if(Q==0){for(V=1,H=it[0];H>=10;H/=10,V++);for(H=it[0]+=X,X=1;H>=10;H/=10,X++);V!=X&&(P.e++,it[0]==gn&&(it[0]=1));break}else{if(it[Q]+=X,it[Q]!=gn)break;it[Q--]=0,X=1}for(V=it.length;it[--V]===0;it.pop());}P.e>I?P.c=P.e=null:P.e<w&&(P.c=[P.e=0])}return P}function $(P){var S,C=P.e;return C===null?P.toString():(S=rn(P.c),S=C<=x||C>=v?Vs(S,C):zn(S,C,"0"),P.s<0?"-"+S:S)}return u.absoluteValue=u.abs=function(){var P=new E(this);return P.s<0&&(P.s=1),P},u.comparedTo=function(P,S){return bi(this,new E(P,S))},u.decimalPlaces=u.dp=function(P,S){var C,R,F,V=this;if(P!=null)return se(P,0,xe),S==null?S=d:se(S,0,8),z(new E(V),P+V.e+1,S);if(!(C=V.c))return null;if(R=((F=C.length-1)-an(this.e/zt))*zt,F=C[F])for(;F%10==0;F/=10,R--);return R<0&&(R=0),R},u.dividedBy=u.div=function(P,S){return n(this,new E(P,S),m,d)},u.dividedToIntegerBy=u.idiv=function(P,S){return n(this,new E(P,S),0,1)},u.exponentiatedBy=u.pow=function(P,S){var C,R,F,V,H,X,q,Q,W,it=this;if(P=new E(P),P.c&&!P.isInteger())throw Error(Ge+"Exponent not an integer: "+$(P));if(S!=null&&(S=new E(S)),X=P.e>14,!it.c||!it.c[0]||it.c[0]==1&&!it.e&&it.c.length==1||!P.c||!P.c[0])return W=new E(Math.pow(+$(it),X?P.s*(2-Ys(P)):+$(P))),S?W.mod(S):W;if(q=P.s<0,S){if(S.c?!S.c[0]:!S.s)return new E(NaN);R=!q&&it.isInteger()&&S.isInteger(),R&&(it=it.mod(S))}else{if(P.e>9&&(it.e>0||it.e<-1||(it.e==0?it.c[0]>1||X&&it.c[1]>=24e7:it.c[0]<8e13||X&&it.c[0]<=9999975e7)))return V=it.s<0&&Ys(P)?-0:0,it.e>-1&&(V=1/V),new E(q?1/V:V);D&&(V=Zo(D/zt+2))}for(X?(C=new E(.5),q&&(P.s=1),Q=Ys(P)):(F=Math.abs(+$(P)),Q=F%2),W=new E(f);;){if(Q){if(W=W.times(it),!W.c)break;V?W.c.length>V&&(W.c.length=V):R&&(W=W.mod(S))}if(F){if(F=on(F/2),F===0)break;Q=F%2}else if(P=P.times(C),z(P,P.e+1,1),P.e>14)Q=Ys(P);else{if(F=+$(P),F===0)break;Q=F%2}it=it.times(it),V?it.c&&it.c.length>V&&(it.c.length=V):R&&(it=it.mod(S))}return R?W:(q&&(W=f.div(W)),S?W.mod(S):V?z(W,D,d,H):W)},u.integerValue=function(P){var S=new E(this);return P==null?P=d:se(P,0,8),z(S,S.e+1,P)},u.isEqualTo=u.eq=function(P,S){return bi(this,new E(P,S))===0},u.isFinite=function(){return!!this.c},u.isGreaterThan=u.gt=function(P,S){return bi(this,new E(P,S))>0},u.isGreaterThanOrEqualTo=u.gte=function(P,S){return(S=bi(this,new E(P,S)))===1||S===0},u.isInteger=function(){return!!this.c&&an(this.e/zt)>this.c.length-2},u.isLessThan=u.lt=function(P,S){return bi(this,new E(P,S))<0},u.isLessThanOrEqualTo=u.lte=function(P,S){return(S=bi(this,new E(P,S)))===-1||S===0},u.isNaN=function(){return!this.s},u.isNegative=function(){return this.s<0},u.isPositive=function(){return this.s>0},u.isZero=function(){return!!this.c&&this.c[0]==0},u.minus=function(P,S){var C,R,F,V,H=this,X=H.s;if(P=new E(P,S),S=P.s,!X||!S)return new E(NaN);if(X!=S)return P.s=-S,H.plus(P);var q=H.e/zt,Q=P.e/zt,W=H.c,it=P.c;if(!q||!Q){if(!W||!it)return W?(P.s=-S,P):new E(it?H:NaN);if(!W[0]||!it[0])return it[0]?(P.s=-S,P):new E(W[0]?H:d==3?-0:0)}if(q=an(q),Q=an(Q),W=W.slice(),X=q-Q){for((V=X<0)?(X=-X,F=W):(Q=q,F=it),F.reverse(),S=X;S--;F.push(0));F.reverse()}else for(R=(V=(X=W.length)<(S=it.length))?X:S,X=S=0;S<R;S++)if(W[S]!=it[S]){V=W[S]<it[S];break}if(V&&(F=W,W=it,it=F,P.s=-P.s),S=(R=it.length)-(C=W.length),S>0)for(;S--;W[C++]=0);for(S=gn-1;R>X;){if(W[--R]<it[R]){for(C=R;C&&!W[--C];W[C]=S);--W[C],W[R]+=gn}W[R]-=it[R]}for(;W[0]==0;W.splice(0,1),--Q);return W[0]?B(P,W,Q):(P.s=d==3?-1:1,P.c=[P.e=0],P)},u.modulo=u.mod=function(P,S){var C,R,F=this;return P=new E(P,S),!F.c||!P.s||P.c&&!P.c[0]?new E(NaN):!P.c||F.c&&!F.c[0]?new E(F):(b==9?(R=P.s,P.s=1,C=n(F,P,0,3),P.s=R,C.s*=R):C=n(F,P,0,b),P=F.minus(C.times(P)),!P.c[0]&&b==1&&(P.s=F.s),P)},u.multipliedBy=u.times=function(P,S){var C,R,F,V,H,X,q,Q,W,it,J,ut,ct,pt,ht,ft=this,gt=ft.c,kt=(P=new E(P,S)).c;if(!gt||!kt||!gt[0]||!kt[0])return!ft.s||!P.s||gt&&!gt[0]&&!kt||kt&&!kt[0]&&!gt?P.c=P.e=P.s=null:(P.s*=ft.s,!gt||!kt?P.c=P.e=null:(P.c=[0],P.e=0)),P;for(R=an(ft.e/zt)+an(P.e/zt),P.s*=ft.s,q=gt.length,it=kt.length,q<it&&(ct=gt,gt=kt,kt=ct,F=q,q=it,it=F),F=q+it,ct=[];F--;ct.push(0));for(pt=gn,ht=si,F=it;--F>=0;){for(C=0,J=kt[F]%ht,ut=kt[F]/ht|0,H=q,V=F+H;V>F;)Q=gt[--H]%ht,W=gt[H]/ht|0,X=ut*Q+W*J,Q=J*Q+X%ht*ht+ct[V]+C,C=(Q/pt|0)+(X/ht|0)+ut*W,ct[V--]=Q%pt;ct[V]=C}return C?++R:ct.splice(0,1),B(P,ct,R)},u.negated=function(){var P=new E(this);return P.s=-P.s||null,P},u.plus=function(P,S){var C,R=this,F=R.s;if(P=new E(P,S),S=P.s,!F||!S)return new E(NaN);if(F!=S)return P.s=-S,R.minus(P);var V=R.e/zt,H=P.e/zt,X=R.c,q=P.c;if(!V||!H){if(!X||!q)return new E(F/0);if(!X[0]||!q[0])return q[0]?P:new E(X[0]?R:F*0)}if(V=an(V),H=an(H),X=X.slice(),F=V-H){for(F>0?(H=V,C=q):(F=-F,C=X),C.reverse();F--;C.push(0));C.reverse()}for(F=X.length,S=q.length,F-S<0&&(C=q,q=X,X=C,S=F),F=0;S;)F=(X[--S]=X[S]+q[S]+F)/gn|0,X[S]=gn===X[S]?0:X[S]%gn;return F&&(X=[F].concat(X),++H),B(P,X,H)},u.precision=u.sd=function(P,S){var C,R,F,V=this;if(P!=null&&P!==!!P)return se(P,1,xe),S==null?S=d:se(S,0,8),z(new E(V),P,S);if(!(C=V.c))return null;if(F=C.length-1,R=F*zt+1,F=C[F]){for(;F%10==0;F/=10,R--);for(F=C[0];F>=10;F/=10,R++);}return P&&V.e+1>R&&(R=V.e+1),R},u.shiftedBy=function(P){return se(P,-Yo,Yo),this.times("1e"+P)},u.squareRoot=u.sqrt=function(){var P,S,C,R,F,V=this,H=V.c,X=V.s,q=V.e,Q=m+4,W=new E("0.5");if(X!==1||!H||!H[0])return new E(!X||X<0&&(!H||H[0])?NaN:H?V:1/0);if(X=Math.sqrt(+$(V)),X==0||X==1/0?(S=rn(H),(S.length+q)%2==0&&(S+="0"),X=Math.sqrt(+S),q=an((q+1)/2)-(q<0||q%2),X==1/0?S="5e"+q:(S=X.toExponential(),S=S.slice(0,S.indexOf("e")+1)+q),C=new E(S)):C=new E(X+""),C.c[0]){for(q=C.e,X=q+Q,X<3&&(X=0);;)if(F=C,C=W.times(F.plus(n(V,F,Q,1))),rn(F.c).slice(0,X)===(S=rn(C.c)).slice(0,X))if(C.e<q&&--X,S=S.slice(X-3,X+1),S=="9999"||!R&&S=="4999"){if(!R&&(z(F,F.e+m+2,0),F.times(F).eq(V))){C=F;break}Q+=4,X+=4,R=1}else{(!+S||!+S.slice(1)&&S.charAt(0)=="5")&&(z(C,C.e+m+2,1),P=!C.times(C).eq(V));break}}return z(C,C.e+m+1,d,P)},u.toExponential=function(P,S){return P!=null&&(se(P,0,xe),P++),G(this,P,S,1)},u.toFixed=function(P,S){return P!=null&&(se(P,0,xe),P=P+this.e+1),G(this,P,S)},u.toFormat=function(P,S,C){var R,F=this;if(C==null)P!=null&&S&&typeof S=="object"?(C=S,S=null):P&&typeof P=="object"?(C=P,P=S=null):C=Z;else if(typeof C!="object")throw Error(Ge+"Argument not an object: "+C);if(R=F.toFixed(P,S),F.c){var V,H=R.split("."),X=+C.groupSize,q=+C.secondaryGroupSize,Q=C.groupSeparator||"",W=H[0],it=H[1],J=F.s<0,ut=J?W.slice(1):W,ct=ut.length;if(q&&(V=X,X=q,q=V,ct-=V),X>0&&ct>0){for(V=ct%X||X,W=ut.substr(0,V);V<ct;V+=X)W+=Q+ut.substr(V,X);q>0&&(W+=Q+ut.slice(V)),J&&(W="-"+W)}R=it?W+(C.decimalSeparator||"")+((q=+C.fractionGroupSize)?it.replace(new RegExp("\\d{"+q+"}\\B","g"),"$&"+(C.fractionGroupSeparator||"")):it):W}return(C.prefix||"")+R+(C.suffix||"")},u.toFraction=function(P){var S,C,R,F,V,H,X,q,Q,W,it,J,ut=this,ct=ut.c;if(P!=null&&(X=new E(P),!X.isInteger()&&(X.c||X.s!==1)||X.lt(f)))throw Error(Ge+"Argument "+(X.isInteger()?"out of range: ":"not an integer: ")+$(X));if(!ct)return new E(ut);for(S=new E(f),Q=C=new E(f),R=q=new E(f),J=rn(ct),V=S.e=J.length-ut.e-1,S.c[0]=Vo[(H=V%zt)<0?zt+H:H],P=!P||X.comparedTo(S)>0?V>0?S:Q:X,H=I,I=1/0,X=new E(J),q.c[0]=0;W=n(X,S,0,1),F=C.plus(W.times(R)),F.comparedTo(P)!=1;)C=R,R=F,Q=q.plus(W.times(F=Q)),q=F,S=X.minus(W.times(F=S)),X=F;return F=n(P.minus(C),R,0,1),q=q.plus(F.times(Q)),C=C.plus(F.times(R)),q.s=Q.s=ut.s,V=V*2,it=n(Q,R,V,d).minus(ut).abs().comparedTo(n(q,C,V,d).minus(ut).abs())<1?[Q,R]:[q,C],I=H,it},u.toNumber=function(){return+$(this)},u.toPrecision=function(P,S){return P!=null&&se(P,1,xe),G(this,P,S,2)},u.toString=function(P){var S,C=this,R=C.s,F=C.e;return F===null?R?(S="Infinity",R<0&&(S="-"+S)):S="NaN":(P==null?S=F<=x||F>=v?Vs(rn(C.c),F):zn(rn(C.c),F,"0"):P===10&&tt?(C=z(new E(C),m+F+1,d),S=zn(rn(C.c),C.e,"0")):(se(P,2,Y.length,"Base"),S=r(zn(rn(C.c),F,"0"),10,P,R,!0)),R<0&&C.c[0]&&(S="-"+S)),S},u.valueOf=u.toJSON=function(){return $(this)},u._isBigNumber=!0,u[Symbol.toStringTag]="BigNumber",u[Symbol.for("nodejs.util.inspect.custom")]=u.valueOf,h!=null&&E.set(h),E}function an(h){var n=h|0;return h>0||h===n?n:n-1}function rn(h){for(var n,r,o=1,u=h.length,f=h[0]+"";o<u;){for(n=h[o++]+"",r=zt-n.length;r--;n="0"+n);f+=n}for(u=f.length;f.charCodeAt(--u)===48;);return f.slice(0,u+1||1)}function bi(h,n){var r,o,u=h.c,f=n.c,m=h.s,d=n.s,x=h.e,v=n.e;if(!m||!d)return null;if(r=u&&!u[0],o=f&&!f[0],r||o)return r?o?0:-d:m;if(m!=d)return m;if(r=m<0,o=x==v,!u||!f)return o?0:!u^r?1:-1;if(!o)return x>v^r?1:-1;for(d=(x=u.length)<(v=f.length)?x:v,m=0;m<d;m++)if(u[m]!=f[m])return u[m]>f[m]^r?1:-1;return x==v?0:x>v^r?1:-1}function se(h,n,r,o){if(h<n||h>r||h!==on(h))throw Error(Ge+(o||"Argument")+(typeof h=="number"?h<n||h>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(h))}function Ys(h){var n=h.c.length-1;return an(h.e/zt)==n&&h.c[n]%2!=0}function Vs(h,n){return(h.length>1?h.charAt(0)+"."+h.slice(1):h)+(n<0?"e":"e+")+n}function zn(h,n,r){var o,u;if(n<0){for(u=r+".";++n;u+=r);h=u+h}else if(o=h.length,++n>o){for(u=r,n-=o;--n;u+=r);h+=u}else n<o&&(h=h.slice(0,n)+"."+h.slice(n));return h}var Mn=Zu(),Gh=class{constructor(h){at(this,"key"),at(this,"left",null),at(this,"right",null),this.key=h}},jr=class extends Gh{constructor(h){super(h)}},Hh=class{constructor(){at(this,"size",0),at(this,"modificationCount",0),at(this,"splayCount",0)}splay(h){const n=this.root;if(n==null)return this.compare(h,h),-1;let r=null,o=null,u=null,f=null,m=n;const d=this.compare;let x;for(;;)if(x=d(m.key,h),x>0){let v=m.left;if(v==null||(x=d(v.key,h),x>0&&(m.left=v.right,v.right=m,m=v,v=m.left,v==null)))break;r==null?o=m:r.left=m,r=m,m=v}else if(x<0){let v=m.right;if(v==null||(x=d(v.key,h),x<0&&(m.right=v.left,v.left=m,m=v,v=m.right,v==null)))break;u==null?f=m:u.right=m,u=m,m=v}else break;return u!=null&&(u.right=m.left,m.left=f),r!=null&&(r.left=m.right,m.right=o),this.root!==m&&(this.root=m,this.splayCount++),x}splayMin(h){let n=h,r=n.left;for(;r!=null;){const o=r;n.left=o.right,o.right=n,n=o,r=n.left}return n}splayMax(h){let n=h,r=n.right;for(;r!=null;){const o=r;n.right=o.left,o.left=n,n=o,r=n.right}return n}_delete(h){if(this.root==null||this.splay(h)!=0)return null;let r=this.root;const o=r,u=r.left;if(this.size--,u==null)this.root=r.right;else{const f=r.right;r=this.splayMax(u),r.right=f,this.root=r}return this.modificationCount++,o}addNewRoot(h,n){this.size++,this.modificationCount++;const r=this.root;if(r==null){this.root=h;return}n<0?(h.left=r,h.right=r.right,r.right=null):(h.right=r,h.left=r.left,r.left=null),this.root=h}_first(){const h=this.root;return h==null?null:(this.root=this.splayMin(h),this.root)}_last(){const h=this.root;return h==null?null:(this.root=this.splayMax(h),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(h){return this.validKey(h)&&this.splay(h)==0}defaultCompare(){return(h,n)=>h<n?-1:h>n?1:0}wrap(){return{getRoot:()=>this.root,setRoot:h=>{this.root=h},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:h=>{this.splayCount=h},splay:h=>this.splay(h),has:h=>this.has(h)}}},uo=class rs extends Hh{constructor(n,r){super(),at(this,"root",null),at(this,"compare"),at(this,"validKey"),at(this,Ca,"[object Set]"),this.compare=n??this.defaultCompare(),this.validKey=r??(o=>o!=null&&o!=null)}delete(n){return this.validKey(n)?this._delete(n)!=null:!1}deleteAll(n){for(const r of n)this.delete(r)}forEach(n){const r=this[Symbol.iterator]();let o;for(;o=r.next(),!o.done;)n(o.value,o.value,this)}add(n){const r=this.splay(n);return r!=0&&this.addNewRoot(new jr(n),r),this}addAndReturn(n){const r=this.splay(n);return r!=0&&this.addNewRoot(new jr(n),r),this.root.key}addAll(n){for(const r of n)this.add(r)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)<0)return this.root.key;let o=this.root.left;if(o==null)return null;let u=o.right;for(;u!=null;)o=u,u=o.right;return o.key}firstAfter(n){if(n==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(n)>0)return this.root.key;let o=this.root.right;if(o==null)return null;let u=o.left;for(;u!=null;)o=u,u=o.left;return o.key}retainAll(n){const r=new rs(this.compare,this.validKey),o=this.modificationCount;for(const u of n){if(o!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(u)&&this.splay(u)==0&&r.add(this.root.key)}r.size!=this.size&&(this.root=r.root,this.size=r.size,this.modificationCount++)}lookup(n){return!this.validKey(n)||this.splay(n)!=0?null:this.root.key}intersection(n){const r=new rs(this.compare,this.validKey);for(const o of this)n.has(o)&&r.add(o);return r}difference(n){const r=new rs(this.compare,this.validKey);for(const o of this)n.has(o)||r.add(o);return r}union(n){const r=this.clone();return r.addAll(n),r}clone(){const n=new rs(this.compare,this.validKey);return n.size=this.size,n.root=this.copyNode(this.root),n}copyNode(n){if(n==null)return null;function r(u,f){let m,d;do{if(m=u.left,d=u.right,m!=null){const x=new jr(m.key);f.left=x,r(m,x)}if(d!=null){const x=new jr(d.key);f.right=x,u=d,f=x}}while(d!=null)}const o=new jr(n.key);return r(n,o),o}toSet(){return this.clone()}entries(){return new Uh(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(ba=Symbol.iterator,Ca=Symbol.toStringTag,ba)](){return new qh(this.wrap())}},Yu=class{constructor(h){at(this,"tree"),at(this,"path",new Array),at(this,"modificationCount",null),at(this,"splayCount"),this.tree=h,this.splayCount=h.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const h=this.path[this.path.length-1];return this.getValue(h)}rebuildPath(h){this.path.splice(0,this.path.length),this.tree.splay(h),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(h){for(;h!=null;)this.path.push(h),h=h.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let r=this.tree.getRoot();for(;r!=null;)this.path.push(r),r=r.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let h=this.path[this.path.length-1],n=h.right;if(n!=null){for(;n!=null;)this.path.push(n),n=n.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===h;)h=this.path.pop();return this.path.length>0}},qh=class extends Yu{getValue(h){return h.key}},Uh=class extends Yu{getValue(h){return[h.key,h.key]}},Vu=h=>()=>h,ea=h=>{const n=h?(r,o)=>o.minus(r).abs().isLessThanOrEqualTo(h):Vu(!1);return(r,o)=>n(r,o)?0:r.comparedTo(o)};function Zh(h){const n=h?(r,o,u,f,m)=>r.exponentiatedBy(2).isLessThanOrEqualTo(f.minus(o).exponentiatedBy(2).plus(m.minus(u).exponentiatedBy(2)).times(h)):Vu(!1);return(r,o,u)=>{const f=r.x,m=r.y,d=u.x,x=u.y,v=m.minus(x).times(o.x.minus(d)).minus(f.minus(d).times(o.y.minus(x)));return n(v,f,m,d,x)?0:v.comparedTo(0)}}var Yh=h=>h,Vh=h=>{if(h){const n=new uo(ea(h)),r=new uo(ea(h)),o=(f,m)=>m.addAndReturn(f),u=f=>({x:o(f.x,n),y:o(f.y,r)});return u({x:new Mn(0),y:new Mn(0)}),u}return Yh},na=h=>({set:n=>{Vn=na(n)},reset:()=>na(h),compare:ea(h),snap:Vh(h),orient:Zh(h)}),Vn=na(),Qr=(h,n)=>h.ll.x.isLessThanOrEqualTo(n.x)&&n.x.isLessThanOrEqualTo(h.ur.x)&&h.ll.y.isLessThanOrEqualTo(n.y)&&n.y.isLessThanOrEqualTo(h.ur.y),ia=(h,n)=>{if(n.ur.x.isLessThan(h.ll.x)||h.ur.x.isLessThan(n.ll.x)||n.ur.y.isLessThan(h.ll.y)||h.ur.y.isLessThan(n.ll.y))return null;const r=h.ll.x.isLessThan(n.ll.x)?n.ll.x:h.ll.x,o=h.ur.x.isLessThan(n.ur.x)?h.ur.x:n.ur.x,u=h.ll.y.isLessThan(n.ll.y)?n.ll.y:h.ll.y,f=h.ur.y.isLessThan(n.ur.y)?h.ur.y:n.ur.y;return{ll:{x:r,y:u},ur:{x:o,y:f}}},no=(h,n)=>h.x.times(n.y).minus(h.y.times(n.x)),Xu=(h,n)=>h.x.times(n.x).plus(h.y.times(n.y)),lo=h=>Xu(h,h).sqrt(),Xh=(h,n,r)=>{const o={x:n.x.minus(h.x),y:n.y.minus(h.y)},u={x:r.x.minus(h.x),y:r.y.minus(h.y)};return no(u,o).div(lo(u)).div(lo(o))},Wh=(h,n,r)=>{const o={x:n.x.minus(h.x),y:n.y.minus(h.y)},u={x:r.x.minus(h.x),y:r.y.minus(h.y)};return Xu(u,o).div(lo(u)).div(lo(o))},Ya=(h,n,r)=>n.y.isZero()?null:{x:h.x.plus(n.x.div(n.y).times(r.minus(h.y))),y:r},Va=(h,n,r)=>n.x.isZero()?null:{x:r,y:h.y.plus(n.y.div(n.x).times(r.minus(h.x)))},Kh=(h,n,r,o)=>{if(n.x.isZero())return Va(r,o,h.x);if(o.x.isZero())return Va(h,n,r.x);if(n.y.isZero())return Ya(r,o,h.y);if(o.y.isZero())return Ya(h,n,r.y);const u=no(n,o);if(u.isZero())return null;const f={x:r.x.minus(h.x),y:r.y.minus(h.y)},m=no(f,n).div(u),d=no(f,o).div(u),x=h.x.plus(d.times(n.x)),v=r.x.plus(m.times(o.x)),w=h.y.plus(d.times(n.y)),I=r.y.plus(m.times(o.y)),T=x.plus(v).div(2),b=w.plus(I).div(2);return{x:T,y:b}},Ln=class Wu{constructor(n,r){at(this,"point"),at(this,"isLeft"),at(this,"segment"),at(this,"otherSE"),at(this,"consumedBy"),n.events===void 0?n.events=[this]:n.events.push(this),this.point=n,this.isLeft=r}static compare(n,r){const o=Wu.comparePoints(n.point,r.point);return o!==0?o:(n.point!==r.point&&n.link(r),n.isLeft!==r.isLeft?n.isLeft?1:-1:ho.compare(n.segment,r.segment))}static comparePoints(n,r){return n.x.isLessThan(r.x)?-1:n.x.isGreaterThan(r.x)?1:n.y.isLessThan(r.y)?-1:n.y.isGreaterThan(r.y)?1:0}link(n){if(n.point===this.point)throw new Error("Tried to link already linked events");const r=n.point.events;for(let o=0,u=r.length;o<u;o++){const f=r[o];this.point.events.push(f),f.point=this.point}this.checkForConsuming()}checkForConsuming(){const n=this.point.events.length;for(let r=0;r<n;r++){const o=this.point.events[r];if(o.segment.consumedBy===void 0)for(let u=r+1;u<n;u++){const f=this.point.events[u];f.consumedBy===void 0&&o.otherSE.point.events===f.otherSE.point.events&&o.segment.consume(f.segment)}}}getAvailableLinkedEvents(){const n=[];for(let r=0,o=this.point.events.length;r<o;r++){const u=this.point.events[r];u!==this&&!u.segment.ringOut&&u.segment.isInResult()&&n.push(u)}return n}getLeftmostComparator(n){const r=new Map,o=u=>{const f=u.otherSE;r.set(u,{sine:Xh(this.point,n.point,f.point),cosine:Wh(this.point,n.point,f.point)})};return(u,f)=>{r.has(u)||o(u),r.has(f)||o(f);const{sine:m,cosine:d}=r.get(u),{sine:x,cosine:v}=r.get(f);return m.isGreaterThanOrEqualTo(0)&&x.isGreaterThanOrEqualTo(0)?d.isLessThan(v)?1:d.isGreaterThan(v)?-1:0:m.isLessThan(0)&&x.isLessThan(0)?d.isLessThan(v)?-1:d.isGreaterThan(v)?1:0:x.isLessThan(m)?-1:x.isGreaterThan(m)?1:0}}},$h=class ra{constructor(n){at(this,"events"),at(this,"poly"),at(this,"_isExteriorRing"),at(this,"_enclosingRing"),this.events=n;for(let r=0,o=n.length;r<o;r++)n[r].segment.ringOut=this;this.poly=null}static factory(n){const r=[];for(let o=0,u=n.length;o<u;o++){const f=n[o];if(!f.isInResult()||f.ringOut)continue;let m=null,d=f.leftSE,x=f.rightSE;const v=[d],w=d.point,I=[];for(;m=d,d=x,v.push(d),d.point!==w;)for(;;){const T=d.getAvailableLinkedEvents();if(T.length===0){const Z=v[0].point,Y=v[v.length-1].point;throw new Error(`Unable to complete output ring starting at [${Z.x}, ${Z.y}]. Last matching segment found ends at [${Y.x}, ${Y.y}].`)}if(T.length===1){x=T[0].otherSE;break}let b=null;for(let Z=0,Y=I.length;Z<Y;Z++)if(I[Z].point===d.point){b=Z;break}if(b!==null){const Z=I.splice(b)[0],Y=v.splice(Z.index);Y.unshift(Y[0].otherSE),r.push(new ra(Y.reverse()));continue}I.push({index:v.length,point:d.point});const D=d.getLeftmostComparator(m);x=T.sort(D)[0].otherSE;break}r.push(new ra(v))}return r}getGeom(){let n=this.events[0].point;const r=[n];for(let v=1,w=this.events.length-1;v<w;v++){const I=this.events[v].point,T=this.events[v+1].point;Vn.orient(I,n,T)!==0&&(r.push(I),n=I)}if(r.length===1)return null;const o=r[0],u=r[1];Vn.orient(o,n,u)===0&&r.shift(),r.push(r[0]);const f=this.isExteriorRing()?1:-1,m=this.isExteriorRing()?0:r.length-1,d=this.isExteriorRing()?r.length:-1,x=[];for(let v=m;v!=d;v+=f)x.push([r[v].x.toNumber(),r[v].y.toNumber()]);return x}isExteriorRing(){if(this._isExteriorRing===void 0){const n=this.enclosingRing();this._isExteriorRing=n?!n.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var n,r;let o=this.events[0];for(let m=1,d=this.events.length;m<d;m++){const x=this.events[m];Ln.compare(o,x)>0&&(o=x)}let u=o.segment.prevInResult(),f=u?u.prevInResult():null;for(;;){if(!u)return null;if(!f)return u.ringOut;if(f.ringOut!==u.ringOut)return((n=f.ringOut)==null?void 0:n.enclosingRing())!==u.ringOut?u.ringOut:(r=u.ringOut)==null?void 0:r.enclosingRing();u=f.prevInResult(),f=u?u.prevInResult():null}}},Xa=class{constructor(h){at(this,"exteriorRing"),at(this,"interiorRings"),this.exteriorRing=h,h.poly=this,this.interiorRings=[]}addInterior(h){this.interiorRings.push(h),h.poly=this}getGeom(){const h=this.exteriorRing.getGeom();if(h===null)return null;const n=[h];for(let r=0,o=this.interiorRings.length;r<o;r++){const u=this.interiorRings[r].getGeom();u!==null&&n.push(u)}return n}},Jh=class{constructor(h){at(this,"rings"),at(this,"polys"),this.rings=h,this.polys=this._composePolys(h)}getGeom(){const h=[];for(let n=0,r=this.polys.length;n<r;n++){const o=this.polys[n].getGeom();o!==null&&h.push(o)}return h}_composePolys(h){var n;const r=[];for(let o=0,u=h.length;o<u;o++){const f=h[o];if(!f.poly)if(f.isExteriorRing())r.push(new Xa(f));else{const m=f.enclosingRing();m!=null&&m.poly||r.push(new Xa(m)),(n=m==null?void 0:m.poly)==null||n.addInterior(f)}}return r}},jh=class{constructor(h,n=ho.compare){at(this,"queue"),at(this,"tree"),at(this,"segments"),this.queue=h,this.tree=new uo(n),this.segments=[]}process(h){const n=h.segment,r=[];if(h.consumedBy)return h.isLeft?this.queue.delete(h.otherSE):this.tree.delete(n),r;h.isLeft&&this.tree.add(n);let o=n,u=n;do o=this.tree.lastBefore(o);while(o!=null&&o.consumedBy!=null);do u=this.tree.firstAfter(u);while(u!=null&&u.consumedBy!=null);if(h.isLeft){let f=null;if(o){const d=o.getIntersection(n);if(d!==null&&(n.isAnEndpoint(d)||(f=d),!o.isAnEndpoint(d))){const x=this._splitSafely(o,d);for(let v=0,w=x.length;v<w;v++)r.push(x[v])}}let m=null;if(u){const d=u.getIntersection(n);if(d!==null&&(n.isAnEndpoint(d)||(m=d),!u.isAnEndpoint(d))){const x=this._splitSafely(u,d);for(let v=0,w=x.length;v<w;v++)r.push(x[v])}}if(f!==null||m!==null){let d=null;f===null?d=m:m===null?d=f:d=Ln.comparePoints(f,m)<=0?f:m,this.queue.delete(n.rightSE),r.push(n.rightSE);const x=n.split(d);for(let v=0,w=x.length;v<w;v++)r.push(x[v])}r.length>0?(this.tree.delete(n),r.push(h)):(this.segments.push(n),n.prev=o)}else{if(o&&u){const f=o.getIntersection(u);if(f!==null){if(!o.isAnEndpoint(f)){const m=this._splitSafely(o,f);for(let d=0,x=m.length;d<x;d++)r.push(m[d])}if(!u.isAnEndpoint(f)){const m=this._splitSafely(u,f);for(let d=0,x=m.length;d<x;d++)r.push(m[d])}}}this.tree.delete(n)}return r}_splitSafely(h,n){this.tree.delete(h);const r=h.rightSE;this.queue.delete(r);const o=h.split(n);return o.push(r),h.consumedBy===void 0&&this.tree.add(h),o}},Qh=class{constructor(){at(this,"type"),at(this,"numMultiPolys")}run(h,n,r){ss.type=h;const o=[new Ka(n,!0)];for(let v=0,w=r.length;v<w;v++)o.push(new Ka(r[v],!1));if(ss.numMultiPolys=o.length,ss.type==="difference"){const v=o[0];let w=1;for(;w<o.length;)ia(o[w].bbox,v.bbox)!==null?w++:o.splice(w,1)}if(ss.type==="intersection")for(let v=0,w=o.length;v<w;v++){const I=o[v];for(let T=v+1,b=o.length;T<b;T++)if(ia(I.bbox,o[T].bbox)===null)return[]}const u=new uo(Ln.compare);for(let v=0,w=o.length;v<w;v++){const I=o[v].getSweepEvents();for(let T=0,b=I.length;T<b;T++)u.add(I[T])}const f=new jh(u);let m=null;for(u.size!=0&&(m=u.first(),u.delete(m));m;){const v=f.process(m);for(let w=0,I=v.length;w<I;w++){const T=v[w];T.consumedBy===void 0&&u.add(T)}u.size!=0?(m=u.first(),u.delete(m)):m=null}Vn.reset();const d=$h.factory(f.segments);return new Jh(d).getGeom()}},ss=new Qh,ms=ss,tc=0,ho=class io{constructor(n,r,o,u){at(this,"id"),at(this,"leftSE"),at(this,"rightSE"),at(this,"rings"),at(this,"windings"),at(this,"ringOut"),at(this,"consumedBy"),at(this,"prev"),at(this,"_prevInResult"),at(this,"_beforeState"),at(this,"_afterState"),at(this,"_isInResult"),this.id=++tc,this.leftSE=n,n.segment=this,n.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=n,this.rings=o,this.windings=u}static compare(n,r){const o=n.leftSE.point.x,u=r.leftSE.point.x,f=n.rightSE.point.x,m=r.rightSE.point.x;if(m.isLessThan(o))return 1;if(f.isLessThan(u))return-1;const d=n.leftSE.point.y,x=r.leftSE.point.y,v=n.rightSE.point.y,w=r.rightSE.point.y;if(o.isLessThan(u)){if(x.isLessThan(d)&&x.isLessThan(v))return 1;if(x.isGreaterThan(d)&&x.isGreaterThan(v))return-1;const I=n.comparePoint(r.leftSE.point);if(I<0)return 1;if(I>0)return-1;const T=r.comparePoint(n.rightSE.point);return T!==0?T:-1}if(o.isGreaterThan(u)){if(d.isLessThan(x)&&d.isLessThan(w))return-1;if(d.isGreaterThan(x)&&d.isGreaterThan(w))return 1;const I=r.comparePoint(n.leftSE.point);if(I!==0)return I;const T=n.comparePoint(r.rightSE.point);return T<0?1:T>0?-1:1}if(d.isLessThan(x))return-1;if(d.isGreaterThan(x))return 1;if(f.isLessThan(m)){const I=r.comparePoint(n.rightSE.point);if(I!==0)return I}if(f.isGreaterThan(m)){const I=n.comparePoint(r.rightSE.point);if(I<0)return 1;if(I>0)return-1}if(!f.eq(m)){const I=v.minus(d),T=f.minus(o),b=w.minus(x),D=m.minus(u);if(I.isGreaterThan(T)&&b.isLessThan(D))return 1;if(I.isLessThan(T)&&b.isGreaterThan(D))return-1}return f.isGreaterThan(m)?1:f.isLessThan(m)||v.isLessThan(w)?-1:v.isGreaterThan(w)?1:n.id<r.id?-1:n.id>r.id?1:0}static fromRing(n,r,o){let u,f,m;const d=Ln.comparePoints(n,r);if(d<0)u=n,f=r,m=1;else if(d>0)u=r,f=n,m=-1;else throw new Error(`Tried to create degenerate segment at [${n.x}, ${n.y}]`);const x=new Ln(u,!0),v=new Ln(f,!1);return new io(x,v,[o],[m])}replaceRightSE(n){this.rightSE=n,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const n=this.leftSE.point.y,r=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:n.isLessThan(r)?n:r},ur:{x:this.rightSE.point.x,y:n.isGreaterThan(r)?n:r}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(n){return n.x.eq(this.leftSE.point.x)&&n.y.eq(this.leftSE.point.y)||n.x.eq(this.rightSE.point.x)&&n.y.eq(this.rightSE.point.y)}comparePoint(n){return Vn.orient(this.leftSE.point,n,this.rightSE.point)}getIntersection(n){const r=this.bbox(),o=n.bbox(),u=ia(r,o);if(u===null)return null;const f=this.leftSE.point,m=this.rightSE.point,d=n.leftSE.point,x=n.rightSE.point,v=Qr(r,d)&&this.comparePoint(d)===0,w=Qr(o,f)&&n.comparePoint(f)===0,I=Qr(r,x)&&this.comparePoint(x)===0,T=Qr(o,m)&&n.comparePoint(m)===0;if(w&&v)return T&&!I?m:!T&&I?x:null;if(w)return I&&f.x.eq(x.x)&&f.y.eq(x.y)?null:f;if(v)return T&&m.x.eq(d.x)&&m.y.eq(d.y)?null:d;if(T&&I)return null;if(T)return m;if(I)return x;const b=Kh(f,this.vector(),d,n.vector());return b===null||!Qr(u,b)?null:Vn.snap(b)}split(n){const r=[],o=n.events!==void 0,u=new Ln(n,!0),f=new Ln(n,!1),m=this.rightSE;this.replaceRightSE(f),r.push(f),r.push(u);const d=new io(u,m,this.rings.slice(),this.windings.slice());return Ln.comparePoints(d.leftSE.point,d.rightSE.point)>0&&d.swapEvents(),Ln.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),o&&(u.checkForConsuming(),f.checkForConsuming()),r}swapEvents(){const n=this.rightSE;this.rightSE=this.leftSE,this.leftSE=n,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let r=0,o=this.windings.length;r<o;r++)this.windings[r]*=-1}consume(n){let r=this,o=n;for(;r.consumedBy;)r=r.consumedBy;for(;o.consumedBy;)o=o.consumedBy;const u=io.compare(r,o);if(u!==0){if(u>0){const f=r;r=o,o=f}if(r.prev===o){const f=r;r=o,o=f}for(let f=0,m=o.rings.length;f<m;f++){const d=o.rings[f],x=o.windings[f],v=r.rings.indexOf(d);v===-1?(r.rings.push(d),r.windings.push(x)):r.windings[v]+=x}o.rings=null,o.windings=null,o.consumedBy=r,o.leftSE.consumedBy=r.leftSE,o.rightSE.consumedBy=r.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const n=this.prev.consumedBy||this.prev;this._beforeState=n.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const n=this.beforeState();this._afterState={rings:n.rings.slice(0),windings:n.windings.slice(0),multiPolys:[]};const r=this._afterState.rings,o=this._afterState.windings,u=this._afterState.multiPolys;for(let d=0,x=this.rings.length;d<x;d++){const v=this.rings[d],w=this.windings[d],I=r.indexOf(v);I===-1?(r.push(v),o.push(w)):o[I]+=w}const f=[],m=[];for(let d=0,x=r.length;d<x;d++){if(o[d]===0)continue;const v=r[d],w=v.poly;if(m.indexOf(w)===-1)if(v.isExterior)f.push(w);else{m.indexOf(w)===-1&&m.push(w);const I=f.indexOf(v.poly);I!==-1&&f.splice(I,1)}}for(let d=0,x=f.length;d<x;d++){const v=f[d].multiPoly;u.indexOf(v)===-1&&u.push(v)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const n=this.beforeState().multiPolys,r=this.afterState().multiPolys;switch(ms.type){case"union":{const o=n.length===0,u=r.length===0;this._isInResult=o!==u;break}case"intersection":{let o,u;n.length<r.length?(o=n.length,u=r.length):(o=r.length,u=n.length),this._isInResult=u===ms.numMultiPolys&&o<u;break}case"xor":{const o=Math.abs(n.length-r.length);this._isInResult=o%2===1;break}case"difference":{const o=u=>u.length===1&&u[0].isSubject;this._isInResult=o(n)!==o(r);break}}return this._isInResult}},Wa=class{constructor(h,n,r){if(at(this,"poly"),at(this,"isExterior"),at(this,"segments"),at(this,"bbox"),!Array.isArray(h)||h.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],typeof h[0][0]!="number"||typeof h[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const o=Vn.snap({x:new Mn(h[0][0]),y:new Mn(h[0][1])});this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};let u=o;for(let f=1,m=h.length;f<m;f++){if(typeof h[f][0]!="number"||typeof h[f][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const d=Vn.snap({x:new Mn(h[f][0]),y:new Mn(h[f][1])});d.x.eq(u.x)&&d.y.eq(u.y)||(this.segments.push(ho.fromRing(u,d,this)),d.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=d.x),d.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=d.y),d.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=d.x),d.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=d.y),u=d)}(!o.x.eq(u.x)||!o.y.eq(u.y))&&this.segments.push(ho.fromRing(u,o,this))}getSweepEvents(){const h=[];for(let n=0,r=this.segments.length;n<r;n++){const o=this.segments[n];h.push(o.leftSE),h.push(o.rightSE)}return h}},ec=class{constructor(h,n){if(at(this,"multiPoly"),at(this,"exteriorRing"),at(this,"interiorRings"),at(this,"bbox"),!Array.isArray(h))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Wa(h[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let r=1,o=h.length;r<o;r++){const u=new Wa(h[r],this,!1);u.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=u.bbox.ll.x),u.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=u.bbox.ll.y),u.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=u.bbox.ur.x),u.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=u.bbox.ur.y),this.interiorRings.push(u)}this.multiPoly=n}getSweepEvents(){const h=this.exteriorRing.getSweepEvents();for(let n=0,r=this.interiorRings.length;n<r;n++){const o=this.interiorRings[n].getSweepEvents();for(let u=0,f=o.length;u<f;u++)h.push(o[u])}return h}},Ka=class{constructor(h,n){if(at(this,"isSubject"),at(this,"polys"),at(this,"bbox"),!Array.isArray(h))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof h[0][0][0]=="number"&&(h=[h])}catch{}this.polys=[],this.bbox={ll:{x:new Mn(Number.POSITIVE_INFINITY),y:new Mn(Number.POSITIVE_INFINITY)},ur:{x:new Mn(Number.NEGATIVE_INFINITY),y:new Mn(Number.NEGATIVE_INFINITY)}};for(let r=0,o=h.length;r<o;r++){const u=new ec(h[r],this);u.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=u.bbox.ll.x),u.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=u.bbox.ll.y),u.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=u.bbox.ur.x),u.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=u.bbox.ur.y),this.polys.push(u)}this.isSubject=n}getSweepEvents(){const h=[];for(let n=0,r=this.polys.length;n<r;n++){const o=this.polys[n].getSweepEvents();for(let u=0,f=o.length;u<f;u++)h.push(o[u])}return h}},nc=(h,...n)=>ms.run("union",h,n),ic=(h,...n)=>ms.run("intersection",h,n),rc=(h,...n)=>ms.run("difference",h,n);Vn.set;function sc(h,n={}){const r=[];if(ci(h,u=>{r.push(u.coordinates)}),r.length<2)throw new Error("Must have at least 2 geometries");const o=nc(r[0],...r.slice(1));return o.length===0?null:o.length===1?Yn(o[0],n.properties):ko(o,n.properties)}var oc=sc;function ac(h,n={}){const r=[];if(ci(h,u=>{r.push(u.coordinates)}),r.length<2)throw new Error("Must specify at least 2 geometries");const o=ic(r[0],...r.slice(1));return o.length===0?null:o.length===1?Yn(o[0],n.properties):ko(o,n.properties)}var $a=ac;function uc(h){const n=[];if(ci(h,u=>{n.push(u.coordinates)}),n.length<2)throw new Error("Must have at least two features");const r=h.features[0].properties||{},o=rc(n[0],...n.slice(1));return o.length===0?null:o.length===1?Yn(o[0],r):ko(o,r)}var lc=uc;function hc(h){const n=[];return h.type==="FeatureCollection"?li(h,function(r){qn(r,function(o){n.push(Hn(o,r.properties))})}):h.type==="Feature"?qn(h,function(r){n.push(Hn(r,h.properties))}):qn(h,function(r){n.push(Hn(r))}),Sn(n)}var ar=hc;function dr(h,n={}){if(h.bbox!=null&&n.recompute!==!0)return h.bbox;const r=[1/0,1/0,-1/0,-1/0];return qn(h,o=>{r[0]>o[0]&&(r[0]=o[0]),r[1]>o[1]&&(r[1]=o[1]),r[2]<o[0]&&(r[2]=o[0]),r[3]<o[1]&&(r[3]=o[1])}),r}function cc(h,n={}){const r=dr(h),o=(r[0]+r[2])/2,u=(r[1]+r[3])/2;return Hn([o,u],n.properties,n)}var ro={exports:{}},fc=ro.exports,Ja;function gc(){return Ja||(Ja=1,function(h,n){(function(r,o){h.exports=o()})(fc,function(){function r(a,t){(t==null||t>a.length)&&(t=a.length);for(var e=0,s=Array(t);e<t;e++)s[e]=a[e];return s}function o(a,t,e){return t=w(t),function(s,c){if(c&&(typeof c=="object"||typeof c=="function"))return c;if(c!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}(s)}(a,T()?Reflect.construct(t,e||[],w(a).constructor):t.apply(a,e))}function u(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function f(a,t,e){if(T())return Reflect.construct.apply(null,arguments);var s=[null];s.push.apply(s,t);var c=new(a.bind.apply(a,s));return e&&b(c,e.prototype),c}function m(a,t){for(var e=0;e<t.length;e++){var s=t[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(a,Y(s.key),s)}}function d(a,t,e){return t&&m(a.prototype,t),e&&m(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function x(a,t){var e=typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(!e){if(Array.isArray(a)||(e=tt(a))||t){e&&(a=e);var s=0,c=function(){};return{s:c,n:function(){return s>=a.length?{done:!0}:{done:!1,value:a[s++]}},e:function(O){throw O},f:c}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p,_=!0,M=!1;return{s:function(){e=e.call(a)},n:function(){var O=e.next();return _=O.done,O},e:function(O){M=!0,p=O},f:function(){try{_||e.return==null||e.return()}finally{if(M)throw p}}}}function v(){return v=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(a,t,e){var s=function(p,_){for(;!{}.hasOwnProperty.call(p,_)&&(p=w(p))!==null;);return p}(a,t);if(s){var c=Object.getOwnPropertyDescriptor(s,t);return c.get?c.get.call(arguments.length<3?a:e):c.value}},v.apply(null,arguments)}function w(a){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(a)}function I(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&b(a,t)}function T(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(T=function(){return!!a})()}function b(a,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,s){return e.__proto__=s,e},b(a,t)}function D(a,t,e,s){var c=v(w(1&s?a.prototype:a),t,e);return 2&s&&typeof c=="function"?function(p){return c.apply(e,p)}:c}function Z(a){return function(t){if(Array.isArray(t))return r(t)}(a)||function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(a)||tt(a)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Y(a){var t=function(e,s){if(typeof e!="object"||!e)return e;var c=e[Symbol.toPrimitive];if(c!==void 0){var p=c.call(e,s);if(typeof p!="object")return p;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a,"string");return typeof t=="symbol"?t:t+""}function tt(a,t){if(a){if(typeof a=="string")return r(a,t);var e={}.toString.call(a).slice(8,-1);return e==="Object"&&a.constructor&&(e=a.constructor.name),e==="Map"||e==="Set"?Array.from(a):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(a,t):void 0}}function E(a){var t=typeof Map=="function"?new Map:void 0;return E=function(e){if(e===null||!function(c){try{return Function.toString.call(c).indexOf("[native code]")!==-1}catch{return typeof c=="function"}}(e))return e;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(e))return t.get(e);t.set(e,s)}function s(){return f(e,arguments,w(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),b(s,e)},E(a)}var G=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(t){this._quadrantSegments=t,this._quadrantSegments===0&&(this._joinStyle=a.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=a.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==a.JOIN_ROUND&&(this._quadrantSegments=a.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(t){this._joinStyle=t}},{key:"setSimplifyFactor",value:function(t){this._simplifyFactor=t<0?0:t}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(t){this._endCapStyle=t}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(t){this._mitreLimit=t}},{key:"setSingleSided",value:function(t){this._isSingleSided=t}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=a.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=a.CAP_ROUND,this._joinStyle=a.JOIN_ROUND,this._mitreLimit=a.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=a.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setQuadrantSegments(t)}else if(arguments.length===2){var e=arguments[0],s=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(s)}else if(arguments.length===4){var c=arguments[0],p=arguments[1],_=arguments[2],M=arguments[3];this.setQuadrantSegments(c),this.setEndCapStyle(p),this.setJoinStyle(_),this.setMitreLimit(M)}}}},{key:"bufferDistanceError",value:function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)}}])}();G.CAP_ROUND=1,G.CAP_FLAT=2,G.CAP_SQUARE=3,G.JOIN_ROUND=1,G.JOIN_MITRE=2,G.JOIN_BEVEL=3,G.DEFAULT_QUADRANT_SEGMENTS=8,G.DEFAULT_MITRE_LIMIT=5,G.DEFAULT_SIMPLIFY_FACTOR=.01;var N=function(a){function t(e){var s;return u(this,t),(s=o(this,t,[e])).name=Object.keys({Exception:t})[0],s}return I(t,a),d(t,[{key:"toString",value:function(){return this.message}}])}(E(Error)),B=function(a){function t(e){var s;return u(this,t),(s=o(this,t,[e])).name=Object.keys({IllegalArgumentException:t})[0],s}return I(t,a),d(t)}(N),z=function(){return d(function a(){u(this,a)},[{key:"filter",value:function(a){}}])}();function $(){}function P(){}function S(){}var C,R,F,V,H,X,q,Q,W=function(){return d(function a(){u(this,a)},null,[{key:"equalsWithTolerance",value:function(a,t,e){return Math.abs(a-t)<=e}}])}(),it=function(){return d(function a(t,e){u(this,a),this.low=e||0,this.high=t||0},null,[{key:"toBinaryString",value:function(a){var t,e="";for(t=2147483648;t>0;t>>>=1)e+=(a.high&t)===t?"1":"0";for(t=2147483648;t>0;t>>>=1)e+=(a.low&t)===t?"1":"0";return e}}])}();function J(){}function ut(){}J.NaN=NaN,J.isNaN=function(a){return Number.isNaN(a)},J.isInfinite=function(a){return!Number.isFinite(a)},J.MAX_VALUE=Number.MAX_VALUE,J.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,J.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(X=2146435072,q=new Float64Array(1),Q=new Int32Array(q.buffer),J.doubleToLongBits=function(a){q[0]=a;var t=0|Q[0],e=0|Q[1];return(e&X)===X&&1048575&e&&t!==0&&(t=0,e=2146959360),new it(e,t)},J.longBitsToDouble=function(a){return Q[0]=a.low,Q[1]=a.high,q[0]}):(C=1023,R=Math.log2,F=Math.floor,V=Math.pow,H=function(){for(var a=53;a>0;a--){var t=V(2,a)-1;if(F(R(t))+1===a)return t}return 0}(),J.doubleToLongBits=function(a){var t,e,s,c,p,_,M,O,U;if(a<0||1/a===Number.NEGATIVE_INFINITY?(_=1<<31,a=-a):_=0,a===0)return new it(O=_,U=0);if(a===1/0)return new it(O=2146435072|_,U=0);if(a!=a)return new it(O=2146959360,U=0);if(c=0,U=0,(t=F(a))>1)if(t<=H)(c=F(R(t)))<=20?(U=0,O=t<<20-c&1048575):(U=t%(e=V(2,s=c-20))<<32-s,O=t/e&1048575);else for(s=t,U=0;(s=F(e=s/2))!==0;)c++,U>>>=1,U|=(1&O)<<31,O>>>=1,e!==s&&(O|=524288);if(M=c+C,p=t===0,t=a-t,c<52&&t!==0)for(s=0;;){if((e=2*t)>=1?(t=e-1,p?(M--,p=!1):(s<<=1,s|=1,c++)):(t=e,p?--M==0&&(c++,p=!1):(s<<=1,c++)),c===20)O|=s,s=0;else if(c===52){U|=s;break}if(e===1){c<20?O|=s<<20-c:c<52&&(U|=s<<52-c);break}}return O|=M<<20,new it(O|=_,U)},J.longBitsToDouble=function(a){var t,e,s,c,p=a.high,_=a.low,M=p&1<<31?-1:1;for(s=((2146435072&p)>>20)-C,c=0,e=1<<19,t=1;t<=20;t++)p&e&&(c+=V(2,-t)),e>>>=1;for(e=1<<31,t=21;t<=52;t++)_&e&&(c+=V(2,-t)),e>>>=1;if(s===-1023){if(c===0)return 0*M;s=-1022}else{if(s===1024)return c===0?M/0:NaN;c+=1}return M*c*V(2,s)});var ct=function(a){function t(e){var s;return u(this,t),(s=o(this,t,[e])).name=Object.keys({RuntimeException:t})[0],s}return I(t,a),d(t)}(N),pt=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,null,[{key:"constructor_",value:function(){if(arguments.length===0)ct.constructor_.call(this);else if(arguments.length===1){var e=arguments[0];ct.constructor_.call(this,e)}}}])}(ct),ht=function(){function a(){u(this,a)}return d(a,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)a.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new pt("Should never reach here"+(t!==null?": "+t:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var t=arguments[0];a.isTrue(t,null)}else if(arguments.length===2){var e=arguments[1];if(!arguments[0])throw e===null?new pt:new pt(e)}}},{key:"equals",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];a.equals(t,e,null)}else if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2];if(!c.equals(s))throw new pt("Expected "+s+" but encountered "+c+(p!==null?": "+p:""))}}}])}(),ft=new ArrayBuffer(8),gt=new Float64Array(ft),kt=new Int32Array(ft),nt=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"getM",value:function(){return J.NaN}},{key:"setOrdinate",value:function(t,e){switch(t){case a.X:this.x=e;break;case a.Y:this.y=e;break;case a.Z:this.setZ(e);break;default:throw new B("Invalid ordinate index: "+t)}}},{key:"equals2D",value:function(){if(arguments.length===1){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(arguments.length===2){var e=arguments[0],s=arguments[1];return!!W.equalsWithTolerance(this.x,e.x,s)&&!!W.equalsWithTolerance(this.y,e.y,s)}}},{key:"setM",value:function(t){throw new B("Invalid ordinate index: "+a.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(t){switch(t){case a.X:return this.x;case a.Y:return this.y;case a.Z:return this.getZ()}throw new B("Invalid ordinate index: "+t)}},{key:"equals3D",value:function(t){return this.x===t.x&&this.y===t.y&&(this.getZ()===t.getZ()||J.isNaN(this.getZ())&&J.isNaN(t.getZ()))}},{key:"equals",value:function(t){return t instanceof a&&this.equals2D(t)}},{key:"equalInZ",value:function(t,e){return W.equalsWithTolerance(this.getZ(),t.getZ(),e)}},{key:"setX",value:function(t){this.x=t}},{key:"compareTo",value:function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(t){this.z=t}},{key:"clone",value:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return ht.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}},{key:"copy",value:function(){return new a(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(t){var e=this.x-t.x,s=this.y-t.y,c=this.getZ()-t.getZ();return Math.sqrt(e*e+s*s+c*c)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(t){this.y=t}},{key:"distance",value:function(t){var e=this.x-t.x,s=this.y-t.y;return Math.sqrt(e*e+s*s)}},{key:"hashCode",value:function(){var t=17;return t=37*(t=37*t+a.hashCode(this.x))+a.hashCode(this.y)}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}},{key:"interfaces_",get:function(){return[$,P,S]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)a.constructor_.call(this,0,0);else if(arguments.length===1){var t=arguments[0];a.constructor_.call(this,t.x,t.y,t.getZ())}else if(arguments.length===2){var e=arguments[0],s=arguments[1];a.constructor_.call(this,e,s,a.NULL_ORDINATE)}else if(arguments.length===3){var c=arguments[0],p=arguments[1],_=arguments[2];this.x=c,this.y=p,this.z=_}}},{key:"hashCode",value:function(t){return gt[0]=t,kt[0]^kt[1]}}])}(),Kt=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"compare",value:function(t,e){var s=a.compare(t.x,e.x);if(s!==0)return s;var c=a.compare(t.y,e.y);return c!==0?c:this._dimensionsToTest<=2?0:a.compare(t.getZ(),e.getZ())}},{key:"interfaces_",get:function(){return[ut]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)a.constructor_.call(this,2);else if(arguments.length===1){var t=arguments[0];if(t!==2&&t!==3)throw new B("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}},{key:"compare",value:function(t,e){return t<e?-1:t>e?1:J.isNaN(t)?J.isNaN(e)?0:-1:J.isNaN(e)?1:0}}])}();nt.DimensionalComparator=Kt,nt.NULL_ORDINATE=J.NaN,nt.X=0,nt.Y=1,nt.Z=2,nt.M=3;var bt=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(t){if(!(t instanceof a))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()}},{key:"intersection",value:function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new a;var e=this._minx>t._minx?this._minx:t._minx,s=this._miny>t._miny?this._miny:t._miny;return new a(e,this._maxx<t._maxx?this._maxx:t._maxx,s,this._maxy<t._maxy?this._maxy:t._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof nt){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof a){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];return!this.isNull()&&s>=this._minx&&s<=this._maxx&&c>=this._miny&&c<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof a){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof nt){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(arguments.length===2){if(arguments[0]instanceof nt&&arguments[1]instanceof nt){var s=arguments[0],c=arguments[1];return!this.isNull()&&!((s.x<c.x?s.x:c.x)>this._maxx)&&!((s.x>c.x?s.x:c.x)<this._minx)&&!((s.y<c.y?s.y:c.y)>this._maxy)&&!((s.y>c.y?s.y:c.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var p=arguments[0],_=arguments[1];return!this.isNull()&&!(p>this._maxx||p<this._minx||_>this._maxy||_<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return Math.sqrt(t*t+e*e)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof nt){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof a){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.isNull()?(this._minx=s,this._maxx=s,this._miny=c,this._maxy=c):(s<this._minx&&(this._minx=s),s>this._maxx&&(this._maxx=s),c<this._miny&&(this._miny=c),c>this._maxy&&(this._maxy=c))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}},{key:"translate",value:function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}},{key:"copy",value:function(){return new a(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(t){return!(!this.isNull()&&!t.isNull())||t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e}},{key:"expandBy",value:function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var e=arguments[0],s=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=s,this._maxy+=s,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof a){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof nt){var e=arguments[0];return this.covers(e)}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];return this.covers(s,c)}}},{key:"centre",value:function(){return this.isNull()?null:new nt((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof nt){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof a){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.init(s.x,c.x,s.y,c.y)}else if(arguments.length===4){var p=arguments[0],_=arguments[1],M=arguments[2],O=arguments[3];p<_?(this._minx=p,this._maxx=_):(this._minx=_,this._maxx=p),M<O?(this._miny=M,this._maxy=O):(this._miny=O,this._maxy=M)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var s=0;return this._maxy<t._miny?s=t._miny-this._maxy:this._miny>t._maxy&&(s=this._miny-t._maxy),e===0?s:s===0?e:Math.sqrt(e*e+s*s)}},{key:"hashCode",value:function(){var t=17;return t=37*(t=37*(t=37*(t=37*t+nt.hashCode(this._minx))+nt.hashCode(this._maxx))+nt.hashCode(this._miny))+nt.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[$,S]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof nt){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof a){var e=arguments[0];this.init(e)}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.init(s.x,c.x,s.y,c.y)}else if(arguments.length===4){var p=arguments[0],_=arguments[1],M=arguments[2],O=arguments[3];this.init(p,_,M,O)}}},{key:"intersects",value:function(){if(arguments.length===3){var t=arguments[0],e=arguments[1],s=arguments[2];return s.x>=(t.x<e.x?t.x:e.x)&&s.x<=(t.x>e.x?t.x:e.x)&&s.y>=(t.y<e.y?t.y:e.y)&&s.y<=(t.y>e.y?t.y:e.y)}if(arguments.length===4){var c=arguments[0],p=arguments[1],_=arguments[2],M=arguments[3],O=Math.min(_.x,M.x),U=Math.max(_.x,M.x),et=Math.min(c.x,p.x),rt=Math.max(c.x,p.x);return!(et>U)&&!(rt<O)&&(O=Math.min(_.y,M.y),U=Math.max(_.y,M.y),et=Math.min(c.y,p.y),rt=Math.max(c.y,p.y),!(et>U)&&!(rt<O))}}}])}(),vt=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===a.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(t){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(t){return this===t||this.equalsExact(t,0)}},{key:"geometryChanged",value:function(){this.apply(a.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(t){return t!==null&&this.norm().equalsExact(t.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var t;if(arguments.length===1){var e=arguments[0];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(arguments.length===2){var s=arguments[0],c=arguments[1];return t=s,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(s,c)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(t){if(t.getTypeCode()===a.TYPECODE_GEOMETRYCOLLECTION)throw new B("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(t,e,s){return s===0?t.equals(e):t.distance(e)<=s}},{key:"norm",value:function(){var t=this.copy();return t.normalize(),t}},{key:"reverse",value:function(){var t=this.reverseInternal();return this.envelope!=null&&(t.envelope=this.envelope.copy()),t.setSRID(this.getSRID()),t}},{key:"copy",value:function(){var t=this.copyInternal();return t.envelope=this._envelope==null?null:this._envelope.copy(),t._SRID=this._SRID,t._userData=this._userData,t}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new bt(this._envelope)}},{key:"setSRID",value:function(t){this._SRID=t}},{key:"setUserData",value:function(t){this._userData=t}},{key:"compare",value:function(t,e){for(var s=t.iterator(),c=e.iterator();s.hasNext()&&c.hasNext();){var p=s.next(),_=c.next(),M=p.compareTo(_);if(M!==0)return M}return s.hasNext()?1:c.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(t){return this.getClass()===t.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===a.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===a.TYPECODE_MULTIPOINT||this.getTypeCode()===a.TYPECODE_MULTILINESTRING||this.getTypeCode()===a.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[P,$,S]}},{key:"getClass",value:function(){return a}}],[{key:"hasNonEmptyElements",value:function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(t){for(var e=0;e<t.length;e++)if(t[e]===null)return!0;return!1}}])}();vt.constructor_=function(a){a&&(this._envelope=null,this._userData=null,this._factory=a,this._SRID=a.getSRID())},vt.TYPECODE_POINT=0,vt.TYPECODE_MULTIPOINT=1,vt.TYPECODE_LINESTRING=2,vt.TYPECODE_LINEARRING=3,vt.TYPECODE_MULTILINESTRING=4,vt.TYPECODE_POLYGON=5,vt.TYPECODE_MULTIPOLYGON=6,vt.TYPECODE_GEOMETRYCOLLECTION=7,vt.TYPENAME_POINT="Point",vt.TYPENAME_MULTIPOINT="MultiPoint",vt.TYPENAME_LINESTRING="LineString",vt.TYPENAME_LINEARRING="LinearRing",vt.TYPENAME_MULTILINESTRING="MultiLineString",vt.TYPENAME_POLYGON="Polygon",vt.TYPENAME_MULTIPOLYGON="MultiPolygon",vt.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",vt.geometryChangedFilter={get interfaces_(){return[z]},filter:function(a){a.geometryChangedAction()}};var K=function(){function a(){u(this,a)}return d(a,null,[{key:"toLocationSymbol",value:function(t){switch(t){case a.EXTERIOR:return"e";case a.BOUNDARY:return"b";case a.INTERIOR:return"i";case a.NONE:return"-"}throw new B("Unknown location value: "+t)}}])}();K.INTERIOR=0,K.BOUNDARY=1,K.EXTERIOR=2,K.NONE=-1;var Rt=function(){return d(function a(){u(this,a)},[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}])}(),qt=function(a){function t(e){var s;return u(this,t),(s=o(this,t,[e])).name=Object.keys({NoSuchElementException:t})[0],s}return I(t,a),d(t)}(N),St=function(a){function t(e){var s;return u(this,t),(s=o(this,t,[e])).name=Object.keys({UnsupportedOperationException:t})[0],s}return I(t,a),d(t)}(N),we=function(a){function t(){return u(this,t),o(this,t,arguments)}return I(t,a),d(t,[{key:"contains",value:function(){}}])}(Rt),fe=function(a){function t(e){var s;return u(this,t),(s=o(this,t)).map=new Map,e instanceof Rt&&s.addAll(e),s}return I(t,a),d(t,[{key:"contains",value:function(e){var s=e.hashCode?e.hashCode():e;return!!this.map.has(s)}},{key:"add",value:function(e){var s=e.hashCode?e.hashCode():e;return!this.map.has(s)&&!!this.map.set(s,e)}},{key:"addAll",value:function(e){var s,c=x(e);try{for(c.s();!(s=c.n()).done;){var p=s.value;this.add(p)}}catch(_){c.e(_)}finally{c.f()}return!0}},{key:"remove",value:function(){throw new St}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new Te(this.map)}},{key:Symbol.iterator,value:function(){return this.map}}])}(we),Te=function(){return d(function a(t){u(this,a),this.iterator=t.values();var e=this.iterator.next(),s=e.done,c=e.value;this.done=s,this.value=c},[{key:"next",value:function(){if(this.done)throw new qt;var a=this.value,t=this.iterator.next(),e=t.done,s=t.value;return this.done=e,this.value=s,a}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new St}}])}(),yt=function(){function a(){u(this,a)}return d(a,null,[{key:"opposite",value:function(t){return t===a.LEFT?a.RIGHT:t===a.RIGHT?a.LEFT:t}}])}();yt.ON=0,yt.LEFT=1,yt.RIGHT=2;var gi=function(a){function t(e){var s;return u(this,t),(s=o(this,t,[e])).name=Object.keys({EmptyStackException:t})[0],s}return I(t,a),d(t)}(N),Xn=function(a){function t(e){var s;return u(this,t),(s=o(this,t,[e])).name=Object.keys({IndexOutOfBoundsException:t})[0],s}return I(t,a),d(t)}(N),Ze=function(a){function t(){return u(this,t),o(this,t,arguments)}return I(t,a),d(t,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}])}(Rt),Ai=function(a){function t(){var e;return u(this,t),(e=o(this,t)).array=[],e}return I(t,a),d(t,[{key:"add",value:function(e){return this.array.push(e),!0}},{key:"get",value:function(e){if(e<0||e>=this.size())throw new Xn;return this.array[e]}},{key:"push",value:function(e){return this.array.push(e),e}},{key:"pop",value:function(){if(this.array.length===0)throw new gi;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new gi;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(e){return this.array.indexOf(e)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}])}(Ze);function Ot(a,t){return a.interfaces_&&a.interfaces_.indexOf(t)>-1}var pn=function(){return d(function a(t){u(this,a),this.str=t},[{key:"append",value:function(a){this.str+=a}},{key:"setCharAt",value:function(a,t){this.str=this.str.substr(0,a)+t+this.str.substr(a+1)}},{key:"toString",value:function(){return this.str}}])}(),Ye=function(){function a(t){u(this,a),this.value=t}return d(a,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(t){return this.value<t?-1:this.value>t?1:0}}],[{key:"compare",value:function(t,e){return t<e?-1:t>e?1:0}},{key:"isNan",value:function(t){return Number.isNaN(t)}},{key:"valueOf",value:function(t){return new a(t)}}])}(),Di=function(){return d(function a(){u(this,a)},null,[{key:"isWhitespace",value:function(a){return a<=32&&a>=0||a===127}},{key:"toUpperCase",value:function(a){return a.toUpperCase()}}])}(),Ct=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"le",value:function(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}},{key:"extractSignificantDigits",value:function(t,e){var s=this.abs(),c=a.magnitude(s._hi),p=a.TEN.pow(c);(s=s.divide(p)).gt(a.TEN)?(s=s.divide(a.TEN),c+=1):s.lt(a.ONE)&&(s=s.multiply(a.TEN),c-=1);for(var _=c+1,M=new pn,O=a.MAX_PRINT_DIGITS-1,U=0;U<=O;U++){t&&U===_&&M.append(".");var et=Math.trunc(s._hi);if(et<0)break;var rt=!1,dt=0;et>9?(rt=!0,dt="9"):dt="0"+et,M.append(dt),s=s.subtract(a.valueOf(et)).multiply(a.TEN),rt&&s.selfAdd(a.TEN);var xt=!0,Pt=a.magnitude(s._hi);if(Pt<0&&Math.abs(Pt)>=O-U&&(xt=!1),!xt)break}return e[0]=c,M.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof a){var t=arguments[0];return this.add(t.negate())}if(typeof arguments[0]=="number"){var e=arguments[0];return this.add(-e)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof a){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof a){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(t){return this.le(t)?this:t}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof a){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfDivide(e,0)}}else if(arguments.length===2){var s,c,p,_,M=arguments[0],O=arguments[1],U=null,et=null,rt=null,dt=null;return p=this._hi/M,dt=(U=(rt=a.SPLIT*p)-(U=rt-p))*(et=(dt=a.SPLIT*M)-(et=dt-M))-(_=p*M)+U*(c=M-et)+(s=p-U)*et+s*c,dt=p+(rt=(this._hi-_-dt+this._lo-p*O)/M),this._hi=dt,this._lo=p-dt+rt,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof a){var t,e,s,c,p=arguments[0],_=null,M=null,O=null,U=null;return t=(s=this._hi/p._hi)-(_=(O=a.SPLIT*s)-(_=O-s)),U=_*(M=(U=a.SPLIT*p._hi)-(M=U-p._hi))-(c=s*p._hi)+_*(e=p._hi-M)+t*M+t*e,new a(U=s+(O=(this._hi-c-U+this._lo-s*p._lo)/p._hi),s-U+O)}if(typeof arguments[0]=="number"){var et=arguments[0];return J.isNaN(et)?a.createNaN():a.copy(this).selfDivide(et,0)}}},{key:"ge",value:function(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}},{key:"pow",value:function(t){if(t===0)return a.valueOf(1);var e=new a(this),s=a.valueOf(1),c=Math.abs(t);if(c>1)for(;c>0;)c%2==1&&s.selfMultiply(e),(c/=2)>0&&(e=e.sqr());else s=e;return t<0?s.reciprocal():s}},{key:"ceil",value:function(){if(this.isNaN())return a.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new a(t,e)}},{key:"compareTo",value:function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof a){var t=arguments[0];return this.init(t),this}if(typeof arguments[0]=="number"){var e=arguments[0];return this.init(e),this}}},{key:"max",value:function(t){return this.ge(t)?this:t}},{key:"sqrt",value:function(){if(this.isZero())return a.valueOf(0);if(this.isNegative())return a.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,s=a.valueOf(e),c=this.subtract(s.sqr())._hi*(.5*t);return s.add(c)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof a){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if(typeof arguments[0]=="number"){var e,s,c,p,_,M=arguments[0],O=null;return O=(c=this._hi+M)-(p=c-this._hi),s=(_=(O=M-p+(this._hi-O))+this._lo)+(c-(e=c+_)),this._hi=e+s,this._lo=s+(e-this._hi),this}}else if(arguments.length===2){var U,et,rt,dt,xt=arguments[0],Pt=arguments[1],Mt=null,Vt=null,Ht=null;rt=this._hi+xt,et=this._lo+Pt,Vt=rt-(Ht=rt-this._hi),Mt=et-(dt=et-this._lo);var te=(U=rt+(Ht=(Vt=xt-Ht+(this._hi-Vt))+et))+(Ht=(Mt=Pt-dt+(this._lo-Mt))+(Ht+(rt-U))),ie=Ht+(U-te);return this._hi=te,this._lo=ie,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof a){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfMultiply(e,0)}}else if(arguments.length===2){var s,c,p=arguments[0],_=arguments[1],M=null,O=null,U=null,et=null;M=(U=a.SPLIT*this._hi)-this._hi,et=a.SPLIT*p,M=U-M,s=this._hi-M,O=et-p;var rt=(U=this._hi*p)+(et=M*(O=et-O)-U+M*(c=p-O)+s*O+s*c+(this._hi*_+this._lo*p)),dt=et+(M=U-rt);return this._hi=rt,this._lo=dt,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return a.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new a(t,e)}},{key:"negate",value:function(){return this.isNaN()?this:new a(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}},{key:"multiply",value:function(){if(arguments[0]instanceof a){var t=arguments[0];return t.isNaN()?a.createNaN():a.copy(this).selfMultiply(t)}if(typeof arguments[0]=="number"){var e=arguments[0];return J.isNaN(e)?a.createNaN():a.copy(this).selfMultiply(e,0)}}},{key:"isNaN",value:function(){return J.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var t=a.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),s=this.extractSignificantDigits(!0,e),c=e[0]+1,p=s;if(s.charAt(0)===".")p="0"+s;else if(c<0)p="0."+a.stringOfChar("0",-c)+s;else if(s.indexOf(".")===-1){var _=c-s.length;p=s+a.stringOfChar("0",_)+".0"}return this.isNegative()?"-"+p:p}},{key:"reciprocal",value:function(){var t,e,s,c,p=null,_=null,M=null,O=null;t=(s=1/this._hi)-(p=(M=a.SPLIT*s)-(p=M-s)),_=(O=a.SPLIT*this._hi)-this._hi;var U=s+(M=(1-(c=s*this._hi)-(O=p*(_=O-_)-c+p*(e=this._hi-_)+t*_+t*e)-s*this._lo)/this._hi);return new a(U,s-U+M)}},{key:"toSciNotation",value:function(){if(this.isZero())return a.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),s=this.extractSignificantDigits(!1,e),c=a.SCI_NOT_EXPONENT_CHAR+e[0];if(s.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+s);var p="";s.length>1&&(p=s.substring(1));var _=s.charAt(0)+"."+p;return this.isNegative()?"-"+_+c:_+c}},{key:"abs",value:function(){return this.isNaN()?a.NaN:this.isNegative()?this.negate():new a(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}},{key:"add",value:function(){if(arguments[0]instanceof a){var t=arguments[0];return a.copy(this).selfAdd(t)}if(typeof arguments[0]=="number"){var e=arguments[0];return a.copy(this).selfAdd(e)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof a){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this._hi=s,this._lo=c}}},{key:"gt",value:function(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?a.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[S,$,P]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof a){var e=arguments[0];this.init(e)}else if(typeof arguments[0]=="string"){var s=arguments[0];a.constructor_.call(this,a.parse(s))}}else if(arguments.length===2){var c=arguments[0],p=arguments[1];this.init(c,p)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1],s=arguments[2],c=arguments[3];return a.determinant(a.valueOf(t),a.valueOf(e),a.valueOf(s),a.valueOf(c))}if(arguments[3]instanceof a&&arguments[2]instanceof a&&arguments[0]instanceof a&&arguments[1]instanceof a){var p=arguments[1],_=arguments[2],M=arguments[3];return arguments[0].multiply(M).selfSubtract(p.multiply(_))}}},{key:"sqr",value:function(t){return a.valueOf(t).selfMultiply(t)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var t=arguments[0];return a.parse(t)}if(typeof arguments[0]=="number")return new a(arguments[0])}},{key:"sqrt",value:function(t){return a.valueOf(t).sqrt()}},{key:"parse",value:function(t){for(var e=0,s=t.length;Di.isWhitespace(t.charAt(e));)e++;var c=!1;if(e<s){var p=t.charAt(e);p!=="-"&&p!=="+"||(e++,p==="-"&&(c=!0))}for(var _=new a,M=0,O=0,U=0,et=!1;!(e>=s);){var rt=t.charAt(e);if(e++,Di.isDigit(rt)){var dt=rt-"0";_.selfMultiply(a.TEN),_.selfAdd(dt),M++}else{if(rt!=="."){if(rt==="e"||rt==="E"){var xt=t.substring(e);try{U=Ye.parseInt(xt)}catch(te){throw te instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+xt+" in string "+t):te}break}throw new NumberFormatException("Unexpected character '"+rt+"' at position "+e+" in string "+t)}O=M,et=!0}}var Pt=_;et||(O=M);var Mt=M-O-U;if(Mt===0)Pt=_;else if(Mt>0){var Vt=a.TEN.pow(Mt);Pt=_.divide(Vt)}else if(Mt<0){var Ht=a.TEN.pow(-Mt);Pt=_.multiply(Ht)}return c?Pt.negate():Pt}},{key:"createNaN",value:function(){return new a(J.NaN,J.NaN)}},{key:"copy",value:function(t){return new a(t)}},{key:"magnitude",value:function(t){var e=Math.abs(t),s=Math.log(e)/Math.log(10),c=Math.trunc(Math.floor(s));return 10*Math.pow(10,c)<=e&&(c+=1),c}},{key:"stringOfChar",value:function(t,e){for(var s=new pn,c=0;c<e;c++)s.append(t);return s.toString()}}])}();Ct.PI=new Ct(3.141592653589793,12246467991473532e-32),Ct.TWO_PI=new Ct(6.283185307179586,24492935982947064e-32),Ct.PI_2=new Ct(1.5707963267948966,6123233995736766e-32),Ct.E=new Ct(2.718281828459045,14456468917292502e-32),Ct.NaN=new Ct(J.NaN,J.NaN),Ct.EPS=123259516440783e-46,Ct.SPLIT=134217729,Ct.MAX_PRINT_DIGITS=32,Ct.TEN=Ct.valueOf(10),Ct.ONE=Ct.valueOf(1),Ct.SCI_NOT_EXPONENT_CHAR="E",Ct.SCI_NOT_ZERO="0.0E0";var kr=function(){function a(){u(this,a)}return d(a,null,[{key:"orientationIndex",value:function(t,e,s){var c=a.orientationIndexFilter(t,e,s);if(c<=1)return c;var p=Ct.valueOf(e.x).selfAdd(-t.x),_=Ct.valueOf(e.y).selfAdd(-t.y),M=Ct.valueOf(s.x).selfAdd(-e.x),O=Ct.valueOf(s.y).selfAdd(-e.y);return p.selfMultiply(O).selfSubtract(_.selfMultiply(M)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof Ct&&arguments[2]instanceof Ct&&arguments[0]instanceof Ct&&arguments[1]instanceof Ct){var t=arguments[1],e=arguments[2],s=arguments[3];return arguments[0].multiply(s).selfSubtract(t.multiply(e)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var c=arguments[0],p=arguments[1],_=arguments[2],M=arguments[3],O=Ct.valueOf(c),U=Ct.valueOf(p),et=Ct.valueOf(_),rt=Ct.valueOf(M);return O.multiply(rt).selfSubtract(U.multiply(et)).signum()}}},{key:"intersection",value:function(t,e,s,c){var p=new Ct(t.y).selfSubtract(e.y),_=new Ct(e.x).selfSubtract(t.x),M=new Ct(t.x).selfMultiply(e.y).selfSubtract(new Ct(e.x).selfMultiply(t.y)),O=new Ct(s.y).selfSubtract(c.y),U=new Ct(c.x).selfSubtract(s.x),et=new Ct(s.x).selfMultiply(c.y).selfSubtract(new Ct(c.x).selfMultiply(s.y)),rt=_.multiply(et).selfSubtract(U.multiply(M)),dt=O.multiply(M).selfSubtract(p.multiply(et)),xt=p.multiply(U).selfSubtract(O.multiply(_)),Pt=rt.selfDivide(xt).doubleValue(),Mt=dt.selfDivide(xt).doubleValue();return J.isNaN(Pt)||J.isInfinite(Pt)||J.isNaN(Mt)||J.isInfinite(Mt)?null:new nt(Pt,Mt)}},{key:"orientationIndexFilter",value:function(t,e,s){var c=null,p=(t.x-s.x)*(e.y-s.y),_=(t.y-s.y)*(e.x-s.x),M=p-_;if(p>0){if(_<=0)return a.signum(M);c=p+_}else{if(!(p<0)||_>=0)return a.signum(M);c=-p-_}var O=a.DP_SAFE_EPSILON*c;return M>=O||-M>=O?a.signum(M):2}},{key:"signum",value:function(t){return t>0?1:t<0?-1:0}}])}();kr.DP_SAFE_EPSILON=1e-15;var Zt=function(){return d(function a(){u(this,a)},[{key:"getM",value:function(a){if(this.hasM()){var t=this.getDimension()-this.getMeasures();return this.getOrdinate(a,t)}return J.NaN}},{key:"setOrdinate",value:function(a,t,e){}},{key:"getZ",value:function(a){return this.hasZ()?this.getOrdinate(a,2):J.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(a,t){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(a){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(a){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(a){}},{key:"copy",value:function(){}},{key:"getY",value:function(a){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[P]}}])}();Zt.X=0,Zt.Y=1,Zt.Z=2,Zt.M=3;var Tt=function(){function a(){u(this,a)}return d(a,null,[{key:"index",value:function(t,e,s){return kr.orientationIndex(t,e,s)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var t=arguments[0],e=t.length-1;if(e<3)throw new B("Ring has fewer than 4 points, so orientation cannot be determined");for(var s=t[0],c=0,p=1;p<=e;p++){var _=t[p];_.y>s.y&&(s=_,c=p)}var M=c;do(M-=1)<0&&(M=e);while(t[M].equals2D(s)&&M!==c);var O=c;do O=(O+1)%e;while(t[O].equals2D(s)&&O!==c);var U=t[M],et=t[O];if(U.equals2D(s)||et.equals2D(s)||U.equals2D(et))return!1;var rt=a.index(U,s,et);return rt===0?U.x>et.x:rt>0}if(Ot(arguments[0],Zt)){var dt=arguments[0],xt=dt.size()-1;if(xt<3)throw new B("Ring has fewer than 4 points, so orientation cannot be determined");for(var Pt=dt.getCoordinate(0),Mt=0,Vt=1;Vt<=xt;Vt++){var Ht=dt.getCoordinate(Vt);Ht.y>Pt.y&&(Pt=Ht,Mt=Vt)}var te=null,ie=Mt;do(ie-=1)<0&&(ie=xt),te=dt.getCoordinate(ie);while(te.equals2D(Pt)&&ie!==Mt);var de=null,Pn=Mt;do Pn=(Pn+1)%xt,de=dt.getCoordinate(Pn);while(de.equals2D(Pt)&&Pn!==Mt);if(te.equals2D(Pt)||de.equals2D(Pt)||te.equals2D(de))return!1;var Si=a.index(te,Pt,de);return Si===0?te.x>de.x:Si>0}}}])}();Tt.CLOCKWISE=-1,Tt.RIGHT=Tt.CLOCKWISE,Tt.COUNTERCLOCKWISE=1,Tt.LEFT=Tt.COUNTERCLOCKWISE,Tt.COLLINEAR=0,Tt.STRAIGHT=Tt.COLLINEAR;var wo=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(a,t){var e=this.getRightmostSideOfSegment(a,t);return e<0&&(e=this.getRightmostSideOfSegment(a,t-1)),e<0&&(this._minCoord=null,this.checkForRightmostCoordinate(a)),e}},{key:"findRightmostEdgeAtVertex",value:function(){var a=this._minDe.getEdge().getCoordinates();ht.isTrue(this._minIndex>0&&this._minIndex<a.length,"rightmost point expected to be interior vertex of edge");var t=a[this._minIndex-1],e=a[this._minIndex+1],s=Tt.index(this._minCoord,e,t),c=!1;(t.y<this._minCoord.y&&e.y<this._minCoord.y&&s===Tt.COUNTERCLOCKWISE||t.y>this._minCoord.y&&e.y>this._minCoord.y&&s===Tt.CLOCKWISE)&&(c=!0),c&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(a,t){var e=a.getEdge().getCoordinates();if(t<0||t+1>=e.length||e[t].y===e[t+1].y)return-1;var s=yt.LEFT;return e[t].y<e[t+1].y&&(s=yt.RIGHT),s}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(a){for(var t=a.getEdge().getCoordinates(),e=0;e<t.length-1;e++)(this._minCoord===null||t[e].x>this._minCoord.x)&&(this._minDe=a,this._minIndex=e,this._minCoord=t[e])}},{key:"findRightmostEdgeAtNode",value:function(){var a=this._minDe.getNode().getEdges();this._minDe=a.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(a){for(var t=a.iterator();t.hasNext();){var e=t.next();e.isForward()&&this.checkForRightmostCoordinate(e)}ht.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===yt.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}])}(),Ve=function(a){function t(e,s){var c;return u(this,t),(c=o(this,t,[s?e+" [ "+s+" ]":e])).pt=s?new nt(s):void 0,c.name=Object.keys({TopologyException:t})[0],c}return I(t,a),d(t,[{key:"getCoordinate",value:function(){return this.pt}}])}(ct),wr=function(){return d(function a(){u(this,a),this.array=[]},[{key:"addLast",value:function(a){this.array.push(a)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}])}(),It=function(a){function t(e){var s;return u(this,t),(s=o(this,t)).array=[],e instanceof Rt&&s.addAll(e),s}return I(t,a),d(t,[{key:"interfaces_",get:function(){return[Ze,Rt]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(e){return arguments.length===1?this.array.push(e):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(e){var s,c=x(e);try{for(c.s();!(s=c.n()).done;){var p=s.value;this.array.push(p)}}catch(_){c.e(_)}finally{c.f()}}},{key:"set",value:function(e,s){var c=this.array[e];return this.array[e]=s,c}},{key:"iterator",value:function(){return new Eo(this)}},{key:"get",value:function(e){if(e<0||e>=this.size())throw new Xn;return this.array[e]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(e){e?this.array.sort(function(s,c){return e.compare(s,c)}):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(e){for(var s=0,c=this.array.length;s<c;s++)if(this.array[s]===e)return!!this.array.splice(s,1);return!1}},{key:Symbol.iterator,value:function(){return this.array.values()}}])}(Ze),Eo=function(){return d(function a(t){u(this,a),this.arrayList=t,this.position=0},[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new qt;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(a){return this.arrayList.set(this.position-1,a)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}])}(),di=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"clearVisitedEdges",value:function(){for(var a=this._dirEdgeList.iterator();a.hasNext();)a.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(a){for(var t=null,e=a.getEdges().iterator();e.hasNext();){var s=e.next();if(s.isVisited()||s.getSym().isVisited()){t=s;break}}if(t===null)throw new Ve("unable to find edge to compute depths at "+a.getCoordinate());a.getEdges().computeDepths(t);for(var c=a.getEdges().iterator();c.hasNext();){var p=c.next();p.setVisited(!0),this.copySymDepths(p)}}},{key:"computeDepth",value:function(a){this.clearVisitedEdges();var t=this._finder.getEdge();t.getNode(),t.getLabel(),t.setEdgeDepths(yt.RIGHT,a),this.copySymDepths(t),this.computeDepths(t)}},{key:"create",value:function(a){this.addReachable(a),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var a=this._dirEdgeList.iterator();a.hasNext();){var t=a.next();t.getDepth(yt.RIGHT)>=1&&t.getDepth(yt.LEFT)<=0&&!t.isInteriorAreaEdge()&&t.setInResult(!0)}}},{key:"computeDepths",value:function(a){var t=new fe,e=new wr,s=a.getNode();for(e.addLast(s),t.add(s),a.setVisited(!0);!e.isEmpty();){var c=e.removeFirst();t.add(c),this.computeNodeDepth(c);for(var p=c.getEdges().iterator();p.hasNext();){var _=p.next().getSym();if(!_.isVisited()){var M=_.getNode();t.contains(M)||(e.addLast(M),t.add(M))}}}}},{key:"compareTo",value:function(a){var t=a;return this._rightMostCoord.x<t._rightMostCoord.x?-1:this._rightMostCoord.x>t._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var a=new bt,t=this._dirEdgeList.iterator();t.hasNext();)for(var e=t.next().getEdge().getCoordinates(),s=0;s<e.length-1;s++)a.expandToInclude(e[s]);this._env=a}return this._env}},{key:"addReachable",value:function(a){var t=new Ai;for(t.add(a);!t.empty();){var e=t.pop();this.add(e,t)}}},{key:"copySymDepths",value:function(a){var t=a.getSym();t.setDepth(yt.LEFT,a.getDepth(yt.RIGHT)),t.setDepth(yt.RIGHT,a.getDepth(yt.LEFT))}},{key:"add",value:function(a,t){a.setVisited(!0),this._nodes.add(a);for(var e=a.getEdges().iterator();e.hasNext();){var s=e.next();this._dirEdgeList.add(s);var c=s.getSym().getNode();c.isVisited()||t.push(c)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[$]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new It,this._nodes=new It,this._rightMostCoord=null,this._env=null,this._finder=new wo}}])}(),Er=function(){return d(function a(){u(this,a)},null,[{key:"intersection",value:function(a,t,e,s){var c=a.x<t.x?a.x:t.x,p=a.y<t.y?a.y:t.y,_=a.x>t.x?a.x:t.x,M=a.y>t.y?a.y:t.y,O=e.x<s.x?e.x:s.x,U=e.y<s.y?e.y:s.y,et=e.x>s.x?e.x:s.x,rt=e.y>s.y?e.y:s.y,dt=((c>O?c:O)+(_<et?_:et))/2,xt=((p>U?p:U)+(M<rt?M:rt))/2,Pt=a.x-dt,Mt=a.y-xt,Vt=t.x-dt,Ht=t.y-xt,te=e.x-dt,ie=e.y-xt,de=s.x-dt,Pn=s.y-xt,Si=Mt-Ht,en=Vt-Pt,Kr=Pt*Ht-Vt*Mt,$r=ie-Pn,ri=de-te,Fs=te*Pn-de*ie,Ci=Si*ri-$r*en,Bn=(en*Fs-ri*Kr)/Ci,ir=($r*Kr-Si*Fs)/Ci;return J.isNaN(Bn)||J.isInfinite(Bn)||J.isNaN(ir)||J.isInfinite(ir)?null:new nt(Bn+dt,ir+xt)}}])}(),Fe=function(){return d(function a(){u(this,a)},null,[{key:"arraycopy",value:function(a,t,e,s,c){for(var p=0,_=t;_<t+c;_++)e[s+p]=a[_],p++}},{key:"getProperty",value:function(a){return{"line.separator":`
`}[a]}}])}(),Wn=function(){function a(){u(this,a)}return d(a,null,[{key:"log10",value:function(t){var e=Math.log(t);return J.isInfinite(e)||J.isNaN(e)?e:e/a.LOG_10}},{key:"min",value:function(t,e,s,c){var p=t;return e<p&&(p=e),s<p&&(p=s),c<p&&(p=c),p}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1],s=arguments[2];return t<e?e:t>s?s:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var c=arguments[0],p=arguments[1],_=arguments[2];return c<p?p:c>_?_:c}}},{key:"wrap",value:function(t,e){return t<0?e- -t%e:t%e}},{key:"max",value:function(){if(arguments.length===3){var t=arguments[1],e=arguments[2],s=arguments[0];return t>s&&(s=t),e>s&&(s=e),s}if(arguments.length===4){var c=arguments[1],p=arguments[2],_=arguments[3],M=arguments[0];return c>M&&(M=c),p>M&&(M=p),_>M&&(M=_),M}}},{key:"average",value:function(t,e){return(t+e)/2}}])}();Wn.LOG_10=Math.log(10);var He=function(){function a(){u(this,a)}return d(a,null,[{key:"segmentToSegment",value:function(t,e,s,c){if(t.equals(e))return a.pointToSegment(t,s,c);if(s.equals(c))return a.pointToSegment(c,t,e);var p=!1;if(bt.intersects(t,e,s,c)){var _=(e.x-t.x)*(c.y-s.y)-(e.y-t.y)*(c.x-s.x);if(_===0)p=!0;else{var M=(t.y-s.y)*(c.x-s.x)-(t.x-s.x)*(c.y-s.y),O=((t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y))/_,U=M/_;(U<0||U>1||O<0||O>1)&&(p=!0)}}else p=!0;return p?Wn.min(a.pointToSegment(t,s,c),a.pointToSegment(e,s,c),a.pointToSegment(s,t,e),a.pointToSegment(c,t,e)):0}},{key:"pointToSegment",value:function(t,e,s){if(e.x===s.x&&e.y===s.y)return t.distance(e);var c=(s.x-e.x)*(s.x-e.x)+(s.y-e.y)*(s.y-e.y),p=((t.x-e.x)*(s.x-e.x)+(t.y-e.y)*(s.y-e.y))/c;if(p<=0)return t.distance(e);if(p>=1)return t.distance(s);var _=((e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y))/c;return Math.abs(_)*Math.sqrt(c)}},{key:"pointToLinePerpendicular",value:function(t,e,s){var c=(s.x-e.x)*(s.x-e.x)+(s.y-e.y)*(s.y-e.y),p=((e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y))/c;return Math.abs(p)*Math.sqrt(c)}},{key:"pointToSegmentString",value:function(t,e){if(e.length===0)throw new B("Line array must contain at least one vertex");for(var s=t.distance(e[0]),c=0;c<e.length-1;c++){var p=a.pointToSegment(t,e[c],e[c+1]);p<s&&(s=p)}return s}}])}(),Pr=function(){return d(function a(){u(this,a)},[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||Ot(arguments[0],Zt);else if(arguments.length!==2){if(arguments.length===3){var a=arguments[0],t=arguments[1];return this.create(a,t)}}}}])}(),Ri=function(){return d(function a(){u(this,a)},[{key:"filter",value:function(a){}}])}(),Po=function(){return d(function a(){u(this,a)},null,[{key:"ofLine",value:function(a){var t=a.size();if(t<=1)return 0;var e=0,s=new nt;a.getCoordinate(0,s);for(var c=s.x,p=s.y,_=1;_<t;_++){a.getCoordinate(_,s);var M=s.x,O=s.y,U=M-c,et=O-p;e+=Math.sqrt(U*U+et*et),c=M,p=O}return e}}])}(),_s=d(function a(){u(this,a)}),Tn=function(){function a(){u(this,a)}return d(a,null,[{key:"copyCoord",value:function(t,e,s,c){for(var p=Math.min(t.getDimension(),s.getDimension()),_=0;_<p;_++)s.setOrdinate(c,_,t.getOrdinate(e,_))}},{key:"isRing",value:function(t){var e=t.size();return e===0||!(e<=3)&&t.getOrdinate(0,Zt.X)===t.getOrdinate(e-1,Zt.X)&&t.getOrdinate(0,Zt.Y)===t.getOrdinate(e-1,Zt.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(Ot(arguments[0],Zt)&&Number.isInteger(arguments[1])){var t=arguments[0],e=arguments[1];a.scroll(t,e,a.isRing(t))}else if(Ot(arguments[0],Zt)&&arguments[1]instanceof nt){var s=arguments[0],c=arguments[1],p=a.indexOf(c,s);if(p<=0)return null;a.scroll(s,p)}}else if(arguments.length===3){var _=arguments[0],M=arguments[1],O=arguments[2];if(M<=0)return null;for(var U=_.copy(),et=O?_.size()-1:_.size(),rt=0;rt<et;rt++)for(var dt=0;dt<_.getDimension();dt++)_.setOrdinate(rt,dt,U.getOrdinate((M+rt)%et,dt));if(O)for(var xt=0;xt<_.getDimension();xt++)_.setOrdinate(et,xt,_.getOrdinate(0,xt))}}},{key:"isEqual",value:function(t,e){var s=t.size();if(s!==e.size())return!1;for(var c=Math.min(t.getDimension(),e.getDimension()),p=0;p<s;p++)for(var _=0;_<c;_++){var M=t.getOrdinate(p,_),O=e.getOrdinate(p,_);if(t.getOrdinate(p,_)!==e.getOrdinate(p,_)&&(!J.isNaN(M)||!J.isNaN(O)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var t=arguments[0];return a.minCoordinateIndex(t,0,t.size()-1)}if(arguments.length===3){for(var e=arguments[0],s=arguments[2],c=-1,p=null,_=arguments[1];_<=s;_++){var M=e.getCoordinate(_);(p===null||p.compareTo(M)>0)&&(p=M,c=_)}return c}}},{key:"extend",value:function(t,e,s){var c=t.create(s,e.getDimension()),p=e.size();if(a.copy(e,0,c,0,p),p>0)for(var _=p;_<s;_++)a.copy(e,p-1,c,_,1);return c}},{key:"reverse",value:function(t){for(var e=t.size()-1,s=Math.trunc(e/2),c=0;c<=s;c++)a.swap(t,c,e-c)}},{key:"swap",value:function(t,e,s){if(e===s)return null;for(var c=0;c<t.getDimension();c++){var p=t.getOrdinate(e,c);t.setOrdinate(e,c,t.getOrdinate(s,c)),t.setOrdinate(s,c,p)}}},{key:"copy",value:function(t,e,s,c,p){for(var _=0;_<p;_++)a.copyCoord(t,e+_,s,c+_)}},{key:"ensureValidRing",value:function(t,e){var s=e.size();return s===0?e:s<=3?a.createClosedRing(t,e,4):e.getOrdinate(0,Zt.X)===e.getOrdinate(s-1,Zt.X)&&e.getOrdinate(0,Zt.Y)===e.getOrdinate(s-1,Zt.Y)?e:a.createClosedRing(t,e,s+1)}},{key:"indexOf",value:function(t,e){for(var s=0;s<e.size();s++)if(t.x===e.getOrdinate(s,Zt.X)&&t.y===e.getOrdinate(s,Zt.Y))return s;return-1}},{key:"createClosedRing",value:function(t,e,s){var c=t.create(s,e.getDimension()),p=e.size();a.copy(e,0,c,0,p);for(var _=p;_<s;_++)a.copy(e,0,c,_,1);return c}},{key:"minCoordinate",value:function(t){for(var e=null,s=0;s<t.size();s++){var c=t.getCoordinate(s);(e===null||e.compareTo(c)>0)&&(e=c)}return e}}])}(),_t=function(){function a(){u(this,a)}return d(a,null,[{key:"toDimensionSymbol",value:function(t){switch(t){case a.FALSE:return a.SYM_FALSE;case a.TRUE:return a.SYM_TRUE;case a.DONTCARE:return a.SYM_DONTCARE;case a.P:return a.SYM_P;case a.L:return a.SYM_L;case a.A:return a.SYM_A}throw new B("Unknown dimension value: "+t)}},{key:"toDimensionValue",value:function(t){switch(Di.toUpperCase(t)){case a.SYM_FALSE:return a.FALSE;case a.SYM_TRUE:return a.TRUE;case a.SYM_DONTCARE:return a.DONTCARE;case a.SYM_P:return a.P;case a.SYM_L:return a.L;case a.SYM_A:return a.A}throw new B("Unknown dimension symbol: "+t)}}])}();_t.P=0,_t.L=1,_t.A=2,_t.FALSE=-1,_t.TRUE=-2,_t.DONTCARE=-3,_t.SYM_FALSE="F",_t.SYM_TRUE="T",_t.SYM_DONTCARE="*",_t.SYM_P="0",_t.SYM_L="1",_t.SYM_A="2";var Fi=function(){return d(function a(){u(this,a)},[{key:"filter",value:function(a){}}])}(),Kn=function(){return d(function a(){u(this,a)},[{key:"filter",value:function(a,t){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}])}(),mi=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new bt:this._points.expandEnvelope(new bt)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new t(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];if(!this.isEquivalentClass(e))return!1;var c=e;if(this._points.size()!==c._points.size())return!1;for(var p=0;p<this._points.size();p++)if(!this.equal(this._points.getCoordinate(p),c._points.getCoordinate(p),s))return!1;return!0}return D(t,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var e=0;e<Math.trunc(this._points.size()/2);e++){var s=this._points.size()-1-e;if(!this._points.getCoordinate(e).equals(this._points.getCoordinate(s))){if(this._points.getCoordinate(e).compareTo(this._points.getCoordinate(s))>0){var c=this._points.copy();Tn.reverse(c),this._points=c}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?_t.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var e=this._points.copy();return Tn.reverse(e),this.getFactory().createLineString(e)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return vt.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return Po.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var e=arguments[0],s=0,c=0;s<this._points.size()&&c<e._points.size();){var p=this._points.getCoordinate(s).compareTo(e._points.getCoordinate(c));if(p!==0)return p;s++,c++}return s<this._points.size()?1:c<e._points.size()?-1:0}if(arguments.length===2){var _=arguments[0];return arguments[1].compare(this._points,_._points)}}},{key:"apply",value:function(){if(Ot(arguments[0],Ri))for(var e=arguments[0],s=0;s<this._points.size();s++)e.filter(this._points.getCoordinate(s));else if(Ot(arguments[0],Kn)){var c=arguments[0];if(this._points.size()===0)return null;for(var p=0;p<this._points.size()&&(c.filter(this._points,p),!c.isDone());p++);c.isGeometryChanged()&&this.geometryChanged()}else Ot(arguments[0],Fi)?arguments[0].filter(this):Ot(arguments[0],z)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new St}},{key:"isEquivalentClass",value:function(e){return e instanceof t}},{key:"getCoordinateN",value:function(e){return this._points.getCoordinate(e)}},{key:"getGeometryType",value:function(){return vt.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(e){if(e===null&&(e=this.getFactory().getCoordinateSequenceFactory().create([])),e.size()===1)throw new B("Invalid number of points in LineString (found "+e.size()+" - must be 0 or >= 2)");this._points=e}},{key:"isCoordinate",value:function(e){for(var s=0;s<this._points.size();s++)if(this._points.getCoordinate(s).equals(e))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(e){return this.getFactory().createPoint(this._points.getCoordinate(e))}},{key:"interfaces_",get:function(){return[_s]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var e=arguments[0],s=arguments[1];vt.constructor_.call(this,s),this.init(e)}}}}])}(vt),xs=d(function a(){u(this,a)}),Lr=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new bt;var e=new bt;return e.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),e}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new t(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),s))}return D(t,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return _t.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return vt.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var e=arguments[0];return this.getCoordinate().compareTo(e.getCoordinate())}if(arguments.length===2){var s=arguments[0];return arguments[1].compare(this._coordinates,s._coordinates)}}},{key:"apply",value:function(){if(Ot(arguments[0],Ri)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this.getCoordinate())}else if(Ot(arguments[0],Kn)){var s=arguments[0];if(this.isEmpty())return null;s.filter(this._coordinates,0),s.isGeometryChanged()&&this.geometryChanged()}else Ot(arguments[0],Fi)?arguments[0].filter(this):Ot(arguments[0],z)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return vt.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(e){e===null&&(e=this.getFactory().getCoordinateSequenceFactory().create([])),ht.isTrue(e.size()<=1),this._coordinates=e}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[xs]}}],[{key:"constructor_",value:function(){this._coordinates=null;var e=arguments[0],s=arguments[1];vt.constructor_.call(this,s),this.init(e)}}])}(vt),ks=function(){function a(){u(this,a)}return d(a,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var t=arguments[0];return Math.abs(a.ofRingSigned(t))}if(Ot(arguments[0],Zt)){var e=arguments[0];return Math.abs(a.ofRingSigned(e))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,s=t[0].x,c=1;c<t.length-1;c++){var p=t[c].x-s,_=t[c+1].y;e+=p*(t[c-1].y-_)}return e/2}if(Ot(arguments[0],Zt)){var M=arguments[0],O=M.size();if(O<3)return 0;var U=new nt,et=new nt,rt=new nt;M.getCoordinate(0,et),M.getCoordinate(1,rt);var dt=et.x;rt.x-=dt;for(var xt=0,Pt=1;Pt<O-1;Pt++)U.y=et.y,et.x=rt.x,et.y=rt.y,M.getCoordinate(Pt+1,rt),rt.x-=dt,xt+=et.x*(U.y-rt.y);return xt/2}}}])}(),me=function(){return d(function a(){u(this,a)},null,[{key:"sort",value:function(){var a=arguments,t=arguments[0];if(arguments.length===1)t.sort(function(dt,xt){return dt.compareTo(xt)});else if(arguments.length===2)t.sort(function(dt,xt){return a[1].compare(dt,xt)});else if(arguments.length===3){var e=t.slice(arguments[1],arguments[2]);e.sort();var s=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);var c,p=x(s);try{for(p.s();!(c=p.n()).done;){var _=c.value;t.push(_)}}catch(dt){p.e(dt)}finally{p.f()}}else if(arguments.length===4){var M=t.slice(arguments[1],arguments[2]);M.sort(function(dt,xt){return a[3].compare(dt,xt)});var O=t.slice(0,arguments[1]).concat(M,t.slice(arguments[2],t.length));t.splice(0,t.length);var U,et=x(O);try{for(et.s();!(U=et.n()).done;){var rt=U.value;t.push(rt)}}catch(dt){et.e(dt)}finally{et.f()}}}},{key:"asList",value:function(a){var t,e=new It,s=x(a);try{for(s.s();!(t=s.n()).done;){var c=t.value;e.add(c)}}catch(p){s.e(p)}finally{s.f()}return e}},{key:"copyOf",value:function(a,t){return a.slice(0,t)}}])}(),Lt=d(function a(){u(this,a)}),pi=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var e=new Array(this.getNumPoints()).fill(null),s=-1,c=this._shell.getCoordinates(),p=0;p<c.length;p++)e[++s]=c[p];for(var _=0;_<this._holes.length;_++)for(var M=this._holes[_].getCoordinates(),O=0;O<M.length;O++)e[++s]=M[O];return e}},{key:"getArea",value:function(){var e=0;e+=ks.ofRing(this._shell.getCoordinateSequence());for(var s=0;s<this._holes.length;s++)e-=ks.ofRing(this._holes[s].getCoordinateSequence());return e}},{key:"copyInternal",value:function(){for(var e=this._shell.copy(),s=new Array(this._holes.length).fill(null),c=0;c<this._holes.length;c++)s[c]=this._holes[c].copy();return new t(e,s,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var e=this._shell.getCoordinateSequence(),s=this.getEnvelopeInternal(),c=0;c<5;c++){var p=e.getX(c);if(p!==s.getMinX()&&p!==s.getMaxX())return!1;var _=e.getY(c);if(_!==s.getMinY()&&_!==s.getMaxY())return!1}for(var M=e.getX(0),O=e.getY(0),U=1;U<=4;U++){var et=e.getX(U),rt=e.getY(U);if(et!==M==(rt!==O))return!1;M=et,O=rt}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];if(!this.isEquivalentClass(e))return!1;var c=e,p=this._shell,_=c._shell;if(!p.equalsExact(_,s)||this._holes.length!==c._holes.length)return!1;for(var M=0;M<this._holes.length;M++)if(!this._holes[M].equalsExact(c._holes[M],s))return!1;return!0}return D(t,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var e=0;e<this._holes.length;e++)this._holes[e]=this.normalized(this._holes[e],!1);me.sort(this._holes)}else if(arguments.length===2){var s=arguments[0],c=arguments[1];if(s.isEmpty())return null;var p=s.getCoordinateSequence(),_=Tn.minCoordinateIndex(p,0,p.size()-2);Tn.scroll(p,_,!0),Tt.isCCW(p)===c&&Tn.reverse(p)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var e=this.getExteriorRing().reverse(),s=new Array(this.getNumInteriorRing()).fill(null),c=0;c<s.length;c++)s[c]=this.getInteriorRingN(c).reverse();return this.getFactory().createPolygon(e,s)}},{key:"getTypeCode",value:function(){return vt.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var e=0;e+=this._shell.getLength();for(var s=0;s<this._holes.length;s++)e+=this._holes[s].getLength();return e}},{key:"getNumPoints",value:function(){for(var e=this._shell.getNumPoints(),s=0;s<this._holes.length;s++)e+=this._holes[s].getNumPoints();return e}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(e,s){var c=e.copy();return this.normalize(c,s),c}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var e=arguments[0],s=this._shell,c=e._shell;return s.compareToSameClass(c)}if(arguments.length===2){var p=arguments[1],_=arguments[0],M=this._shell,O=_._shell,U=M.compareToSameClass(O,p);if(U!==0)return U;for(var et=this.getNumInteriorRing(),rt=_.getNumInteriorRing(),dt=0;dt<et&&dt<rt;){var xt=this.getInteriorRingN(dt),Pt=_.getInteriorRingN(dt),Mt=xt.compareToSameClass(Pt,p);if(Mt!==0)return Mt;dt++}return dt<et?1:dt<rt?-1:0}}},{key:"apply",value:function(){if(Ot(arguments[0],Ri)){var e=arguments[0];this._shell.apply(e);for(var s=0;s<this._holes.length;s++)this._holes[s].apply(e)}else if(Ot(arguments[0],Kn)){var c=arguments[0];if(this._shell.apply(c),!c.isDone())for(var p=0;p<this._holes.length&&(this._holes[p].apply(c),!c.isDone());p++);c.isGeometryChanged()&&this.geometryChanged()}else if(Ot(arguments[0],Fi))arguments[0].filter(this);else if(Ot(arguments[0],z)){var _=arguments[0];_.filter(this),this._shell.apply(_);for(var M=0;M<this._holes.length;M++)this._holes[M].apply(_)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var e=new Array(this._holes.length+1).fill(null);e[0]=this._shell;for(var s=0;s<this._holes.length;s++)e[s+1]=this._holes[s];return e.length<=1?this.getFactory().createLinearRing(e[0].getCoordinateSequence()):this.getFactory().createMultiLineString(e)}},{key:"getGeometryType",value:function(){return vt.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(e){return this._holes[e]}},{key:"interfaces_",get:function(){return[Lt]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var e=arguments[0],s=arguments[1],c=arguments[2];if(vt.constructor_.call(this,c),e===null&&(e=this.getFactory().createLinearRing()),s===null&&(s=[]),vt.hasNullElements(s))throw new B("holes must not contain null elements");if(e.isEmpty()&&vt.hasNonEmptyElements(s))throw new B("shell is empty but holes are not");this._shell=e,this._holes=s}}])}(vt),ws=function(a){function t(){return u(this,t),o(this,t,arguments)}return I(t,a),d(t)}(we),Mr=function(a){function t(e){var s;return u(this,t),(s=o(this,t)).array=[],e instanceof Rt&&s.addAll(e),s}return I(t,a),d(t,[{key:"contains",value:function(e){var s,c=x(this.array);try{for(c.s();!(s=c.n()).done;)if(s.value.compareTo(e)===0)return!0}catch(p){c.e(p)}finally{c.f()}return!1}},{key:"add",value:function(e){if(this.contains(e))return!1;for(var s=0,c=this.array.length;s<c;s++)if(this.array[s].compareTo(e)===1)return!!this.array.splice(s,0,e);return this.array.push(e),!0}},{key:"addAll",value:function(e){var s,c=x(e);try{for(c.s();!(s=c.n()).done;){var p=s.value;this.add(p)}}catch(_){c.e(_)}finally{c.f()}return!0}},{key:"remove",value:function(){throw new St}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new Es(this.array)}}])}(ws),Es=function(){return d(function a(t){u(this,a),this.array=t,this.position=0},[{key:"next",value:function(){if(this.position===this.array.length)throw new qt;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new St}}])}(),Ee=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"computeEnvelopeInternal",value:function(){for(var e=new bt,s=0;s<this._geometries.length;s++)e.expandToInclude(this._geometries[s].getEnvelopeInternal());return e}},{key:"getGeometryN",value:function(e){return this._geometries[e]}},{key:"getCoordinates",value:function(){for(var e=new Array(this.getNumPoints()).fill(null),s=-1,c=0;c<this._geometries.length;c++)for(var p=this._geometries[c].getCoordinates(),_=0;_<p.length;_++)e[++s]=p[_];return e}},{key:"getArea",value:function(){for(var e=0,s=0;s<this._geometries.length;s++)e+=this._geometries[s].getArea();return e}},{key:"copyInternal",value:function(){for(var e=new Array(this._geometries.length).fill(null),s=0;s<e.length;s++)e[s]=this._geometries[s].copy();return new t(e,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];if(!this.isEquivalentClass(e))return!1;var c=e;if(this._geometries.length!==c._geometries.length)return!1;for(var p=0;p<this._geometries.length;p++)if(!this._geometries[p].equalsExact(c._geometries[p],s))return!1;return!0}return D(t,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var e=0;e<this._geometries.length;e++)this._geometries[e].normalize();me.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var e=_t.FALSE,s=0;s<this._geometries.length;s++)e=Math.max(e,this._geometries[s].getBoundaryDimension());return e}},{key:"reverseInternal",value:function(){for(var e=this._geometries.length,s=new It(e),c=0;c<e;c++)s.add(this._geometries[c].reverse());return this.getFactory().buildGeometry(s)}},{key:"getTypeCode",value:function(){return vt.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var e=_t.FALSE,s=0;s<this._geometries.length;s++)e=Math.max(e,this._geometries[s].getDimension());return e}},{key:"getLength",value:function(){for(var e=0,s=0;s<this._geometries.length;s++)e+=this._geometries[s].getLength();return e}},{key:"getNumPoints",value:function(){for(var e=0,s=0;s<this._geometries.length;s++)e+=this._geometries[s].getNumPoints();return e}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var e=arguments[0],s=new Mr(me.asList(this._geometries)),c=new Mr(me.asList(e._geometries));return this.compare(s,c)}if(arguments.length===2){for(var p=arguments[1],_=arguments[0],M=this.getNumGeometries(),O=_.getNumGeometries(),U=0;U<M&&U<O;){var et=this.getGeometryN(U),rt=_.getGeometryN(U),dt=et.compareToSameClass(rt,p);if(dt!==0)return dt;U++}return U<M?1:U<O?-1:0}}},{key:"apply",value:function(){if(Ot(arguments[0],Ri))for(var e=arguments[0],s=0;s<this._geometries.length;s++)this._geometries[s].apply(e);else if(Ot(arguments[0],Kn)){var c=arguments[0];if(this._geometries.length===0)return null;for(var p=0;p<this._geometries.length&&(this._geometries[p].apply(c),!c.isDone());p++);c.isGeometryChanged()&&this.geometryChanged()}else if(Ot(arguments[0],Fi)){var _=arguments[0];_.filter(this);for(var M=0;M<this._geometries.length;M++)this._geometries[M].apply(_)}else if(Ot(arguments[0],z)){var O=arguments[0];O.filter(this);for(var U=0;U<this._geometries.length;U++)this._geometries[U].apply(O)}}},{key:"getBoundary",value:function(){return vt.checkNotGeometryCollection(this),ht.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return vt.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var e=arguments[0],s=arguments[1];if(vt.constructor_.call(this,s),e===null&&(e=[]),vt.hasNullElements(e))throw new B("geometries must not contain null elements");this._geometries=e}}}}])}(vt),Bi=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"copyInternal",value:function(){for(var e=new Array(this._geometries.length).fill(null),s=0;s<e.length;s++)e[s]=this._geometries[s].copy();return new t(e,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];return!!this.isEquivalentClass(e)&&D(t,"equalsExact",this,1).call(this,e,s)}return D(t,"equalsExact",this,1).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var e=arguments[0];return this._geometries[e].getCoordinate()}return D(t,"getCoordinate",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return _t.FALSE}},{key:"getTypeCode",value:function(){return vt.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return vt.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[xs]}}],[{key:"constructor_",value:function(){var e=arguments[0],s=arguments[1];Ee.constructor_.call(this,e,s)}}])}(Ee),Xe=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"copyInternal",value:function(){return new t(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return _t.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||D(t,"isClosed",this,1).call(this)}},{key:"reverseInternal",value:function(){var e=this._points.copy();return Tn.reverse(e),this.getFactory().createLinearRing(e)}},{key:"getTypeCode",value:function(){return vt.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!D(t,"isClosed",this,1).call(this))throw new B("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new B("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return vt.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var e=arguments[0],s=arguments[1];mi.constructor_.call(this,e,s),this.validateConstruction()}}])}(mi);Xe.MINIMUM_VALID_SIZE=4;var yn=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"setOrdinate",value:function(e,s){switch(e){case t.X:this.x=s;break;case t.Y:this.y=s;break;default:throw new B("Invalid ordinate index: "+e)}}},{key:"getZ",value:function(){return nt.NULL_ORDINATE}},{key:"getOrdinate",value:function(e){switch(e){case t.X:return this.x;case t.Y:return this.y}throw new B("Invalid ordinate index: "+e)}},{key:"setZ",value:function(e){throw new B("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new t(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)nt.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof t){var e=arguments[0];nt.constructor_.call(this,e.x,e.y)}else if(arguments[0]instanceof nt){var s=arguments[0];nt.constructor_.call(this,s.x,s.y)}}else if(arguments.length===2){var c=arguments[0],p=arguments[1];nt.constructor_.call(this,c,p,nt.NULL_ORDINATE)}}}])}(nt);yn.X=0,yn.Y=1,yn.Z=-1,yn.M=-1;var Nn=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(e,s){switch(e){case t.X:this.x=s;break;case t.Y:this.y=s;break;case t.M:this._m=s;break;default:throw new B("Invalid ordinate index: "+e)}}},{key:"setM",value:function(e){this._m=e}},{key:"getZ",value:function(){return nt.NULL_ORDINATE}},{key:"getOrdinate",value:function(e){switch(e){case t.X:return this.x;case t.Y:return this.y;case t.M:return this._m}throw new B("Invalid ordinate index: "+e)}},{key:"setZ",value:function(e){throw new B("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new t(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ(),this._m=e.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)nt.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof t){var e=arguments[0];nt.constructor_.call(this,e.x,e.y),this._m=e._m}else if(arguments[0]instanceof nt){var s=arguments[0];nt.constructor_.call(this,s.x,s.y),this._m=this.getM()}}else if(arguments.length===3){var c=arguments[0],p=arguments[1],_=arguments[2];nt.constructor_.call(this,c,p,nt.NULL_ORDINATE),this._m=_}}}])}(nt);Nn.X=0,Nn.Y=1,Nn.Z=-1,Nn.M=2;var Ir=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(e,s){switch(e){case nt.X:this.x=s;break;case nt.Y:this.y=s;break;case nt.Z:this.z=s;break;case nt.M:this._m=s;break;default:throw new B("Invalid ordinate index: "+e)}}},{key:"setM",value:function(e){this._m=e}},{key:"getOrdinate",value:function(e){switch(e){case nt.X:return this.x;case nt.Y:return this.y;case nt.Z:return this.getZ();case nt.M:return this.getM()}throw new B("Invalid ordinate index: "+e)}},{key:"copy",value:function(){return new t(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ(),this._m=e.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)nt.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof t){var e=arguments[0];nt.constructor_.call(this,e),this._m=e._m}else if(arguments[0]instanceof nt){var s=arguments[0];nt.constructor_.call(this,s),this._m=this.getM()}}else if(arguments.length===4){var c=arguments[0],p=arguments[1],_=arguments[2],M=arguments[3];nt.constructor_.call(this,c,p,_),this._m=M}}}])}(nt),zi=function(){function a(){u(this,a)}return d(a,null,[{key:"measures",value:function(t){return t instanceof yn?0:t instanceof Nn||t instanceof Ir?1:0}},{key:"dimension",value:function(t){return t instanceof yn?2:t instanceof Nn?3:t instanceof Ir?4:3}},{key:"create",value:function(){if(arguments.length===1){var t=arguments[0];return a.create(t,0)}if(arguments.length===2){var e=arguments[0],s=arguments[1];return e===2?new yn:e===3&&s===0?new nt:e===3&&s===1?new Nn:e===4&&s===1?new Ir:new nt}}}])}(),yi=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"getCoordinate",value:function(e){return this.get(e)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&Ot(arguments[0],Rt)){for(var e=arguments[1],s=!1,c=arguments[0].iterator();c.hasNext();)this.add(c.next(),e),s=!0;return s}return D(t,"addAll",this,1).apply(this,arguments)}},{key:"clone",value:function(){for(var e=D(t,"clone",this,1).call(this),s=0;s<this.size();s++)e.add(s,this.get(s).clone());return e}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(t.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(t.coordArrayType);for(var e=this.size(),s=new Array(e).fill(null),c=0;c<e;c++)s[c]=this.get(e-c-1);return s}}},{key:"add",value:function(){if(arguments.length===1){var e=arguments[0];return D(t,"add",this,1).call(this,e)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var s=arguments[0],c=arguments[1];return this.add(s,c,!0),!0}if(arguments[0]instanceof nt&&typeof arguments[1]=="boolean"){var p=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(p))return null;D(t,"add",this,1).call(this,p)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var _=arguments[0],M=arguments[1];return this.add(_,M),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var O=arguments[0],U=arguments[1];if(arguments[2])for(var et=0;et<O.length;et++)this.add(O[et],U);else for(var rt=O.length-1;rt>=0;rt--)this.add(O[rt],U);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof nt){var dt=arguments[0],xt=arguments[1];if(!arguments[2]){var Pt=this.size();if(Pt>0&&(dt>0&&this.get(dt-1).equals2D(xt)||dt<Pt&&this.get(dt).equals2D(xt)))return null}D(t,"add",this,1).call(this,dt,xt)}}else if(arguments.length===4){var Mt=arguments[0],Vt=arguments[1],Ht=arguments[2],te=arguments[3],ie=1;Ht>te&&(ie=-1);for(var de=Ht;de!==te;de+=ie)this.add(Mt[de],Vt);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var e=this.get(0).copy();this.add(e,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.ensureCapacity(s.length),this.add(s,c)}}}}])}(It);yi.coordArrayType=new Array(0).fill(null);var ue=function(){function a(){u(this,a)}return d(a,null,[{key:"isRing",value:function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])}},{key:"ptNotInList",value:function(t,e){for(var s=0;s<t.length;s++){var c=t[s];if(a.indexOf(c,e)<0)return c}return null}},{key:"scroll",value:function(t,e){var s=a.indexOf(e,t);if(s<0)return null;var c=new Array(t.length).fill(null);Fe.arraycopy(t,s,c,0,t.length-s),Fe.arraycopy(t,0,c,t.length-s,s),Fe.arraycopy(c,0,t,0,t.length)}},{key:"equals",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(t===null||e===null||t.length!==e.length)return!1;for(var s=0;s<t.length;s++)if(!t[s].equals(e[s]))return!1;return!0}if(arguments.length===3){var c=arguments[0],p=arguments[1],_=arguments[2];if(c===p)return!0;if(c===null||p===null||c.length!==p.length)return!1;for(var M=0;M<c.length;M++)if(_.compare(c[M],p[M])!==0)return!1;return!0}}},{key:"intersection",value:function(t,e){for(var s=new yi,c=0;c<t.length;c++)e.intersects(t[c])&&s.add(t[c],!0);return s.toCoordinateArray()}},{key:"measures",value:function(t){if(t===null||t.length===0)return 0;var e,s=0,c=x(t);try{for(c.s();!(e=c.n()).done;){var p=e.value;s=Math.max(s,zi.measures(p))}}catch(_){c.e(_)}finally{c.f()}return s}},{key:"hasRepeatedPoints",value:function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(t){return a.hasRepeatedPoints(t)?new yi(t,!1).toCoordinateArray():t}},{key:"reverse",value:function(t){for(var e=t.length-1,s=Math.trunc(e/2),c=0;c<=s;c++){var p=t[c];t[c]=t[e-c],t[e-c]=p}}},{key:"removeNull",value:function(t){for(var e=0,s=0;s<t.length;s++)t[s]!==null&&e++;var c=new Array(e).fill(null);if(e===0)return c;for(var p=0,_=0;_<t.length;_++)t[_]!==null&&(c[p++]=t[_]);return c}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var t=arguments[0],e=new Array(t.length).fill(null),s=0;s<t.length;s++)e[s]=t[s].copy();return e}if(arguments.length===5)for(var c=arguments[0],p=arguments[1],_=arguments[2],M=arguments[3],O=arguments[4],U=0;U<O;U++)_[M+U]=c[p+U].copy()}},{key:"isEqualReversed",value:function(t,e){for(var s=0;s<t.length;s++){var c=t[s],p=e[t.length-s-1];if(c.compareTo(p)!==0)return!1}return!0}},{key:"envelope",value:function(t){for(var e=new bt,s=0;s<t.length;s++)e.expandToInclude(t[s]);return e}},{key:"toCoordinateArray",value:function(t){return t.toArray(a.coordArrayType)}},{key:"dimension",value:function(t){if(t===null||t.length===0)return 3;var e,s=0,c=x(t);try{for(c.s();!(e=c.n()).done;){var p=e.value;s=Math.max(s,zi.dimension(p))}}catch(_){c.e(_)}finally{c.f()}return s}},{key:"atLeastNCoordinatesOrNothing",value:function(t,e){return e.length>=t?e:[]}},{key:"indexOf",value:function(t,e){for(var s=0;s<e.length;s++)if(t.equals(e[s]))return s;return-1}},{key:"increasingDirection",value:function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var s=t.length-1-e,c=t[e].compareTo(t[s]);if(c!==0)return c}return 1}},{key:"compare",value:function(t,e){for(var s=0;s<t.length&&s<e.length;){var c=t[s].compareTo(e[s]);if(c!==0)return c;s++}return s<e.length?-1:s<t.length?1:0}},{key:"minCoordinate",value:function(t){for(var e=null,s=0;s<t.length;s++)(e===null||e.compareTo(t[s])>0)&&(e=t[s]);return e}},{key:"extract",value:function(t,e,s){e=Wn.clamp(e,0,t.length);var c=(s=Wn.clamp(s,-1,t.length))-e+1;s<0&&(c=0),e>=t.length&&(c=0),s<e&&(c=0);var p=new Array(c).fill(null);if(c===0)return p;for(var _=0,M=e;M<=s;M++)p[_++]=t[M];return p}}])}(),Lo=function(){return d(function a(){u(this,a)},[{key:"compare",value:function(a,t){var e=a,s=t;return ue.compare(e,s)}},{key:"interfaces_",get:function(){return[ut]}}])}(),Gi=function(){return d(function a(){u(this,a)},[{key:"compare",value:function(a,t){var e=a,s=t;if(e.length<s.length)return-1;if(e.length>s.length)return 1;if(e.length===0)return 0;var c=ue.compare(e,s);return ue.isEqualReversed(e,s)?0:c}},{key:"OLDcompare",value:function(a,t){var e=a,s=t;if(e.length<s.length)return-1;if(e.length>s.length)return 1;if(e.length===0)return 0;for(var c=ue.increasingDirection(e),p=ue.increasingDirection(s),_=c>0?0:e.length-1,M=p>0?0:e.length-1,O=0;O<e.length;O++){var U=e[_].compareTo(s[M]);if(U!==0)return U;_+=c,M+=p}return 0}},{key:"interfaces_",get:function(){return[ut]}}])}();ue.ForwardComparator=Lo,ue.BidirectionalComparator=Gi,ue.coordArrayType=new Array(0).fill(null);var Hi=function(){return d(function a(t){u(this,a),this.str=t},[{key:"append",value:function(a){this.str+=a}},{key:"setCharAt",value:function(a,t){this.str=this.str.substr(0,a)+t+this.str.substr(a+1)}},{key:"toString",value:function(){return this.str}}])}(),vi=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"getM",value:function(t){return this.hasM()?this._coordinates[t].getM():J.NaN}},{key:"setOrdinate",value:function(t,e,s){switch(e){case Zt.X:this._coordinates[t].x=s;break;case Zt.Y:this._coordinates[t].y=s;break;default:this._coordinates[t].setOrdinate(e,s)}}},{key:"getZ",value:function(t){return this.hasZ()?this._coordinates[t].getZ():J.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(t,e){switch(e){case Zt.X:return this._coordinates[t].x;case Zt.Y:return this._coordinates[t].y;default:return this._coordinates[t].getOrdinate(e)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var t=arguments[0];return this._coordinates[t]}if(arguments.length===2){var e=arguments[0];arguments[1].setCoordinate(this._coordinates[e])}}},{key:"getCoordinateCopy",value:function(t){var e=this.createCoordinate();return e.setCoordinate(this._coordinates[t]),e}},{key:"createCoordinate",value:function(){return zi.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(t){return this._coordinates[t].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}},{key:"copy",value:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++){var s=this.createCoordinate();s.setCoordinate(this._coordinates[e]),t[e]=s}return new a(t,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var t=new Hi(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}},{key:"getY",value:function(t){return this._coordinates[t].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[Zt,S]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];a.constructor_.call(this,t,ue.dimension(t),ue.measures(t))}else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var s=0;s<e;s++)this._coordinates[s]=new nt}else if(Ot(arguments[0],Zt)){var c=arguments[0];if(c===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=c.getDimension(),this._measures=c.getMeasures(),this._coordinates=new Array(c.size()).fill(null);for(var p=0;p<this._coordinates.length;p++)this._coordinates[p]=c.getCoordinateCopy(p)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var _=arguments[0],M=arguments[1];a.constructor_.call(this,_,M,ue.measures(_))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var O=arguments[0],U=arguments[1];this._coordinates=new Array(O).fill(null),this._dimension=U;for(var et=0;et<O;et++)this._coordinates[et]=zi.create(U)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var rt=arguments[0],dt=arguments[1],xt=arguments[2];this._dimension=dt,this._measures=xt,this._coordinates=rt===null?new Array(0).fill(null):rt}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var Pt=arguments[0],Mt=arguments[1],Vt=arguments[2];this._coordinates=new Array(Pt).fill(null),this._dimension=Mt,this._measures=Vt;for(var Ht=0;Ht<Pt;Ht++)this._coordinates[Ht]=this.createCoordinate()}}}}])}(),Sr=function(){function a(){u(this,a)}return d(a,[{key:"readResolve",value:function(){return a.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array)return new vi(arguments[0]);if(Ot(arguments[0],Zt))return new vi(arguments[0])}else{if(arguments.length===2){var t=arguments[1];return t>3&&(t=3),t<2&&(t=2),new vi(arguments[0],t)}if(arguments.length===3){var e=arguments[2],s=arguments[1]-e;return e>1&&(e=1),s>3&&(s=3),s<2&&(s=2),new vi(arguments[0],s+e,e)}}}},{key:"interfaces_",get:function(){return[Pr,S]}}],[{key:"instance",value:function(){return a.instanceObject}}])}();Sr.instanceObject=new Sr;var Cr=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"copyInternal",value:function(){for(var e=new Array(this._geometries.length).fill(null),s=0;s<e.length;s++)e[s]=this._geometries[s].copy();return new t(e,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];return!!this.isEquivalentClass(e)&&D(t,"equalsExact",this,1).call(this,e,s)}return D(t,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return vt.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var e=new It,s=0;s<this._geometries.length;s++)for(var c=this._geometries[s].getBoundary(),p=0;p<c.getNumGeometries();p++)e.add(c.getGeometryN(p));var _=new Array(e.size()).fill(null);return this.getFactory().createMultiLineString(e.toArray(_))}},{key:"getGeometryType",value:function(){return vt.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Lt]}}],[{key:"constructor_",value:function(){var e=arguments[0],s=arguments[1];Ee.constructor_.call(this,e,s)}}])}(Ee),Ps=function(){return d(function a(){u(this,a)},[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}])}(),br=function(a){function t(){var e;return u(this,t),(e=o(this,t)).map=new Map,e}return I(t,a),d(t,[{key:"get",value:function(e){return this.map.get(e)||null}},{key:"put",value:function(e,s){return this.map.set(e,s),s}},{key:"values",value:function(){for(var e=new It,s=this.map.values(),c=s.next();!c.done;)e.add(c.value),c=s.next();return e}},{key:"entrySet",value:function(){var e=new fe;return this.map.entries().forEach(function(s){return e.add(s)}),e}},{key:"size",value:function(){return this.map.size()}}])}(Ps),Pe=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"equals",value:function(t){if(!(t instanceof a))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale}},{key:"compareTo",value:function(t){var e=t,s=this.getMaximumSignificantDigits(),c=e.getMaximumSignificantDigits();return Ye.compare(s,c)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===a.FLOATING||this._modelType===a.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var t="UNKNOWN";return this._modelType===a.FLOATING?t="Floating":this._modelType===a.FLOATING_SINGLE?t="Floating-Single":this._modelType===a.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var t=arguments[0];return J.isNaN(t)||this._modelType===a.FLOATING_SINGLE?t:this._modelType===a.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof nt){var e=arguments[0];if(this._modelType===a.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}}},{key:"getMaximumSignificantDigits",value:function(){var t=16;return this._modelType===a.FLOATING?t=16:this._modelType===a.FLOATING_SINGLE?t=6:this._modelType===a.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}},{key:"setScale",value:function(t){this._scale=Math.abs(t)}},{key:"interfaces_",get:function(){return[S,$]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=a.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof On){var t=arguments[0];this._modelType=t,t===a.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var e=arguments[0];this._modelType=a.FIXED,this.setScale(e)}else if(arguments[0]instanceof a){var s=arguments[0];this._modelType=s._modelType,this._scale=s._scale}}}},{key:"mostPrecise",value:function(t,e){return t.compareTo(e)>=0?t:e}}])}(),On=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"readResolve",value:function(){return a.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[S]}}],[{key:"constructor_",value:function(){this._name=null;var t=arguments[0];this._name=t,a.nameToTypeMap.put(t,this)}}])}();On.nameToTypeMap=new br,Pe.Type=On,Pe.FIXED=new On("FIXED"),Pe.FLOATING=new On("FLOATING"),Pe.FLOATING_SINGLE=new On("FLOATING SINGLE"),Pe.maximumPreciseValue=9007199254740992;var qi=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"copyInternal",value:function(){for(var e=new Array(this._geometries.length).fill(null),s=0;s<e.length;s++)e[s]=this._geometries[s].copy();return new t(e,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof vt){var e=arguments[0],s=arguments[1];return!!this.isEquivalentClass(e)&&D(t,"equalsExact",this,1).call(this,e,s)}return D(t,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?_t.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return vt.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new St}},{key:"getGeometryType",value:function(){return vt.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[_s]}}],[{key:"constructor_",value:function(){var e=arguments[0],s=arguments[1];Ee.constructor_.call(this,e,s)}}])}(Ee),We=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"createEmpty",value:function(t){switch(t){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new B("Invalid dimension: "+t)}}},{key:"toGeometry",value:function(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new nt(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new nt(t.getMinX(),t.getMinY()),new nt(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new nt(t.getMinX(),t.getMinY()),new nt(t.getMinX(),t.getMaxY()),new nt(t.getMaxX(),t.getMaxY()),new nt(t.getMaxX(),t.getMinY()),new nt(t.getMinX(),t.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLineString(t!==null?this.getCoordinateSequenceFactory().create(t):null)}if(Ot(arguments[0],Zt))return new mi(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return arguments.length===0?new qi(null,this):arguments.length===1?new qi(arguments[0],this):void 0}},{key:"buildGeometry",value:function(t){for(var e=null,s=!1,c=!1,p=t.iterator();p.hasNext();){var _=p.next(),M=_.getTypeCode();e===null&&(e=M),M!==e&&(s=!0),_ instanceof Ee&&(c=!0)}if(e===null)return this.createGeometryCollection();if(s||c)return this.createGeometryCollection(a.toGeometryArray(t));var O=t.iterator().next();if(t.size()>1){if(O instanceof pi)return this.createMultiPolygon(a.toPolygonArray(t));if(O instanceof mi)return this.createMultiLineString(a.toLineStringArray(t));if(O instanceof Lr)return this.createMultiPoint(a.toPointArray(t));ht.shouldNeverReachHere("Unhandled geometry type: "+O.getGeometryType())}return O}},{key:"createMultiPointFromCoords",value:function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof nt){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}if(Ot(arguments[0],Zt))return new Lr(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(Ot(arguments[0],Zt)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Xe){var s=arguments[0];return this.createPolygon(s,null)}}else if(arguments.length===2)return new pi(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return arguments.length===0?new Ee(null,this):arguments.length===1?new Ee(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}if(Ot(arguments[0],Zt))return new Xe(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return arguments.length===0?new Cr(null,this):arguments.length===1?new Cr(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Bi(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new Bi(arguments[0],this);if(Ot(arguments[0],Zt)){var t=arguments[0];if(t===null)return this.createMultiPoint(new Array(0).fill(null));for(var e=new Array(t.size()).fill(null),s=0;s<t.size();s++){var c=this.getCoordinateSequenceFactory().create(1,t.getDimension(),t.getMeasures());Tn.copy(t,s,c,0,1),e[s]=this.createPoint(c)}return this.createMultiPoint(e)}}}},{key:"interfaces_",get:function(){return[S]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)a.constructor_.call(this,new Pe,0);else if(arguments.length===1){if(Ot(arguments[0],Pr)){var t=arguments[0];a.constructor_.call(this,new Pe,0,t)}else if(arguments[0]instanceof Pe){var e=arguments[0];a.constructor_.call(this,e,0,a.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];a.constructor_.call(this,s,c,a.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var p=arguments[0],_=arguments[1],M=arguments[2];this._precisionModel=p,this._coordinateSequenceFactory=M,this._SRID=_}}},{key:"toMultiPolygonArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toGeometryArray",value:function(t){if(t===null)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return Sr.instance()}},{key:"toMultiLineStringArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toLineStringArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toMultiPointArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toLinearRingArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toPointArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toPolygonArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"createPointFromInternalCoord",value:function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}}])}(),Yt="XY",ne="XYZ",Ui="XYM",$n="XYZM",An={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Zi="EMPTY",Dt=1,Jt=2,Ke=3,_i=4,ge=5,Mo=6;for(var Yi in An)An[Yi].toUpperCase();var Dn=function(){return d(function a(t){u(this,a),this.wkt=t,this.index_=-1},[{key:"isAlpha_",value:function(a){return a>="a"&&a<="z"||a>="A"&&a<="Z"}},{key:"isNumeric_",value:function(a,t){return a>="0"&&a<="9"||a=="."&&!(t!==void 0&&t)}},{key:"isWhiteSpace_",value:function(a){return a==" "||a=="	"||a=="\r"||a==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var a,t=this.nextChar_(),e=this.index_,s=t;if(t=="(")a=Jt;else if(t==",")a=ge;else if(t==")")a=Ke;else if(this.isNumeric_(t)||t=="-")a=_i,s=this.readNumber_();else if(this.isAlpha_(t))a=Dt,s=this.readText_();else{if(this.isWhiteSpace_(t))return this.nextToken();if(t!=="")throw new Error("Unexpected character: "+t);a=Mo}return{position:e,value:s,type:a}}},{key:"readNumber_",value:function(){var a,t=this.index_,e=!1,s=!1;do a=="."?e=!0:a!="e"&&a!="E"||(s=!0),a=this.nextChar_();while(this.isNumeric_(a,e)||!s&&(a=="e"||a=="E")||s&&(a=="-"||a=="+"));return parseFloat(this.wkt.substring(t,this.index_--))}},{key:"readText_",value:function(){var a,t=this.index_;do a=this.nextChar_();while(this.isAlpha_(a));return this.wkt.substring(t,this.index_--).toUpperCase()}}])}(),le=function(){return d(function a(t,e){u(this,a),this.lexer_=t,this.token_,this.layout_=Yt,this.factory=e},[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(a){return this.token_.type==a}},{key:"match",value:function(a){var t=this.isTokenType(a);return t&&this.consume_(),t}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var a=Yt,t=this.token_;if(this.isTokenType(Dt)){var e=t.value;e==="Z"?a=ne:e==="M"?a=Ui:e==="ZM"&&(a=$n),a!==Yt&&this.consume_()}return a}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(Jt)){var a=[];do a.push(this.parseGeometry_());while(this.match(ge));if(this.match(Ke))return a}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(Jt)){var a=this.parsePoint_();if(this.match(Ke))return a}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(Jt)){var a=this.parsePointList_();if(this.match(Ke))return a}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(Jt)){var a=this.parseLineStringTextList_();if(this.match(Ke))return a}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var a;if(this.match(Jt)){if(a=this.token_.type==Jt?this.parsePointTextList_():this.parsePointList_(),this.match(Ke))return a}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(Jt)){var a=this.parseLineStringTextList_();if(this.match(Ke))return a}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(Jt)){var a=this.parsePolygonTextList_();if(this.match(Ke))return a}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var a=[],t=this.layout_.length,e=0;e<t;++e){var s=this.token_;if(!this.match(_i))break;a.push(s.value)}if(a.length==t)return a;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var a=[this.parsePoint_()];this.match(ge);)a.push(this.parsePoint_());return a}},{key:"parsePointTextList_",value:function(){for(var a=[this.parsePointText_()];this.match(ge);)a.push(this.parsePointText_());return a}},{key:"parseLineStringTextList_",value:function(){for(var a=[this.parseLineStringText_()];this.match(ge);)a.push(this.parseLineStringText_());return a}},{key:"parsePolygonTextList_",value:function(){for(var a=[this.parsePolygonText_()];this.match(ge);)a.push(this.parsePolygonText_());return a}},{key:"isEmptyGeometry_",value:function(){var a=this.isTokenType(Dt)&&this.token_.value==Zi;return a&&this.consume_(),a}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var a=this.factory,t=function(Mt){return f(nt,Z(Mt))},e=function(Mt){var Vt=Mt.map(function(Ht){return a.createLinearRing(Ht.map(t))});return Vt.length>1?a.createPolygon(Vt[0],Vt.slice(1)):a.createPolygon(Vt[0])},s=this.token_;if(this.match(Dt)){var c=s.value;if(this.layout_=this.parseGeometryLayout_(),c=="GEOMETRYCOLLECTION"){var p=this.parseGeometryCollectionText_();return a.createGeometryCollection(p)}switch(c){case"POINT":var _=this.parsePointText_();return _?a.createPoint(f(nt,Z(_))):a.createPoint();case"LINESTRING":var M=this.parseLineStringText_().map(t);return a.createLineString(M);case"LINEARRING":var O=this.parseLineStringText_().map(t);return a.createLinearRing(O);case"POLYGON":var U=this.parsePolygonText_();return U&&U.length!==0?e(U):a.createPolygon();case"MULTIPOINT":var et=this.parseMultiPointText_();if(!et||et.length===0)return a.createMultiPoint();var rt=et.map(t).map(function(Mt){return a.createPoint(Mt)});return a.createMultiPoint(rt);case"MULTILINESTRING":var dt=this.parseMultiLineStringText_().map(function(Mt){return a.createLineString(Mt.map(t))});return a.createMultiLineString(dt);case"MULTIPOLYGON":var xt=this.parseMultiPolygonText_();if(!xt||xt.length===0)return a.createMultiPolygon();var Pt=xt.map(e);return a.createMultiPolygon(Pt);default:throw new Error("Invalid geometry type: "+c)}}throw new Error(this.formatErrorMessage_())}}])}();function vn(a){if(a.isEmpty())return"";var t=a.getCoordinate(),e=[t.x,t.y];return t.z===void 0||Number.isNaN(t.z)||e.push(t.z),t.m===void 0||Number.isNaN(t.m)||e.push(t.m),e.join(" ")}function ln(a){for(var t=a.getCoordinates().map(function(p){var _=[p.x,p.y];return p.z===void 0||Number.isNaN(p.z)||_.push(p.z),p.m===void 0||Number.isNaN(p.m)||_.push(p.m),_}),e=[],s=0,c=t.length;s<c;++s)e.push(t[s].join(" "));return e.join(", ")}function Jn(a){var t=[];t.push("("+ln(a.getExteriorRing())+")");for(var e=0,s=a.getNumInteriorRing();e<s;++e)t.push("("+ln(a.getInteriorRingN(e))+")");return t.join(", ")}var Tr={Point:vn,LineString:ln,LinearRing:ln,Polygon:Jn,MultiPoint:function(a){for(var t=[],e=0,s=a.getNumGeometries();e<s;++e)t.push("("+vn(a.getGeometryN(e))+")");return t.join(", ")},MultiLineString:function(a){for(var t=[],e=0,s=a.getNumGeometries();e<s;++e)t.push("("+ln(a.getGeometryN(e))+")");return t.join(", ")},MultiPolygon:function(a){for(var t=[],e=0,s=a.getNumGeometries();e<s;++e)t.push("("+Jn(a.getGeometryN(e))+")");return t.join(", ")},GeometryCollection:function(a){for(var t=[],e=0,s=a.getNumGeometries();e<s;++e)t.push(jn(a.getGeometryN(e)));return t.join(", ")}};function jn(a){var t=a.getGeometryType(),e=Tr[t];t=t.toUpperCase();var s=function(c){var p="";if(c.isEmpty())return p;var _=c.getCoordinate();return _.z===void 0||Number.isNaN(_.z)||(p+="Z"),_.m===void 0||Number.isNaN(_.m)||(p+="M"),p}(a);return s.length>0&&(t+=" "+s),a.isEmpty()?t+" "+Zi:t+" ("+e(a)+")"}var Nr=function(){return d(function a(t){u(this,a),this.geometryFactory=t||new We,this.precisionModel=this.geometryFactory.getPrecisionModel()},[{key:"read",value:function(a){var t=new Dn(a);return new le(t,this.geometryFactory).parse()}},{key:"write",value:function(a){return jn(a)}}])}(),xi=function(){return d(function a(t){u(this,a),this.parser=new Nr(t)},[{key:"write",value:function(a){return this.parser.write(a)}}],[{key:"toLineString",value:function(a,t){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+a.x+" "+a.y+", "+t.x+" "+t.y+" )"}}])}(),jt=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"getIndexAlongSegment",value:function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}},{key:"getTopologySummary",value:function(){var t=new Hi;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}},{key:"computeIntersection",value:function(t,e,s,c){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=s,this._inputLines[1][1]=c,this._result=this.computeIntersect(t,e,s,c)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(t){this._precisionModel=t}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}}},{key:"getIntersection",value:function(t){return this._intPt[t]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==a.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(t,e){return a.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])}},{key:"isCollinear",value:function(){return this._result===a.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return xi.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+xi.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(t,e){return this._inputLines[t][e]}},{key:"isIntersection",value:function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new nt,this._intPt[1]=new nt,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(t,e,s){var c=Math.abs(s.x-e.x),p=Math.abs(s.y-e.y),_=-1;if(t.equals(e))_=0;else if(t.equals(s))_=c>p?c:p;else{var M=Math.abs(t.x-e.x),O=Math.abs(t.y-e.y);(_=c>p?M:O)!==0||t.equals(e)||(_=Math.max(M,O))}return ht.isTrue(!(_===0&&!t.equals(e)),"Bad distance calculation"),_}},{key:"nonRobustComputeEdgeDistance",value:function(t,e,s){var c=t.x-e.x,p=t.y-e.y,_=Math.sqrt(c*c+p*p);return ht.isTrue(!(_===0&&!t.equals(e)),"Invalid distance calculation"),_}}])}();jt.DONT_INTERSECT=0,jt.DO_INTERSECT=1,jt.COLLINEAR=2,jt.NO_INTERSECTION=0,jt.POINT_INTERSECTION=1,jt.COLLINEAR_INTERSECTION=2;var hn=function(a){function t(){return u(this,t),o(this,t)}return I(t,a),d(t,[{key:"isInSegmentEnvelopes",value:function(e){var s=new bt(this._inputLines[0][0],this._inputLines[0][1]),c=new bt(this._inputLines[1][0],this._inputLines[1][1]);return s.contains(e)&&c.contains(e)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return D(t,"computeIntersection",this,1).apply(this,arguments);var e=arguments[0],s=arguments[1],c=arguments[2];if(this._isProper=!1,bt.intersects(s,c,e)&&Tt.index(s,c,e)===0&&Tt.index(c,s,e)===0)return this._isProper=!0,(e.equals(s)||e.equals(c))&&(this._isProper=!1),this._result=jt.POINT_INTERSECTION,null;this._result=jt.NO_INTERSECTION}},{key:"intersection",value:function(e,s,c,p){var _=this.intersectionSafe(e,s,c,p);return this.isInSegmentEnvelopes(_)||(_=new nt(t.nearestEndpoint(e,s,c,p))),this._precisionModel!==null&&this._precisionModel.makePrecise(_),_}},{key:"checkDD",value:function(e,s,c,p,_){var M=kr.intersection(e,s,c,p),O=this.isInSegmentEnvelopes(M);Fe.out.println("DD in env = "+O+"  --------------------- "+M),_.distance(M)>1e-4&&Fe.out.println("Distance = "+_.distance(M))}},{key:"intersectionSafe",value:function(e,s,c,p){var _=Er.intersection(e,s,c,p);return _===null&&(_=t.nearestEndpoint(e,s,c,p)),_}},{key:"computeCollinearIntersection",value:function(e,s,c,p){var _=bt.intersects(e,s,c),M=bt.intersects(e,s,p),O=bt.intersects(c,p,e),U=bt.intersects(c,p,s);return _&&M?(this._intPt[0]=c,this._intPt[1]=p,jt.COLLINEAR_INTERSECTION):O&&U?(this._intPt[0]=e,this._intPt[1]=s,jt.COLLINEAR_INTERSECTION):_&&O?(this._intPt[0]=c,this._intPt[1]=e,!c.equals(e)||M||U?jt.COLLINEAR_INTERSECTION:jt.POINT_INTERSECTION):_&&U?(this._intPt[0]=c,this._intPt[1]=s,!c.equals(s)||M||O?jt.COLLINEAR_INTERSECTION:jt.POINT_INTERSECTION):M&&O?(this._intPt[0]=p,this._intPt[1]=e,!p.equals(e)||_||U?jt.COLLINEAR_INTERSECTION:jt.POINT_INTERSECTION):M&&U?(this._intPt[0]=p,this._intPt[1]=s,!p.equals(s)||_||O?jt.COLLINEAR_INTERSECTION:jt.POINT_INTERSECTION):jt.NO_INTERSECTION}},{key:"computeIntersect",value:function(e,s,c,p){if(this._isProper=!1,!bt.intersects(e,s,c,p))return jt.NO_INTERSECTION;var _=Tt.index(e,s,c),M=Tt.index(e,s,p);if(_>0&&M>0||_<0&&M<0)return jt.NO_INTERSECTION;var O=Tt.index(c,p,e),U=Tt.index(c,p,s);return O>0&&U>0||O<0&&U<0?jt.NO_INTERSECTION:_===0&&M===0&&O===0&&U===0?this.computeCollinearIntersection(e,s,c,p):(_===0||M===0||O===0||U===0?(this._isProper=!1,e.equals2D(c)||e.equals2D(p)?this._intPt[0]=e:s.equals2D(c)||s.equals2D(p)?this._intPt[0]=s:_===0?this._intPt[0]=new nt(c):M===0?this._intPt[0]=new nt(p):O===0?this._intPt[0]=new nt(e):U===0&&(this._intPt[0]=new nt(s))):(this._isProper=!0,this._intPt[0]=this.intersection(e,s,c,p)),jt.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(e,s,c,p){var _=e,M=He.pointToSegment(e,c,p),O=He.pointToSegment(s,c,p);return O<M&&(M=O,_=s),(O=He.pointToSegment(c,e,s))<M&&(M=O,_=c),(O=He.pointToSegment(p,e,s))<M&&(M=O,_=p),_}}])}(jt),Or=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"countSegment",value:function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var s=t.x,c=e.x;return s>c&&(s=e.x,c=t.x),this._p.x>=s&&this._p.x<=c&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var p=Tt.index(t,e,this._p);if(p===Tt.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(p=-p),p===Tt.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==K.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?K.BOUNDARY:this._crossingCount%2==1?K.INTERIOR:K.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof nt&&Ot(arguments[1],Zt)){for(var t=arguments[1],e=new a(arguments[0]),s=new nt,c=new nt,p=1;p<t.size();p++)if(t.getCoordinate(p,s),t.getCoordinate(p-1,c),e.countSegment(s,c),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof nt&&arguments[1]instanceof Array){for(var _=arguments[1],M=new a(arguments[0]),O=1;O<_.length;O++){var U=_[O],et=_[O-1];if(M.countSegment(U,et),M.isOnSegment())return M.getLocation()}return M.getLocation()}}}])}(),Qn=function(){function a(){u(this,a)}return d(a,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof nt&&Ot(arguments[1],Zt)){for(var t=arguments[0],e=arguments[1],s=new hn,c=new nt,p=new nt,_=e.size(),M=1;M<_;M++)if(e.getCoordinate(M-1,c),e.getCoordinate(M,p),s.computeIntersection(t,c,p),s.hasIntersection())return!0;return!1}if(arguments[0]instanceof nt&&arguments[1]instanceof Array){for(var O=arguments[0],U=arguments[1],et=new hn,rt=1;rt<U.length;rt++){var dt=U[rt-1],xt=U[rt];if(et.computeIntersection(O,dt,xt),et.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(t,e){return Or.locatePointInRing(t,e)}},{key:"isInRing",value:function(t,e){return a.locateInRing(t,e)!==K.EXTERIOR}}])}(),Ne=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"setAllLocations",value:function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t}},{key:"isNull",value:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==K.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(t){for(var e=0;e<this.location.length;e++)this.location[e]===K.NONE&&(this.location[e]=t)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[yt.ON]=this.location[yt.ON],e[yt.LEFT]=K.NONE,e[yt.RIGHT]=K.NONE,this.location=e}for(var s=0;s<this.location.length;s++)this.location[s]===K.NONE&&s<t.location.length&&(this.location[s]=t.location[s])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var t=this.location[yt.LEFT];this.location[yt.LEFT]=this.location[yt.RIGHT],this.location[yt.RIGHT]=t}},{key:"toString",value:function(){var t=new pn;return this.location.length>1&&t.append(K.toLocationSymbol(this.location[yt.LEFT])),t.append(K.toLocationSymbol(this.location[yt.ON])),this.location.length>1&&t.append(K.toLocationSymbol(this.location[yt.RIGHT])),t.toString()}},{key:"setLocations",value:function(t,e,s){this.location[yt.ON]=t,this.location[yt.LEFT]=e,this.location[yt.RIGHT]=s}},{key:"get",value:function(t){return t<this.location.length?this.location[t]:K.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===K.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var t=arguments[0];this.setLocation(yt.ON,t)}else if(arguments.length===2){var e=arguments[0],s=arguments[1];this.location[e]=s}}},{key:"init",value:function(t){this.location=new Array(t).fill(null),this.setAllLocations(K.NONE)}},{key:"isEqualOnSide",value:function(t,e){return this.location[e]===t.location[e]}},{key:"allPositionsEqual",value:function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.init(1),this.location[yt.ON]=e}else if(arguments[0]instanceof a){var s=arguments[0];if(this.init(s.location.length),s!==null)for(var c=0;c<this.location.length;c++)this.location[c]=s.location[c]}}else if(arguments.length===3){var p=arguments[0],_=arguments[1],M=arguments[2];this.init(3),this.location[yt.ON]=p,this.location[yt.LEFT]=_,this.location[yt.RIGHT]=M}}}])}(),Se=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"getGeometryCount",value:function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}},{key:"setAllLocations",value:function(t,e){this.elt[t].setAllLocations(e)}},{key:"isNull",value:function(t){return this.elt[t].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var e=arguments[0],s=arguments[1];this.elt[e].setAllLocationsIfNull(s)}}},{key:"isLine",value:function(t){return this.elt[t].isLine()}},{key:"merge",value:function(t){for(var e=0;e<2;e++)this.elt[e]===null&&t.elt[e]!==null?this.elt[e]=new Ne(t.elt[e]):this.elt[e].merge(t.elt[e])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(yt.ON)}if(arguments.length===2){var e=arguments[0],s=arguments[1];return this.elt[e].get(s)}}},{key:"toString",value:function(){var t=new pn;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}}},{key:"isAnyNull",value:function(t){return this.elt[t].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(yt.ON,e)}else if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2];this.elt[s].setLocation(c,p)}}},{key:"isEqualOnSide",value:function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}},{key:"allPositionsEqual",value:function(t,e){return this.elt[t].allPositionsEqual(e)}},{key:"toLine",value:function(t){this.elt[t].isArea()&&(this.elt[t]=new Ne(this.elt[t].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new Ne(t),this.elt[1]=new Ne(t)}else if(arguments[0]instanceof a){var e=arguments[0];this.elt[0]=new Ne(e.elt[0]),this.elt[1]=new Ne(e.elt[1])}}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.elt[0]=new Ne(K.NONE),this.elt[1]=new Ne(K.NONE),this.elt[s].setLocation(c)}else if(arguments.length===3){var p=arguments[0],_=arguments[1],M=arguments[2];this.elt[0]=new Ne(p,_,M),this.elt[1]=new Ne(p,_,M)}else if(arguments.length===4){var O=arguments[0],U=arguments[1],et=arguments[2],rt=arguments[3];this.elt[0]=new Ne(K.NONE,K.NONE,K.NONE),this.elt[1]=new Ne(K.NONE,K.NONE,K.NONE),this.elt[O].setLocations(U,et,rt)}}},{key:"toLineLabel",value:function(t){for(var e=new a(K.NONE),s=0;s<2;s++)e.setLocation(s,t.getLocation(s));return e}}])}(),Vi=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var a=new Array(this._pts.size()).fill(null),t=0;t<this._pts.size();t++)a[t]=this._pts.get(t);this._ring=this._geometryFactory.createLinearRing(a),this._isHole=Tt.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(a){this._startDe=a;var t=a,e=!0;do{if(t===null)throw new Ve("Found null DirectedEdge");if(t.getEdgeRing()===this)throw new Ve("Directed Edge visited twice during ring-building at "+t.getCoordinate());this._edges.add(t);var s=t.getLabel();ht.isTrue(s.isArea()),this.mergeLabel(s),this.addPoints(t.getEdge(),t.isForward(),e),e=!1,this.setEdgeRing(t,this),t=this.getNext(t)}while(t!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(a){return this._pts.get(a)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var a=this._startDe;do{var t=a.getNode().getEdges().getOutgoingDegree(this);t>this._maxNodeDegree&&(this._maxNodeDegree=t),a=this.getNext(a)}while(a!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(a,t,e){var s=a.getCoordinates();if(t){var c=1;e&&(c=0);for(var p=c;p<s.length;p++)this._pts.add(s[p])}else{var _=s.length-2;e&&(_=s.length-1);for(var M=_;M>=0;M--)this._pts.add(s[M])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var a=this._startDe;do a.getEdge().setInResult(!0),a=a.getNext();while(a!==this._startDe)}},{key:"containsPoint",value:function(a){var t=this.getLinearRing();if(!t.getEnvelopeInternal().contains(a)||!Qn.isInRing(a,t.getCoordinates()))return!1;for(var e=this._holes.iterator();e.hasNext();)if(e.next().containsPoint(a))return!1;return!0}},{key:"addHole",value:function(a){this._holes.add(a)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var a=arguments[0];this.mergeLabel(a,0),this.mergeLabel(a,1)}else if(arguments.length===2){var t=arguments[1],e=arguments[0].getLocation(t,yt.RIGHT);if(e===K.NONE)return null;if(this._label.getLocation(t)===K.NONE)return this._label.setLocation(t,e),null}}},{key:"setShell",value:function(a){this._shell=a,a!==null&&a.addHole(this)}},{key:"toPolygon",value:function(a){for(var t=new Array(this._holes.size()).fill(null),e=0;e<this._holes.size();e++)t[e]=this._holes.get(e).getLinearRing();return a.createPolygon(this.getLinearRing(),t)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new It,this._pts=new It,this._label=new Se(K.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new It,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var a=arguments[0],t=arguments[1];this._geometryFactory=t,this.computePoints(a),this.computeRing()}}}}])}(),Ft=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"setEdgeRing",value:function(e,s){e.setMinEdgeRing(s)}},{key:"getNext",value:function(e){return e.getNextMin()}}],[{key:"constructor_",value:function(){var e=arguments[0],s=arguments[1];Vi.constructor_.call(this,e,s)}}])}(Vi),$e=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"buildMinimalRings",value:function(){var e=new It,s=this._startDe;do{if(s.getMinEdgeRing()===null){var c=new Ft(s,this._geometryFactory);e.add(c)}s=s.getNext()}while(s!==this._startDe);return e}},{key:"setEdgeRing",value:function(e,s){e.setEdgeRing(s)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var e=this._startDe;do e.getNode().getEdges().linkMinimalDirectedEdges(this),e=e.getNext();while(e!==this._startDe)}},{key:"getNext",value:function(e){return e.getNext()}}],[{key:"constructor_",value:function(){var e=arguments[0],s=arguments[1];Vi.constructor_.call(this,e,s)}}])}(Vi),Qt=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"setVisited",value:function(a){this._isVisited=a}},{key:"setInResult",value:function(a){this._isInResult=a}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(a){this._label=a}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(a){this._isCovered=a,this._isCoveredSet=!0}},{key:"updateIM",value:function(a){ht.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(a)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var a=arguments[0];this._label=a}}}}])}(),ki=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"isIncidentEdgeInResult",value:function(){for(var e=this.getEdges().getEdges().iterator();e.hasNext();)if(e.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(e){e.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(e){}},{key:"computeMergedLocation",value:function(e,s){var c=K.NONE;if(c=this._label.getLocation(s),!e.isNull(s)){var p=e.getLocation(s);c!==K.BOUNDARY&&(c=p)}return c}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return D(t,"setLabel",this,1).apply(this,arguments);var e=arguments[0],s=arguments[1];this._label===null?this._label=new Se(e,s):this._label.setLocation(e,s)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof t){var e=arguments[0];this.mergeLabel(e._label)}else if(arguments[0]instanceof Se)for(var s=arguments[0],c=0;c<2;c++){var p=this.computeMergedLocation(s,c);this._label.getLocation(c)===K.NONE&&this._label.setLocation(c,p)}}},{key:"add",value:function(e){this._edges.insert(e),e.setNode(this)}},{key:"setLabelBoundary",value:function(e){if(this._label===null)return null;var s=K.NONE;this._label!==null&&(s=this._label.getLocation(e));var c=null;switch(s){case K.BOUNDARY:c=K.INTERIOR;break;case K.INTERIOR:default:c=K.BOUNDARY}this._label.setLocation(e,c)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var e=arguments[0],s=arguments[1];this._coord=e,this._edges=s,this._label=new Se(0,K.NONE)}}])}(Qt),Ar=function(a){function t(){return u(this,t),o(this,t,arguments)}return I(t,a),d(t)}(Ps);function Xi(a){return a==null?0:a.color}function Xt(a){return a==null?null:a.parent}function pe(a,t){a!==null&&(a.color=t)}function wi(a){return a==null?null:a.left}function ti(a){return a==null?null:a.right}var re=function(a){function t(){var e;return u(this,t),(e=o(this,t)).root_=null,e.size_=0,e}return I(t,a),d(t,[{key:"get",value:function(e){for(var s=this.root_;s!==null;){var c=e.compareTo(s.key);if(c<0)s=s.left;else{if(!(c>0))return s.value;s=s.right}}return null}},{key:"put",value:function(e,s){if(this.root_===null)return this.root_={key:e,value:s,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var c,p,_=this.root_;do if(c=_,(p=e.compareTo(_.key))<0)_=_.left;else{if(!(p>0)){var M=_.value;return _.value=s,M}_=_.right}while(_!==null);var O={key:e,left:null,right:null,value:s,parent:c,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return p<0?c.left=O:c.right=O,this.fixAfterInsertion(O),this.size_++,null}},{key:"fixAfterInsertion",value:function(e){var s;for(e.color=1;e!=null&&e!==this.root_&&e.parent.color===1;)Xt(e)===wi(Xt(Xt(e)))?Xi(s=ti(Xt(Xt(e))))===1?(pe(Xt(e),0),pe(s,0),pe(Xt(Xt(e)),1),e=Xt(Xt(e))):(e===ti(Xt(e))&&(e=Xt(e),this.rotateLeft(e)),pe(Xt(e),0),pe(Xt(Xt(e)),1),this.rotateRight(Xt(Xt(e)))):Xi(s=wi(Xt(Xt(e))))===1?(pe(Xt(e),0),pe(s,0),pe(Xt(Xt(e)),1),e=Xt(Xt(e))):(e===wi(Xt(e))&&(e=Xt(e),this.rotateRight(e)),pe(Xt(e),0),pe(Xt(Xt(e)),1),this.rotateLeft(Xt(Xt(e))));this.root_.color=0}},{key:"values",value:function(){var e=new It,s=this.getFirstEntry();if(s!==null)for(e.add(s.value);(s=t.successor(s))!==null;)e.add(s.value);return e}},{key:"entrySet",value:function(){var e=new fe,s=this.getFirstEntry();if(s!==null)for(e.add(s);(s=t.successor(s))!==null;)e.add(s);return e}},{key:"rotateLeft",value:function(e){if(e!=null){var s=e.right;e.right=s.left,s.left!=null&&(s.left.parent=e),s.parent=e.parent,e.parent==null?this.root_=s:e.parent.left===e?e.parent.left=s:e.parent.right=s,s.left=e,e.parent=s}}},{key:"rotateRight",value:function(e){if(e!=null){var s=e.left;e.left=s.right,s.right!=null&&(s.right.parent=e),s.parent=e.parent,e.parent==null?this.root_=s:e.parent.right===e?e.parent.right=s:e.parent.left=s,s.right=e,e.parent=s}}},{key:"getFirstEntry",value:function(){var e=this.root_;if(e!=null)for(;e.left!=null;)e=e.left;return e}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(e){for(var s=this.root_;s!==null;){var c=e.compareTo(s.key);if(c<0)s=s.left;else{if(!(c>0))return!0;s=s.right}}return!1}}],[{key:"successor",value:function(e){var s;if(e===null)return null;if(e.right!==null){for(s=e.right;s.left!==null;)s=s.left;return s}s=e.parent;for(var c=e;s!==null&&c===s.right;)c=s,s=s.parent;return s}}])}(Ar),_n=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"find",value:function(a){return this.nodeMap.get(a)}},{key:"addNode",value:function(){if(arguments[0]instanceof nt){var a=arguments[0],t=this.nodeMap.get(a);return t===null&&(t=this.nodeFact.createNode(a),this.nodeMap.put(a,t)),t}if(arguments[0]instanceof ki){var e=arguments[0],s=this.nodeMap.get(e.getCoordinate());return s===null?(this.nodeMap.put(e.getCoordinate(),e),e):(s.mergeLabel(e),s)}}},{key:"print",value:function(a){for(var t=this.iterator();t.hasNext();)t.next().print(a)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(a){for(var t=new It,e=this.iterator();e.hasNext();){var s=e.next();s.getLabel().getLocation(a)===K.BOUNDARY&&t.add(s)}return t}},{key:"add",value:function(a){var t=a.getCoordinate();this.addNode(t).add(a)}}],[{key:"constructor_",value:function(){this.nodeMap=new re,this.nodeFact=null;var a=arguments[0];this.nodeFact=a}}])}(),ye=function(){function a(){u(this,a)}return d(a,null,[{key:"isNorthern",value:function(t){return t===a.NE||t===a.NW}},{key:"isOpposite",value:function(t,e){return t!==e&&(t-e+4)%4===2}},{key:"commonHalfPlane",value:function(t,e){if(t===e)return t;if((t-e+4)%4===2)return-1;var s=t<e?t:e;return s===0&&(t>e?t:e)===3?3:s}},{key:"isInHalfPlane",value:function(t,e){return e===a.SE?t===a.SE||t===a.SW:t===e||t===e+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new B("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?a.NE:a.SE:e>=0?a.NW:a.SW}if(arguments[0]instanceof nt&&arguments[1]instanceof nt){var s=arguments[0],c=arguments[1];if(c.x===s.x&&c.y===s.y)throw new B("Cannot compute the quadrant for two identical points "+s);return c.x>=s.x?c.y>=s.y?a.NE:a.SE:c.y>=s.y?a.NW:a.SW}}}])}();ye.NE=0,ye.NW=1,ye.SW=2,ye.SE=3;var Dr=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"compareDirection",value:function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:Tt.index(t._p0,t._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(t){this._node=t}},{key:"print",value:function(t){var e=Math.atan2(this._dy,this._dx),s=this.getClass().getName(),c=s.lastIndexOf("."),p=s.substring(c+1);t.print("  "+p+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}},{key:"compareTo",value:function(t){var e=t;return this.compareDirection(e)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),s=e.lastIndexOf(".");return"  "+e.substring(s+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}},{key:"computeLabel",value:function(t){}},{key:"init",value:function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=ye.quadrant(this._dx,this._dy),ht.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[$]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var t=arguments[0];this._edge=t}else if(arguments.length===3){var e=arguments[0],s=arguments[1],c=arguments[2];a.constructor_.call(this,e,s,c,null)}else if(arguments.length===4){var p=arguments[0],_=arguments[1],M=arguments[2],O=arguments[3];a.constructor_.call(this,p),this.init(_,M),this._label=O}}}])}(),Rr=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(e){return this._depth[e]}},{key:"setVisited",value:function(e){this._isVisited=e}},{key:"computeDirectedLabel",value:function(){this._label=new Se(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(e,s){if(this._depth[e]!==-999&&this._depth[e]!==s)throw new Ve("assigned depths do not match",this.getCoordinate());this._depth[e]=s}},{key:"isInteriorAreaEdge",value:function(){for(var e=!0,s=0;s<2;s++)this._label.isArea(s)&&this._label.getLocation(s,yt.LEFT)===K.INTERIOR&&this._label.getLocation(s,yt.RIGHT)===K.INTERIOR||(e=!1);return e}},{key:"setNextMin",value:function(e){this._nextMin=e}},{key:"print",value:function(e){D(t,"print",this,1).call(this,e),e.print(" "+this._depth[yt.LEFT]+"/"+this._depth[yt.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")}},{key:"setMinEdgeRing",value:function(e){this._minEdgeRing=e}},{key:"isLineEdge",value:function(){var e=this._label.isLine(0)||this._label.isLine(1),s=!this._label.isArea(0)||this._label.allPositionsEqual(0,K.EXTERIOR),c=!this._label.isArea(1)||this._label.allPositionsEqual(1,K.EXTERIOR);return e&&s&&c}},{key:"setEdgeRing",value:function(e){this._edgeRing=e}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var e=this._edge.getDepthDelta();return this._isForward||(e=-e),e}},{key:"setInResult",value:function(e){this._isInResult=e}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(e){this.print(e),e.print(" "),this._isForward?this._edge.print(e):this._edge.printReverse(e)}},{key:"setSym",value:function(e){this._sym=e}},{key:"setVisitedEdge",value:function(e){this.setVisited(e),this._sym.setVisited(e)}},{key:"setEdgeDepths",value:function(e,s){var c=this.getEdge().getDepthDelta();this._isForward||(c=-c);var p=1;e===yt.LEFT&&(p=-1);var _=yt.opposite(e),M=s+c*p;this.setDepth(e,s),this.setDepth(_,M)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(e){this._next=e}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var e=arguments[0],s=arguments[1];if(Dr.constructor_.call(this,e),this._isForward=s,s)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var c=e.getNumPoints()-1;this.init(e.getCoordinate(c),e.getCoordinate(c-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(e,s){return e===K.EXTERIOR&&s===K.INTERIOR?1:e===K.INTERIOR&&s===K.EXTERIOR?-1:0}}])}(Dr),Fr=function(){return d(function a(){u(this,a)},[{key:"createNode",value:function(a){return new ki(a,null)}}])}(),Wi=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"printEdges",value:function(a){a.println("Edges:");for(var t=0;t<this._edges.size();t++){a.println("edge "+t+":");var e=this._edges.get(t);e.print(a),e.eiList.print(a)}}},{key:"find",value:function(a){return this._nodes.find(a)}},{key:"addNode",value:function(){if(arguments[0]instanceof ki){var a=arguments[0];return this._nodes.addNode(a)}if(arguments[0]instanceof nt){var t=arguments[0];return this._nodes.addNode(t)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var a=this._nodes.iterator();a.hasNext();)a.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(a){Fe.out.println(a)}},{key:"isBoundaryNode",value:function(a,t){var e=this._nodes.find(t);if(e===null)return!1;var s=e.getLabel();return s!==null&&s.getLocation(a)===K.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var a=this._nodes.iterator();a.hasNext();)a.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(a,t,e,s){return!!a.equals(e)&&Tt.index(a,t,s)===Tt.COLLINEAR&&ye.quadrant(a,t)===ye.quadrant(e,s)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(a){Fe.out.print(a)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(a,t){for(var e=0;e<this._edges.size();e++){var s=this._edges.get(e),c=s.getCoordinates();if(this.matchInSameDirection(a,t,c[0],c[1])||this.matchInSameDirection(a,t,c[c.length-1],c[c.length-2]))return s}return null}},{key:"insertEdge",value:function(a){this._edges.add(a)}},{key:"findEdgeEnd",value:function(a){for(var t=this.getEdgeEnds().iterator();t.hasNext();){var e=t.next();if(e.getEdge()===a)return e}return null}},{key:"addEdges",value:function(a){for(var t=a.iterator();t.hasNext();){var e=t.next();this._edges.add(e);var s=new Rr(e,!0),c=new Rr(e,!1);s.setSym(c),c.setSym(s),this.add(s),this.add(c)}}},{key:"add",value:function(a){this._nodes.add(a),this._edgeEndList.add(a)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(a,t){for(var e=0;e<this._edges.size();e++){var s=this._edges.get(e),c=s.getCoordinates();if(a.equals(c[0])&&t.equals(c[1]))return s}return null}}],[{key:"constructor_",value:function(){if(this._edges=new It,this._nodes=null,this._edgeEndList=new It,arguments.length===0)this._nodes=new _n(new Fr);else if(arguments.length===1){var a=arguments[0];this._nodes=new _n(a)}}},{key:"linkResultDirectedEdges",value:function(a){for(var t=a.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()}}])}(),Io=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"sortShellsAndHoles",value:function(t,e,s){for(var c=t.iterator();c.hasNext();){var p=c.next();p.isHole()?s.add(p):e.add(p)}}},{key:"computePolygons",value:function(t){for(var e=new It,s=t.iterator();s.hasNext();){var c=s.next().toPolygon(this._geometryFactory);e.add(c)}return e}},{key:"placeFreeHoles",value:function(t,e){for(var s=e.iterator();s.hasNext();){var c=s.next();if(c.getShell()===null){var p=a.findEdgeRingContaining(c,t);if(p===null)throw new Ve("unable to assign hole to a shell",c.getCoordinate(0));c.setShell(p)}}}},{key:"buildMinimalEdgeRings",value:function(t,e,s){for(var c=new It,p=t.iterator();p.hasNext();){var _=p.next();if(_.getMaxNodeDegree()>2){_.linkDirectedEdgesForMinimalEdgeRings();var M=_.buildMinimalRings(),O=this.findShell(M);O!==null?(this.placePolygonHoles(O,M),e.add(O)):s.addAll(M)}else c.add(_)}return c}},{key:"buildMaximalEdgeRings",value:function(t){for(var e=new It,s=t.iterator();s.hasNext();){var c=s.next();if(c.isInResult()&&c.getLabel().isArea()&&c.getEdgeRing()===null){var p=new $e(c,this._geometryFactory);e.add(p),p.setInResult()}}return e}},{key:"placePolygonHoles",value:function(t,e){for(var s=e.iterator();s.hasNext();){var c=s.next();c.isHole()&&c.setShell(t)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(t){for(var e=0,s=null,c=t.iterator();c.hasNext();){var p=c.next();p.isHole()||(s=p,e++)}return ht.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),s}},{key:"add",value:function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var e=arguments[0],s=arguments[1];Wi.linkResultDirectedEdges(s);var c=this.buildMaximalEdgeRings(e),p=new It,_=this.buildMinimalEdgeRings(c,this._shellList,p);this.sortShellsAndHoles(_,this._shellList,p),this.placeFreeHoles(this._shellList,p)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new It;var t=arguments[0];this._geometryFactory=t}},{key:"findEdgeRingContaining",value:function(t,e){for(var s=t.getLinearRing(),c=s.getEnvelopeInternal(),p=s.getCoordinateN(0),_=null,M=null,O=e.iterator();O.hasNext();){var U=O.next(),et=U.getLinearRing(),rt=et.getEnvelopeInternal();if(!rt.equals(c)&&rt.contains(c)){p=ue.ptNotInList(s.getCoordinates(),et.getCoordinates());var dt=!1;Qn.isInRing(p,et.getCoordinates())&&(dt=!0),dt&&(_===null||M.contains(rt))&&(M=(_=U).getLinearRing().getEnvelopeInternal())}}return _}}])}(),Br=function(){return d(function a(){u(this,a)},[{key:"getBounds",value:function(){}}])}(),Bt=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[Br,S]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var a=arguments[0],t=arguments[1];this._bounds=a,this._item=t}}])}(),Ki=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"poll",value:function(){if(this.isEmpty())return null;var a=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),a}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(a){for(var t=null,e=this._items.get(a);2*a<=this._size&&((t=2*a)!==this._size&&this._items.get(t+1).compareTo(this._items.get(t))<0&&t++,this._items.get(t).compareTo(e)<0);a=t)this._items.set(a,this._items.get(t));this._items.set(a,e)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(a){this._items.add(null),this._size+=1;var t=this._size;for(this._items.set(0,a);a.compareTo(this._items.get(Math.trunc(t/2)))<0;t/=2)this._items.set(t,this._items.get(Math.trunc(t/2)));this._items.set(t,a)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new It,this._items.add(null)}}])}(),qe=function(){return d(function a(){u(this,a)},[{key:"insert",value:function(a,t){}},{key:"remove",value:function(a,t){}},{key:"query",value:function(){}}])}(),ve=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(a){ht.isTrue(this._bounds===null),this._childBoundables.add(a)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[Br,S]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new It,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var a=arguments[0];this._level=a}}}}])}(),Rn={reverseOrder:function(){return{compare:function(a,t){return t.compareTo(a)}}},min:function(a){return Rn.sort(a),a.get(0)},sort:function(a,t){var e=a.toArray();t?me.sort(e,t):me.sort(e);for(var s=a.iterator(),c=0,p=e.length;c<p;c++)s.next(),s.set(e[c])},singletonList:function(a){var t=new It;return t.add(a),t}},So=function(){function a(){u(this,a)}return d(a,null,[{key:"maxDistance",value:function(t,e,s,c,p,_,M,O){var U=a.distance(t,e,p,_);return U=Math.max(U,a.distance(t,e,M,O)),U=Math.max(U,a.distance(s,c,p,_)),U=Math.max(U,a.distance(s,c,M,O))}},{key:"distance",value:function(t,e,s,c){var p=s-t,_=c-e;return Math.sqrt(p*p+_*_)}},{key:"maximumDistance",value:function(t,e){var s=Math.min(t.getMinX(),e.getMinX()),c=Math.min(t.getMinY(),e.getMinY()),p=Math.max(t.getMaxX(),e.getMaxX()),_=Math.max(t.getMaxY(),e.getMaxY());return a.distance(s,c,p,_)}},{key:"minMaxDistance",value:function(t,e){var s=t.getMinX(),c=t.getMinY(),p=t.getMaxX(),_=t.getMaxY(),M=e.getMinX(),O=e.getMinY(),U=e.getMaxX(),et=e.getMaxY(),rt=a.maxDistance(s,c,s,_,M,O,M,et);return rt=Math.min(rt,a.maxDistance(s,c,s,_,M,O,U,O)),rt=Math.min(rt,a.maxDistance(s,c,s,_,U,et,M,et)),rt=Math.min(rt,a.maxDistance(s,c,s,_,U,et,U,O)),rt=Math.min(rt,a.maxDistance(s,c,p,c,M,O,M,et)),rt=Math.min(rt,a.maxDistance(s,c,p,c,M,O,U,O)),rt=Math.min(rt,a.maxDistance(s,c,p,c,U,et,M,et)),rt=Math.min(rt,a.maxDistance(s,c,p,c,U,et,U,O)),rt=Math.min(rt,a.maxDistance(p,_,s,_,M,O,M,et)),rt=Math.min(rt,a.maxDistance(p,_,s,_,M,O,U,O)),rt=Math.min(rt,a.maxDistance(p,_,s,_,U,et,M,et)),rt=Math.min(rt,a.maxDistance(p,_,s,_,U,et,U,O)),rt=Math.min(rt,a.maxDistance(p,_,p,c,M,O,M,et)),rt=Math.min(rt,a.maxDistance(p,_,p,c,M,O,U,O)),rt=Math.min(rt,a.maxDistance(p,_,p,c,U,et,M,et)),rt=Math.min(rt,a.maxDistance(p,_,p,c,U,et,U,O))}}])}(),xn=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"maximumDistance",value:function(){return So.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(t,e){var s=a.isComposite(this._boundable1),c=a.isComposite(this._boundable2);if(s&&c)return a.area(this._boundable1)>a.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,t,e),null):(this.expand(this._boundable2,this._boundable1,!0,t,e),null);if(s)return this.expand(this._boundable1,this._boundable2,!1,t,e),null;if(c)return this.expand(this._boundable2,this._boundable1,!0,t,e),null;throw new B("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(a.isComposite(this._boundable1)||a.isComposite(this._boundable2))}},{key:"compareTo",value:function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0}},{key:"expand",value:function(t,e,s,c,p){for(var _=t.getChildBoundables().iterator();_.hasNext();){var M=_.next(),O=null;(O=s?new a(e,M,this._itemDistance):new a(M,e,this._itemDistance)).getDistance()<p&&c.add(O)}}},{key:"getBoundable",value:function(t){return t===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[$]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],s=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=s,this._distance=this.distance()}},{key:"area",value:function(t){return t.getBounds().getArea()}},{key:"isComposite",value:function(t){return t instanceof ve}}])}(),Ls=function(){return d(function a(){u(this,a)},[{key:"visitItem",value:function(a){}}])}(),Fn=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"queryInternal",value:function(){if(Ot(arguments[2],Ls)&&arguments[0]instanceof Object&&arguments[1]instanceof ve)for(var t=arguments[0],e=arguments[2],s=arguments[1].getChildBoundables(),c=0;c<s.size();c++){var p=s.get(c);this.getIntersectsOp().intersects(p.getBounds(),t)&&(p instanceof ve?this.queryInternal(t,p,e):p instanceof Bt?e.visitItem(p.getItem()):ht.shouldNeverReachHere())}else if(Ot(arguments[2],Ze)&&arguments[0]instanceof Object&&arguments[1]instanceof ve)for(var _=arguments[0],M=arguments[2],O=arguments[1].getChildBoundables(),U=0;U<O.size();U++){var et=O.get(U);this.getIntersectsOp().intersects(et.getBounds(),_)&&(et instanceof ve?this.queryInternal(_,et,M):et instanceof Bt?M.add(et.getItem()):ht.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(t){return t.get(t.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var s=e.next();s instanceof ve?t+=this.size(s):s instanceof Bt&&(t+=1)}return t}}},{key:"removeItem",value:function(t,e){for(var s=null,c=t.getChildBoundables().iterator();c.hasNext();){var p=c.next();p instanceof Bt&&p.getItem()===e&&(s=p)}return s!==null&&(t.getChildBoundables().remove(s),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var t=this.itemsTree(this._root);return t===null?new It:t}if(arguments.length===1){for(var e=arguments[0],s=new It,c=e.getChildBoundables().iterator();c.hasNext();){var p=c.next();if(p instanceof ve){var _=this.itemsTree(p);_!==null&&s.add(_)}else p instanceof Bt?s.add(p.getItem()):ht.shouldNeverReachHere()}return s.size()<=0?null:s}}},{key:"insert",value:function(t,e){ht.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Bt(t,e))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var t=arguments[0],e=new It;return this.boundablesAtLevel(t,this._root,e),e}if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2];if(ht.isTrue(s>-2),c.getLevel()===s)return p.add(c),null;for(var _=c.getChildBoundables().iterator();_.hasNext();){var M=_.next();M instanceof ve?this.boundablesAtLevel(s,M,p):(ht.isTrue(M instanceof Bt),s===-1&&p.add(M))}return null}}},{key:"query",value:function(){if(arguments.length===1){var t=arguments[0];this.build();var e=new It;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e),e}if(arguments.length===2){var s=arguments[0],c=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),s)&&this.queryInternal(s,this._root,c)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(arguments.length===3){var s=arguments[0],c=arguments[1],p=arguments[2],_=this.removeItem(c,p);if(_)return!0;for(var M=null,O=c.getChildBoundables().iterator();O.hasNext();){var U=O.next();if(this.getIntersectsOp().intersects(U.getBounds(),s)&&U instanceof ve&&(_=this.remove(s,U,p))){M=U;break}}return M!==null&&M.getChildBoundables().isEmpty()&&c.getChildBoundables().remove(M),_}}},{key:"createHigherLevels",value:function(t,e){ht.isTrue(!t.isEmpty());var s=this.createParentBoundables(t,e+1);return s.size()===1?s.get(0):this.createHigherLevels(s,e+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var s=e.next();if(s instanceof ve){var c=this.depth(s);c>t&&(t=c)}}return t+1}}},{key:"createParentBoundables",value:function(t,e){ht.isTrue(!t.isEmpty());var s=new It;s.add(this.createNode(e));var c=new It(t);Rn.sort(c,this.getComparator());for(var p=c.iterator();p.hasNext();){var _=p.next();this.lastNode(s).getChildBoundables().size()===this.getNodeCapacity()&&s.add(this.createNode(e)),this.lastNode(s).addChildBoundable(_)}return s}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[S]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new It,this._nodeCapacity=null,arguments.length===0)a.constructor_.call(this,a.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var t=arguments[0];ht.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}}},{key:"compareDoubles",value:function(t,e){return t>e?1:t<e?-1:0}}])}();Fn.IntersectsOp=function(){},Fn.DEFAULT_NODE_CAPACITY=10;var Co=function(){return d(function a(){u(this,a)},[{key:"distance",value:function(a,t){}}])}(),Je=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"createParentBoundablesFromVerticalSlices",value:function(e,s){ht.isTrue(e.length>0);for(var c=new It,p=0;p<e.length;p++)c.addAll(this.createParentBoundablesFromVerticalSlice(e[p],s));return c}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var e=arguments[0],s=arguments[1];return this.nearestNeighbourK(e,J.POSITIVE_INFINITY,s)}if(arguments.length===3){var c=arguments[0],p=arguments[2],_=arguments[1],M=new Ki;M.add(c);for(var O=new Ki;!M.isEmpty()&&_>=0;){var U=M.poll(),et=U.getDistance();if(et>=_)break;U.isLeaves()?O.size()<p?O.add(U):(O.peek().getDistance()>et&&(O.poll(),O.add(U)),_=O.peek().getDistance()):U.expandToQueue(M,_)}return t.getItems(O)}}},{key:"createNode",value:function(e){return new $i(e)}},{key:"size",value:function(){return arguments.length===0?D(t,"size",this,1).call(this):D(t,"size",this,1).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof bt))return D(t,"insert",this,1).apply(this,arguments);var e=arguments[0],s=arguments[1];if(e.isNull())return null;D(t,"insert",this,1).call(this,e,s)}},{key:"getIntersectsOp",value:function(){return t.intersectsOp}},{key:"verticalSlices",value:function(e,s){for(var c=Math.trunc(Math.ceil(e.size()/s)),p=new Array(s).fill(null),_=e.iterator(),M=0;M<s;M++){p[M]=new It;for(var O=0;_.hasNext()&&O<c;){var U=_.next();p[M].add(U),O++}}return p}},{key:"query",value:function(){if(arguments.length===1){var e=arguments[0];return D(t,"query",this,1).call(this,e)}if(arguments.length===2){var s=arguments[0],c=arguments[1];D(t,"query",this,1).call(this,s,c)}}},{key:"getComparator",value:function(){return t.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(e,s){return D(t,"createParentBoundables",this,1).call(this,e,s)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof bt){var e=arguments[0],s=arguments[1];return D(t,"remove",this,1).call(this,e,s)}return D(t,"remove",this,1).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?D(t,"depth",this,1).call(this):D(t,"depth",this,1).apply(this,arguments)}},{key:"createParentBoundables",value:function(e,s){ht.isTrue(!e.isEmpty());var c=Math.trunc(Math.ceil(e.size()/this.getNodeCapacity())),p=new It(e);Rn.sort(p,t.xComparator);var _=this.verticalSlices(p,Math.trunc(Math.ceil(Math.sqrt(c))));return this.createParentBoundablesFromVerticalSlices(_,s)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(Ot(arguments[0],Co)){var e=arguments[0];if(this.isEmpty())return null;var s=new xn(this.getRoot(),this.getRoot(),e);return this.nearestNeighbour(s)}if(arguments[0]instanceof xn){var c=arguments[0],p=J.POSITIVE_INFINITY,_=null,M=new Ki;for(M.add(c);!M.isEmpty()&&p>0;){var O=M.poll(),U=O.getDistance();if(U>=p)break;O.isLeaves()?(p=U,_=O):O.expandToQueue(M,p)}return _===null?null:[_.getBoundable(0).getItem(),_.getBoundable(1).getItem()]}}else{if(arguments.length===2){var et=arguments[0],rt=arguments[1];if(this.isEmpty()||et.isEmpty())return null;var dt=new xn(this.getRoot(),et.getRoot(),rt);return this.nearestNeighbour(dt)}if(arguments.length===3){var xt=arguments[2],Pt=new Bt(arguments[0],arguments[1]),Mt=new xn(this.getRoot(),Pt,xt);return this.nearestNeighbour(Mt)[0]}if(arguments.length===4){var Vt=arguments[2],Ht=arguments[3],te=new Bt(arguments[0],arguments[1]),ie=new xn(this.getRoot(),te,Vt);return this.nearestNeighbourK(ie,Ht)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var e=arguments[0],s=arguments[1],c=J.POSITIVE_INFINITY,p=new Ki;for(p.add(e);!p.isEmpty();){var _=p.poll(),M=_.getDistance();if(M>s)return!1;if(_.maximumDistance()<=s)return!0;if(_.isLeaves()){if((c=M)<=s)return!0}else _.expandToQueue(p,c)}return!1}if(arguments.length===3){var O=arguments[0],U=arguments[1],et=arguments[2],rt=new xn(this.getRoot(),O.getRoot(),U);return this.isWithinDistance(rt,et)}}},{key:"interfaces_",get:function(){return[qe,S]}}],[{key:"constructor_",value:function(){if(arguments.length===0)t.constructor_.call(this,t.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var e=arguments[0];Fn.constructor_.call(this,e)}}},{key:"centreX",value:function(e){return t.avg(e.getMinX(),e.getMaxX())}},{key:"avg",value:function(e,s){return(e+s)/2}},{key:"getItems",value:function(e){for(var s=new Array(e.size()).fill(null),c=0;!e.isEmpty();){var p=e.poll();s[c]=p.getBoundable(0).getItem(),c++}return s}},{key:"centreY",value:function(e){return t.avg(e.getMinY(),e.getMaxY())}}])}(Fn),$i=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"computeBounds",value:function(){for(var e=null,s=this.getChildBoundables().iterator();s.hasNext();){var c=s.next();e===null?e=new bt(c.getBounds()):e.expandToInclude(c.getBounds())}return e}}],[{key:"constructor_",value:function(){var e=arguments[0];ve.constructor_.call(this,e)}}])}(ve);Je.STRtreeNode=$i,Je.xComparator=new(function(){return d(function a(){u(this,a)},[{key:"interfaces_",get:function(){return[ut]}},{key:"compare",value:function(a,t){return Fn.compareDoubles(Je.centreX(a.getBounds()),Je.centreX(t.getBounds()))}}])}()),Je.yComparator=new(function(){return d(function a(){u(this,a)},[{key:"interfaces_",get:function(){return[ut]}},{key:"compare",value:function(a,t){return Fn.compareDoubles(Je.centreY(a.getBounds()),Je.centreY(t.getBounds()))}}])}()),Je.intersectsOp=new(function(){return d(function a(){u(this,a)},[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(a,t){return a.intersects(t)}}])}()),Je.DEFAULT_NODE_CAPACITY=10;var bo=function(){function a(){u(this,a)}return d(a,null,[{key:"relativeSign",value:function(t,e){return t<e?-1:t>e?1:0}},{key:"compare",value:function(t,e,s){if(e.equals2D(s))return 0;var c=a.relativeSign(e.x,s.x),p=a.relativeSign(e.y,s.y);switch(t){case 0:return a.compareValue(c,p);case 1:return a.compareValue(p,c);case 2:return a.compareValue(p,-c);case 3:return a.compareValue(-c,p);case 4:return a.compareValue(-c,-p);case 5:return a.compareValue(-p,-c);case 6:return a.compareValue(-p,c);case 7:return a.compareValue(c,-p)}return ht.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0}}])}(),je=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(a){a.print(this.coord),a.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(a){var t=a;return this.segmentIndex<t.segmentIndex?-1:this.segmentIndex>t.segmentIndex?1:this.coord.equals2D(t.coord)?0:this._isInterior?t._isInterior?bo.compare(this._segmentOctant,this.coord,t.coord):1:-1}},{key:"isEndPoint",value:function(a){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===a}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[$]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var a=arguments[0],t=arguments[1],e=arguments[2],s=arguments[3];this._segString=a,this.coord=new nt(t),this.segmentIndex=e,this._segmentOctant=s,this._isInterior=!t.equals2D(a.getCoordinate(e))}}])}(),To=function(){return d(function a(){u(this,a)},[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}])}(),Ms=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"getSplitCoordinates",value:function(){var a=new yi;this.addEndpoints();for(var t=this.iterator(),e=t.next();t.hasNext();){var s=t.next();this.addEdgeCoordinates(e,s,a),e=s}return a.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var a=new It;this.findCollapsesFromInsertedNodes(a),this.findCollapsesFromExistingVertices(a);for(var t=a.iterator();t.hasNext();){var e=t.next().intValue();this.add(this._edge.getCoordinate(e),e)}}},{key:"createSplitEdgePts",value:function(a,t){var e=t.segmentIndex-a.segmentIndex+2;if(e===2)return[new nt(a.coord),new nt(t.coord)];var s=this._edge.getCoordinate(t.segmentIndex),c=t.isInterior()||!t.coord.equals2D(s);c||e--;var p=new Array(e).fill(null),_=0;p[_++]=new nt(a.coord);for(var M=a.segmentIndex+1;M<=t.segmentIndex;M++)p[_++]=this._edge.getCoordinate(M);return c&&(p[_]=new nt(t.coord)),p}},{key:"print",value:function(a){a.println("Intersections:");for(var t=this.iterator();t.hasNext();)t.next().print(a)}},{key:"findCollapsesFromExistingVertices",value:function(a){for(var t=0;t<this._edge.size()-2;t++){var e=this._edge.getCoordinate(t);this._edge.getCoordinate(t+1);var s=this._edge.getCoordinate(t+2);e.equals2D(s)&&a.add(Ye.valueOf(t+1))}}},{key:"addEdgeCoordinates",value:function(a,t,e){var s=this.createSplitEdgePts(a,t);e.add(s,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(a){this.addEndpoints(),this.addCollapsedNodes();for(var t=this.iterator(),e=t.next();t.hasNext();){var s=t.next(),c=this.createSplitEdge(e,s);a.add(c),e=s}}},{key:"findCollapseIndex",value:function(a,t,e){if(!a.coord.equals2D(t.coord))return!1;var s=t.segmentIndex-a.segmentIndex;return t.isInterior()||s--,s===1&&(e[0]=a.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(a){for(var t=new Array(1).fill(null),e=this.iterator(),s=e.next();e.hasNext();){var c=e.next();this.findCollapseIndex(s,c,t)&&a.add(Ye.valueOf(t[0])),s=c}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var a=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(a),a)}},{key:"createSplitEdge",value:function(a,t){var e=this.createSplitEdgePts(a,t);return new cn(e,this._edge.getData())}},{key:"add",value:function(a,t){var e=new je(this._edge,a,t,this._edge.getSegmentOctant(t)),s=this._nodeMap.get(e);return s!==null?(ht.isTrue(s.coord.equals2D(a),"Found equal nodes with different coordinates"),s):(this._nodeMap.put(e,e),e)}},{key:"checkSplitEdgesCorrectness",value:function(a){var t=this._edge.getCoordinates(),e=a.get(0).getCoordinate(0);if(!e.equals2D(t[0]))throw new ct("bad split edge start point at "+e);var s=a.get(a.size()-1).getCoordinates(),c=s[s.length-1];if(!c.equals2D(t[t.length-1]))throw new ct("bad split edge end point at "+c)}}],[{key:"constructor_",value:function(){this._nodeMap=new re,this._edge=null;var a=arguments[0];this._edge=a}}])}(),kn=function(){function a(){u(this,a)}return d(a,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new B("Cannot compute the octant for point ( "+t+", "+e+" )");var s=Math.abs(t),c=Math.abs(e);return t>=0?e>=0?s>=c?0:1:s>=c?7:6:e>=0?s>=c?3:2:s>=c?4:5}if(arguments[0]instanceof nt&&arguments[1]instanceof nt){var p=arguments[0],_=arguments[1],M=_.x-p.x,O=_.y-p.y;if(M===0&&O===0)throw new B("Cannot compute the octant for two identical points "+p);return a.octant(M,O)}}}])}(),Is=function(){return d(function a(){u(this,a)},[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(a){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(a){}},{key:"getData",value:function(){}}])}(),Ss=function(){return d(function a(){u(this,a)},[{key:"addIntersection",value:function(a,t){}},{key:"interfaces_",get:function(){return[Is]}}])}(),cn=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(t){return this._pts[t]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))}},{key:"setData",value:function(t){this._data=t}},{key:"safeOctant",value:function(t,e){return t.equals2D(e)?0:kn.octant(t,e)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(arguments.length===4){var s=arguments[1],c=arguments[3],p=new nt(arguments[0].getIntersection(c));this.addIntersection(p,s)}}},{key:"toString",value:function(){return xi.toLineString(new vi(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(t,e){var s=e,c=s+1;if(c<this._pts.length){var p=this._pts[c];t.equals2D(p)&&(s=c)}return this._nodeList.add(t,s)}},{key:"addIntersections",value:function(t,e,s){for(var c=0;c<t.getIntersectionNum();c++)this.addIntersection(t,e,s,c)}},{key:"interfaces_",get:function(){return[Ss]}}],[{key:"constructor_",value:function(){this._nodeList=new Ms(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var t=arguments[0],e=new It;return a.getNodedSubstrings(t,e),e}if(arguments.length===2)for(var s=arguments[1],c=arguments[0].iterator();c.hasNext();)c.next().getNodeList().addSplitEdges(s)}}])}(),Oe=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof a){var t=arguments[0],e=Tt.index(this.p0,this.p1,t.p0),s=Tt.index(this.p0,this.p1,t.p1);return e>=0&&s>=0||e<=0&&s<=0?Math.max(e,s):0}if(arguments[0]instanceof nt){var c=arguments[0];return Tt.index(this.p0,this.p1,c)}}},{key:"toGeometry",value:function(t){return t.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(t){if(!(t instanceof a))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)}},{key:"intersection",value:function(t){var e=new hn;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof nt){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new nt(t);var e=this.projectionFactor(t),s=new nt;return s.x=this.p0.x+e*(this.p1.x-this.p0.x),s.y=this.p0.y+e*(this.p1.y-this.p0.y),s}if(arguments[0]instanceof a){var c=arguments[0],p=this.projectionFactor(c.p0),_=this.projectionFactor(c.p1);if(p>=1&&_>=1||p<=0&&_<=0)return null;var M=this.project(c.p0);p<0&&(M=this.p0),p>1&&(M=this.p1);var O=this.project(c.p1);return _<0&&(O=this.p0),_>1&&(O=this.p1),new a(M,O)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(t){return t===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(t){return He.pointToLinePerpendicular(t,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return a.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,c=e*e+s*s;return c<=0?J.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*s)/c}},{key:"closestPoints",value:function(t){var e=this.intersection(t);if(e!==null)return[e,e];var s=new Array(2).fill(null),c=J.MAX_VALUE,p=null,_=this.closestPoint(t.p0);c=_.distance(t.p0),s[0]=_,s[1]=t.p0;var M=this.closestPoint(t.p1);(p=M.distance(t.p1))<c&&(c=p,s[0]=M,s[1]=t.p1);var O=t.closestPoint(this.p0);(p=O.distance(this.p0))<c&&(c=p,s[0]=this.p0,s[1]=O);var U=t.closestPoint(this.p1);return(p=U.distance(this.p1))<c&&(c=p,s[0]=this.p1,s[1]=U),s}},{key:"closestPoint",value:function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(t){var e=t,s=this.p0.compareTo(e.p0);return s!==0?s:this.p1.compareTo(e.p1)}},{key:"reverse",value:function(){var t=this.p0;this.p0=this.p1,this.p1=t}},{key:"equalsTopo",value:function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}},{key:"lineIntersection",value:function(t){return Er.intersection(this.p0,this.p1,t.p0,t.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(t,e){var s=this.p0.x+t*(this.p1.x-this.p0.x),c=this.p0.y+t*(this.p1.y-this.p0.y),p=this.p1.x-this.p0.x,_=this.p1.y-this.p0.y,M=Math.sqrt(p*p+_*_),O=0,U=0;if(e!==0){if(M<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");O=e*p/M,U=e*_/M}return new nt(s-U,c+O)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var e=arguments[0],s=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=s.x,this.p1.y=s.y}}},{key:"segmentFraction",value:function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||J.isNaN(e))&&(e=1),e}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(t){var e=this.p1.getY()-this.p0.getY(),s=this.p0.getX()-this.p1.getX(),c=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),p=e*e+s*s,_=e*e-s*s,M=t.getX(),O=t.getY();return new nt((-_*M-2*e*s*O-2*e*c)/p,(_*O-2*e*s*M-2*s*c)/p)}},{key:"distance",value:function(){if(arguments[0]instanceof a){var t=arguments[0];return He.segmentToSegment(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof nt){var e=arguments[0];return He.pointToSegment(e,this.p0,this.p1)}}},{key:"pointAlong",value:function(t){var e=new nt;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}},{key:"hashCode",value:function(){var t=J.doubleToLongBits(this.p0.x);t^=31*J.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),s=J.doubleToLongBits(this.p1.x);return s^=31*J.doubleToLongBits(this.p1.y),e^(Math.trunc(s)^Math.trunc(s>>32))}},{key:"interfaces_",get:function(){return[$,S]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)a.constructor_.call(this,new nt,new nt);else if(arguments.length===1){var t=arguments[0];a.constructor_.call(this,t.p0,t.p1)}else if(arguments.length===2){var e=arguments[0],s=arguments[1];this.p0=e,this.p1=s}else if(arguments.length===4){var c=arguments[0],p=arguments[1],_=arguments[2],M=arguments[3];a.constructor_.call(this,new nt(c,p),new nt(_,M))}}},{key:"midPoint",value:function(t,e){return new nt((t.x+e.x)/2,(t.y+e.y)/2)}}])}(),Cs=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var a=arguments[1],t=arguments[2],e=arguments[3];arguments[0].getLineSegment(a,this._overlapSeg1),t.getLineSegment(e,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new Oe,this._overlapSeg2=new Oe}}])}(),zr=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"getLineSegment",value:function(a,t){t.p0=this._pts[a],t.p1=this._pts[a+1]}},{key:"computeSelect",value:function(a,t,e,s){var c=this._pts[t],p=this._pts[e];if(e-t==1)return s.select(this,t),null;if(!a.intersects(c,p))return null;var _=Math.trunc((t+e)/2);t<_&&this.computeSelect(a,t,_,s),_<e&&this.computeSelect(a,_,e,s)}},{key:"getCoordinates",value:function(){for(var a=new Array(this._end-this._start+1).fill(null),t=0,e=this._start;e<=this._end;e++)a[t++]=this._pts[e];return a}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var a=arguments[0],t=arguments[1];this.computeOverlaps(this._start,this._end,a,a._start,a._end,t)}else if(arguments.length===6){var e=arguments[0],s=arguments[1],c=arguments[2],p=arguments[3],_=arguments[4],M=arguments[5];if(s-e==1&&_-p==1)return M.overlap(this,e,c,p),null;if(!this.overlaps(e,s,c,p,_))return null;var O=Math.trunc((e+s)/2),U=Math.trunc((p+_)/2);e<O&&(p<U&&this.computeOverlaps(e,O,c,p,U,M),U<_&&this.computeOverlaps(e,O,c,U,_,M)),O<s&&(p<U&&this.computeOverlaps(O,s,c,p,U,M),U<_&&this.computeOverlaps(O,s,c,U,_,M))}}},{key:"setId",value:function(a){this._id=a}},{key:"select",value:function(a,t){this.computeSelect(a,this._start,this._end,t)}},{key:"getEnvelope",value:function(){if(this._env===null){var a=this._pts[this._start],t=this._pts[this._end];this._env=new bt(a,t)}return this._env}},{key:"overlaps",value:function(a,t,e,s,c){return bt.intersects(this._pts[a],this._pts[t],e._pts[s],e._pts[c])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var a=arguments[0],t=arguments[1],e=arguments[2],s=arguments[3];this._pts=a,this._start=t,this._end=e,this._context=s}}])}(),No=function(){function a(){u(this,a)}return d(a,null,[{key:"findChainEnd",value:function(t,e){for(var s=e;s<t.length-1&&t[s].equals2D(t[s+1]);)s++;if(s>=t.length-1)return t.length-1;for(var c=ye.quadrant(t[s],t[s+1]),p=e+1;p<t.length&&!(!t[p-1].equals2D(t[p])&&ye.quadrant(t[p-1],t[p])!==c);)p++;return p-1}},{key:"getChains",value:function(){if(arguments.length===1){var t=arguments[0];return a.getChains(t,null)}if(arguments.length===2){var e=arguments[0],s=arguments[1],c=new It,p=0;do{var _=a.findChainEnd(e,p),M=new zr(e,p,_,s);c.add(M),p=_}while(p<e.length-1);return c}}}])}(),Gr=function(){return d(function a(){u(this,a)},[{key:"computeNodes",value:function(a){}},{key:"getNodedSubstrings",value:function(){}}])}(),Ji=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"setSegmentIntersector",value:function(a){this._segInt=a}},{key:"interfaces_",get:function(){return[Gr]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var a=arguments[0];this.setSegmentIntersector(a)}}}}])}(),Hr=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return cn.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(e){for(var s=No.getChains(e.getCoordinates(),e).iterator();s.hasNext();){var c=s.next();c.setId(this._idCounter++),this._index.insert(c.getEnvelope(),c),this._monoChains.add(c)}}},{key:"computeNodes",value:function(e){this._nodedSegStrings=e;for(var s=e.iterator();s.hasNext();)this.add(s.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var e=new qr(this._segInt),s=this._monoChains.iterator();s.hasNext();)for(var c=s.next(),p=this._index.query(c.getEnvelope()).iterator();p.hasNext();){var _=p.next();if(_.getId()>c.getId()&&(c.computeOverlaps(_,e),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new It,this._index=new Je,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var e=arguments[0];Ji.constructor_.call(this,e)}}}}])}(Ji),qr=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"overlap",value:function(){if(arguments.length!==4)return D(t,"overlap",this,1).apply(this,arguments);var e=arguments[1],s=arguments[2],c=arguments[3],p=arguments[0].getContext(),_=s.getContext();this._si.processIntersections(p,e,_,c)}}],[{key:"constructor_",value:function(){this._si=null;var e=arguments[0];this._si=e}}])}(Cs);Hr.SegmentOverlapAction=qr;var Be=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"isDeletable",value:function(t,e,s,c){var p=this._inputLine[t],_=this._inputLine[e],M=this._inputLine[s];return!!this.isConcave(p,_,M)&&!!this.isShallow(p,_,M,c)&&this.isShallowSampled(p,_,t,s,c)}},{key:"deleteShallowConcavities",value:function(){for(var t=1,e=this.findNextNonDeletedIndex(t),s=this.findNextNonDeletedIndex(e),c=!1;s<this._inputLine.length;){var p=!1;this.isDeletable(t,e,s,this._distanceTol)&&(this._isDeleted[e]=a.DELETE,p=!0,c=!0),t=p?s:e,e=this.findNextNonDeletedIndex(t),s=this.findNextNonDeletedIndex(e)}return c}},{key:"isShallowConcavity",value:function(t,e,s,c){return Tt.index(t,e,s)===this._angleOrientation&&He.pointToSegment(e,t,s)<c}},{key:"isShallowSampled",value:function(t,e,s,c,p){var _=Math.trunc((c-s)/a.NUM_PTS_TO_CHECK);_<=0&&(_=1);for(var M=s;M<c;M+=_)if(!this.isShallow(t,e,this._inputLine[M],p))return!1;return!0}},{key:"isConcave",value:function(t,e,s){var c=Tt.index(t,e,s)===this._angleOrientation;return c}},{key:"simplify",value:function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=Tt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do e=this.deleteShallowConcavities();while(e);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===a.DELETE;)e++;return e}},{key:"isShallow",value:function(t,e,s,c){return He.pointToSegment(e,t,s)<c}},{key:"collapseLine",value:function(){for(var t=new yi,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==a.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Tt.COUNTERCLOCKWISE;var t=arguments[0];this._inputLine=t}},{key:"simplify",value:function(t,e){return new a(t).simplify(e)}}])}();Be.INIT=0,Be.DELETE=1,Be.KEEP=1,Be.NUM_PTS_TO_CHECK=10;var Ei=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"getCoordinates",value:function(){return this._ptList.toArray(a.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(t){this._precisionModel=t}},{key:"addPt",value:function(t){var e=new nt(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(t,e){if(e)for(var s=0;s<t.length;s++)this.addPt(t[s]);else for(var c=t.length-1;c>=0;c--)this.addPt(t[c])}},{key:"isRedundant",value:function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance}},{key:"toString",value:function(){return new We().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var t=new nt(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)}},{key:"setMinimumVertexDistance",value:function(t){this._minimimVertexDistance=t}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new It}}])}();Ei.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var he=function(){function a(){u(this,a)}return d(a,null,[{key:"toDegrees",value:function(t){return 180*t/Math.PI}},{key:"normalize",value:function(t){for(;t>Math.PI;)t-=a.PI_TIMES_2;for(;t<=-Math.PI;)t+=a.PI_TIMES_2;return t}},{key:"angle",value:function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}if(arguments.length===2){var e=arguments[0],s=arguments[1],c=s.x-e.x,p=s.y-e.y;return Math.atan2(p,c)}}},{key:"isAcute",value:function(t,e,s){var c=t.x-e.x,p=t.y-e.y;return c*(s.x-e.x)+p*(s.y-e.y)>0}},{key:"isObtuse",value:function(t,e,s){var c=t.x-e.x,p=t.y-e.y;return c*(s.x-e.x)+p*(s.y-e.y)<0}},{key:"interiorAngle",value:function(t,e,s){var c=a.angle(e,t),p=a.angle(e,s);return Math.abs(p-c)}},{key:"normalizePositive",value:function(t){if(t<0){for(;t<0;)t+=a.PI_TIMES_2;t>=a.PI_TIMES_2&&(t=0)}else{for(;t>=a.PI_TIMES_2;)t-=a.PI_TIMES_2;t<0&&(t=0)}return t}},{key:"angleBetween",value:function(t,e,s){var c=a.angle(e,t),p=a.angle(e,s);return a.diff(c,p)}},{key:"diff",value:function(t,e){var s=null;return(s=t<e?e-t:t-e)>Math.PI&&(s=2*Math.PI-s),s}},{key:"toRadians",value:function(t){return t*Math.PI/180}},{key:"getTurn",value:function(t,e){var s=Math.sin(e-t);return s>0?a.COUNTERCLOCKWISE:s<0?a.CLOCKWISE:a.NONE}},{key:"angleBetweenOriented",value:function(t,e,s){var c=a.angle(e,t),p=a.angle(e,s)-c;return p<=-Math.PI?p+a.PI_TIMES_2:p>Math.PI?p-a.PI_TIMES_2:p}}])}();he.PI_TIMES_2=2*Math.PI,he.PI_OVER_2=Math.PI/2,he.PI_OVER_4=Math.PI/4,he.COUNTERCLOCKWISE=Tt.COUNTERCLOCKWISE,he.CLOCKWISE=Tt.CLOCKWISE,he.NONE=Tt.COLLINEAR;var Pi=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"addNextSegment",value:function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var s=Tt.index(this._s0,this._s1,this._s2),c=s===Tt.CLOCKWISE&&this._side===yt.LEFT||s===Tt.COUNTERCLOCKWISE&&this._side===yt.RIGHT;s===0?this.addCollinear(e):c?this.addOutsideTurn(s,e):this.addInsideTurn(s,e)}},{key:"addLineEndCap",value:function(t,e){var s=new Oe(t,e),c=new Oe;this.computeOffsetSegment(s,yt.LEFT,this._distance,c);var p=new Oe;this.computeOffsetSegment(s,yt.RIGHT,this._distance,p);var _=e.x-t.x,M=e.y-t.y,O=Math.atan2(M,_);switch(this._bufParams.getEndCapStyle()){case G.CAP_ROUND:this._segList.addPt(c.p1),this.addDirectedFillet(e,O+Math.PI/2,O-Math.PI/2,Tt.CLOCKWISE,this._distance),this._segList.addPt(p.p1);break;case G.CAP_FLAT:this._segList.addPt(c.p1),this._segList.addPt(p.p1);break;case G.CAP_SQUARE:var U=new nt;U.x=Math.abs(this._distance)*Math.cos(O),U.y=Math.abs(this._distance)*Math.sin(O);var et=new nt(c.p1.x+U.x,c.p1.y+U.y),rt=new nt(p.p1.x+U.x,p.p1.y+U.y);this._segList.addPt(et),this._segList.addPt(rt)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(t,e,s,c){var p=Er.intersection(e.p0,e.p1,s.p0,s.p1);if(p!==null&&(c<=0?1:p.distance(t)/Math.abs(c))<=this._bufParams.getMitreLimit())return this._segList.addPt(p),null;this.addLimitedMitreJoin(e,s,c,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*a.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===G.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===G.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(t){this._segList.addPt(new nt(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new nt(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new nt(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new nt(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(t,e){this._segList.addPts(t,e)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(t,e,s,c,p){var _=e.x-t.x,M=e.y-t.y,O=Math.atan2(M,_),U=s.x-t.x,et=s.y-t.y,rt=Math.atan2(et,U);c===Tt.CLOCKWISE?O<=rt&&(O+=2*Math.PI):O>=rt&&(O-=2*Math.PI),this._segList.addPt(e),this.addDirectedFillet(t,O,rt,c,p),this._segList.addPt(s)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(t,e,s){this._s1=t,this._s2=e,this._side=s,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,s,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(t,e,s,c){var p=this._seg0.p1,_=he.angle(p,this._seg0.p0),M=he.angleBetweenOriented(this._seg0.p0,p,this._seg1.p1)/2,O=he.normalize(_+M),U=he.normalize(O+Math.PI),et=c*s,rt=s-et*Math.abs(Math.sin(M)),dt=p.x+et*Math.cos(U),xt=p.y+et*Math.sin(U),Pt=new nt(dt,xt),Mt=new Oe(p,Pt),Vt=Mt.pointAlongOffset(1,rt),Ht=Mt.pointAlongOffset(1,-rt);this._side===yt.LEFT?(this._segList.addPt(Vt),this._segList.addPt(Ht)):(this._segList.addPt(Ht),this._segList.addPt(Vt))}},{key:"addDirectedFillet",value:function(t,e,s,c,p){var _=c===Tt.CLOCKWISE?-1:1,M=Math.abs(e-s),O=Math.trunc(M/this._filletAngleQuantum+.5);if(O<1)return null;for(var U=M/O,et=new nt,rt=0;rt<O;rt++){var dt=e+_*rt*U;et.x=t.x+p*Math.cos(dt),et.y=t.y+p*Math.sin(dt),this._segList.addPt(et)}}},{key:"computeOffsetSegment",value:function(t,e,s,c){var p=e===yt.LEFT?1:-1,_=t.p1.x-t.p0.x,M=t.p1.y-t.p0.y,O=Math.sqrt(_*_+M*M),U=p*s*_/O,et=p*s*M/O;c.p0.x=t.p0.x-et,c.p0.y=t.p0.y+U,c.p1.x=t.p1.x-et,c.p1.y=t.p1.y+U}},{key:"addInsideTurn",value:function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*a.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var s=new nt((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(s);var c=new nt((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(c)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(t){var e=new nt(t.x+this._distance,t.y);this._segList.addPt(e),this.addDirectedFillet(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)}},{key:"init",value:function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Ei,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*a.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===G.JOIN_BEVEL||this._bufParams.getJoinStyle()===G.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,Tt.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Oe,this._seg1=new Oe,this._offset0=new Oe,this._offset1=new Oe,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],s=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new hn,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===G.JOIN_ROUND&&(this._closingSegLengthFactor=a.MAX_CLOSING_SEG_LEN_FACTOR),this.init(s)}}])}();Pi.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Pi.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Pi.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Pi.MAX_CLOSING_SEG_LEN_FACTOR=80;var Li=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"getOffsetCurve",value:function(t,e){if(this._distance=e,e===0)return null;var s=e<0,c=Math.abs(e),p=this.getSegGen(c);t.length<=1?this.computePointCurve(t[0],p):this.computeOffsetCurve(t,s,p);var _=p.getCoordinates();return s&&ue.reverse(_),_}},{key:"computeSingleSidedBufferCurve",value:function(t,e,s){var c=this.simplifyTolerance(this._distance);if(e){s.addSegments(t,!0);var p=Be.simplify(t,-c),_=p.length-1;s.initSideSegments(p[_],p[_-1],yt.LEFT),s.addFirstSegment();for(var M=_-2;M>=0;M--)s.addNextSegment(p[M],!0)}else{s.addSegments(t,!1);var O=Be.simplify(t,c),U=O.length-1;s.initSideSegments(O[0],O[1],yt.LEFT),s.addFirstSegment();for(var et=2;et<=U;et++)s.addNextSegment(O[et],!0)}s.addLastSegment(),s.closeRing()}},{key:"computeRingBufferCurve",value:function(t,e,s){var c=this.simplifyTolerance(this._distance);e===yt.RIGHT&&(c=-c);var p=Be.simplify(t,c),_=p.length-1;s.initSideSegments(p[_-1],p[0],e);for(var M=1;M<=_;M++){var O=M!==1;s.addNextSegment(p[M],O)}s.closeRing()}},{key:"computeLineBufferCurve",value:function(t,e){var s=this.simplifyTolerance(this._distance),c=Be.simplify(t,s),p=c.length-1;e.initSideSegments(c[0],c[1],yt.LEFT);for(var _=2;_<=p;_++)e.addNextSegment(c[_],!0);e.addLastSegment(),e.addLineEndCap(c[p-1],c[p]);var M=Be.simplify(t,-s),O=M.length-1;e.initSideSegments(M[O],M[O-1],yt.LEFT);for(var U=O-2;U>=0;U--)e.addNextSegment(M[U],!0);e.addLastSegment(),e.addLineEndCap(M[1],M[0]),e.closeRing()}},{key:"computePointCurve",value:function(t,e){switch(this._bufParams.getEndCapStyle()){case G.CAP_ROUND:e.createCircle(t);break;case G.CAP_SQUARE:e.createSquare(t)}}},{key:"getLineCurve",value:function(t,e){if(this._distance=e,this.isLineOffsetEmpty(e))return null;var s=Math.abs(e),c=this.getSegGen(s);if(t.length<=1)this.computePointCurve(t[0],c);else if(this._bufParams.isSingleSided()){var p=e<0;this.computeSingleSidedBufferCurve(t,p,c)}else this.computeLineBufferCurve(t,c);return c.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(t){return t*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(t,e,s){if(this._distance=s,t.length<=2)return this.getLineCurve(t,s);if(s===0)return a.copyCoordinates(t);var c=this.getSegGen(s);return this.computeRingBufferCurve(t,e,c),c.getCoordinates()}},{key:"computeOffsetCurve",value:function(t,e,s){var c=this.simplifyTolerance(this._distance);if(e){var p=Be.simplify(t,-c),_=p.length-1;s.initSideSegments(p[_],p[_-1],yt.LEFT),s.addFirstSegment();for(var M=_-2;M>=0;M--)s.addNextSegment(p[M],!0)}else{var O=Be.simplify(t,c),U=O.length-1;s.initSideSegments(O[0],O[1],yt.LEFT),s.addFirstSegment();for(var et=2;et<=U;et++)s.addNextSegment(O[et],!0)}s.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(t){return t===0||t<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(t){return new Pi(this._precisionModel,this._bufParams,t)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e}},{key:"copyCoordinates",value:function(t){for(var e=new Array(t.length).fill(null),s=0;s<e.length;s++)e[s]=new nt(t[s]);return e}}])}(),Ae=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var a=arguments[0],t=new It,e=this._subgraphs.iterator();e.hasNext();){var s=e.next(),c=s.getEnvelope();a.y<c.getMinY()||a.y>c.getMaxY()||this.findStabbedSegments(a,s.getDirectedEdges(),t)}return t}if(arguments.length===3){if(Ot(arguments[2],Ze)&&arguments[0]instanceof nt&&arguments[1]instanceof Rr){for(var p=arguments[0],_=arguments[1],M=arguments[2],O=_.getEdge().getCoordinates(),U=0;U<O.length-1;U++)if(this._seg.p0=O[U],this._seg.p1=O[U+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<p.x||this._seg.isHorizontal()||p.y<this._seg.p0.y||p.y>this._seg.p1.y||Tt.index(this._seg.p0,this._seg.p1,p)===Tt.RIGHT)){var et=_.getDepth(yt.LEFT);this._seg.p0.equals(O[U])||(et=_.getDepth(yt.RIGHT));var rt=new Ur(this._seg,et);M.add(rt)}}else if(Ot(arguments[2],Ze)&&arguments[0]instanceof nt&&Ot(arguments[1],Ze))for(var dt=arguments[0],xt=arguments[2],Pt=arguments[1].iterator();Pt.hasNext();){var Mt=Pt.next();Mt.isForward()&&this.findStabbedSegments(dt,Mt,xt)}}}},{key:"getDepth",value:function(a){var t=this.findStabbedSegments(a);return t.size()===0?0:Rn.min(t)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new Oe;var a=arguments[0];this._subgraphs=a}}])}(),Ur=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"compareTo",value:function(a){var t=a;if(this._upwardSeg.minX()>=t._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=t._upwardSeg.minX())return-1;var e=this._upwardSeg.orientationIndex(t._upwardSeg);return e!==0||(e=-1*t._upwardSeg.orientationIndex(this._upwardSeg))!==0?e:this._upwardSeg.compareTo(t._upwardSeg)}},{key:"compareX",value:function(a,t){var e=a.p0.compareTo(t.p0);return e!==0?e:a.p1.compareTo(t.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[$]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var a=arguments[0],t=arguments[1];this._upwardSeg=new Oe(a),this._leftDepth=t}}])}();Ae.DepthSegment=Ur;var Zr=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,null,[{key:"constructor_",value:function(){N.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}])}(N),Yr=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"getY",value:function(){var t=this.y/this.w;if(J.isNaN(t)||J.isInfinite(t))throw new Zr;return t}},{key:"getX",value:function(){var t=this.x/this.w;if(J.isNaN(t)||J.isInfinite(t))throw new Zr;return t}},{key:"getCoordinate",value:function(){var t=new nt;return t.x=this.getX(),t.y=this.getY(),t}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],s=arguments[1];this.x=e,this.y=s,this.w=1}else if(arguments[0]instanceof a&&arguments[1]instanceof a){var c=arguments[0],p=arguments[1];this.x=c.y*p.w-p.y*c.w,this.y=p.x*c.w-c.x*p.w,this.w=c.x*p.y-p.x*c.y}else if(arguments[0]instanceof nt&&arguments[1]instanceof nt){var _=arguments[0],M=arguments[1];this.x=_.y-M.y,this.y=M.x-_.x,this.w=_.x*M.y-M.x*_.y}}else if(arguments.length===3){var O=arguments[0],U=arguments[1],et=arguments[2];this.x=O,this.y=U,this.w=et}else if(arguments.length===4){var rt=arguments[0],dt=arguments[1],xt=arguments[2],Pt=arguments[3],Mt=rt.y-dt.y,Vt=dt.x-rt.x,Ht=rt.x*dt.y-dt.x*rt.y,te=xt.y-Pt.y,ie=Pt.x-xt.x,de=xt.x*Pt.y-Pt.x*xt.y;this.x=Vt*de-ie*Ht,this.y=te*Ht-Mt*de,this.w=Mt*ie-te*Vt}}}])}(),Vr=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"area",value:function(){return a.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return a.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(t){if(t===null)throw new B("Supplied point is null.");return a.interpolateZ(t,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return a.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return a.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return a.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return a.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return a.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return a.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var t=arguments[0],e=arguments[1],s=arguments[2];this.p0=t,this.p1=e,this.p2=s}},{key:"area",value:function(t,e,s){return Math.abs(((s.x-t.x)*(e.y-t.y)-(e.x-t.x)*(s.y-t.y))/2)}},{key:"signedArea",value:function(t,e,s){return((s.x-t.x)*(e.y-t.y)-(e.x-t.x)*(s.y-t.y))/2}},{key:"det",value:function(t,e,s,c){return t*c-e*s}},{key:"interpolateZ",value:function(t,e,s,c){var p=e.x,_=e.y,M=s.x-p,O=c.x-p,U=s.y-_,et=c.y-_,rt=M*et-O*U,dt=t.x-p,xt=t.y-_,Pt=(et*dt-O*xt)/rt,Mt=(-U*dt+M*xt)/rt;return e.getZ()+Pt*(s.getZ()-e.getZ())+Mt*(c.getZ()-e.getZ())}},{key:"longestSideLength",value:function(t,e,s){var c=t.distance(e),p=e.distance(s),_=s.distance(t),M=c;return p>M&&(M=p),_>M&&(M=_),M}},{key:"circumcentreDD",value:function(t,e,s){var c=Ct.valueOf(t.x).subtract(s.x),p=Ct.valueOf(t.y).subtract(s.y),_=Ct.valueOf(e.x).subtract(s.x),M=Ct.valueOf(e.y).subtract(s.y),O=Ct.determinant(c,p,_,M).multiply(2),U=c.sqr().add(p.sqr()),et=_.sqr().add(M.sqr()),rt=Ct.determinant(p,U,M,et),dt=Ct.determinant(c,U,_,et),xt=Ct.valueOf(s.x).subtract(rt.divide(O)).doubleValue(),Pt=Ct.valueOf(s.y).add(dt.divide(O)).doubleValue();return new nt(xt,Pt)}},{key:"isAcute",value:function(t,e,s){return!!he.isAcute(t,e,s)&&!!he.isAcute(e,s,t)&&!!he.isAcute(s,t,e)}},{key:"circumcentre",value:function(t,e,s){var c=s.x,p=s.y,_=t.x-c,M=t.y-p,O=e.x-c,U=e.y-p,et=2*a.det(_,M,O,U),rt=a.det(M,_*_+M*M,U,O*O+U*U),dt=a.det(_,_*_+M*M,O,O*O+U*U);return new nt(c-rt/et,p+dt/et)}},{key:"perpendicularBisector",value:function(t,e){var s=e.x-t.x,c=e.y-t.y,p=new Yr(t.x+s/2,t.y+c/2,1),_=new Yr(t.x-c+s/2,t.y+s+c/2,1);return new Yr(p,_)}},{key:"angleBisector",value:function(t,e,s){var c=e.distance(t),p=c/(c+e.distance(s)),_=s.x-t.x,M=s.y-t.y;return new nt(t.x+p*_,t.y+p*M)}},{key:"area3D",value:function(t,e,s){var c=e.x-t.x,p=e.y-t.y,_=e.getZ()-t.getZ(),M=s.x-t.x,O=s.y-t.y,U=s.getZ()-t.getZ(),et=p*U-_*O,rt=_*M-c*U,dt=c*O-p*M,xt=et*et+rt*rt+dt*dt,Pt=Math.sqrt(xt)/2;return Pt}},{key:"centroid",value:function(t,e,s){var c=(t.x+e.x+s.x)/3,p=(t.y+e.y+s.y)/3;return new nt(c,p)}},{key:"inCentre",value:function(t,e,s){var c=e.distance(s),p=t.distance(s),_=t.distance(e),M=c+p+_,O=(c*t.x+p*e.x+_*s.x)/M,U=(c*t.y+p*e.y+_*s.y)/M;return new nt(O,U)}}])}(),Xr=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"addRingSide",value:function(a,t,e,s,c){if(t===0&&a.length<Xe.MINIMUM_VALID_SIZE)return null;var p=s,_=c;a.length>=Xe.MINIMUM_VALID_SIZE&&Tt.isCCW(a)&&(p=c,_=s,e=yt.opposite(e));var M=this._curveBuilder.getRingCurve(a,e,t);this.addCurve(M,p,_)}},{key:"addRingBothSides",value:function(a,t){this.addRingSide(a,t,yt.LEFT,K.EXTERIOR,K.INTERIOR),this.addRingSide(a,t,yt.RIGHT,K.INTERIOR,K.EXTERIOR)}},{key:"addPoint",value:function(a){if(this._distance<=0)return null;var t=a.getCoordinates(),e=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(e,K.EXTERIOR,K.INTERIOR)}},{key:"addPolygon",value:function(a){var t=this._distance,e=yt.LEFT;this._distance<0&&(t=-this._distance,e=yt.RIGHT);var s=a.getExteriorRing(),c=ue.removeRepeatedPoints(s.getCoordinates());if(this._distance<0&&this.isErodedCompletely(s,this._distance)||this._distance<=0&&c.length<3)return null;this.addRingSide(c,t,e,K.EXTERIOR,K.INTERIOR);for(var p=0;p<a.getNumInteriorRing();p++){var _=a.getInteriorRingN(p),M=ue.removeRepeatedPoints(_.getCoordinates());this._distance>0&&this.isErodedCompletely(_,-this._distance)||this.addRingSide(M,t,yt.opposite(e),K.INTERIOR,K.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(a,t){var e=new Vr(a[0],a[1],a[2]),s=e.inCentre();return He.pointToSegment(s,e.p0,e.p1)<Math.abs(t)}},{key:"addLineString",value:function(a){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var t=ue.removeRepeatedPoints(a.getCoordinates());if(ue.isRing(t)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(t,this._distance);else{var e=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(e,K.EXTERIOR,K.INTERIOR)}}},{key:"addCurve",value:function(a,t,e){if(a===null||a.length<2)return null;var s=new cn(a,new Se(0,K.BOUNDARY,t,e));this._curveList.add(s)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(a){if(a.isEmpty())return null;if(a instanceof pi)this.addPolygon(a);else if(a instanceof mi)this.addLineString(a);else if(a instanceof Lr)this.addPoint(a);else if(a instanceof Bi)this.addCollection(a);else if(a instanceof qi)this.addCollection(a);else if(a instanceof Cr)this.addCollection(a);else{if(!(a instanceof Ee))throw new St(a.getGeometryType());this.addCollection(a)}}},{key:"isErodedCompletely",value:function(a,t){var e=a.getCoordinates();if(e.length<4)return t<0;if(e.length===4)return this.isTriangleErodedCompletely(e,t);var s=a.getEnvelopeInternal(),c=Math.min(s.getHeight(),s.getWidth());return t<0&&2*Math.abs(t)>c}},{key:"addCollection",value:function(a){for(var t=0;t<a.getNumGeometries();t++){var e=a.getGeometryN(t);this.add(e)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new It;var a=arguments[0],t=arguments[1],e=arguments[2];this._inputGeom=a,this._distance=t,this._curveBuilder=e}}])}(),Oo=function(){return d(function a(){u(this,a)},[{key:"locate",value:function(a){}}])}(),Ao=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,a.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new qt;var t=this._parent.getGeometryN(this._index++);return t instanceof Ee?(this._subcollectionIterator=new a(t),this._subcollectionIterator.next()):t}},{key:"remove",value:function(){throw new St(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[To]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()}},{key:"isAtomic",value:function(t){return!(t instanceof Ee)}}])}(),bs=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"locate",value:function(t){return a.locate(t,this._geom)}},{key:"interfaces_",get:function(){return[Oo]}}],[{key:"constructor_",value:function(){this._geom=null;var t=arguments[0];this._geom=t}},{key:"locatePointInPolygon",value:function(t,e){if(e.isEmpty())return K.EXTERIOR;var s=e.getExteriorRing(),c=a.locatePointInRing(t,s);if(c!==K.INTERIOR)return c;for(var p=0;p<e.getNumInteriorRing();p++){var _=e.getInteriorRingN(p),M=a.locatePointInRing(t,_);if(M===K.BOUNDARY)return K.BOUNDARY;if(M===K.INTERIOR)return K.EXTERIOR}return K.INTERIOR}},{key:"locatePointInRing",value:function(t,e){return e.getEnvelopeInternal().intersects(t)?Qn.locateInRing(t,e.getCoordinates()):K.EXTERIOR}},{key:"containsPointInPolygon",value:function(t,e){return K.EXTERIOR!==a.locatePointInPolygon(t,e)}},{key:"locateInGeometry",value:function(t,e){if(e instanceof pi)return a.locatePointInPolygon(t,e);if(e instanceof Ee)for(var s=new Ao(e);s.hasNext();){var c=s.next();if(c!==e){var p=a.locateInGeometry(t,c);if(p!==K.EXTERIOR)return p}}return K.EXTERIOR}},{key:"isContained",value:function(t,e){return K.EXTERIOR!==a.locate(t,e)}},{key:"locate",value:function(t,e){return e.isEmpty()?K.EXTERIOR:e.getEnvelopeInternal().intersects(t)?a.locateInGeometry(t,e):K.EXTERIOR}}])}(),Do=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"getNextCW",value:function(a){this.getEdges();var t=this._edgeList.indexOf(a),e=t-1;return t===0&&(e=this._edgeList.size()-1),this._edgeList.get(e)}},{key:"propagateSideLabels",value:function(a){for(var t=K.NONE,e=this.iterator();e.hasNext();){var s=e.next().getLabel();s.isArea(a)&&s.getLocation(a,yt.LEFT)!==K.NONE&&(t=s.getLocation(a,yt.LEFT))}if(t===K.NONE)return null;for(var c=t,p=this.iterator();p.hasNext();){var _=p.next(),M=_.getLabel();if(M.getLocation(a,yt.ON)===K.NONE&&M.setLocation(a,yt.ON,c),M.isArea(a)){var O=M.getLocation(a,yt.LEFT),U=M.getLocation(a,yt.RIGHT);if(U!==K.NONE){if(U!==c)throw new Ve("side location conflict",_.getCoordinate());O===K.NONE&&ht.shouldNeverReachHere("found single null side (at "+_.getCoordinate()+")"),c=O}else ht.isTrue(M.getLocation(a,yt.LEFT)===K.NONE,"found single null side"),M.setLocation(a,yt.RIGHT,c),M.setLocation(a,yt.LEFT,c)}}}},{key:"getCoordinate",value:function(){var a=this.iterator();return a.hasNext()?a.next().getCoordinate():null}},{key:"print",value:function(a){Fe.out.println("EdgeEndStar:   "+this.getCoordinate());for(var t=this.iterator();t.hasNext();)t.next().print(a)}},{key:"isAreaLabelsConsistent",value:function(a){return this.computeEdgeEndLabels(a.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(a){var t=this.getEdges();if(t.size()<=0)return!0;var e=t.size()-1,s=t.get(e).getLabel().getLocation(a,yt.LEFT);ht.isTrue(s!==K.NONE,"Found unlabelled area edge");for(var c=s,p=this.iterator();p.hasNext();){var _=p.next().getLabel();ht.isTrue(_.isArea(a),"Found non-area edge");var M=_.getLocation(a,yt.LEFT),O=_.getLocation(a,yt.RIGHT);if(M===O||O!==c)return!1;c=M}return!0}},{key:"findIndex",value:function(a){this.iterator();for(var t=0;t<this._edgeList.size();t++)if(this._edgeList.get(t)===a)return t;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new It(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(a,t,e){return this._ptInAreaLocation[a]===K.NONE&&(this._ptInAreaLocation[a]=bs.locate(t,e[a].getGeometry())),this._ptInAreaLocation[a]}},{key:"toString",value:function(){var a=new pn;a.append("EdgeEndStar:   "+this.getCoordinate()),a.append(`
`);for(var t=this.iterator();t.hasNext();){var e=t.next();a.append(e),a.append(`
`)}return a.toString()}},{key:"computeEdgeEndLabels",value:function(a){for(var t=this.iterator();t.hasNext();)t.next().computeLabel(a)}},{key:"computeLabelling",value:function(a){this.computeEdgeEndLabels(a[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var t=[!1,!1],e=this.iterator();e.hasNext();)for(var s=e.next().getLabel(),c=0;c<2;c++)s.isLine(c)&&s.getLocation(c)===K.BOUNDARY&&(t[c]=!0);for(var p=this.iterator();p.hasNext();)for(var _=p.next(),M=_.getLabel(),O=0;O<2;O++)if(M.isAnyNull(O)){var U=K.NONE;if(t[O])U=K.EXTERIOR;else{var et=_.getCoordinate();U=this.getLocation(O,et,a)}M.setAllLocationsIfNull(O,U)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(a,t){this._edgeMap.put(a,t),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new re,this._edgeList=null,this._ptInAreaLocation=[K.NONE,K.NONE]}}])}(),Ue=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var e=null,s=null,c=this._SCANNING_FOR_INCOMING,p=0;p<this._resultAreaEdgeList.size();p++){var _=this._resultAreaEdgeList.get(p),M=_.getSym();if(_.getLabel().isArea())switch(e===null&&_.isInResult()&&(e=_),c){case this._SCANNING_FOR_INCOMING:if(!M.isInResult())continue;s=M,c=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!_.isInResult())continue;s.setNext(_),c=this._SCANNING_FOR_INCOMING}}if(c===this._LINKING_TO_OUTGOING){if(e===null)throw new Ve("no outgoing dirEdge found",this.getCoordinate());ht.isTrue(e.isInResult(),"unable to link last incoming dirEdge"),s.setNext(e)}}},{key:"insert",value:function(e){var s=e;this.insertEdgeEnd(s,s)}},{key:"getRightmostEdge",value:function(){var e=this.getEdges(),s=e.size();if(s<1)return null;var c=e.get(0);if(s===1)return c;var p=e.get(s-1),_=c.getQuadrant(),M=p.getQuadrant();return ye.isNorthern(_)&&ye.isNorthern(M)?c:ye.isNorthern(_)||ye.isNorthern(M)?c.getDy()!==0?c:p.getDy()!==0?p:(ht.shouldNeverReachHere("found two horizontal edges incident on node"),null):p}},{key:"print",value:function(e){Fe.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var s=this.iterator();s.hasNext();){var c=s.next();e.print("out "),c.print(e),e.println(),e.print("in "),c.getSym().print(e),e.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new It;for(var e=this.iterator();e.hasNext();){var s=e.next();(s.isInResult()||s.getSym().isInResult())&&this._resultAreaEdgeList.add(s)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(e){for(var s=this.iterator();s.hasNext();){var c=s.next().getLabel();c.setAllLocationsIfNull(0,e.getLocation(0)),c.setAllLocationsIfNull(1,e.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var e=null,s=null,c=this._edgeList.size()-1;c>=0;c--){var p=this._edgeList.get(c),_=p.getSym();s===null&&(s=_),e!==null&&_.setNext(e),e=p}s.setNext(e)}},{key:"computeDepths",value:function(){if(arguments.length===1){var e=arguments[0],s=this.findIndex(e),c=e.getDepth(yt.LEFT),p=e.getDepth(yt.RIGHT),_=this.computeDepths(s+1,this._edgeList.size(),c);if(this.computeDepths(0,s,_)!==p)throw new Ve("depth mismatch at "+e.getCoordinate())}else if(arguments.length===3){for(var M=arguments[1],O=arguments[2],U=arguments[0];U<M;U++){var et=this._edgeList.get(U);et.setEdgeDepths(yt.RIGHT,O),O=et.getDepth(yt.LEFT)}return O}}},{key:"mergeSymLabels",value:function(){for(var e=this.iterator();e.hasNext();){var s=e.next();s.getLabel().merge(s.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(e){for(var s=null,c=null,p=this._SCANNING_FOR_INCOMING,_=this._resultAreaEdgeList.size()-1;_>=0;_--){var M=this._resultAreaEdgeList.get(_),O=M.getSym();switch(s===null&&M.getEdgeRing()===e&&(s=M),p){case this._SCANNING_FOR_INCOMING:if(O.getEdgeRing()!==e)continue;c=O,p=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(M.getEdgeRing()!==e)continue;c.setNextMin(M),p=this._SCANNING_FOR_INCOMING}}p===this._LINKING_TO_OUTGOING&&(ht.isTrue(s!==null,"found null for first outgoing dirEdge"),ht.isTrue(s.getEdgeRing()===e,"unable to link last incoming dirEdge"),c.setNextMin(s))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var e=0,s=this.iterator();s.hasNext();)s.next().isInResult()&&e++;return e}if(arguments.length===1){for(var c=arguments[0],p=0,_=this.iterator();_.hasNext();)_.next().getEdgeRing()===c&&p++;return p}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var e=K.NONE,s=this.iterator();s.hasNext();){var c=s.next(),p=c.getSym();if(!c.isLineEdge()){if(c.isInResult()){e=K.INTERIOR;break}if(p.isInResult()){e=K.EXTERIOR;break}}}if(e===K.NONE)return null;for(var _=e,M=this.iterator();M.hasNext();){var O=M.next(),U=O.getSym();O.isLineEdge()?O.getEdge().setCovered(_===K.INTERIOR):(O.isInResult()&&(_=K.EXTERIOR),U.isInResult()&&(_=K.INTERIOR))}}},{key:"computeLabelling",value:function(e){D(t,"computeLabelling",this,1).call(this,e),this._label=new Se(K.NONE);for(var s=this.iterator();s.hasNext();)for(var c=s.next().getEdge().getLabel(),p=0;p<2;p++){var _=c.getLocation(p);_!==K.INTERIOR&&_!==K.BOUNDARY||this._label.setLocation(p,K.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}])}(Do),ei=function(a){function t(){return u(this,t),o(this,t)}return I(t,a),d(t,[{key:"createNode",value:function(e){return new ki(e,new Ue)}}])}(Fr),Ts=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"compareTo",value:function(t){var e=t;return a.compareOriented(this._pts,this._orientation,e._pts,e._orientation)}},{key:"interfaces_",get:function(){return[$]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=a.orientation(t)}},{key:"orientation",value:function(t){return ue.increasingDirection(t)===1}},{key:"compareOriented",value:function(t,e,s,c){for(var p=e?1:-1,_=c?1:-1,M=e?t.length:-1,O=c?s.length:-1,U=e?0:t.length-1,et=c?0:s.length-1;;){var rt=t[U].compareTo(s[et]);if(rt!==0)return rt;var dt=(U+=p)===M,xt=(et+=_)===O;if(dt&&!xt)return-1;if(!dt&&xt)return 1;if(dt&&xt)return 0}}}])}(),fn=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"print",value:function(a){a.print("MULTILINESTRING ( ");for(var t=0;t<this._edges.size();t++){var e=this._edges.get(t);t>0&&a.print(","),a.print("(");for(var s=e.getCoordinates(),c=0;c<s.length;c++)c>0&&a.print(","),a.print(s[c].x+" "+s[c].y);a.println(")")}a.print(")  ")}},{key:"addAll",value:function(a){for(var t=a.iterator();t.hasNext();)this.add(t.next())}},{key:"findEdgeIndex",value:function(a){for(var t=0;t<this._edges.size();t++)if(this._edges.get(t).equals(a))return t;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(a){return this._edges.get(a)}},{key:"findEqualEdge",value:function(a){var t=new Ts(a.getCoordinates());return this._ocaMap.get(t)}},{key:"add",value:function(a){this._edges.add(a);var t=new Ts(a.getCoordinates());this._ocaMap.put(t,a)}}],[{key:"constructor_",value:function(){this._edges=new It,this._ocaMap=new re}}])}(),Ns=function(){return d(function a(){u(this,a)},[{key:"processIntersections",value:function(a,t,e,s){}},{key:"isDone",value:function(){}}])}(),ni=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"isTrivialIntersection",value:function(t,e,s,c){if(t===s&&this._li.getIntersectionNum()===1){if(a.isAdjacentSegments(e,c))return!0;if(t.isClosed()){var p=t.size()-1;if(e===0&&c===p||c===0&&e===p)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(t,e,s,c){if(t===s&&e===c)return null;this.numTests++;var p=t.getCoordinates()[e],_=t.getCoordinates()[e+1],M=s.getCoordinates()[c],O=s.getCoordinates()[c+1];this._li.computeIntersection(p,_,M,O),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,s,c)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),s.addIntersections(this._li,c,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[Ns]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t}},{key:"isAdjacentSegments",value:function(t,e){return Math.abs(t-e)===1}}])}(),Ro=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(a){a.print(this.coord),a.print(" seg # = "+this.segmentIndex),a.println(" dist = "+this.dist)}},{key:"compareTo",value:function(a){var t=a;return this.compare(t.segmentIndex,t.dist)}},{key:"isEndPoint",value:function(a){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===a}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(a,t){return this.segmentIndex<a?-1:this.segmentIndex>a?1:this.dist<t?-1:this.dist>t?1:0}},{key:"interfaces_",get:function(){return[$]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var a=arguments[0],t=arguments[1],e=arguments[2];this.coord=new nt(a),this.segmentIndex=t,this.dist=e}}])}(),Mi=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"print",value:function(a){a.println("Intersections:");for(var t=this.iterator();t.hasNext();)t.next().print(a)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(a){this.addEndpoints();for(var t=this.iterator(),e=t.next();t.hasNext();){var s=t.next(),c=this.createSplitEdge(e,s);a.add(c),e=s}}},{key:"addEndpoints",value:function(){var a=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[a],a,0)}},{key:"createSplitEdge",value:function(a,t){var e=t.segmentIndex-a.segmentIndex+2,s=this.edge.pts[t.segmentIndex],c=t.dist>0||!t.coord.equals2D(s);c||e--;var p=new Array(e).fill(null),_=0;p[_++]=new nt(a.coord);for(var M=a.segmentIndex+1;M<=t.segmentIndex;M++)p[_++]=this.edge.pts[M];return c&&(p[_]=t.coord),new As(p,new Se(this.edge._label))}},{key:"add",value:function(a,t,e){var s=new Ro(a,t,e),c=this._nodeMap.get(s);return c!==null?c:(this._nodeMap.put(s,s),s)}},{key:"isIntersection",value:function(a){for(var t=this.iterator();t.hasNext();)if(t.next().coord.equals(a))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new re,this.edge=null;var a=arguments[0];this.edge=a}}])}(),Os=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(a.isTrue(this._matrix[K.INTERIOR][K.INTERIOR])||a.isTrue(this._matrix[K.INTERIOR][K.BOUNDARY])||a.isTrue(this._matrix[K.BOUNDARY][K.INTERIOR])||a.isTrue(this._matrix[K.BOUNDARY][K.BOUNDARY]))&&this._matrix[K.EXTERIOR][K.INTERIOR]===_t.FALSE&&this._matrix[K.EXTERIOR][K.BOUNDARY]===_t.FALSE}},{key:"isCoveredBy",value:function(){return(a.isTrue(this._matrix[K.INTERIOR][K.INTERIOR])||a.isTrue(this._matrix[K.INTERIOR][K.BOUNDARY])||a.isTrue(this._matrix[K.BOUNDARY][K.INTERIOR])||a.isTrue(this._matrix[K.BOUNDARY][K.BOUNDARY]))&&this._matrix[K.INTERIOR][K.EXTERIOR]===_t.FALSE&&this._matrix[K.BOUNDARY][K.EXTERIOR]===_t.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var t=arguments[0],e=0;e<t.length;e++){var s=Math.trunc(e/3),c=e%3;this._matrix[s][c]=_t.toDimensionValue(t.charAt(e))}else if(arguments.length===3){var p=arguments[0],_=arguments[1],M=arguments[2];this._matrix[p][_]=M}}},{key:"isContains",value:function(){return a.isTrue(this._matrix[K.INTERIOR][K.INTERIOR])&&this._matrix[K.EXTERIOR][K.INTERIOR]===_t.FALSE&&this._matrix[K.EXTERIOR][K.BOUNDARY]===_t.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var t=arguments[0],e=0;e<t.length;e++){var s=Math.trunc(e/3),c=e%3;this.setAtLeast(s,c,_t.toDimensionValue(t.charAt(e)))}else if(arguments.length===3){var p=arguments[0],_=arguments[1],M=arguments[2];this._matrix[p][_]<M&&(this._matrix[p][_]=M)}}},{key:"setAtLeastIfValid",value:function(t,e,s){t>=0&&e>=0&&this.setAtLeast(t,e,s)}},{key:"isWithin",value:function(){return a.isTrue(this._matrix[K.INTERIOR][K.INTERIOR])&&this._matrix[K.INTERIOR][K.EXTERIOR]===_t.FALSE&&this._matrix[K.BOUNDARY][K.EXTERIOR]===_t.FALSE}},{key:"isTouches",value:function(t,e){return t>e?this.isTouches(e,t):(t===_t.A&&e===_t.A||t===_t.L&&e===_t.L||t===_t.L&&e===_t.A||t===_t.P&&e===_t.A||t===_t.P&&e===_t.L)&&this._matrix[K.INTERIOR][K.INTERIOR]===_t.FALSE&&(a.isTrue(this._matrix[K.INTERIOR][K.BOUNDARY])||a.isTrue(this._matrix[K.BOUNDARY][K.INTERIOR])||a.isTrue(this._matrix[K.BOUNDARY][K.BOUNDARY]))}},{key:"isOverlaps",value:function(t,e){return t===_t.P&&e===_t.P||t===_t.A&&e===_t.A?a.isTrue(this._matrix[K.INTERIOR][K.INTERIOR])&&a.isTrue(this._matrix[K.INTERIOR][K.EXTERIOR])&&a.isTrue(this._matrix[K.EXTERIOR][K.INTERIOR]):t===_t.L&&e===_t.L&&this._matrix[K.INTERIOR][K.INTERIOR]===1&&a.isTrue(this._matrix[K.INTERIOR][K.EXTERIOR])&&a.isTrue(this._matrix[K.EXTERIOR][K.INTERIOR])}},{key:"isEquals",value:function(t,e){return t===e&&a.isTrue(this._matrix[K.INTERIOR][K.INTERIOR])&&this._matrix[K.INTERIOR][K.EXTERIOR]===_t.FALSE&&this._matrix[K.BOUNDARY][K.EXTERIOR]===_t.FALSE&&this._matrix[K.EXTERIOR][K.INTERIOR]===_t.FALSE&&this._matrix[K.EXTERIOR][K.BOUNDARY]===_t.FALSE}},{key:"toString",value:function(){for(var t=new Hi("123456789"),e=0;e<3;e++)for(var s=0;s<3;s++)t.setCharAt(3*e+s,_t.toDimensionSymbol(this._matrix[e][s]));return t.toString()}},{key:"setAll",value:function(t){for(var e=0;e<3;e++)for(var s=0;s<3;s++)this._matrix[e][s]=t}},{key:"get",value:function(t,e){return this._matrix[t][e]}},{key:"transpose",value:function(){var t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}},{key:"matches",value:function(t){if(t.length!==9)throw new B("Should be length 9: "+t);for(var e=0;e<3;e++)for(var s=0;s<3;s++)if(!a.matches(this._matrix[e][s],t.charAt(3*e+s)))return!1;return!0}},{key:"add",value:function(t){for(var e=0;e<3;e++)for(var s=0;s<3;s++)this.setAtLeast(e,s,t.get(e,s))}},{key:"isDisjoint",value:function(){return this._matrix[K.INTERIOR][K.INTERIOR]===_t.FALSE&&this._matrix[K.INTERIOR][K.BOUNDARY]===_t.FALSE&&this._matrix[K.BOUNDARY][K.INTERIOR]===_t.FALSE&&this._matrix[K.BOUNDARY][K.BOUNDARY]===_t.FALSE}},{key:"isCrosses",value:function(t,e){return t===_t.P&&e===_t.L||t===_t.P&&e===_t.A||t===_t.L&&e===_t.A?a.isTrue(this._matrix[K.INTERIOR][K.INTERIOR])&&a.isTrue(this._matrix[K.INTERIOR][K.EXTERIOR]):t===_t.L&&e===_t.P||t===_t.A&&e===_t.P||t===_t.A&&e===_t.L?a.isTrue(this._matrix[K.INTERIOR][K.INTERIOR])&&a.isTrue(this._matrix[K.EXTERIOR][K.INTERIOR]):t===_t.L&&e===_t.L&&this._matrix[K.INTERIOR][K.INTERIOR]===0}},{key:"interfaces_",get:function(){return[P]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(_t.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var t=arguments[0];a.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof a){var e=arguments[0];a.constructor_.call(this),this._matrix[K.INTERIOR][K.INTERIOR]=e._matrix[K.INTERIOR][K.INTERIOR],this._matrix[K.INTERIOR][K.BOUNDARY]=e._matrix[K.INTERIOR][K.BOUNDARY],this._matrix[K.INTERIOR][K.EXTERIOR]=e._matrix[K.INTERIOR][K.EXTERIOR],this._matrix[K.BOUNDARY][K.INTERIOR]=e._matrix[K.BOUNDARY][K.INTERIOR],this._matrix[K.BOUNDARY][K.BOUNDARY]=e._matrix[K.BOUNDARY][K.BOUNDARY],this._matrix[K.BOUNDARY][K.EXTERIOR]=e._matrix[K.BOUNDARY][K.EXTERIOR],this._matrix[K.EXTERIOR][K.INTERIOR]=e._matrix[K.EXTERIOR][K.INTERIOR],this._matrix[K.EXTERIOR][K.BOUNDARY]=e._matrix[K.EXTERIOR][K.BOUNDARY],this._matrix[K.EXTERIOR][K.EXTERIOR]=e._matrix[K.EXTERIOR][K.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var t=arguments[0],e=arguments[1];return e===_t.SYM_DONTCARE||e===_t.SYM_TRUE&&(t>=0||t===_t.TRUE)||e===_t.SYM_FALSE&&t===_t.FALSE||e===_t.SYM_P&&t===_t.P||e===_t.SYM_L&&t===_t.L||e===_t.SYM_A&&t===_t.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var s=arguments[1];return new a(arguments[0]).matches(s)}}},{key:"isTrue",value:function(t){return t>=0||t===_t.TRUE}}])}(),ji=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(t){return t===null||t.length===0?null:(this.ensureCapacity(this._size+t.length),Fe.arraycopy(t,0,this._data,this._size,t.length),void(this._size+=t.length))}},{key:"ensureCapacity",value:function(t){if(t<=this._data.length)return null;var e=Math.max(t,2*this._data.length);this._data=me.copyOf(this._data,e)}},{key:"toArray",value:function(){var t=new Array(this._size).fill(null);return Fe.arraycopy(this._data,0,t,0,this._size),t}},{key:"add",value:function(t){this.ensureCapacity(this._size+1),this._data[this._size]=t,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)a.constructor_.call(this,10);else if(arguments.length===1){var t=arguments[0];this._data=new Array(t).fill(null)}}}])}(),Fo=function(){function a(){u(this,a)}return d(a,[{key:"getChainStartIndices",value:function(t){var e=0,s=new ji(Math.trunc(t.length/2));s.add(e);do{var c=this.findChainEnd(t,e);s.add(c),e=c}while(e<t.length-1);return s.toArray()}},{key:"findChainEnd",value:function(t,e){for(var s=ye.quadrant(t[e],t[e+1]),c=e+1;c<t.length&&ye.quadrant(t[c-1],t[c])===s;)c++;return c-1}},{key:"OLDgetChainStartIndices",value:function(t){var e=0,s=new It;s.add(e);do{var c=this.findChainEnd(t,e);s.add(c),e=c}while(e<t.length-1);return a.toIntArray(s)}}],[{key:"toIntArray",value:function(t){for(var e=new Array(t.size()).fill(null),s=0;s<e.length;s++)e[s]=t.get(s).intValue();return e}}])}(),wn=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(a){var t=this.pts[this.startIndex[a]].x,e=this.pts[this.startIndex[a+1]].x;return t>e?t:e}},{key:"getMinX",value:function(a){var t=this.pts[this.startIndex[a]].x,e=this.pts[this.startIndex[a+1]].x;return t<e?t:e}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var a=arguments[0],t=arguments[1],e=arguments[2],s=arguments[3];this.computeIntersectsForChain(this.startIndex[a],this.startIndex[a+1],t,t.startIndex[e],t.startIndex[e+1],s)}else if(arguments.length===6){var c=arguments[0],p=arguments[1],_=arguments[2],M=arguments[3],O=arguments[4],U=arguments[5];if(p-c==1&&O-M==1)return U.addIntersections(this.e,c,_.e,M),null;if(!this.overlaps(c,p,_,M,O))return null;var et=Math.trunc((c+p)/2),rt=Math.trunc((M+O)/2);c<et&&(M<rt&&this.computeIntersectsForChain(c,et,_,M,rt,U),rt<O&&this.computeIntersectsForChain(c,et,_,rt,O,U)),et<p&&(M<rt&&this.computeIntersectsForChain(et,p,_,M,rt,U),rt<O&&this.computeIntersectsForChain(et,p,_,rt,O,U))}}},{key:"overlaps",value:function(a,t,e,s,c){return bt.intersects(this.pts[a],this.pts[t],e.pts[s],e.pts[c])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(a,t){for(var e=0;e<this.startIndex.length-1;e++)for(var s=0;s<a.startIndex.length-1;s++)this.computeIntersectsForChain(e,a,s,t)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var a=arguments[0];this.e=a,this.pts=a.getCoordinates();var t=new Fo;this.startIndex=t.getChainStartIndices(this.pts)}}])}(),Ii=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"getDepth",value:function(t,e){return this._depth[t][e]}},{key:"setDepth",value:function(t,e,s){this._depth[t][e]=s}},{key:"isNull",value:function(){if(arguments.length===0){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==a.NULL_VALUE)return!1;return!0}if(arguments.length===1){var s=arguments[0];return this._depth[s][1]===a.NULL_VALUE}if(arguments.length===2){var c=arguments[0],p=arguments[1];return this._depth[c][p]===a.NULL_VALUE}}},{key:"normalize",value:function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var s=1;s<3;s++){var c=0;this._depth[t][s]>e&&(c=1),this._depth[t][s]=c}}}},{key:"getDelta",value:function(t){return this._depth[t][yt.RIGHT]-this._depth[t][yt.LEFT]}},{key:"getLocation",value:function(t,e){return this._depth[t][e]<=0?K.EXTERIOR:K.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var t=arguments[0],e=0;e<2;e++)for(var s=1;s<3;s++){var c=t.getLocation(e,s);c!==K.EXTERIOR&&c!==K.INTERIOR||(this.isNull(e,s)?this._depth[e][s]=a.depthAtLocation(c):this._depth[e][s]+=a.depthAtLocation(c))}else if(arguments.length===3){var p=arguments[0],_=arguments[1];arguments[2]===K.INTERIOR&&this._depth[p][_]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var e=0;e<3;e++)this._depth[t][e]=a.NULL_VALUE}},{key:"depthAtLocation",value:function(t){return t===K.EXTERIOR?0:t===K.INTERIOR?1:a.NULL_VALUE}}])}();Ii.NULL_VALUE=-1;var As=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var e=new Array(2).fill(null);return e[0]=this.pts[0],e[1]=this.pts[1],new t(e,Se.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(e){this._isIsolated=e}},{key:"setName",value:function(e){this._name=e}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var s=e;if(this.pts.length!==s.pts.length)return!1;for(var c=!0,p=!0,_=this.pts.length,M=0;M<this.pts.length;M++)if(this.pts[M].equals2D(s.pts[M])||(c=!1),this.pts[M].equals2D(s.pts[--_])||(p=!1),!c&&!p)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var e=arguments[0];return this.pts[e]}}},{key:"print",value:function(e){e.print("edge "+this._name+": "),e.print("LINESTRING (");for(var s=0;s<this.pts.length;s++)s>0&&e.print(","),e.print(this.pts[s].x+" "+this.pts[s].y);e.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(e){t.updateIM(this._label,e)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(e){e.print("edge "+this._name+": ");for(var s=this.pts.length-1;s>=0;s--)e.print(this.pts[s]+" ");e.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new wn(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new bt;for(var e=0;e<this.pts.length;e++)this._env.expandToInclude(this.pts[e])}return this._env}},{key:"addIntersection",value:function(e,s,c,p){var _=new nt(e.getIntersection(p)),M=s,O=e.getEdgeDistance(c,p),U=M+1;if(U<this.pts.length){var et=this.pts[U];_.equals2D(et)&&(M=U,O=0)}this.eiList.add(_,M,O)}},{key:"toString",value:function(){var e=new Hi;e.append("edge "+this._name+": "),e.append("LINESTRING (");for(var s=0;s<this.pts.length;s++)s>0&&e.append(","),e.append(this.pts[s].x+" "+this.pts[s].y);return e.append(")  "+this._label+" "+this._depthDelta),e.toString()}},{key:"isPointwiseEqual",value:function(e){if(this.pts.length!==e.pts.length)return!1;for(var s=0;s<this.pts.length;s++)if(!this.pts[s].equals2D(e.pts[s]))return!1;return!0}},{key:"setDepthDelta",value:function(e){this._depthDelta=e}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(e,s,c){for(var p=0;p<e.getIntersectionNum();p++)this.addIntersection(e,s,c,p)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new Mi(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Ii,this._depthDelta=0,arguments.length===1){var e=arguments[0];t.constructor_.call(this,e,null)}else if(arguments.length===2){var s=arguments[0],c=arguments[1];this.pts=s,this._label=c}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Os&&arguments[0]instanceof Se))return D(t,"updateIM",this).apply(this,arguments);var e=arguments[0],s=arguments[1];s.setAtLeastIfValid(e.getLocation(0,yt.ON),e.getLocation(1,yt.ON),1),e.isArea()&&(s.setAtLeastIfValid(e.getLocation(0,yt.LEFT),e.getLocation(1,yt.LEFT),2),s.setAtLeastIfValid(e.getLocation(0,yt.RIGHT),e.getLocation(1,yt.RIGHT),2))}}])}(Qt),Qi=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"setWorkingPrecisionModel",value:function(t){this._workingPrecisionModel=t}},{key:"insertUniqueEdge",value:function(t){var e=this._edgeList.findEqualEdge(t);if(e!==null){var s=e.getLabel(),c=t.getLabel();e.isPointwiseEqual(t)||(c=new Se(t.getLabel())).flip(),s.merge(c);var p=a.depthDelta(c),_=e.getDepthDelta()+p;e.setDepthDelta(_)}else this._edgeList.add(t),t.setDepthDelta(a.depthDelta(t.getLabel()))}},{key:"buildSubgraphs",value:function(t,e){for(var s=new It,c=t.iterator();c.hasNext();){var p=c.next(),_=p.getRightmostCoordinate(),M=new Ae(s).getDepth(_);p.computeDepth(M),p.findResultEdges(),s.add(p),e.add(p.getDirectedEdges(),p.getNodes())}}},{key:"createSubgraphs",value:function(t){for(var e=new It,s=t.getNodes().iterator();s.hasNext();){var c=s.next();if(!c.isVisited()){var p=new di;p.create(c),e.add(p)}}return Rn.sort(e,Rn.reverseOrder()),e}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(t){if(this._workingNoder!==null)return this._workingNoder;var e=new Hr,s=new hn;return s.setPrecisionModel(t),e.setSegmentIntersector(new ni(s)),e}},{key:"buffer",value:function(t,e){var s=this._workingPrecisionModel;s===null&&(s=t.getPrecisionModel()),this._geomFact=t.getFactory();var c=new Li(s,this._bufParams),p=new Xr(t,e,c).getCurves();if(p.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(p,s),this._graph=new Wi(new ei),this._graph.addEdges(this._edgeList.getEdges());var _=this.createSubgraphs(this._graph),M=new Io(this._geomFact);this.buildSubgraphs(_,M);var O=M.getPolygons();return O.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(O)}},{key:"computeNodedEdges",value:function(t,e){var s=this.getNoder(e);s.computeNodes(t);for(var c=s.getNodedSubstrings().iterator();c.hasNext();){var p=c.next(),_=p.getCoordinates();if(_.length!==2||!_[0].equals2D(_[1])){var M=p.getData(),O=new As(p.getCoordinates(),new Se(M));this.insertUniqueEdge(O)}}}},{key:"setNoder",value:function(t){this._workingNoder=t}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new fn;var t=arguments[0];this._bufParams=t}},{key:"depthDelta",value:function(t){var e=t.getLocation(0,yt.LEFT),s=t.getLocation(0,yt.RIGHT);return e===K.INTERIOR&&s===K.EXTERIOR?1:e===K.EXTERIOR&&s===K.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(t){for(var e=new We,s=new It;t.hasNext();){var c=t.next(),p=e.createLineString(c.getCoordinates());s.add(p)}return e.buildGeometry(s)}}])}(),Bo=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"rescale",value:function(){if(Ot(arguments[0],Rt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var s=arguments[0],c=0;c<s.length;c++)s[c].x=s[c].x/this._scaleFactor+this._offsetX,s[c].y=s[c].y/this._scaleFactor+this._offsetY;s.length===2&&s[0].equals2D(s[1])&&Fe.out.println(s)}}},{key:"scale",value:function(){if(Ot(arguments[0],Rt)){for(var t=arguments[0],e=new It(t.size()),s=t.iterator();s.hasNext();){var c=s.next();e.add(new cn(this.scale(c.getCoordinates()),c.getData()))}return e}if(arguments[0]instanceof Array){for(var p=arguments[0],_=new Array(p.length).fill(null),M=0;M<p.length;M++)_[M]=new nt(Math.round((p[M].x-this._offsetX)*this._scaleFactor),Math.round((p[M].y-this._offsetY)*this._scaleFactor),p[M].getZ());return ue.removeRepeatedPoints(_)}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t}},{key:"computeNodes",value:function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)}},{key:"interfaces_",get:function(){return[Gr]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var t=arguments[0],e=arguments[1];a.constructor_.call(this,t,e,0,0)}else if(arguments.length===4){var s=arguments[0],c=arguments[1];this._noder=s,this._scaleFactor=c,this._isScaled=!this.isIntegerPrecision()}}}])}(),Qe=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(arguments.length===2){for(var s=arguments[0],c=arguments[1].iterator();c.hasNext();)for(var p=c.next().getCoordinates(),_=1;_<p.length-1;_++)if(p[_].equals(s))throw new ct("found endpt/interior pt intersection at index "+_+" :pt "+s)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),s=this._segStrings.iterator();s.hasNext();){var c=s.next();this.checkInteriorIntersections(e,c)}else if(arguments.length===2)for(var p=arguments[0],_=arguments[1],M=p.getCoordinates(),O=_.getCoordinates(),U=0;U<M.length-1;U++)for(var et=0;et<O.length-1;et++)this.checkInteriorIntersections(p,U,_,et);else if(arguments.length===4){var rt=arguments[0],dt=arguments[1],xt=arguments[2],Pt=arguments[3];if(rt===xt&&dt===Pt)return null;var Mt=rt.getCoordinates()[dt],Vt=rt.getCoordinates()[dt+1],Ht=xt.getCoordinates()[Pt],te=xt.getCoordinates()[Pt+1];if(this._li.computeIntersection(Mt,Vt,Ht,te),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,Mt,Vt)||this.hasInteriorIntersection(this._li,Ht,te)))throw new ct("found non-noded intersection at "+Mt+"-"+Vt+" and "+Ht+"-"+te)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(arguments.length===1)for(var s=arguments[0].getCoordinates(),c=0;c<s.length-2;c++)this.checkCollapse(s[c],s[c+1],s[c+2])}},{key:"hasInteriorIntersection",value:function(t,e,s){for(var c=0;c<t.getIntersectionNum();c++){var p=t.getIntersection(c);if(!p.equals(e)&&!p.equals(s))return!0}return!1}},{key:"checkCollapse",value:function(t,e,s){if(t.equals(s))throw new ct("found non-noded collapse at "+a.fact.createLineString([t,e,s]))}}],[{key:"constructor_",value:function(){this._li=new hn,this._segStrings=null;var t=arguments[0];this._segStrings=t}}])}();Qe.fact=new We;var Wr=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"intersectsScaled",value:function(t,e){var s=Math.min(t.x,e.x),c=Math.max(t.x,e.x),p=Math.min(t.y,e.y),_=Math.max(t.y,e.y),M=this._maxx<s||this._minx>c||this._maxy<p||this._miny>_;if(M)return!1;var O=this.intersectsToleranceSquare(t,e);return ht.isTrue(!(M&&O),"Found bad envelope test"),O}},{key:"initCorners",value:function(t){var e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new nt(this._maxx,this._maxy),this._corner[1]=new nt(this._minx,this._maxy),this._corner[2]=new nt(this._minx,this._miny),this._corner[3]=new nt(this._maxx,this._miny)}},{key:"intersects",value:function(t,e){return this._scaleFactor===1?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(t){return Math.round(t*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var t=a.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new bt(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(t,e){var s=!1,c=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(s=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(c=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!s||!c)||!!t.equals(this._pt)||!!e.equals(this._pt))))}},{key:"addSnappedNode",value:function(t,e){var s=t.getCoordinate(e),c=t.getCoordinate(e+1);return!!this.intersects(s,c)&&(t.addIntersection(this.getCoordinate(),e),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],s=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=s,e<=0)throw new B("Scale factor must be non-zero");e!==1&&(this._pt=new nt(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new nt,this._p1Scaled=new nt),this.initCorners(this._pt)}}])}();Wr.SAFE_ENV_EXPANSION_FACTOR=.75;var ii=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var a=arguments[1];arguments[0].getLineSegment(a,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new Oe}}])}(),Ds=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"snap",value:function(){if(arguments.length===1){var a=arguments[0];return this.snap(a,null,-1)}if(arguments.length===3){var t=arguments[0],e=arguments[1],s=arguments[2],c=t.getSafeEnvelope(),p=new tn(t,e,s);return this._index.query(c,new(function(){return d(function _(){u(this,_)},[{key:"interfaces_",get:function(){return[Ls]}},{key:"visitItem",value:function(_){_.select(c,p)}}])}())),p.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var a=arguments[0];this._index=a}}])}(),tn=function(a){function t(){var e;return u(this,t),e=o(this,t),t.constructor_.apply(e,arguments),e}return I(t,a),d(t,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof zr))return D(t,"select",this,1).apply(this,arguments);var e=arguments[1],s=arguments[0].getContext();if(this._parentEdge===s&&(e===this._hotPixelVertexIndex||e+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(s,e)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],s=arguments[1],c=arguments[2];this._hotPixel=e,this._parentEdge=s,this._hotPixelVertexIndex=c}}])}(ii);Ds.HotPixelSnapAction=tn;var tr=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"processIntersections",value:function(a,t,e,s){if(a===e&&t===s)return null;var c=a.getCoordinates()[t],p=a.getCoordinates()[t+1],_=e.getCoordinates()[s],M=e.getCoordinates()[s+1];if(this._li.computeIntersection(c,p,_,M),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var O=0;O<this._li.getIntersectionNum();O++)this._interiorIntersections.add(this._li.getIntersection(O));a.addIntersections(this._li,t,0),e.addIntersections(this._li,s,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[Ns]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var a=arguments[0];this._li=a,this._interiorIntersections=new It}}])}(),Rs=function(){return d(function a(){u(this,a),a.constructor_.apply(this,arguments)},[{key:"checkCorrectness",value:function(a){var t=cn.getNodedSubstrings(a),e=new Qe(t);try{e.checkValid()}catch(s){if(!(s instanceof N))throw s;s.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return cn.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(a,t){var e=this.findInteriorIntersections(a,t);this.computeIntersectionSnaps(e),this.computeVertexSnaps(a)}},{key:"findInteriorIntersections",value:function(a,t){var e=new tr(t);return this._noder.setSegmentIntersector(e),this._noder.computeNodes(a),e.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(Ot(arguments[0],Rt))for(var a=arguments[0].iterator();a.hasNext();){var t=a.next();this.computeVertexSnaps(t)}else if(arguments[0]instanceof cn)for(var e=arguments[0],s=e.getCoordinates(),c=0;c<s.length;c++){var p=new Wr(s[c],this._scaleFactor,this._li);this._pointSnapper.snap(p,e,c)&&e.addIntersection(s[c],c)}}},{key:"computeNodes",value:function(a){this._nodedSegStrings=a,this._noder=new Hr,this._pointSnapper=new Ds(this._noder.getIndex()),this.snapRound(a,this._li)}},{key:"computeIntersectionSnaps",value:function(a){for(var t=a.iterator();t.hasNext();){var e=t.next(),s=new Wr(e,this._scaleFactor,this._li);this._pointSnapper.snap(s)}}},{key:"interfaces_",get:function(){return[Gr]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var a=arguments[0];this._pm=a,this._li=new hn,this._li.setPrecisionModel(a),this._scaleFactor=a.getScale()}}])}(),En=function(){function a(){u(this,a),a.constructor_.apply(this,arguments)}return d(a,[{key:"bufferFixedPrecision",value:function(t){var e=new Bo(new Rs(new Pe(1)),t.getScale()),s=new Qi(this._bufParams);s.setWorkingPrecisionModel(t),s.setNoder(e),this._resultGeometry=s.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var t=a.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(p){if(!(p instanceof Ve))throw p;this._saveException=p}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var e=arguments[0],s=a.precisionScaleFactor(this._argGeom,this._distance,e),c=new Pe(s);this.bufferFixedPrecision(c)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Pe.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(t){this._bufParams.setQuadrantSegments(t)}},{key:"bufferOriginalPrecision",value:function(){try{var t=new Qi(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(e){if(!(e instanceof ct))throw e;this._saveException=e}}},{key:"getResultGeometry",value:function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(t){this._bufParams.setEndCapStyle(t)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new G,this._resultGeometry=null,this._saveException=null,arguments.length===1){var t=arguments[0];this._argGeom=t}else if(arguments.length===2){var e=arguments[0],s=arguments[1];this._argGeom=e,this._bufParams=s}}},{key:"bufferOp",value:function(){if(arguments.length===2){var t=arguments[1];return new a(arguments[0]).getResultGeometry(t)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof vt&&typeof arguments[1]=="number"){var e=arguments[1],s=arguments[2],c=new a(arguments[0]);return c.setQuadrantSegments(s),c.getResultGeometry(e)}if(arguments[2]instanceof G&&arguments[0]instanceof vt&&typeof arguments[1]=="number"){var p=arguments[1];return new a(arguments[0],arguments[2]).getResultGeometry(p)}}else if(arguments.length===4){var _=arguments[1],M=arguments[2],O=arguments[3],U=new a(arguments[0]);return U.setQuadrantSegments(M),U.setEndCapStyle(O),U.getResultGeometry(_)}}},{key:"precisionScaleFactor",value:function(t,e,s){var c=t.getEnvelopeInternal(),p=Wn.max(Math.abs(c.getMaxX()),Math.abs(c.getMaxY()),Math.abs(c.getMinX()),Math.abs(c.getMinY()))+2*(e>0?e:0),_=s-Math.trunc(Math.log(p)/Math.log(10)+1);return Math.pow(10,_)}}])}();En.CAP_ROUND=G.CAP_ROUND,En.CAP_BUTT=G.CAP_FLAT,En.CAP_FLAT=G.CAP_FLAT,En.CAP_SQUARE=G.CAP_SQUARE,En.MAX_PRECISION_DIGITS=12;var er=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],nr=function(){return d(function a(t){u(this,a),this.geometryFactory=t||new We},[{key:"read",value:function(a){var t,e=(t=typeof a=="string"?JSON.parse(a):a).type;if(!Le[e])throw new Error("Unknown GeoJSON type: "+t.type);return er.indexOf(e)!==-1?Le[e].call(this,t.coordinates):e==="GeometryCollection"?Le[e].call(this,t.geometries):Le[e].call(this,t)}},{key:"write",value:function(a){var t=a.getGeometryType();if(!Me[t])throw new Error("Geometry is not supported");return Me[t].call(this,a)}}])}(),Le={Feature:function(a){var t={};for(var e in a)t[e]=a[e];if(a.geometry){var s=a.geometry.type;if(!Le[s])throw new Error("Unknown GeoJSON type: "+a.type);t.geometry=this.read(a.geometry)}return a.bbox&&(t.bbox=Le.bbox.call(this,a.bbox)),t},FeatureCollection:function(a){var t={};if(a.features){t.features=[];for(var e=0;e<a.features.length;++e)t.features.push(this.read(a.features[e]))}return a.bbox&&(t.bbox=this.parse.bbox.call(this,a.bbox)),t},coordinates:function(a){for(var t=[],e=0;e<a.length;++e){var s=a[e];t.push(f(nt,Z(s)))}return t},bbox:function(a){return this.geometryFactory.createLinearRing([new nt(a[0],a[1]),new nt(a[2],a[1]),new nt(a[2],a[3]),new nt(a[0],a[3]),new nt(a[0],a[1])])},Point:function(a){var t=f(nt,Z(a));return this.geometryFactory.createPoint(t)},MultiPoint:function(a){for(var t=[],e=0;e<a.length;++e)t.push(Le.Point.call(this,a[e]));return this.geometryFactory.createMultiPoint(t)},LineString:function(a){var t=Le.coordinates.call(this,a);return this.geometryFactory.createLineString(t)},MultiLineString:function(a){for(var t=[],e=0;e<a.length;++e)t.push(Le.LineString.call(this,a[e]));return this.geometryFactory.createMultiLineString(t)},Polygon:function(a){for(var t=Le.coordinates.call(this,a[0]),e=this.geometryFactory.createLinearRing(t),s=[],c=1;c<a.length;++c){var p=a[c],_=Le.coordinates.call(this,p),M=this.geometryFactory.createLinearRing(_);s.push(M)}return this.geometryFactory.createPolygon(e,s)},MultiPolygon:function(a){for(var t=[],e=0;e<a.length;++e){var s=a[e];t.push(Le.Polygon.call(this,s))}return this.geometryFactory.createMultiPolygon(t)},GeometryCollection:function(a){for(var t=[],e=0;e<a.length;++e){var s=a[e];t.push(this.read(s))}return this.geometryFactory.createGeometryCollection(t)}},Me={coordinate:function(a){var t=[a.x,a.y];return a.z&&t.push(a.z),a.m&&t.push(a.m),t},Point:function(a){return{type:"Point",coordinates:Me.coordinate.call(this,a.getCoordinate())}},MultiPoint:function(a){for(var t=[],e=0;e<a._geometries.length;++e){var s=a._geometries[e],c=Me.Point.call(this,s);t.push(c.coordinates)}return{type:"MultiPoint",coordinates:t}},LineString:function(a){for(var t=[],e=a.getCoordinates(),s=0;s<e.length;++s){var c=e[s];t.push(Me.coordinate.call(this,c))}return{type:"LineString",coordinates:t}},MultiLineString:function(a){for(var t=[],e=0;e<a._geometries.length;++e){var s=a._geometries[e],c=Me.LineString.call(this,s);t.push(c.coordinates)}return{type:"MultiLineString",coordinates:t}},Polygon:function(a){var t=[],e=Me.LineString.call(this,a._shell);t.push(e.coordinates);for(var s=0;s<a._holes.length;++s){var c=a._holes[s],p=Me.LineString.call(this,c);t.push(p.coordinates)}return{type:"Polygon",coordinates:t}},MultiPolygon:function(a){for(var t=[],e=0;e<a._geometries.length;++e){var s=a._geometries[e],c=Me.Polygon.call(this,s);t.push(c.coordinates)}return{type:"MultiPolygon",coordinates:t}},GeometryCollection:function(a){for(var t=[],e=0;e<a._geometries.length;++e){var s=a._geometries[e],c=s.getGeometryType();t.push(Me[c].call(this,s))}return{type:"GeometryCollection",geometries:t}}};return{BufferOp:En,GeoJSONReader:function(){return d(function a(t){u(this,a),this.parser=new nr(t||new We)},[{key:"read",value:function(a){return this.parser.read(a)}}])}(),GeoJSONWriter:function(){return d(function a(){u(this,a),this.parser=new nr(this.geometryFactory)},[{key:"write",value:function(a){return this.parser.write(a)}}])}()}})}(ro)),ro.exports}var dc=gc();const mc=Fu(dc);function fi(){return new co}function co(){this.reset()}co.prototype={constructor:co,reset:function(){this.s=this.t=0},add:function(h){ja(Xs,h,this.t),ja(this,Xs.s,this.s),this.s?this.t+=Xs.t:this.s=Xs.t},valueOf:function(){return this.s}};var Xs=new co;function ja(h,n,r){var o=h.s=n+r,u=o-n,f=o-u;h.t=n-f+(r-u)}var ee=1e-6,$t=Math.PI,In=$t/2,Qa=$t/4,bn=$t*2,oi=180/$t,un=$t/180,ke=Math.abs,pc=Math.atan,mr=Math.atan2,oe=Math.cos,ae=Math.sin,vr=Math.sqrt;function Ku(h){return h>1?0:h<-1?$t:Math.acos(h)}function Oi(h){return h>1?In:h<-1?-In:Math.asin(h)}function os(){}function fo(h,n){h&&eu.hasOwnProperty(h.type)&&eu[h.type](h,n)}var tu={Feature:function(h,n){fo(h.geometry,n)},FeatureCollection:function(h,n){for(var r=h.features,o=-1,u=r.length;++o<u;)fo(r[o].geometry,n)}},eu={Sphere:function(h,n){n.sphere()},Point:function(h,n){h=h.coordinates,n.point(h[0],h[1],h[2])},MultiPoint:function(h,n){for(var r=h.coordinates,o=-1,u=r.length;++o<u;)h=r[o],n.point(h[0],h[1],h[2])},LineString:function(h,n){sa(h.coordinates,n,0)},MultiLineString:function(h,n){for(var r=h.coordinates,o=-1,u=r.length;++o<u;)sa(r[o],n,0)},Polygon:function(h,n){nu(h.coordinates,n)},MultiPolygon:function(h,n){for(var r=h.coordinates,o=-1,u=r.length;++o<u;)nu(r[o],n)},GeometryCollection:function(h,n){for(var r=h.geometries,o=-1,u=r.length;++o<u;)fo(r[o],n)}};function sa(h,n,r){var o=-1,u=h.length-r,f;for(n.lineStart();++o<u;)f=h[o],n.point(f[0],f[1],f[2]);n.lineEnd()}function nu(h,n){var r=-1,o=h.length;for(n.polygonStart();++r<o;)sa(h[r],n,1);n.polygonEnd()}function yc(h,n){h&&tu.hasOwnProperty(h.type)?tu[h.type](h,n):fo(h,n)}fi();fi();function oa(h){return[mr(h[1],h[0]),Oi(h[2])]}function pr(h){var n=h[0],r=h[1],o=oe(r);return[o*oe(n),o*ae(n),ae(r)]}function Ws(h,n){return h[0]*n[0]+h[1]*n[1]+h[2]*n[2]}function go(h,n){return[h[1]*n[2]-h[2]*n[1],h[2]*n[0]-h[0]*n[2],h[0]*n[1]-h[1]*n[0]]}function Xo(h,n){h[0]+=n[0],h[1]+=n[1],h[2]+=n[2]}function Ks(h,n){return[h[0]*n,h[1]*n,h[2]*n]}function aa(h){var n=vr(h[0]*h[0]+h[1]*h[1]+h[2]*h[2]);h[0]/=n,h[1]/=n,h[2]/=n}fi();function $u(h,n){function r(o,u){return o=h(o,u),n(o[0],o[1])}return h.invert&&n.invert&&(r.invert=function(o,u){return o=n.invert(o,u),o&&h.invert(o[0],o[1])}),r}function ua(h,n){return[h>$t?h-bn:h<-$t?h+bn:h,n]}ua.invert=ua;function vc(h,n,r){return(h%=bn)?n||r?$u(ru(h),su(n,r)):ru(h):n||r?su(n,r):ua}function iu(h){return function(n,r){return n+=h,[n>$t?n-bn:n<-$t?n+bn:n,r]}}function ru(h){var n=iu(h);return n.invert=iu(-h),n}function su(h,n){var r=oe(h),o=ae(h),u=oe(n),f=ae(n);function m(d,x){var v=oe(x),w=oe(d)*v,I=ae(d)*v,T=ae(x),b=T*r+w*o;return[mr(I*u-b*f,w*r-T*o),Oi(b*u+I*f)]}return m.invert=function(d,x){var v=oe(x),w=oe(d)*v,I=ae(d)*v,T=ae(x),b=T*u-I*f;return[mr(I*u+T*f,w*r+b*o),Oi(b*r-w*o)]},m}function _c(h,n,r,o,u,f){if(r){var m=oe(n),d=ae(n),x=o*r;u==null?(u=n+o*bn,f=n-x/2):(u=ou(m,u),f=ou(m,f),(o>0?u<f:u>f)&&(u+=o*bn));for(var v,w=u;o>0?w>f:w<f;w-=x)v=oa([m,-d*oe(w),-d*ae(w)]),h.point(v[0],v[1])}}function ou(h,n){n=pr(n),n[0]-=h,aa(n);var r=Ku(-n[1]);return((-n[2]<0?-r:r)+bn-ee)%bn}function Ju(){var h=[],n;return{point:function(r,o){n.push([r,o])},lineStart:function(){h.push(n=[])},lineEnd:os,rejoin:function(){h.length>1&&h.push(h.pop().concat(h.shift()))},result:function(){var r=h;return h=[],n=null,r}}}function xc(h,n,r,o,u,f){var m=h[0],d=h[1],x=n[0],v=n[1],w=0,I=1,T=x-m,b=v-d,D;if(D=r-m,!(!T&&D>0)){if(D/=T,T<0){if(D<w)return;D<I&&(I=D)}else if(T>0){if(D>I)return;D>w&&(w=D)}if(D=u-m,!(!T&&D<0)){if(D/=T,T<0){if(D>I)return;D>w&&(w=D)}else if(T>0){if(D<w)return;D<I&&(I=D)}if(D=o-d,!(!b&&D>0)){if(D/=b,b<0){if(D<w)return;D<I&&(I=D)}else if(b>0){if(D>I)return;D>w&&(w=D)}if(D=f-d,!(!b&&D<0)){if(D/=b,b<0){if(D>I)return;D>w&&(w=D)}else if(b>0){if(D<w)return;D<I&&(I=D)}return w>0&&(h[0]=m+w*T,h[1]=d+w*b),I<1&&(n[0]=m+I*T,n[1]=d+I*b),!0}}}}}function so(h,n){return ke(h[0]-n[0])<ee&&ke(h[1]-n[1])<ee}function $s(h,n,r,o){this.x=h,this.z=n,this.o=r,this.e=o,this.v=!1,this.n=this.p=null}function ju(h,n,r,o,u){var f=[],m=[],d,x;if(h.forEach(function(D){if(!((Z=D.length-1)<=0)){var Z,Y=D[0],tt=D[Z],E;if(so(Y,tt)){for(u.lineStart(),d=0;d<Z;++d)u.point((Y=D[d])[0],Y[1]);u.lineEnd();return}f.push(E=new $s(Y,D,null,!0)),m.push(E.o=new $s(Y,null,E,!1)),f.push(E=new $s(tt,D,null,!1)),m.push(E.o=new $s(tt,null,E,!0))}}),!!f.length){for(m.sort(n),au(f),au(m),d=0,x=m.length;d<x;++d)m[d].e=r=!r;for(var v=f[0],w,I;;){for(var T=v,b=!0;T.v;)if((T=T.n)===v)return;w=T.z,u.lineStart();do{if(T.v=T.o.v=!0,T.e){if(b)for(d=0,x=w.length;d<x;++d)u.point((I=w[d])[0],I[1]);else o(T.x,T.n.x,1,u);T=T.n}else{if(b)for(w=T.p.z,d=w.length-1;d>=0;--d)u.point((I=w[d])[0],I[1]);else o(T.x,T.p.x,-1,u);T=T.p}T=T.o,w=T.z,b=!b}while(!T.v);u.lineEnd()}}}function au(h){if(n=h.length){for(var n,r=0,o=h[0],u;++r<n;)o.n=u=h[r],u.p=o,o=u;o.n=u=h[0],u.p=o}}function Qu(h,n){return h<n?-1:h>n?1:h>=n?0:NaN}function kc(h){return h.length===1&&(h=wc(h)),{left:function(n,r,o,u){for(o==null&&(o=0),u==null&&(u=n.length);o<u;){var f=o+u>>>1;h(n[f],r)<0?o=f+1:u=f}return o},right:function(n,r,o,u){for(o==null&&(o=0),u==null&&(u=n.length);o<u;){var f=o+u>>>1;h(n[f],r)>0?u=f:o=f+1}return o}}}function wc(h){return function(n,r){return Qu(h(n),r)}}kc(Qu);function tl(h){for(var n=h.length,r,o=-1,u=0,f,m;++o<n;)u+=h[o].length;for(f=new Array(u);--n>=0;)for(m=h[n],r=m.length;--r>=0;)f[--u]=m[r];return f}var as=1e9,Js=-as;function Ec(h,n,r,o){function u(v,w){return h<=v&&v<=r&&n<=w&&w<=o}function f(v,w,I,T){var b=0,D=0;if(v==null||(b=m(v,I))!==(D=m(w,I))||x(v,w)<0^I>0)do T.point(b===0||b===3?h:r,b>1?o:n);while((b=(b+I+4)%4)!==D);else T.point(w[0],w[1])}function m(v,w){return ke(v[0]-h)<ee?w>0?0:3:ke(v[0]-r)<ee?w>0?2:1:ke(v[1]-n)<ee?w>0?1:0:w>0?3:2}function d(v,w){return x(v.x,w.x)}function x(v,w){var I=m(v,1),T=m(w,1);return I!==T?I-T:I===0?w[1]-v[1]:I===1?v[0]-w[0]:I===2?v[1]-w[1]:w[0]-v[0]}return function(v){var w=v,I=Ju(),T,b,D,Z,Y,tt,E,G,N,B,z,$={point:P,lineStart:F,lineEnd:V,polygonStart:C,polygonEnd:R};function P(X,q){u(X,q)&&w.point(X,q)}function S(){for(var X=0,q=0,Q=b.length;q<Q;++q)for(var W=b[q],it=1,J=W.length,ut=W[0],ct,pt,ht=ut[0],ft=ut[1];it<J;++it)ct=ht,pt=ft,ut=W[it],ht=ut[0],ft=ut[1],pt<=o?ft>o&&(ht-ct)*(o-pt)>(ft-pt)*(h-ct)&&++X:ft<=o&&(ht-ct)*(o-pt)<(ft-pt)*(h-ct)&&--X;return X}function C(){w=I,T=[],b=[],z=!0}function R(){var X=S(),q=z&&X,Q=(T=tl(T)).length;(q||Q)&&(v.polygonStart(),q&&(v.lineStart(),f(null,null,1,v),v.lineEnd()),Q&&ju(T,d,X,f,v),v.polygonEnd()),w=v,T=b=D=null}function F(){$.point=H,b&&b.push(D=[]),B=!0,N=!1,E=G=NaN}function V(){T&&(H(Z,Y),tt&&N&&I.rejoin(),T.push(I.result())),$.point=P,N&&w.lineEnd()}function H(X,q){var Q=u(X,q);if(b&&D.push([X,q]),B)Z=X,Y=q,tt=Q,B=!1,Q&&(w.lineStart(),w.point(X,q));else if(Q&&N)w.point(X,q);else{var W=[E=Math.max(Js,Math.min(as,E)),G=Math.max(Js,Math.min(as,G))],it=[X=Math.max(Js,Math.min(as,X)),q=Math.max(Js,Math.min(as,q))];xc(W,it,h,n,r,o)?(N||(w.lineStart(),w.point(W[0],W[1])),w.point(it[0],it[1]),Q||w.lineEnd(),z=!1):Q&&(w.lineStart(),w.point(X,q),z=!1)}E=X,G=q,N=Q}return $}}var Wo=fi();function Pc(h,n){var r=n[0],o=n[1],u=[ae(r),-oe(r),0],f=0,m=0;Wo.reset();for(var d=0,x=h.length;d<x;++d)if(w=(v=h[d]).length)for(var v,w,I=v[w-1],T=I[0],b=I[1]/2+Qa,D=ae(b),Z=oe(b),Y=0;Y<w;++Y,T=E,D=N,Z=B,I=tt){var tt=v[Y],E=tt[0],G=tt[1]/2+Qa,N=ae(G),B=oe(G),z=E-T,$=z>=0?1:-1,P=$*z,S=P>$t,C=D*N;if(Wo.add(mr(C*$*ae(P),Z*B+C*oe(P))),f+=S?z+$*bn:z,S^T>=r^E>=r){var R=go(pr(I),pr(tt));aa(R);var F=go(u,R);aa(F);var V=(S^z>=0?-1:1)*Oi(F[2]);(o>V||o===V&&(R[0]||R[1]))&&(m+=S^z>=0?1:-1)}}return(f<-ee||f<ee&&Wo<-ee)^m&1}fi();function uu(h){return h}fi();fi();var yr=1/0,mo=yr,ps=-yr,po=ps,lu={point:Lc,lineStart:os,lineEnd:os,polygonStart:os,polygonEnd:os,result:function(){var h=[[yr,mo],[ps,po]];return ps=po=-(mo=yr=1/0),h}};function Lc(h,n){h<yr&&(yr=h),h>ps&&(ps=h),n<mo&&(mo=n),n>po&&(po=n)}fi();function el(h,n,r,o){return function(u,f){var m=n(f),d=u.invert(o[0],o[1]),x=Ju(),v=n(x),w=!1,I,T,b,D={point:Z,lineStart:tt,lineEnd:E,polygonStart:function(){D.point=G,D.lineStart=N,D.lineEnd=B,T=[],I=[]},polygonEnd:function(){D.point=Z,D.lineStart=tt,D.lineEnd=E,T=tl(T);var z=Pc(I,d);T.length?(w||(f.polygonStart(),w=!0),ju(T,Ic,z,r,f)):z&&(w||(f.polygonStart(),w=!0),f.lineStart(),r(null,null,1,f),f.lineEnd()),w&&(f.polygonEnd(),w=!1),T=I=null},sphere:function(){f.polygonStart(),f.lineStart(),r(null,null,1,f),f.lineEnd(),f.polygonEnd()}};function Z(z,$){var P=u(z,$);h(z=P[0],$=P[1])&&f.point(z,$)}function Y(z,$){var P=u(z,$);m.point(P[0],P[1])}function tt(){D.point=Y,m.lineStart()}function E(){D.point=Z,m.lineEnd()}function G(z,$){b.push([z,$]);var P=u(z,$);v.point(P[0],P[1])}function N(){v.lineStart(),b=[]}function B(){G(b[0][0],b[0][1]),v.lineEnd();var z=v.clean(),$=x.result(),P,S=$.length,C,R,F;if(b.pop(),I.push(b),b=null,!!S){if(z&1){if(R=$[0],(C=R.length-1)>0){for(w||(f.polygonStart(),w=!0),f.lineStart(),P=0;P<C;++P)f.point((F=R[P])[0],F[1]);f.lineEnd()}return}S>1&&z&2&&$.push($.pop().concat($.shift())),T.push($.filter(Mc))}}return D}}function Mc(h){return h.length>1}function Ic(h,n){return((h=h.x)[0]<0?h[1]-In-ee:In-h[1])-((n=n.x)[0]<0?n[1]-In-ee:In-n[1])}const hu=el(function(){return!0},Sc,bc,[-$t,-In]);function Sc(h){var n=NaN,r=NaN,o=NaN,u;return{lineStart:function(){h.lineStart(),u=1},point:function(f,m){var d=f>0?$t:-$t,x=ke(f-n);ke(x-$t)<ee?(h.point(n,r=(r+m)/2>0?In:-In),h.point(o,r),h.lineEnd(),h.lineStart(),h.point(d,r),h.point(f,r),u=0):o!==d&&x>=$t&&(ke(n-o)<ee&&(n-=o*ee),ke(f-d)<ee&&(f-=d*ee),r=Cc(n,r,f,m),h.point(o,r),h.lineEnd(),h.lineStart(),h.point(d,r),u=0),h.point(n=f,r=m),o=d},lineEnd:function(){h.lineEnd(),n=r=NaN},clean:function(){return 2-u}}}function Cc(h,n,r,o){var u,f,m=ae(h-r);return ke(m)>ee?pc((ae(n)*(f=oe(o))*ae(r)-ae(o)*(u=oe(n))*ae(h))/(u*f*m)):(n+o)/2}function bc(h,n,r,o){var u;if(h==null)u=r*In,o.point(-$t,u),o.point(0,u),o.point($t,u),o.point($t,0),o.point($t,-u),o.point(0,-u),o.point(-$t,-u),o.point(-$t,0),o.point(-$t,u);else if(ke(h[0]-n[0])>ee){var f=h[0]<n[0]?$t:-$t;u=r*f/2,o.point(-f,u),o.point(0,u),o.point(f,u)}else o.point(n[0],n[1])}function Tc(h,n){var r=oe(h),o=r>0,u=ke(r)>ee;function f(w,I,T,b){_c(b,h,n,T,w,I)}function m(w,I){return oe(w)*oe(I)>r}function d(w){var I,T,b,D,Z;return{lineStart:function(){D=b=!1,Z=1},point:function(Y,tt){var E=[Y,tt],G,N=m(Y,tt),B=o?N?0:v(Y,tt):N?v(Y+(Y<0?$t:-$t),tt):0;if(!I&&(D=b=N)&&w.lineStart(),N!==b&&(G=x(I,E),(!G||so(I,G)||so(E,G))&&(E[0]+=ee,E[1]+=ee,N=m(E[0],E[1]))),N!==b)Z=0,N?(w.lineStart(),G=x(E,I),w.point(G[0],G[1])):(G=x(I,E),w.point(G[0],G[1]),w.lineEnd()),I=G;else if(u&&I&&o^N){var z;!(B&T)&&(z=x(E,I,!0))&&(Z=0,o?(w.lineStart(),w.point(z[0][0],z[0][1]),w.point(z[1][0],z[1][1]),w.lineEnd()):(w.point(z[1][0],z[1][1]),w.lineEnd(),w.lineStart(),w.point(z[0][0],z[0][1])))}N&&(!I||!so(I,E))&&w.point(E[0],E[1]),I=E,b=N,T=B},lineEnd:function(){b&&w.lineEnd(),I=null},clean:function(){return Z|(D&&b)<<1}}}function x(w,I,T){var b=pr(w),D=pr(I),Z=[1,0,0],Y=go(b,D),tt=Ws(Y,Y),E=Y[0],G=tt-E*E;if(!G)return!T&&w;var N=r*tt/G,B=-r*E/G,z=go(Z,Y),$=Ks(Z,N),P=Ks(Y,B);Xo($,P);var S=z,C=Ws($,S),R=Ws(S,S),F=C*C-R*(Ws($,$)-1);if(!(F<0)){var V=vr(F),H=Ks(S,(-C-V)/R);if(Xo(H,$),H=oa(H),!T)return H;var X=w[0],q=I[0],Q=w[1],W=I[1],it;q<X&&(it=X,X=q,q=it);var J=q-X,ut=ke(J-$t)<ee,ct=ut||J<ee;if(!ut&&W<Q&&(it=Q,Q=W,W=it),ct?ut?Q+W>0^H[1]<(ke(H[0]-X)<ee?Q:W):Q<=H[1]&&H[1]<=W:J>$t^(X<=H[0]&&H[0]<=q)){var pt=Ks(S,(-C+V)/R);return Xo(pt,$),[H,oa(pt)]}}}function v(w,I){var T=o?h:$t-h,b=0;return w<-T?b|=1:w>T&&(b|=2),I<-T?b|=4:I>T&&(b|=8),b}return el(m,d,f,o?[0,-h]:[-$t,h-$t])}function nl(h){return function(n){var r=new la;for(var o in h)r[o]=h[o];return r.stream=n,r}}function la(){}la.prototype={constructor:la,point:function(h,n){this.stream.point(h,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function il(h,n,r){var o=n[1][0]-n[0][0],u=n[1][1]-n[0][1],f=h.clipExtent&&h.clipExtent();h.scale(150).translate([0,0]),f!=null&&h.clipExtent(null),yc(r,h.stream(lu));var m=lu.result(),d=Math.min(o/(m[1][0]-m[0][0]),u/(m[1][1]-m[0][1])),x=+n[0][0]+(o-d*(m[1][0]+m[0][0]))/2,v=+n[0][1]+(u-d*(m[1][1]+m[0][1]))/2;return f!=null&&h.clipExtent(f),h.scale(d*150).translate([x,v])}function Nc(h,n,r){return il(h,[[0,0],n],r)}var cu=16,Oc=oe(30*un);function fu(h,n){return+n?Dc(h,n):Ac(h)}function Ac(h){return nl({point:function(n,r){n=h(n,r),this.stream.point(n[0],n[1])}})}function Dc(h,n){function r(o,u,f,m,d,x,v,w,I,T,b,D,Z,Y){var tt=v-o,E=w-u,G=tt*tt+E*E;if(G>4*n&&Z--){var N=m+T,B=d+b,z=x+D,$=vr(N*N+B*B+z*z),P=Oi(z/=$),S=ke(ke(z)-1)<ee||ke(f-I)<ee?(f+I)/2:mr(B,N),C=h(S,P),R=C[0],F=C[1],V=R-o,H=F-u,X=E*V-tt*H;(X*X/G>n||ke((tt*V+E*H)/G-.5)>.3||m*T+d*b+x*D<Oc)&&(r(o,u,f,m,d,x,R,F,S,N/=$,B/=$,z,Z,Y),Y.point(R,F),r(R,F,S,N,B,z,v,w,I,T,b,D,Z,Y))}}return function(o){var u,f,m,d,x,v,w,I,T,b,D,Z,Y={point:tt,lineStart:E,lineEnd:N,polygonStart:function(){o.polygonStart(),Y.lineStart=B},polygonEnd:function(){o.polygonEnd(),Y.lineStart=E}};function tt(P,S){P=h(P,S),o.point(P[0],P[1])}function E(){I=NaN,Y.point=G,o.lineStart()}function G(P,S){var C=pr([P,S]),R=h(P,S);r(I,T,w,b,D,Z,I=R[0],T=R[1],w=P,b=C[0],D=C[1],Z=C[2],cu,o),o.point(I,T)}function N(){Y.point=tt,o.lineEnd()}function B(){E(),Y.point=z,Y.lineEnd=$}function z(P,S){G(u=P,S),f=I,m=T,d=b,x=D,v=Z,Y.point=G}function $(){r(I,T,w,b,D,Z,f,m,u,d,x,v,cu,o),Y.lineEnd=N,N()}return Y}}var Rc=nl({point:function(h,n){this.stream.point(h*un,n*un)}});function Fc(h){return Bc(function(){return h})()}function Bc(h){var n,r=150,o=480,u=250,f,m,d=0,x=0,v=0,w=0,I=0,T,b,D=null,Z=hu,Y=null,tt,E,G,N=uu,B=.5,z=fu(R,B),$,P;function S(H){return H=b(H[0]*un,H[1]*un),[H[0]*r+f,m-H[1]*r]}function C(H){return H=b.invert((H[0]-f)/r,(m-H[1])/r),H&&[H[0]*oi,H[1]*oi]}function R(H,X){return H=n(H,X),[H[0]*r+f,m-H[1]*r]}S.stream=function(H){return $&&P===H?$:$=Rc(Z(T,z(N(P=H))))},S.clipAngle=function(H){return arguments.length?(Z=+H?Tc(D=H*un,6*un):(D=null,hu),V()):D*oi},S.clipExtent=function(H){return arguments.length?(N=H==null?(Y=tt=E=G=null,uu):Ec(Y=+H[0][0],tt=+H[0][1],E=+H[1][0],G=+H[1][1]),V()):Y==null?null:[[Y,tt],[E,G]]},S.scale=function(H){return arguments.length?(r=+H,F()):r},S.translate=function(H){return arguments.length?(o=+H[0],u=+H[1],F()):[o,u]},S.center=function(H){return arguments.length?(d=H[0]%360*un,x=H[1]%360*un,F()):[d*oi,x*oi]},S.rotate=function(H){return arguments.length?(v=H[0]%360*un,w=H[1]%360*un,I=H.length>2?H[2]%360*un:0,F()):[v*oi,w*oi,I*oi]},S.precision=function(H){return arguments.length?(z=fu(R,B=H*H),V()):vr(B)},S.fitExtent=function(H,X){return il(S,H,X)},S.fitSize=function(H,X){return Nc(S,H,X)};function F(){b=$u(T=vc(v,w,I),n);var H=n(d,x);return f=o-H[0]*r,m=u+H[1]*r,V()}function V(){return $=P=null,S}return function(){return n=h.apply(this,arguments),S.invert=n.invert&&C,F()}}function rl(h){return function(n,r){var o=oe(n),u=oe(r),f=h(o*u);return[f*u*ae(n),f*ae(r)]}}function sl(h){return function(n,r){var o=vr(n*n+r*r),u=h(o),f=ae(u),m=oe(u);return[mr(n*f,o*m),Oi(o&&r*f/o)]}}var zc=rl(function(h){return vr(2/(1+h))});zc.invert=sl(function(h){return 2*Oi(h/2)});var ol=rl(function(h){return(h=Ku(h))&&h/ae(h)});ol.invert=sl(function(h){return h});function Gc(){return Fc(ol).scale(79.4188).clipAngle(180-.001)}function gu(h,n){return[h,n]}gu.invert=gu;var{BufferOp:Hc,GeoJSONReader:qc,GeoJSONWriter:Uc}=mc;function Zc(h,n,r){r=r||{};var o=r.units||"kilometers",u=r.steps||8;if(!h)throw new Error("geojson is required");if(typeof r!="object")throw new Error("options must be an object");if(typeof u!="number")throw new Error("steps must be an number");if(n===void 0)throw new Error("radius is required");if(u<=0)throw new Error("steps must be greater than 0");var f=[];switch(h.type){case"GeometryCollection":return ci(h,function(m){var d=oo(m,n,o,u);d&&f.push(d)}),Sn(f);case"FeatureCollection":return li(h,function(m){var d=oo(m,n,o,u);d&&li(d,function(x){x&&f.push(x)})}),Sn(f)}return oo(h,n,o,u)}function oo(h,n,r,o){var u=h.properties||{},f=h.type==="Feature"?h.geometry:h;if(f.type==="GeometryCollection"){var m=[];return ci(h,function(Z){var Y=oo(Z,n,r,o);Y&&m.push(Y)}),Sn(m)}var d=Yc(f),x={type:f.type,coordinates:ul(f.coordinates,d)},v=new qc,w=v.read(x),I=Du(lh(n,r),"meters"),T=Hc.bufferOp(w,I,o),b=new Uc;if(T=b.write(T),!al(T.coordinates)){var D={type:T.type,coordinates:ll(T.coordinates,d)};return mn(D,u)}}function al(h){return Array.isArray(h[0])?al(h[0]):isNaN(h[0])}function ul(h,n){return typeof h[0]!="object"?n(h):h.map(function(r){return ul(r,n)})}function ll(h,n){return typeof h[0]!="object"?n.invert(h):h.map(function(r){return ll(r,n)})}function Yc(h){var n=cc(h).geometry.coordinates,r=[-n[0],-n[1]];return Gc().rotate(r).scale(be)}var Vc=Zc;function ha(h,n={}){var r=typeof n=="object"?n.mutate:n;if(!h)throw new Error("geojson is required");var o=Gu(h),u=[];switch(o){case"LineString":u=Ko(h,o);break;case"MultiLineString":case"Polygon":gr(h).forEach(function(m){u.push(Ko(m,o))});break;case"MultiPolygon":gr(h).forEach(function(m){var d=[];m.forEach(function(x){d.push(Ko(x,o))}),u.push(d)});break;case"Point":return h;case"MultiPoint":var f={};gr(h).forEach(function(m){var d=m.join("-");Object.prototype.hasOwnProperty.call(f,d)||(u.push(m),f[d]=!0)});break;default:throw new Error(o+" geometry not supported")}return h.coordinates?r===!0?(h.coordinates=u,h):{type:o,coordinates:u}:r===!0?(h.geometry.coordinates=u,h):mn({type:o,coordinates:u},h.properties,{bbox:h.bbox,id:h.id})}function Ko(h,n){var r=gr(h);if(r.length===2&&!du(r[0],r[1]))return r;var o=[],u=r.length-1,f=o.length;o.push(r[0]);for(var m=1;m<u;m++){var d=o[o.length-1];r[m][0]===d[0]&&r[m][1]===d[1]||(o.push(r[m]),f=o.length,f>2&&mu(o[f-3],o[f-1],o[f-2])&&o.splice(o.length-2,1))}if(o.push(r[r.length-1]),f=o.length,(n==="Polygon"||n==="MultiPolygon")&&du(r[0],r[r.length-1])&&f<4)throw new Error("invalid polygon");return n==="LineString"&&f<3||mu(o[f-3],o[f-1],o[f-2])&&o.splice(o.length-2,1),o}function du(h,n){return h[0]===n[0]&&h[1]===n[1]}function mu(h,n,r){var o=r[0],u=r[1],f=h[0],m=h[1],d=n[0],x=n[1],v=o-f,w=u-m,I=d-f,T=x-m,b=v*T-w*I;return b!==0?!1:Math.abs(I)>=Math.abs(T)?I>0?f<=o&&o<=d:d<=o&&o<=f:T>0?m<=u&&u<=x:x<=u&&u<=m}function da(h){if(!h)throw new Error("geojson is required");switch(h.type){case"Feature":return hl(h);case"FeatureCollection":return Xc(h);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return ma(h);default:throw new Error("unknown GeoJSON type")}}function hl(h){const n={type:"Feature"};return Object.keys(h).forEach(r=>{switch(r){case"type":case"properties":case"geometry":return;default:n[r]=h[r]}}),n.properties=cl(h.properties),h.geometry==null?n.geometry=null:n.geometry=ma(h.geometry),n}function cl(h){const n={};return h&&Object.keys(h).forEach(r=>{const o=h[r];typeof o=="object"?o===null?n[r]=null:Array.isArray(o)?n[r]=o.map(u=>u):n[r]=cl(o):n[r]=o}),n}function Xc(h){const n={type:"FeatureCollection"};return Object.keys(h).forEach(r=>{switch(r){case"type":case"features":return;default:n[r]=h[r]}}),n.features=h.features.map(r=>hl(r)),n}function ma(h){const n={type:h.type};return h.bbox&&(n.bbox=h.bbox),h.type==="GeometryCollection"?(n.geometries=h.geometries.map(r=>ma(r)),n):(n.coordinates=fl(h.coordinates),n)}function fl(h){const n=h;return typeof n[0]!="object"?n.slice():n.map(r=>fl(r))}function Wc(h,n){var r=h[0]-n[0],o=h[1]-n[1];return r*r+o*o}function Kc(h,n,r){var o=n[0],u=n[1],f=r[0]-o,m=r[1]-u;if(f!==0||m!==0){var d=((h[0]-o)*f+(h[1]-u)*m)/(f*f+m*m);d>1?(o=r[0],u=r[1]):d>0&&(o+=f*d,u+=m*d)}return f=h[0]-o,m=h[1]-u,f*f+m*m}function $c(h,n){for(var r=h[0],o=[r],u,f=1,m=h.length;f<m;f++)u=h[f],Wc(u,r)>n&&(o.push(u),r=u);return r!==u&&o.push(u),o}function ca(h,n,r,o,u){for(var f=o,m,d=n+1;d<r;d++){var x=Kc(h[d],h[n],h[r]);x>f&&(m=d,f=x)}f>o&&(m-n>1&&ca(h,n,m,o,u),u.push(h[m]),r-m>1&&ca(h,m,r,o,u))}function Jc(h,n){var r=h.length-1,o=[h[0]];return ca(h,0,r,n,o),o.push(h[r]),o}function yo(h,n,r){if(h.length<=2)return h;var o=n!==void 0?n*n:1;return h=r?h:$c(h,o),h=Jc(h,o),h}function jc(h,n={}){var r,o,u;if(n=n??{},!hh(n))throw new Error("options is invalid");const f=(r=n.tolerance)!=null?r:1,m=(o=n.highQuality)!=null?o:!1,d=(u=n.mutate)!=null?u:!1;if(!h)throw new Error("geojson is required");if(f&&f<0)throw new Error("invalid tolerance");return d!==!0&&(h=da(h)),ci(h,function(x){Qc(x,f,m)}),h}function Qc(h,n,r){const o=h.type;if(o==="Point"||o==="MultiPoint")return h;if(ha(h,{mutate:!0}),o!=="GeometryCollection")switch(o){case"LineString":h.coordinates=yo(h.coordinates,n,r);break;case"MultiLineString":h.coordinates=h.coordinates.map(u=>yo(u,n,r));break;case"Polygon":h.coordinates=pu(h.coordinates,n,r);break;case"MultiPolygon":h.coordinates=h.coordinates.map(u=>pu(u,n,r))}return h}function pu(h,n,r){return h.map(function(o){if(o.length<4)throw new Error("invalid polygon");let u=n,f=yo(o,u,r);for(;!tf(f);)u-=u*.01,f=yo(o,u,r);return(f[f.length-1][0]!==f[0][0]||f[f.length-1][1]!==f[0][1])&&f.push(f[0]),f})}function tf(h){return h.length<3?!1:!(h.length===3&&h[2][0]===h[0][0]&&h[2][1]===h[0][1])}var ts=jc;function ef(h){let n,r;const o={type:"FeatureCollection",features:[]};if(h.type==="Feature"?r=h.geometry:r=h,r.type==="LineString")n=[r.coordinates];else if(r.type==="MultiLineString")n=r.coordinates;else if(r.type==="MultiPolygon")n=[].concat(...r.coordinates);else if(r.type==="Polygon")n=r.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return n.forEach(u=>{n.forEach(f=>{for(let m=0;m<u.length-1;m++)for(let d=m;d<f.length-1;d++){if(u===f&&(Math.abs(m-d)===1||m===0&&d===u.length-2&&u[m][0]===u[u.length-1][0]&&u[m][1]===u[u.length-1][1]))continue;const x=nf(u[m][0],u[m][1],u[m+1][0],u[m+1][1],f[d][0],f[d][1],f[d+1][0],f[d+1][1]);x&&o.features.push(Hn([x[0],x[1]]))}})}),o}function nf(h,n,r,o,u,f,m,d){let x,v,w,I,T;const b={x:null,y:null,onLine1:!1,onLine2:!1};return x=(d-f)*(r-h)-(m-u)*(o-n),x===0?b.x!==null&&b.y!==null?b:!1:(v=n-f,w=h-u,I=(m-u)*v-(d-f)*w,T=(r-h)*v-(o-n)*w,v=I/x,w=T/x,b.x=h+v*(r-h),b.y=n+v*(o-n),v>=0&&v<=1&&(b.onLine1=!0),w>=0&&w<=1&&(b.onLine2=!0),b.onLine1&&b.onLine2?[b.x,b.y]:!1)}var yu=ef;function rf(h,n,r,o,u){gl(h,n,r||0,o||h.length-1,u||sf)}function gl(h,n,r,o,u){for(;o>r;){if(o-r>600){var f=o-r+1,m=n-r+1,d=Math.log(f),x=.5*Math.exp(2*d/3),v=.5*Math.sqrt(d*x*(f-x)/f)*(m-f/2<0?-1:1),w=Math.max(r,Math.floor(n-m*x/f+v)),I=Math.min(o,Math.floor(n+(f-m)*x/f+v));gl(h,n,w,I,u)}var T=h[n],b=r,D=o;for(es(h,r,n),u(h[o],T)>0&&es(h,r,o);b<D;){for(es(h,b,D),b++,D--;u(h[b],T)<0;)b++;for(;u(h[D],T)>0;)D--}u(h[r],T)===0?es(h,r,D):(D++,es(h,D,o)),D<=n&&(r=D+1),n<=D&&(o=D-1)}}function es(h,n,r){var o=h[n];h[n]=h[r],h[r]=o}function sf(h,n){return h<n?-1:h>n?1:0}class dl{constructor(n=9){this._maxEntries=Math.max(4,n),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(n){let r=this.data;const o=[];if(!Qs(n,r))return o;const u=this.toBBox,f=[];for(;r;){for(let m=0;m<r.children.length;m++){const d=r.children[m],x=r.leaf?u(d):d;Qs(n,x)&&(r.leaf?o.push(d):Jo(n,x)?this._all(d,o):f.push(d))}r=f.pop()}return o}collides(n){let r=this.data;if(!Qs(n,r))return!1;const o=[];for(;r;){for(let u=0;u<r.children.length;u++){const f=r.children[u],m=r.leaf?this.toBBox(f):f;if(Qs(n,m)){if(r.leaf||Jo(n,m))return!0;o.push(f)}}r=o.pop()}return!1}load(n){if(!(n&&n.length))return this;if(n.length<this._minEntries){for(let o=0;o<n.length;o++)this.insert(n[o]);return this}let r=this._build(n.slice(),0,n.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){const o=this.data;this.data=r,r=o}this._insert(r,this.data.height-r.height-1,!0)}return this}insert(n){return n&&this._insert(n,this.data.height-1),this}clear(){return this.data=hr([]),this}remove(n,r){if(!n)return this;let o=this.data;const u=this.toBBox(n),f=[],m=[];let d,x,v;for(;o||f.length;){if(o||(o=f.pop(),x=f[f.length-1],d=m.pop(),v=!0),o.leaf){const w=of(n,o.children,r);if(w!==-1)return o.children.splice(w,1),f.push(o),this._condense(f),this}!v&&!o.leaf&&Jo(o,u)?(f.push(o),m.push(d),d=0,x=o,o=o.children[0]):x?(d++,o=x.children[d],v=!1):o=null}return this}toBBox(n){return n}compareMinX(n,r){return n.minX-r.minX}compareMinY(n,r){return n.minY-r.minY}toJSON(){return this.data}fromJSON(n){return this.data=n,this}_all(n,r){const o=[];for(;n;)n.leaf?r.push(...n.children):o.push(...n.children),n=o.pop();return r}_build(n,r,o,u){const f=o-r+1;let m=this._maxEntries,d;if(f<=m)return d=hr(n.slice(r,o+1)),ur(d,this.toBBox),d;u||(u=Math.ceil(Math.log(f)/Math.log(m)),m=Math.ceil(f/Math.pow(m,u-1))),d=hr([]),d.leaf=!1,d.height=u;const x=Math.ceil(f/m),v=x*Math.ceil(Math.sqrt(m));vu(n,r,o,v,this.compareMinX);for(let w=r;w<=o;w+=v){const I=Math.min(w+v-1,o);vu(n,w,I,x,this.compareMinY);for(let T=w;T<=I;T+=x){const b=Math.min(T+x-1,I);d.children.push(this._build(n,T,b,u-1))}}return ur(d,this.toBBox),d}_chooseSubtree(n,r,o,u){for(;u.push(r),!(r.leaf||u.length-1===o);){let f=1/0,m=1/0,d;for(let x=0;x<r.children.length;x++){const v=r.children[x],w=$o(v),I=lf(n,v)-w;I<m?(m=I,f=w<f?w:f,d=v):I===m&&w<f&&(f=w,d=v)}r=d||r.children[0]}return r}_insert(n,r,o){const u=o?n:this.toBBox(n),f=[],m=this._chooseSubtree(u,this.data,r,f);for(m.children.push(n),ls(m,u);r>=0&&f[r].children.length>this._maxEntries;)this._split(f,r),r--;this._adjustParentBBoxes(u,f,r)}_split(n,r){const o=n[r],u=o.children.length,f=this._minEntries;this._chooseSplitAxis(o,f,u);const m=this._chooseSplitIndex(o,f,u),d=hr(o.children.splice(m,o.children.length-m));d.height=o.height,d.leaf=o.leaf,ur(o,this.toBBox),ur(d,this.toBBox),r?n[r-1].children.push(d):this._splitRoot(o,d)}_splitRoot(n,r){this.data=hr([n,r]),this.data.height=n.height+1,this.data.leaf=!1,ur(this.data,this.toBBox)}_chooseSplitIndex(n,r,o){let u,f=1/0,m=1/0;for(let d=r;d<=o-r;d++){const x=us(n,0,d,this.toBBox),v=us(n,d,o,this.toBBox),w=hf(x,v),I=$o(x)+$o(v);w<f?(f=w,u=d,m=I<m?I:m):w===f&&I<m&&(m=I,u=d)}return u||o-r}_chooseSplitAxis(n,r,o){const u=n.leaf?this.compareMinX:af,f=n.leaf?this.compareMinY:uf,m=this._allDistMargin(n,r,o,u),d=this._allDistMargin(n,r,o,f);m<d&&n.children.sort(u)}_allDistMargin(n,r,o,u){n.children.sort(u);const f=this.toBBox,m=us(n,0,r,f),d=us(n,o-r,o,f);let x=js(m)+js(d);for(let v=r;v<o-r;v++){const w=n.children[v];ls(m,n.leaf?f(w):w),x+=js(m)}for(let v=o-r-1;v>=r;v--){const w=n.children[v];ls(d,n.leaf?f(w):w),x+=js(d)}return x}_adjustParentBBoxes(n,r,o){for(let u=o;u>=0;u--)ls(r[u],n)}_condense(n){for(let r=n.length-1,o;r>=0;r--)n[r].children.length===0?r>0?(o=n[r-1].children,o.splice(o.indexOf(n[r]),1)):this.clear():ur(n[r],this.toBBox)}}function of(h,n,r){if(!r)return n.indexOf(h);for(let o=0;o<n.length;o++)if(r(h,n[o]))return o;return-1}function ur(h,n){us(h,0,h.children.length,n,h)}function us(h,n,r,o,u){u||(u=hr(null)),u.minX=1/0,u.minY=1/0,u.maxX=-1/0,u.maxY=-1/0;for(let f=n;f<r;f++){const m=h.children[f];ls(u,h.leaf?o(m):m)}return u}function ls(h,n){return h.minX=Math.min(h.minX,n.minX),h.minY=Math.min(h.minY,n.minY),h.maxX=Math.max(h.maxX,n.maxX),h.maxY=Math.max(h.maxY,n.maxY),h}function af(h,n){return h.minX-n.minX}function uf(h,n){return h.minY-n.minY}function $o(h){return(h.maxX-h.minX)*(h.maxY-h.minY)}function js(h){return h.maxX-h.minX+(h.maxY-h.minY)}function lf(h,n){return(Math.max(n.maxX,h.maxX)-Math.min(n.minX,h.minX))*(Math.max(n.maxY,h.maxY)-Math.min(n.minY,h.minY))}function hf(h,n){const r=Math.max(h.minX,n.minX),o=Math.max(h.minY,n.minY),u=Math.min(h.maxX,n.maxX),f=Math.min(h.maxY,n.maxY);return Math.max(0,u-r)*Math.max(0,f-o)}function Jo(h,n){return h.minX<=n.minX&&h.minY<=n.minY&&n.maxX<=h.maxX&&n.maxY<=h.maxY}function Qs(h,n){return n.minX<=h.maxX&&n.minY<=h.maxY&&n.maxX>=h.minX&&n.maxY>=h.minY}function hr(h){return{children:h,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function vu(h,n,r,o,u){const f=[n,r];for(;f.length;){if(r=f.pop(),n=f.pop(),r-n<=o)continue;const m=n+Math.ceil((r-n)/o/2)*o;rf(h,m,n,r,u),f.push(n,m,m,r)}}function cf(h){return ch(h,(n,r)=>n+ff(r),0)}function ff(h){let n=0,r;switch(h.type){case"Polygon":return _u(h.coordinates);case"MultiPolygon":for(r=0;r<h.coordinates.length;r++)n+=_u(h.coordinates[r]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function _u(h){let n=0;if(h&&h.length>0){n+=Math.abs(xu(h[0]));for(let r=1;r<h.length;r++)n-=Math.abs(xu(h[r]))}return n}var gf=be*be/2,jo=Math.PI/180;function xu(h){const n=h.length-1;if(n<=2)return 0;let r=0,o=0;for(;o<n;){const u=h[o],f=h[o+1===n?0:o+1],m=h[o+2>=n?(o+2)%n:o+2],d=u[0]*jo,x=f[1]*jo,v=m[0]*jo;r+=(v-d)*Math.sin(x),o++}return r*gf}const Un=11102230246251565e-32,Ce=134217729,df=(3+8*Un)*Un;function Qo(h,n,r,o,u){let f,m,d,x,v=n[0],w=o[0],I=0,T=0;w>v==w>-v?(f=v,v=n[++I]):(f=w,w=o[++T]);let b=0;if(I<h&&T<r)for(w>v==w>-v?(m=v+f,d=f-(m-v),v=n[++I]):(m=w+f,d=f-(m-w),w=o[++T]),f=m,d!==0&&(u[b++]=d);I<h&&T<r;)w>v==w>-v?(m=f+v,x=m-f,d=f-(m-x)+(v-x),v=n[++I]):(m=f+w,x=m-f,d=f-(m-x)+(w-x),w=o[++T]),f=m,d!==0&&(u[b++]=d);for(;I<h;)m=f+v,x=m-f,d=f-(m-x)+(v-x),v=n[++I],f=m,d!==0&&(u[b++]=d);for(;T<r;)m=f+w,x=m-f,d=f-(m-x)+(w-x),w=o[++T],f=m,d!==0&&(u[b++]=d);return(f!==0||b===0)&&(u[b++]=f),b}function mf(h,n){let r=n[0];for(let o=1;o<h;o++)r+=n[o];return r}function ys(h){return new Float64Array(h)}const pf=(3+16*Un)*Un,yf=(2+12*Un)*Un,vf=(9+64*Un)*Un*Un,lr=ys(4),ku=ys(8),wu=ys(12),Eu=ys(16),Re=ys(4);function _f(h,n,r,o,u,f,m){let d,x,v,w,I,T,b,D,Z,Y,tt,E,G,N,B,z,$,P;const S=h-u,C=r-u,R=n-f,F=o-f;N=S*F,T=Ce*S,b=T-(T-S),D=S-b,T=Ce*F,Z=T-(T-F),Y=F-Z,B=D*Y-(N-b*Z-D*Z-b*Y),z=R*C,T=Ce*R,b=T-(T-R),D=R-b,T=Ce*C,Z=T-(T-C),Y=C-Z,$=D*Y-(z-b*Z-D*Z-b*Y),tt=B-$,I=B-tt,lr[0]=B-(tt+I)+(I-$),E=N+tt,I=E-N,G=N-(E-I)+(tt-I),tt=G-z,I=G-tt,lr[1]=G-(tt+I)+(I-z),P=E+tt,I=P-E,lr[2]=E-(P-I)+(tt-I),lr[3]=P;let V=mf(4,lr),H=yf*m;if(V>=H||-V>=H||(I=h-S,d=h-(S+I)+(I-u),I=r-C,v=r-(C+I)+(I-u),I=n-R,x=n-(R+I)+(I-f),I=o-F,w=o-(F+I)+(I-f),d===0&&x===0&&v===0&&w===0)||(H=vf*m+df*Math.abs(V),V+=S*w+F*d-(R*v+C*x),V>=H||-V>=H))return V;N=d*F,T=Ce*d,b=T-(T-d),D=d-b,T=Ce*F,Z=T-(T-F),Y=F-Z,B=D*Y-(N-b*Z-D*Z-b*Y),z=x*C,T=Ce*x,b=T-(T-x),D=x-b,T=Ce*C,Z=T-(T-C),Y=C-Z,$=D*Y-(z-b*Z-D*Z-b*Y),tt=B-$,I=B-tt,Re[0]=B-(tt+I)+(I-$),E=N+tt,I=E-N,G=N-(E-I)+(tt-I),tt=G-z,I=G-tt,Re[1]=G-(tt+I)+(I-z),P=E+tt,I=P-E,Re[2]=E-(P-I)+(tt-I),Re[3]=P;const X=Qo(4,lr,4,Re,ku);N=S*w,T=Ce*S,b=T-(T-S),D=S-b,T=Ce*w,Z=T-(T-w),Y=w-Z,B=D*Y-(N-b*Z-D*Z-b*Y),z=R*v,T=Ce*R,b=T-(T-R),D=R-b,T=Ce*v,Z=T-(T-v),Y=v-Z,$=D*Y-(z-b*Z-D*Z-b*Y),tt=B-$,I=B-tt,Re[0]=B-(tt+I)+(I-$),E=N+tt,I=E-N,G=N-(E-I)+(tt-I),tt=G-z,I=G-tt,Re[1]=G-(tt+I)+(I-z),P=E+tt,I=P-E,Re[2]=E-(P-I)+(tt-I),Re[3]=P;const q=Qo(X,ku,4,Re,wu);N=d*w,T=Ce*d,b=T-(T-d),D=d-b,T=Ce*w,Z=T-(T-w),Y=w-Z,B=D*Y-(N-b*Z-D*Z-b*Y),z=x*v,T=Ce*x,b=T-(T-x),D=x-b,T=Ce*v,Z=T-(T-v),Y=v-Z,$=D*Y-(z-b*Z-D*Z-b*Y),tt=B-$,I=B-tt,Re[0]=B-(tt+I)+(I-$),E=N+tt,I=E-N,G=N-(E-I)+(tt-I),tt=G-z,I=G-tt,Re[1]=G-(tt+I)+(I-z),P=E+tt,I=P-E,Re[2]=E-(P-I)+(tt-I),Re[3]=P;const Q=Qo(q,wu,4,Re,Eu);return Eu[Q-1]}function xf(h,n,r,o,u,f){const m=(n-f)*(r-u),d=(h-u)*(o-f),x=m-d,v=Math.abs(m+d);return Math.abs(x)>=pf*v?x:-_f(h,n,r,o,u,f,v)}function kf(h,n){var r,o,u=0,f,m,d,x,v,w,I,T=h[0],b=h[1],D=n.length;for(r=0;r<D;r++){o=0;var Z=n[r],Y=Z.length-1;if(w=Z[0],w[0]!==Z[Y][0]&&w[1]!==Z[Y][1])throw new Error("First and last coordinates in a ring must be the same");for(m=w[0]-T,d=w[1]-b,o;o<Y;o++){if(I=Z[o+1],x=I[0]-T,v=I[1]-b,d===0&&v===0){if(x<=0&&m>=0||m<=0&&x>=0)return 0}else if(v>=0&&d<=0||v<=0&&d>=0){if(f=xf(m,x,d,v,0,0),f===0)return 0;(f>0&&v>0&&d<=0||f<0&&v<=0&&d>0)&&u++}w=I,d=v,m=x}}return u%2!==0}function Zn(h,n,r={}){if(!h)throw new Error("point is required");if(!n)throw new Error("polygon is required");const o=ds(h),u=Cn(n),f=u.type,m=n.bbox;let d=u.coordinates;if(m&&wf(o,m)===!1)return!1;f==="Polygon"&&(d=[d]);let x=!1;for(var v=0;v<d.length;++v){const w=kf(o,d[v]);if(w===0)return!r.ignoreBoundary;w&&(x=!0)}return x}function wf(h,n){return n[0]<=h[0]&&n[1]<=h[1]&&n[2]>=h[0]&&n[3]>=h[1]}var Gn=Zn;function Ef(h,n,r){if(h.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");r===void 0&&(r=1);var o=h.geometry.coordinates,u=[],f={};if(r){for(var m=[],d=0;d<o.length;d++)for(var x=0;x<o[d].length-1;x++)m.push(Y(d,x));var v=new dl;v.load(m)}for(var w=0;w<o.length;w++)for(var I=0;I<o[w].length-1;I++)if(r){var T=v.search(Y(w,I));T.forEach(function(tt){var E=tt.ring,G=tt.edge;Z(w,I,E,G)})}else for(var b=0;b<o.length;b++)for(var D=0;D<o[b].length-1;D++)Z(w,I,b,D);return n||(u={type:"Feature",geometry:{type:"MultiPoint",coordinates:u}}),u;function Z(tt,E,G,N){var B=o[tt][E],z=o[tt][E+1],$=o[G][N],P=o[G][N+1],S=Pf(B,z,$,P);if(S!==null){var C,R;if(z[0]!==B[0]?C=(S[0]-B[0])/(z[0]-B[0]):C=(S[1]-B[1])/(z[1]-B[1]),P[0]!==$[0]?R=(S[0]-$[0])/(P[0]-$[0]):R=(S[1]-$[1])/(P[1]-$[1]),!(C>=1||C<=0||R>=1||R<=0)){var F=S,V=!f[F];V&&(f[F]=!0),n?u.push(n(S,tt,E,B,z,C,G,N,$,P,R,V)):u.push(S)}}}function Y(tt,E){var G=o[tt][E],N=o[tt][E+1],B,z,$,P;return G[0]<N[0]?(B=G[0],z=N[0]):(B=N[0],z=G[0]),G[1]<N[1]?($=G[1],P=N[1]):($=N[1],P=G[1]),{minX:B,minY:$,maxX:z,maxY:P,ring:tt,edge:E}}}function Pf(h,n,r,o){if(hs(h,r)||hs(h,o)||hs(n,r)||hs(o,r))return null;var u=h[0],f=h[1],m=n[0],d=n[1],x=r[0],v=r[1],w=o[0],I=o[1],T=(u-m)*(v-I)-(f-d)*(x-w);if(T===0)return null;var b=((u*d-f*m)*(x-w)-(u-m)*(x*I-v*w))/T,D=((u*d-f*m)*(v-I)-(f-d)*(x*I-v*w))/T;return[b,D]}function hs(h,n){if(!h||!n||h.length!==n.length)return!1;for(var r=0,o=h.length;r<o;r++)if(h[r]instanceof Array&&n[r]instanceof Array){if(!hs(h[r],n[r]))return!1}else if(h[r]!==n[r])return!1;return!0}function Lf(h){if(h.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(h.geometry===void 0||h.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(h.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var n=h.geometry.coordinates.length,r=[],E=0;E<n;E++){var o=h.geometry.coordinates[E];cs(o[0],o[o.length-1])||o.push(o[0]);for(var u=0;u<o.length-1;u++)r.push(o[u])}if(!If(r))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var f=r.length,m=Ef(h,function(ht,ft,gt,kt,nt,Kt,bt,vt,K,Rt,qt,St){return[ht,ft,gt,kt,nt,Kt,bt,vt,K,Rt,qt,St]}),d=m.length;if(d==0){for(var $=[],E=0;E<n;E++)$.push(Yn([h.geometry.coordinates[E]],{parent:-1,winding:Mf(h.geometry.coordinates[E])}));var it=Sn($);return J(),ut(),it}for(var x=[],v=[],E=0;E<n;E++){x.push([]);for(var u=0;u<h.geometry.coordinates[E].length-1;u++)x[E].push([new Pu(h.geometry.coordinates[E][fr(u+1,h.geometry.coordinates[E].length-1)],1,[E,u],[E,fr(u+1,h.geometry.coordinates[E].length-1)],void 0)]),v.push(new Lu(h.geometry.coordinates[E][u],[E,fr(u-1,h.geometry.coordinates[E].length-1)],[E,u],void 0,void 0,!1,!0))}for(var E=0;E<d;E++)x[m[E][1]][m[E][2]].push(new Pu(m[E][0],m[E][5],[m[E][1],m[E][2]],[m[E][6],m[E][7]],void 0)),m[E][11]&&v.push(new Lu(m[E][0],[m[E][1],m[E][2]],[m[E][6],m[E][7]],void 0,void 0,!0,!0));for(var w=v.length,E=0;E<x.length;E++)for(var u=0;u<x[E].length;u++)x[E][u].sort(function(ft,gt){return ft.param<gt.param?-1:1});for(var I=[],E=0;E<w;E++)I.push({minX:v[E].coord[0],minY:v[E].coord[1],maxX:v[E].coord[0],maxY:v[E].coord[1],index:E});var T=new dl;T.load(I);for(var E=0;E<x.length;E++)for(var u=0;u<x[E].length;u++)for(var b=0;b<x[E][u].length;b++){var D;b==x[E][u].length-1?D=x[E][fr(u+1,h.geometry.coordinates[E].length-1)][0].coord:D=x[E][u][b+1].coord;var Z=T.search({minX:D[0],minY:D[1],maxX:D[0],maxY:D[1]})[0];x[E][u][b].nxtIsectAlongEdgeIn=Z.index}for(var E=0;E<x.length;E++)for(var u=0;u<x[E].length;u++)for(var b=0;b<x[E][u].length;b++){var D=x[E][u][b].coord,Z=T.search({minX:D[0],minY:D[1],maxX:D[0],maxY:D[1]})[0],Y=Z.index;Y<f?v[Y].nxtIsectAlongRingAndEdge2=x[E][u][b].nxtIsectAlongEdgeIn:cs(v[Y].ringAndEdge1,x[E][u][b].ringAndEdgeIn)?v[Y].nxtIsectAlongRingAndEdge1=x[E][u][b].nxtIsectAlongEdgeIn:v[Y].nxtIsectAlongRingAndEdge2=x[E][u][b].nxtIsectAlongEdgeIn}for(var tt=[],E=0,u=0;u<n;u++){for(var G=E,b=0;b<h.geometry.coordinates[u].length-1;b++)v[E].coord[0]<v[G].coord[0]&&(G=E),E++;for(var N=v[G].nxtIsectAlongRingAndEdge2,b=0;b<v.length;b++)if(v[b].nxtIsectAlongRingAndEdge1==G||v[b].nxtIsectAlongRingAndEdge2==G){var B=b;break}var z=ao([v[B].coord,v[G].coord,v[N].coord],!0)?1:-1;tt.push({isect:G,parent:-1,winding:z})}tt.sort(function(pt,ht){return v[pt.isect].coord>v[ht.isect].coord?-1:1});for(var $=[];tt.length>0;){var P=tt.pop(),S=P.isect,C=P.parent,R=P.winding,F=$.length,V=[v[S].coord],H=S;if(v[S].ringAndEdge1Walkable)var X=v[S].ringAndEdge1,q=v[S].nxtIsectAlongRingAndEdge1;else var X=v[S].ringAndEdge2,q=v[S].nxtIsectAlongRingAndEdge2;for(;!cs(v[S].coord,v[q].coord);){V.push(v[q].coord);for(var Q=void 0,E=0;E<tt.length;E++)if(tt[E].isect==q){Q=E;break}if(Q!=null&&tt.splice(Q,1),cs(X,v[q].ringAndEdge1)){if(X=v[q].ringAndEdge2,v[q].ringAndEdge2Walkable=!1,v[q].ringAndEdge1Walkable){var W={isect:q};ao([v[H].coord,v[q].coord,v[v[q].nxtIsectAlongRingAndEdge2].coord],R==1)?(W.parent=C,W.winding=-R):(W.parent=F,W.winding=R),tt.push(W)}H=q,q=v[q].nxtIsectAlongRingAndEdge2}else{if(X=v[q].ringAndEdge1,v[q].ringAndEdge1Walkable=!1,v[q].ringAndEdge2Walkable){var W={isect:q};ao([v[H].coord,v[q].coord,v[v[q].nxtIsectAlongRingAndEdge1].coord],R==1)?(W.parent=C,W.winding=-R):(W.parent=F,W.winding=R),tt.push(W)}H=q,q=v[q].nxtIsectAlongRingAndEdge1}}V.push(v[q].coord),$.push(Yn([V],{index:F,parent:C,winding:R,netWinding:void 0}))}var it=Sn($);J(),ut();function J(){for(var pt=[],ht=0;ht<it.features.length;ht++)it.features[ht].properties.parent==-1&&pt.push(ht);if(pt.length>1)for(var ht=0;ht<pt.length;ht++){for(var ft=-1,gt=1/0,kt=0;kt<it.features.length;kt++)pt[ht]!=kt&&Zn(it.features[pt[ht]].geometry.coordinates[0][0],it.features[kt],{ignoreBoundary:!0})&&cf(it.features[kt])<gt&&(ft=kt);it.features[pt[ht]].properties.parent=ft}}function ut(){for(var pt=0;pt<it.features.length;pt++)if(it.features[pt].properties.parent==-1){var ht=it.features[pt].properties.winding;it.features[pt].properties.netWinding=ht,ct(pt,ht)}}function ct(pt,ht){for(var ft=0;ft<it.features.length;ft++)if(it.features[ft].properties.parent==pt){var gt=ht+it.features[ft].properties.winding;it.features[ft].properties.netWinding=gt,ct(ft,gt)}}return it}var Pu=function(h,n,r,o,u){this.coord=h,this.param=n,this.ringAndEdgeIn=r,this.ringAndEdgeOut=o,this.nxtIsectAlongEdgeIn=u},Lu=function(h,n,r,o,u,f,m){this.coord=h,this.ringAndEdge1=n,this.ringAndEdge2=r,this.nxtIsectAlongRingAndEdge1=o,this.nxtIsectAlongRingAndEdge2=u,this.ringAndEdge1Walkable=f,this.ringAndEdge2Walkable=m};function ao(h,n){if(typeof n>"u"&&(n=!0),h.length!=3)throw new Error("This function requires an array of three points [x,y]");var r=(h[1][0]-h[0][0])*(h[2][1]-h[0][1])-(h[1][1]-h[0][1])*(h[2][0]-h[0][0]);return r>=0==n}function Mf(h){for(var n=0,r=0;r<h.length-1;r++)h[r][0]<h[n][0]&&(n=r);if(ao([h[fr(n-1,h.length-1)],h[n],h[fr(n+1,h.length-1)]],!0))var o=1;else var o=-1;return o}function cs(h,n){if(!h||!n||h.length!=n.length)return!1;for(var r=0,o=h.length;r<o;r++)if(h[r]instanceof Array&&n[r]instanceof Array){if(!cs(h[r],n[r]))return!1}else if(h[r]!=n[r])return!1;return!0}function fr(h,n){return(h%n+n)%n}function If(h){for(var n={},r=1,o=0,u=h.length;o<u;++o){if(Object.prototype.hasOwnProperty.call(n,h[o])){r=0;break}n[h[o]]=1}return r}function Sf(h){var n=[];return Ru(h,function(r){r.geometry.type==="Polygon"&&li(Lf(r),function(o){n.push(Yn(o.geometry.coordinates,r.properties))})}),Sn(n)}var ta=Sf;function vo(h,n,r={}){const o=ds(h),u=gr(n);for(let f=0;f<u.length-1;f++){let m=!1;if(r.ignoreEndVertices&&(f===0&&(m="start"),f===u.length-2&&(m="end"),f===0&&f+1===u.length-1&&(m="both")),Cf(u[f],u[f+1],o,m,typeof r.epsilon>"u"?null:r.epsilon))return!0}return!1}function Cf(h,n,r,o,u){const f=r[0],m=r[1],d=h[0],x=h[1],v=n[0],w=n[1],I=r[0]-d,T=r[1]-x,b=v-d,D=w-x,Z=I*D-T*b;if(u!==null){if(Math.abs(Z)>u)return!1}else if(Z!==0)return!1;if(Math.abs(b)===Math.abs(D)&&Math.abs(b)===0)return o?!1:r[0]===h[0]&&r[1]===h[1];if(o){if(o==="start")return Math.abs(b)>=Math.abs(D)?b>0?d<f&&f<=v:v<=f&&f<d:D>0?x<m&&m<=w:w<=m&&m<x;if(o==="end")return Math.abs(b)>=Math.abs(D)?b>0?d<=f&&f<v:v<f&&f<=d:D>0?x<=m&&m<w:w<m&&m<=x;if(o==="both")return Math.abs(b)>=Math.abs(D)?b>0?d<f&&f<v:v<f&&f<d:D>0?x<m&&m<w:w<m&&m<x}else return Math.abs(b)>=Math.abs(D)?b>0?d<=f&&f<=v:v<=f&&f<=d:D>0?x<=m&&m<=w:w<=m&&m<=x;return!1}function bf(h,n){var r=Cn(h),o=Cn(n),u=r.type,f=o.type;switch(u){case"Point":switch(f){case"MultiPoint":return Tf(r,o);case"LineString":return vo(r,o,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return Zn(r,o,{ignoreBoundary:!0});default:throw new Error("feature2 "+f+" geometry not supported")}case"MultiPoint":switch(f){case"MultiPoint":return Nf(r,o);case"LineString":return Of(r,o);case"Polygon":case"MultiPolygon":return Af(r,o);default:throw new Error("feature2 "+f+" geometry not supported")}case"LineString":switch(f){case"LineString":return Df(r,o);case"Polygon":case"MultiPolygon":return Rf(r,o);default:throw new Error("feature2 "+f+" geometry not supported")}case"Polygon":switch(f){case"Polygon":case"MultiPolygon":return Ff(r,o);default:throw new Error("feature2 "+f+" geometry not supported")}default:throw new Error("feature1 "+u+" geometry not supported")}}function Tf(h,n){var r,o=!1;for(r=0;r<n.coordinates.length;r++)if(pl(n.coordinates[r],h.coordinates)){o=!0;break}return o}function Nf(h,n){for(var r=0;r<h.coordinates.length;r++){for(var o=!1,u=0;u<n.coordinates.length;u++)pl(h.coordinates[r],n.coordinates[u])&&(o=!0);if(!o)return!1}return!0}function Of(h,n){for(var r=!1,o=0;o<h.coordinates.length;o++){if(!vo(h.coordinates[o],n))return!1;r||(r=vo(h.coordinates[o],n,{ignoreEndVertices:!0}))}return r}function Af(h,n){for(var r=!0,o=!1,u=0;u<h.coordinates.length;u++){if(o=Zn(h.coordinates[u],n),!o){r=!1;break}o=Zn(h.coordinates[u],n,{ignoreBoundary:!0})}return r&&o}function Df(h,n){for(var r=0;r<h.coordinates.length;r++)if(!vo(h.coordinates[r],n))return!1;return!0}function Rf(h,n){var r=dr(n),o=dr(h);if(!ml(r,o))return!1;for(var u=!1,f=0;f<h.coordinates.length;f++){if(!Zn(h.coordinates[f],n))return!1;if(u||(u=Zn(h.coordinates[f],n,{ignoreBoundary:!0})),!u&&f<h.coordinates.length-1){var m=Bf(h.coordinates[f],h.coordinates[f+1]);u=Zn(m,n,{ignoreBoundary:!0})}}return u}function Ff(h,n){var r=dr(h),o=dr(n);if(!ml(o,r))return!1;for(var u=0;u<h.coordinates[0].length;u++)if(!Zn(h.coordinates[0][u],n))return!1;return!0}function ml(h,n){return!(h[0]>n[0]||h[2]<n[2]||h[1]>n[1]||h[3]<n[3])}function pl(h,n){return h[0]===n[0]&&h[1]===n[1]}function Bf(h,n){return[(h[0]+n[0])/2,(h[1]+n[1])/2]}var Mu=bf,zf=Object.defineProperty,_r=(h,n)=>zf(h,"name",{value:n,configurable:!0}),yl=class{constructor(n){this.direction=!1,this.compareProperties=!0;var r,o,u;this.precision=10**-((r=n==null?void 0:n.precision)!=null?r:17),this.direction=(o=n==null?void 0:n.direction)!=null?o:!1,this.compareProperties=(u=n==null?void 0:n.compareProperties)!=null?u:!0}compare(n,r){if(n.type!==r.type||!fs(n,r))return!1;switch(n.type){case"Point":return this.compareCoord(n.coordinates,r.coordinates);case"LineString":return this.compareLine(n.coordinates,r.coordinates);case"Polygon":return this.comparePolygon(n,r);case"GeometryCollection":return this.compareGeometryCollection(n,r);case"Feature":return this.compareFeature(n,r);case"FeatureCollection":return this.compareFeatureCollection(n,r);default:if(n.type.startsWith("Multi")){const o=fa(n),u=fa(r);return o.every(f=>u.some(m=>this.compare(f,m)))}}return!1}compareCoord(n,r){return n.length===r.length&&n.every((o,u)=>Math.abs(o-r[u])<this.precision)}compareLine(n,r,o=0,u=!1){if(!fs(n,r))return!1;const f=n;let m=r;if(u&&!this.compareCoord(f[0],m[0])){const x=this.fixStartIndex(m,f);if(x)m=x;else return!1}const d=this.compareCoord(f[o],m[o]);return this.direction||d?this.comparePath(f,m):this.compareCoord(f[o],m[m.length-(1+o)])?this.comparePath(f.slice().reverse(),m):!1}fixStartIndex(n,r){let o,u=-1;for(let f=0;f<n.length;f++)if(this.compareCoord(n[f],r[0])){u=f;break}return u>=0&&(o=[].concat(n.slice(u,n.length),n.slice(1,u+1))),o}comparePath(n,r){return n.every((o,u)=>this.compareCoord(o,r[u]))}comparePolygon(n,r){if(this.compareLine(n.coordinates[0],r.coordinates[0],1,!0)){const o=n.coordinates.slice(1,n.coordinates.length),u=r.coordinates.slice(1,r.coordinates.length);return o.every(f=>u.some(m=>this.compareLine(f,m,1,!0)))}return!1}compareGeometryCollection(n,r){return fs(n.geometries,r.geometries)&&this.compareBBox(n,r)&&n.geometries.every((o,u)=>this.compare(o,r.geometries[u]))}compareFeature(n,r){return n.id===r.id&&(this.compareProperties?pa(n.properties,r.properties):!0)&&this.compareBBox(n,r)&&this.compare(n.geometry,r.geometry)}compareFeatureCollection(n,r){return fs(n.features,r.features)&&this.compareBBox(n,r)&&n.features.every((o,u)=>this.compare(o,r.features[u]))}compareBBox(n,r){return!n.bbox&&!r.bbox||(n.bbox&&r.bbox?this.compareCoord(n.bbox,r.bbox):!1)}};_r(yl,"GeojsonEquality");var Gf=yl;function fs(h,n){return h.coordinates?h.coordinates.length===n.coordinates.length:h.length===n.length}_r(fs,"sameLength");function fa(h){return h.coordinates.map(n=>({type:h.type.replace("Multi",""),coordinates:n}))}_r(fa,"explode");function vl(h,n,r){return new Gf(r).compare(h,n)}_r(vl,"geojsonEquality");function pa(h,n){if(h===null&&n===null)return!0;if(h===null||n===null)return!1;const r=Object.keys(h),o=Object.keys(n);if(r.length!==o.length)return!1;for(var u of r){const f=h[u],m=n[u],d=Iu(f)&&Iu(m);if(d&&!pa(f,m)||!d&&f!==m)return!1}return!0}_r(pa,"equal");var Iu=_r(h=>h!=null&&typeof h=="object","isObject");function Hf(h,n,r={}){let o=r.precision;if(o=o==null||isNaN(o)?6:o,typeof o!="number"||!(o>=0))throw new Error("precision must be a positive number");const u=Cn(h).type,f=Cn(n).type;return u!==f?!1:vl(ha(h),ha(n),{precision:o})}var qf=Hf;function _l(h,n,r={}){var o=ds(h),u=ds(n),f=Gs(u[1]-o[1]),m=Gs(u[0]-o[0]),d=Gs(o[1]),x=Gs(u[1]),v=Math.pow(Math.sin(f/2),2)+Math.pow(Math.sin(m/2),2)*Math.cos(d)*Math.cos(x);return Du(2*Math.atan2(Math.sqrt(v),Math.sqrt(1-v)),r.units)}var Uf=Object.defineProperty,Zf=Object.defineProperties,Yf=Object.getOwnPropertyDescriptors,Su=Object.getOwnPropertySymbols,Vf=Object.prototype.hasOwnProperty,Xf=Object.prototype.propertyIsEnumerable,Cu=(h,n,r)=>n in h?Uf(h,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[n]=r,bu=(h,n)=>{for(var r in n||(n={}))Vf.call(n,r)&&Cu(h,r,n[r]);if(Su)for(var r of Su(n))Xf.call(n,r)&&Cu(h,r,n[r]);return h},Tu=(h,n)=>Zf(h,Yf(n));function Wf(h,n,r={}){if(!h)throw new Error("targetPoint is required");if(!n)throw new Error("points is required");let o=1/0,u=0;li(n,(m,d)=>{const x=_l(h,m,r);x<o&&(u=d,o=x)});const f=da(n.features[u]);return Tu(bu({},f),{properties:Tu(bu({},f.properties),{featureIndex:u,distanceToPoint:o})})}var Kf=Wf;function $f(h,n={}){const r=Cn(h);switch(!n.properties&&h.type==="Feature"&&(n.properties=h.properties),r.type){case"Polygon":return Jf(r,n);case"MultiPolygon":return jf(r,n);default:throw new Error("invalid poly")}}function Jf(h,n={}){const o=Cn(h).coordinates,u=n.properties?n.properties:h.type==="Feature"?h.properties:{};return xl(o,u)}function jf(h,n={}){const o=Cn(h).coordinates,u=n.properties?n.properties:h.type==="Feature"?h.properties:{},f=[];return o.forEach(m=>{f.push(xl(m,u))}),Sn(f)}function xl(h,n){return h.length>1?uh(h,n):xo(h[0],n)}var Qf=$f;function tg(h,n={}){var r,o,u,f=n.properties,m=(r=n.autoComplete)!=null?r:!0,d=(o=n.orderCoords)!=null?o:!0,x=(u=n.mutate)!=null?u:!1;switch(x||(h=da(h)),h.type){case"FeatureCollection":var v=[];return h.features.forEach(function(w){v.push(gr(Nu(w,{},m,d)))}),ko(v,f);default:return Nu(h,f,m,d)}}function Nu(h,n,r,o){n=n||(h.type==="Feature"?h.properties:{});var u=Cn(h),f=u.coordinates,m=u.type;if(!f.length)throw new Error("line must contain coordinates");switch(m){case"LineString":return r&&(f=Ou(f)),Yn([f],n);case"MultiLineString":var d=[],x=0;return f.forEach(function(v){if(r&&(v=Ou(v)),o){var w=eg(dr(xo(v)));w>x?(d.unshift(v),x=w):d.push(v)}else d.push(v)}),Yn(d,n);default:throw new Error("geometry type "+m+" is not supported")}}function Ou(h){var n=h[0],r=n[0],o=n[1],u=h[h.length-1],f=u[0],m=u[1];return(r!==f||o!==m)&&h.push(n),h}function eg(h){var n=h[0],r=h[1],o=h[2],u=h[3];return Math.abs(n-o)*Math.abs(r-u)}var ng=tg,ig=class{constructor(h){this.points=h.points||[],this.duration=h.duration||1e4,this.sharpness=h.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=h.stepLength||60,this.length=this.points.length,this.delay=0;for(let n=0;n<this.length;n++)this.points[n].z=this.points[n].z||0;for(let n=0;n<this.length-1;n++){const r=this.points[n],o=this.points[n+1];this.centers.push({x:(r.x+o.x)/2,y:(r.y+o.y)/2,z:(r.z+o.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(let n=0;n<this.centers.length-1;n++){const r=this.points[n+1].x-(this.centers[n].x+this.centers[n+1].x)/2,o=this.points[n+1].y-(this.centers[n].y+this.centers[n+1].y)/2,u=this.points[n+1].z-(this.centers[n].y+this.centers[n+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[n+1].x+this.sharpness*(this.centers[n].x+r),y:(1-this.sharpness)*this.points[n+1].y+this.sharpness*(this.centers[n].y+o),z:(1-this.sharpness)*this.points[n+1].z+this.sharpness*(this.centers[n].z+u)},{x:(1-this.sharpness)*this.points[n+1].x+this.sharpness*(this.centers[n+1].x+r),y:(1-this.sharpness)*this.points[n+1].y+this.sharpness*(this.centers[n+1].y+o),z:(1-this.sharpness)*this.points[n+1].z+this.sharpness*(this.centers[n+1].z+u)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}cacheSteps(h){const n=[];let r=this.pos(0);n.push(0);for(let o=0;o<this.duration;o+=10){const u=this.pos(o);Math.sqrt((u.x-r.x)*(u.x-r.x)+(u.y-r.y)*(u.y-r.y)+(u.z-r.z)*(u.z-r.z))>h&&(n.push(o),r=u)}return n}vector(h){const n=this.pos(h+10),r=this.pos(h-10);return{angle:180*Math.atan2(n.y-r.y,n.x-r.x)/3.14,speed:Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)+(r.z-n.z)*(r.z-n.z))}}pos(h){let n=h-this.delay;n<0&&(n=0),n>this.duration&&(n=this.duration-1);const r=n/this.duration;if(r>=1)return this.points[this.length-1];const o=Math.floor((this.points.length-1)*r),u=(this.length-1)*r-o;return rg(u,this.points[o],this.controls[o][1],this.controls[o+1][0],this.points[o+1])}};function rg(h,n,r,o,u){const f=sg(h);return{x:u.x*f[0]+o.x*f[1]+r.x*f[2]+n.x*f[3],y:u.y*f[0]+o.y*f[1]+r.y*f[2]+n.y*f[3],z:u.z*f[0]+o.z*f[1]+r.z*f[2]+n.z*f[3]}}function sg(h){const n=h*h;return[n*h,3*n*(1-h),3*h*(1-h)*(1-h),(1-h)*(1-h)*(1-h)]}function og(h,n={}){const r=n.resolution||1e4,o=n.sharpness||.85,u=[],f=Cn(h).coordinates.map(v=>({x:v[0],y:v[1]})),m=new ig({duration:r,points:f,sharpness:o}),d=v=>{var w=m.pos(v);Math.floor(v/100)%2===0&&u.push([w.x,w.y])};for(var x=0;x<m.duration;x+=10)d(x);return d(m.duration),xo(u,n.properties)}var ag=og;function ug(h,n={}){return gh(h,(r,o)=>{const u=o.geometry.coordinates;return r+_l(u[0],u[1],n)},0)}var lg=ug;const ga=()=>"ontouchstart"in window||navigator.maxTouchPoints>0;function Wt(){return typeof vitest<"u"}class hg{static getBounds(n,r=0){const o=[];n.forEach(m=>{isNaN(m.lat)||isNaN(m.lng),o.push(m)});const f=new ot.Polyline(o).getBounds();return r!==0?f.pad(r):f}}class cg{constructor(n=0,r=0,o=0,u=0){at(this,"direction",{East:new ot.LatLng(0,0),North:new ot.LatLng(0,0),NorthEast:new ot.LatLng(0,0),NorthWest:new ot.LatLng(0,0),South:new ot.LatLng(0,0),SouthEast:new ot.LatLng(0,0),SouthWest:new ot.LatLng(0,0),West:new ot.LatLng(0,0)}),this.direction.North=new ot.LatLng(o,(r+u)/2),this.direction.NorthEast=new ot.LatLng(o,u),this.direction.East=new ot.LatLng((n+o)/2,u),this.direction.SouthEast=new ot.LatLng(n,u),this.direction.South=new ot.LatLng(n,(r+u)/2),this.direction.SouthWest=new ot.LatLng(n,r),this.direction.West=new ot.LatLng((n+o)/2,r),this.direction.NorthWest=new ot.LatLng(o,r)}getDirection(n){switch(n){case sn.SouthWest:return this.direction.SouthWest;case sn.West:return this.direction.West;case sn.NorthWest:return this.direction.NorthWest;case sn.North:return this.direction.North;case sn.NorthEast:return this.direction.NorthEast;case sn.East:return this.direction.East;case sn.SouthEast:return this.direction.SouthEast;case sn.South:return this.direction.South;default:throw new Error}}getPositions(n=sn.SouthWest,r=!1,o=!0){const u=[],f=this.getPositionAsArray(n,r);return f.forEach(m=>{u.push([m.lng,m.lat])}),o&&u.push([f[0].lng,f[0].lat]),u}getPositionAsArray(n=sn.NorthEast,r=!1){const o=[];return r?(o.push(this.direction.SouthWest),o.push(this.direction.West),o.push(this.direction.NorthWest),o.push(this.direction.North),o.push(this.direction.NorthEast),o.push(this.direction.East),o.push(this.direction.SouthEast),o.push(this.direction.South)):(o.push(this.direction.SouthWest),o.push(this.direction.South),o.push(this.direction.SouthEast),o.push(this.direction.East),o.push(this.direction.NorthEast),o.push(this.direction.North),o.push(this.direction.NorthWest),o.push(this.direction.West)),n!==sn.SouthWest&&o.splice(0,n).forEach((f,m)=>{o.splice(n+m,0,f)}),o}}class fg{constructor(n,r){if(at(this,"metricLength",""),at(this,"metricUnit",""),at(this,"imperialLength",""),at(this,"imperialUnit",""),n!==null||n!==void 0){n===0?r.markers.markerInfoIcon.usePerimeterMinValue?(this.metricLength=r.markers.markerInfoIcon.values.min.metric,this.metricUnit=r.markers.markerInfoIcon.units.metric.perimeter.m,this.imperialLength=r.markers.markerInfoIcon.values.min.imperial,this.imperialUnit=r.markers.markerInfoIcon.units.imperial.perimeter.feet):(this.metricLength=r.markers.markerInfoIcon.values.unknown.metric,this.metricUnit=r.markers.markerInfoIcon.units.unknownUnit,this.imperialLength=r.markers.markerInfoIcon.values.unknown.imperial,this.imperialUnit=r.markers.markerInfoIcon.units.unknownUnit):n<100?(this.metricLength=(Math.ceil(n/10)*10).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.perimeter.m):n<500?(this.metricLength=(Math.ceil(n/50)*50).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.perimeter.m):n<1e3?(this.metricLength=(Math.ceil(n/100)*100).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.perimeter.m):n<1e4?(this.metricLength=(Math.ceil(n/100)*100/1e3).toFixed(1),this.metricUnit=r.markers.markerInfoIcon.units.metric.perimeter.km):(this.metricLength=(Math.ceil(n/1e3)*1e3/1e3).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.perimeter.km);const u=n/.0254/12,f=u/3,m=f/1760;n<1e3/2.54?(this.imperialLength=(Math.ceil(u/10)*10).toString(),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.perimeter.feet):n<1e3/2.54*3?(this.imperialLength=(Math.ceil(f/10)*10).toString(),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.perimeter.yards):n<1609?(this.imperialLength=m.toFixed(2),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.perimeter.miles):n<16093?(this.imperialLength=m.toFixed(1),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.perimeter.miles):(this.imperialLength=m.toFixed(0),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.perimeter.miles)}}}class gg{constructor(n,r){at(this,"metricArea",""),at(this,"metricUnit",""),at(this,"imperialArea",""),at(this,"imperialUnit","");const o=n,u=r.markers.markerInfoIcon.units.metric.onlyMetrics;if(o!==null||o!==void 0){o===0?(this.metricArea="-",this.metricUnit=r.markers.markerInfoIcon.units.unknownUnit,this.imperialArea="-",this.imperialUnit=r.markers.markerInfoIcon.units.unknownUnit):o<1e4?(this.metricArea=Math.round(o).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.m2):o<1e5?u?(this.metricArea=(o/1e6).toFixed(2),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.km2):(this.metricArea=(o/1e3).toFixed(1),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.daa):o<1e7?u?(this.metricArea=(o/1e6).toFixed(2),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.km2):(this.metricArea=Math.round(o/1e3).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.daa):o<1e8?u?(this.metricArea=(o/1e6).toFixed(1),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.km2):(this.metricArea=Math.round(o/1e4).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.ha):(this.metricArea=Math.round(o/1e6).toString(),this.metricUnit=r.markers.markerInfoIcon.units.metric.area.km2);const m=o*1550*.0069444,d=m*.11111,x=d*20661e-8,v=d*32283e-11;o<92.9?(this.imperialArea=Math.round(m).toString(),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.feet2):o<836.14?(this.imperialArea=d.toFixed(0),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.yards2):o<40469.6?(this.imperialArea=x.toFixed(2),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.acres):o<404696?(this.imperialArea=x.toFixed(1),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.acres):o<4046960?(this.imperialArea=x.toFixed(0),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.acres):o<25900404?(this.imperialArea=v.toFixed(2),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.miles2):o<259004040?(this.imperialArea=v.toFixed(1),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.miles2):(this.imperialArea=v.toFixed(0),this.imperialUnit=r.markers.markerInfoIcon.units.imperial.area.miles2)}}}class kl{constructor(n){at(this,"config",Ni),this.config={...Ni,...n}}union(n,r){try{const o=or([n,r]),u=oc(o);return u?this.getTurfPolygon(u):null}catch(o){return Wt()||console.warn("Error in union:",o instanceof Error?o.message:String(o)),null}}createPolygonFromTrace(n){var r;const o=((r=this.config.polygonCreation)==null?void 0:r.method)||"concaveman";switch(o){case"concaveman":return this.turfConcaveman(n);case"convex":return this.createConvexPolygon(n);case"direct":return this.createDirectPolygon(n);case"buffer":return this.createBufferedPolygon(n);default:return Wt()||console.warn(`Unknown polygon creation method: ${o}, falling back to concaveman`),this.turfConcaveman(n)}}turfConcaveman(n){const o=ar(n).features.map(u=>u.geometry.coordinates);return sr([[Bu(o)]])}createConvexPolygon(n){const r=ar(n),o=Ga(r);return o?this.getTurfPolygon(o):this.createDirectPolygon(n)}createDirectPolygon(n){let r;if(n.geometry.type==="LineString"?r=n.geometry.coordinates:n.geometry.type==="Polygon"?r=n.geometry.coordinates[0]:r=ar(n).features.map(u=>u.geometry.coordinates),r.length>0){const o=r[0],u=r[r.length-1];(o[0]!==u[0]||o[1]!==u[1])&&r.push([o[0],o[1]])}return r.length<4?(Wt()||console.warn("Not enough points for direct polygon, falling back to concaveman"),this.turfConcaveman(n)):sr([[r]])}createBufferedPolygon(n){try{let r;if(n.geometry.type==="LineString")r=n;else{const f=ar(n).features.map(m=>m.geometry.coordinates);r=Go(f)}const o=Vc(r,.001,{units:"kilometers"});return o?this.getTurfPolygon(o):this.createDirectPolygon(n)}catch(r){return Wt()||console.warn("Buffer polygon creation failed:",r instanceof Error?r.message:String(r)),this.createDirectPolygon(n)}}getSimplified(n,r=!1){var o,u,f,m,d,x;const v=((u=(o=this.config.polygonCreation)==null?void 0:o.simplification)==null?void 0:u.mode)||"simple";if(v==="simple"){const w={tolerance:((m=(f=this.config.polygonCreation)==null?void 0:f.simplification)==null?void 0:m.tolerance)||1e-4,highQuality:((x=(d=this.config.polygonCreation)==null?void 0:d.simplification)==null?void 0:x.highQuality)||!1,mutate:!1};return ts(n,w)}else if(v==="dynamic"){const w=n.geometry.coordinates[0][0].length,I=this.config.simplification.simplifyTolerance;if(r){let T=ts(n,I);const b=this.config.simplification.dynamicMode.fractionGuard,D=this.config.simplification.dynamicMode.multiplier;for(;T.geometry.coordinates[0][0].length>4&&T.geometry.coordinates[0][0].length/(w+2)>b;)I.tolerance=I.tolerance*D,T=ts(n,I);return T}else return ts(n,I)}else return v==="none"?n:(Wt()||console.warn(`Unknown simplification mode: ${v}, falling back to simple`),ts(n,{tolerance:1e-4,highQuality:!1,mutate:!1}))}getTurfPolygon(n){let r;return n.geometry.type==="Polygon"?r=sr([n.geometry.coordinates]):r=sr(n.geometry.coordinates),r}getMultiPolygon(n){return sr(n)}getKinks(n){try{if(!n||!n.geometry||!n.geometry.coordinates)return[n];const r=this.removeDuplicateVertices(n);if(!r||!r.geometry||!r.geometry.coordinates)return Wt()||console.warn("Feature became invalid after cleaning in getKinks"),[n];if(this.polygonHasHoles(r))return this.getKinksWithHolePreservation(r);{const u=ta(r),f=[];return li(u,m=>{f.push(m)}),f}}catch(r){return Wt()||console.warn("Error processing kinks:",r instanceof Error?r.message:String(r)),[n]}}getCoords(n){return Ti(n)}hasKinks(n){return yu(n).features.length>0}getConvexHull(n){try{const r=or([n]);return Ga(r)}catch(r){return Wt()||console.warn("Error in getConvexHull:",r instanceof Error?r.message:String(r)),null}}getMidpoint(n,r){const o=Ie([n.lng,n.lat]),u=Ie([r.lng,r.lat]),f=Na(o,u);return{lat:f.geometry.coordinates[1],lng:f.geometry.coordinates[0]}}polygonIntersect(n,r){try{if(!n||!n.geometry||!n.geometry.coordinates||!r||!r.geometry||!r.geometry.coordinates)return Wt()||console.warn("Invalid features passed to polygonIntersect"),!1;const o=u=>{if(!Array.isArray(u))return!1;for(const f of u){if(!Array.isArray(f))return!1;for(const m of f)if(!Array.isArray(m)||m.length<2||m.some(d=>d==null||!isFinite(d)))return!1}return!0};if(!o(n.geometry.coordinates)||!o(r.geometry.coordinates))return!1;try{const u=or([n,r]),f=$a(u);if(f&&f.geometry&&(f.geometry.type==="Polygon"||f.geometry.type==="MultiPolygon")&&Ho(f)>1e-6)return!0}catch{}try{const u=ar(n),f=ar(r);for(const m of f.features)if(Gn(m,n))return!0;for(const m of u.features)if(Gn(m,r))return!0}catch{}try{const u=Ti(n),f=Ti(r);for(const m of u){const d=m[0];if(!(!d||d.length<2))for(let x=0;x<d.length-1;x++){const v=d[x],w=d[x+1];if(!v||!w||!Array.isArray(v)||!Array.isArray(w)||v.length<2||w.length<2||v.some(T=>T==null||!isFinite(T))||w.some(T=>T==null||!isFinite(T)))continue;const I=Go([v,w]);for(const T of f){const b=T[0];if(!(!b||b.length<2))for(let D=0;D<b.length-1;D++){const Z=b[D],Y=b[D+1];if(!Z||!Y||!Array.isArray(Z)||!Array.isArray(Y)||Z.length<2||Y.length<2||Z.some(E=>E==null||!isFinite(E))||Y.some(E=>E==null||!isFinite(E)))continue;const tt=Go([Z,Y]);try{const E=Bh(I,tt);if(E&&E.features&&E.features.length>0)return!0}catch{}}}}}}catch{}return!1}catch(o){return Wt()||console.warn("Error in polygonIntersect:",o instanceof Error?o.message:String(o)),!1}}getIntersection(n,r){try{const o=or([n,r]),u=$a(o);return u&&u.geometry&&(u.geometry.type==="Polygon"||u.geometry.type==="MultiPolygon")?u:null}catch(o){return Wt()||console.warn("Error in getIntersection:",o instanceof Error?o.message:String(o)),null}}getDistance(n,r){return Ta(n,r)}isWithin(n,r){return Mu(dn([n]),dn([r]))}isPolygonCompletelyWithin(n,r){try{return Mu(n,r)}catch{const u=Ti(n),f=Ti(r);for(const m of u)for(const d of m)for(const x of d){const v=Ie(x);let w=!1;for(const I of f){for(const T of I){const b=dn([T]);if(Gn(v,b)){w=!0;break}}if(w)break}if(!w)return!1}return!0}}toPointFeature(n){var r,o;if((n==null?void 0:n.type)==="Feature"&&((r=n.geometry)==null?void 0:r.type)==="Point")return n;if(Array.isArray(n)&&n.length>=2&&typeof n[0]=="number"&&typeof n[1]=="number")return Ie(n);if(typeof(n==null?void 0:n.lat)=="number"&&typeof(n==null?void 0:n.lng)=="number"){const u=n;return Ie([u.lng,u.lat])}if((o=n==null?void 0:n.geometry)!=null&&o.coordinates&&Array.isArray(n.geometry.coordinates))return Ie(n.geometry.coordinates);throw new Error("Unsupported point format provided to toPointFeature")}isPointInsidePolygon(n,r){try{const o=this.toPointFeature(n);return Gn(o,r)}catch{return!1}}equalPolygons(n,r){return qf(n,r)}convertToBoundingBoxPolygon(n){const r=rh(n);return sh(r)}polygonToMultiPolygon(n){return sr([n.geometry.coordinates])}injectPointToPolygon(n,r,o){const u=JSON.parse(JSON.stringify(n));let f;if(u.geometry.type==="MultiPolygon")f=u.geometry.coordinates[0][o];else if(u.geometry.type==="Polygon")f=u.geometry.coordinates[o];else return u;if(!f)return u;let m=1/0,d=0;for(let x=0;x<f.length-1;x++){const v=f[x],w=f[x+1],I=this.distanceToLineSegment(r,v,w);I<m&&(m=I,d=x+1)}return f.splice(d,0,r),u}distanceToLineSegment(n,r,o){const u=n[0]-r[0],f=n[1]-r[1],m=o[0]-r[0],d=o[1]-r[1],x=u*m+f*d,v=m*m+d*d;if(v===0)return Math.sqrt(u*u+f*f);const w=x/v;let I,T;w<0?(I=r[0],T=r[1]):w>1?(I=o[0],T=o[1]):(I=r[0]+w*m,T=r[1]+w*d);const b=n[0]-I,D=n[1]-T;return Math.sqrt(b*b+D*D)}polygonDifference(n,r){try{const o=or([n,r]),u=lc(o);return u?this.getTurfPolygon(u):null}catch(o){return Wt()||console.warn("Error in polygonDifference:",o instanceof Error?o.message:String(o)),null}}getBoundingBoxCompassPosition(n,r,o,u){return null}getNearestPointIndex(n,r){return Kf(n,r).properties.featureIndex}getCoord(n){return[n.lng,n.lat]}createPolygon(n){return dn(n)}getFeaturePointCollection(n){const r=[];return n.forEach(u=>{const f=Ie([u.lng,u.lat],{});r.push(f)}),or(r)}getPolygonArea(n){return Ho(n)}getPolygonPerimeter(n){return lg(n,{units:"kilometers"})}getCenterOfMass(n){return Sh(n)}getDoubleElbowLatLngs(n){const r=[],o=n.length,u=n[0].lat===n[o-1].lat&&n[0].lng===n[o-1].lng?o-1:o;for(let f=0;f<u;f++){const m=n[f],d=n[(f+1)%u];r.push(new ot.LatLng(m.lat,m.lng));const x=Na(Ie([m.lng,m.lat]),Ie([d.lng,d.lat]));r.push(new ot.LatLng(x.geometry.coordinates[1],x.geometry.coordinates[0]))}return r}getBezierMultiPolygon(n){const r=Qf(this.getMultiPolygon(n));r.features[0].geometry.coordinates.push(r.features[0].geometry.coordinates[0]);const o=ag(r.features[0],{resolution:this.config.bezier.resolution,sharpness:this.config.bezier.sharpness});return ng(o)}polygonHasHoles(n){try{return n.geometry.type==="Polygon"?n.geometry.coordinates.length>1:n.geometry.type==="MultiPolygon"?n.geometry.coordinates.some(r=>r.length>1):!1}catch(r){return Wt()||console.warn("Error checking for holes:",r instanceof Error?r.message:String(r)),!1}}getKinksWithHolePreservation(n){try{if(n.geometry.type==="Polygon"){const r=n.geometry.coordinates,o=r[0],u=r.slice(1),f={type:"Feature",geometry:{type:"Polygon",coordinates:[o]},properties:n.properties||{}},m=this.hasKinks(f),d=this.checkOuterRingHoleIntersection(o,u);if(m||d){if(this.checkIfDragCompletelyThroughHole(o,u))return this.handleCompleteHoleTraversal(f,u);const v=ta(f),w=[];return li(v,I=>{const T=this.subtractIntersectingHoles(I,u);w.push(T)}),w}else return[n]}else if(n.geometry.type==="MultiPolygon"){const r=[];for(const o of n.geometry.coordinates){const u={type:"Feature",geometry:{type:"Polygon",coordinates:o},properties:n.properties||{}},f=this.getKinksWithHolePreservation(u);r.push(...f)}return r}return[n]}catch(r){return Wt()||console.warn("Error in getKinksWithHolePreservation:",r instanceof Error?r.message:String(r)),[n]}}checkIfDragCompletelyThroughHole(n,r){try{if(this.findDuplicatePoints(n).length>0)return!0;const u=this.findSelfIntersectionLine(n);if(u&&r.length>0){for(const f of r)if(this.lineCompletelyTraversesHole(u,f))return!0}if(this.hasKinks({type:"Feature",geometry:{type:"Polygon",coordinates:[n]},properties:{}})){for(const f of r)if(this.holeIsCutByKinks(n,f))return!0}return!1}catch(o){return Wt()||console.warn("Error checking complete hole traversal:",o instanceof Error?o.message:String(o)),!1}}findSelfIntersectionLine(n){try{const r=new Map;for(let o=0;o<n.length-1;o++){const u=n[o],f=`${u[0]},${u[1]}`;r.has(f)?r.get(f).indices.push(o):r.set(f,{point:u,indices:[o]})}for(const[,o]of r)if(o.indices.length>=2){const u=o.indices[0],f=o.indices[1],m=[];for(let d=u;d<=f;d++)m.push(n[d]);return m}return null}catch(r){return Wt()||console.warn("Error finding self-intersection line:",r instanceof Error?r.message:String(r)),null}}lineCompletelyTraversesHole(n,r){try{if(n.length<2)return!1;const o=n[0],u=n[n.length-1],f=dn([r]),m=Gn(Ie(o),f),d=Gn(Ie(u),f);return m!==d}catch(o){return Wt()||console.warn("Error checking line hole traversal:",o instanceof Error?o.message:String(o)),!1}}holeIsCutByKinks(n,r){try{const o=dn([n]),u=dn([r]),f=yu(o);if(f.features.length===0)return!1;for(const m of f.features){const d=m.geometry.coordinates;try{if(Ta(Ie(d),oh(u))<.01||Gn(Ie(d),u))return!0}catch{if(Gn(Ie(d),u))return!0}}return!1}catch(o){return Wt()||console.warn("Error checking hole cut by kinks:",o.message),!1}}findDuplicatePoints(n){const r=[],o=new Set;for(let u=0;u<n.length-1;u++){const f=n[u],m=`${f[0]},${f[1]}`;o.has(m)?r.push(f):o.add(m)}return r}checkOuterRingHoleIntersection(n,r){try{if(r.length===0)return!1;const o=dn([n]);for(const u of r){const f=dn([u]);if(this.getIntersection(o,f))return!0;for(let d=0;d<n.length-1;d++){const x=n[d];if(Gn(Ie(x),f))return!0}}return!1}catch{return!1}}handleCompleteHoleTraversal(n,r){try{const o={type:"Feature",geometry:{type:"Polygon",coordinates:[n.geometry.coordinates[0]]},properties:n.properties||{}},u=ta(o),f=[];return li(u,m=>{m._polydrawHoleTraversalOccurred=!0,f.push(m)}),f}catch(o){Wt()||console.warn("Error handling complete hole traversal:",o instanceof Error?o.message:String(o));try{const u={...n,geometry:{...n.geometry,coordinates:[n.geometry.coordinates[0]]}};return u._polydrawHoleTraversalOccurred=!0,[u]}catch{return[n]}}}subtractIntersectingHoles(n,r){try{let o=n;for(const u of r){const f=dn([u]);if(this.getIntersection(f,o)){const d=this.polygonDifference(o,f);if(d){if(d.geometry.type==="Polygon")o=d;else if(d.geometry.type==="MultiPolygon"){const x=d;let v=0,w=null;for(const I of x.geometry.coordinates){const T={type:"Feature",geometry:{type:"Polygon",coordinates:I},properties:{}},b=Ho(T);b>v&&(v=b,w=T)}w&&(o=w)}}}}return o}catch(o){return Wt()||console.warn("Error subtracting intersecting holes:",o instanceof Error?o.message:String(o)),n}}removeDuplicateVertices(n){if(!n||!n.geometry||!n.geometry.coordinates)return Wt()||console.warn("Invalid feature passed to removeDuplicateVertices"),n;const r=o=>{if(!o||o.length<3)return Wt()||console.warn("Invalid coordinates array - need at least 3 points for a polygon"),o||[];const u=[],f=1e-6;for(let m=0;m<o.length;m++){const d=o[m],x=o[(m+1)%o.length];if(!d||!Array.isArray(d)||d.length<2||!x||!Array.isArray(x)||x.length<2)continue;const v=Math.abs(d[1]-x[1]),w=Math.abs(d[0]-x[0]);(v>f||w>f)&&u.push(d)}if(u.length<3)return Wt()||console.warn("After cleaning, polygon has less than 3 points"),o;if(u.length>0){const m=u[0],d=u[u.length-1],x=Math.abs(m[1]-d[1]),v=Math.abs(m[0]-d[0]);(x>f||v>f)&&u.push([m[0],m[1]])}return u};try{if(n.geometry.type==="Polygon"){const o=n.geometry.coordinates.map(u=>r(u));return o.some(u=>u.length<4)?(Wt()||console.warn("Cleaned polygon has invalid ring with less than 4 coordinates"),n):{...n,geometry:{...n.geometry,coordinates:o}}}else if(n.geometry.type==="MultiPolygon"){const o=n.geometry.coordinates.map(u=>u.map(f=>r(f)));return o.some(u=>u.some(f=>f.length<4))?(Wt()||console.warn("Cleaned multipolygon has invalid ring with less than 4 coordinates"),n):{...n,geometry:{...n.geometry,coordinates:o}}}}catch(o){return Wt()||console.warn("Error in removeDuplicateVertices:",o instanceof Error?o.message:String(o)),n}return n}}class ui{static getVersion(){return this._detectedVersion?this._detectedVersion:(this._detectedVersion=this.detectVersion(),this._detectedVersion)}static detectVersion(){if(typeof L>"u")return Et.V2;if(L.version){if(L.version.startsWith("2."))return Et.V2;if(L.version.startsWith("1."))return Et.V1}return typeof L.marker!="function"?Et.V2:typeof L.marker=="function"&&typeof L.polyline=="function"&&typeof L.polygon=="function"?Et.V1:L.Marker&&typeof L.Marker=="function"&&L.Polyline&&typeof L.Polyline=="function"?Et.V2:Et.V1}static isV1(){return this.getVersion()===Et.V1}static isV2(){return this.getVersion()===Et.V2}static reset(){this._detectedVersion=null}static getVersionInfo(){return{version:this.getVersion(),leafletVersion:typeof L<"u"?L.version:void 0,hasFactoryMethods:typeof L<"u"&&typeof L.marker=="function",hasConstructors:typeof L<"u"&&L.Marker&&typeof L.Marker=="function",globalLAvailable:typeof L<"u"}}}at(ui,"_detectedVersion",null);class dg{constructor(){at(this,"version"),at(this,"domUtil",{create:(n,r,o)=>{if(typeof L<"u"&&L.DomUtil)return L.DomUtil.create(n,r,o);{const u=document.createElement(n);return r&&(u.className=r),o&&o.appendChild(u),u}},addClass:(n,r)=>{this.version===Et.V1?L.DomUtil.addClass(n,r):n.classList.add(r)},removeClass:(n,r)=>{this.version===Et.V1?L.DomUtil.removeClass(n,r):n.classList.remove(r)},hasClass:(n,r)=>this.version===Et.V1?L.DomUtil.hasClass(n,r):n.classList.contains(r),setPosition:(n,r)=>{L.DomUtil.setPosition(n,r)},getPosition:n=>L.DomUtil.getPosition(n)}),at(this,"domEvent",{on:(n,r,o,u)=>(L.DomEvent.on(n,r,o,u),this),off:(n,r,o,u)=>(L.DomEvent.off(n,r,o,u),this),stopPropagation:n=>(L.DomEvent.stopPropagation(n),this),preventDefault:n=>(L.DomEvent.preventDefault(n),this),stop:n=>(L.DomEvent.stop(n),this),disableClickPropagation:n=>(L.DomEvent.disableClickPropagation(n),this),disableScrollPropagation:n=>(L.DomEvent.disableScrollPropagation(n),this),getMousePosition:(n,r)=>this.version===Et.V1?L.DomEvent.getMousePosition(n,r):L.DomEvent.getPointerPosition?L.DomEvent.getPointerPosition(n,r):L.DomEvent.getMousePosition(n,r)}),at(this,"util",{extend:(n,...r)=>this.version===Et.V1?L.Util.extend(n,...r):Object.assign(n,...r),bind:(n,r)=>this.version===Et.V1?L.Util.bind(n,r):n.bind(r),stamp:n=>L.Util.stamp(n),throttle:(n,r,o)=>L.Util.throttle(n,r,o),wrapNum:(n,r,o)=>L.Util.wrapNum(n,r,o),falseFn:()=>L.Util.falseFn(),formatNum:(n,r)=>L.Util.formatNum(n,r),trim:n=>this.version===Et.V1?L.Util.trim(n):n.trim(),splitWords:n=>L.Util.splitWords(n),setOptions:(n,r)=>L.Util.setOptions(n,r),getParamString:(n,r,o)=>{if(this.version===Et.V1)return L.Util.getParamString(n,r,o);{const u=new URLSearchParams;for(const m in n)if(Object.prototype.hasOwnProperty.call(n,m)){const d=o?m.toUpperCase():m;u.set(d,n[m])}const f=u.toString();if(r){const m=r.indexOf("?")===-1?"?":"&";return r+m+f}return f?"?"+f:""}},template:(n,r)=>L.Util.template(n,r),isArray:n=>this.version===Et.V1?L.Util.isArray(n):Array.isArray(n),indexOf:(n,r)=>L.Util.indexOf(n,r),requestAnimFrame:(n,r,o)=>this.version===Et.V1?L.Util.requestAnimFrame(n,r,o):requestAnimationFrame(r?n.bind(r):n),cancelAnimFrame:n=>{this.version===Et.V1?L.Util.cancelAnimFrame(n):cancelAnimationFrame(n)}}),this.version=ui.getVersion()}createTileLayer(n,r){return this.version===Et.V1?L.tileLayer(n,r):new L.TileLayer(n,r)}createMap(n,r){return this.version===Et.V1?L.map(n,r):new L.Map(n,r)}createMarker(n,r){return this.version===Et.V1?L.marker(n,r):new L.Marker(n,r)}createPolyline(n,r){return this.version===Et.V1?L.polyline(n,r):new L.Polyline(n,r)}createPolygon(n,r){return this.version===Et.V1?L.polygon(n,r):new L.Polygon(n,r)}createDivIcon(n){return this.version===Et.V1?L.divIcon(n):new L.DivIcon(n)}createLatLng(n,r,o){return this.version===Et.V1?L.latLng(n,r,o):new L.LatLng(n,r,o)}createLatLngBounds(n,r){return this.version===Et.V1?L.latLngBounds(n,r):new L.LatLngBounds(n,r)}createPoint(n,r,o){return this.version===Et.V1?L.point(n,r,o):new L.Point(n,r,o)}createPopup(n,r){return this.version===Et.V1?L.popup(n,r):new L.Popup(n,r)}createFeatureGroup(n){return this.version===Et.V1?L.featureGroup(n):new L.FeatureGroup(n)}createLayerGroup(n){return this.version===Et.V1?L.layerGroup(n):new L.LayerGroup(n)}getBrowser(){const n=this;return{get ie(){return n.version===Et.V1?L.Browser.ie:!1},get ielt9(){return n.version===Et.V1?L.Browser.ielt9:!1},get edge(){return n.version===Et.V1?L.Browser.edge:!1},get webkit(){return n.version===Et.V1?L.Browser.webkit:!1},get android(){return n.version===Et.V1?L.Browser.android:/Android/.test(navigator.userAgent)},get android23(){return n.version===Et.V1?L.Browser.android23:!1},get androidStock(){return n.version===Et.V1?L.Browser.androidStock:!1},get opera(){return n.version===Et.V1?L.Browser.opera:!1},get chrome(){return n.version===Et.V1?L.Browser.chrome:/Chrome/.test(navigator.userAgent)},get gecko(){return n.version===Et.V1?L.Browser.gecko:!1},get safari(){return n.version===Et.V1?L.Browser.safari:/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)},get phantom(){return n.version===Et.V1?L.Browser.phantom:!1},get opera12(){return n.version===Et.V1?L.Browser.opera12:!1},get win(){return n.version===Et.V1?L.Browser.win:/Win/.test(navigator.platform)},get ie3d(){return n.version===Et.V1?L.Browser.ie3d:!1},get webkit3d(){return n.version===Et.V1?L.Browser.webkit3d:!1},get gecko3d(){return n.version===Et.V1?L.Browser.gecko3d:!1},get any3d(){return n.version===Et.V1?L.Browser.any3d:!0},get mobile(){return L.Browser.mobile},get mobileWebkit(){return n.version===Et.V1?L.Browser.mobileWebkit:!1},get mobileWebkit3d(){return n.version===Et.V1?L.Browser.mobileWebkit3d:!1},get msPointer(){return n.version===Et.V1?L.Browser.msPointer:!1},get pointer(){return L.Browser.pointer||!0},get touch(){return L.Browser.touch},get touchNative(){return n.version===Et.V1?L.Browser.touchNative:!1},get mobileOpera(){return n.version===Et.V1?L.Browser.mobileOpera:!1},get mobileGecko(){return n.version===Et.V1?L.Browser.mobileGecko:!1},get retina(){return L.Browser.retina},get passiveEvents(){return n.version===Et.V1?L.Browser.passiveEvents:!0},get canvas(){return n.version===Et.V1?L.Browser.canvas:!0},get svg(){return n.version===Et.V1?L.Browser.svg:!0},get vml(){return n.version===Et.V1?L.Browser.vml:!1},get inlineSvg(){return n.version===Et.V1?L.Browser.inlineSvg:!0}}}getVersion(){return this.version}isV1(){return this.version===Et.V1}isV2(){return this.version===Et.V2}}const Gt=new dg;function mg(h,n,r,o,u,f,m,d){const x=Gt.domUtil.create("a","icon-activate",h);if(x.href="#",x.title="Activate",x.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M5 17V7M5 17C3.89543 17 3 17.8954 3 19C3 20.1046 3.89543 21 5 21C6.10457 21 7 20.1046 7 19M5 17C6.10457 17 7 17.8954 7 19M5 7C6.10457 7 7 6.10457 7 5M5 7C3.89543 7 3 6.10457 3 5C3 3.89543 3.89543 3 5 3C6.10457 3 7 3.89543 7 5M7 5H17M17 5C17 6.10457 17.8954 7 19 7C20.1046 7 21 6.10457 21 5C21 3.89543 20.1046 3 19 3C17.8954 3 17 3.89543 17 5ZM7 19H17M17 19C17 20.1046 17.8954 21 19 21C20.1046 21 21 20.1046 21 19C21 17.8954 20.1046 17 19 17C17.8954 17 17 17.8954 17 19ZM17.9247 6.6737L15.1955 10.3776M15.1955 13.6223L17.9222 17.3223M16 12C16 13.1046 15.1046 14 14 14C12.8954 14 12 13.1046 12 12C12 10.8954 12.8954 10 14 10C15.1046 10 16 10.8954 16 12Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>',ot.DomEvent.on(x,"mousedown",ot.DomEvent.stopPropagation),ot.DomEvent.on(x,"touchstart",ot.DomEvent.stopPropagation),ot.DomEvent.on(x,"click",ot.DomEvent.stop).on(x,"click",o),r.modes.draw){const v=Gt.domUtil.create("a","icon-draw",n);v.href="#",v.title="Draw",v.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M15 7.49996L17.5 9.99996M7.5 20L19.25 8.24996C19.9404 7.5596 19.9404 6.44032 19.25 5.74996V5.74996C18.5596 5.0596 17.4404 5.05961 16.75 5.74996L5 17.5V20H7.5ZM7.5 20H15.8787C17.0503 20 18 19.0502 18 17.8786V17.8786C18 17.316 17.7765 16.7765 17.3787 16.3786L17 16M4.5 4.99996C6.5 2.99996 10 3.99996 10 5.99996C10 8.5 4 8.5 4 11C4 11.8759 4.53314 12.5256 5.22583 13" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>',ot.DomEvent.on(v,"mousedown",ot.DomEvent.stopPropagation),ot.DomEvent.on(v,"touchstart",ot.DomEvent.stopPropagation),ot.DomEvent.on(v,"click",ot.DomEvent.stop).on(v,"click",u)}if(r.modes.subtract){const v=Gt.domUtil.create("a","icon-subtract",n);v.href="#",v.title="Subtract",v.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M15.0722 3.9967L20.7508 9.83395L17.0544 13.5304L13.0758 17.5H21.0041V19H7.93503L4.00195 15.0669L15.0722 3.9967ZM10.952 17.5L15.4628 12.9994L11.8268 9.3634L6.12327 15.0669L8.55635 17.5H10.952Z" fill="#1F2328"></path> </g></svg>',ot.DomEvent.on(v,"mousedown",ot.DomEvent.stopPropagation),ot.DomEvent.on(v,"touchstart",ot.DomEvent.stopPropagation),ot.DomEvent.on(v,"click",ot.DomEvent.stop).on(v,"click",f)}if(r.modes.p2p){const v=Gt.domUtil.create("a","icon-p2p",n);v.href="#",v.title="Point to Point",v.innerHTML='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M5 17V7M5 17C3.89543 17 3 17.8954 3 19C3 20.1046 3.89543 21 5 21C6.10457 21 7 20.1046 7 19M5 17C6.10457 17 7 17.8954 7 19M5 7C6.10457 7 7 6.10457 7 5M5 7C3.89543 7 3 6.10457 3 5C3 3.89543 3.89543 3 5 3C6.10457 3 7 3.89543 7 5M7 5H17M17 5C17 6.10457 17.8954 7 19 7C20.1046 7 21 6.10457 21 5C21 3.89543 20.1046 3 19 3C17.8954 3 17 3.89543 17 5ZM7 19H17M17 19C17 20.1046 17.8954 21 19 21C20.1046 21 21 20.1046 21 19C21 17.8954 20.1046 17 19 17C17.8954 17 17 17.8954 17 19ZM17.9247 6.6737L15.1955 10.3776M15.1955 13.6223L17.9222 17.3223M16 12C16 13.1046 15.1046 14 14 14C12.8954 14 12 13.1046 12 12C12 10.8954 12.8954 10 14 10C15.1046 10 16 10.8954 16 12Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>',ot.DomEvent.on(v,"mousedown",ot.DomEvent.stopPropagation),ot.DomEvent.on(v,"touchstart",ot.DomEvent.stopPropagation),ot.DomEvent.on(v,"click",ot.DomEvent.stop).on(v,"click",d)}if(r.modes.deleteAll){const v=Gt.domUtil.create("a","icon-erase",n);v.href="#",v.title="Erase All",v.innerHTML=`<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 21.0.2, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 48 48" style="enable-background:new 0 0 48 48;" xml:space="preserve">
<style type="text/css">
	.st0{fill:#000000}
	.st1{fill:#333333;fill-opacity:0;}
</style>
<title>trash</title>
<rect class="st1" width="48" height="48"/>
<polygon class="st0" points="26.6,10 26.6,7.8 21.4,7.8 21.4,10 12.6,10 12.6,12.8 35.4,12.8 35.4,10 "/>
<path class="st0" d="M35.4,15.4H12.6v4.3h1.8V37c0,1.1,0.9,2,2,2h15.2c1.1,0,2-0.9,2-2V19.7h1.8V15.4z M19.7,34.2c0,0.5-0.4,1-1,1
	c-0.5,0-1-0.4-1-1V22.6c0-0.5,0.4-1,1-1c0.5,0,1,0.4,1,1V34.2z M25.3,33.8c0,0.7-0.6,1.3-1.3,1.3c-0.7,0-1.3-0.6-1.3-1.3V23
	c0-0.7,0.6-1.3,1.3-1.3c0.7,0,1.3,0.6,1.3,1.3V33.8z M30.3,34.2c0,0.5-0.4,1-1,1c-0.5,0-1-0.4-1-1V22.6c0-0.5,0.4-1,1-1
	c0.5,0,1,0.4,1,1V34.2z"/>
</svg>`,ot.DomEvent.on(v,"mousedown",ot.DomEvent.stopPropagation),ot.DomEvent.on(v,"touchstart",ot.DomEvent.stopPropagation),ot.DomEvent.on(v,"click",ot.DomEvent.stop).on(v,"click",m)}}class hi{static getCenter(n){let r=0,o=0,u=0;n.forEach(v=>{let w=v.lat,I=v.lng;w=w*cr.DEG_TO_RAD,I=I*cr.DEG_TO_RAD,r+=Math.cos(w)*Math.cos(I),o+=Math.cos(w)*Math.sin(I),u+=Math.sin(w)});let f=Math.atan2(o,r);const m=Math.sqrt(r*r+o*o);let d=Math.atan2(u,m);return d=d*cr.RAD_TO_DEG,f=f*cr.RAD_TO_DEG,{lat:d,lng:f}}static getSouthWest(n){return this.getBounds(n).getSouthWest()}static getNorthEast(n){return this.getBounds(n).getNorthEast()}static getNorthWest(n){return this.getBounds(n).getNorthWest()}static getSouthEast(n){return this.getBounds(n).getSouthEast()}static getNorth(n){return this.getBounds(n).getNorth()}static getSouth(n){return this.getBounds(n).getSouth()}static getWest(n){return this.getBounds(n).getWest()}static getEast(n){return this.getBounds(n).getEast()}static getSqmArea(n){const o=new ot.Polygon(n).toGeoJSON();return this.turfHelper.getPolygonArea(o)}static getPerimeter(n){const o=new ot.Polygon(n).toGeoJSON();return this.turfHelper.getPolygonPerimeter(o)*1e3}static getPolygonChecksum(n){const r=n.filter((o,u,f)=>{const m=f.find(d=>d.lat===o.lat&&d.lng===o.lng);return m?f.indexOf(m)===u:!1});return r.reduce((o,u)=>+o+ +u.lat,0)*r.reduce((o,u)=>+o+ +u.lng,0)}static getMidPoint(n,r){const o=this.turfHelper.getMidpoint(n,r);return{lat:o.lat,lng:o.lng}}static getBounds(n){const r=[];return n.forEach(f=>{isNaN(f.lat)||isNaN(f.lng),r.push(f)}),new ot.Polyline(r).getBounds()}static getCenterOfMass(n){const r=this.turfHelper.getCenterOfMass(n);return{lat:r.geometry.coordinates[1],lng:r.geometry.coordinates[0]}}}at(hi,"turfHelper",new kl(Ni));class pg{constructor(n){if(at(this,"polygon",[]),at(this,"trashcanPoint",[]),at(this,"sqmArea",[]),at(this,"perimeter",[]),!Array.isArray(n))return;if(n.length>0&&Array.isArray(n[0])&&n[0].length>0&&typeof n[0][0]=="object"&&"lat"in n[0][0]){const o=n[0];this.trashcanPoint[0]=this.getTrashcanPoint(o),this.sqmArea[0]=this.calculatePolygonArea(o),this.perimeter[0]=this.calculatePolygonPerimeter(o),this.polygon[0]=[o];return}if(n.length>0&&n[0]&&typeof n[0]=="object"&&"lat"in n[0]){const o=n,u=[[o]];this.trashcanPoint[0]=this.getTrashcanPoint(o),this.sqmArea[0]=this.calculatePolygonArea(o),this.perimeter[0]=this.calculatePolygonPerimeter(o),this.polygon[0]=u[0];return}n.forEach((o,u)=>{!o||!Array.isArray(o)||!o[0]||!Array.isArray(o[0])||(this.trashcanPoint[u]=this.getTrashcanPoint(o[0]),this.sqmArea[u]=this.calculatePolygonArea(o[0]),this.perimeter[u]=this.calculatePolygonPerimeter(o[0]),this.polygon[u]=o)})}setSqmArea(n){this.sqmArea[0]=n}getTrashcanPoint(n){if(!Array.isArray(n)||n.length===0)return console.warn("getTrashcanPoint: Invalid polygon array:",n),{lat:0,lng:0};const r=n.filter(v=>v&&typeof v=="object"&&typeof v.lat=="number"&&typeof v.lng=="number"&&!isNaN(v.lat)&&!isNaN(v.lng));if(r.length===0)return console.warn("getTrashcanPoint: No valid coordinates found:",n),{lat:0,lng:0};const o=Math.max(...r.map(v=>v.lat)),u=r.findIndex(v=>v.lat===o);if(u===-1)return console.warn("getTrashcanPoint: Could not find max lat coordinate"),{lat:0,lng:0};let f,m;if(u>0?(f=r[u-1],u<r.length-1?m=r[u+1]:m=r[0]):(f=r[r.length-1],m=r[u+1]),!f||!m)return console.warn("getTrashcanPoint: Could not determine previous/next points"),r[u]||{lat:0,lng:0};const d=f.lng<m.lng?f:m;return hi.getMidPoint(r[u],d)}calculatePolygonArea(n){return hi.getSqmArea(n)}calculatePolygonPerimeter(n){return hi.getPerimeter(n)}}class yg{constructor(n){at(this,"polygonInfoListeners",[]),at(this,"polygonDrawStateListeners",[]),at(this,"polygonInformationStorage",[]),this.mapStateService=n}onPolygonInfoUpdated(n){this.polygonInfoListeners.push(n)}emitPolygonInfoUpdated(){for(const n of this.polygonInfoListeners)n(this.polygonInformationStorage)}onPolygonDrawStateUpdated(n){this.polygonDrawStateListeners.push(n)}updatePolygons(){const n=[];this.polygonInformationStorage.length>0&&this.polygonInformationStorage.forEach(r=>{const o=[];r.polygon.forEach(u=>{u.forEach(f=>{const m=[...f];f.length>0&&f[0].toString()!==f[f.length-1].toString()&&m.push(f[0]),o.push(m)})}),n.push(o)}),this.mapStateService.updatePolygons(n),this.saveCurrentState()}saveCurrentState(){this.emitPolygonInfoUpdated()}deleteTrashcan(n){const r=this.polygonInformationStorage.findIndex(o=>o.polygon[0]===n);r!==-1&&(this.polygonInformationStorage.splice(r,1),this.updatePolygons())}deleteTrashCanOnMulti(n){let r=0;this.polygonInformationStorage.forEach((o,u)=>{const f=o.polygon.findIndex(m=>m.toString()===n.toString());f>=0&&(r=u,o.trashcanPoint.splice(f,1),o.sqmArea.splice(f,1),o.perimeter.splice(f,1),o.polygon.splice(f,1))}),this.updatePolygons(),this.polygonInformationStorage.length>1&&this.polygonInformationStorage.splice(r,1)}deletePolygonInformationStorage(){this.polygonInformationStorage=[]}createPolygonInformationStorage(n){n.length>0&&(n.forEach(r=>{var o;const u=(o=r.getLayers)==null?void 0:o.call(r);if(u!=null&&u[0]){const f=u[0].getLatLngs(),m=new pg(f);this.polygonInformationStorage.push(m)}}),this.updatePolygons())}}class vg{constructor(){at(this,"map",null),at(this,"mapListeners",[])}onMapUpdated(n){this.map&&n(this.map),this.mapListeners.push(n)}emitMapUpdated(){if(this.map)for(const n of this.mapListeners)n(this.map)}updateMapState(n){this.map=n,this.emitMapUpdated()}updatePolygons(n){}}class _g{constructor(){at(this,"eventListeners",new Map)}on(n,r){this.eventListeners.has(n)||this.eventListeners.set(n,[]),this.eventListeners.get(n).push(r)}off(n,r){const o=this.eventListeners.get(n);if(o){const u=o.indexOf(r);u>-1&&o.splice(u,1)}}emit(n,r){var o;this.eventListeners.has(n)&&((o=this.eventListeners.get(n))==null||o.forEach(u=>{u(r)}))}}class xg{constructor(n,r){at(this,"state"),at(this,"config"),at(this,"eventManager"),this.config=n,this.eventManager=r,this.state=this.createInitialState()}createInitialState(){return{polygonDragging:this.config.modes.dragPolygons??!1,markerDragging:this.config.modes.dragElbow??!1,edgeClicking:!0,polygonClicking:!0,canStartDrawing:!0,canCompletePolygon:!1,mapDragging:!0,mapZooming:!0,mapDoubleClickZoom:!0,currentMode:At.Off,isDrawingActive:!1,isModifierKeyHeld:!1,showCrosshairCursor:!1,showDragCursor:!1}}updateStateForMode(n){switch(this.state.currentMode=n,n){case At.Off:this.setOffModeState();break;case At.Add:this.setDrawingModeState();break;case At.Subtract:this.setDrawingModeState();break;case At.PointToPoint:this.setPointToPointModeState();break}this.state.isDrawingActive=n!==At.Off,this.eventManager.emit("polydraw:mode:change",{mode:n})}setOffModeState(){this.state.polygonDragging=this.config.modes.dragPolygons??!1,this.state.markerDragging=this.config.modes.dragElbow??!1,this.state.edgeClicking=!0,this.state.polygonClicking=!0,this.state.canStartDrawing=!0,this.state.canCompletePolygon=!1,this.state.mapDragging=!0,this.state.mapZooming=!0,this.state.mapDoubleClickZoom=!0,this.state.showCrosshairCursor=!1,this.state.showDragCursor=!1}setDrawingModeState(){this.state.polygonDragging=!1,this.state.markerDragging=!1,this.state.edgeClicking=!1,this.state.polygonClicking=!1,this.state.canStartDrawing=!0,this.state.canCompletePolygon=!0,this.state.mapDragging=!1,this.state.mapZooming=!1,this.state.mapDoubleClickZoom=!1,this.state.showCrosshairCursor=!0,this.state.showDragCursor=!1}setPointToPointModeState(){this.state.polygonDragging=!1,this.state.markerDragging=!1,this.state.edgeClicking=!1,this.state.polygonClicking=!1,this.state.canStartDrawing=!0,this.state.canCompletePolygon=!0,this.state.mapDragging=!1,this.state.mapZooming=!1,this.state.mapDoubleClickZoom=!1,this.state.showCrosshairCursor=!0,this.state.showDragCursor=!1}setModifierKeyState(n){this.state.isModifierKeyHeld=n,this.state.currentMode,At.Off}canPerformAction(n){switch(n){case"polygonDrag":return this.state.polygonDragging;case"markerDrag":return this.state.markerDragging;case"edgeClick":return this.state.edgeClicking;case"polygonClick":return this.state.polygonClicking;case"startDrawing":return this.state.canStartDrawing;case"completePolygon":return this.state.canCompletePolygon;case"mapDrag":return this.state.mapDragging;case"mapZoom":return this.state.mapZooming;case"mapDoubleClickZoom":return this.state.mapDoubleClickZoom;default:return!1}}isInDrawingMode(){return this.state.isDrawingActive}isInOffMode(){return this.state.currentMode===At.Off}getCurrentMode(){return this.state.currentMode}getState(){return{...this.state}}shouldShowCrosshairCursor(){return this.state.showCrosshairCursor}shouldShowDragCursor(){return this.state.showDragCursor}updateConfig(n){this.config=n,this.updateStateForMode(this.state.currentMode)}}class kg{constructor(n){at(this,"turfHelper"),at(this,"map"),at(this,"config"),at(this,"modeManager"),at(this,"eventManager"),at(this,"tracer"),at(this,"p2pMarkers",[]),at(this,"isModifierKeyHeld",!1),at(this,"markerModifierHandlers",new WeakMap),this.turfHelper=n.turfHelper,this.map=n.map,this.config=n.config,this.modeManager=n.modeManager,this.eventManager=n.eventManager,this.tracer=n.tracer}mouseMove(n){if("latlng"in n&&n.latlng)this.tracer.addLatLng(n.latlng);else if("touches"in n&&n.touches&&n.touches.length>0){const r=this.map.getContainer().getBoundingClientRect(),o=this.map.containerPointToLatLng([n.touches[0].clientX-r.x,n.touches[0].clientY-r.y]);this.tracer.addLatLng(o)}}async mouseUpLeave(n){const r=this.tracer.toGeoJSON();if(!r||!r.geometry||!r.geometry.coordinates||r.geometry.coordinates.length<3)return{success:!1,error:"Not enough points to form a valid polygon. Event: "+JSON.stringify(n)};let o;try{o=this.turfHelper.createPolygonFromTrace(r)}catch(u){return{success:!1,error:(u instanceof Error?u.message:"Failed to create polygon from trace")+". Event: "+JSON.stringify(n)}}return!o||!o.geometry||!o.geometry.coordinates||o.geometry.coordinates.length===0?{success:!1,error:"Invalid polygon created from trace. Event: "+JSON.stringify(n)}:(this.eventManager.emit("polydraw:polygon:created",{polygon:o,mode:this.modeManager.getCurrentMode()}),{success:!0,polygon:o})}setModifierKey(n){this.isModifierKeyHeld=n}handlePointToPointClick(n){if(n){if(this.p2pMarkers.length>=3){const r=this.p2pMarkers[0].getLatLng();if(this.isClickingFirstPoint(n,r)){this.completePointToPointPolygon();return}}try{const r=this.p2pMarkers.length===0,o=r?"leaflet-polydraw-p2p-marker leaflet-polydraw-p2p-first-marker":"leaflet-polydraw-p2p-marker",u=new ot.Marker(n,{icon:Gt.createDivIcon({className:o,iconSize:r?[20,20]:[16,16]}),draggable:this.config.modes.dragElbow}).addTo(this.map);u.on("mousedown",f=>{ot.DomEvent.stopPropagation(f)}),u.on("drag",()=>{this.updateP2PTracer()}),u.on("click",f=>{this.isModifierKeyHeld&&this.config.modes.edgeDeletion&&(this.deleteP2PMarker(u),ot.DomEvent.stopPropagation(f))}),u.on("mouseover",()=>this.onMarkerHoverForEdgeDeletion(u,!0)),u.on("mouseout",()=>this.onMarkerHoverForEdgeDeletion(u,!1)),r&&(u.on("mouseover",()=>{if(this.p2pMarkers.length>=3){const f=u.getElement();f&&(f.style.backgroundColor=this.config.colors.p2p.closingMarker,f.style.borderColor=this.config.colors.p2p.closingMarker,f.style.cursor="pointer",f.title="Click to close polygon")}}),u.on("mouseout",()=>{const f=u.getElement();f&&(f.style.backgroundColor="",f.style.borderColor="",f.style.cursor="",f.title="")}),u.on("click",f=>{if(this.isModifierKeyHeld&&this.config.modes.edgeDeletion){this.deleteP2PMarker(u),ot.DomEvent.stopPropagation(f);return}this.p2pMarkers.length>=3&&(ot.DomEvent.stopPropagation(f),this.completePointToPointPolygon())})),this.p2pMarkers.push(u),this.updateP2PTracer()}catch{}}}handleDoubleClick(n){this.modeManager.getCurrentMode()===At.PointToPoint&&this.p2pMarkers.length>=3&&this.completePointToPointPolygon()}handleDoubleTap(n){this.modeManager.getCurrentMode()===At.PointToPoint&&this.p2pMarkers.length>=3&&this.completePointToPointPolygon()}completePointToPointPolygon(){const n=this.p2pMarkers.map(f=>f.getLatLng());if(n.length<3)return;const r=[...n],o=n[0],u=n[n.length-1];(o.lat!==u.lat||o.lng!==u.lng)&&r.push(o);try{const f=r.map(d=>[d.lng,d.lat]),m=this.turfHelper.getMultiPolygon([[f]]);this.clearP2pMarkers(),this.resetTracer(),this.eventManager.emit("polydraw:polygon:created",{polygon:m,mode:At.PointToPoint,isPointToPoint:!0})}catch(f){Wt()||console.warn("Error completing point-to-point polygon:",f),this.clearP2pMarkers(),this.resetTracer()}}cancelPointToPointDrawing(){this.clearP2pMarkers(),this.resetTracer(),this.eventManager.emit("polydraw:draw:cancel",{mode:At.PointToPoint})}clearP2pMarkers(){this.p2pMarkers.forEach(n=>this.map.removeLayer(n)),this.p2pMarkers=[]}resetTracer(){this.tracer.setLatLngs([]);try{this.tracer.setStyle({dashArray:void 0})}catch{}}isClickingFirstPoint(n,r){if(!r)return!1;const o=this.map.getZoom();let f=5e-4/Math.pow(2,Math.max(0,o-10));this.isTouchDevice()&&(f*=5);const m=Math.abs(n.lat-r.lat),d=Math.abs(n.lng-r.lng);return m<f&&d<f}isTouchDevice(){return ga()}updateP2PTracer(){const n=this.p2pMarkers.map(r=>r.getLatLng());if(this.tracer.setLatLngs(n),this.p2pMarkers.length>=2)try{this.tracer.setStyle({color:this.config.colors.polyline,dashArray:"5, 5"})}catch{}else try{this.tracer.setStyle({dashArray:void 0})}catch{}}deleteP2PMarker(n){const r=this.p2pMarkers.findIndex(o=>o===n);r>-1&&(this.p2pMarkers.splice(r,1),this.map.removeLayer(n),this.updateP2PTracer(),r===0&&this.p2pMarkers.length>0&&this.setupFirstMarker())}getP2pMarkers(){return[...this.p2pMarkers]}isInPointToPointMode(){return this.modeManager.getCurrentMode()===At.PointToPoint}getTracerPointsCount(){return this.tracer.getLatLngs().length}setupFirstMarker(){if(this.p2pMarkers.length===0)return;const n=this.p2pMarkers[0],r=n.getElement();r&&(r.classList.add("leaflet-polydraw-p2p-first-marker"),n.setIcon(Gt.createDivIcon({className:"leaflet-polydraw-p2p-marker leaflet-polydraw-p2p-first-marker",iconSize:[20,20]}))),n.off("mouseover"),n.off("mouseout"),n.off("click"),n.on("mouseover",()=>{if(this.p2pMarkers.length>=3){const o=n.getElement();o&&(o.style.backgroundColor=this.config.colors.p2p.closingMarker,o.style.borderColor=this.config.colors.p2p.closingMarker,o.style.cursor="pointer",o.title="Click to close polygon")}}),n.on("mouseout",()=>{const o=n.getElement();o&&(o.style.backgroundColor="",o.style.borderColor="",o.style.cursor="",o.title="")}),n.on("click",o=>{if(this.isModifierKeyHeld&&this.config.modes.edgeDeletion){this.deleteP2PMarker(n),ot.DomEvent.stopPropagation(o);return}this.p2pMarkers.length>=3&&(ot.DomEvent.stopPropagation(o),this.completePointToPointPolygon())})}onMarkerHoverForEdgeDeletion(n,r){const o=n.getElement();if(o)if(r){const u=f=>{if(this.isModifierKeyHeld&&this.config.modes.edgeDeletion){o.classList.add("edge-deletion-hover");try{const m=this.map.getContainer();m.style.cursor="pointer"}catch{}}else{o.classList.remove("edge-deletion-hover");try{const m=this.map.getContainer();m.style.cursor=""}catch{}}};this.markerModifierHandlers.set(n,u),document.addEventListener("keydown",u),document.addEventListener("keyup",u),o.addEventListener("mousemove",u)}else{o.classList.remove("edge-deletion-hover");try{const f=this.map.getContainer();f.style.cursor=""}catch{}const u=this.markerModifierHandlers.get(n);u&&(document.removeEventListener("keydown",u),document.removeEventListener("keyup",u),o.removeEventListener("mousemove",u),this.markerModifierHandlers.delete(n))}}}class wg{constructor(n){at(this,"turfHelper"),at(this,"config"),this.turfHelper=n.turfHelper,this.config=n.config}checkPolygonIntersection(n,r){try{const o=this.turfHelper.isPolygonCompletelyWithin(n,r),u=this.turfHelper.isPolygonCompletelyWithin(r,n);if(o||u)return!0}catch{}try{if(this.turfHelper.polygonIntersect(n,r))return!0}catch{}try{const o=this.turfHelper.getIntersection(n,r);if(o&&o.geometry&&(o.geometry.type==="Polygon"||o.geometry.type==="MultiPolygon")&&this.turfHelper.getPolygonArea(o)>1e-6)return!0}catch{}try{const o=this.turfHelper.getCoords(n),u=this.turfHelper.getCoords(r);for(const f of u)for(const m of f[0]){const d={type:"Feature",geometry:{type:"Point",coordinates:m},properties:{}};if(this.turfHelper.isPointInsidePolygon(d,n))return!0}for(const f of o)for(const m of f[0]){const d={type:"Feature",geometry:{type:"Point",coordinates:m},properties:{}};if(this.turfHelper.isPointInsidePolygon(d,r))return!0}}catch{}return!1}unionPolygons(n,r){try{let o=r;for(const u of n){const f=this.turfHelper.union(o,u);f&&(o=f)}return{success:!0,result:o}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Unknown error in unionPolygons"}}}subtractPolygon(n,r){try{const o=this.turfHelper.polygonDifference(n,r);if(o){const u=this.turfHelper.getCoords(o),f=[];for(const m of u)f.push(this.turfHelper.getMultiPolygon([m]));return{success:!0,results:f}}else return{success:!0,results:[]}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Unknown error in subtractPolygon"}}}simplifyPolygon(n){var r,o;try{const u=this.turfHelper.getCoords(n);if(!u||u.length===0)return{success:!1,error:"Invalid polygon coordinates"};const f=((o=(r=this.config.menuOperations)==null?void 0:r.simplify)==null?void 0:o.processHoles)??!0,m=u.map(x=>{const v=[];for(let w=0;w<x.length;w++){const I=x[w];if(w===0||f){if(I.length<=4){v.push(I);continue}const b=[];for(let Y=0;Y<I.length;Y+=2)b.push(I[Y]);const D=b[0],Z=b[b.length-1];(D[0]!==Z[0]||D[1]!==Z[1])&&b.push(D),b.length<4?v.push(I):v.push(b)}else v.push(I)}return v}),d=this.turfHelper.getMultiPolygon(m);return{success:!0,result:this.turfHelper.getTurfPolygon(d)}}catch(u){return{success:!1,error:u instanceof Error?u.message:"Unknown error in simplifyPolygon"}}}convertToBoundingBox(n){var r,o;try{const u=this.turfHelper.getCoords(n);if(!u||u.length===0)return{success:!1,error:"Invalid polygon coordinates"};if(!(((o=(r=this.config.menuOperations)==null?void 0:r.bbox)==null?void 0:o.processHoles)??!0)){const x=this.turfHelper.convertToBoundingBoxPolygon(n);return{success:!0,result:this.turfHelper.getTurfPolygon(x)}}const m=u.map(x=>{const v=[];for(let w=0;w<x.length;w++){const I=x[w];let T=1/0,b=-1/0,D=1/0,Z=-1/0;for(const Y of I)if(Array.isArray(Y)&&Y.length>=2){const tt=Y[0],E=Y[1];typeof tt=="number"&&typeof E=="number"&&!isNaN(tt)&&!isNaN(E)&&(D=Math.min(D,tt),Z=Math.max(Z,tt),T=Math.min(T,E),b=Math.max(b,E))}if(T!==1/0&&b!==-1/0&&D!==1/0&&Z!==-1/0){const Y=[[D,T],[D,b],[Z,b],[Z,T],[D,T]];v.push(Y)}else v.push(I)}return v}),d=this.turfHelper.getMultiPolygon(m);return{success:!0,result:this.turfHelper.getTurfPolygon(d)}}catch(u){return{success:!1,error:u instanceof Error?u.message:"Unknown error in convertToBoundingBox"}}}bezierifyPolygon(n){try{const r=this.turfHelper.getCoords(n),o=this.turfHelper.getBezierMultiPolygon(r);return{success:!0,result:this.turfHelper.getTurfPolygon(o)}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown error in bezierifyPolygon"}}}doubleElbowsPolygon(n){var r,o;try{const u=this.turfHelper.getCoords(n);if(!u||u.length===0)return{success:!1,error:"Invalid polygon coordinates"};const f=((o=(r=this.config.menuOperations)==null?void 0:r.doubleElbows)==null?void 0:o.processHoles)??!0,m=u.map(x=>{const v=[];for(let w=0;w<x.length;w++){const I=x[w];if(w===0||f){const b=I.map(Y=>({lat:Y[1],lng:Y[0]})),Z=this.turfHelper.getDoubleElbowLatLngs(b).map(Y=>[Y.lng,Y.lat]);v.push(Z)}else v.push(I)}return v}),d=this.turfHelper.getMultiPolygon(m);return{success:!0,result:this.turfHelper.getTurfPolygon(d)}}catch(u){return{success:!1,error:u instanceof Error?u.message:"Unknown error in doubleElbowsPolygon"}}}}class Eg{static createDivIcon(n){const r=n.join(" ");return Gt.createDivIcon({className:r})}}class Pg{constructor(n,r){at(this,"markerFeatureGroupMap",new WeakMap),at(this,"markerModifierHandlers",new WeakMap),at(this,"_activeMarker",null),at(this,"isDraggingMarker",!1),at(this,"turfHelper"),at(this,"polygonInformation"),at(this,"map"),at(this,"config"),at(this,"modeManager"),at(this,"eventManager"),at(this,"currentDragPolygon",null),at(this,"currentModifierDragMode",!1),at(this,"isModifierKeyHeld",!1),at(this,"_openMenuPopup",null),at(this,"getFeatureGroups"),at(this,"removeFeatureGroup"),at(this,"onPolygonMouseMove",o=>{if(!this.currentDragPolygon||!this.currentDragPolygon._polydrawDragData||!this.currentDragPolygon._polydrawDragData.isDragging)return;const u=this.currentDragPolygon,f=u._polydrawDragData,m=o.originalEvent&&"metaKey"in o.originalEvent?o.originalEvent:o;this.detectDragSubtractModifierKey(m)!==this.currentModifierDragMode&&this.handleModifierToggleDuringDrag(m);const x=f.startPosition,v=o.latlng,w=v.lat-x.lat,I=v.lng-x.lng,T=this.offsetPolygonCoordinates(f.startLatLngs,w,I);u.setLatLngs(T),this.updateMarkersAndHoleLinesDuringDrag(u,w,I)}),at(this,"onPolygonMouseUp",o=>{if(!this.currentDragPolygon||!this.currentDragPolygon._polydrawDragData||!this.currentDragPolygon._polydrawDragData.isDragging)return;const u=this.currentDragPolygon,f=u._polydrawDragData;f.isDragging=!1,this.map.off("mousemove",this.onPolygonMouseMove,this),this.map.off("mouseup",this.onPolygonMouseUp,this),this.map.off("pointermove",this.onPolygonMouseMove,this),this.map.off("pointerup",this.onPolygonMouseUp,this),this.map.dragging&&this.map.dragging.enable(),u._polydrawDragData&&u._polydrawDragData.originalOpacity!=null&&u.setStyle({fillOpacity:u._polydrawDragData.originalOpacity}),this.setMarkerVisibility(u,!0);try{const m=this.map.getContainer();m.style.cursor=""}catch{}this.updatePolygonAfterDrag(u),u._polydrawOriginalMarkerPositions&&(u._polydrawOriginalMarkerPositions.clear(),delete u._polydrawOriginalMarkerPositions),u._polydrawOriginalHoleLinePositions&&(u._polydrawOriginalHoleLinePositions.clear(),delete u._polydrawOriginalHoleLinePositions),u._polydrawCurrentDragSession&&delete u._polydrawCurrentDragSession,this.currentDragPolygon=null}),at(this,"onMarkerHoverForEdgeDeletionEvent",o=>{if(!this.isModifierKeyHeld)return;const u=o.target;u&&(u.style.backgroundColor=this.config.colors.edgeDeletion.hover,u.style.borderColor=this.config.colors.edgeDeletion.hover,u.classList.add("edge-deletion-hover"))}),at(this,"onMarkerLeaveForEdgeDeletionEvent",o=>{const u=o.target;u&&(u.style.backgroundColor="",u.style.borderColor="",u.classList.remove("edge-deletion-hover"))}),this.turfHelper=n.turfHelper,this.polygonInformation=n.polygonInformation,this.map=n.map,this.config=n.config,this.modeManager=n.modeManager,this.eventManager=n.eventManager,this.getFeatureGroups=r.getFeatureGroups,this.removeFeatureGroup=r.removeFeatureGroup}addMarkers(n,r){let o=this.getMarkerIndex(n,this.config.markers.markerMenuIcon.position),u=this.getMarkerIndex(n,this.config.markers.markerDeleteIcon.position),f=this.getMarkerIndex(n,this.config.markers.markerInfoIcon.position);const m=this.ensureMarkerSeparation(n.length,{menu:{index:o,enabled:this.config.markers.menuMarker},delete:{index:u,enabled:this.config.markers.deleteMarker},info:{index:f,enabled:this.config.markers.infoMarker}});o=m.menu,u=m.delete,f=m.info,n.forEach((x,v)=>{let w=this.config.markers.markerIcon.styleClasses;v===o&&this.config.markers.menuMarker&&(w=this.config.markers.markerMenuIcon.styleClasses),v===u&&this.config.markers.deleteMarker&&(w=this.config.markers.markerDeleteIcon.styleClasses),v===f&&this.config.markers.infoMarker&&(w=this.config.markers.markerInfoIcon.styleClasses);const I=Array.isArray(w)?w:[w],T=v===o&&this.config.markers.menuMarker||v===u&&this.config.markers.deleteMarker||v===f&&this.config.markers.infoMarker,b=new ot.Marker(x,{icon:this.createDivIcon(I),draggable:this.config.modes.dragElbow,title:this.config.markers.coordsTitle?this.getLatLngInfoString(x):"",zIndexOffset:this.config.markers.markerIcon.zIndexOffset??this.config.markers.zIndexOffset});r.addLayer(b).addTo(this.map),this.markerFeatureGroupMap.set(b,r),b.on("add",()=>{const Z=b.getElement();Z&&(Z.style.pointerEvents="auto")}),b.on("click",Z=>{var Y,tt;this.isDraggingMarker&&((tt=(Y=Z.originalEvent)==null?void 0:Y.stopPropagation)==null||tt.call(Y),ot.DomEvent.stopPropagation(Z))}),b.on("dragstart",()=>{this.isDraggingMarker=!0,this._activeMarker=b}),b.on("dragend",Z=>{const Y=this.markerFeatureGroupMap.get(b);this.modeManager.canPerformAction("markerDrag")&&Y&&this.markerDragEnd(Y),this._activeMarker=null,ot.DomEvent.stopPropagation(Z),setTimeout(()=>{this.isDraggingMarker=!1},10)});const D=b.getElement();if(D&&(D.addEventListener("touchstart",Z=>{Z.stopPropagation()},{passive:!0}),D.addEventListener("touchend",Z=>{if(Z.preventDefault(),Z.stopPropagation(),b.fire("click"),this.isDraggingMarker&&!T){const Y=this.markerFeatureGroupMap.get(b);this.modeManager.canPerformAction("markerDrag")&&Y&&this.markerDragEnd(Y)}this._activeMarker=null})),v===o||v===u||v===f){const Z=b.getElement();Z&&(Z.style.zIndex="10000")}if(this.config.modes.dragElbow){const Z=Y=>()=>{this.modeManager.canPerformAction("markerDrag")&&this.markerDrag(Y)};b.on("drag",Z(r))}if(v===o&&this.config.markers.menuMarker&&(b.options.zIndexOffset=this.config.markers.markerMenuIcon.zIndexOffset??this.config.markers.zIndexOffset,b.on("click",()=>{const Z=this.getPolygonGeoJSONFromFeatureGroup(r),Y=hi.getCenterOfMass(Z);this.generateMenuMarkerPopup(n,r).setLatLng(Y).openOn(this.map)}),b.on("popupopen",Z=>{const tt=Z.popup.getElement();if(!tt)return;setTimeout(()=>{const N=this.map.getContainer().getBoundingClientRect(),B=tt.getBoundingClientRect();B.left<N.left?tt.style.transform=`translateX(${N.left-B.left}px)`:B.right>N.right&&(tt.style.transform=`translateX(${N.right-B.right}px)`)},0);const E=this.map.getContainer();E&&(E.style.touchAction="manipulation")}),b.on("popupclose",()=>{const Z=this.map.getContainer();Z&&(Z.style.touchAction="")})),v===f&&this.config.markers.infoMarker){const Z=this.getPolygonGeoJSONFromFeatureGroup(r),Y=this.turfHelper.getPolygonArea(Z),tt=this.getTotalPolygonPerimeter(Z);b.options.zIndexOffset=this.config.markers.markerInfoIcon.zIndexOffset??this.config.markers.zIndexOffset,b.on("click",()=>{const E=this.generateInfoMarkerPopup(Y,tt),G=hi.getCenterOfMass(Z);E.setLatLng(G).openOn(this.map)}),b.on("popupopen",E=>{const N=E.popup.getElement();if(!N)return;setTimeout(()=>{const $=this.map.getContainer().getBoundingClientRect(),P=N.getBoundingClientRect();P.left<$.left?N.style.transform=`translateX(${$.left-P.left}px)`:P.right>$.right&&(N.style.transform=`translateX(${$.right-P.right}px)`)},0);const B=this.map.getContainer();B&&(B.style.touchAction="manipulation")}),b.on("popupclose",()=>{const E=this.map.getContainer();E&&(E.style.touchAction="")})}b.on("mousedown",Z=>{this.modeManager.isInOffMode()||(ot.DomEvent.stopPropagation(Z),this.map.fire("mousedown",Z)),this._activeMarker=b}),b.on("click",Z=>{if(this.modeManager.isInOffMode())if(this.isEdgeDeletionModifierKeyPressed(Z.originalEvent)){const Y=r.getLayers().find(tt=>tt instanceof ot.Polygon);Y&&this.elbowClicked(Z,Y,b.getLatLng())}else v===u&&this.config.markers.deleteMarker&&(this.map.closePopup(),this.removeFeatureGroup(r),this.polygonInformation.createPolygonInformationStorage(this.getFeatureGroups()),this.eventManager.emit("polydraw:polygon:deleted",void 0))}),b.on("mouseover",()=>this.onMarkerHoverForEdgeDeletion(b,!0)),b.on("mouseout",()=>this.onMarkerHoverForEdgeDeletion(b,!1))});const d=this.map.getContainer();d&&(d.style.touchAction="manipulation")}addHoleMarkers(n,r){var o,u,f;const m=((o=this.config.markers.holeMarkers)==null?void 0:o.menuMarker)??!1,d=((u=this.config.markers.holeMarkers)==null?void 0:u.deleteMarker)??!1,x=((f=this.config.markers.holeMarkers)==null?void 0:f.infoMarker)??!1;let v=this.getMarkerIndex(n,this.config.markers.markerMenuIcon.position),w=this.getMarkerIndex(n,this.config.markers.markerDeleteIcon.position),I=this.getMarkerIndex(n,this.config.markers.markerInfoIcon.position);const T=this.ensureMarkerSeparation(n.length,{menu:{index:v,enabled:m},delete:{index:w,enabled:d},info:{index:I,enabled:x}});v=T.menu,w=T.delete,I=T.info,n.forEach((b,D)=>{let Z=this.config.markers.holeIcon.styleClasses;D===v&&m&&(Z=this.config.markers.markerMenuIcon.styleClasses),D===w&&d&&(Z=this.config.markers.markerDeleteIcon.styleClasses),D===I&&x&&(Z=this.config.markers.markerInfoIcon.styleClasses);const Y=Array.isArray(Z)?Z:[Z],tt=D===v&&m||D===w&&d||D===I&&x,E=new ot.Marker(b,{icon:this.createDivIcon(Y),draggable:this.config.modes.dragElbow,title:this.config.markers.coordsTitle?this.getLatLngInfoString(b):"",zIndexOffset:this.config.markers.holeIcon.zIndexOffset??this.config.markers.zIndexOffset});r.addLayer(E).addTo(this.map),this.markerFeatureGroupMap.set(E,r),E.on("add",()=>{const N=E.getElement();N&&(N.style.pointerEvents="auto")}),E.on("click",N=>{var B,z;this.isDraggingMarker&&((z=(B=N.originalEvent)==null?void 0:B.stopPropagation)==null||z.call(B),ot.DomEvent.stopPropagation(N))}),E.on("dragstart",()=>{this.isDraggingMarker=!0,this._activeMarker=E}),E.on("dragend",N=>{const B=this.markerFeatureGroupMap.get(E);this.modeManager.canPerformAction("markerDrag")&&B&&this.markerDragEnd(B),this._activeMarker=null,ot.DomEvent.stopPropagation(N),setTimeout(()=>{this.isDraggingMarker=!1},10)});const G=E.getElement();if(G&&(G.addEventListener("touchstart",N=>{N.stopPropagation()},{passive:!0}),G.addEventListener("touchend",N=>{if(N.preventDefault(),N.stopPropagation(),E.fire("click"),this.isDraggingMarker&&!tt){const B=this.markerFeatureGroupMap.get(E);this.modeManager.canPerformAction("markerDrag")&&B&&this.markerDragEnd(B)}this._activeMarker=null})),D===v||D===w||D===I){const N=E.getElement();N&&(N.style.zIndex="10000")}if(this.config.modes.dragElbow){const N=B=>()=>{this.modeManager.canPerformAction("markerDrag")&&this.markerDrag(B)};E.on("drag",N(r))}if(D===v&&m&&(E.options.zIndexOffset=this.config.markers.markerMenuIcon.zIndexOffset??this.config.markers.zIndexOffset,E.on("click",()=>{const N=n.map(P=>[P.lng,P.lat]);N.push(N[0]);const B={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[N]}},z=hi.getCenterOfMass(B);this.generateMenuMarkerPopup(n,r).setLatLng(z).openOn(this.map)}),E.on("popupopen",N=>{const z=N.popup.getElement();if(!z)return;setTimeout(()=>{const S=this.map.getContainer().getBoundingClientRect(),C=z.getBoundingClientRect();C.left<S.left?z.style.transform=`translateX(${S.left-C.left}px)`:C.right>S.right&&(z.style.transform=`translateX(${S.right-C.right}px)`)},0);const $=this.map.getContainer();$&&($.style.touchAction="manipulation")}),E.on("popupclose",()=>{const N=this.map.getContainer();N&&(N.style.touchAction="")})),D===I&&x){const N=n.map(P=>[P.lng,P.lat]);N.push(N[0]);const B={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[N]}},z=this.turfHelper.getPolygonArea(B),$=this.turfHelper.getPolygonPerimeter(B)*1e3;E.options.zIndexOffset=this.config.markers.markerInfoIcon.zIndexOffset??this.config.markers.zIndexOffset,E.on("click",()=>{this.generateInfoMarkerPopup(z,$).setLatLng(b).openOn(this.map)})}E.on("mousedown",N=>{this.modeManager.isInOffMode()||(ot.DomEvent.stopPropagation(N),this.map.fire("mousedown",N)),this._activeMarker=E}),E.on("click",N=>{if(this.modeManager.isInOffMode()){if(this.isEdgeDeletionModifierKeyPressed(N.originalEvent)){const B=r.getLayers().find(z=>z instanceof ot.Polygon);B&&this.elbowClicked(N,B,E.getLatLng())}else if(D===w&&d){this.map.closePopup();const B=r.getLayers().find(z=>z instanceof ot.Polygon);if(B){const z=B.getLatLngs();let $=[];if(Array.isArray(z)&&z.length>0)if(Array.isArray(z[0])){const C=z[0];Array.isArray(C)&&Array.isArray(C[0])?$=z[0]:$=z}else $=[z];const P=E.getLatLng();let S=-1;for(let C=1;C<$.length;C++)if($[C].some(R=>R.lat===P.lat&&R.lng===P.lng)){S=C;break}if(S>0){const R=$.filter((V,H)=>H!==S).map(V=>{const H=V.map(X=>[X.lng,X.lat]);if(H.length>0){const X=H[0],q=H[H.length-1];(X[0]!==q[0]||X[1]!==q[1])&&H.push([X[0],X[1]])}return H}),F=this.turfHelper.getMultiPolygon([R]);this.removeFeatureGroup(r),this.eventManager.emit("polydraw:polygon:updated",{operation:"removeHole",polygon:F})}}}}}),E.on("mouseover",()=>this.onMarkerHoverForEdgeDeletion(E,!0)),E.on("mouseout",()=>this.onMarkerHoverForEdgeDeletion(E,!1))})}addEdgeClickListeners(n,r){const o=n.getLatLngs();let u;if(Array.isArray(o)&&o.length>0)if(Array.isArray(o[0]))if(Array.isArray(o[0][0])&&o[0][0].length>0){const f=o[0][0][0];f&&typeof f=="object"&&"lat"in f,u=o[0]}else o[0][0]&&typeof o[0][0]=="object"&&"lat"in o[0][0]?u=o:u=o[0];else o[0]&&typeof o[0]=="object"&&"lat"in o[0]?u=[o]:u=[o];else return;u.forEach((f,m)=>{for(let d=0;d<f.length;d++){const x=f[d],v=f[(d+1)%f.length];if(x.lat===v.lat&&x.lng===v.lng)continue;const w=Gt.createPolyline([x,v],{color:"transparent",weight:10,opacity:0,interactive:!0});w._polydrawEdgeInfo={ringIndex:m,edgeIndex:d,startPoint:x,endPoint:v,parentPolygon:n,parentFeatureGroup:r},w.on("click",I=>{this.onEdgeClick(I,w)}),w.on("mouseover",()=>{this.highlightEdgeOnHover(w,!0)}),w.on("mouseout",()=>{this.highlightEdgeOnHover(w,!1)}),r.addLayer(w)}})}enablePolygonDragging(n,r){this.config.modes.dragPolygons&&(n._polydrawOriginalLatLngs=r,n._polydrawDragData={isDragging:!1,startPosition:null,startLatLngs:null,originalOpacity:n.options.fillOpacity},n.on("mousedown",o=>{if(!this.modeManager.isInOffMode()){ot.DomEvent.stopPropagation(o),this.map.fire("mousedown",o);return}if(!this.modeManager.canPerformAction("polygonDrag"))return;ot.DomEvent.stopPropagation(o.originalEvent),ot.DomEvent.preventDefault(o.originalEvent);const u=this.detectDragSubtractModifierKey(o.originalEvent);this.currentModifierDragMode=u,this.isModifierKeyHeld=u,n._polydrawDragData.isDragging=!0,n._polydrawDragData.startPosition=o.latlng,n._polydrawDragData.startLatLngs=n.getLatLngs(),n.setStyle({fillOpacity:this.config.dragPolygons.opacity}),this.map.dragging&&this.map.dragging.disable(),this.setSubtractVisualMode(n,u),this.setMarkerVisibility(n,!1);try{const f=this.map.getContainer();f.style.cursor=this.config.dragPolygons.dragCursor||"move"}catch{}this.map.on("mousemove",this.onPolygonMouseMove,this),this.map.on("mouseup",this.onPolygonMouseUp,this),this.map.on("pointermove",this.onPolygonMouseMove,this),this.map.on("pointerup",this.onPolygonMouseUp,this),this.currentDragPolygon=n}),n.on("pointerdown",o=>{if(!this.modeManager.isInOffMode()){ot.DomEvent.stopPropagation(o),this.map.fire("pointerdown",o);return}if(!this.modeManager.canPerformAction("polygonDrag"))return;const u=o&&o.originalEvent?o.originalEvent:o;ot.DomEvent.stopPropagation(u),ot.DomEvent.preventDefault(u);const f=this.detectDragSubtractModifierKey(u);this.currentModifierDragMode=f,this.isModifierKeyHeld=f,n._polydrawDragData.isDragging=!0,n._polydrawDragData.startPosition=o.latlng,n._polydrawDragData.startLatLngs=n.getLatLngs(),n.setStyle({fillOpacity:this.config.dragPolygons.opacity}),this.map.dragging&&this.map.dragging.disable(),this.setSubtractVisualMode(n,f),this.setMarkerVisibility(n,!1);try{const m=this.map.getContainer();m.style.cursor=this.config.dragPolygons.dragCursor||"move"}catch{}this.map.on("mousemove",this.onPolygonMouseMove,this),this.map.on("mouseup",this.onPolygonMouseUp,this),this.map.on("pointermove",this.onPolygonMouseMove,this),this.map.on("pointerup",this.onPolygonMouseUp,this),this.currentDragPolygon=n}),n.on("mouseover",()=>{if(!n._polydrawDragData||!n._polydrawDragData.isDragging)try{const o=this.map.getContainer();o.style.cursor=this.config.dragPolygons.hoverCursor||"grab"}catch{}}),n.on("mouseout",()=>{if(!n._polydrawDragData||!n._polydrawDragData.isDragging)try{const o=this.map.getContainer();o.style.cursor=""}catch{}}))}updateMarkerDraggableState(){const n=this.modeManager.canPerformAction("markerDrag");this.getFeatureGroups().forEach(r=>{r.eachLayer(o=>{if(o instanceof ot.Marker){const u=o;try{u.options.draggable=n,u.dragging&&(n?u.dragging.enable():u.dragging.disable())}catch{}}})})}updateAllMarkersForEdgeDeletion(n){this.getFeatureGroups().forEach(r=>{r.eachLayer(o=>{o instanceof ot.Marker&&this.updateMarkerForEdgeDeletion(o,n)})})}updateMarkerForEdgeDeletion(n,r){const o=n.getElement();o&&(r?(o.addEventListener("mouseenter",this.onMarkerHoverForEdgeDeletionEvent),o.addEventListener("mouseleave",this.onMarkerLeaveForEdgeDeletionEvent)):(o.removeEventListener("mouseenter",this.onMarkerHoverForEdgeDeletionEvent),o.removeEventListener("mouseleave",this.onMarkerLeaveForEdgeDeletionEvent),o.style.backgroundColor="",o.style.borderColor=""))}setModifierKeyHeld(n){this.isModifierKeyHeld=n}onEdgeClick(n,r){if(!this.config.modes.attachElbow||!this.modeManager.isInOffMode())return;const o=r._polydrawEdgeInfo;if(!o)return;const u=n.latlng,f=o.parentPolygon,m=o.parentFeatureGroup;if(f&&m)try{if(typeof f.toGeoJSON!="function")return;const d=f.toGeoJSON();if(d.geometry.type==="MultiPolygon"||d.geometry.type==="Polygon"){const x=this.turfHelper.injectPointToPolygon(d,[u.lng,u.lat],o.ringIndex);if(x){const w=f._polydrawOptimizationLevel||0;this.removeFeatureGroup(m),this.eventManager.emit("polydraw:polygon:updated",{operation:"addVertex",polygon:x,optimizationLevel:w})}}}catch{}ot.DomEvent.stopPropagation(n)}highlightEdgeOnHover(n,r){r?n.setStyle({color:this.config.colors.edgeHover,weight:4,opacity:1}):n.setStyle({color:"transparent",weight:10,opacity:0})}elbowClicked(n,r,o){if(!this.config.modes.edgeDeletion||!this.isEdgeDeletionModifierKeyPressed(n.originalEvent))return;const u=o??n.latlng,f=r.getLatLngs();let m=[];if(Array.isArray(f)&&f.length>0)if(Array.isArray(f[0])){const D=f[0];Array.isArray(D)&&Array.isArray(D[0])?m=f[0]:m=f}else m=[f];else return;let d=-1,x=-1;for(let D=0;D<m.length;D++){const Z=m[D];for(let Y=0;Y<Z.length;Y++){const tt=Z[Y];if(tt.lat===u.lat&&tt.lng===u.lng){d=D,x=Y;break}}if(d!==-1)break}if(d===-1||x===-1||m[d].length<=this.config.edgeDeletion.minVertices)return;const I=m.map((D,Z)=>{if(Z!==d)return D.slice();const Y=D.slice();return Y.splice(x,1),Y}).map(D=>{const Z=D.map(Y=>[Y.lng,Y.lat]);if(Z.length>0){const Y=Z[0],tt=Z[Z.length-1];(Y[0]!==tt[0]||Y[1]!==tt[1])&&Z.push([Y[0],Y[1]])}return Z});let T=null;for(const D of this.getFeatureGroups()){let Z=!1;if(D.eachLayer(Y=>{Y===r&&(Z=!0)}),Z){T=D;break}}T&&this.removeFeatureGroup(T);const b=this.turfHelper.getMultiPolygon([I]);this.eventManager.emit("polydraw:polygon:updated",{operation:"removeVertex",polygon:b})}markerDrag(n){if(!this._activeMarker){Wt()||console.warn("No active marker set for dragging.");return}const r=[];let o=[],u=[];const f=n.getLayers(),m=f.find(w=>w instanceof ot.Polygon);if(!m){Wt()||console.warn("No polygon found in feature group for marker drag.");return}const d=m.getLatLngs();let x=0;const v=f.filter(w=>w instanceof ot.Marker);if(d.length>1)for(let w=0;w<d.length;w++)if(o=[],u=[],w===0){if(d[0].length>1)for(let I=0;I<d[0].length;I++){for(let T=0;T<d[0][I].length;T++)v[T]&&o.push(v[T].getLatLng());u.push(o)}else{for(let I=0;I<d[0][0].length;I++)v[I]&&o.push(v[I].getLatLng());u.push(o)}r.push(u)}else{x+=d[w-1].length;for(let I=x;I<d[w][0].length+x;I++)v[I]&&o.push(v[I].getLatLng());u.push(o),r.push(u)}else{u=[];let w=0;for(let I=0;I<d[0].length;I++){if(o=[],I===0)if(d[0][I].length>1)for(let T=0;T<d[0][I].length;T++)v[T]&&o.push(v[T].getLatLng());else for(let T=0;T<d[0][0].length;T++)v[T]&&o.push(v[T].getLatLng());else{w+=d[0][I-1].length;for(let T=w;T<d[0][I].length+w;T++)v[T]&&o.push(v[T].getLatLng())}u.push(o)}r.push(u)}m.setLatLngs(r)}async markerDragEnd(n){this.polygonInformation.deletePolygonInformationStorage();const r=n.toGeoJSON();if(!(!r.features||r.features.length===0)){if(this.removeFeatureGroup(n),r.features[0].geometry.type==="MultiPolygon")for(const o of r.features[0].geometry.coordinates){const u=this.turfHelper.getMultiPolygon([o]);if(this.turfHelper.hasKinks(u)){const f=this.turfHelper.getKinks(u);for(const m of f)this.eventManager.emit("polydraw:polygon:updated",{operation:"markerDrag",polygon:this.turfHelper.getTurfPolygon(m),allowMerge:!0,intelligentMerge:!0})}else this.eventManager.emit("polydraw:polygon:updated",{operation:"markerDrag",polygon:u,allowMerge:!0,intelligentMerge:!0})}else{const o=this.turfHelper.getMultiPolygon([r.features[0].geometry.coordinates]);if(this.turfHelper.hasKinks(o)){const u=this.turfHelper.getKinks(o);for(const f of u)this.eventManager.emit("polydraw:polygon:updated",{operation:"markerDrag",polygon:this.turfHelper.getTurfPolygon(f),allowMerge:!1})}else this.eventManager.emit("polydraw:polygon:updated",{operation:"markerDrag",polygon:o,allowMerge:!1})}this.polygonInformation.createPolygonInformationStorage(this.getFeatureGroups())}}offsetPolygonCoordinates(n,r,o){return n&&(Array.isArray(n[0])?n.map(u=>this.offsetPolygonCoordinates(u,r,o)):n.map(u=>Gt.createLatLng(u.lat+r,u.lng+o)))}updateMarkersAndHoleLinesDuringDrag(n,r,o){try{let u=null;for(const m of this.getFeatureGroups()){let d=!1;if(m.eachLayer(x=>{x===n&&(d=!0)}),d){u=m;break}}if(!u)return;const f="_polydrawDragSession_"+Date.now()+"_"+Gt.util.stamp(n);n._polydrawCurrentDragSession||(n._polydrawCurrentDragSession=f,n._polydrawOriginalMarkerPositions=new Map,n._polydrawOriginalHoleLinePositions=new Map,u.eachLayer(m=>{if(m instanceof ot.Marker)n._polydrawOriginalMarkerPositions.set(m,m.getLatLng());else if(m instanceof ot.Polyline&&!(m instanceof ot.Polygon)){const d=m.getLatLngs();n._polydrawOriginalHoleLinePositions.set(m,d)}})),u.eachLayer(m=>{if(m instanceof ot.Marker){const d=n._polydrawOriginalMarkerPositions.get(m);if(d){const x={lat:d.lat+r,lng:d.lng+o};m.setLatLng(x)}}else if(m instanceof ot.Polyline&&!(m instanceof ot.Polygon)){const d=n._polydrawOriginalHoleLinePositions.get(m);if(d){let x;Array.isArray(d[0])?x=d.map(v=>v.map(w=>Gt.createLatLng(w.lat+r,w.lng+o))):x=d.map(v=>Gt.createLatLng(v.lat+r,v.lng+o)),m.setLatLngs(x)}}})}catch(u){console.warn("Error updating markers during drag:",u)}}async updatePolygonAfterDrag(n){try{let r=null;for(const f of this.getFeatureGroups())if(f.eachLayer(m=>{m===n&&(r=f)}),r)break;if(!r)return;const o=n.toGeoJSON();if(this.isModifierDragActive()){this.performModifierSubtract(o,r),this.currentModifierDragMode=!1,this.isModifierKeyHeld=!1;return}this.removeFeatureGroup(r);const u=this.turfHelper.getTurfPolygon(o);this.eventManager.emit("polydraw:polygon:updated",{operation:"polygonDrag",polygon:u,allowMerge:!0}),this.polygonInformation.createPolygonInformationStorage(this.getFeatureGroups())}catch{}}getDragSubtractModifierKey(){const{keys:n}=this.config.dragPolygons.modifierSubtract,r=navigator.userAgent.toLowerCase(),o=r.includes("mac"),u=r.includes("windows");return o&&n.mac?n.mac:u&&n.windows?n.windows:n.linux?n.linux:o?"metaKey":"ctrlKey"}detectDragSubtractModifierKey(n){if(ga())return!1;const r=this.getDragSubtractModifierKey();return n[r]||!1}setSubtractVisualMode(n,r){if(!(!n||!n.setStyle))try{r?n.setStyle({color:this.config.colors.dragPolygons.subtract}):n.setStyle({color:this.config.colors.polygon.border}),this.updateMarkerColorsForSubtractMode(n,r)}catch{}}updateMarkerColorsForSubtractMode(n,r){try{let o=null;for(const m of this.getFeatureGroups())if(m.eachLayer(d=>{d===n&&(o=m)}),o)break;if(!o)return;const u=o,f=this.config.dragPolygons.modifierSubtract.hideMarkersOnDrag;u.eachLayer(m=>{if(m instanceof ot.Marker){const x=m.getElement();x&&(r?f?(x.style.display="none",x.classList.add("subtract-mode-hidden")):(x.style.backgroundColor=this.config.colors.dragPolygons.subtract,x.style.borderColor=this.config.colors.dragPolygons.subtract,x.classList.add("subtract-mode")):f?(x.style.display="",x.classList.remove("subtract-mode-hidden")):(x.style.backgroundColor="",x.style.borderColor="",x.classList.remove("subtract-mode")))}})}catch{}}handleModifierToggleDuringDrag(n){const r=this.detectDragSubtractModifierKey(n);this.currentModifierDragMode=r,this.isModifierKeyHeld=r,this.currentDragPolygon&&this.setSubtractVisualMode(this.currentDragPolygon,r)}isModifierDragActive(){return this.currentModifierDragMode}performModifierSubtract(n,r){try{const o=this.turfHelper.getTurfPolygon(n),u=[];this.getFeatureGroups().forEach(f=>{if(f!==r)try{const m=f.toGeoJSON();if(!m||!m.features||!m.features[0])return;const d=m.features[0];if(!d.geometry||!d.geometry.coordinates)return;const x=this.turfHelper.getTurfPolygon(d);try{const v=this.turfHelper.getIntersection(x,o);v&&v.geometry&&"coordinates"in v.geometry&&v.geometry.coordinates.length>0&&u.push(f)}catch{try{this.turfHelper.polygonIntersect(x,o)&&u.push(f)}catch{}}}catch{}}),this.removeFeatureGroup(r),u.forEach(f=>{try{const m=f.toGeoJSON(),d=this.turfHelper.getTurfPolygon(m.features[0]);this.removeFeatureGroup(f);try{const x=this.turfHelper.polygonDifference(d,o);if(x&&x.geometry){const v=this.turfHelper.getCoords(x);for(const w of v){const I=this.turfHelper.getMultiPolygon([w]);this.eventManager.emit("polydraw:polygon:updated",{operation:"modifierSubtract",polygon:this.turfHelper.getTurfPolygon(I),allowMerge:!1})}}}catch(x){Wt()||console.warn("Failed to perform difference operation:",x),this.eventManager.emit("polydraw:polygon:updated",{operation:"modifierSubtractFallback",polygon:d,allowMerge:!1})}}catch(m){Wt()||console.warn("Error in modifier subtract operation:",m)}}),this.polygonInformation.createPolygonInformationStorage(this.getFeatureGroups())}catch(o){Wt()||console.warn("Error in performModifierSubtract:",o)}}getEdgeDeletionModifierKey(){const{keys:n}=this.config.edgeDeletion,r=navigator.userAgent.toLowerCase(),o=r.includes("mac"),u=r.includes("windows");return o&&n.mac?n.mac:u&&n.windows?n.windows:n.linux?n.linux:o?"metaKey":"ctrlKey"}isEdgeDeletionModifierKeyPressed(n){if(ga())return!1;const r=this.getEdgeDeletionModifierKey();return!!n[r]}onMarkerHoverForEdgeDeletion(n,r){const o=n.getElement();if(o)if(r){const u=m=>{if(this.isEdgeDeletionModifierKeyPressed(m)){o.style.backgroundColor=this.config.colors.edgeDeletion.hover,o.style.borderColor=this.config.colors.edgeDeletion.hover,o.classList.add("edge-deletion-hover");try{const x=this.map.getContainer();x.style.cursor="pointer"}catch{}}else{o.style.backgroundColor="",o.style.borderColor="",o.classList.remove("edge-deletion-hover");try{const x=this.map.getContainer();x.style.cursor=""}catch{}}},f=new MouseEvent("mouseover");u(f),this.markerModifierHandlers.set(n,u),document.addEventListener("keydown",u),document.addEventListener("keyup",u),o.addEventListener("mousemove",u)}else{o.style.backgroundColor="",o.style.borderColor="",o.classList.remove("edge-deletion-hover");try{const f=this.map.getContainer();f.style.cursor=""}catch{}const u=this.markerModifierHandlers.get(n);u&&(document.removeEventListener("keydown",u),document.removeEventListener("keyup",u),o.removeEventListener("mousemove",u),this.markerModifierHandlers.delete(n))}}getMarkerIndex(n,r){const o=hg.getBounds(n,Math.sqrt(2)/2),f=new cg(o.getSouth(),o.getWest(),o.getNorth(),o.getEast()).getDirection(r),m={lat:f.lat,lng:f.lng},d=this.turfHelper.getCoord(m),x=this.turfHelper.getFeaturePointCollection(n);return this.turfHelper.getNearestPointIndex(d,x)}ensureMarkerSeparation(n,r){const o=[];if(r.menu.enabled&&o.push({type:"menu",index:r.menu.index}),r.delete.enabled&&o.push({type:"delete",index:r.delete.index}),r.info.enabled&&o.push({type:"info",index:r.info.index}),o.length<2)return{menu:r.menu.index,delete:r.delete.index,info:r.info.index};const u={...r},f=new Set,m=["info","delete","menu"];for(const d of m){const x=u[d];if(x.enabled)if(f.has(x.index)){const v=this.findAlternativeMarkerPosition(n,x.index,f);u[d].index=v,f.add(v)}else f.add(x.index)}return{menu:u.menu.index,delete:u.delete.index,info:u.info.index}}findAlternativeMarkerPosition(n,r,o){const u=n,f=Math.max(1,Math.floor(n/8));for(let m=1;m<u;m++){const d=[(r+m*f)%n,(r-m*f+n)%n];for(const x of d)if(!o.has(x))return x}for(let m=0;m<n;m++)if(!o.has(m))return m;return r}createDivIcon(n){return Eg.createDivIcon(n)}getLatLngInfoString(n){return"Latitude: "+n.lat+" Longitude: "+n.lng}setMarkerVisibility(n,r){const o=this.getFeatureGroups().find(u=>u.hasLayer(n));o&&o.eachLayer(u=>{if(u instanceof ot.Marker){const m=u.getElement();if(m){const d=this.config.dragPolygons.markerBehavior,x=this.config.dragPolygons.markerAnimationDuration;d==="hide"?m.style.display=r?"":"none":d==="fade"&&(m.style.transition=`opacity ${x}ms ease`,m.style.opacity=r?"1":"0")}}})}generateMenuMarkerPopup(n,r){const o=document.createElement("div");o.classList.add("alter-marker-outer-wrapper");const u=document.createElement("div");u.classList.add("alter-marker-wrapper");const f=document.createElement("div");f.classList.add("content");const m=document.createElement("div");m.classList.add("marker-menu-content");const d=document.createElement("div");d.classList.add("marker-menu-button","simplify"),d.title="Simplify";const x=document.createElement("div");x.classList.add("marker-menu-button","double-elbows"),x.title="DoubleElbows";const v=document.createElement("div");v.classList.add("marker-menu-button","bbox"),v.title="Bounding box";const w=document.createElement("div");w.classList.add("marker-menu-button","bezier"),w.title="Curve";const I=document.createElement("span");I.classList.add("alpha-banner"),I.textContent="ALPHA",w.appendChild(I);const T=document.createElement("div");T.classList.add("separator"),o.appendChild(u),u.appendChild(f),f.appendChild(m),m.appendChild(d),m.appendChild(T.cloneNode()),m.appendChild(x),m.appendChild(T.cloneNode()),m.appendChild(v),m.appendChild(T.cloneNode()),m.appendChild(w);const b=()=>{this._openMenuPopup&&(this.map.closePopup(this._openMenuPopup),this._openMenuPopup=null)};d.addEventListener("touchend",Y=>{Y.preventDefault(),Y.stopPropagation(),this.eventManager.emit("polydraw:menu:action",{action:"simplify",latLngs:n,featureGroup:r}),b()}),d.onclick=()=>{this.eventManager.emit("polydraw:menu:action",{action:"simplify",latLngs:n,featureGroup:r}),b()},v.addEventListener("touchend",Y=>{Y.preventDefault(),Y.stopPropagation(),this.eventManager.emit("polydraw:menu:action",{action:"bbox",latLngs:n,featureGroup:r}),b()}),v.onclick=()=>{this.eventManager.emit("polydraw:menu:action",{action:"bbox",latLngs:n,featureGroup:r}),b()},x.addEventListener("touchend",Y=>{Y.preventDefault(),Y.stopPropagation(),this.eventManager.emit("polydraw:menu:action",{action:"doubleElbows",latLngs:n,featureGroup:r}),b()}),x.onclick=()=>{this.eventManager.emit("polydraw:menu:action",{action:"doubleElbows",latLngs:n,featureGroup:r}),b()},w.addEventListener("touchend",Y=>{Y.preventDefault(),Y.stopPropagation(),this.eventManager.emit("polydraw:menu:action",{action:"bezier",latLngs:n,featureGroup:r}),b()}),w.onclick=()=>{this.eventManager.emit("polydraw:menu:action",{action:"bezier",latLngs:n,featureGroup:r}),b()},ot.DomEvent.disableClickPropagation(o),o.style.pointerEvents="auto",o.querySelectorAll(".marker-menu-button").forEach(Y=>{Y.style.pointerEvents="auto",Y.addEventListener("click",tt=>tt.stopPropagation())});const D=window.innerWidth<=600,Z=Gt.createPopup({closeButton:!0,autoClose:!0,className:`menu-popup${D?" mobile-popup":""}`}).setContent(o);return this._openMenuPopup=Z,Z}getPolygonGeoJSONFromFeatureGroup(n){try{const r=n.getLayers().find(o=>o instanceof ot.Polygon);if(!r)throw new Error("No polygon found in feature group");return r.toGeoJSON()}catch(r){return Wt()||(r instanceof Error?console.warn("Error getting polygon GeoJSON from feature group:",r.message):console.warn("Error getting polygon GeoJSON from feature group:",r)),{type:"Feature",geometry:{type:"Polygon",coordinates:[[[0,0],[0,1],[1,1],[1,0],[0,0]]]},properties:{}}}}getTotalPolygonPerimeter(n){try{if(!n||!n.geometry)return 0;let r=0;if(n.geometry.type==="Polygon"){const o=n.geometry.coordinates;for(const u of o){const f={type:"Feature",geometry:{type:"Polygon",coordinates:[u]},properties:{}},m=this.turfHelper.getPolygonPerimeter(f);r+=m}}else if(n.geometry.type==="MultiPolygon"){const o=n.geometry.coordinates;for(const u of o)for(const f of u){const m={type:"Feature",geometry:{type:"Polygon",coordinates:[f]},properties:{}},d=this.turfHelper.getPolygonPerimeter(m);r+=d}}return r*1e3}catch(r){return Wt()||(r instanceof Error?console.warn("Error calculating total polygon perimeter:",r.message):console.warn("Error calculating total polygon perimeter:",r)),this.turfHelper.getPolygonPerimeter(n)*1e3}}generateInfoMarkerPopup(n,r){const o=new fg(r,this.config),u=new gg(n,this.config),f=document.createElement("div");f.classList.add("info-marker-outer-wrapper");const m=document.createElement("div");m.classList.add("info-marker-wrapper");const d=document.createElement("div");d.classList.add("content");const x=document.createElement("div");x.classList.add("info-marker-content");const v=document.createElement("div");v.classList.add("info-item","area"),v.innerHTML=`<strong>Area:</strong> ${u.metricArea} ${u.metricUnit}`;const w=document.createElement("div");w.classList.add("info-item","perimeter"),w.innerHTML=`<strong>Perimeter:</strong> ${o.metricLength} ${o.metricUnit}`,x.appendChild(v),x.appendChild(w),d.appendChild(x),f.appendChild(m),m.appendChild(d),ot.DomEvent.disableClickPropagation(f),f.style.pointerEvents="auto",f.querySelectorAll("button").forEach(b=>{b.style.pointerEvents="auto",b.addEventListener("click",D=>D.stopPropagation())});const I=window.innerWidth<=600;return Gt.createPopup({closeButton:!0,autoClose:!0,className:`info-popup${I?" mobile-popup":""}`}).setContent(f)}}class Lg{constructor(n){at(this,"turfHelper"),at(this,"map"),at(this,"config"),at(this,"eventManager"),at(this,"getFeatureGroups"),at(this,"geometryManager"),at(this,"interactionManager"),this.turfHelper=n.turfHelper,this.map=n.map,this.config=n.config,this.eventManager=n.eventManager,this.getFeatureGroups=n.getFeatureGroups,this.initializeSpecializedManagers(n)}initializeSpecializedManagers(n){this.geometryManager=new wg({turfHelper:n.turfHelper,config:n.config}),this.interactionManager=new Pg({turfHelper:n.turfHelper,polygonInformation:n.polygonInformation,map:n.map,config:n.config,modeManager:n.modeManager,eventManager:this.eventManager},{getFeatureGroups:this.getFeatureGroups,addFeatureGroup:r=>this.addFeatureGroupInternal(r),removeFeatureGroup:r=>this.removeFeatureGroupInternal(r)}),this.setupEventForwarding()}setupEventForwarding(){this.eventManager.on("polydraw:draw:cancel",n=>{this.emit("drawCancelled",n)}),this.eventManager.on("polydraw:polygon:updated",n=>{this.handlePolygonModified(n)}),this.eventManager.on("polydraw:menu:action",n=>{this.handleMenuAction(n)}),this.eventManager.on("polydraw:check:intersection",n=>{const r=this.geometryManager.checkPolygonIntersection(n.polygon1,n.polygon2);n.callback(r)}),this.eventManager.on("polydraw:subtract",n=>{this.subtractPolygon(n.subtractPolygon)}),this.eventManager.on("polydraw:polygon:deleted",()=>{this.emit("polygonDeleted",void 0)})}async handlePolygonModified(n){const r=n.operation!=="addVertex"&&n.operation!=="markerDrag"&&n.operation!=="polygonDrag";let o=n.allowMerge;n.intelligentMerge&&n.operation==="markerDrag"&&(o=this.shouldAllowIntelligentMerge(n.polygon));const u={simplify:r,noMerge:!o,visualOptimizationLevel:n.optimizationLevel||0};await this.addPolygon(n.polygon,u)}async handleMenuAction(n){const r=this.getCompletePolygonFromFeatureGroup(n.featureGroup);this.removeFeatureGroupInternal(n.featureGroup);let o;switch(n.action){case"simplify":{o=this.geometryManager.simplifyPolygon(r);break}case"bbox":{o=this.geometryManager.convertToBoundingBox(r);break}case"doubleElbows":{o=this.geometryManager.doubleElbowsPolygon(r);break}case"bezier":{o=this.geometryManager.bezierifyPolygon(r);break}default:return}o.success&&o.result&&await this.addPolygon(o.result,{simplify:!1})}get polygonInteractionManager(){return this.interactionManager}on(n,r){this.eventManager.on(n,r)}emit(n,r){this.eventManager.emit(n,r)}async addPolygon(n,r={}){const{noMerge:o=!1}=r;try{return this.isPolygonInsideExistingHole(n)?await this.addPolygonLayer(n,r):this.config.mergePolygons&&!o&&this.getFeatureGroups().length>0&&!this.config.kinks?await this.mergePolygon(n,r):await this.addPolygonLayer(n,r)}catch(u){return{success:!1,error:u instanceof Error?u.message:"Unknown error in addPolygon"}}}async subtractPolygon(n){try{const r=[];this.getFeatureGroups().forEach(u=>{try{const f=u.toGeoJSON();if(!f||!f.features||!f.features[0])return;const m=f.features[0];if(!m.geometry||!m.geometry.coordinates)return;const d=this.turfHelper.getTurfPolygon(m);this.geometryManager.checkPolygonIntersection(d,n)&&r.push(u)}catch{}});const o=[];for(const u of r)try{const f=u.toGeoJSON(),m=this.turfHelper.getTurfPolygon(f.features[0]),d=this.geometryManager.subtractPolygon(m,n);if(this.removeFeatureGroupInternal(u),d.success&&d.results)for(const x of d.results){const v=await this.addPolygonLayer(x,{simplify:!0});v.success&&v.featureGroups&&o.push(...v.featureGroups)}}catch{}return this.emit("polygonSubtracted",{subtractedPolygon:n,affectedFeatureGroups:r,resultFeatureGroups:o}),this.emit("polygonOperationComplete",{operation:"subtract",polygon:n,resultFeatureGroups:o}),{success:!0,featureGroups:o}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown error in subtractPolygon"}}}async addPolygonLayer(n,r={}){const{simplify:o=!0,dynamicTolerance:u=!1,visualOptimizationLevel:f=0}=r;try{if(!n||!n.geometry||!n.geometry.coordinates)return{success:!1,error:"Invalid polygon data"};const m=new ot.FeatureGroup,d=o?this.turfHelper.getSimplified(n,u):n;let x;try{if(x=this.getPolygon(d),!x)return{success:!1,error:"Failed to create polygon"};x._polydrawOptimizationLevel=f,m.addLayer(x)}catch{return{success:!1,error:"Failed to create polygon layer"}}let v;try{const w=x.getLatLngs();v=this.normalizePolygonCoordinates(w)}catch{v=[]}try{v.forEach((w,I)=>{if(!w||!Array.isArray(w))return;const T=[];if(w.forEach(b=>{Array.isArray(b)&&b.length>=2?T.push({lat:b[1],lng:b[0]}):typeof b=="object"&&b!==null&&"lat"in b&&"lng"in b&&T.push(b)}),T.length!==0)try{if(I===0)this.interactionManager.addMarkers(T,m);else{const b=Gt.createPolyline(T,{color:this.config.colors.hole.border,weight:this.config.holeOptions.weight||2,opacity:this.config.holeOptions.opacity||1,fillColor:this.config.colors.hole.fill,fillOpacity:this.config.holeOptions.fillOpacity||.5});m.addLayer(b),this.interactionManager.addHoleMarkers(T,m)}}catch{}})}catch{}try{this.interactionManager.addEdgeClickListeners(x,m)}catch{}this.getFeatureGroups().push(m);try{m.addTo(this.map)}catch{}return this.emit("polygonAdded",{polygon:d,featureGroup:m}),this.emit("polygonOperationComplete",{operation:"add",polygon:d,featureGroup:m}),{success:!0,featureGroups:[m]}}catch(m){return{success:!1,error:m instanceof Error?m.message:"Unknown error in addPolygonLayer"}}}async mergePolygon(n,r={}){try{const o=[],u=[];let f=!1;return this.getFeatureGroups().forEach(m=>{try{const d=m.toGeoJSON();if(!d||!d.features||!d.features[0])return;const x=d.features[0];if(!x.geometry||!x.geometry.coordinates)return;if(this.isPositionArrayofArrays(x.geometry.coordinates))x.geometry.coordinates.forEach(v=>{try{const w=this.turfHelper.getMultiPolygon([v]);f=this.geometryManager.checkPolygonIntersection(w,n),f&&(u.push(m),o.push(w))}catch{}});else try{const v=this.turfHelper.getTurfPolygon(x);f=this.geometryManager.checkPolygonIntersection(v,n),f&&(u.push(m),o.push(v))}catch{}}catch{}}),u.length>0?await this.unionPolygons(u,n,o,r):await this.addPolygonLayer(n,r)}catch(o){return{success:!1,error:o instanceof Error?o.message:"Unknown error in mergePolygon"}}}async unionPolygons(n,r,o,u={}){try{n.forEach(m=>{this.removeFeatureGroupInternal(m)});const f=this.geometryManager.unionPolygons(o,r);if(f.success&&f.result){const m=await this.addPolygonLayer(f.result,u);return this.emit("polygonsUnioned",{originalPolygons:o,resultPolygon:f.result,featureGroups:m.featureGroups}),m}else return{success:!1,error:f.error||"Failed to union polygons"}}catch(f){return{success:!1,error:f instanceof Error?f.message:"Unknown error in unionPolygons"}}}shouldAllowIntelligentMerge(n){try{for(const r of this.getFeatureGroups())try{const o=r.toGeoJSON();if(!o||!o.features||!o.features[0])continue;const u=o.features[0];if(!u.geometry||!u.geometry.coordinates)continue;const f=this.turfHelper.getTurfPolygon(u);if(this.geometryManager.checkPolygonIntersection(f,n))return!0}catch{continue}return!1}catch{return!1}}isPolygonInsideExistingHole(n){try{for(const r of this.getFeatureGroups())try{const o=r.toGeoJSON();if(!o||!o.features||!o.features[0])continue;const u=o.features[0];if(!u.geometry||!u.geometry.coordinates)continue;let f=!1,m=[];if(u.geometry.type==="Polygon")f=u.geometry.coordinates.length>1,f&&(m=u.geometry.coordinates.slice(1));else if(u.geometry.type==="MultiPolygon")for(const d of u.geometry.coordinates)d.length>1&&(f=!0,m.push(...d.slice(1)));if(f&&m.length>0)for(const d of m)try{const x=this.turfHelper.createPolygon([d]);if(this.turfHelper.isPolygonCompletelyWithin(n,x))return!0}catch{continue}}catch{continue}return!1}catch{return!1}}normalizePolygonCoordinates(n){if(!Array.isArray(n)||n.length===0)return[];const r=u=>u!==null&&typeof u=="object"&&"lat"in u&&"lng"in u&&typeof u.lat=="number"&&typeof u.lng=="number",o=u=>{if(!Array.isArray(u))return[];if(u.length>0&&r(u[0]))return[u];const f=[];for(const m of u)if(Array.isArray(m))if(m.length>0&&r(m[0]))f.push(m);else{const d=o(m);f.push(...d)}return f};try{return o(n)}catch{return[]}}isPositionArrayofArrays(n){if(!Array.isArray(n)||n.length===0)return!1;const r=n[0];if(!Array.isArray(r)||r.length===0)return!1;const o=r[0];if(!Array.isArray(o)||o.length===0)return!1;const u=o[0];return this.isPosition(u)}isPosition(n){return Array.isArray(n)&&n.length>=2&&n.every(r=>typeof r=="number")}getPolygon(n){const r=ot.GeoJSON.geometryToLayer(n),o={...this.config.polygonOptions,color:this.config.colors.polygon.border,fillColor:this.config.colors.polygon.fill,weight:this.config.polygonOptions.weight||2,opacity:this.config.polygonOptions.opacity||1,fillOpacity:this.config.polygonOptions.fillOpacity||.2};return r.setStyle(o),r._polydrawUniqueId=Gt.util.stamp(r)+"_"+Date.now(),delete r._polydrawDragData,delete r._polydrawOriginalLatLngs,delete r._polydrawCurrentDragSession,delete r._polydrawOriginalMarkerPositions,delete r._polydrawOriginalHoleLinePositions,this.config.modes.dragPolygons&&this.interactionManager.enablePolygonDragging(r,n),r}addFeatureGroupInternal(n){this.getFeatureGroups().push(n)}removeFeatureGroupInternal(n){n.clearLayers();const r=this.getFeatureGroups(),o=r.indexOf(n);o>-1&&r.splice(o,1),this.map.removeLayer(n)}getCompletePolygonFromFeatureGroup(n){try{let r=null;if(n.eachLayer(o=>{o instanceof ot.Polygon&&(r=o)}),!r)throw new Error("No polygon found in feature group");return r.toGeoJSON()}catch(r){return Wt()||r instanceof Error&&console.warn("Error getting complete polygon GeoJSON from feature group:",r.message),{type:"Feature",geometry:{type:"Polygon",coordinates:[[[0,0],[0,1],[1,1],[1,0],[0,0]]]},properties:{}}}}updateMarkerDraggableState(){this.interactionManager.updateMarkerDraggableState()}updateAllMarkersForEdgeDeletion(n){this.interactionManager.updateAllMarkersForEdgeDeletion(n)}setModifierKeyHeld(n){this.interactionManager.setModifierKeyHeld(n)}checkPolygonIntersection(n,r){return this.geometryManager.checkPolygonIntersection(n,r)}getPolygonCenter(n){try{if(!n||!n.geometry||!n.geometry.coordinates)return null;let r;if(n.geometry.type==="Polygon")r=n.geometry.coordinates[0];else if(n.geometry.type==="MultiPolygon")r=n.geometry.coordinates[0][0];else return null;if(!Array.isArray(r)||r.length===0)return null;let o=0,u=0,f=0;for(const m of r)if(Array.isArray(m)&&m.length>=2){const d=m[0],x=m[1];typeof d=="number"&&typeof x=="number"&&!isNaN(d)&&!isNaN(x)&&(u+=d,o+=x,f++)}return f===0?null:{lat:o/f,lng:u/f}}catch{return null}}getBoundingBox(n){try{if(!n||!n.geometry||!n.geometry.coordinates)return null;let r;if(n.geometry.type==="Polygon")r=n.geometry.coordinates[0];else if(n.geometry.type==="MultiPolygon")r=n.geometry.coordinates[0][0];else return null;if(!Array.isArray(r)||r.length===0)return null;let o=1/0,u=-1/0,f=1/0,m=-1/0;for(const d of r)if(Array.isArray(d)&&d.length>=2){const x=d[0],v=d[1];typeof x=="number"&&typeof v=="number"&&!isNaN(x)&&!isNaN(v)&&(f=Math.min(f,x),m=Math.max(m,x),o=Math.min(o,v),u=Math.max(u,v))}return o===1/0||u===-1/0||f===1/0||m===-1/0?null:{minLat:o,maxLat:u,minLng:f,maxLng:m}}catch{return null}}addMarker(n,r){this.interactionManager.addMarkers(n,r)}addHoleMarker(n,r){this.interactionManager.addHoleMarkers(n,r)}addEdgeClickListeners(n,r){this.interactionManager.addEdgeClickListeners(n,r)}enablePolygonDragging(n,r){this.interactionManager.enablePolygonDragging(n,r)}getMarkerIndex(n,r){return 0}ensureMarkerSeparation(n,r){var o,u,f;return{menu:((o=r.menu)==null?void 0:o.index)??0,delete:((u=r.delete)==null?void 0:u.index)??1,info:((f=r.info)==null?void 0:f.index)??2}}findAlternativeMarkerPosition(n,r,o){return(r+1)%n}createDivIcon(n){return Gt.createDivIcon({className:n.join(" ")})}getLatLngInfoString(n){return"Latitude: "+n.lat+" Longitude: "+n.lng}generateMenuMarkerPopup(n,r){const o=document.createElement("div");return o.innerHTML="Menu",o}getPolygonGeoJSONFromFeatureGroup(n){return{type:"Feature",geometry:{type:"Polygon",coordinates:[[[0,0],[0,1],[1,1],[1,0],[0,0]]]},properties:{}}}getTotalPolygonPerimeter(n){return 1e3}generateInfoMarkerPopup(n,r){const o=document.createElement("div");return o.innerHTML=`Area: ${n}, Perimeter: ${r}`,o}onMarkerHoverForEdgeDeletion(n,r){}highlightEdgeOnHover(n,r){}onEdgeClick(n,r){}removeFeatureGroup(n){this.removeFeatureGroupInternal(n)}onPolygonMouseMove(n){}onPolygonMouseUp(n){}updatePolygonAfterDrag(n){}setSubtractVisualMode(n,r){}performModifierSubtract(n,r){try{const o=this.turfHelper.getTurfPolygon(n),u=[];this.getFeatureGroups().forEach(f=>{if(f!==r)try{const m=f.toGeoJSON();if(!m||!m.features||!m.features[0])return;const d=m.features[0];if(!d.geometry||!d.geometry.coordinates)return;const x=this.turfHelper.getTurfPolygon(d);this.geometryManager.checkPolygonIntersection(x,o)&&u.push(f)}catch{}}),this.removeFeatureGroupInternal(r),u.forEach(f=>{try{const m=f.toGeoJSON(),d=this.turfHelper.getTurfPolygon(m.features[0]);this.removeFeatureGroupInternal(f);const x=this.geometryManager.subtractPolygon(d,o);if(x.success&&x.results)for(const v of x.results)this.addPolygonLayer(v,{simplify:!0})}catch{}})}catch{}}}function Mg(h){const n=document.createElement("style");n.innerHTML=`
    .leaflet-control a { background-color: ${h.colors.styles.controlButton.backgroundColor}; color: ${h.colors.styles.controlButton.color}; display: flex; align-items: center; justify-content: center; }
    .leaflet-control a:hover { background-color: ${h.colors.styles.controlButtonHover.backgroundColor}; }
    .leaflet-control a.active { background-color: ${h.colors.styles.controlButtonActive.backgroundColor}; color: ${h.colors.styles.controlButtonActive.color}; }
    .polydraw-indicator-active { background-color: ${h.colors.styles.indicatorActive.backgroundColor} !important; }
    .crosshair-cursor-enabled { cursor: crosshair !important; }
    .crosshair-cursor-enabled * { cursor: crosshair !important; }
    .leaflet-polydraw-p2p-marker { background-color: ${h.colors.styles.p2pMarker.backgroundColor}; border: 2px solid ${h.colors.styles.p2pMarker.borderColor}; border-radius: 50%; box-sizing: border-box; }
    .leaflet-polydraw-p2p-first-marker { position: relative; }
    .leaflet-polydraw-p2p-first-marker:hover { transform: scale(1.5); transition: all 0.2s ease; }
  `,document.head.appendChild(n)}class ai{static normalizeEvent(n){return ui.getVersion()===Et.V2&&(n.layer&&!n.propagatedFrom&&(n.propagatedFrom=n.layer),(n.type==="mousedown"||n.type==="touchstart")&&(n._isPointerEvent=!0)),n}static getEventName(n){if(ui.getVersion()===Et.V2)switch(n){case"mousedown":return"pointerdown";case"mouseup":return"pointerup";case"mousemove":return"pointermove";case"touchstart":return"pointerdown";case"touchend":return"pointerup";case"touchmove":return"pointermove";default:return n}return n}static shouldUsePointerEvents(){return ui.getVersion()===Et.V2&&"PointerEvent"in window}static extractCoordinates(n,r){if(n.latlng)return n.latlng;if(n.touches&&n.touches.length>0){const o=r.getContainer().getBoundingClientRect();return r.containerPointToLatLng([n.touches[0].clientX-o.x,n.touches[0].clientY-o.y])}if(n.pointerType&&n.clientX!==void 0){const o=r.getContainer().getBoundingClientRect();return r.containerPointToLatLng([n.clientX-o.x,n.clientY-o.y])}if(n.clientX!==void 0){const o=r.getContainer().getBoundingClientRect();return r.containerPointToLatLng([n.clientX-o.x,n.clientY-o.y])}return null}static shouldPreventDefault(n){return n.type&&n.type.startsWith("touch")?!0:n.pointerType&&n.isPrimary===!1?!1:!!("cancelable"in n&&n.cancelable)}static getEventNames(){return ui.getVersion()===Et.V2&&this.shouldUsePointerEvents()?{start:["pointerdown"],move:["pointermove"],end:["pointerup"]}:{start:["mousedown","touchstart"],move:["mousemove","touchmove"],end:["mouseup","touchend"]}}}class _o{static calculateAngle(n,r,o){const u={x:n.lng-r.lng,y:n.lat-r.lat},f={x:o.lng-r.lng,y:o.lat-r.lat},m=u.x*f.x+u.y*f.y,d=Math.sqrt(u.x*u.x+u.y*u.y),x=Math.sqrt(f.x*f.x+f.y*f.y);if(d===0||x===0)return 0;const v=m/(d*x);return Math.acos(Math.max(-1,Math.min(1,v)))}static calculateDistanceFromLine(n,r,o){const u=r.lng-n.lng,f=r.lat-n.lat,m=o.lng-n.lng,d=o.lat-n.lat,x=u*m+f*d,v=m*m+d*d;if(v===0)return Math.sqrt(u*u+f*f);const w=x/v;let I,T;w<0?(I=n.lng,T=n.lat):w>1?(I=o.lng,T=o.lat):(I=n.lng+w*m,T=n.lat+w*d);const b=r.lng-I,D=r.lat-T;return Math.sqrt(b*b+D*D)}static calculateCentroid(n){return hi.getCenter(n)}static calculateDistance(n,r){const o=n.lng-r.lng,u=n.lat-r.lat;return Math.sqrt(o*o+u*u)}static offsetPolygonCoordinates(n,r,o){return n&&(Array.isArray(n[0])?n.map(u=>_o.offsetPolygonCoordinates(u,r,o)):n.lat!==void 0&&n.lng!==void 0?{lat:n.lat+r,lng:n.lng+o}:n.map(u=>_o.offsetPolygonCoordinates(u,r,o)))}}class Ig{static convertToCoords(n,r){const o=[];if(n.length>1&&n.length<3){const u=[];r.isWithin(ot.GeoJSON.latLngsToCoords(n[n.length-1]),ot.GeoJSON.latLngsToCoords(n[0]))?n.forEach(m=>{u.push(ot.GeoJSON.latLngsToCoords(m))}):n.forEach(m=>{o.push([ot.GeoJSON.latLngsToCoords(m)])}),u.length>=1&&o.push(u)}else if(n.length>2){const u=[];for(let f=1;f<n.length-1;f++)r.isWithin(ot.GeoJSON.latLngsToCoords(n[f]),ot.GeoJSON.latLngsToCoords(n[0]))?(n.forEach(d=>{u.push(ot.GeoJSON.latLngsToCoords(d))}),o.push(u)):n.forEach(d=>{o.push([ot.GeoJSON.latLngsToCoords(d)])})}else o.push([ot.GeoJSON.latLngsToCoords(n[0])]);return o}static offsetPolygonCoordinates(n,r,o){return _o.offsetPolygonCoordinates(n,r,o)}static getLatLngInfoString(n){return"Latitude: "+n.lat+" Longitude: "+n.lng}static convertToLatLng(n){if(typeof n=="object"&&n!==null){if("lat"in n&&"lng"in n)return Gt.createLatLng(n.lat,n.lng);if("latitude"in n&&"longitude"in n||"longitude"in n&&"latitude"in n)return Gt.createLatLng(n.latitude,n.longitude);if("lng"in n&&"lat"in n)return Gt.createLatLng(n.lat,n.lng)}if(Array.isArray(n)&&n.length>=2){const[r,o]=n;if(typeof r=="number"&&typeof o=="number")return r>90||o>90||r>180||o>180?Gt.createLatLng(o,r):Gt.createLatLng(r,o)}if(typeof n=="string"){const r=n.trim();if(r.includes(",")&&!r.includes("")&&!r.includes("'")&&!r.includes('"')){const w=r.split(",").map(I=>parseFloat(I.trim()));if(w.length>=2&&!isNaN(w[0])&&!isNaN(w[1]))return this.convertToLatLng(w)}const o=r.match(/(\d+)(\d+)'(?:(\d+(?:\.\d+)?)")?([NS])\s*,?\s*(\d+)(\d+)'(?:(\d+(?:\.\d+)?)")?([EW])/i);if(o){const[,w,I,T,b,D,Z,Y,tt]=o,E=parseFloat(w)+parseFloat(I)/60+parseFloat(T||"0")/3600,G=parseFloat(D)+parseFloat(Z)/60+parseFloat(Y||"0")/3600,N=b.toUpperCase()==="S"?-E:E,B=tt.toUpperCase()==="W"?-G:G;return Gt.createLatLng(N,B)}const u=r.match(/(\d+)(\d+(?:\.\d+)?)'([NS])\s*,?\s*(\d+)(\d+(?:\.\d+)?)'([EW])/i);if(u){const[,w,I,T,b,D,Z]=u,Y=parseFloat(w)+parseFloat(I)/60,tt=parseFloat(b)+parseFloat(D)/60,E=T.toUpperCase()==="S"?-Y:Y,G=Z.toUpperCase()==="W"?-tt:tt;return Gt.createLatLng(E,G)}const f=r.match(/(\d+(?:\.\d+)?)?\s*([NS])\s*,\s*(\d+(?:\.\d+)?)?\s*([EW])/i);if(f){const[,w,I,T,b]=f,D=I.toUpperCase()==="S"?-parseFloat(w):parseFloat(w),Z=b.toUpperCase()==="W"?-parseFloat(T):parseFloat(T);return Gt.createLatLng(D,Z)}const m=r.match(/N\s*(\d+(?:\.\d+)?)\s+E\s*(\d+(?:\.\d+)?)/i);if(m){const[,w,I]=m;return Gt.createLatLng(parseFloat(w),parseFloat(I))}if(r.match(/(?:UTM\s+)?(\d+)([NS])\s+(\d+(?:\.\d+)?)\s+(\d+(?:\.\d+)?)/i))throw new Error(`UTM coordinates detected: ${r}. UTM conversion requires specialized libraries like proj4js. Please convert to decimal degrees first.`);if(r.match(/(\d+)([A-Z])\s+([A-Z]{2})\s+(\d+)\s+(\d+)/i))throw new Error(`MGRS coordinates detected: ${r}. MGRS conversion requires specialized libraries. Please convert to decimal degrees first.`);if(r.match(/^[23456789CFGHJMPQRVWX]{2,3}[23456789CFGHJMPQRVWX]{3,7}\+[23456789CFGHJMPQRVWX]{2,3}$/i))throw new Error(`Plus Code detected: ${r}. Plus Code conversion requires specialized libraries. Please convert to decimal degrees first.`)}throw new Error(`Unable to convert coordinate: ${JSON.stringify(n)}`)}static convertToLatLngArray(n){return n.map(r=>r.map(o=>o.map(u=>this.convertToLatLng(u))))}}class wl extends ot.Control{constructor(n){super(n),at(this,"map"),at(this,"tracer"),at(this,"turfHelper"),at(this,"subContainer"),at(this,"config"),at(this,"mapStateService"),at(this,"eventManager"),at(this,"polygonInformation"),at(this,"modeManager"),at(this,"polygonDrawManager"),at(this,"polygonMutationManager"),at(this,"arrayOfFeatureGroups",[]),at(this,"drawMode",At.Off),at(this,"drawModeListeners",[]),at(this,"_boundKeyDownHandler"),at(this,"_boundKeyUpHandler"),at(this,"isModifierKeyHeld",!1),at(this,"_boundTouchMove"),at(this,"_boundTouchEnd"),at(this,"_boundTouchStart"),at(this,"_boundPointerDown"),at(this,"_boundPointerMove"),at(this,"_boundPointerUp"),at(this,"_lastTapTime",0),at(this,"_tapTimeout",null),at(this,"_handleActivateToggle",()=>{const r=this.getContainer();if(!r)return;const o=r.querySelector(".icon-activate");Gt.domUtil.hasClass(o,"active")?(Gt.domUtil.removeClass(o,"active"),this.subContainer&&(this.subContainer.style.maxHeight="0px")):(Gt.domUtil.addClass(o,"active"),this.subContainer&&(this.subContainer.style.maxHeight="250px")),this.updateActivateButtonIndicator()}),at(this,"_handleDrawClick",r=>{if(r&&(r.preventDefault(),r.stopPropagation()),this.modeManager.getCurrentMode()===At.Add){this.setDrawMode(At.Off);return}this.setDrawMode(At.Add),this.polygonInformation.saveCurrentState()}),at(this,"_handleSubtractClick",r=>{if(r&&(r.preventDefault(),r.stopPropagation()),this.modeManager.getCurrentMode()===At.Subtract){this.setDrawMode(At.Off);return}this.setDrawMode(At.Subtract),this.polygonInformation.saveCurrentState()}),at(this,"_handleEraseClick",r=>{this.map.closePopup(),r&&(r.preventDefault(),r.stopPropagation()),this.arrayOfFeatureGroups.length!==0&&this.removeAllFeatureGroups()}),at(this,"_handlePointToPointClick",r=>{if(r&&(r.preventDefault(),r.stopPropagation()),this.modeManager.getCurrentMode()===At.PointToPoint){this.setDrawMode(At.Off);return}this.setDrawMode(At.PointToPoint),this.polygonInformation.saveCurrentState()}),at(this,"onMarkerHoverForEdgeDeletionEvent",r=>{if(!this.isModifierKeyHeld)return;const o=r.target;o&&(o.style.backgroundColor=this.config.colors.edgeDeletion.hover,o.style.borderColor=this.config.colors.edgeDeletion.hover,o.classList.add("edge-deletion-hover"))}),at(this,"onMarkerLeaveForEdgeDeletionEvent",r=>{const o=r.target;o&&(o.style.backgroundColor="",o.style.borderColor="",o.classList.remove("edge-deletion-hover"))}),this.config=Ni,n!=null&&n.configPath?this.loadExternalConfig(n.configPath,n==null?void 0:n.config):(this.config={...Ni,...(n==null?void 0:n.config)||{}},this.initializeComponents())}onAdd(n){const r=n,o=ot.Browser;r._onResize=()=>{},o.touch&&o.mobile&&(r.tap=!1),this.map=n,this.setupKeyboardHandlers();const u=Gt.domUtil.create("div","leaflet-control leaflet-bar");return this.initializeUI(u),this.createTracer(),this.initializeManagers(),this.setupEventListeners(),u}onRemove(n){this.removeKeyboardHandlers(),this.tracer&&this.map.removeLayer(this.tracer),this.removeAllFeatureGroups()}addTo(n){return super.addTo(n),this}getFeatureGroups(){return this.arrayOfFeatureGroups}async addPredefinedPolygon(n,r){const o=Ig.convertToLatLngArray(n);if(!o||o.length===0)throw new Error("Cannot add empty polygon array");if(!this.map)throw new Error("Map not initialized");if(!this.polygonMutationManager)throw new Error("PolygonMutationManager not initialized");const u=(r==null?void 0:r.visualOptimizationLevel)??0;for(const[f,m]of o.entries()){if(!m||!m[0]||m[0].length<4)throw new Error(`Invalid polygon data at index ${f}: A polygon must have at least 3 unique vertices.`);try{const d=m.map(w=>w.map(I=>[I.lng,I.lat])),x=this.turfHelper.getMultiPolygon([d]),v=await this.polygonMutationManager.addPolygon(x,{simplify:!1,noMerge:!1,visualOptimizationLevel:u});if(!v.success)throw console.error("Error adding polygon via manager:",v.error),new Error(v.error||"Failed to add polygon");this.polygonInformation.createPolygonInformationStorage(this.arrayOfFeatureGroups)}catch(d){throw console.error("Error adding auto polygon:",d),d}}}setDrawMode(n){const r=this.drawMode;this._updateDrawModeState(n),r===At.PointToPoint&&n!==At.PointToPoint?(this.polygonDrawManager.clearP2pMarkers(),this.stopDraw()):n===At.Off?this.stopDraw():n!==At.PointToPoint&&this.stopDraw(),this.map&&(this._updateUIAfterDrawModeChange(n),this._updateMapInteractions())}getDrawMode(){return this.modeManager.getCurrentMode()}on(n,r){this.eventManager.on(n,r)}off(n,r){this.eventManager.off(n,r)}removeAllFeatureGroups(){this.arrayOfFeatureGroups.forEach(n=>{try{this.map.removeLayer(n)}catch{}}),this.arrayOfFeatureGroups.length=0,this.polygonInformation.deletePolygonInformationStorage(),this.polygonInformation.updatePolygons(),this.updateActivateButtonIndicator()}initializeUI(n){Mg(this.config),ot.DomEvent.disableClickPropagation(n),ot.DomEvent.on(n,"mousedown",ot.DomEvent.stopPropagation),ot.DomEvent.on(n,"touchstart",ot.DomEvent.stopPropagation),ot.DomEvent.on(n,"click",ot.DomEvent.stopPropagation),n.style.display="flex",n.style.flexDirection="column-reverse",n.style.pointerEvents="auto",n.style.position="relative",n.style.zIndex="1000",this.subContainer=Gt.domUtil.create("div","sub-buttons",n),this.subContainer.style.maxHeight="0px",this.subContainer.style.overflow="hidden",this.subContainer.style.transition="max-height 0.3s ease",this.subContainer.style.pointerEvents="auto",this.subContainer.style.position="relative",mg(n,this.subContainer,this.config,this._handleActivateToggle,this._handleDrawClick,this._handleSubtractClick,this._handleEraseClick,this._handlePointToPointClick),this.ensureButtonTouchResponsiveness(n);const r=o=>{const u=n.querySelector(".icon-draw"),f=n.querySelector(".icon-subtract");u&&u.classList.toggle("active",o===At.Add),f&&f.classList.toggle("active",o===At.Subtract)};this.drawModeListeners.push(r)}setupEventListeners(){this.polygonMutationManager.on("polygonOperationComplete",()=>{this.updateActivateButtonIndicator(),this.modeManager.updateStateForMode(At.Off),this.drawMode=At.Off,this.emitDrawModeChanged(),this.updateMarkerDraggableState();const n=this.modeManager.shouldShowCrosshairCursor(),r=this.modeManager.canPerformAction("mapDrag"),o=this.modeManager.canPerformAction("mapZoom"),u=this.modeManager.canPerformAction("mapDoubleClickZoom");n?Gt.domUtil.addClass(this.map.getContainer(),"crosshair-cursor-enabled"):Gt.domUtil.removeClass(this.map.getContainer(),"crosshair-cursor-enabled"),this.events(!1),this.setLeafletMapEvents(r,u,o);try{this.tracer.setStyle({color:""})}catch{}}),this.polygonMutationManager.on("polygonDeleted",()=>{this.updateActivateButtonIndicator()}),this.eventManager.on("polydraw:polygon:created",async n=>{this.stopDraw(),n.isPointToPoint?await this.polygonMutationManager.addPolygon(n.polygon,{simplify:!1,noMerge:!1}):await this.handleFreehandDrawCompletion(n.polygon),this.polygonInformation.createPolygonInformationStorage(this.arrayOfFeatureGroups)}),this.eventManager.on("polydraw:draw:cancel",()=>{this.stopDraw(),this.setDrawMode(At.Off)})}createTracer(){this.tracer=Gt.createPolyline([],{...this.config.polyLineOptions,color:this.config.colors.polyline});try{this.tracer.addTo(this.map)}catch{}}initializeManagers(){this.polygonDrawManager=new kg({turfHelper:this.turfHelper,map:this.map,config:this.config,modeManager:this.modeManager,eventManager:this.eventManager,tracer:this.tracer}),this.polygonMutationManager=new Lg({turfHelper:this.turfHelper,polygonInformation:this.polygonInformation,map:this.map,config:this.config,modeManager:this.modeManager,eventManager:this.eventManager,getFeatureGroups:()=>this.arrayOfFeatureGroups})}async loadExternalConfig(n,r){try{const o=await fetch(n);if(!o.ok)throw new Error(`Failed to load config from ${n}: ${o.status} ${o.statusText}`);const u=await o.json();this.config={...Ni,...u,...r||{}},this.initializeComponents()}catch(o){console.warn("Failed to load external config, falling back to default + inline config:",o),this.config={...Ni,...r||{}},this.initializeComponents()}}_updateDrawModeState(n){this.drawMode=n,this.modeManager.updateStateForMode(n),this.emitDrawModeChanged(),this.updateMarkerDraggableState()}_updateUIAfterDrawModeChange(n){this.modeManager.shouldShowCrosshairCursor()?Gt.domUtil.addClass(this.map.getContainer(),"crosshair-cursor-enabled"):Gt.domUtil.removeClass(this.map.getContainer(),"crosshair-cursor-enabled");try{switch(n){case At.Off:this.tracer.setStyle({color:""});break;case At.Add:this.tracer.setStyle({color:this.config.colors.polyline,dashArray:void 0});break;case At.Subtract:this.tracer.setStyle({color:this.config.colors.subtractLine,dashArray:void 0});break;case At.PointToPoint:this.tracer.setStyle({color:this.config.colors.polyline,dashArray:"5, 5"});break}}catch{}}_updateMapInteractions(){const n=this.modeManager.canPerformAction("mapDrag"),r=this.modeManager.canPerformAction("mapZoom"),o=this.modeManager.canPerformAction("mapDoubleClickZoom");this.events(this.drawMode!==At.Off),this.setLeafletMapEvents(n,o,r)}initializeComponents(){this.turfHelper=new kl(this.config),this.mapStateService=new vg,this.eventManager=new _g,this.polygonInformation=new yg(this.mapStateService),this.modeManager=new xg(this.config,this.eventManager),this.polygonInformation.onPolygonInfoUpdated(n=>{this.updateActivateButtonIndicator()}),this._boundKeyDownHandler=this.handleKeyDown.bind(this)}emitDrawModeChanged(){this.eventManager.emit("polydraw:mode:change",{mode:this.modeManager.getCurrentMode()});for(const n of this.drawModeListeners)n(this.modeManager.getCurrentMode())}updateMarkerDraggableState(){const n=this.modeManager.canPerformAction("markerDrag");this.arrayOfFeatureGroups.forEach(r=>{r.eachLayer(o=>{if(o instanceof ot.Marker){const u=o;try{u.options.draggable=n,u.dragging&&(n?u.dragging.enable():u.dragging.disable())}catch{}}})})}stopDraw(){this.resetTracker(),this.drawStartedEvents(!1)}setLeafletMapEvents(n,r,o){n?this.map.dragging.enable():this.map.dragging.disable(),r?this.map.doubleClickZoom.enable():this.map.doubleClickZoom.disable(),o?this.map.scrollWheelZoom.enable():this.map.scrollWheelZoom.disable()}resetTracker(){this.tracer.setLatLngs([])}drawStartedEvents(n){console.log("drawStartedEvents called with onoff:",n);const r=n?"on":"off";this.map[r]("mousemove",this.mouseMove,this),this.map[r]("mouseup",this.mouseUpLeave,this),n?(this._boundTouchMove=o=>this.mouseMove(o),this._boundTouchEnd=o=>this.mouseUpLeave(o),ui.isV2()&&(this._boundPointerMove=o=>this.mouseMove(o),this._boundPointerUp=o=>this.mouseUpLeave(o),this.map.getContainer().addEventListener("pointermove",this._boundPointerMove,{passive:!1}),this.map.getContainer().addEventListener("pointerup",this._boundPointerUp,{passive:!1})),this.map.getContainer().addEventListener("touchmove",this._boundTouchMove,{passive:!1}),this.map.getContainer().addEventListener("touchend",this._boundTouchEnd,{passive:!1})):(this._boundTouchMove&&this.map.getContainer().removeEventListener("touchmove",this._boundTouchMove),this._boundTouchEnd&&this.map.getContainer().removeEventListener("touchend",this._boundTouchEnd),this._boundPointerMove&&this.map.getContainer().removeEventListener("pointermove",this._boundPointerMove),this._boundPointerUp&&this.map.getContainer().removeEventListener("pointerup",this._boundPointerUp))}events(n){const r=n?"on":"off";this.map[r]("mousedown",this.mouseDown,this),this.map[r]("dblclick",this.handleDoubleClick,this),n?(this._boundTouchStart=o=>this.handleTouchStart(o),ui.isV2()&&(this._boundPointerDown=o=>this.mouseDown(o),this.map.getContainer().addEventListener("pointerdown",this._boundPointerDown,{passive:!1})),this.map.getContainer().addEventListener("touchstart",this._boundTouchStart,{passive:!1})):(this._boundTouchStart&&this.map.getContainer().removeEventListener("touchstart",this._boundTouchStart),this._boundPointerDown&&this.map.getContainer().removeEventListener("pointerdown",this._boundPointerDown))}handleTouchStart(n){const r=Date.now(),o=r-this._lastTapTime;this._tapTimeout&&(clearTimeout(this._tapTimeout),this._tapTimeout=null),o<300&&o>0?(this.handleDoubleTap(n),this._lastTapTime=0):(this._lastTapTime=r,this._tapTimeout=window.setTimeout(()=>{this.mouseDown(n),this._tapTimeout=null},300))}handleDoubleTap(n){this.modeManager.getCurrentMode()===At.PointToPoint&&this.polygonDrawManager.handleDoubleTap(n)}mouseDown(n){console.log("mouseDown called",n.type,n);const r=ai.normalizeEvent(n);if(ai.shouldPreventDefault(r)&&r.preventDefault(),this.modeManager.isInOffMode()){console.log("In off mode, ignoring");return}const o=ai.extractCoordinates(r,this.map);if(console.log("Extracted coordinates:",o),!o){console.log("No coordinates extracted");return}if(this.modeManager.getCurrentMode()===At.PointToPoint){console.log("Point-to-Point mode, calling handlePointToPointClick"),this.polygonDrawManager.handlePointToPointClick(o);return}console.log("Normal drawing mode, setting tracer and starting draw"),this.tracer.setLatLngs([o]),this.startDraw()}mouseMove(n){console.log("mouseMove called",n.type);const r=ai.normalizeEvent(n);ai.shouldPreventDefault(r)&&r.preventDefault();const o=ai.extractCoordinates(r,this.map);o&&(console.log("Adding latlng to tracer:",o),this.tracer.addLatLng(o))}async mouseUpLeave(n){console.log("mouseUpLeave called",n.type);const r=ai.normalizeEvent(n);ai.shouldPreventDefault(r)&&r.preventDefault(),this.polygonInformation.deletePolygonInformationStorage();const o=this.tracer.toGeoJSON();if(console.log("Tracer GeoJSON:",o),!o||!o.geometry||!o.geometry.coordinates||o.geometry.coordinates.length<3){this.stopDraw();return}let u;try{u=this.turfHelper.createPolygonFromTrace(o)}catch{this.stopDraw();return}if(!u||!u.geometry||!u.geometry.coordinates||u.geometry.coordinates.length===0){this.stopDraw();return}this.stopDraw();try{switch(this.modeManager.getCurrentMode()){case At.Add:{const f=await this.polygonMutationManager.addPolygon(u,{simplify:!0,noMerge:!1});f.success||console.error("Error adding polygon via manager:",f.error);break}case At.Subtract:{const f=await this.polygonMutationManager.subtractPolygon(u);f.success||console.error("Error subtracting polygon via manager:",f.error);break}default:break}}catch(f){console.error("Error in mouseUpLeave polygon operation:",f)}this.polygonInformation.createPolygonInformationStorage(this.arrayOfFeatureGroups)}async handleFreehandDrawCompletion(n){try{switch(this.modeManager.getCurrentMode()){case At.Add:{const r=await this.polygonMutationManager.addPolygon(n,{simplify:!0,noMerge:!1});r.success||console.error("Error adding polygon via manager:",r.error);break}case At.Subtract:{const r=await this.polygonMutationManager.subtractPolygon(n);r.success||console.error("Error subtracting polygon via manager:",r.error);break}default:break}}catch(r){console.error("Error in mouseUpLeave polygon operation:",r)}}startDraw(){console.log("startDraw called, attaching draw events"),this.drawStartedEvents(!0)}setupKeyboardHandlers(){this._boundKeyUpHandler=this.handleKeyUp.bind(this),document.addEventListener("keydown",this._boundKeyDownHandler),document.addEventListener("keyup",this._boundKeyUpHandler)}removeKeyboardHandlers(){document.removeEventListener("keydown",this._boundKeyDownHandler),document.removeEventListener("keyup",this._boundKeyUpHandler)}handleKeyDown(n){n.key==="Escape"&&this.modeManager.getCurrentMode()===At.PointToPoint&&this.polygonDrawManager.cancelPointToPointDrawing(),this.isModifierKeyPressed(n)&&!this.isModifierKeyHeld&&(this.isModifierKeyHeld=!0,this.polygonDrawManager.setModifierKey(!0),this.updateAllMarkersForEdgeDeletion(!0))}handleKeyUp(n){!this.isModifierKeyPressed(n)&&this.isModifierKeyHeld&&(this.isModifierKeyHeld=!1,this.polygonDrawManager.setModifierKey(!1),this.updateAllMarkersForEdgeDeletion(!1))}updateAllMarkersForEdgeDeletion(n){this.arrayOfFeatureGroups.forEach(r=>{r.eachLayer(o=>{o instanceof ot.Marker&&this.updateMarkerForEdgeDeletion(o,n)})})}updateMarkerForEdgeDeletion(n,r){const o=n.getElement();o&&(r?(o.addEventListener("mouseenter",this.onMarkerHoverForEdgeDeletionEvent),o.addEventListener("mouseleave",this.onMarkerLeaveForEdgeDeletionEvent)):(o.removeEventListener("mouseenter",this.onMarkerHoverForEdgeDeletionEvent),o.removeEventListener("mouseleave",this.onMarkerLeaveForEdgeDeletionEvent),o.style.backgroundColor="",o.style.borderColor=""))}handleDoubleClick(n){this.modeManager.getCurrentMode()===At.PointToPoint&&this.polygonDrawManager.handleDoubleClick(n)}isModifierKeyPressed(n){return navigator.userAgent.toLowerCase().includes("mac")?n.metaKey:n.ctrlKey}ensureButtonTouchResponsiveness(n){n.querySelectorAll("a").forEach(o=>{o.style.pointerEvents="auto",o.style.touchAction="manipulation",o.style.position="relative",o.style.zIndex="1";const u=f=>{f.stopPropagation(),f.target.style.pointerEvents="auto"};o.addEventListener("touchstart",u,{passive:!0}),o.addEventListener("touchend",u,{passive:!0})})}updateActivateButtonIndicator(){if(typeof this.getContainer!="function")return;const n=this.getContainer();if(!n)return;const r=n.querySelector(".icon-activate");if(!r)return;const o=this.arrayOfFeatureGroups.length>0,u=!Gt.domUtil.hasClass(r,"active");o&&u?Gt.domUtil.addClass(r,"polydraw-indicator-active"):Gt.domUtil.removeClass(r,"polydraw-indicator-active")}}typeof zl<"u"&&ot.control&&(ot.control.polydraw=function(h){return new wl(h)});ot.latLng(58.404493,15.6),ot.latLng(58.402928,15.602928),ot.latLng(58.4,15.604493),ot.latLng(58.397072,15.602928),ot.latLng(58.395507,15.6),ot.latLng(58.397072,15.597072),ot.latLng(58.4,15.595507),ot.latLng(58.402928,15.597072),ot.latLng(58.404493,15.6);ot.latLng(58.407,15.597),ot.latLng(58.407,15.603),ot.latLng(58.397,15.603),ot.latLng(58.397,15.597),ot.latLng(58.407,15.597),ot.latLng(58.403,15.599),ot.latLng(58.403,15.601),ot.latLng(58.401,15.601),ot.latLng(58.401,15.599),ot.latLng(58.403,15.599);ot.latLng(58.405,15.595),ot.latLng(58.405,15.6),ot.latLng(58.4,15.6),ot.latLng(58.4,15.595),ot.latLng(58.405,15.595),ot.latLng(58.403,15.598),ot.latLng(58.403,15.603),ot.latLng(58.398,15.603),ot.latLng(58.398,15.598),ot.latLng(58.403,15.598);ot.latLng(58.41,15.59),ot.latLng(58.41,15.595),ot.latLng(58.405,15.592),ot.latLng(58.41,15.59);const gs=ot.map("map").setView([58.4108,15.6214],13);ot.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'<span>&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors</span>'}).addTo(gs);const xr=new wl;xr.addTo(gs);function vs(){const h=xr.getFeatureGroups(),n=document.getElementById("count-value"),r=document.getElementById("structure-value");if(!r)return;const o=h.map(b=>{let D={outer:0,holes:[],coordinates:null};return b.eachLayer(Z=>{if(Z instanceof ot.Polygon){const Y=Z,tt=Y.getLatLngs();D.coordinates=tt,D.layer=Y;const E=C=>{if(!Array.isArray(C)||C.length<2)return!1;const R=C[0],F=C[C.length-1];return R&&typeof R.equals=="function"?R.equals(F,1e-9):Math.abs(R.lat-F.lat)<1e-12&&Math.abs(R.lng-F.lng)<1e-12},G=C=>Array.isArray(C)?C.length-(E(C)?1:0):0,N=C=>!C||C.length===0||E(C)?C:[...C,C[0]],B=C=>{if(!C||C.length<2)return 0;const R=N(C);let F=0;for(let V=1;V<R.length;V++)F+=gs.distance(R[V-1],R[V]);return F},z=C=>{if(!C||C.length<3)return 0;const R=N(C);let F=0;const V=R.map(H=>gs.project(H,gs.getZoom()));for(let H=1;H<V.length;H++){const X=V[H-1].x,q=V[H-1].y,Q=V[H].x,W=V[H].y;F+=X*W-Q*q}return F/2},$=C=>{const R=z(C);return R===0?"N/A":R>0?"CCW":"CW"},P=C=>N(C).map(F=>`${F.lng} ${F.lat}`).join(", "),S=C=>`POLYGON (${C.map(F=>`(${P(F)})`).join(", ")})`;if(Array.isArray(tt)&&tt.length>0){if(Array.isArray(tt[0]))if(Array.isArray(tt[0][0])){const C=tt[0];C.length>0&&(D.outer=G(C[0]),C.length>1&&(D.holes=C.slice(1).map(R=>G(R))))}else{const C=tt;C.length>0&&(D.outer=G(C[0]),C.length>1&&(D.holes=C.slice(1).map(R=>G(R))))}else{const C=tt;D.outer=G(C)}try{let C=[];Array.isArray(tt)&&(Array.isArray(tt[0])?Array.isArray(tt[0][0])?C=tt[0]:C=tt:C=[tt]);const R=C[0]||[],F=C.slice(1),V=B(R),H=F.map(it=>B(it)),X=V+H.reduce((it,J)=>it+J,0),q=$(R),Q=F.map(it=>$(it)),W=Y.getBounds();D.metrics={outerPerimeter:V,holePerimeters:H,totalPerimeter:X,outerOrientation:q,holeOrientations:Q,bounds:{sw:W.getSouthWest(),ne:W.getNorthEast()}},D.wkt=S(C)}catch(C){console.warn("Metric/WKT computation failed:",C)}}}}),D}),u=b=>{if(!b)return"No coordinates available";const D=Y=>Array.isArray(Y)?Y.map(tt=>tt&&typeof tt.lat=="number"&&typeof tt.lng=="number"?[tt.lat,tt.lng]:Array.isArray(tt)?D(tt):tt):Y,Z=D(b);return JSON.stringify(Z,null,2)},f=(b,D)=>{const Z=document.getElementById("coords-modal");Z&&Z.remove();const Y=document.createElement("div");Y.id="coords-modal",Y.style.position="fixed",Y.style.top="0",Y.style.left="0",Y.style.width="100%",Y.style.height="100%",Y.style.backgroundColor="rgba(0,0,0,0.5)",Y.style.zIndex="10002",Y.style.display="flex",Y.style.alignItems="center",Y.style.justifyContent="center";const tt=document.createElement("div");tt.style.backgroundColor="white",tt.style.padding="20px",tt.style.borderRadius="8px",tt.style.maxWidth="80%",tt.style.maxHeight="80%",tt.style.overflow="auto",tt.style.boxShadow="0 4px 20px rgba(0,0,0,0.3)";const E=document.createElement("div");E.style.display="flex",E.style.justifyContent="space-between",E.style.alignItems="center",E.style.marginBottom="15px",E.style.borderBottom="1px solid #eee",E.style.paddingBottom="10px";const G=document.createElement("h3");G.textContent=`Polygon ${D+1} Coordinates`,G.style.margin="0",G.style.color="#333";const N=document.createElement("button");N.textContent="",N.style.background="none",N.style.border="none",N.style.fontSize="24px",N.style.cursor="pointer",N.style.color="#666",N.style.padding="0",N.style.width="30px",N.style.height="30px",E.appendChild(G),E.appendChild(N);const B=document.createElement("pre");B.textContent=b,B.style.fontFamily="monospace",B.style.fontSize="12px",B.style.backgroundColor="#f5f5f5",B.style.padding="15px",B.style.borderRadius="4px",B.style.overflow="auto",B.style.maxHeight="400px",B.style.margin="0",B.style.whiteSpace="pre-wrap",tt.appendChild(E),tt.appendChild(B),Y.appendChild(tt);const z=()=>{Y.remove()};N.addEventListener("click",z),Y.addEventListener("click",$=>{$.target===Y&&z()}),document.body.appendChild(Y)},m=document.createElement("div");m.style.fontFamily="monospace",m.style.fontSize="12px",m.style.lineHeight="1.4",m.style.whiteSpace="pre";let d=`[
`;o.forEach((b,D)=>{D>0&&(d+=`,
`),d+=`    [
        `;let Z;const Y=b.metrics;if(b.holes.length===0)Z=`[outer: ${b.outer} vtx, perim: ${Y&&Y.outerPerimeter!==void 0?Y.outerPerimeter<1?Y.outerPerimeter.toFixed(2)+" m":Y.outerPerimeter<1e3?Y.outerPerimeter.toFixed(1)+" m":(Y.outerPerimeter/1e3).toFixed(2)+" km":""}, ${Y?Y.outerOrientation:""}]`;else{const tt=b.holes.length===1?`inner: ${b.holes[0]} vtx`:`inner: ${b.holes.join(", ")} vtx`;Z=`[outer: ${b.outer} vtx, ${tt}, total perim: ${Y&&Y.totalPerimeter!==void 0?Y.totalPerimeter<1?Y.totalPerimeter.toFixed(2)+" m":Y.totalPerimeter<1e3?Y.totalPerimeter.toFixed(1)+" m":(Y.totalPerimeter/1e3).toFixed(2)+" km":""}]`}d+=Z+" ",d+=`(i)
    ]`});const x=o.length,v=o.reduce((b,D)=>b+D.outer+D.holes.reduce((Z,Y)=>Z+Y,0),0);d+=`
]`;const w=`// Summary: ${x} polygon(s), ${v} total vertex/vertices`;d+=`
${w}`,m.textContent=d;const I=d.split(`
`);m.innerHTML="";let T=0;I.forEach((b,D)=>{if(b.includes("(i)")){const Z=T,Y=b.substring(0,b.indexOf("(i)")),tt=b.substring(b.indexOf("(i)")+3),E=document.createElement("div");E.style.display="inline";const G=document.createElement("span");G.textContent=Y,E.appendChild(G);const N=document.createElement("span");N.textContent="(i)",N.style.color="#007bff",N.style.cursor="pointer",N.style.textDecoration="underline",N.style.fontWeight="bold",N.title="Click to view coordinates",N.addEventListener("click",()=>{if(Z<0||Z>=o.length||!o[Z]){console.error("Invalid polygon index:",Z,"Structure length:",o.length);return}const z=o[Z],$=u(z.coordinates);try{const C=z.layer;if(C&&typeof C.setStyle=="function"){const R=C.options&&{...C.options};C.setStyle({weight:5}),setTimeout(()=>{R&&C.setStyle({weight:R.weight??3})},1200)}}catch(C){console.warn("Highlight failed:",C)}let P="";if(z.metrics){const C=z.metrics.bounds;P+=`Outer perimeter: ${z.metrics.outerPerimeter<1?z.metrics.outerPerimeter.toFixed(2)+" m":z.metrics.outerPerimeter<1e3?z.metrics.outerPerimeter.toFixed(1)+" m":(z.metrics.outerPerimeter/1e3).toFixed(2)+" km"}
`,z.holes.length>0&&(P+=`Hole perimeters: ${z.metrics.holePerimeters.map(R=>R<1?R.toFixed(2)+" m":R<1e3?R.toFixed(1)+" m":(R/1e3).toFixed(2)+" km").join(", ")}
`),P+=`Total perimeter: ${z.metrics.totalPerimeter<1?z.metrics.totalPerimeter.toFixed(2)+" m":z.metrics.totalPerimeter<1e3?z.metrics.totalPerimeter.toFixed(1)+" m":(z.metrics.totalPerimeter/1e3).toFixed(2)+" km"}
`,P+=`Outer orientation: ${z.metrics.outerOrientation}`,z.metrics.holeOrientations.length&&(P+=`, Hole orientations: ${z.metrics.holeOrientations.join(", ")}`),P+=`
`,C&&(P+=`Bounds SW: [${C.sw.lat.toFixed(6)}, ${C.sw.lng.toFixed(6)}], NE: [${C.ne.lat.toFixed(6)}, ${C.ne.lng.toFixed(6)}]
`)}const S=z.wkt??"";f(`# Metrics
${P}
# Coordinates (JSON)
${$}

# WKT
${S}`,Z)}),T++,E.appendChild(N);const B=document.createElement("span");B.textContent=tt,E.appendChild(B),m.appendChild(E)}else{const Z=document.createElement("div");Z.style.display="inline",Z.textContent=b,m.appendChild(Z)}D<I.length-1&&m.appendChild(document.createElement("br"))}),n&&(n.textContent=h.length.toString()),r.innerHTML="",r.appendChild(m)}xr.on("polydraw:polygon:created",()=>{console.log("Polygon created"),vs()});xr.on("polydraw:mode:change",h=>{console.log("Mode changed to:",h.mode),vs()});xr.on("polygonOperationComplete",()=>{console.log("Polygon operation completed"),vs()});xr.on("polygonDeleted",()=>{console.log("Polygon deleted"),vs()});vs();
